import{d as ue}from"./chunk-3LB7TUPB.js";import{c as z,d as le,e as O,f as x}from"./chunk-WGCZSWYA.js";import{d as He}from"./chunk-BKPOG6ZD.js";import{$ as j,U as ce,_a as fe}from"./chunk-2MV3WEYP.js";import{ha as se}from"./chunk-IUIJ46C3.js";import{d as S,f as Ne}from"./chunk-MAIAJ7GD.js";import{F as ie,n as $}from"./chunk-SOHTSUTI.js";import{I as oe,w as u}from"./chunk-RPZQDAIQ.js";import{Y as Z}from"./chunk-V4F2JFTP.js";import{f as be,m as v,o as g}from"./chunk-EQYVU4XP.js";v();g();var X=be(He());oe();v();g();v();g();function b(){return b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},b.apply(this,arguments)}v();g();function F(e){return e.charAt(0)==="/"}function K(e,t){for(var o=t,n=o+1,a=e.length;n<a;o+=1,n+=1)e[o]=e[n];e.pop()}function ke(e,t){t===void 0&&(t="");var o=e&&e.split("/")||[],n=t&&t.split("/")||[],a=e&&F(e),s=t&&F(t),i=a||s;if(e&&F(e)?n=o:o.length&&(n.pop(),n=n.concat(o)),!n.length)return"/";var d;if(n.length){var c=n[n.length-1];d=c==="."||c===".."||c===""}else d=!1;for(var l=0,f=n.length;f>=0;f--){var y=n[f];y==="."?K(n,f):y===".."?(K(n,f),l++):l&&(K(n,f),l--)}if(!i)for(;l--;l)n.unshift("..");i&&n[0]!==""&&(!n[0]||!F(n[0]))&&n.unshift("");var _=n.join("/");return d&&_.substr(-1)!=="/"&&(_+="/"),_}var he=ke;v();g();v();g();var Me=!0,de="Invariant failed";function Ie(e,t){if(!e)throw Me?new Error(de):new Error(de+": "+(t||""))}var pe=Ie;function Y(e){return e.charAt(0)==="/"?e:"/"+e}function ve(e){return e.charAt(0)==="/"?e.substr(1):e}function Ue(e,t){return e.toLowerCase().indexOf(t.toLowerCase())===0&&"/?#".indexOf(e.charAt(t.length))!==-1}function De(e,t){return Ue(e,t)?e.substr(t.length):e}function Re(e){return e.charAt(e.length-1)==="/"?e.slice(0,-1):e}function Ve(e){var t=e||"/",o="",n="",a=t.indexOf("#");a!==-1&&(n=t.substr(a),t=t.substr(0,a));var s=t.indexOf("?");return s!==-1&&(o=t.substr(s),t=t.substr(0,s)),{pathname:t,search:o==="?"?"":o,hash:n==="#"?"":n}}function P(e){var t=e.pathname,o=e.search,n=e.hash,a=t||"/";return o&&o!=="?"&&(a+=o.charAt(0)==="?"?o:"?"+o),n&&n!=="#"&&(a+=n.charAt(0)==="#"?n:"#"+n),a}function J(e,t,o,n){var a;typeof e=="string"?(a=Ve(e),a.state=t):(a=b({},e),a.pathname===void 0&&(a.pathname=""),a.search?a.search.charAt(0)!=="?"&&(a.search="?"+a.search):a.search="",a.hash?a.hash.charAt(0)!=="#"&&(a.hash="#"+a.hash):a.hash="",t!==void 0&&a.state===void 0&&(a.state=t));try{a.pathname=decodeURI(a.pathname)}catch(s){throw s instanceof URIError?new URIError('Pathname "'+a.pathname+'" could not be decoded. This is likely caused by an invalid percent-encoding.'):s}return o&&(a.key=o),n?a.pathname?a.pathname.charAt(0)!=="/"&&(a.pathname=he(a.pathname,n.pathname)):a.pathname=n.pathname:a.pathname||(a.pathname="/"),a}function Be(){var e=null;function t(i){return e=i,function(){e===i&&(e=null)}}function o(i,d,c,l){if(e!=null){var f=typeof e=="function"?e(i,d):e;typeof f=="string"?typeof c=="function"?c(f,l):l(!0):l(f!==!1)}else l(!0)}var n=[];function a(i){var d=!0;function c(){d&&i.apply(void 0,arguments)}return n.push(c),function(){d=!1,n=n.filter(function(l){return l!==c})}}function s(){for(var i=arguments.length,d=new Array(i),c=0;c<i;c++)d[c]=arguments[c];n.forEach(function(l){return l.apply(void 0,d)})}return{setPrompt:t,confirmTransitionTo:o,appendListener:a,notifyListeners:s}}var We=!!(typeof window<"u"&&window.document&&window.document.createElement);function $e(e,t){t(window.confirm(e))}function je(){return window.navigator.userAgent.indexOf("Firefox")===-1}var ge="hashchange",Fe={hashbang:{encodePath:function(t){return t.charAt(0)==="!"?t:"!/"+ve(t)},decodePath:function(t){return t.charAt(0)==="!"?t.substr(1):t}},noslash:{encodePath:ve,decodePath:Y},slash:{encodePath:Y,decodePath:Y}};function me(e){var t=e.indexOf("#");return t===-1?e:e.slice(0,t)}function k(){var e=window.location.href,t=e.indexOf("#");return t===-1?"":e.substring(t+1)}function Ye(e){window.location.hash=e}function Q(e){window.location.replace(me(window.location.href)+"#"+e)}function we(e){e===void 0&&(e={}),We||pe(!1);var t=window.history,o=je(),n=e,a=n.getUserConfirmation,s=a===void 0?$e:a,i=n.hashType,d=i===void 0?"slash":i,c=e.basename?Re(Y(e.basename)):"",l=Fe[d],f=l.encodePath,y=l.decodePath;function _(){var r=y(k());return c&&(r=De(r,c)),J(r)}var E=Be();function T(r){b(w,r),w.length=t.length,E.notifyListeners(w.location,w.action)}var U=!1,D=null;function ye(r,h){return r.pathname===h.pathname&&r.search===h.search&&r.hash===h.hash}function ee(){var r=k(),h=f(r);if(r!==h)Q(h);else{var p=_(),m=w.location;if(!U&&ye(m,p)||D===P(p))return;D=null,Ee(p)}}function Ee(r){if(U)U=!1,T();else{var h="POP";E.confirmTransitionTo(r,h,s,function(p){p?T({action:h,location:r}):xe(r)})}}function xe(r){var h=w.location,p=A.lastIndexOf(P(h));p===-1&&(p=0);var m=A.lastIndexOf(P(r));m===-1&&(m=0);var C=p-m;C&&(U=!0,R(C))}var te=k(),ne=f(te);te!==ne&&Q(ne);var ae=_(),A=[P(ae)];function Pe(r){var h=document.querySelector("base"),p="";return h&&h.getAttribute("href")&&(p=me(window.location.href)),p+"#"+f(c+P(r))}function Oe(r,h){var p="PUSH",m=J(r,void 0,void 0,w.location);E.confirmTransitionTo(m,p,s,function(C){if(!!C){var L=P(m),H=f(c+L),q=k()!==H;if(q){D=L,Ye(H);var W=A.lastIndexOf(P(w.location)),re=A.slice(0,W+1);re.push(L),A=re,T({action:p,location:m})}else T()}})}function Te(r,h){var p="REPLACE",m=J(r,void 0,void 0,w.location);E.confirmTransitionTo(m,p,s,function(C){if(!!C){var L=P(m),H=f(c+L),q=k()!==H;q&&(D=L,Q(H));var W=A.indexOf(P(w.location));W!==-1&&(A[W]=L),T({action:p,location:m})}})}function R(r){t.go(r)}function Ae(){R(-1)}function Le(){R(1)}var G=0;function V(r){G+=r,G===1&&r===1?window.addEventListener(ge,ee):G===0&&window.removeEventListener(ge,ee)}var B=!1;function Ce(r){r===void 0&&(r=!1);var h=E.setPrompt(r);return B||(V(1),B=!0),function(){return B&&(B=!1,V(-1)),h()}}function Se(r){var h=E.appendListener(r);return V(1),function(){V(-1),h()}}var w={length:t.length,action:"POP",location:ae,createHref:Pe,push:Oe,replace:Te,go:R,goBack:Ae,goForward:Le,block:Ce,listen:Se};return w}Ne();v();g();oe();var M={hideCloseBtn:!0,infoType:$.Prompt.INFO_TYPE.warn,alignBottom:!1,maskClosable:!1,confirmBtnProps:{type:Z.TYPE.highlight,size:Z.SIZE.lg}},_e=(e,t)=>{let{accountStatus:o,mpcStatus:n,loginStatus:a=!0}=e;switch(!0){case n===x.RECOVER:return{...M,title:u("wallet_extension_mpc_title_sync_wallet"),text:u("wallet_extension_mpc_subtitle_sync_wallet"),confirmText:u("wallet_extension_mpc_btn_sync_wallet"),cancelText:u("extension_wallet_error_toast_btn_switch_wallet"),...t};case n===x.ESCAPE:return{...M,title:u("extension_wallet_error_toast_modaltitle_wallet_escaped"),text:u("extension_wallet_error_toast_modaldesc_wallet_escapeddesc"),confirmText:u("extension_wallet_error_toast_btn_switch_wallet"),...t};case o===O.FROZEN:return{...M,title:u("extension_wallet_error_toast_title_freeze_account"),text:u("extension_wallet_error_toast_text_freeze_desc"),confirmText:u("extension_wallet_error_toast_btn_switch_wallet"),...t};case o===O.DELETE:return{...M,title:u("extension_wallet_error_toast_modatitle_deleteacct"),text:u("extension_wallet_error_toast_modaldesc_deleteacct"),confirmText:u("extension_wallet_error_toast_btn_switch_wallet"),...t};case!a:return{...M,title:u("extension_wallet_error_toast_title_verify_again"),text:u("extension_wallet_error_toast_text_verify_again2"),confirmText:u("extension_wallet_error_toast_btn_verification"),...t};default:return{}}};var I=we(),Ge=async e=>{let t={pass:!0};if(await S().getServerWalletTypeByWalletId(e)!==se.MPC_WALLET)return t;let n=await S().getMpcIdByWalletId(e);if(!n)return t;let a=!1;try{a=await S().accountCheck(n)}catch{a=!1}let s=O.FROZEN,i=x.ESCAPE,{data:d}=await ue([{mpcId:n}]);return s=(0,X.default)(d,"[0].accountStatus",s),i=(0,X.default)(d,"[0].mpcStatus",i),{pass:s===O.NORMAL&&i!==x.ESCAPE&&i!==x.RECOVER&&a,accountStatus:s,mpcStatus:i,loginStatus:a,walletId:e}},St=async({callback:e,walletId:t}={})=>{try{let o=await S().getSelectedWallet(),n=t||o,{pass:a,accountStatus:s,mpcStatus:i,loginStatus:d}=await Ge(n);if(a)return!0;let c=async()=>{let T=u("wallet_common_okx_link");await S().setMpcAction(z.VERIFY,n),globalThis.open(`https://${T}${le}`),window.close()},l={},f=$.prompt(l),y,_,E={};switch(d||(y=async()=>{e&&e(),await c(),f.destroyAll()},I.location.pathname.includes(ce)||(_=()=>{e&&e(),I.replace(j),f.destroyAll()},E={cancelText:u("extension_wallet_error_toast_btn_switch_wallet")})),!0){case i===x.RECOVER:y=()=>{e&&e(),I.replace(`${fe}?action=${z.RECOVER}&walletId=${n}`),f.destroyAll()},_=()=>{e&&e(),I.replace(j),f.destroyAll()};break;case i===x.ESCAPE:case s===O.FROZEN:case s===O.DELETE:y=()=>{e&&e(),I.replace(j),f.destroyAll()};break;default:break}return l=_e({accountStatus:s,mpcStatus:i,loginStatus:d},{onConfirm:y,onCancel:_,...E}),f.update(l),!1}catch{return ie.error({title:u("extension_wallet_error_toast_signature_failed")}),!1}};export{_e as a,St as b};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "prepub";

//# sourceMappingURL=chunk-5EZVDCYS.js.map
