import{a as Se}from"./chunk-O5OC5U2Z.js";import"./chunk-TUEJVTLY.js";import{a as Te}from"./chunk-SLLZHAN2.js";import{a as ge}from"./chunk-XQL7T4TZ.js";import{a as de}from"./chunk-QNERK7ZB.js";import{a as pe}from"./chunk-H3SRG5PM.js";import"./chunk-SCZBCO2U.js";import{a as ue,b as fe}from"./chunk-R37IPONJ.js";import{a as ie}from"./chunk-G2V3XEUQ.js";import{a as ae,b as me}from"./chunk-QR2WOQMM.js";import{d as ce,g as le}from"./chunk-2P6KMQ6R.js";import{a as ne}from"./chunk-PVE3B4RU.js";import"./chunk-636MHS2Q.js";import"./chunk-XJ4IKVPR.js";import{k as oe}from"./chunk-XE2F6LDQ.js";import"./chunk-REIQGNZB.js";import"./chunk-Q4CU3DV4.js";import"./chunk-DSYZP5KR.js";import"./chunk-36P2OA3A.js";import"./chunk-JMAKZZHS.js";import"./chunk-NZPUYPHL.js";import"./chunk-4QAFBCO2.js";import{a as re}from"./chunk-B553FNEQ.js";import"./chunk-6QKWDR6X.js";import"./chunk-S2GMXONU.js";import{a as P}from"./chunk-7XFZKU6W.js";import"./chunk-ZPDRUAGN.js";import"./chunk-WCH23YYN.js";import"./chunk-NZZFB6IS.js";import"./chunk-35PGDXR7.js";import"./chunk-PUO23DIP.js";import"./chunk-O2J764NL.js";import"./chunk-CDLW656Z.js";import"./chunk-3K3KMGWB.js";import"./chunk-5EZVDCYS.js";import"./chunk-475E6NBR.js";import"./chunk-RC5IAFKK.js";import"./chunk-4VLUHY4K.js";import"./chunk-IHPHPUUG.js";import"./chunk-ZEWK7OGU.js";import"./chunk-QVA4WXOQ.js";import"./chunk-EX22SDGB.js";import"./chunk-4RARGC4D.js";import"./chunk-OQOFXHGC.js";import"./chunk-3QA2SYRR.js";import"./chunk-3SC55VQ2.js";import{e as z,g as te}from"./chunk-VTLNAOHG.js";import"./chunk-Y7YPG2EJ.js";import"./chunk-7R67VE77.js";import"./chunk-NHGZUGLZ.js";import"./chunk-G5LEAVCY.js";import"./chunk-ACHWU2H6.js";import"./chunk-ZPFBKNRM.js";import"./chunk-7DP5LYUM.js";import"./chunk-BVXKJJ4A.js";import"./chunk-TBBE7OKY.js";import"./chunk-7HJDVUH5.js";import"./chunk-E2XQ2FKN.js";import"./chunk-Y6FCLKTO.js";import"./chunk-R53OLZPP.js";import"./chunk-ADKEXOTG.js";import"./chunk-H7DITLB3.js";import"./chunk-2GMLPDYZ.js";import"./chunk-DY54SY5O.js";import"./chunk-VQBK6IHT.js";import"./chunk-CTT7GD4C.js";import"./chunk-LQAOHG2H.js";import"./chunk-WNQ6F6VV.js";import"./chunk-LEADLFDQ.js";import"./chunk-DGK7TBBE.js";import"./chunk-6Y7ULJF6.js";import"./chunk-3YH3AGVS.js";import"./chunk-3LB7TUPB.js";import"./chunk-TK6JYPIW.js";import"./chunk-OS6E6KVM.js";import"./chunk-GZRBUDXF.js";import"./chunk-WY46TT4P.js";import"./chunk-MTMUCMTY.js";import{a as se}from"./chunk-S6N4IJX7.js";import"./chunk-ZD4EJWX6.js";import"./chunk-WGCZSWYA.js";import"./chunk-IINHHLHP.js";import"./chunk-DY2YURLY.js";import"./chunk-KXZSXP3G.js";import"./chunk-6HXVFU7V.js";import"./chunk-D5FMQLJG.js";import"./chunk-3I7UBQEQ.js";import"./chunk-DXRBY5MU.js";import"./chunk-6FR2UIE7.js";import"./chunk-5GMHHIH5.js";import{c as ee}from"./chunk-7KCWBFQ2.js";import"./chunk-QLUP7GYN.js";import"./chunk-7Y44NCE5.js";import"./chunk-BKPOG6ZD.js";import"./chunk-OZMVWMFO.js";import"./chunk-KTO7CPX7.js";import"./chunk-P3XTPXPO.js";import"./chunk-S6TPD26J.js";import"./chunk-4IY6P5HR.js";import"./chunk-FQWGOLDH.js";import"./chunk-QEPBNPHF.js";import"./chunk-3JLS3TGD.js";import"./chunk-KDP5Z4RF.js";import"./chunk-W234FNSM.js";import"./chunk-DDO6HXRN.js";import"./chunk-CLWWTOKP.js";import"./chunk-KZ2PCELG.js";import"./chunk-C7ZG4INB.js";import"./chunk-J5ANWCEO.js";import"./chunk-VMO2INN3.js";import"./chunk-J4TF3RT7.js";import"./chunk-6FOZGMAL.js";import"./chunk-2MV3WEYP.js";import"./chunk-HPXM6RSK.js";import"./chunk-NAI3K3VA.js";import"./chunk-56PELQWI.js";import{E as y,aa as _}from"./chunk-IUIJ46C3.js";import"./chunk-KZ3ZU675.js";import"./chunk-NJ5CWPUY.js";import"./chunk-UH5YBH76.js";import"./chunk-UMJMJOW4.js";import"./chunk-YTJBYVBO.js";import"./chunk-QO3243S4.js";import"./chunk-O5JCC6KG.js";import"./chunk-MAIAJ7GD.js";import{e as v}from"./chunk-4PGNX6E2.js";import"./chunk-DBHB6SUD.js";import"./chunk-I56VJWE4.js";import"./chunk-PS3S6BG3.js";import"./chunk-RT4Y2U5N.js";import"./chunk-2VHH444P.js";import"./chunk-RIMU4JTV.js";import"./chunk-MGLVPWSV.js";import{i as Z}from"./chunk-TXKWPME2.js";import"./chunk-4D3M2I6W.js";import"./chunk-AMVK42SC.js";import"./chunk-D6RIE45O.js";import"./chunk-XCAARJ7Q.js";import"./chunk-JXCCIV3J.js";import"./chunk-AOA7NX2Y.js";import"./chunk-HXZH2DHB.js";import"./chunk-MZG4RHXJ.js";import"./chunk-VTST2UXT.js";import{Kb as $,kb as Y,m as J,pb as X,rb as U}from"./chunk-X7YMANPZ.js";import"./chunk-IRITFTWC.js";import{c as Q}from"./chunk-SOHTSUTI.js";import{I as j,m as K,w as W}from"./chunk-RPZQDAIQ.js";import"./chunk-LDRI4AYU.js";import"./chunk-E24EBHFY.js";import"./chunk-V4F2JFTP.js";import{a as w}from"./chunk-6DDC4Y2S.js";import"./chunk-TEY24VZN.js";import"./chunk-RKHQOOTU.js";import"./chunk-KJOC4LFM.js";import"./chunk-6FDO4Y56.js";import"./chunk-NNZ5SU5W.js";import"./chunk-F4JTGWJH.js";import"./chunk-ZALGQC7G.js";import"./chunk-4OUGL4WS.js";import"./chunk-YUXYCITH.js";import"./chunk-RMV3AS5X.js";import"./chunk-IYL2DA3V.js";import"./chunk-MYDAWE3K.js";import"./chunk-3NG42BBY.js";import"./chunk-QYTYSNLW.js";import"./chunk-QMAXXJCA.js";import"./chunk-HFBVRVPB.js";import"./chunk-SF2LTPAC.js";import"./chunk-TEKDZ77C.js";import"./chunk-NC54RUAI.js";import"./chunk-YR74Q3QD.js";import{f as C,m as d,o as g}from"./chunk-EQYVU4XP.js";d();g();var q=C(w());d();g();var L=C(w());j();d();g();var Ee=C(w()),H=C(J());d();g();var m=C(w());$();function we({coinId:e,transactions:r,address:s,replace:n,disabled:F,unitLimits:u,signInfo:o}){let[E,x]=(0,m.useState)(0),[f,i]=(0,m.useState)(null),[R,p]=(0,m.useState)([]),[c,S]=(0,m.useState)("0"),[t,a]=(0,m.useState)(!1),T=f?.fee||"0",[N,b]=(0,m.useState)(r),A=de(),G=z(e),{disabledSignInfo:D=!1,disabledPreExecute:B=!1}=F||{},I=O=>{x(O?l=>l+1:l=>l-1)};return(0,m.useEffect)(()=>{u&&p(u)},[u]),(0,m.useEffect)(()=>{o&&i(o)},[o]),(0,m.useEffect)(()=>{(async function(){if(!(D||!e)){I(!0);try{let{data:l={}}=await ee({coinId:e,address:s}),{info:k={}}=l;i(k),a(!1)}catch{a(!0)}finally{I(!1)}}})()},[s,e,D]),(0,m.useEffect)(()=>{(async function(){if(!(B||!e)&&!(!n||!G?.chainId)){I(!0);try{let l=await A({coinId:e,from:s,chainId:G.chainId,simulateTransactionParamList:r.map(({serializedMessage:k})=>({transaction:k,sigVerify:!1,replaceRecentBlockhash:!0}))});p(l.unitLimits),a(!1)}catch{a(!0)}finally{I(!1)}}})()},[...r,n,s,G?.chainId,B,e]),(0,m.useEffect)(()=>{(async function(){if(!(n&&(!f||!R?.length))){I(!0);try{let l=r;n&&(l=await Promise.all(l.map(async(V,Ne)=>{let{serializedMessage:_e,...Le}=V,Ie=await fe(_e,f.computeUnitPrice,R[Ne]);return{...Le,serializedMessage:Ie}})));let k=await ue(l.map(({serializedMessage:V})=>V));S(k),b(l)}finally{I(!1)}}})()},[...r,n,f,R]),{loading:E>0,baseFee:T,priorityFee:c,totalFee:Y(T,c),signInfo:f,estimateFailed:t,replacedTransactions:N}}var Fe=we;$();var Pe=({unapproved:e,coinId:r,preExecuteResult:s})=>{let{address:n}=P(e),{loading:F,preExecuteRet:u}=s,o=u?.[_.TX_ANALYZE]||{},E=(o.simulateTransactionResultList||[]).find(A=>(0,H.isNil)(A?.unitGasLimit)||U(A?.unitGasLimit,"0")),x=(0,Ee.useMemo)(()=>(o.simulateTransactionResultList||[]).map(A=>A?.unitGasLimit),[o.simulateTransactionResultList]),{loading:f,totalFee:i,estimateFailed:R,signInfo:p,replacedTransactions:c}=Fe({coinId:r,transactions:e?.params?.message||[],address:n,replace:!0,unitLimits:x,disabled:{disabledPreExecute:!0}}),S=p?.solRent||"0",t=R||!F&&!!E,a=te(r,e.walletId)?.coinAmountInt,T=(0,H.isNil)(a)||X(a,i)||F,N=(0,H.isNil)(a)||X(a,Y(i,S))||F;return{loading:f,networkFeeProps:{loading:f,networkFee:i,estimateFailed:t,coinId:r},isSufficientGas:T,networkFee:i,estimateFailed:t,estimateFailedMsg:E?.msg,isSufficientBalance:N,selfRent:S,replacedTransactions:c}},xe=Pe;d();g();var Re=C(J());j();var h=C(w());var Ge=({unapproved:e})=>{let r=re(),[s,n]=(0,h.useState)(!1),{host:F}=ne(e),u=P(e),[o,E]=(0,h.useState)({}),x=e?.params?.message||[],f=(0,h.useCallback)(async p=>{let{chainId:c,coinId:S}=p;try{n(!0);let t=await r({checkTypes:[_.TX_ANALYZE,_.KYS],from:u.address,chainId:c,domain:F,coinId:S,bizLine:6,simulateTransactionParamList:x.map(a=>({transaction:a.serializedMessage,sigVerify:!1,replaceRecentBlockhash:!0}))});E(t)}catch(t){console.log(t)}finally{n(!1)}},[F,x.length,r,u.address]),i=(0,h.useMemo)(()=>{let p=o?.[_.TX_ANALYZE]||{},c=p.simulateTransactionResultList,S=c?.length;if((0,Re.isArray)(c)&&S>0){if(S===1)return c[0];let t={};if(c.every(T=>!T.result)){t.result=!1,t.msg=W("wallet_extension_transaction_text_thirdparty_contract_failed");let T=c.some(N=>N.addFundsFlag);t.addFundsFlag=T,t.resultCode=T?se:""}else t.result=!0,t.msg="",t.addFundsFlag=!1,t.resultCode="";return t}return p},[o]),R=(0,h.useMemo)(()=>({loading:s,...o?.[_.KYS]||{}}),[s,o]);return{loading:s,kysRet:R,preExecute:f,verifyGasLimitRet:i,preExecuteRet:o}},ye=Ge;var Ae=({unapproved:e})=>{let r=pe(Z),s=z(r?.coinId)||{},n=s?.coinId||r?.coinId,{initialType:F}=P(e),u=ye({unapproved:e}),{verifyGasLimitRet:o,kysRet:E,preExecute:x}=u;(0,L.useEffect)(()=>{s?.coinId&&x(s)},[s?.coinId,x]);let{networkFee:f,isSufficientGas:i,networkFeeProps:R,estimateFailed:p,estimateFailedMsg:c,loading:S,isSufficientBalance:t,selfRent:a,replacedTransactions:T}=xe({coinId:n,unapproved:e,preExecuteResult:u}),N=(0,L.useCallback)(()=>!t&&i?{type:Q.TYPE.warn,message:W("walletextension_toast_text_reserve_rent_exempt",{number:K.div(a,10**s?.decimals)})}:null,[i,t,a,s?.decimals]),b=ce({unapproved:e}),A=le({verifyGasLimitRet:o}),G=me({baseCoin:s,unapproved:e,estimateFailed:p,isSufficientGas:i,verifyGasLimitRet:o,estimateFailedMsg:c,kysRet:E},{pre:[b,A],post:[N]}),{buttonGroup:D,handleCancel:B}=ie({coinId:n,feeLoading:S,unapproved:e,estimateFailed:p,isSufficientGas:i,preExecuteRet:u,extParams:{coinId:n,replacedTransactions:T,serviceCharge:f},chainConfirmDisabled:v(F),isSufficientBalance:t});return oe({kysRet:E,handleCancel:B,coinId:n}),L.default.createElement(ae,{slot:{top:L.default.createElement(Se,{origin:e.origin,providerType:Z,chainName:r?.chainName})},kysRet:E,baseCoin:s,unapproved:e,tipMessage:G,buttonGroup:D,networkFee:R})};d();g();var Ce=C(w());var he=({unapproved:e})=>{let r=e.params?.message,s=Te({unapproved:e});return Ce.default.createElement(ge,{message:r,unapproved:e,tipMessage:s})};var wt=({unapproved:e})=>{switch(e.method){case y.SIGN_TRANSACTION:case y.RPC_SIGN_TRANSACTION:case y.SIGN_AND_SEND_TRANSACTION:case y.RPC_SIGN_AND_SEND_TRANSACTION:case y.SIGN_ALL_TRANSACTIONS:case y.RPC_SIGN_ALL_TRANSACTIONS:return q.default.createElement(Ae,{unapproved:e});case y.SIGN_MESSAGE:case y.RPC_SIGN_MESSAGE:return q.default.createElement(he,{unapproved:e});default:return""}};export{wt as default};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "prepub";

//# sourceMappingURL=Solana-KX4RRX45.js.map
