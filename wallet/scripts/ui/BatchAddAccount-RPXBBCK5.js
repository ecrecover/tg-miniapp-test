import{a as bt}from"./chunk-WJWEP735.js";import{a as ht}from"./chunk-FPD7KVNO.js";import{a as Nt}from"./chunk-GUR7WW2Z.js";import{a as It}from"./chunk-JZPJQZZP.js";import"./chunk-GITGXMEO.js";import{a as V}from"./chunk-LEKCTZRC.js";import"./chunk-EQQ4TY26.js";import{a as rt}from"./chunk-PCN4TJH3.js";import{a as wt,b as Et,c as kt,d as Bt}from"./chunk-KCL2QTT6.js";import"./chunk-EZON4FEH.js";import{q as gt}from"./chunk-WWF4GAYE.js";import"./chunk-YITM3H6Z.js";import"./chunk-IQFXZKFW.js";import{Oa as P,Pa as M}from"./chunk-4Z4GXCHB.js";import{y as no}from"./chunk-FK3ETA6I.js";import"./chunk-QZDHFNHK.js";import{a as xt}from"./chunk-EJQOS3F4.js";import{j as At,o as ao}from"./chunk-LHHZ5TAA.js";import{h as yt,l as so}from"./chunk-PI6QLVMS.js";import"./chunk-QY4HIIR3.js";import"./chunk-XFWUEPSK.js";import{d as pt,f as ro}from"./chunk-MNNY2ODL.js";import"./chunk-C5ZJZEPI.js";import"./chunk-LGHM3MOC.js";import"./chunk-2FULUWWG.js";import"./chunk-SLEUZTBQ.js";import{c as d}from"./chunk-4QSQKIBZ.js";import"./chunk-OXVQDEZW.js";import"./chunk-X3G52GGX.js";import"./chunk-WUKT6J7S.js";import"./chunk-FTJCOLFJ.js";import{Hc as et,Sb as _t,Wb as oo,Xb as ft,Yb as eo}from"./chunk-QG673PNL.js";import"./chunk-ZUFARSFM.js";import{C as D,p as ut,v as dt}from"./chunk-6MTHEPGF.js";import{I as b,m as w,w as _}from"./chunk-ZQQ7HNWV.js";import"./chunk-Y62GSKHT.js";import"./chunk-2BXFMFMK.js";import{M as mt,R as ct,S as lt,Y as x,c as ot}from"./chunk-ZOQTSYT4.js";import{a as A}from"./chunk-ADZWCU3Q.js";import"./chunk-FDI7TLXH.js";import"./chunk-L4HTIIR6.js";import"./chunk-733NI6T7.js";import"./chunk-EYWGNJVY.js";import"./chunk-TBVIGR5T.js";import"./chunk-FHQVMQUK.js";import"./chunk-XNS2NFYY.js";import{f,m as t,o}from"./chunk-REC7XVZY.js";t();o();var R=f(A()),K=f(xt());t();o();var G=f(A());t();o();var z=f(A());t();o();var nt={root:"_root_th09o_1",header:"_header_th09o_42"};t();o();t();o();var Lt=f(A());t();o();var C=rt(Et,Bt),Y=rt(wt,kt);t();o();var Dt=f(xt());function io(){let e=(0,Dt.useHistory)(),r=u=>(p=!0)=>{p?e.replace(u):e.push(u)},n=u=>e.location.pathname===u,s=r(M),a=r(P),i=n(P),m=n(M);return{isHomePage:i,isAddPage:m,gotoAddPage:s,gotoHomePage:a}}var j=io;function mo(){let[e]=C(),{gotoHomePage:r,isHomePage:n}=j();(0,Lt.useLayoutEffect)(()=>{!n&&!e&&r()},[r,n,e])}var St=mo;function co(){return St(),null}var Tt=co;function lo({children:e,hidden:r=!1}){return z.default.createElement(d.Box,{className:nt.root},z.default.createElement(ht,{className:nt.header}),r?null:e,z.default.createElement(Tt,null))}var Z=lo;t();o();var q=f(A());b();t();o();var O={root:"_root_1ccc7_1",titleBox:"_titleBox_1ccc7_17",title:"_title_1ccc7_17",subtitle:"_subtitle_1ccc7_160",add:"_add_1ccc7_179"};function uo(){let e=_("wallet_extension_addaccount_title_add_account"),r=_("wallet_extension_addaccount_subtitle_select_account");return q.default.createElement(d.Box,{className:O.titleBox},q.default.createElement(d.Box,{className:O.title},e),q.default.createElement(d.Box,{className:O.subtitle},r))}var Ft=uo;t();o();var y=f(A());b();t();o();var Ct=f(A());b();var _o=e=>e.filter(r=>[et.MNEMONIC,et.MPC].includes(r.keyringIdentityType)).filter(r=>r.walletIdentities.every(n=>(n.backupData??[]).length<=0)),st=1;function fo(){let e=D.useForm(),{gotoAddPage:r}=j(),{keyringIdentities:n,remainAccountAmount:s}=V(),[,a]=Y(),[,i]=C(),m=N=>{if(Object.keys(e.getErrors()).length>0)return;let{keyringId:T,amount:v}=N;if(v==="0")return;let tt=Number(v||st);!T||tt>s||(a(tt),i(T),r())},u=(0,Ct.useMemo)(()=>_o(n).map(N=>({value:N.keyringId,label:N.keyringName,len:N.walletIdentities.length})),[n]),p={keyringId:u[0]?.value,amount:""},g=(N,B=st)=>{if(Number(B||st)<=s&&s>0)return Promise.resolve();let v=_("wallet_extension_addaccount_remainder_added_upper_limits",{num:w.thousandFormat(s)});return Promise.reject(v)},H=()=>{e.setFieldsValue({amount:s})},k=s<=0||u.length<=0;return{initialValues:p,onSubmit:m,form:e,options:u,amountValidator:g,onSetMaxAmount:H,disableAdd:k}}var Ot=fo;t();o();var E={root:"_root_1e3xx_2",confirm:"_confirm_1e3xx_57",max:"_max_1e3xx_71",label:"_label_1e3xx_81",name:"_name_1e3xx_87",nums:"_nums_1e3xx_94",option:"_option_1e3xx_100",icon:"_icon_1e3xx_119"};function po(){let{initialValues:e,onSubmit:r,form:n,options:s,amountValidator:a,onSetMaxAmount:i,disableAdd:m}=Ot(),u=p=>y.default.createElement(y.default.Fragment,null,y.default.createElement("div",{className:E.name},p.label),y.default.createElement("div",{className:E.nums},_("wallet_extension_batch_modify_account_desc",{num:w.thousandFormat(p.len)})));return y.default.createElement(d.Box,{className:E.root},y.default.createElement(D,{requiredMark:!0,initialValues:e,onSubmit:r,form:n},y.default.createElement(D.Item,{label:_("wallet_extension_addaccount_title_select_wallet"),name:"keyringId"},y.default.createElement(dt,{title:_("wallet_extension_addaccount_title_select_wallet"),options:s,searchable:!1,showSelectedIcon:!0,label:p=>y.default.createElement("div",{className:E.label},u(p)),renderOption:({option:p,activeIcon:g})=>y.default.createElement("div",{className:E.option},y.default.createElement("div",null,u(p)),y.default.createElement("div",{className:E.icon},g))})),y.default.createElement(D.Item,{label:_("wallet_extension_addaccount_text_added_amount"),name:"amount",rules:[{validator:a}]},y.default.createElement(ut.Number,{placeholder:"1",precision:0,min:1,suffix:y.default.createElement(d.Box,{className:E.max,onClick:i},_("wallet_extension_addaccount_textbtn_max"))})),y.default.createElement(D.Item,{noStyle:!0,className:E.confirm},y.default.createElement(x,{category:x.CATEGORY.fill,type:x.TYPE.highlight,size:x.SIZE.xl,disabled:m,htmlType:"submit",block:!0},_("wallet_extension_addaccount_btn_add")))))}var Ht=po;function xo(){return G.default.createElement(Z,null,G.default.createElement(d.Box,{className:O.root},G.default.createElement(Ft,null),G.default.createElement(Ht,null)))}var vt=xo;t();o();var S=f(A());t();o();var Pt={root:"_root_1uqqr_1"};t();o();t();o();ro();var Mt=f(no());ao();so();var yo=()=>{let e=(0,Mt.useDispatch)();return async(n,s=1)=>{try{return await pt().addNewWallets(n,s)}catch(a){throw e(yt(a?.message)),a}finally{await At(e)}}},Gt=yo;var I=f(A());t();o();function Ao(){let e=r=>({execute:r,cancel:()=>{},pause:()=>{}});return new bt(e)}var Ut=Ao;t();o();var go={NONE:"NONE",ADDING:"ADDING",FINISHED:"FINISHED",FAILED:"FAILED"},l=go;var X=e=>r=>r+e,Io=e=>{let[r,n]=(0,I.useState)(l.NONE),s=(0,I.useRef)(),[a]=Y(),[i,m]=(0,I.useState)(0),[u,p]=(0,I.useState)(0),g=(0,I.useRef)(),H=Gt(),k=a-i,N=F=>F>0;(0,I.useEffect)(()=>{a<=0||(i===a&&n(l.FINISHED),u===a&&n(l.FAILED))},[u,i,a]);let B=F=>{!N(F)||(n(l.ADDING),s.current=Ut(),s.current.start(async Rt=>{if(N(F)&&F>g.current){let W=Math.min(F-g.current,1);try{let it=(await H(e,W)).length;m(X(it)),p(X(W-it))}catch{p(X(W))}finally{g.current=X(W)(g.current),Rt()}}else n(l.FINISHED)}))};return{start:()=>{i>0||(g.current=0,B(a))},cancel:()=>{n(l.FINISHED),s.current?.cancel()},retry:()=>{k>0&&(g.current=0,p(0),B(k))},failed:u,success:i,total:a,remain:k,status:r}},ho=e=>{let{keyringIdentities:r,remainAccountAmount:n}=V(),s=r.find(i=>i.keyringId===e),a=s?.walletIdentities?.[0]?.walletId;return{keyring:s,walletId:a,remainAccountAmount:n}};function wo(){let[e]=C(),{walletId:r,keyring:n,remainAccountAmount:s}=ho(e),a=(0,I.useRef)(!1),{start:i,cancel:m,retry:u,success:p,failed:g,total:H,status:k}=Io(r),N=async()=>{let B=await globalThis.platform.getActiveTabs();await globalThis.platform.closeTab(B.map(({id:T})=>T))};return(0,I.useEffect)(()=>{!a.current&&r&&s>0&&(i(),a.current=!0)},[r,s,i]),{start:i,cancel:m,retry:u,success:p,failed:g,total:H,keyring:n,status:k,onFinish:N}}var Kt=wo;t();o();var Vt=f(A()),Yt=f(ot());b();t();o();var Wt={root:"_root_1lp9n_1"};var Eo=({status:e,className:r,walletName:n})=>{let a={[l.NONE]:null,[l.ADDING]:{key:"wallet_extension_addaccount_remainder_account_creating",params:{acctName:n}},[l.FINISHED]:{key:"wallet_extension_addaccount_remainder_account_created"},[l.FAILED]:{key:"wallet_extension_addaccount_adding_maintitle_create_failed"}}[e],i=a?_(a.key,a.params):"";return Vt.default.createElement(d.Box,{className:(0,Yt.default)(Wt.root,r)},i)},jt=Eo;t();o();var J=f(A());var zt=f(ot());t();o();var U={icon:"_icon_1y49k_1",failed:"_failed_1y49k_5",finished:"_finished_1y49k_8",loading:"_loading_1y49k_11"};var Zt=(e,r)=>()=>J.default.createElement(mt,{className:(0,zt.default)(e,U.icon,r)}),ko=Zt("okds-success-circle",U.finished),Bo=Zt("okx-wallet-plugin-warning-circle",U.failed),bo=()=>J.default.createElement(lt,{loaderClassName:U.loading}),Do=()=>null,Lo={[l.NONE]:Do,[l.ADDING]:bo,[l.FINISHED]:ko,[l.FAILED]:Bo},So=({status:e})=>{let r=Lo[e];return J.default.createElement(r,null)},qt=So;t();o();var $=f(A());b();t();o();var Q={root:"_root_4wjpy_1",item:"_item_4wjpy_107",retry:"_retry_4wjpy_130"};t();o();b();var To=({status:e,success:r=0,total:n=0,failed:s=0})=>{let i=l.FINISHED===e?n-r:s,m={success:{key:"wallet_extension_addaccount_adding_text_create_success",params:{num:w.thousandFormat(r)}},failed:{key:"wallet_extension_addaccount_adding_text_create_failed",params:{num:w.thousandFormat(i)},withRetry:i>0},adding:{key:"wallet_extension_addaccount_remainder_created_account",params:{successnum:w.thousandFormat(r),totalnum:w.thousandFormat(n)}}};return{items:{[l.NONE]:[],[l.ADDING]:[m.adding],[l.FINISHED]:[m.success,i>0?m.failed:void 0].filter(Boolean),[l.FAILED]:[m.failed]}[e]}},Xt=To;function Fo(e){let{items:r=[]}=Xt(e),{retry:n}=e;return $.default.createElement(d.Box,{className:Q.root},r.map((s,a)=>{let{key:i,params:m,withRetry:u}=s;return $.default.createElement(d.Box,{key:a,className:Q.item},_(i,m),u&&$.default.createElement(d.Box,{onClick:n,className:Q.retry},_("wallet_extension_addaccount_adding_textbtn_retry")))}))}var Jt=Fo;t();o();var h=f(A()),at=f(ot());b();eo();oo();t();o();var L={root:"_root_1chmx_1",actions:"_actions_1chmx_21",adding:"_adding_1chmx_38",finish:"_finish_1chmx_52",tip:"_tip_1chmx_104",hiddenTip:"_hiddenTip_1chmx_202"};function Co(e){let{isSm:r}=ct(),{status:n,cancel:s,download:a,finish:i}=e,m=n===l.ADDING,u=ft();return h.default.createElement(d.Box,{className:L.root},h.default.createElement(d.Box,{className:(0,at.default)(L.actions,m?L.adding:L.finish)},m?h.default.createElement(h.default.Fragment,null,h.default.createElement(x,{category:x.CATEGORY.outline,type:x.TYPE.primary,onClick:s,size:x.SIZE.xl,block:!0},_("wallet_extension_addaccount_adding_btn_cancel"))):h.default.createElement(h.default.Fragment,null,u!==_t&&h.default.createElement(x,{category:x.CATEGORY.outline,type:x.TYPE.primary,size:x.SIZE.xl,onClick:Nt(gt)(a),block:r},_("wallet_extension_addaccount_adding_btn_download_address")),h.default.createElement(x,{category:x.CATEGORY.fill,type:x.TYPE.highlight,size:x.SIZE.xl,onClick:i,block:r},_("wallet_extension_addaccount_adding_btn_confirm")))),h.default.createElement(d.Box,{className:(0,at.default)(L.tip,!m&&L.hiddenTip)},m?_("wallet_extension_addaccount_adding_text_not_close"):""))}var Qt=Co;function Oo(){let{cancel:e,retry:r,success:n,failed:s,total:a,keyring:i,status:m,onFinish:u}=Kt(),{downloadAddress:p}=It();return S.default.createElement(Z,{hidden:m===l.NONE},S.default.createElement(d.Box,{className:Pt.root},S.default.createElement(qt,{status:m}),S.default.createElement(jt,{status:m,walletName:i?.keyringName}),S.default.createElement(Jt,{status:m,retry:r,total:a,failed:s,success:n}),S.default.createElement(Qt,{status:m,cancel:e,download:p,finish:u})))}var $t=Oo;var ts=()=>R.default.createElement(K.Switch,null,R.default.createElement(K.Route,{path:P,component:vt,exact:!0}),R.default.createElement(K.Route,{path:M,component:$t,exact:!0}));export{ts as default};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "prepub";

//# sourceMappingURL=BatchAddAccount-RPXBBCK5.js.map
