import{h as _e,l as B,t as ye,v as we}from"./chunk-JXVNQTQI.js";import{Ba as Ce,L as K,T as Wt,Z as ge,g as ne,ga as C,i as tt,ia as Et,k as Ct,lb as L,mb as dt,nb as mt,ob as it,pb as ut,qa as F,ra as P,s as Vt,sa as Se,va as $t,wa as Ie,y as Ht}from"./chunk-YMSVZYST.js";import{Ia as me,Kb as vt,M as ae,Sa as _t,Z as de,eb as yt,gc as pe,hb as h,jc as Te,kb as O,kc as fe,lb as Nt,mb as xt,nb as Gt,oc as et,pb as ue,qb as ce,qc as at,rb as le,rc as wt,sb as Ut,sc as A,tb as he,tc as R,wa as Rt,xa as Mt,ya as Bt}from"./chunk-LTVFH3JK.js";import{F as Z}from"./chunk-6MTHEPGF.js";import{D as M,I as se,a as re,b as oe,f as j,v,z as Ft}from"./chunk-ZQQ7HNWV.js";import{a as Xe}from"./chunk-ADZWCU3Q.js";import{f as Qe,h as s,m as E,o as b}from"./chunk-REC7XVZY.js";E();b();se();E();b();var Ti={Failed:"-1",Waiting:"1",Pending:"2",Succeed:"3"},ct={ESTIMATE:1,EXCEED_ESTIMATE:2,UNTIMED:3,TIMEOUT:4},fi={FromIsBtcChain:1,FromIsNotBtcChain:2,FromIsEthChainFacetCoin:3},G={SINGLE_TIPS:1,GAS:2,BRIDGE:3},rt={SINGLE:1,CROSS_FROM_SWAP:2,CROSS_BRIDGE_SWAP:3,CROSS_TO_SWAP:4};E();b();var Ot={SUCCESS:"success",FAIL:"fail",REJECT:"reject",TXHASH:"txhash",APPROVE:"approve",CONNECT:"connect",APP_STATUS:"appStatus",CLOSE:"close"},Je=Object.values(Ot),Yt=class{constructor(){s(this,"toast",!0);s(this,"setToast",t=>{this.toast=t});s(this,"chainList",[]);s(this,"setChainList",t=>{this.chainList=t});s(this,"quote",{});s(this,"updateQuote",t=>{this.quote={...this.quote,...t}});s(this,"portal","");s(this,"setPortal",t=>{this.portal=t||""});s(this,"swapParams",{});s(this,"setSwapParams",({fromAmount:t,...e})=>{this.swapParams={...e,fromAmount:Et(t)?t:"1"}});s(this,"status","");s(this,"reset",()=>{this.to={},this.from={},this.events={},this.swapParams={}});s(this,"on",(t,e)=>{if(!Je.includes(t))return new Error("Not support event!!");if(typeof e!="function")return{};this.events[t]||(this.events[t]=[]);let i=`${t}${this.events[t].length}`;return this.events[t].push({cb:e,eventId:i}),{eventId:i,remove:()=>{this.remove(t,i)}}});s(this,"emit",(t,...e)=>{let i=this.events[t];i&&i.length&&i.forEach(r=>{let{cb:o}=r;o&&o.apply(this,e)})});s(this,"remove",(t,e)=>{let i=this.events[t];i&&e&&i.forEach((r,o)=>{r.eventId===e&&i.splice(o,1)})});s(this,"removeAll",()=>{this.events={}});this.events={}}static init(t){return this.instance||(this.instance=new Yt(t)),this.instance}},bt=Yt;s(bt,"instance",null);var Ze=new bt,qt=Ze;E();b();var lt=Qe(Xe());function ht({type:p,title:t,exploreUrl:e,onURLClick:i,showClose:r}){let o=e?lt.default.createElement(we,{className:"color-959dad",href:e,onClick:i},lt.default.createElement("div",{className:"inline-flex align-items-center"},lt.default.createElement("div",{className:"font-12 color-0569ff font-bold"},C("swaptrade_toast_anchor_view_in_explorer")),lt.default.createElement(ye,{className:"okx-defi-dex-link color-0569ff",size:20}))):void 0,n=5;p==="success"?Z.success({title:t,desc:o,duration:n}):p==="failed"?Z.error({title:t,desc:o,duration:n}):p==="info"?Z.info({title:t,desc:o,duration:n,showClose:r}):p==="expired"?Z.info({title:t,desc:o,duration:n,icon:"okds-clock"}):p==="warn"&&Z.warn({title:t,desc:o,duration:n,showClose:r})}function ot({title:p,exploreUrl:t,onURLClick:e=()=>{}}){ht({type:"success",title:p,exploreUrl:t,onURLClick:e})}function At({title:p,exploreUrl:t,onURLClick:e=()=>{}}){ht({type:"failed",title:p,exploreUrl:t,onURLClick:e})}function zt({title:p,exploreUrl:t,onURLClick:e=()=>{},showClose:i=!0}){ht({type:"info",title:p,exploreUrl:t,onURLClick:e,showClose:i})}function Ee({title:p,exploreUrl:t,onURLClick:e=()=>{}}){ht({type:"expired",title:p,exploreUrl:t,onURLClick:e})}function be({title:p,exploreUrl:t,onURLClick:e=()=>{},showClose:i=!0}){ht({type:"warn",title:p,exploreUrl:t,onURLClick:e,showClose:i})}E();b();var st=class{constructor(t){s(this,"orderId","--");s(this,"chainId","--");s(this,"defiPlatformInfo","--");s(this,"fromAmount","--");s(this,"fromTokenSymbol","--");s(this,"price","--");s(this,"status","--");s(this,"time","--");s(this,"toAmount","--");s(this,"toTokenSymbol","--");s(this,"userWalletAddress","--");s(this,"exploreUrl","--");s(this,"isExchanged",!1);s(this,"swapType","--");s(this,"toChainId","--");Ct(this),Object.assign(this,t)}get computedFromAmount(){return`${R(this.fromAmount,{needPlaceholder:!0,needBillionMillionUnit:!0})}`}get computedToAmount(){return A(this.toAmount)}get computedToNetWorkPath(){let{fromChainName:t,toChainName:e}=this;return t===e?e:`${t} ${C("swaptrade_order_info_label_network_to")} ${e}`}updateFromJson(t){Object.assign(this,t)}toJSON(){return tt(this)}};var{BigNumber:jt}=et,Oe=20,H=[],d={Pending:"0",Failed:"-1",Succeed:"1",Waiting:"100",SpeedingUp:"-4",Canceling:"-3",Canceled:"-2",PendingWithdrawn:"10",PendingCanRedeem:"11",PendingRedeeming:"12"},{Pending:ei,SpeedingUp:ii,Canceling:ri,PendingWithdrawn:oi,PendingCanRedeem:si,PendingRedeeming:ni}=d,ai=[ei,ii,ri,oi,si,ni],c={SingleChain:"1",CrossBridge:"2",CrossChain:"3",FromBridge:"3-1",BridgeTo:"3-2",FromBridgeTo:"3-3",GasStation:"4",GasStationCross:"5",LimitOrder:"6",MemeMode:"7"};var U={from:1,bridge:2,fromSwapTimeout:3},di={FAIL:"-1",NO_SELECTED:"0",WAITING_FOR_FINAL:"1",WAITING_FOR_TRANSFER:"2",TRANSFER_SUCCEED:"3"},{NO_SELECTED:mi,TRANSFER_SUCCEED:ui}=di,ci=10,Ae={curPageNum:1,pageSize:ci,total:0},li={[c.SingleChain]:"swaptrade_order_swap_trade_type_swap",[c.CrossBridge]:"swaptrade_order_swap_trade_type_bridge",[c.CrossChain]:"swaptrade_order_swap_trade_type_cross_chain",[c.GasStation]:"swaptrade_dialog_tab_gasstation",[c.GasStationCross]:"swaptrade_dialog_tab_gasstation",[c.LimitOrder]:"swaptrade_dialog_tab_gasstation",[c.MemeMode]:"swaptrade_history_modal_label_meme_mode"};function W({childOrderId:p,status:t,exploreUrl:e,orderFailReason:i,toastGuideUrl:r,fromTokenIcon:o,fromChainLogoUrl:n,fromAmountIn:a,fromTokenSymbol:m,fromChainName:u,toTokenIcon:g,toChainLogoUrl:l,toAmountOut:_,toTokenSymbol:T,toChainName:S,originalTokenSymbol:I,refundAmount:w,refundSymbol:D,refundChain:k,errorCode:f},y,N={}){let x=y==="from",q=x?a:_,nt=w?A(w):"",X=x?R(a):A(_,{needBillionMillionUnit:!1});N?.useCurrencyInputFormat&&(X=R(q));let J=N?.isMemeModeOrder&&N?.assetDelay&&t===d.Succeed?"999999":f;return{key:`${p}${y}`,status:t,exploreUrl:e,orderFailReason:i,toastGuideUrl:r,originalTokenSymbol:I,fromChainName:u,fromTokenSymbol:m,toChainName:S,chainName:x?u:S,chainLogo:x?n:l,symbol:x?m:T,symbolLogo:x?o:g,amount:q==="-1"?"":X,errorCode:J,refund:{amount:nt,symbol:D,chain:k},...N}}var Kt=class{constructor(t){s(this,"detail",{data:null,loading:!1,error:!1});s(this,"history",{list:[],loading:!1,loadMore:!1,hasMore:!1,error:null,pageInfo:{...Ae},chainId:-1});s(this,"limitHistory",{...this.history});s(this,"limitDetail",{...this.detail});s(this,"pendingOrders",[]);s(this,"modal",{orderId:"",visible:!1});s(this,"expireTime",0);s(this,"fromStepCountDownTimeGroup",{estimatedTime:0,estimatedTimeTotal:0});s(this,"bridgeStepCountDownTimeGroup",{estimatedTime:0,originEstimatedTime:0});s(this,"timeoutTimestamp",0);s(this,"timer",null);s(this,"timeOutTimer",null);s(this,"detailShowSource","");s(this,"showModal",t=>{let e=typeof t=="string"?t:"";this.modal={visible:!0,orderId:e,defaultOrderId:e},this.setHistoryTab(this.commonStore?.currentTab===h.BRIDGE?h.SWAP:this.commonStore?.currentTab)});s(this,"updateModal",t=>{this.modal.orderId=typeof t=="string"?t:""});s(this,"closeModal",()=>{this.modal.visible=!1,this.setDetailShowSource()});s(this,"setDetailShowSource",(t="")=>{this.detailShowSource=t});s(this,"setDetail",t=>{this.detail={...this.detail,...t}});s(this,"setLimitDetail",t=>{this.limitDetail={...this.limitDetail,...t}});s(this,"getStepCountDownTimeGroup",({estimatedTime:t,originEstimatedTime:e,expireTime:i,extraEstimatedTime:r,extraOriginEstimatedTime:o})=>{let n=Math.min(t,i),a=e||t;return this.computedMainOrderType===c.BridgeTo&&(n=t+Math.min(r,i),a+=o),{estimatedTime:n,estimatedTimeTotal:a}});s(this,"setSwapExpireTime",t=>{let e=!this.computedCurrentHistoryTabIsLimit&&Number(t.estimatedTime),i=Number(t.fromEstimatedTime)||0,r=Number(t.bridgeEstimatedTime)||0,o=Number(t.originFromEstimatedTime)||0,n=Number(t.originBridgeEstimatedTime)||0;this.fromStepCountDownTimeGroup=this.getStepCountDownTimeGroup({expireTime:e,estimatedTime:i,originEstimatedTime:o}),this.bridgeStepCountDownTimeGroup=this.getStepCountDownTimeGroup({expireTime:e,estimatedTime:r,originEstimatedTime:n,extraEstimatedTime:i,extraOriginEstimatedTime:o}),this.expireTime=e,this.expireTime>0&&(this.timer=setInterval(()=>{let a=this.computedStepStatus.bridgeStatus,m=this.computedStepStatus.fromSwapStatus,u=this.detail?.data?.status===d.Canceling,g=l=>l===d.SpeedingUp||l===d.Pending;this.expireTime<1?(clearInterval(this.timer),this.bridgeStepCountDownTimeGroup.estimatedTime=0,this.fromStepCountDownTimeGroup.estimatedTime=0):(this.expireTime-=1,this.fromStepCountDownTimeGroup.estimatedTime>0&&g(m)&&!u&&(this.fromStepCountDownTimeGroup.estimatedTime-=1),this.bridgeStepCountDownTimeGroup.estimatedTime>0&&g(a)&&!u&&(this.bridgeStepCountDownTimeGroup.estimatedTime-=1))},1e3))});s(this,"setSwapTimeout",t=>{this.timeOutTimer&&clearInterval(this.timeOutTimer),this.timeoutTimestamp=Date.now()>t?0:t||0,this.timeoutTimestamp>0&&(this.timeOutTimer=setInterval(()=>{Date.now()>this.timeoutTimestamp&&(this.timeoutTimestamp=0,clearInterval(this.timeOutTimer))},1e3))});s(this,"removePendingOrder",t=>{let e=this.pendingOrders,i=e.findIndex(({orderId:o})=>o===t);i>-1&&e.splice(i,1),this.setPendingOrders([...e])});s(this,"updateDetailByData",t=>{let e=this.detail.data,i=r=>r&&{...r,fromAmountIn:r?.fromAmount,toAmountOut:r?.toAmount};if(e&&t&&t.orderId===e.orderId){let{fromChildOrder:r,bridgeChildOrder:o,toChildOrder:n}=t;this.setDetail({data:Wt(e,{...t,fromChildOrderDetailVo:i(r),bridgeChildOrderDetailVo:i(o),toChildOrderDetailVo:i(n)})})}});s(this,"fetchHistory",ne(function*(e={},i=!1){let r=this.accountStore.computedAccountWalletAddressesArray;if(this.computedIsLimitOrSwapLabel.chainId!==-1&&Object.assign(e,{chainId:this.computedIsLimitOrSwapLabel.chainId}),this.computedIsLimitOrSwapLabel.loading||this.computedIsLimitOrSwapLabel.loadMore||K(r))return;this.setSwapOrLimitHistory(i?{loadMore:!0}:{loading:!0});let n=this.rootStore.widgetConfigStore?.getOrdersQueryParams()||{},a={...e,pageSize:this.history.pageInfo.pageSize,accountId:this.accountStore.computedAccountId,...n},m={...e,pageSize:this.limitHistory.pageInfo.pageSize,accountId:this.accountStore.computedAccountId,statusType:Nt.ALL},u=this.computedCurrentHistoryTabIsLimit?m:a,g=this.computedCurrentHistoryTabIsLimit?Ut:ue,[l,_]=yield M(B.get(g,{params:u}));if(this.setSwapOrLimitHistory(i?{loadMore:!1}:{loading:!1}),l){this.setSwapOrLimitHistory({error:l});return}this.setSucResult(_,i)}).bind(this));s(this,"setSucResult",(t,e)=>{let{data:{dataList:i,pageSize:r,totalCount:o,curPageNum:n,maxPageNum:a}}=t,m=e?this.computedIsLimitOrSwapLabel.list.concat(i):i;this.setSwapOrLimitHistory({list:m,pageInfo:{...this.computedIsLimitOrSwapLabel.pageInfo,total:o,pageSize:r,curPageNum:n},hasMore:a>n})});s(this,"updateSwapAndLimitDataList",t=>{this.computedIsLimitOrSwapLabel.list.forEach((e,i)=>{String(e?.orderId)===String(t?.orderId)&&(this.computedIsLimitOrSwapLabel.list[i]={...e,...t})})});s(this,"setChainId",async t=>{this.resetHistoryList(),this.setSwapOrLimitHistory({chainId:t}),await this.fetchHistory()});s(this,"resetHistoryList",()=>{this.setSwapOrLimitHistory({pageInfo:{...Ae},list:[],error:null,loading:!1,loadMore:!1,hasMore:!1,chainId:-1})});s(this,"getLocalPriceFee",(t,e,i=!0)=>{let{symbol:r,usdToThisRate:o}=this.commonStore.nowCurrencyUnit||{};if(t&&e&&o){let n=et.mul(et.mul(t,e),o);return i?`(${wt(n,r)})`:wt(n,r)}return""});s(this,"getDexGasStationFeeDetailTip",(t,e)=>{if(!this.computedIsGasStation||e!==d.Succeed||!t)return"";let{approveTokenAmount:i,gasTokenPriceUSD:r,gasTokenSymbol:o,swapGasFeeAmount:n,transferApproveTokenGasFeeAmount:a}=t||{};return C("swaptrade_swapforgas_tooltips_desc_gasswap_netfee",{value1:this.getLocalPriceFee(i,r,!1),approveFee:A(i),token1:o,value2:this.getLocalPriceFee(a,r,!1),transferFee:A(a),token2:o,value3:this.getLocalPriceFee(n,r,!1),swapFee:A(n),token3:o})});s(this,"emitOrder",t=>{if(t){let{status:e,orderId:i}=t;e===d.Succeed||e===O.SUCCEED?qt.emit(Ot.SUCCESS,{status:0,data:tt(t),message:Ft("transaction success")}):(e===d.Failed||e===O.FAILED)&&qt.emit(Ot.FAIL,{data:{orderId:i},status:-1,message:Ft("transaction fail")})}});s(this,"onSocket",(t,e=!0)=>{(t?.type==="1"||t?.type==="3")&&t?.dexData&&t.dexData.type!=="approve"&&t.dexData.type!=="register"&&(this.updateSwapAndLimitDataList(t.dexData),this.updateSwapAndLimitDetail(t.dexData),this.updateLimitOuterOrderList(t.dexData),this.updatePendingOrdersByData(t.dexData),this.emitOrder(t.dexData),this.toastSwapAndLimitOrder(e,t.dexData))});s(this,"updateSwapAndLimitDetail",t=>{t.swapTradeType!==c.LimitOrder?this.updateDetailByData(t):this.updateLimitDetailByData(t)});s(this,"updateLimitOuterOrderList",t=>{this.commonStore?.computedCurrentTabIsLimit&&this.rootStore.limitOrderListStore.updateLimitOuterListData(t)});s(this,"toastSwapAndLimitOrder",(t,e)=>{t&&!this.commonStore?.computedCurrentTabIsLimit?this.toastOrder(e):t&&this.commonStore?.computedCurrentTabIsLimit&&this.toastLimitOrder(e)});s(this,"onSocketError",async()=>{let{computedAccountId:t}=this.accountStore,{visible:e,orderId:i}=this.modal;if(!e){let[r]=await M(this.updatePendingOrders(t));r&&oe.error("history detail onSocketError",{error:r})}e&&i&&await M(this.updateDetail(i,!0))});s(this,"historyTab","");s(this,"setHistoryTab",t=>{this.historyTab=t});Ct(this,{},{autoBind:!0}),this.rootStore=t,this.commonStore=t.commonStore,this.accountStore=t.accountStore,this.fromToStore=t.fromToStore,this.tokenModalStore=t.tokenModalStore}get computedHistoryList(){return this.history.list.map(t=>new st(tt(t)))}get computedLimitHistoryList(){return this.limitHistory.list.map(t=>new st(tt(t)))}get computedTimeGroup(){let t=this.computedCurrentHistoryTabIsLimit?this.computedLimitHistoryList:this.computedHistoryList,e=this.computedCurrentHistoryTabIsLimit?"createTime":"time";return t.reduce((i,r)=>{let o=i.find(n=>n.time===j(r?.[e],{format:"yyyyMMdd"}));return o?o.list.push(r):i.push({time:j(r?.[e],{format:"yyyyMMdd"}),list:[r]}),i},[])}get noData(){return this.computedCurrentHistoryTabIsLimit?!this.computedLimitHistoryList.length:!this.computedHistoryList.length}setHistory(t){this.history={...this.history,...t}}setLimitHistory(t){this.limitHistory={...this.limitHistory,...t}}setPendingOrders(t){this.pendingOrders=t}fetchDetail(t){return this.computedCurrentHistoryTabIsLimit?B.get(he,{params:{orderId:t}}).then(({data:e})=>e):B.get(ce,{params:{orderId:t}}).then(({data:e})=>e)}fetchPendingOrders(t){let i=this.rootStore.widgetConfigStore?.getOrdersQueryParams()||{};return B.post(le,{accountId:t,...i}).then(({data:r})=>r)}async updatePendingOrders(t){if(re())return;let e;if(this.commonStore?.computedCurrentTabIsLimit){let[,i]=await M(B.get(Ut,{params:{accountId:this.accountStore.computedAccountId,chainId:"",pageNum:1,pageSize:10,statusType:Nt.PENDING}}));e=i?.data?.dataList}else{let[,i]=await M(this.fetchPendingOrders(t));e=i}Array.isArray(e)?this.setPendingOrders(e):this.setPendingOrders([])}updatePendingOrdersByData(t){if(!t)return;let e=this.pendingOrders,i=e.findIndex(({orderId:n})=>n===t.orderId),r=i>-1,o=t.swapTradeType===c.LimitOrder?t.status===O.PENDING:ai.includes(t.status);o?(r&&e.splice(i,1),e.push(t)):!o&&r&&e.splice(i,1),this.setPendingOrders([...e])}async updateDetail(t,e){e||this.setLimitOrSwapDetail({data:null,loading:!0,error:!1});let[i,r]=await M(this.fetchDetail(t));clearInterval(this.timer),i||!r?this.setLimitOrSwapDetail({data:null,error:!0}):(this.setLimitOrSwapDetail({data:r,error:!1}),this.setSwapExpireTime(r),this.setSwapTimeout(Number(r.timeoutTimestamp))),this.setLimitOrSwapDetail({loading:!1})}setLimitOrSwapDetail(t){this.computedCurrentHistoryTabIsLimit?this.setLimitDetail(t):this.setDetail(t)}updateLimitDetailByData(t){let e=this.limitDetail.data,i={data:Wt({},e,{...t})};this.setLimitDetail(i)}get computedIsLimitOrSwapLabel(){return this.computedCurrentHistoryTabIsLimit?this.limitHistory:this.history}setSwapOrLimitHistory(t){this.computedCurrentHistoryTabIsLimit?this.setLimitHistory(t):this.setHistory(t)}get computedIsSingleChain(){return[c.SingleChain,c.GasStation,c.MemeMode].includes(Ht(this,"detail.data.swapTradeType",""))}get computedIsGasStation(){return[c.GasStation,c.GasStationCross].includes(Ht(this,"detail.data.swapTradeType",""))}get computedMainOrderType(){let t=this.detail.data,e="";if(!t)return e;let{swapTradeType:i,hiddenFromOrder:r,toChildOrderDetailVo:o}=t;return i!==c.CrossChain?e=i:r==="1"?e=c.BridgeTo:o?e=c.FromBridgeTo:e=c.FromBridge,e}get computedStepStatus(){let t=this.detail.data,e=r=>r?[d.Waiting,d.Pending].includes(r)?d.Pending:r:"",i=this.computedMainOrderType===c.BridgeTo?e(t?.bridgeChildOrderDetailVo?.status||""):t?.bridgeChildOrderDetailVo?.status||"";return[c.BridgeTo,c.CrossBridge].includes(this.computedMainOrderType)&&[d.Failed,d.Canceled].includes(t?.status)&&(i=t?.status),{fromSwapStatus:e(t?.fromChildOrderDetailVo?.status||""),bridgeStatus:i,toSwapStatus:t?.toChildOrderDetailVo?.status||""}}get computedRatio(){let t=this.detail?.data;if(!t)return{fromRatio:0,bridgeRatio:0};let{status:e}=t,i=this.computedStepStatus.bridgeStatus,r=this.computedStepStatus.fromSwapStatus;if(e===d.Succeed||e===d.Canceled||e===d.Failed&&this.computedMainOrderType===c.BridgeTo)return{fromRatio:1,bridgeRatio:1};let n=(this.fromStepCountDownTimeGroup.estimatedTimeTotal-this.fromStepCountDownTimeGroup.estimatedTime)/this.fromStepCountDownTimeGroup.estimatedTimeTotal;n=n>.8||this.fromStepCountDownTimeGroup.estimatedTimeTotal===0?.8:n;let a=(this.bridgeStepCountDownTimeGroup.estimatedTimeTotal-this.bridgeStepCountDownTimeGroup.estimatedTime)/this.bridgeStepCountDownTimeGroup.estimatedTimeTotal;return a=a>.8||this.bridgeStepCountDownTimeGroup.estimatedTimeTotal===0?.8:a,r!==d.Pending&&r!==d.SpeedingUp&&r!==d.Canceling&&(n=1),this.computedMainOrderType===c.FromBridgeTo&&i!==d.Pending&&i!==d.SpeedingUp&&i!==d.Canceling&&(a=0),i===d.Succeed&&(a=1),{fromRatio:n,bridgeRatio:a}}get computedFoldTipToast(){let t=this.detail?.data;if(!t)return{foldTipType:""};let{bridgeChildOrderDetailVo:e}=t,i=[],r=[],o=!1,n=!1,a=0,m=this.fromStepCountDownTimeGroup.estimatedTime,u=this.bridgeStepCountDownTimeGroup.estimatedTime,g=this.computedMainOrderType===c.FromBridge;this.computedSubOrders.forEach((S,I)=>{(S.tipType===U.from||S.tipType===U.bridge)&&i.push(S),S.errorCode!=="0"&&I<this.computedSubOrders.length-1&&r.push(S)});let l=-1;i.length>0&&(l=i[0]?.tipType),l===U.bridge&&(a=u),l===U.from&&(a=m),g&&l===U.bridge&&(a=0),l===U.from?n=m===0:l===U.bridge&&(n=u===0);let _={...e,refund:{amount:e?.refundAmount?A(e.refundAmount):"",symbol:e?.refundSymbol,chain:e?.refundChain}},T=l===U.bridge?_:i?.[0];return r.length>0&&(T=r[r.length-1],o=!0),{foldTipType:l,currentProcessIsTimeOut:n,tipCountDownTime:a,filterProcessItem:T,needShowErrorTip:o}}get computedSubOrders(){let t=this.detail.data;if(!t)return[];let{fromChildOrderDetailVo:e,bridgeChildOrderDetailVo:i}=t,{toChildOrderDetailVo:r,status:o,assetDelay:n}=t,a=this.computedStepStatus.bridgeStatus,m=this.computedStepStatus.fromSwapStatus,u=this.computedMainOrderType===c.BridgeTo,g=this.computedMainOrderType===c.FromBridgeTo,l=this.computedMainOrderType===c.FromBridge,_=a===d.Pending||a===d.SpeedingUp||this.computedMainOrderType===c.CrossBridge&&o!==d.Failed&&o!==d.Canceled&&o!==d.Succeed||u&&a===d.Waiting?U.bridge:0,T=m===d.Pending||m===d.SpeedingUp?U.from:0,S={bridgeInfo:i?.bridgeOrderInfoVo,dexBridgeShadowTokenPair:i?.dexBridgeShadowTokenPairInfoVo,dexBridgeShadowTokenPairChainId:i?.toChainId,tipInfo:{toTokenSymbol:e?.toTokenSymbol},bridgeTipInfo:{bridgeName:i?.bridgeOrderInfoVo?.bridgeName||"",toChainName:i?.toChainName||""}};e={...e,status:this.computedStepStatus.fromSwapStatus};let I=i?.status;if(i={...i,status:this.computedStepStatus.bridgeStatus},this.computedIsSingleChain||this.computedMainOrderType===c.GasStationCross){let w=!1;this.timeoutTimestamp?w=!this.expireTime&&e.status===d.Pending:w=e.status===d.Pending;let D=this.computedMainOrderType===c.MemeMode;return[W(e,"from",{isFromStart:!0,hasTimeoutTips:w,timeoutType:G.SINGLE_TIPS}),W(e,"to",{...S,hiddenExploreUrl:!0,subOrderType:rt.SINGLE,isMemeModeOrder:D,assetDelay:n})]}else if(this.computedMainOrderType===c.CrossBridge){let w=this.expireTime<1&&(i.status===d.Waiting||i.status===d.Pending);return[W(e,"to",{...S,tipType:_,useCurrencyInputFormat:!0,hasTimeoutTips:w,timeoutType:G[i.status===d.Pending?"BRIDGE":"GAS"]}),W(i,"to",{...S,officialBridgeTime:i?.officialBridgeTime,subOrderType:rt.CROSS_BRIDGE_SWAP})]}else if([c.BridgeTo,c.FromBridge,c.FromBridgeTo].includes(this.computedMainOrderType)){let w=this.expireTime<1&&r?.status===d.Pending,D=!this.fromStepCountDownTimeGroup.estimatedTime&&(e.status===d.Pending||I===d.Waiting),k=!1,f;u&&!this.bridgeStepCountDownTimeGroup.estimatedTime?I===d.Waiting?(k=!0,f=G.GAS):I===d.Pending&&(k=!0,f=G.BRIDGE):g&&e?.status===d.Succeed&&!this.bridgeStepCountDownTimeGroup.estimatedTime&&(i.status===d.Waiting?(k=!0,f=G.GAS):i.status===d.Pending&&(k=!0,f=G.BRIDGE));let y=[W(e,"from",{isFromStart:!0,ratio:this.computedRatio.fromRatio,showProgressBar:!0,tipType:T,hasTimeoutTips:D,timeoutType:G.SINGLE_TIPS,...S}),W(e,"to",{ratio:this.computedRatio.bridgeRatio,tipType:l&&D?0:_,showProgressBar:g||u,countDownTime:!u&&this.fromStepCountDownTimeGroup.estimatedTime,hasTimeoutTips:k,timeoutType:l?G.SINGLE_TIPS:f,...S,subOrderType:rt.CROSS_FROM_SWAP}),W(i,"to",{...S,countDownTime:this.bridgeStepCountDownTimeGroup.estimatedTime,hasTimeoutTips:l?!1:w,timeoutType:G.SINGLE_TIPS,subOrderType:rt.CROSS_BRIDGE_SWAP})];return u&&y.shift(),(u||g)&&y.push(W(r,"to",{subOrderType:rt.CROSS_TO_SWAP})),y}return[]}get computedDataDetail(){return this.computedCurrentHistoryTabIsLimit?this.limitDetail:this.detail}get computedLimitOrderInfo(){if(!this.limitDetail?.data)return null;let{swapTradeType:t,createTime:e,fromChildOrderDetailVO:i,price:r,transactionPrice:o,surplus:n,surplusUsdValue:a,totalGasFee:m,totalGasFeeUsdValue:u,transactionTime:g,exploreUrl:l,expireTime:_,userWalletAddress:T,failureReason:S,status:I,dealWarnTag:w,remainTime:D,timeoutToast:k}=this.limitDetail?.data,{fromTokenSymbol:f,toTokenSymbol:y,fromAmount:N,toAmount:x,fromChainLogoUrl:q,toChainLogoUrl:nt,fromTokenIcon:X,toTokenIcon:J,fromChainName:kt,failureReason:Lt}=i,Dt=[O.CANCELLED,O.EXPIRED,O.SUCCEED,O.FAILED].includes(I),Y=S||Lt,z=R(N),pt=F(x),Tt={fromAmount:1,fromSymbol:f,toAmount:F(o),toSymbol:y},ft={fromAmount:1,fromSymbol:y,toAmount:F(jt(1).div(o).toString()),toSymbol:f},gt={fromAmount:1,fromSymbol:f,toAmount:F(r),toSymbol:y},St={fromAmount:1,fromSymbol:y,toAmount:F(jt(1).div(r).toString()),toSymbol:f};return{type:t,typeKey:"swaptrade_orders_text_limit_order",status:I,isSuccess:I===O.SUCCEED,isFailed:I===O.FAILED,isSupplyFailed:I===O.FAILED&&Y===Gt.NO_SUPPLY,isOtherFailed:I===O.FAILED&&Y!==Gt.NO_SUPPLY&&!!Y,fromTokenGroupLabel:`${ut("-",z)} ${f}`,fromTokenGroupLabelEquation:`${ut("-",z)} ${L(f)}`,toTokenGroupLabel:`${ut("+",pt)} ${y}`,toTokenGroupLabelEquation:`${ut("+",pt)} ${L(y)}`,fromChainLogoUrl:q,fromTokenIcon:X,toChainLogoUrl:nt,toTokenIcon:J,createTime:e?j(e,{format:"yyyyMMddHHmmss"}):"",expireTime:_?j(_,{format:"yyyyMMddHHmmss"}):"",txTime:g?j(g,{format:"yyyyMMddHHmmss"}):"",networksName:kt,networksLogo:q,price:dt(gt),reversePrice:dt(St),priceEquation:mt(gt),reversePriceEquation:mt(St),execPrice:o?dt(Tt):yt,reverseExecPrice:dt(ft),execPriceEquation:o?mt(Tt):yt,reverseExecPriceEquation:mt(ft),fee:m?it({amount:F(m),symbol:f,extra:this.getLocalPriceFee(1,u,!0)}):yt,surplus:n?it({amount:F(n),symbol:y,extra:this.getLocalPriceFee(1,a,!0)}):"",originAddress:T,formatAddress:`${T.substr(0,6)}...${T.substr(T.length-4)}`,exploreUrl:l,fromTokenSymbol:f,failureReason:Y,dealWarnTag:w,remainTime:D,timeoutToast:k,showSwapAgainBtn:Dt}}get computedLimitFromToInfo(){let t=this.limitDetail?.data;if(!t)return null;let{fromChildOrderDetailVO:e,userWalletAddress:i,swapTradeType:r}=t,{fromChainId:o,fromTokenContractAddress:n,toChainId:a,toTokenContractAddress:m}=e;return{apiRequestParams:{fromChainId:o,toChainId:a,userWalletAddress:i,swapTradeType:r},locationParams:{from:{chainId:o,tokenContractAddress:n},to:{chainId:a,tokenContractAddress:m}}}}get computedSwapFromToInfo(){let t=this.detail?.data;if(!t)return null;let{fromChainId:e,fromTokenAddress:i,toChainId:r,toTokenAddress:o,swapTradeType:n,from:a}=t;return{apiRequestParams:{fromChainId:e,toChainId:r,userWalletAddress:a,swapTradeType:n},locationParams:{from:{chainId:e,tokenContractAddress:i},to:{chainId:r,tokenContractAddress:o},inputAmount:this.computedIfSwapFailedAmount||ae}}}get computedFromToInfo(){return this.computedCurrentHistoryTabIsLimit?this.computedLimitFromToInfo:this.computedSwapFromToInfo}getForRefuelFromPrice(t){return t&&!at(t)?A(t):"--"}getReceiveTokenPrice(t){return t&&!at(t)?A(t):"--"}getExplorerUrl(t){return this.computedIsSingleChain?t?.exploreUrl:""}getOrderFinnishedTime(t,e,i){return[d.Succeed].includes(i)?Se(e-t):"--"}getIsIntentOrder(t){return t!==de&&t}getFormattedNetworkFee(t){return t?A(t):""}getFormattedOtherFees(t){return t?A(t):""}getOtherFees(t,e){return t&&e?.fromTokenSymbol?`${t} ${e.fromTokenSymbol}`:""}getBridgeFee(t,e){return t?`${t} ${e?.toTokenSymbol}`:""}getBridgeFeeUsd(t,e,i){return Ie(t(e).toString(),i)}getEstimateBridgeFeeAmount(t,e){return t?`${A(t)} ${e}`:""}getEstimateBridgeFeeAmountUsd(t,e,i){return t?wt(i(t).toString(),e):""}getToSwapFee(t,e,i,r){return t?it({amount:t,symbol:e,extra:this.getLocalPriceFee(i,r)}):""}getFromToPrice(t){return t&&!at(t)&&t!=="-1"?A(jt("1").div(t).toString(10)):"--"}getToFromPrice(t){return t&&!at(t)&&t!=="-1"?A(t):"--"}getGasToken(t,e,i,r,o){return!t||t===mi?null:{amount:e,symbol:i,status:t,exploreUrl:r,logoUrl:o}}get computedOrderInfo(){if(!this.detail.data)return null;let{swapTradeType:t,time:e,fromChainName:i,fromChainLogoUrl:r,fromChildOrderDetailVo:o,toChainName:n,toChainLogoUrl:a,networkFee:m,nativeTokenSymbol:u,otherFees:g,from:l,forRefuelFromAmount:_,fromTokenSymbol:T,toTokenSymbol:S,bridgeChildOrderDetailVo:I,receiveTokenStatus:w,receiveTokenExploreUrl:D,receiveTokenAmount:k,receiveTokenSymbol:f,abnormalStatus:y,hiddenFromOrder:N,bridgeFee:x,bridgeFeeUsd:q,estimateBridgeFeeAmount:nt,estimateBridgeFeeAmountUsd:X,toSwapFee:J,toChainNativeTokenSymbol:kt,hiddenOtherFee:Lt,toChildOrderDetailVo:Dt,price:Y,receiveWalletAddress:z,gasStationActivityReward:pt,fromGasTokenPriceUsd:Tt,toGasTokenPriceUsd:ft,receiveTokenLogoUrl:gt,errorCode:St,status:It,orderCompletionTime:De,orderId:Pe,specialOrderType:Fe,mevInfo:Re,fromSwapMevInfo:Me,toSwapMevInfo:Be,intentCode:Ne,assetDelay:xe,assetDelayTime:Ge,isMemeTimeOut:Ue,totalSlippage:ve,dexGasStationFeeDetailVO:Pt}=this.detail.data,{currencyConversion:Qt,computedNowCurrencySymbol:Xt}=this.commonStore,Jt=[{chainName:i,chainLogo:r}];this.computedIsSingleChain||Jt.push({chainName:n,chainLogo:a});let Zt=this.getFormattedNetworkFee(m),Ve=this.getFormattedOtherFees(g),He=$t(x),We=$t(J),te=t===c.MemeMode,$e=[d.Succeed,d.Failed,d.Canceled].includes(It),qe=![c.GasStation,c.GasStationCross].includes(t),Ye=$e&&qe&&!te&&!_e(),ze=()=>{if(this.computedIsGasStation&&Pt){let{gasTokenSymbol:je,gasTokenPriceUSD:Ke,totalGasFeeAmount:ee}=Pt||{},ie=A(ee);return ie?it({amount:ie,symbol:je,extra:this.getLocalPriceFee(ee,Ke)}):"--"}return Zt?it({amount:Zt,symbol:u,extra:this.getLocalPriceFee(m,this.computedIsGasStation?"":Tt)}):"--"};return{isSingleChain:this.computedIsSingleChain,type:t,typeKey:li[t],time:j(e,{format:"yyyyMMddHHmmss"}),networks:Jt,assetDelay:xe,assetDelayTime:Ge,isMemeTimeOut:Ue,isMemeModeOrder:te,networkFee:ze(),otherFees:this.getOtherFees(Ve,I),bridgeFee:this.getBridgeFee(He,I),bridgeName:I?.bridgeOrderInfoVo?.bridgeName,bridgeFeeUsd:this.getBridgeFeeUsd(Qt,q,Xt),estimateBridgeFeeAmount:this.getEstimateBridgeFeeAmount(nt,u),estimateBridgeFeeAmountUsd:this.getEstimateBridgeFeeAmountUsd(X,Xt,Qt),toSwapFee:this.getToSwapFee(We,kt,J,ft),fromToPrice:this.getFromToPrice(Y),toFromPrice:this.getToFromPrice(Y),from:l,receiveWalletAddress:z,fromSymbol:T,toSymbol:S,omittedFrom:`${l.substr(0,6)}...${l.substr(l.length-4)}`,omittedTo:`${z.substr(0,6)}...${z.substr(z.length-4)}`,gasToken:this.getGasToken(w,k,f,D,gt),abnormalStatus:y,hiddenFromOrder:N,hiddenOtherFee:Lt,hasToChildOrderDetailVo:!!Dt,forRefuelFromPrice:this.getForRefuelFromPrice(_),receiveTokenPrice:this.getReceiveTokenPrice(k),receiveTokenStatus:w,gasStationActivityReward:pt,exploreUrl:this.getExplorerUrl(o),errorCode:St,orderFinishedTime:this.getOrderFinnishedTime(e,De,It),status:It,showSwapAgainBtn:Ye,orderId:Pe,fromChainName:i,specialOrderType:Fe,mevInfo:Re,fromSwapMevInfo:Me,toSwapMevInfo:Be,isIntentOrder:this.getIsIntentOrder(Ne),totalSlippage:ve,dexGasStationFeeDetailTips:this.getDexGasStationFeeDetailTip(Pt,It)}}get computedPendingOrdersCount(){return this.pendingOrders.filter(e=>e.status!==d.PendingCanRedeem).length}get computedOrdersHasFacetSwap(){let t=this.pendingOrders.find(e=>e.status==d.PendingCanRedeem);return{showTip:!!t,data:t||{}}}get computedPendingTimingStatus(){return this.timeoutTimestamp?this.expireTime!==0&&this.timeoutTimestamp?ct.ESTIMATE:!this.expireTime&&this.timeoutTimestamp?ct.EXCEED_ESTIMATE:!this.expireTime&&!this.timeoutTimestamp?ct.TIMEOUT:1:ct.TIMEOUT}toastOrder(t){if(t){let{status:e,orderId:i,fromAmount:r,fromTokenSymbol:o,toAmount:n,toTokenSymbol:a,fromChildOrder:m,receiveTokenStatus:u,type:g,swapTradeType:l,isMemeTimeOut:_,exploreUrl:T,assetDelay:S}=t,I=`${i}_${e}`;if(me()||H.includes(I))return;let w=l===c.MemeMode,D=()=>{H.unshift(I),H=H.slice(0,Oe)},k=u!==ui;if(e===d.Pending&&m?.status===d.Pending){if(D(),w&&_){be({title:C("swaptrade_history_modal_error_likely_fail",{num:r,token1:o,token2:a})});return}ot({title:C("wallet_swap_toast_swap_submitted")})}else if(e===d.Succeed&&k){let f=this.computedSubOrders;if(D(),w&&S){ot({title:C("swaptrade_history_modal_tips_swap_update",{num1:r,token1:o,num2:n,token2:a}),exploreUrl:T});return}ot({title:C("swaptrade_toast_swap_success",{fromCount:R(r,{needBillionMillionUnit:!0}),fromToken:L(o),toCount:A(n),toToken:L(a)}),exploreUrl:f[f.length-1]?.exploreUrl})}else if(e===d.Failed&&k){let y=this.computedSubOrders.filter(N=>N.status===d.Failed);D(),At({title:g==="gasStation"?C("swaptrade_gasstation_toast_refill_failed",{nativeToken:L(a)}):C("wallet_swap_toast_swap_failed"),exploreUrl:y[y.length-1]?.exploreUrl})}else e===d.Canceled&&k&&(ot({title:C("swaptrade_placeorder_toast_transaction_canceled")}),D())}}toastLimitOrder(t){if(t){let{status:e,orderId:i,fromChildOrderDetailVO:r,failureReason:o}=t,{fromAmount:n,fromTokenSymbol:a,toAmount:m,toTokenSymbol:u,failureReason:g,exploreUrl:l}=r,_=`${i}_${e}`;if(H.includes(_))return;let T=()=>{H.unshift(_),H=H.slice(0,Oe)};e===O.OPEN?(T(),zt({title:C("swaptrade_orders_notif_limitorder_submitted",{sellValue:R(n,{needBillionMillionUnit:!0}),sellToken:L(a),receiveValue:F(m),receiveToken:L(u)})})):e===O.SUCCEED?(T(),ot({title:C("swaptrade_orders_notif_limitorder_success",{sellValue:R(n,{needBillionMillionUnit:!0}),sellToken:a,receiveValue:F(m),receiveToken:u}),exploreUrl:l})):e===O.FAILED&&o?(T(),At({title:C("swaptrade_orders_notif_limitorder_failed",{sellValue:R(n,{needBillionMillionUnit:!0}),sellToken:L(a),receiveValue:F(m),receiveToken:L(u)})})):e===O.FAILED&&g?(T(),At({title:C("swaptrade_orders_notif_limitorder_failed",{sellValue:R(n,{needBillionMillionUnit:!0}),sellToken:L(a),receiveValue:F(m),receiveToken:L(u)}),exploreUrl:l})):e===O.CANCELLED?(zt({title:C("swaptrade_orders_notif_limitorder_canceled",{sellValue:R(n,{needBillionMillionUnit:!0}),sellToken:L(a),receiveValue:F(m),receiveToken:L(u)})}),T()):e===O.EXPIRED&&(Ee({title:C("swaptrade_orders_notif_limitorder_expired",{sellValue:R(n,{needBillionMillionUnit:!0}),sellToken:L(a),receiveValue:F(m),receiveToken:L(u)}),exploreUrl:l}),T())}}get computedCurrentHistoryTabIsLimit(){return this.historyTab===h.LIMIT_ORDER}get computedOrigin(){return this.historyTab===h.LIMIT_ORDER?h.LIMIT_ORDER:[c.SingleChain,c.GasStation].includes(this.computedMainOrderType)?h.SWAP:h.BRIDGE}get computedIfSwapFailedAmount(){let t=this.detail?.data;return t?.status===d.Failed&&!this.computedCurrentHistoryTabIsLimit&&Et(t?.fromAmount)?t.fromAmount:""}},Zi=Kt;E();b();var or="",sr="hide_detail_alert";E();b();se();E();b();function ke(p){return![...Object.values(p?.from||{}),...Object.values(p?.to||{})].some(t=>t)}E();b();var Cr=(p,t)=>!!p.find(i=>Number(t)===Number(i.chainId)),Le=p=>{if(!p)return!1;let{fromChainId:t,toChainId:e,fromTokenAddress:i,toTokenAddress:r}=p,o=[P(t)&&i,P(e)&&r];return!!ge(o,Boolean)};var pi=()=>({from:{chainId:null,tokenContractAddress:null},to:{chainId:null,tokenContractAddress:null}}),Rr={BRIDGE:"bridge",SWAP:"swap"},Q=class{constructor(t,e,i={}){s(this,"setTab",t=>{this.tab=t});s(this,"hasFromToToken",t=>this.tab===h.LIMIT_ORDER?!K(t?.data?.fromToken)&&!K(t?.data?.toToken):!K(t?.data?.fromTokenInfo)&&!K(t?.data?.toTokenInfo));s(this,"getWidgetVersionParams",()=>!this.config.widgetVersion||this.tab===h.LIMIT_ORDER?{}:this.tab===h.BRIDGE?{widgetVersion:this.config.widgetVersion}:{widgetVersion:this.config.widgetVersion,widgetChainIds:this.config.widgetChainIds});s(this,"fetchSingleChainTokens",async({fromTokenAddress:t,toTokenAddress:e,chainId:i})=>{let[r,o]=await M(B.get(pe,{params:{fromTokenAddress:t,toTokenAddress:e,chainId:i,...this.getWidgetVersionParams()}}));return[r,o]});s(this,"generateSingleChainTokenPair",async({walletChainId:t,...e})=>{let r={chainId:P(e.fromChainId)?e.fromChainId:e.toChainId,fromTokenAddress:e.fromTokenAddress,toTokenAddress:e.toTokenAddress};if(P(r.chainId)){let[a,m]=await this.fetchSingleChainTokens(r);if(!a&&this.hasFromToToken(m))return[a,m]}if(P(t)){let[a,m]=await this.fetchSingleChainTokens({chainId:t});if(!a&&this.hasFromToToken(m))return[a,m]}let[o,n]=await this.fetchSingleChainTokens({chainId:_t});return[o,n]});s(this,"fetchCrossChainTokens",async({fromChainId:t,toChainId:e,fromTokenAddress:i,toTokenAddress:r})=>{let[o,n]=await M(B.get(vt,{params:{chainId:t,toChainId:e,fromTokenAddress:i,toTokenAddress:r,...this.getWidgetVersionParams()}}));return[o,n]});s(this,"generateCrossChainTokenPair",async({walletChainId:t,...e})=>{if(P(e.fromChainId)||P(e.toChainId)){let o={...e},{hasFrom:n,hasTo:a}=Q.checkTokenParams({chainId:e.fromChainId,tokenContractAddress:e.fromTokenAddress},{chainId:e.toChainId,tokenContractAddress:e.toTokenAddress});Ce(e.fromChainId,e.toChainId)&&(n?o={fromChainId:e.fromChainId,fromTokenAddress:e.fromTokenAddress}:a&&(o={toChainId:e.toChainId,toTokenAddress:e.toTokenAddress}));let[m,u]=await this.fetchCrossChainTokens(o);if(!m&&this.hasFromToToken(u))return[m,u]}if(P(t)){let[o,n]=await this.fetchCrossChainTokens({fromChainId:t});if(!o&&this.hasFromToToken(n))return[o,n]}let[i,r]=await this.fetchCrossChainTokens({fromChainId:_t});return[i,r]});s(this,"fetchLimitOrderRecommendTokens",async({fromChainId:t,toChainId:e,fromTokenAddress:i,toTokenAddress:r})=>{let[o,n]=await M(B.get(Te,{params:{fromChainId:t,toChainId:e,fromTokenAddress:i,toTokenAddress:r}}));return[o,n]});s(this,"generateLimitOrderTokenPair",async({walletChainId:t,...e})=>{let i=P(e.fromChainId),o=P(e.toChainId)?e.fromChainId===e.toChainId:!0;if(i&&o){let[m,u]=await this.fetchLimitOrderRecommendTokens(e);if(!m&&this.hasFromToToken(u))return[m,u]}if(P(t)){let[m,u]=await this.fetchLimitOrderRecommendTokens({fromChainId:t});if(!m&&this.hasFromToToken(u))return[m,u]}let[n,a]=await this.fetchLimitOrderRecommendTokens({fromChainId:_t,fromTokenAddress:""});return[n,a]});s(this,"getTokenPairByResponseData",t=>this.tab===h.LIMIT_ORDER?{from:t?.fromToken,to:t?.toToken}:{from:t?.fromTokenInfo,to:t?.toTokenInfo});s(this,"generateTokenAndTabConfig",({error:t,data:e})=>{if(t)return{error:t,from:null,to:null,tab:this.tab};let{from:i,to:r}=this.getTokenPairByResponseData(e);return{error:null,from:i,to:r,tab:this.tab}});s(this,"checkInputAmount",t=>{let e=et.BigNumber(t);return!e.isNaN()&&e.isFinite()&&e.gt(0)?e.toString():""});s(this,"generateInitConfigByParams",async({from:t,to:e,inputAmount:i,walletChainId:r})=>{let o=this.checkInputAmount(i),n={fromChainId:t.chainId,toChainId:e.chainId,fromTokenAddress:t.tokenContractAddress,toTokenAddress:e.tokenContractAddress,walletChainId:r};if(this.tab===h.BRIDGE){let[a,m]=await this.generateCrossChainTokenPair(n);return{...this.generateTokenAndTabConfig({error:a,data:m.data}),inputAmount:o}}if(this.tab===h.SWAP){let[a,m]=await this.generateSingleChainTokenPair(n);return{...this.generateTokenAndTabConfig({error:a,data:m.data}),inputAmount:o}}if(this.tab===h.LIMIT_ORDER){let[a,m]=await this.generateLimitOrderTokenPair(n);return{...this.generateTokenAndTabConfig({error:a,data:m.data}),inputAmount:o}}return{error:new Error("tab is not valid"),from:null,to:null,tab:this.tab,inputAmount:o}});this.setTab(t),this.dexParams=e,this.config=i}makeDexParams(){let{dexParams:t}=this;return ke(t)?this.readInfoFromLocalStorage():t}async initTokenPair(t){let e=this.makeDexParams(),{from:i,to:r,tab:o,inputAmount:n,error:a}=await this.generateInitConfigByParams({...e,walletChainId:t});return{from:i,to:r,tab:o,inputAmount:n,error:a}}async switchTabAndInitToken(t){let e=this.makeDexParams(),{from:i,to:r,tab:o,inputAmount:n,error:a}=await this.generateInitConfigByParams({...e,tab:t});return{from:i,to:r,tab:o,inputAmount:n,error:a}}readInfoFromLocalStorage(){let t=pi(),e;switch(this.tab){case h.SWAP:e=v.get(Rt);break;case h.BRIDGE:e=v.get(Mt);break;case h.LIMIT_ORDER:e=v.get(Bt)||v.get(xt)?.LIMIT_ORDER;break;default:break}let i={from:{...t.from,...e?.from},to:{...t.to,...e?.to}};return e?.from?.tokenContractAddress?i:t}writeTabInfoToLocalStorage(t){switch(this.tab){case h.SWAP:v.set(Rt,t);break;case h.BRIDGE:v.set(Mt,t);break;case h.LIMIT_ORDER:v.set(Bt,t);break;default:break}}},$=Q;s($,"checkTokenParams",(t,e)=>{let i=Le({fromChainId:t?.chainId,toChainId:e?.chainId,fromTokenAddress:t?.tokenContractAddress,toTokenAddress:e?.tokenContractAddress}),r=P(t?.chainId)&&!!t?.tokenContractAddress,o=P(e?.chainId)&&!!e?.tokenContractAddress;return{isValid:i,hasFrom:r,hasTo:o}}),s($,"judgeTabTypeByChainId",async t=>{let[e,i]=await M(B.get(fe));if(e)return h.SWAP;let{swap:r=[],bridge:o=[]}=i.data;return r.includes(Vt(t))?h.SWAP:o.includes(Vt(t))?h.BRIDGE:h.SWAP}),s($,"judgeTabTypeByParams",async(t,e)=>{let{isValid:i,hasFrom:r,hasTo:o}=Q.checkTokenParams(t,e);if(!i)return h.SWAP;let n=t?.chainId,a=e?.chainId;if(r&&o)return n===a?h.SWAP:h.BRIDGE;let m;return r&&!o&&(m=n),!r&&o&&(m=a),await Q.judgeTabTypeByChainId(m)}),s($,"formatDialogParams",t=>({from:{chainId:t?.fromChainId,tokenContractAddress:t?.fromTokenAddress},to:{chainId:t?.toChainId,tokenContractAddress:t?.toTokenAddress}})),s($,"getDialogInitTab",async t=>{let{from:e,to:i}=Q.formatDialogParams(t);return await Q.judgeTabTypeByParams(e,i)});var Mr=$;export{Cr as a,Rr as b,Mr as c,Ti as d,ct as e,fi as f,G as g,rt as h,Ot as i,qt as j,ot as k,At as l,zt as m,d as n,c as o,U as p,Zi as q,or as r,sr as s};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "prepub";

//# sourceMappingURL=chunk-3B2A66XQ.js.map
