import{a as Se}from"./chunk-AWNYZZYN.js";import"./chunk-KEYDXKLJ.js";import{a as Te}from"./chunk-QJYMCODD.js";import{a as ge}from"./chunk-MYKMM3H4.js";import{a as de}from"./chunk-66GXWB2E.js";import{a as pe}from"./chunk-TU2674H5.js";import"./chunk-UMBG4UN5.js";import{a as ue,b as fe}from"./chunk-LEWA7IEW.js";import{a as ie}from"./chunk-NTDPB2D3.js";import{a as ae,b as me}from"./chunk-5N5OIY46.js";import{d as ce,g as le}from"./chunk-KZUQM6PE.js";import{a as ne}from"./chunk-3G5IAADG.js";import"./chunk-Q7EMQCH4.js";import"./chunk-TAIMVZA3.js";import{k as oe}from"./chunk-XHGDRCKN.js";import"./chunk-MJY6W4GC.js";import"./chunk-5KKHZTOM.js";import"./chunk-EKXTRWYR.js";import"./chunk-CP4V5WQH.js";import"./chunk-HTDEED7X.js";import"./chunk-JXXKPVB7.js";import"./chunk-3LOAATWV.js";import{a as re}from"./chunk-OR3IMHNP.js";import"./chunk-G2LUKHAZ.js";import"./chunk-BITK2ZRS.js";import{a as P}from"./chunk-FC47KHHQ.js";import"./chunk-NWBT27VI.js";import"./chunk-ERRJFVON.js";import"./chunk-AGNEMUCC.js";import"./chunk-SFY37WOS.js";import"./chunk-7GRBMPLB.js";import"./chunk-H2MP374E.js";import"./chunk-JFCE4WMN.js";import"./chunk-2CQDB45Y.js";import"./chunk-TCY2QN26.js";import"./chunk-TAMFXRQS.js";import"./chunk-SWNKITDG.js";import"./chunk-PCT6WF3F.js";import"./chunk-7G3IOU2S.js";import"./chunk-FSSAJWUE.js";import"./chunk-EYUJFPID.js";import"./chunk-QXSGLFJ4.js";import"./chunk-LTVFH3JK.js";import"./chunk-UX45LV4J.js";import"./chunk-S2L2SUZT.js";import"./chunk-WAOH7NV4.js";import{e as z,g as te}from"./chunk-Z7MVEL6Q.js";import"./chunk-EQQ4TY26.js";import"./chunk-BSJ5U7SB.js";import"./chunk-RQ4URFJV.js";import"./chunk-A7QDOMG2.js";import"./chunk-PCN4TJH3.js";import"./chunk-UV4CBWDM.js";import"./chunk-JZYFGUUR.js";import"./chunk-55MBPFME.js";import"./chunk-ITV6J4J2.js";import"./chunk-E4R5GU2A.js";import"./chunk-W5VVGPTJ.js";import"./chunk-CQGRSH3C.js";import"./chunk-V2WVG2S2.js";import"./chunk-6JC2JFPK.js";import"./chunk-3OA7XW3I.js";import"./chunk-DJZDNU23.js";import"./chunk-YFG3KJV4.js";import"./chunk-QAD7XKBR.js";import"./chunk-FSHQROIB.js";import"./chunk-RSZRDNEQ.js";import"./chunk-LWWOGE47.js";import"./chunk-PNKC4I7V.js";import"./chunk-OBDMMZ5P.js";import"./chunk-AWV3UGPG.js";import"./chunk-ZFY6KTVJ.js";import"./chunk-LQ6EG3M7.js";import"./chunk-EFXUUWZM.js";import"./chunk-SXT2HSEA.js";import"./chunk-X6MJ7FAJ.js";import"./chunk-4QGZMEGU.js";import"./chunk-JGVOOQUI.js";import{a as se}from"./chunk-OL5PZGTP.js";import"./chunk-T6BAWHSV.js";import"./chunk-NZFRZUU7.js";import"./chunk-GKPU7ZYD.js";import"./chunk-IY5XPXLD.js";import"./chunk-N6T7YZKN.js";import"./chunk-CE2I3GSK.js";import"./chunk-SPMBQ3GG.js";import"./chunk-W3BHXSAD.js";import"./chunk-KWEOQTFQ.js";import"./chunk-MYLTZKPJ.js";import"./chunk-RAK5MQVM.js";import{c as ee}from"./chunk-ILYGYWTN.js";import"./chunk-HOK5U34D.js";import"./chunk-XPB5VA3I.js";import"./chunk-XSNWL3NI.js";import"./chunk-IOMWHGY3.js";import"./chunk-EDYYUNM2.js";import"./chunk-FOI3TQUA.js";import"./chunk-Y3W2FGGC.js";import"./chunk-6SKAHEOE.js";import"./chunk-QYGNKIL6.js";import"./chunk-WWF4GAYE.js";import"./chunk-YITM3H6Z.js";import"./chunk-IQFXZKFW.js";import"./chunk-7BFUGHAL.js";import"./chunk-JVN7YJ6W.js";import"./chunk-VSX7BSN7.js";import"./chunk-V4V6C6NY.js";import"./chunk-ZQ5A3KPQ.js";import"./chunk-BGUY7SH3.js";import"./chunk-MJYAUOKI.js";import"./chunk-LI3NFLG3.js";import"./chunk-FCCCJLF6.js";import"./chunk-4Z4GXCHB.js";import"./chunk-FK3ETA6I.js";import"./chunk-UX2SYDH6.js";import"./chunk-MNKHROKM.js";import{E as y,aa as _}from"./chunk-QZDHFNHK.js";import"./chunk-6KPQELH2.js";import"./chunk-EJQOS3F4.js";import"./chunk-F2C2DYTN.js";import"./chunk-LHHZ5TAA.js";import"./chunk-PI6QLVMS.js";import"./chunk-QY4HIIR3.js";import"./chunk-XFWUEPSK.js";import"./chunk-MNNY2ODL.js";import{e as v}from"./chunk-VCAWL4NW.js";import"./chunk-XVIU24G2.js";import"./chunk-2LDYLNUY.js";import"./chunk-KCITCUTL.js";import"./chunk-YZ3HCB4K.js";import"./chunk-EZ7VUFME.js";import"./chunk-T2OWRX3Y.js";import"./chunk-C3FJ2D4V.js";import{i as Z}from"./chunk-C5ZJZEPI.js";import"./chunk-LGHM3MOC.js";import"./chunk-2FULUWWG.js";import"./chunk-SLEUZTBQ.js";import"./chunk-4X6ZAX3L.js";import"./chunk-4QSQKIBZ.js";import"./chunk-OXVQDEZW.js";import"./chunk-X3G52GGX.js";import"./chunk-WUKT6J7S.js";import"./chunk-FTJCOLFJ.js";import{Kb as $,kb as Y,m as J,pb as X,rb as U}from"./chunk-QG673PNL.js";import"./chunk-ZUFARSFM.js";import{c as Q}from"./chunk-6MTHEPGF.js";import{I as j,m as K,w as W}from"./chunk-ZQQ7HNWV.js";import"./chunk-Y62GSKHT.js";import"./chunk-2BXFMFMK.js";import"./chunk-ZOQTSYT4.js";import{a as w}from"./chunk-ADZWCU3Q.js";import"./chunk-AXQY4CD5.js";import"./chunk-ZPRPROG4.js";import"./chunk-FDI7TLXH.js";import"./chunk-L4HTIIR6.js";import"./chunk-733NI6T7.js";import"./chunk-5TB3ZTAO.js";import"./chunk-LJMQYMIY.js";import"./chunk-KLGATC6G.js";import"./chunk-EYWGNJVY.js";import"./chunk-PIGJQYQ3.js";import"./chunk-EWYZZSY3.js";import"./chunk-7K7BCLRD.js";import"./chunk-WELSRPTB.js";import"./chunk-7TSJ7C24.js";import"./chunk-DW2DZMT3.js";import"./chunk-C672KFBI.js";import"./chunk-YSXN7JDZ.js";import"./chunk-TBVIGR5T.js";import"./chunk-FHQVMQUK.js";import"./chunk-XNS2NFYY.js";import{f as C,m as d,o as g}from"./chunk-REC7XVZY.js";d();g();var q=C(w());d();g();var L=C(w());j();d();g();var Ee=C(w()),H=C(J());d();g();var m=C(w());$();function we({coinId:e,transactions:r,address:s,replace:n,disabled:F,unitLimits:u,signInfo:o}){let[E,x]=(0,m.useState)(0),[f,i]=(0,m.useState)(null),[R,p]=(0,m.useState)([]),[c,S]=(0,m.useState)("0"),[t,a]=(0,m.useState)(!1),T=f?.fee||"0",[N,b]=(0,m.useState)(r),A=de(),G=z(e),{disabledSignInfo:D=!1,disabledPreExecute:B=!1}=F||{},I=O=>{x(O?l=>l+1:l=>l-1)};return(0,m.useEffect)(()=>{u&&p(u)},[u]),(0,m.useEffect)(()=>{o&&i(o)},[o]),(0,m.useEffect)(()=>{(async function(){if(!(D||!e)){I(!0);try{let{data:l={}}=await ee({coinId:e,address:s}),{info:k={}}=l;i(k),a(!1)}catch{a(!0)}finally{I(!1)}}})()},[s,e,D]),(0,m.useEffect)(()=>{(async function(){if(!(B||!e)&&!(!n||!G?.chainId)){I(!0);try{let l=await A({coinId:e,from:s,chainId:G.chainId,simulateTransactionParamList:r.map(({serializedMessage:k})=>({transaction:k,sigVerify:!1,replaceRecentBlockhash:!0}))});p(l.unitLimits),a(!1)}catch{a(!0)}finally{I(!1)}}})()},[...r,n,s,G?.chainId,B,e]),(0,m.useEffect)(()=>{(async function(){if(!(n&&(!f||!R?.length))){I(!0);try{let l=r;n&&(l=await Promise.all(l.map(async(V,Ne)=>{let{serializedMessage:_e,...Le}=V,Ie=await fe(_e,f.computeUnitPrice,R[Ne]);return{...Le,serializedMessage:Ie}})));let k=await ue(l.map(({serializedMessage:V})=>V));S(k),b(l)}finally{I(!1)}}})()},[...r,n,f,R]),{loading:E>0,baseFee:T,priorityFee:c,totalFee:Y(T,c),signInfo:f,estimateFailed:t,replacedTransactions:N}}var Fe=we;$();var Pe=({unapproved:e,coinId:r,preExecuteResult:s})=>{let{address:n}=P(e),{loading:F,preExecuteRet:u}=s,o=u?.[_.TX_ANALYZE]||{},E=(o.simulateTransactionResultList||[]).find(A=>(0,H.isNil)(A?.unitGasLimit)||U(A?.unitGasLimit,"0")),x=(0,Ee.useMemo)(()=>(o.simulateTransactionResultList||[]).map(A=>A?.unitGasLimit),[o.simulateTransactionResultList]),{loading:f,totalFee:i,estimateFailed:R,signInfo:p,replacedTransactions:c}=Fe({coinId:r,transactions:e?.params?.message||[],address:n,replace:!0,unitLimits:x,disabled:{disabledPreExecute:!0}}),S=p?.solRent||"0",t=R||!F&&!!E,a=te(r,e.walletId)?.coinAmountInt,T=(0,H.isNil)(a)||X(a,i)||F,N=(0,H.isNil)(a)||X(a,Y(i,S))||F;return{loading:f,networkFeeProps:{loading:f,networkFee:i,estimateFailed:t,coinId:r},isSufficientGas:T,networkFee:i,estimateFailed:t,estimateFailedMsg:E?.msg,isSufficientBalance:N,selfRent:S,replacedTransactions:c}},xe=Pe;d();g();var Re=C(J());j();var h=C(w());var Ge=({unapproved:e})=>{let r=re(),[s,n]=(0,h.useState)(!1),{host:F}=ne(e),u=P(e),[o,E]=(0,h.useState)({}),x=e?.params?.message||[],f=(0,h.useCallback)(async p=>{let{chainId:c,coinId:S}=p;try{n(!0);let t=await r({checkTypes:[_.TX_ANALYZE,_.KYS],from:u.address,chainId:c,domain:F,coinId:S,bizLine:6,simulateTransactionParamList:x.map(a=>({transaction:a.serializedMessage,sigVerify:!1,replaceRecentBlockhash:!0}))});E(t)}catch(t){console.log(t)}finally{n(!1)}},[F,x.length,r,u.address]),i=(0,h.useMemo)(()=>{let p=o?.[_.TX_ANALYZE]||{},c=p.simulateTransactionResultList,S=c?.length;if((0,Re.isArray)(c)&&S>0){if(S===1)return c[0];let t={};if(c.every(T=>!T.result)){t.result=!1,t.msg=W("wallet_extension_transaction_text_thirdparty_contract_failed");let T=c.some(N=>N.addFundsFlag);t.addFundsFlag=T,t.resultCode=T?se:""}else t.result=!0,t.msg="",t.addFundsFlag=!1,t.resultCode="";return t}return p},[o]),R=(0,h.useMemo)(()=>({loading:s,...o?.[_.KYS]||{}}),[s,o]);return{loading:s,kysRet:R,preExecute:f,verifyGasLimitRet:i,preExecuteRet:o}},ye=Ge;var Ae=({unapproved:e})=>{let r=pe(Z),s=z(r?.coinId)||{},n=s?.coinId||r?.coinId,{initialType:F}=P(e),u=ye({unapproved:e}),{verifyGasLimitRet:o,kysRet:E,preExecute:x}=u;(0,L.useEffect)(()=>{s?.coinId&&x(s)},[s?.coinId,x]);let{networkFee:f,isSufficientGas:i,networkFeeProps:R,estimateFailed:p,estimateFailedMsg:c,loading:S,isSufficientBalance:t,selfRent:a,replacedTransactions:T}=xe({coinId:n,unapproved:e,preExecuteResult:u}),N=(0,L.useCallback)(()=>!t&&i?{type:Q.TYPE.warn,message:W("walletextension_toast_text_reserve_rent_exempt",{number:K.div(a,10**s?.decimals)})}:null,[i,t,a,s?.decimals]),b=ce({unapproved:e}),A=le({verifyGasLimitRet:o}),G=me({baseCoin:s,unapproved:e,estimateFailed:p,isSufficientGas:i,verifyGasLimitRet:o,estimateFailedMsg:c,kysRet:E},{pre:[b,A],post:[N]}),{buttonGroup:D,handleCancel:B}=ie({coinId:n,feeLoading:S,unapproved:e,estimateFailed:p,isSufficientGas:i,preExecuteRet:u,extParams:{coinId:n,replacedTransactions:T,serviceCharge:f},chainConfirmDisabled:v(F),isSufficientBalance:t});return oe({kysRet:E,handleCancel:B,coinId:n}),L.default.createElement(ae,{slot:{top:L.default.createElement(Se,{origin:e.origin,providerType:Z,chainName:r?.chainName})},kysRet:E,baseCoin:s,unapproved:e,tipMessage:G,buttonGroup:D,networkFee:R})};d();g();var Ce=C(w());var he=({unapproved:e})=>{let r=e.params?.message,s=Te({unapproved:e});return Ce.default.createElement(ge,{message:r,unapproved:e,tipMessage:s})};var wt=({unapproved:e})=>{switch(e.method){case y.SIGN_TRANSACTION:case y.RPC_SIGN_TRANSACTION:case y.SIGN_AND_SEND_TRANSACTION:case y.RPC_SIGN_AND_SEND_TRANSACTION:case y.SIGN_ALL_TRANSACTIONS:case y.RPC_SIGN_ALL_TRANSACTIONS:return q.default.createElement(Ae,{unapproved:e});case y.SIGN_MESSAGE:case y.RPC_SIGN_MESSAGE:return q.default.createElement(he,{unapproved:e});default:return""}};export{wt as default};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "prepub";

//# sourceMappingURL=Solana-D3L4FNZA.js.map
