import{a as V,b as H}from"./chunk-FSSAJWUE.js";import{a as g}from"./chunk-EYUJFPID.js";import{a as O,b as K}from"./chunk-QXSGLFJ4.js";import{b as x}from"./chunk-RQ4URFJV.js";import{b as R,c as N}from"./chunk-A7QDOMG2.js";import{b as D,c as U}from"./chunk-UV4CBWDM.js";import{f as k,i as v}from"./chunk-JZYFGUUR.js";import{b as re,g as Y,h as ce,i as ae,j as le,k as z,l as ue,m as G}from"./chunk-IY5XPXLD.js";import{d as I}from"./chunk-CE2I3GSK.js";import{a as W}from"./chunk-FCCCJLF6.js";import{a as ge,qb as se,xb as P,y as S}from"./chunk-FK3ETA6I.js";import{b as ne,c as ke}from"./chunk-OXVQDEZW.js";import{j,m as we}from"./chunk-X3G52GGX.js";import{Ca as F,Cb as te,Hc as oe,Kb as _,hb as be,ib as L,jb as ee,kb as w,m as $}from"./chunk-QG673PNL.js";import{a as b}from"./chunk-ADZWCU3Q.js";import{f as d,m,o as f}from"./chunk-REC7XVZY.js";m();f();var Q=d(b()),X=d(S()),We=d($());m();f();var B=d(b()),A=d(S());var J=d(ge()),E=d($());m();f();m();f();var ie=d(S());var me=d(b());var xe=o=>{let[n]=U(D.showNftAmount),e=v(o),t=O(),r=R(),s=N(r),a=(0,ie.useSelector)(P);return(0,me.useMemo)(()=>{let{walletAccountsWidthBalance:l}=K({walletAccounts:[e],showNftAmount:n,rpcData:null,selectedCurrency:s,assetsMap:t,hiddenSmallAsset:a});return l[0]},[e,n,s,t])},Me=xe;m();f();var fe=d(b()),pe=d(S());var M=(o="")=>{let{extensionConfig:n}=g("rpc_info"),{isRpcMode:e}=(0,pe.useSelector)(I);return(0,fe.useCallback)(async()=>!e||!n?.rpcUrl?{}:await re(o||n.rpcUrl),[o,n,e])};m();f();var de=d(b());function q(o,n,e){let t=de.default.useRef({});return(!("value"in t.current)||e(t.current.condition,n))&&(t.current.value=o(),t.current.condition=n),t.current.value}be();ke();we();_();m();f();_();var Fe=6,he=(o,n=Fe)=>{if(!Number(o))return"0";let e=o?.toString();return(o.split(".")[1]||"")?.length>n?te(e,n&&Number(n)):e},Ae=(o,n)=>{let{rpcUrl:e,chainId:t,account:r,existAccounts:s,isDeleted:a}=n;return Array.isArray(o)?o.filter(l=>{let c=!0;return t&&(c=c&&l.chainId===t),r&&(c=c&&l.account===r),Array.isArray(s)&&!!s?.length&&(c=c&&s?.includes(l.account)),a!==void 0&&(c=c&&(l.isDeleted||!1)===a),l.address||(c=c&&l.rpcUrl===e),c}):[]},Ce=(o,n={})=>{let{symbol:e,usdToThisRate:t,chainTokenPrice:r,chainTokenBalance:s}=n;return Array.isArray(o)?o.map(a=>{let l,c,{chainId:u,decimals:i}=a,C=e;a.address?(l=r?.[u]?.[a.address]||0,c=s?.[a.account]?.[u]?.[a.address]||0):(l=r?.[u]?.price||0,c=s?.[a.account]?.[u]?.balance||0),c=he(c&&ee(c,10**i));let p=he(L(c,L(l,t)));return{price:l,balance:c,...a,moneySymbol:C,marketValue:p}}):[]};var y=(o,n,e=!0)=>{let{extensionConfig:t}=g("rpc_info"),{chainId:r,rpcUrl:s}=t,a=(0,A.useSelector)(Y),l=(0,A.useSelector)(ce),c=(0,A.useSelector)(ae),{symbol:u,usdToThisRate:i}=(0,A.useSelector)(se),C=V(),p=H(void 0,F),h=(0,B.useMemo)(()=>Ae(a,{chainId:r,rpcUrl:s,existAccounts:p,account:e?C:void 0,isDeleted:n?void 0:!1}),[r,C,p,a]);return(0,B.useMemo)(()=>o?h:Ce(h,{symbol:u,usdToThisRate:i,chainTokenPrice:l,chainTokenBalance:c}),[u,h,i,l,c,o])},nn=(o,n)=>{let e=y(n);return(0,B.useMemo)(()=>e.find(t=>t.address===(o||void 0))||{},[o,e])};var Se=o=>{let n=M(o);return W(async e=>{let t=await n(),r=new t.eth.Contract(J.default,e),s=await r.methods.symbol().call(),a=await r.methods.decimals().call();return{name:await r.methods.name().call(),symbol:s,decimals:a}},[n])},Pe=()=>{let o=M(),n=x();return W(async(e,t,r)=>{let s,a=r||await o(),l=t||n;return e?s=await new a.eth.Contract(J.default,e).methods.balanceOf(l).call():s=await a.eth.getBalance(l,"latest"),s},[o,n])},Ie=()=>W(async(o,n)=>{let e=n;typeof n=="string"&&(e=[n]);try{let{data:t}=await j(ne.getCoinPrice,{tokenAddresses:e,chainId:typeof o=="string"?Number.parseInt(o,16):o});return t}catch{return[]}},[]),on=()=>{let o=M(),n=(0,A.useDispatch)();return W(async({chainId:e,injectWeb3:t,wallets:r=[]})=>{let s=t||await o(),a=new s.BatchRequest;r.forEach(l=>{a.add(s.eth.getBalance.request(l,"latest",(c,u)=>{c||n(G({chainId:e,balance:u,account:l}))}))}),a.execute()})},Re=()=>{let o=(0,A.useDispatch)(),n=x(),e=Ie(),t=Pe();return W(async({chainId:r,address:s,injectAccount:a,injectWeb3:l})=>{let[c,u]=await Promise.all([e(r,s),t(s,a,l)]);return c?.length&&o(ue({chainId:r,price:c[0].price})),o(G({chainId:r,balance:u,address:s,account:a||n})),!0},[t,n])},sn=()=>{let o=x(),{extensionConfig:n}=g("rpc_info"),{chainId:e}=n,t=y(!0,!1,!1);return q(()=>({chainId:e,chainTokens:t}),{chainId:e,account:o,needPollChainTokens:t},(r,s)=>!(0,E.isEqual)(r,s))},Ne=18,De=()=>{let o=(0,A.useDispatch)(),n=(0,A.useSelector)(Y),e=x();return W((t,r,s)=>{if(!t&&!e&&!s?.account)return!1;let{rpcUrl:a}=s,l=n.find(u=>{let i=u.chainId===t&&u.address===r&&u.account===(s?.account||e);return r||(i=i&&u.rpcUrl===a),i});if(l){if(l.isDeleted===!0){let u={...l,...s,chainId:t,address:r,isDeleted:!1};return o(z(u)),!0}return!1}let c={chainId:t,address:r,isDeleted:!1,account:e,decimals:Ne};return s&&typeof s=="object"&&Object.assign(c,s),o(le(c)),!0},[n,e])},rn=o=>{let n=M(o),e=De(),t=Se(o),r=Re();return async(s,a)=>{let l=await t(a);if(e(s,a,l)){let u=await n();await r(s,a,u)}}},Ue=(o={})=>{let n=k(o);return q(()=>n.reduce((e,t)=>{if(t.keyringIdentityType===oe.MNEMONIC)e.push(t);else{let r=t.walletIdentities.filter(s=>Boolean(s.account[F]));r.length&&e.push({...t,walletIdentities:r})}return e},[]),n,(e,t)=>!(0,E.isEqual)(e,t))},cn=(o={})=>{let n=Ue(o),e=y(!1,!1,!1);return(0,B.useMemo)(()=>{let t=(0,E.groupBy)(e||[],"account");return n?.map(r=>{let s="",a=r.walletIdentities?.map(c=>{let u=c?.account?.[F],{balance:i,symbol:C}=t[u]?.filter(({address:p})=>!p)[0]||{};return s=C,{...c,balance:i,symbol:C}}),l=a.reduce((c,u)=>w(c,u.balance),0);return{...r,marketValue:l,marketValueSymbol:s,walletIdentities:a}})||[]},[e,n])},an=()=>{let o=(0,A.useDispatch)(),n=y(!0,!1,!1);return e=>{n?.filter(({chainId:t,rpcUrl:r,address:s})=>!s&&t===e.chainId&&r===e.rpcUrl)?.forEach(({chainId:t,account:r})=>{o(z({chainId:t,account:r,...e}))})}};_();var Oe=o=>{let n=k(o),[e]=U(D.showNftAmount),t=R(),r=N(t),{isRpcMode:s}=(0,X.useSelector)(I),a=y(!1,!1,!1),l=(0,We.groupBy)(a||[],"account"),c=(0,X.useSelector)(P),u=O(),i=(0,Q.useMemo)(()=>n.map(p=>{let{walletIdentities:h}=p,{walletAccountsWidthBalance:Z,walletAsset:Te,platformAsset:ye}=K({walletAccounts:h,showNftAmount:e,rpcData:s?{chainTokensAccountMap:l}:null,selectedCurrency:r,assetsMap:u,hiddenSmallAsset:c});return{...p,walletAsset:Te,platformAsset:ye,walletIdentities:Z}}),[n,e,l,s,r,u]);return[(0,Q.useMemo)(()=>i?.reduce((p,h)=>({walletAsset:w(p.walletAsset,h.walletAsset==="--"?"0":h.walletAsset),platformAsset:w(p.platformAsset,h.platformAsset==="--"?"0":h.platformAsset),rpcModeCoinSymbol:p.rpcModeCoinSymbol||h?.rpcModeCoinSymbol}),{walletAsset:"0",platformAsset:"0",rpcModeCoinSymbol:""}),[i]),i]},Be=Oe;export{Me as a,M as b,q as c,y as d,nn as e,Se as f,Pe as g,Ie as h,on as i,Re as j,sn as k,De as l,rn as m,Ue as n,cn as o,an as p,Be as q};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "prepub";

//# sourceMappingURL=chunk-7G3IOU2S.js.map
