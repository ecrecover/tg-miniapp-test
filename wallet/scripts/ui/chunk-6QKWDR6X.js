import{e as L}from"./chunk-CDLW656Z.js";import{a as U}from"./chunk-4VLUHY4K.js";import{w as b}from"./chunk-VMO2INN3.js";import{aa as O,b as T,da as I}from"./chunk-IUIJ46C3.js";import{a as k}from"./chunk-KZ3ZU675.js";import{d as F}from"./chunk-PS3S6BG3.js";import{c as f}from"./chunk-JXCCIV3J.js";import{m as Q}from"./chunk-X7YMANPZ.js";import{I as D,m as g,w as s}from"./chunk-RPZQDAIQ.js";import{M as G,Y as B,c as $}from"./chunk-V4F2JFTP.js";import{a as V}from"./chunk-6DDC4Y2S.js";import{f as C,m,o as x}from"./chunk-EQYVU4XP.js";m();x();var M=C(V());D();m();x();var P={extLink:"_extLink_1eb1z_1"};var R=()=>{let e=U(),t=u=>({title:s("wallet_extension_header_title_transaction_risk"),desc:s(u,{case:M.default.createElement(k,{className:P.extLink,href:e?.scamsUrl},s("wallet_extension_function_link_case"))}),mainBtnText:s("wallet_extension_function_btn_cancel"),subBtnText:s("wallet_extension_function_btn_advanced")}),o=(u="")=>({screenOne:{title:s("wallet_extension_function_title_approve_to_eoa"),desc:s("wallet_extension_function_desc_approve_to_eoa",{address:F(u),link:M.default.createElement(k,{className:P.extLink,href:e?.scamsUrl},s("wallet_extension_function_link_case"))}),mainBtnText:s("wallet_extension_function_btn_cancel"),subBtnText:s("wallet_extension_function_btn_advanced")},screenTwo:{title:s("wallet_extension_function_title_approve_to_eoa"),desc:s("wallet_extension_function_desc_developer_continue"),mainBtnText:s("wallet_extension_mid_dialog_btn_cancel"),subBtnText:s("wallet_extension_function_btn_continue_transaction")}}),n=()=>({screenOne:t("wallet_extension_mid_desc_transaction_account_risk"),screenTwo:{title:s("wallet_extension_header_title_transaction_risk"),desc:s("wallet_extension_mid_desc_continue_transaction"),mainBtnText:s("wallet_extension_mid_dialog_btn_cancel"),subBtnText:s("wallet_extension_mid_btn_continue_transaction")}}),a=()=>({screenOne:t("wallet_extension_mid_desc_transaction_account_risk")}),r={title:s("wallet_extension_header_title_transaction_risk"),desc:s("wallet_extension_function_desc_developer_continue"),mainBtnText:s("wallet_extension_mid_dialog_btn_cancel"),subBtnText:s("wallet_extension_function_btn_continue_transaction")};return{getEoaModalParams:o,getEthSignModalParams:()=>({screenOne:t("wallet_extension_sign_card_desc_risky_blocked")}),getLowerValueModalParams:()=>({screenOne:t("wallet_extension_sign_card_desc_risky_unusual"),screenTwo:r}),getSolPermissionsModalParams:a,getTronPermissionsModalParams:n,getBlackAddressWarnModalParams:(u="")=>({screenOne:{title:s("wallet_extension_header_title_transaction_risk"),desc:u,mainBtnText:s("wallet_extension_function_btn_cancel"),subBtnText:s("wallet_extension_function_btn_advanced")},screenTwo:r}),getStrongBlackAddressModalParams:(u="")=>({screenOne:{title:s("wallet_extension_header_title_transaction_risk"),desc:s("wallet_extension_address_card_desc_risky_blocked",{address:F(u),case:M.default.createElement(k,{className:P.extLink,href:e?.scamsUrl},s("wallet_extension_function_link_case"))}),mainBtnText:s("wallet_extension_function_btn_cancel"),subBtnText:s("wallet_extension_function_btn_advanced")}}),getSuspicionWithdrawAddressModalParams:()=>({screenOne:t("wallet_extension_mid_desc_transaction_address_risk"),screenTwo:r})}},Ae=R;m();x();var _=C(V()),W=C($());m();x();var d={main:"_main_1fewt_1",box:"_box_1fewt_6",isPureScreen:"_isPureScreen_1fewt_12",tipImg:"_tipImg_1fewt_15",tipImgIcon:"_tipImgIcon_1fewt_24",title:"_title_1fewt_28",decs:"_decs_1fewt_36",extLink:"_extLink_1fewt_42",footerWrap:"_footerWrap_1fewt_46",screenOneButtons:"_screenOneButtons_1fewt_49",extButton:"_extButton_1fewt_53"};var H=e=>{let{children:t,desc:o,title:n,isPureScreen:a}=e;return _.default.createElement(f.FlexBox,{className:d.main,direction:f.DIRECTION.vertical},_.default.createElement(f.Box,{className:(0,W.default)(d.box,{[d.isPureScreen]:a})},_.default.createElement(f.Box,{className:d.tipImg},_.default.createElement(G,{className:(0,W.default)("okx-wallet-plugin-risk-trading",d.tipImgIcon)})),_.default.createElement(b.Text,{className:d.title,align:b.ALIGN.center},n),_.default.createElement(b.Text,{className:d.decs,size:b.SIZE.sm,align:b.ALIGN.center},o)),_.default.createElement(f.Box,{className:d.footerWrap},t))},ee=({modalParams:e,handleCancel:t,handleNext:o})=>{let{screenOne:n,screenTwo:a}=e,[r,i]=(0,_.useState)(!1),c=async()=>{i(!0),await t(),i(!1)};return _.default.createElement(H,{desc:n.desc,title:n.title},_.default.createElement(f.Box,{className:d.screenOneButtons},_.default.createElement(B,{block:!0,loading:r,size:B.SIZE.lg,onClick:c,type:B.TYPE.highlight,category:B.CATEGORY.fill},n.mainBtnText),a?_.default.createElement(f.Box,{className:d.extButton,onClick:o},n.subBtnText):null))},te=({handleCancel:e,handleNext:t,modalParams:o})=>{let{screenTwo:n={}}=o,a=[{actionType:L.ACTION_TYPE.CANCEL,btnText:n.subBtnText,onClick:t},{actionType:L.ACTION_TYPE.CONFIRM,btnText:n.mainBtnText,onClick:e}];return _.default.createElement(H,{isPureScreen:!0,desc:n.desc,title:n.title},_.default.createElement(f.Box,{className:d.screenTwoButtons},_.default.createElement(L,{buttonGroup:a})))},ne=({handleCancel:e,closeModal:t,modalParams:o})=>{let[n,a]=(0,_.useState)(1);return n===2?_.default.createElement(te,{modalParams:o,handleCancel:e,handleNext:t}):_.default.createElement(ee,{modalParams:o,handleCancel:e,handleNext:()=>{a(2)}})},Fe=ne;m();x();var h=C(Q());D();var w={NATIVE:132,TOKEN:99,NFT:66,OTHERS:33},N={add:"+",sub:"-"},se="306001",oe=e=>{let{approveList:t=[],assetChange:o=[]}=e||{};if(t.length){let n=t[0];if([T.AUTHORIZATION,T.CANCEL_AUTHORIZATION,T.INCREASE_ALLOWANCE,T.DECREASE_ALLOWANCE,T.COMMON_APPROVE,T.NFT_AUTHORIZATION,T.NFT_CANCEL_AUTHORIZATION].includes(n?.approvalType))return n.approvalType}return o.length?T.TRANS_OUT:""},K=(e,t)=>{let o=e.filter(({operator:r})=>r===N.sub),n=e.filter(({operator:r})=>r===N.add),a=(r,i)=>{let c=r[t],l=i[t],p=r.asset?.decimals,E=i.asset?.decimals;return p&&E&&(c=g.div(c,g.pow(10,p)),l=g.div(l,g.pow(10,E))),g.sub(l,c)};return o.sort(a),n.sort(a),[...o,...n]},ae=(e,t)=>{let o=e.assetsDiffs?.[t]||{},n=e.exposures?.[t]||[],a=e.permissions?.[t]||[],r=e.permissionMsg||"",i=e.intention||{},c=e.blackAddressWarning||{},l=e.causeRiskItem||[];return{assetsDiff:o,exposure:n,permission:a,permissionMsg:r,intention:i,blackAddress:c,causeRiskItem:l}},re=e=>{let t=[];return(0,h.isArray)(e)&&e.forEach(o=>{let{asset:n}=o||{};if(o?.diff){let a=g.gt(o.diff,0);t.push({asset:n,usdValue:o.diffUsdValue,operator:a?N.add:N.sub,rawValue:a?o.diff:o.diff?.slice(1)})}else o?.out?.forEach(a=>{t.push({asset:n,operator:N.sub,...a})}),o?.in?.forEach(a=>{t.push({asset:n,operator:N.add,...a})})}),t},ie=(e,t)=>{if(!e||(0,h.isEmpty)(e))return{};let{assetsDiff:o,exposure:n,permission:a,permissionMsg:r,intention:i,blackAddress:c,causeRiskItem:l}=ae(e,t),p=[];if((0,h.isArray)(n)){let A=n[0]||{},{asset:y={},spenders:v={}}=A;Object.entries(v).forEach(([q,J])=>{p.push({asset:y,address:q,...J})})}let E=re(o),u={};[w.NATIVE,w.TOKEN,w.OTHERS].forEach(A=>{let y=E.filter(v=>v?.asset?.assetType===A);u[A]=K(y,"rawValue")});let z=E.filter(A=>A?.asset?.assetType===w.NFT),j=K(z,"tokenNum"),X=[...u[w.NATIVE],...u[w.TOKEN],...j,...u[w.OTHERS]];return{intention:i,permission:a,permissionMsg:r,assetChange:X,approveList:p,blackAddress:c,causeRiskItem:l}},Y=e=>e&&e?.result===!1,Z=e=>e&&(e?.resultCode===se||e?.addFundsFlag),le=e=>Y(e)&&!Z(e),He=(e,t,o={})=>{let{from:n,preExecuteFailed:a=!1}=o||{},r={};return t?.forEach(i=>{let c=e?.find(l=>l?.checkType===i)||{};if(i===O.SAFE_ADDRESS){let l=Boolean(c?.blackAddress),p=c?.isSimilar||I.FAILED;r[i]={...c,isDefraud:l,similarType:p,isSimilar:[I.EXACT,I.ROUGH].includes(p)}}else if(i===O.CONTRACT_ADDRESS)r[i]={...c,isContract:typeof c?.result=="boolean"&&!c?.result};else if(i===O.KYS){let l=ie(c,n);r[i]={...l,txType:oe(l)}}else if(i===O.VERIFY_GAS_LIMIT){let l={...c};a&&(l.result=!1),r[i]={...l,isPreExecuteFailed:Y(l),isPreExecuteGasError:Z(l),isPreExecuteNonGasError:le(l)}}else r[i]=c}),r};export{Ae as a,Fe as b,w as c,N as d,He as e};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "prepub";

//# sourceMappingURL=chunk-6QKWDR6X.js.map
