import{a as ge,b as _e,c as N,d as we,e as Ie}from"./chunk-3PTPKHLI.js";import{a as xe}from"./chunk-RONUZVEW.js";import"./chunk-CQ2K3QEZ.js";import{a as Pe}from"./chunk-J7WTXBCA.js";import{a as Ce}from"./chunk-DTYLEM3V.js";import"./chunk-PSJFSVFM.js";import"./chunk-MYKMM3H4.js";import"./chunk-UMBG4UN5.js";import"./chunk-Z223YH2S.js";import{j as de}from"./chunk-KZUQM6PE.js";import{a as it}from"./chunk-3G5IAADG.js";import{a as pe,c as fe}from"./chunk-YEYYFHLH.js";import"./chunk-7H2LDC2I.js";import"./chunk-NHHEXXPU.js";import"./chunk-RZ42FYW3.js";import"./chunk-B4ATV3GC.js";import"./chunk-WUFX5FIX.js";import"./chunk-5WLVDQXN.js";import"./chunk-Q7EMQCH4.js";import"./chunk-TAIMVZA3.js";import"./chunk-XHGDRCKN.js";import"./chunk-MJY6W4GC.js";import{d as le}from"./chunk-5KKHZTOM.js";import{a as L}from"./chunk-EKXTRWYR.js";import{a as ne,b as ae,d as se}from"./chunk-JWIDJEDW.js";import"./chunk-WQ5TWFR7.js";import"./chunk-A7BL4T7A.js";import"./chunk-M7H3BUKN.js";import"./chunk-2PVY7Q74.js";import"./chunk-AQEDLRCW.js";import"./chunk-JXXKPVB7.js";import{c as re}from"./chunk-3LOAATWV.js";import"./chunk-OR3IMHNP.js";import"./chunk-G2LUKHAZ.js";import{a as ue}from"./chunk-FC47KHHQ.js";import"./chunk-IPY7DOYN.js";import"./chunk-ITKK42YQ.js";import"./chunk-IF7RTFSM.js";import"./chunk-NWBT27VI.js";import{a as ie}from"./chunk-ERRJFVON.js";import"./chunk-AGNEMUCC.js";import{d as st,e as me,g as ce}from"./chunk-SFY37WOS.js";import"./chunk-7GRBMPLB.js";import"./chunk-H2MP374E.js";import{a as te,e as v}from"./chunk-JFCE4WMN.js";import"./chunk-2CQDB45Y.js";import{b as at}from"./chunk-TCY2QN26.js";import"./chunk-TAMFXRQS.js";import"./chunk-SWNKITDG.js";import"./chunk-PCT6WF3F.js";import"./chunk-7G3IOU2S.js";import"./chunk-FSSAJWUE.js";import"./chunk-EYUJFPID.js";import"./chunk-QXSGLFJ4.js";import"./chunk-LTVFH3JK.js";import"./chunk-UX45LV4J.js";import{a as Ct}from"./chunk-S2L2SUZT.js";import"./chunk-WAOH7NV4.js";import{g as Zt}from"./chunk-Z7MVEL6Q.js";import"./chunk-EQQ4TY26.js";import"./chunk-BSJ5U7SB.js";import"./chunk-RQ4URFJV.js";import"./chunk-A7QDOMG2.js";import"./chunk-PCN4TJH3.js";import"./chunk-UV4CBWDM.js";import{m as rt}from"./chunk-JZYFGUUR.js";import"./chunk-55MBPFME.js";import"./chunk-ITV6J4J2.js";import"./chunk-E4R5GU2A.js";import{a as jt}from"./chunk-ROVVMPCE.js";import"./chunk-JHFWN6ZE.js";import"./chunk-7XFWBKEO.js";import"./chunk-GFKALINB.js";import{l as Te}from"./chunk-PSXFVNX7.js";import"./chunk-FOB36UC7.js";import"./chunk-W5VVGPTJ.js";import"./chunk-6JC2JFPK.js";import"./chunk-RDUIYFM4.js";import"./chunk-3OA7XW3I.js";import{b as Jt}from"./chunk-MVELXHVO.js";import"./chunk-YFG3KJV4.js";import"./chunk-HP4KI3UG.js";import"./chunk-QAD7XKBR.js";import"./chunk-FSHQROIB.js";import{e as qt,g as Vt,m as Kt}from"./chunk-RSZRDNEQ.js";import"./chunk-LWWOGE47.js";import"./chunk-PNKC4I7V.js";import"./chunk-OBDMMZ5P.js";import"./chunk-AWV3UGPG.js";import{a as Ht,b as Yt}from"./chunk-ZFY6KTVJ.js";import"./chunk-LQ6EG3M7.js";import"./chunk-EFXUUWZM.js";import"./chunk-SXT2HSEA.js";import"./chunk-X6MJ7FAJ.js";import"./chunk-4QGZMEGU.js";import"./chunk-JGVOOQUI.js";import{h as nt,j as ee,k as oe,p as Tt}from"./chunk-OL5PZGTP.js";import"./chunk-T6BAWHSV.js";import"./chunk-NZFRZUU7.js";import"./chunk-GKPU7ZYD.js";import"./chunk-IY5XPXLD.js";import"./chunk-N6T7YZKN.js";import"./chunk-CE2I3GSK.js";import"./chunk-SPMBQ3GG.js";import"./chunk-W3BHXSAD.js";import"./chunk-KWEOQTFQ.js";import"./chunk-MYLTZKPJ.js";import{a as ot}from"./chunk-RAK5MQVM.js";import{f as Qt}from"./chunk-ILYGYWTN.js";import"./chunk-HOK5U34D.js";import"./chunk-XPB5VA3I.js";import"./chunk-XSNWL3NI.js";import"./chunk-IOMWHGY3.js";import"./chunk-EDYYUNM2.js";import"./chunk-FOI3TQUA.js";import"./chunk-Y3W2FGGC.js";import"./chunk-6SKAHEOE.js";import"./chunk-QYGNKIL6.js";import{B as $t}from"./chunk-WWF4GAYE.js";import"./chunk-YITM3H6Z.js";import"./chunk-IQFXZKFW.js";import"./chunk-7BFUGHAL.js";import"./chunk-JVN7YJ6W.js";import"./chunk-VSX7BSN7.js";import{a as zt}from"./chunk-V4V6C6NY.js";import"./chunk-ZQ5A3KPQ.js";import{a as Xt}from"./chunk-BGUY7SH3.js";import"./chunk-MJYAUOKI.js";import"./chunk-LI3NFLG3.js";import{a as et,j as Dt,o as Ot}from"./chunk-FCCCJLF6.js";import{a as Wt}from"./chunk-4Z4GXCHB.js";import{Wa as Lt,y as $}from"./chunk-FK3ETA6I.js";import{S as Gt,X as Rt,aa as dt,ca as Bt,d as vt,m as tt}from"./chunk-QZDHFNHK.js";import"./chunk-24PQFN5C.js";import"./chunk-6KPQELH2.js";import{a as mo}from"./chunk-EJQOS3F4.js";import{k as U,o as Ut}from"./chunk-LHHZ5TAA.js";import"./chunk-PI6QLVMS.js";import"./chunk-QY4HIIR3.js";import"./chunk-XFWUEPSK.js";import{d as St,f as io}from"./chunk-MNNY2ODL.js";import"./chunk-VCAWL4NW.js";import"./chunk-XVIU24G2.js";import"./chunk-Q277JDUA.js";import"./chunk-2LDYLNUY.js";import"./chunk-KCITCUTL.js";import"./chunk-YZ3HCB4K.js";import"./chunk-EZ7VUFME.js";import{a as y,b as g}from"./chunk-T2OWRX3Y.js";import"./chunk-C3FJ2D4V.js";import"./chunk-C5ZJZEPI.js";import"./chunk-LGHM3MOC.js";import"./chunk-2FULUWWG.js";import"./chunk-SLEUZTBQ.js";import"./chunk-4X6ZAX3L.js";import{c as Mt}from"./chunk-4QSQKIBZ.js";import{b as Nt,c as so}from"./chunk-OXVQDEZW.js";import{j as Ft,m as ro}from"./chunk-X3G52GGX.js";import"./chunk-WUKT6J7S.js";import"./chunk-FTJCOLFJ.js";import{Ca as ft,Jc as bt,Kb as At,Tb as B,Wb as no,ac as kt,hb as oo,jc as ao,kb as ut,lb as Et,m as pt,pb as Z,qb as yt,rb as ht}from"./chunk-QG673PNL.js";import"./chunk-ZUFARSFM.js";import{G as R,c as lt}from"./chunk-6MTHEPGF.js";import{I as K,w as T}from"./chunk-ZQQ7HNWV.js";import"./chunk-Y62GSKHT.js";import"./chunk-2BXFMFMK.js";import"./chunk-ZOQTSYT4.js";import{a as W}from"./chunk-ADZWCU3Q.js";import"./chunk-AXQY4CD5.js";import"./chunk-ZPRPROG4.js";import"./chunk-FDI7TLXH.js";import"./chunk-L4HTIIR6.js";import"./chunk-733NI6T7.js";import"./chunk-5TB3ZTAO.js";import"./chunk-EYWGNJVY.js";import"./chunk-PIGJQYQ3.js";import"./chunk-YSXN7JDZ.js";import"./chunk-TBVIGR5T.js";import"./chunk-FHQVMQUK.js";import"./chunk-XNS2NFYY.js";import{f as x,m,o as c}from"./chunk-REC7XVZY.js";m();c();var O=x(W());no();m();c();var J=x(W()),Ae=x($()),ke=x(mo());m();c();var Fe=x($()),mt=x(pt());var co=t=>{let o=(0,Fe.useSelector)(Lt),e=t?.image;return(0,mt.isArray)(e)?t.image=e[0]:(0,mt.isObject)(e)&&(t.image=null),{token:t,provider:o}},Ee=co;m();c();K();var ye=x($());Ut();var po=(t={},o={},e=!0)=>{let r=(0,ye.useDispatch)(),a=t.address,u=ot(),i=_e(),s=L(),l={actionType:v.ACTION_TYPE.CANCEL,async onClick(){s({all_confirmation:"cancel",trade:"add_token"}),await i(a,!1),await U(r)},btnText:T("wallet_dapp_connection_btn_reject")},n={actionType:v.ACTION_TYPE.CONFIRM,disabled:!e,async onClick(){try{s({all_confirmation:"confirm",trade:"add_token"});let f=await nt(o.type,u),C={...t,contractAddress:a,blockChain:f.shortName,localType:o.type};await Jt(C),await i(a,!0),await U(r)}catch(f){R.error(f?.data?.originalError?.msg||T("wallet_extenshion_toast_add_failed"))}}};return[l,n]},he=po;var lo=({unapproved:t})=>{let o=(0,Ae.useSelector)(Yt),{token:e,provider:r}=Ee(t),[a,u]=(0,J.useState)(!0),i=ot();Dt(async()=>{let l=await nt(r.type,i);u(!!l)});let s=he(e,r,a);return!e||o!==Ht.addToken?J.default.createElement(ke.Redirect,{to:Wt}):J.default.createElement(Pe,{token:e,provider:r,supported:a,buttonGroup:s})},Ne=lo;m();c();var Re=x(W());var X=x($());Ut();K();m();c();var D=x(W());io();var Se=()=>(0,D.useCallback)(async(o,e)=>{await St().updateReportTimestamp(o,e)},[]);var fo=()=>{let t=Se();return(0,D.useCallback)(async e=>{await t(e,"CAN_CONFIRM")},[t])},Me=(t,o)=>{let e=fo(),r=(0,D.useRef)(!1);(0,D.useEffect)(()=>{!o&&!r.current&&(r.current=!0,e(t))},[t,o,e])},be=()=>{let t=Se();return(0,D.useCallback)(async e=>{await t(e,"CLICK_CONFIRM")},[t])};m();c();var ve=x(pt());var Ge=({isMev:t,mevInfo:o,unapproved:e,modifiedData:r,customGasInfo:a,updateData:u,gasReturnActivity:i})=>{let{nonce:s,updateGasInfo:l}=u,n=(0,ve.cloneDeep)(e),{supportEip1559:f,gasLimitInfo:C={},gasLimit:P,maxFeePerGas:w,gasPrice:I,maxPriorityFeePerGas:F}=a;if(r&&n.txParams&&(n.txParams.data=r),f?(delete n?.txParams.gasPrice,n.txParams.maxFeePerGas=g(w),n.txParams.maxPriorityFeePerGas=g(F),n.txParams.type=tt.FEE_MARKET):(delete n?.txParams.maxFeePerGas,delete n?.txParams.maxPriorityFeePerGas,delete n?.txParams.type,n.txParams.gasPrice=g(I)),l){let A=Object.entries(l).reduce((_,[E,h])=>(_[E]=g(h),_),{});n.txParams={...n.txParams,...A}}return n.txParams.gas=g(P),n.txParams.nonce=g(s),n.gasLimitInfo=C||{},n.mev=t?o.name:"",n.activityId=i?.activityId,n.gasType=a.gasType,e?.txParams?.data||(n.isBaseCoinTransfer=!0),n};var uo=(t,o)=>{let e=(0,X.useSelector)(a=>oe(a,t)),r=(0,X.useSelector)(a=>ee(a,t)??o??!1);return{mevInfo:e,isMev:r}},To=({unapproved:t})=>{let o=(0,X.useDispatch)(),e=N(),r=it(t),{id:a,txParams:u={},extParams:i={}}=t,{from:s,to:l,value:n}=u,{coinId:f,chainName:C}=e,P=ge(t.origin,s)||{},{isMev:w,mevInfo:I}=uo(a,i?.isMev),F=be(),A=et((M,b)=>{o(Tt.setIsMev({isMev:M,id:a})),o(Tt.setMevInfo({mevInfo:b,id:a}))});Me();let _=L(P?.walletId),E=et(async()=>{_({trade:"contract_interaction",all_confirmation:"cancel",network:C,dapp_url:t.origin}),$t(),await o(Kt({id:a})),await U(o)}),h=pe(),k=et(async({modifiedData:M,customGasInfo:b,gasReturnActivity:H,reportGasReturnActivityDataInConfirm:q})=>{let{gasPrice:ct}=b;if(F(a),await at({callback:E,walletId:P?.walletId})){_({all_confirmation:"confirm",trade:"contract_interaction",network:C,dapp_url:t.origin});let j=await h({to:l,from:s,coinId:f,gasPrice:ct,userGasInfo:b,amount:y(n||0),baseCoinAmountUse:y(n||0)});q(),await o(Vt(Ge({isMev:w,mevInfo:I,unapproved:t,updateData:j,modifiedData:M,customGasInfo:b,gasReturnActivity:H}))).then(V=>{let{serverTxId:G}=V||{};Te({tx_id:G})}).catch(V=>{try{let G=V?.data?.originalError;qt(G.code)&&(H?.clear(),R.error({title:G?.msg||T("wallet_home_toast_network_error"),duration:3}))}catch(G){console.log(G)}}),await U(o)}});return Re.default.createElement(fe,{needMev:!0,coinId:f,openMev:w,onConfirmReplace:!0,dappInfo:r,txParams:u,txType:t?.type,walletId:P?.walletId,isShowBlockSwapMevTooltip:i?.isShowBlockSwapMevTooltip,onMevChange:A,onCancel:E,onConfirm:k})},Be=To;m();c();K();var d=x(W());m();c();var xt=x(pt()),Le=x(W());At();var Co=({unapproved:t,walletAccount:o,customGasInfo:e={}})=>{let{params:r}=t,{walletId:a}=o,u=N(),{coinId:i}=u,s=Zt(i,a)?.coinAmountInt,{gasType:l,isNetworkFeeLoading:n,networkFee:f,getLimit:C}=e,{minGasFee:P}=ne(e),w=ae(e),I=(0,Le.useMemo)(()=>{if((0,xt.isNil)(s))return r;let h=s,k=[];return r.forEach(M=>{h=Et(h,f),Z(h,0)&&k.push(M)}),k},[s,r,f]),F=n&&ht(C,0),A={level:l||Rt.STANDARD,loading:n,coinId:u?.coinId,networkFee:F?void 0:P,maxNetworkFee:F?void 0:f,estimateFailed:w},_=n||I.length&&I.length===r.length,E=(0,xt.isNil)(s)||yt(s,f);return{isNetworkFeeLoading:n,estimateFailed:w,networkFeeProps:A,canApproveTxs:I,isSufficientGas:E,canApproveAll:_}},De=Co;m();c();K();var xo=t=>{for(let o=0;o<t.length;o++){let e=t[o],r=e();if(r)return r}return null},go=({walletAccount:t,canApproveTxs:o,canApproveAll:e,isSufficientGas:r})=>{let a=rt(t.walletId),u=()=>a?{type:lt.TYPE.error,message:T("wallet_extension_function_alert_wallet_unsupported")}:null,i=N(),s=de({baseCoin:i,isSufficientGas:r});return xo([u,s,()=>e?null:{type:lt.TYPE.warn,message:T("wallet_extension_function_alert_available_balance",{gasToken:i.symbol,num:o.length})}])},Oe=go;m();c();var He=x(W());K();At();oo();so();ao();ro();var We=100,Po=({unapproved:t,walletAccount:o,isSufficientGas:e,canApproveTxs:r,customGasInfo:a,isNetworkFeeLoading:u})=>{let{id:i}=t,{walletId:s,address:l}=o,n=rt(s),f=L(s),{coinId:C}=N(),P=xe(),w=Ce(),I=(0,He.useCallback)(async()=>{f({trade:"sendEvmInscriptions",all_confirmation:"cancel"}),await P({id:i})},[P,f,i]),F={onClick:I,actionType:v.ACTION_TYPE.CANCEL,btnText:T("wallet_dapp_connection_btn_reject")},A=n||u,{gasPrice:_,supportEip1559:E,gasLimitInfo:h={},gasLimit:k,maxFeePerGas:M,maxPriorityFeePerGas:b,networkFee:H}=a,q=re({fromAddr:r[0]?.txParams?.from,walletId:s,localType:ft}),ct=async()=>{try{let j=r.length,V=r[0],{from:G,to:qe,value:je}=V.txParams;if(f({trade:"sendEvmInscriptions",all_confirmation:"confirm"}),!await at({callback:I,walletId:s}))return;let{data:Ve}=await Qt({checkTypes:[dt.OVERWRITTEN],coinId:C,from:G,to:qe,amount:y(je||0),gasPrice:_}),Ke=Ve.find(({checkType:Y})=>Y===dt.OVERWRITTEN)||{},{newNonce:Je,toastType:Xe,pendingNum:ze}=Ke;if(Xe===Bt.FAILED){R.error(T("wallet_extension_function_toast_failed_single")),await Ct(1500),await P({id:i});return}let gt=ut(ze,j);if(Z(gt,We)){R.error(T("wallet_extension_function_toast_pending",{TotalNum:gt,ExceededNum:We}));return}let Pt=[],_t=[];for(let Y=0;Y<r.length;Y++){let Q=r[Y],{txParams:p}=Q,{from:Qe,to:Ze}=p;p.nonce=kt(g(ut(Je,Y))),E?(delete Q.gasPrice,p.maxFeePerGas=g(M),p.maxPriorityFeePerGas=g(b),p.type=tt.FEE_MARKET):(delete p.maxFeePerGas,delete p.maxPriorityFeePerGas,delete p.type,p.gasPrice=g(_)),p.gas=g(k),p.gasLimit=g(k),p.gasLimitInfo=h,p.gasType=a.gasType;let $e=jt(Q.txParams),wt=await q({params:$e}),It=await te(ft,wt),to={...p,value:y(p.value),gas:k,gasPrice:y(E?p.maxFeePerGas:p.gasPrice),priorityFee:y(E?p.maxPriorityFeePerGas:0),nonce:y(p.nonce),repeatTxType:vt.CONFIRMING,oldTxHash:"",inscriptionType:1},eo={extJson:JSON.stringify(to),signedTx:wt,coinId:C,coinAmount:y(p.value||0),fromAdr:Qe,toAdr:Ze,serviceCharge:H,txHash:It,txSource:bt.DAPP,inputData:p.data,accountId:s,txType:1,walletType:o?.serverWalletType};_t.push(eo),Pt.push({id:Q.id,txHash:It})}await Ft(Nt.postSendEvmInscriptions,{txList:_t}),await w({id:i,result:Pt})}catch(j){R.error(j.msg||T("wallet_home_toast_network_error")),await Ct(1500),await w({id:i,error:"Failed"})}},z={disabled:A,actionType:v.ACTION_TYPE.CONFIRM,onClick:ct};return A?[F,z]:(e||(z={actionType:v.ACTION_TYPE.FILL_UP,txId:i,coinId:C,walletId:s,address:l,receiveOnly:e}),[F,z])},Ye=Po;var _o=({unapproved:t})=>{let{coinId:o}=N(),{txParams:e={}}=t?.params?.[0],{from:r,to:a,data:u,value:i}=e,{walletId:s}=t,l=ue(t),n=L(s),f=it(t),[C,P]=(0,d.useState)({}),w=(0,d.useCallback)(q=>{P(q)},[]),{networkFeeProps:I,canApproveTxs:F,canApproveAll:A,isSufficientGas:_,isNetworkFeeLoading:E}=De({unapproved:t,walletAccount:l,customGasInfo:C}),h=Ye({unapproved:t,walletAccount:l,canApproveTxs:F,customGasInfo:C,isSufficientGas:_,isNetworkFeeLoading:E}),k=Oe({walletAccount:l,canApproveTxs:F,canApproveAll:A,isSufficientGas:_}),[M,{setTrue:b,setFalse:H}]=Ot(!1);return d.default.createElement(Mt.Container,null,d.default.createElement(zt,{title:T("wallet_extension_function_title_bulk_signing"),closeable:!1,backable:!1}),d.default.createElement(st,null,d.default.createElement(le,{...f})),d.default.createElement(st,null,d.default.createElement(ie,{onClick:b,...I})),d.default.createElement(st,{bordered:!1},d.default.createElement(me,{title:T("wallet_extension_network_address_title_walletused"),address:l.address,walletId:l.walletId,onCopyCallback:()=>{n({trade:"sendEvmInscriptions",all_confirmation:"wallet_used_address"})}})),d.default.createElement(Xt,{placeholder:!0,offsetBottom:0,borderTop:!0},d.default.createElement(ce,{...k}),d.default.createElement(v,{buttonGroup:h})),d.default.createElement(se,{visible:M,coinId:o,address:r,inputData:u,tokenAddress:a,value:y(i),onBack:H,onClose:null,onGasChange:w}))},Ue=_o;var Kn=(0,O.memo)(({unapproved:t})=>{switch(t.method){case Gt.SEND_EVM_INSCRIPTIONS:return O.default.createElement(Ue,{unapproved:t});default:break}switch(t.type){case B.ETH_SIGN:case B.PERSONAL_SIGN:case B.ETH_SIGN_TYPED_DATA:case B.ETH_GET_ENCRYPTION_PUBLIC_KEY:case B.ETH_DECRYPT:return O.default.createElement(we,{unapproved:t});case B.WATCH_ASSET:return O.default.createElement(Ne,{unapproved:t});case B.ADD_ETHEREUM_CHAIN:return O.default.createElement(Ie,{unapproved:t});default:return O.default.createElement(Be,{unapproved:t})}});export{Kn as default};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "prepub";

//# sourceMappingURL=Ethereum-WVWEJJMT.js.map
