import{a as Ri}from"./chunk-FPD7KVNO.js";import{a as zd}from"./chunk-MY53LEOF.js";import{g as ci,i as ui,j as di,k as fo}from"./chunk-CQ2K3QEZ.js";import{a as li}from"./chunk-VUWJ3UDJ.js";import{a as ai}from"./chunk-PXOMNFEE.js";import{b as ii}from"./chunk-M3BU7MMF.js";import{a as ti,b as en,c as Kt,d as Gr,e as ri,f as st,g as oi,h as ni}from"./chunk-YOTOBB67.js";import{a as si}from"./chunk-GITGXMEO.js";import{a as Hr}from"./chunk-UMBG4UN5.js";import{b as Ja,k as Qa}from"./chunk-BY7EJ2OB.js";import{a as Qo,b as ss,c as $a}from"./chunk-RZ42FYW3.js";import{b as ei}from"./chunk-CP4V5WQH.js";import"./chunk-HTDEED7X.js";import{a as Jo,b as Ka}from"./chunk-2PVY7Q74.js";import"./chunk-AQEDLRCW.js";import{a as Za}from"./chunk-JXXKPVB7.js";import{a as nt,c as $o,d as Ur}from"./chunk-3LOAATWV.js";import{a as qa}from"./chunk-OR3IMHNP.js";import"./chunk-G2LUKHAZ.js";import"./chunk-BITK2ZRS.js";import"./chunk-GUYSHF5X.js";import"./chunk-IPY7DOYN.js";import"./chunk-NWBT27VI.js";import"./chunk-7GRBMPLB.js";import"./chunk-H2MP374E.js";import{a as Vo}from"./chunk-JFCE4WMN.js";import"./chunk-2CQDB45Y.js";import"./chunk-TCY2QN26.js";import"./chunk-TAMFXRQS.js";import"./chunk-SWNKITDG.js";import"./chunk-PCT6WF3F.js";import{g as Ga,h as ja}from"./chunk-7G3IOU2S.js";import{a as Wr,d as za}from"./chunk-FSSAJWUE.js";import{a as Wa}from"./chunk-EYUJFPID.js";import"./chunk-QXSGLFJ4.js";import"./chunk-LTVFH3JK.js";import"./chunk-UX45LV4J.js";import{a as Ya}from"./chunk-S2L2SUZT.js";import"./chunk-WAOH7NV4.js";import{e as Sr,f as Fa}from"./chunk-Z7MVEL6Q.js";import"./chunk-EQQ4TY26.js";import{a as La}from"./chunk-BSJ5U7SB.js";import"./chunk-RQ4URFJV.js";import"./chunk-A7QDOMG2.js";import"./chunk-PCN4TJH3.js";import{a as Ba}from"./chunk-UV4CBWDM.js";import{i as Ca,k as Oa}from"./chunk-JZYFGUUR.js";import"./chunk-55MBPFME.js";import"./chunk-ITV6J4J2.js";import"./chunk-E4R5GU2A.js";import{A as Fi,B as tn,C as Bi,D as dt,E as Di,F as Mi,G as Pi,H as rn,a as mo,b as ie,c as Ue,d as fi,e as mi,f as pi,g as hi,h as vi,i as gi,j as _i,k as xi,l as Si,m as wi,n as Ti,o as Ze,p as Ei,q as yi,r as Ai,s as bi,t as Ni,u as ki,v as as,w as Ii,x as Ci,y as Oi,z as Li}from"./chunk-RDQCNJVD.js";import{a as V,d as qe}from"./chunk-GFKALINB.js";import"./chunk-OF3HXDD4.js";import{d as uo}from"./chunk-W5VVGPTJ.js";import"./chunk-RDUIYFM4.js";import"./chunk-YFG3KJV4.js";import{S as Va,X as Xa}from"./chunk-QAD7XKBR.js";import"./chunk-FSHQROIB.js";import"./chunk-RSZRDNEQ.js";import"./chunk-LWWOGE47.js";import{e as Zo}from"./chunk-PNKC4I7V.js";import"./chunk-OBDMMZ5P.js";import{a as Ko}from"./chunk-AWV3UGPG.js";import"./chunk-ZFY6KTVJ.js";import"./chunk-LQ6EG3M7.js";import"./chunk-EFXUUWZM.js";import"./chunk-SXT2HSEA.js";import"./chunk-X6MJ7FAJ.js";import"./chunk-4QGZMEGU.js";import"./chunk-JGVOOQUI.js";import"./chunk-OL5PZGTP.js";import"./chunk-T6BAWHSV.js";import"./chunk-NZFRZUU7.js";import"./chunk-GKPU7ZYD.js";import{a as Xo,b as Ua,g as Ha}from"./chunk-IY5XPXLD.js";import"./chunk-N6T7YZKN.js";import{d as qo}from"./chunk-CE2I3GSK.js";import"./chunk-SPMBQ3GG.js";import"./chunk-W3BHXSAD.js";import{e as Na}from"./chunk-KWEOQTFQ.js";import"./chunk-MYLTZKPJ.js";import"./chunk-RAK5MQVM.js";import{O as Ia,o as ka}from"./chunk-ILYGYWTN.js";import"./chunk-HOK5U34D.js";import"./chunk-XPB5VA3I.js";import{a as Fd,c as Bd,e as Dd}from"./chunk-XSNWL3NI.js";import{a as Md,c as Pd,e as Rd}from"./chunk-IOMWHGY3.js";import{a as Ld}from"./chunk-EDYYUNM2.js";import"./chunk-FOI3TQUA.js";import"./chunk-Y3W2FGGC.js";import"./chunk-6SKAHEOE.js";import"./chunk-QYGNKIL6.js";import{E as Ra,h as Da,i as Ma,r as Pa}from"./chunk-WWF4GAYE.js";import"./chunk-YITM3H6Z.js";import"./chunk-IQFXZKFW.js";import"./chunk-7BFUGHAL.js";import"./chunk-JVN7YJ6W.js";import"./chunk-VSX7BSN7.js";import"./chunk-V4V6C6NY.js";import{b as Ce}from"./chunk-ZQ5A3KPQ.js";import"./chunk-BGUY7SH3.js";import{s as so,w as ae}from"./chunk-MJYAUOKI.js";import{a as Id}from"./chunk-LI3NFLG3.js";import{a as B,c as jo,h as Cd,i as Od,l as Ta,m as zr,p as Ea,r as ya,s as Aa}from"./chunk-FCCCJLF6.js";import{Ja as xr,Ka as io,La as lo,Ma as co}from"./chunk-4Z4GXCHB.js";import{a as _a,n as Ho,qb as os,y as ct}from"./chunk-FK3ETA6I.js";import{aa as rs,fa as Dt,k as Sa,m as es,r as ts,t as Go}from"./chunk-QZDHFNHK.js";import"./chunk-6KPQELH2.js";import{a as Qn}from"./chunk-EJQOS3F4.js";import"./chunk-F2C2DYTN.js";import"./chunk-LHHZ5TAA.js";import"./chunk-PI6QLVMS.js";import"./chunk-QY4HIIR3.js";import"./chunk-XFWUEPSK.js";import"./chunk-MNNY2ODL.js";import"./chunk-VCAWL4NW.js";import"./chunk-XVIU24G2.js";import"./chunk-Q277JDUA.js";import"./chunk-2LDYLNUY.js";import{b as ut,c as ba}from"./chunk-KCITCUTL.js";import"./chunk-YZ3HCB4K.js";import"./chunk-EZ7VUFME.js";import{b as ns}from"./chunk-T2OWRX3Y.js";import"./chunk-C3FJ2D4V.js";import"./chunk-C5ZJZEPI.js";import"./chunk-LGHM3MOC.js";import{g as Yo}from"./chunk-2FULUWWG.js";import{a as wa}from"./chunk-SLEUZTBQ.js";import"./chunk-4X6ZAX3L.js";import{c as T}from"./chunk-4QSQKIBZ.js";import{b as Bt,c as no}from"./chunk-OXVQDEZW.js";import{j as Ft,m as oo}from"./chunk-X3G52GGX.js";import"./chunk-WUKT6J7S.js";import"./chunk-FTJCOLFJ.js";import{Ca as Xn,D as J,Db as $n,E as Se,Jc as xa,Kb as Jn,R as pa,Vc as ao,a as ua,aa as ha,b as bd,da as ar,ga as Ro,hb as kd,ia as Pr,ja as zo,kb as va,lb as Rr,m as rt,mc as Uo,u as re,vb as Wo,xb as ga,z as se,za as Ie}from"./chunk-QG673PNL.js";import"./chunk-ZUFARSFM.js";import{A as _r,F as Vn,K as ma,b as da,c as to,g as ro,n as gr,p as ve,q as sr,v as Kn,w as Mr,y as fa}from"./chunk-6MTHEPGF.js";import{I as ne,J as Nd,m as D,w as y}from"./chunk-ZQQ7HNWV.js";import"./chunk-Y62GSKHT.js";import"./chunk-2BXFMFMK.js";import{M as ot,R as Le,S as At,Y as Z,c as Be}from"./chunk-ZOQTSYT4.js";import{a as K}from"./chunk-ADZWCU3Q.js";import"./chunk-AXQY4CD5.js";import"./chunk-ZPRPROG4.js";import"./chunk-FDI7TLXH.js";import"./chunk-L4HTIIR6.js";import"./chunk-733NI6T7.js";import"./chunk-5TB3ZTAO.js";import"./chunk-EYWGNJVY.js";import"./chunk-PIGJQYQ3.js";import"./chunk-KNDZEUJE.js";import"./chunk-YSXN7JDZ.js";import"./chunk-TBVIGR5T.js";import"./chunk-FHQVMQUK.js";import"./chunk-XNS2NFYY.js";import{c as nr,f as N,h as yt,m as f,o as m}from"./chunk-REC7XVZY.js";var Zl=nr((Dy,ql)=>{"use strict";f();m();ql.exports=Ff;var jl="\u0591-\u07FF\uFB1D-\uFDFD\uFE70-\uFEFC",Yl="A-Za-z\xC0-\xD6\xD8-\xF6\xF8-\u02B8\u0300-\u0590\u0800-\u1FFF\u200E\u2C00-\uFB1C\uFE00-\uFE6F\uFEFD-\uFFFF",Of=new RegExp("^[^"+Yl+"]*["+jl+"]"),Lf=new RegExp("^[^"+jl+"]*["+Yl+"]");function Ff(t){return t=String(t||""),Of.test(t)?"rtl":Lf.test(t)?"ltr":"neutral"}});var yo=nr((Yy,Jl)=>{f();m();Jl.exports=globalThis.Slate});var Sc=nr(Ut=>{"use strict";f();m();Object.defineProperty(Ut,"__esModule",{value:!0});var Yf=typeof window<"u"&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform),Bs={alt:"altKey",control:"ctrlKey",meta:"metaKey",shift:"shiftKey"},qf={add:"+",break:"pause",cmd:"meta",command:"meta",ctl:"control",ctrl:"control",del:"delete",down:"arrowdown",esc:"escape",ins:"insert",left:"arrowleft",mod:Yf?"meta":"control",opt:"alt",option:"alt",return:"enter",right:"arrowright",space:" ",spacebar:" ",up:"arrowup",win:"meta",windows:"meta"},vc={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,pause:19,capslock:20,escape:27," ":32,pageup:33,pagedown:34,end:35,home:36,arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,insert:45,delete:46,meta:91,numlock:144,scrolllock:145,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222};for(No=1;No<20;No++)vc["f"+No]=111+No;var No;function Fn(t,e,r){e&&!("byKey"in e)&&(r=e,e=null),Array.isArray(t)||(t=[t]);var o=t.map(function(i){return gc(i,e)}),n=function(l){return o.some(function(d){return _c(d,l)})},a=r==null?n:n(r);return a}function Zf(t,e){return Fn(t,e)}function Kf(t,e){return Fn(t,{byKey:!0},e)}function gc(t,e){var r=e&&e.byKey,o={};t=t.replace("++","+add");var n=t.split("+"),a=n.length;for(var i in Bs)o[Bs[i]]=!1;var l=!0,d=!1,c=void 0;try{for(var g=n[Symbol.iterator](),x;!(l=(x=g.next()).done);l=!0){var v=x.value,h=v.endsWith("?")&&v.length>1;h&&(v=v.slice(0,-1));var p=Ds(v),s=Bs[p];(a===1||!s)&&(r?o.key=p:o.which=xc(v)),s&&(o[s]=h?null:!0)}}catch(_){d=!0,c=_}finally{try{!l&&g.return&&g.return()}finally{if(d)throw c}}return o}function _c(t,e){for(var r in t){var o=t[r],n=void 0;if(o!=null&&(r==="key"&&e.key!=null?n=e.key.toLowerCase():r==="which"?n=o===91&&e.which===93?91:e.which:n=e[r],!(n==null&&o===!1)&&n!==o))return!1}return!0}function xc(t){t=Ds(t);var e=vc[t]||t.toUpperCase().charCodeAt(0);return e}function Ds(t){return t=t.toLowerCase(),t=qf[t]||t,t}Ut.default=Fn;Ut.isHotkey=Fn;Ut.isCodeHotkey=Zf;Ut.isKeyHotkey=Kf;Ut.parseHotkey=gc;Ut.compareHotkey=_c;Ut.toKeyCode=xc;Ut.toKeyName=Ds});var ld=nr((WF,id)=>{f();m();var Qp=Bd(),eh=zd(),th=Fd();function rh(t,e,r){for(var o=-1,n=e.length,a={};++o<n;){var i=e[o],l=Qp(t,i);r(l,i)&&eh(a,th(i,t),l)}return a}id.exports=rh});var ud=nr((GF,cd)=>{f();m();var oh=ld(),nh=Dd();function sh(t,e){return oh(t,e,function(r,o){return nh(t,o)})}cd.exports=sh});var fd=nr((qF,dd)=>{f();m();var ah=Md();function ih(t){var e=t==null?0:t.length;return e?ah(t,1):[]}dd.exports=ih});var pd=nr((VF,md)=>{f();m();var lh=fd(),ch=Pd(),uh=Rd();function dh(t){return uh(ch(t,void 0,lh),t+"")}md.exports=dh});var vd=nr((JF,hd)=>{f();m();var fh=ud(),mh=pd(),ph=mh(function(t,e){return t==null?{}:fh(t,e)});hd.exports=ph});f();m();var vr=N(K()),Br=N(Qn());f();m();var Ji=N(K()),is=N(ct());ne();f();m();ne();Ie();no();oo();var Wd="8000",on=()=>{let t=nt();return B(async({coinId:e,address:r,inputData:o})=>{let n=await t({coinId:e,address:r,fromAddr:r,scenario:Sa.SCENARIO_SEND_COIN}),a=n,{gasUnitPrice:i}=n;if(o){let{data:{gasLimit:d}}=await Ft(Bt.getAptosGasLimit,{inputData:o});a=d}else a=Wd;let l=D.mul(i,a);return{...n,networkFee:l,maxGasAmount:a,gasUnitPrice:i}})},zi=()=>{let t=$o({localType:se});return B(async({to:e,from:r,amount:o,baseCoinId:n,metaAddress:a,sequenceNumber:i,maxGasAmount:l,gasUnitPrice:d,protocolType:c,chainId:g,expirationTimestampSecs:x,tyArg:v})=>{let p={base:{sequenceNumber:i,chainId:g,maxGasAmount:l,gasUnitPrice:d,expirationTimestampSecs:x}},s={amount:o,recipientAddress:e};return n===0&&(p.type=Go.TRANSFER,p.data=s),n!==0&&c===ao.APTOS_FUNGIBLE_TOKEN&&(p.type=Go.FUNGIBLE_ASSET_TRANSFER,p.data={...s,fungibleAssetMetadataAddress:a}),n!==0&&c===ao.APTOS_TOKEN&&(p.type=Go.TOKEN_TRANSFER,p.data={...s,tyArg:v}),await t({params:p,fromAddr:r})})};f();m();ne();Ie();var Wi=()=>B(async({to:t,toes:e,from:r,value:o,values:n,budget:a,gasPrice:i,inputCoins:l,tokenInputCoins:d,baseCoinId:c})=>{let g=e?.length?e:[t],x=n?.length?n:[o],v=l.map((s={})=>{let{digest:_,version:w,objectId:S}=s;return{digest:_,version:w,objectId:S}}),h=new Qa;if(h.setGasPrice(i),h.setGasPayment(v||[]),h.setSender(r),a&&h.setGasBudget(a),c===0){let s=h.splitCoins(h.gas,x?.map(_=>h.pure(_)));g.forEach((_,w)=>{h.transferObjects([s[w]],h.pure(_))})}else if(d?.length>1){let s=d.slice(1).map(S=>h.object(S.objectId)),_=h.object(d[0].objectId);h.mergeCoins(_,s);let w=h.splitCoins(_,[h.pure(o)]);h.transferObjects([w],h.pure(t))}else{let s=h.splitCoins(h.object(d[0].objectId),[h.pure(o)]);h.transferObjects([s],h.pure(t))}let p=Ja(await h.build({client:li}));return{tx:h,txBytes:p}}),nn=()=>{let t=nt(),e=Wi();return B(async({to:r,from:o,value:n,values:a,toes:i,coinId:l,baseCoinId:d})=>{let c=a?.length?a?.reduce((h,p)=>D.add(h,p),0):n,g=await t({coinId:l,address:o,value:c,toAddr:i?.[0]||r});return(await e({...g,to:r,toes:i,from:o,value:n,coinId:l,values:a,baseCoinId:d}))?.tx?.blockData?.gasConfig?.budget||"0"})},Ui=()=>{let t=Wi(),e=nt(),r=$o({localType:Se});return B(async({to:o,toes:n,values:a,from:i,coinId:l,value:d,baseCoinId:c})=>{let g=a?.length?a?.reduce((_,w)=>D.add(_,w),0):d,x=await e({value:g,coinId:l,address:i,toAddr:n?.[0]||o}),{tx:v,txBytes:h}=await t({...x,value:d,coinId:l,to:o,toes:n,from:i,values:a,baseCoinId:c}),s=await r({params:{type:"raw",data:h},fromAddr:i});return{tx:v,txBytes:h,signedTx:s}})},Hi=t=>{let e=Oa(),r=Ca(),o=Ur({coinId:t,txSource:xa.NORMAL});return B(async({tx:n,to:a,from:i,txBytes:l,coinAmount:d,signedTx:c,walletId:g})=>{let{signature:x,hash:v}=c||{},h=e(g)||r;return await o({tx_bytes:l,signatures:[x],request_type:"WaitForEffectsCert"},{txHash:v,coinAmount:d,accountId:g,fromAdr:i,toAdr:a,walletType:h?.serverWalletType,serviceCharge:n?.blockData?.gasConfig?.budget||"0"})})};Ie();f();m();f();m();var po=N(ct()),Gi=N(K());var ft=(t,e)=>r=>{let o=(0,po.useSelector)(t),n=(0,po.useDispatch)(),a=l=>{e&&n(e(l))},i=B(a);return(0,Gi.useEffect)(()=>{if(r===void 0)return;let l=typeof r=="function"?r():r;i(l)},[r,i]),[o,a]},ji=t=>()=>{let e=(0,po.useDispatch)();return(...o)=>{t&&e(t(...o))}};var De=ft(hi,ki),te=ft(vi,Ni),sn=ft(gi,tn),an=ft(_i,Bi),mt=ft(mi,bi),Yi=ft(yi,Li),Vh=ft(Ai,Fi),_e=ft(xi,Ii),qi=ji(Mi),pt=ft(wi,Ci),ht=ft(Ti,Oi),jr=ft(pi,Di);f();m();var ln=N(K()),Vi=N(ct());var cn=N(rt());Ie();f();m();var ho=N(K()),Zi=N(ct());Ie();var at=()=>{let{isRpcMode:t}=(0,Zi.useSelector)(qo);return t},Ud=[se,re,Se,J],Hd=()=>{let t=Ko(),e=La(),r=(0,ho.useMemo)(()=>t.filter(({appBaseChain:o,localType:n})=>o===pa?.ETHEREUM?!0:Ud.includes(n)),[t]);return(0,ho.useMemo)(()=>r.map(({image:o,chainName:n,localType:a,...i})=>{let l=e.find(d=>d.localType===a);return{...l||i,chainName:n,icon:o,chainId:[se,re,Se,J].includes(a)?ns(i?.chainId):l?.realChainIdHex||ns(i?.chainId)}}),[e,r])},Gd=()=>{let{rpcNetworks:t}=Hr();return(0,ho.useMemo)(()=>ti(t),[t])},Ki=()=>{let t=at(),e=Gd(),r=Hd();return(0,ho.useMemo)(()=>t?e:r,[t,e,r])};var jd=()=>{let t=(0,Vi.useSelector)(Ha);return(0,ln.useCallback)(e=>{let r=t.filter(o=>o.chainId===e&&!o.isDeleted);return(0,cn.uniqBy)(r,"address")},[t])},Yd=(t,e)=>{let r=at(),{data:o,reload:n,loadingMore:a,listRef:i}=ii({aggregation:!1,chainIds:[en(t)],symbolLike:e||void 0},{filter:!1,reloadDeps:[t,e],beforeRequest(){return r||!t?{list:[],pageNo:0,isNoMore:!0}:!1}});return{list:jo(()=>o?.list??[],[o?.list]),listRef:i,loadingMore:a,refreshDom:n}},Xi=(t,e)=>{let{chainId:r,localType:o}=t||{},[n,a]=(0,ln.useState)([]),i=at(),l=ya(e,{wait:300}),{list:d,listRef:c,refreshDom:g,loadingMore:x}=Yd(r,l),v=jd(),h=nt(),p=Wr(J);zr(async()=>{if(o===J){let{coinFeeList:_}=await h({coinId:Pr,address:p,fromAddr:p,toAddr:p,value:"0"});a(_)}},[o]);let s=jo(()=>{if(o===J&&n?.length){let _=n.map(({coinId:S})=>S);return d.filter(({coinId:S})=>(0,cn.includes)(_,S)).map(S=>{let{tokenId:k,originSymbol:C}=n.find(z=>z?.coinId===S?.coinId);return{...S,tokenId:k,originSymbol:C}})}return d},[o,d,n]);return jo(()=>i?{list:v(r)??[],listRef:null,refreshDom:null,loadingMore:!1}:{list:s,listRef:c,refreshDom:g,loadingMore:x},[r,s,d,c,x,i,v])},vo=()=>{let t=at(),e=ja(),r=Na();return B(async({coinId:o,chainId:n,contractAddress:a})=>{if(t)try{return(await e(n,[a||""]))?.[0]?.price||0}catch{return 0}return r?.[o]?.coinToUSDRate||"0"},[t])};f();m();var $i=N(K());var wr=t=>{let[e]=De(),r=t||e?.rpcUrl;return(0,$i.useCallback)(async()=>r?await Ua(r):{},[r])};var un=t=>{let[e]=De(),r=t||e?.rpcUrl;return ui(r)};var qd=(t,e)=>{let[r]=te(),{ready:o=!0,onSuccess:n}=e||{},a=di(t);Ta(async()=>{let i=await a(r?.chainId);return{isSupportEip1559:i?.[0]?.isSupportEip1559||!1,gasPriceLevels:i}},{onSuccess:n,pollingInterval:7e3,ready:!!r?.chainId&&!!o})},Qi=()=>{let[t]=te(),[e]=De(),r=(0,is.useDispatch)(),[o,n]=(0,Ji.useState)([]),[,a]=jr(),i=Wr(t?.localType),l=i&&ut(i,t?.localType);return qd(e?.rpcUrl,{ready:!!e?.rpcUrl&&!t?.coinId,onSuccess:({isSupportEip1559:d,gasPriceLevels:c})=>{a(d),r(as(c)),n(c)}}),Za({coinId:t?.coinId,chainId:t?.chainId,address:l},{ready:!!t?.coinId&&![se,re,Se,J].includes(t?.localType),onSuccess:d=>{let{gasPrice:c,needExtFee:g}=d;r(rn(g)),a(c?.supportEip1559||!1),n(ss(c)),r(as(ss(c)))}}),o};var dn=()=>{let t=Sr(ar,{withPrice:!0}),e=nt(),r=qa();return B(async({from:o,to:n,coinId:a,chainId:i})=>{let l=await e({coinId:a,toAddr:n,address:o,fromAddr:o})||{},d=await r({from:o,chainId:i,coinId:a,bizLine:6,simulateTransactionParamList:[{sigVerify:!1,replaceRecentBlockhash:!0}],checkTypes:[rs.TX_ANALYZE]}),{simulateTransactionResultList:c}=d?.[rs.TX_ANALYZE]||{},{unitGasLimit:g}=c[0]||{},{fee:x,feelimit:v,computeUnitPrice:h,rent:p,solRent:s}=l;if(x){let{priorityFee:_,priorityGasPrice:w,priorityGasLimit:S}=ei(v,h,g),k=D.add(x,_),C=D.div(k,10**t?.decimals);return{rent:p,solRent:s,networkFee:C,networkFeeInt:k,computeUnitLimit:S,computeUnitPrice:w,networkFeeMarket:D.mul(C,t?.currencyPrice)}}return{estimateFailed:!0}})},el=()=>{let t=Sr(zo,{withPrice:!0}),e=nn();return B(async({coinId:r,from:o,to:n,value:a,baseCoinId:i})=>{let l=await e({to:n,from:o,value:a,coinId:r,baseCoinId:i}),d=D.div(l,10**t?.decimals);return{networkFee:d,networkFeeInt:l,networkFeeMarket:D.mul(d,t?.currencyPrice)}})},fn=t=>{let e=Sr(t||Pr,{withPrice:!0});return B(async({to:r,chainId:o,contractAddress:n})=>{let a={address:r,type:"Transfer",contractAddress:n,chainId:o||e?.chainId},l=(await ai(a))?.data?.fee||"0",d=D.div(l,10**(e?.decimals||0));return{networkFee:d,networkFeeInt:l,networkFeeMarket:D.mul(d,e?.currencyPrice)}})},tl=()=>{let t=Sr(Ro,{withPrice:!0}),e=on();return B(async({coinId:r,address:o,inputData:n})=>{let{networkFee:a}=await e({coinId:r,address:o,inputData:n}),i=D.div(a,10**t?.decimals);return{networkFee:i,networkFeeInt:a,networkFeeMarket:D.mul(i,t?.currencyPrice)}})};var qn=N(ct());Ie();Jn();f();m();var je=N(K());ne();f();m();var Vt=N(K());var mn=N(Be());f();m();f();m();var go=N(K());f();m();var rl=N(Qn());function Zd(){let t=(0,rl.useHistory)(),[e,r]=Yi(),o=(h,p)=>(s=!0)=>{e!==p&&r(p),s?t.replace(h):t.push(h)},n=h=>t.location.pathname===h,a=o(io,mo.ADD_ADDRESS),i=o(lo,mo.CONFIRM),l=o(co,mo.SEND),d=o(xr,mo.SELECT_TYPE),c=n(xr),g=n(lo),x=n(co),v=n(io);return{isConfirmPage:g,isHomePage:c,isSendPage:x,isAddressPage:v,gotoAddressPage:a,gotoConfirmPage:i,gotoSendPage:l,gotoHomePage:d}}var Ke=Zd;function Kd(){let[t]=De(),[e]=te(),[r]=_e(),{gotoHomePage:o,gotoAddressPage:n,isConfirmPage:a,isSendPage:i,isAddressPage:l,isHomePage:d}=Ke(),c=(0,go.useCallback)(()=>{!t&&!e?.symbol&&!d&&o()},[t,e,d,o]),g=(0,go.useCallback)(()=>{r.length<=0&&!l&&n()},[r,l,n]);(0,go.useLayoutEffect)(()=>{l?c():(a||i)&&(c(),g())},[c,g,l,a,i])}var ol=Kd;function Vd(){return ol(),null}var nl=Vd;f();m();var Tr={root:"_root_3x3tv_1",container:"_container_3x3tv_6",okgLayout:"_okgLayout_3x3tv_10",headerBox:"_headerBox_3x3tv_44",header:"_header_3x3tv_44",footer:"_footer_3x3tv_181"};function Xd({children:t}){return Vt.default.createElement(T.Box,{className:Tr.footer},t)}function $d({children:t,footer:e,useOkg:r=!0,headerProps:o={}}){let n=r?Vt.default.Fragment:T.Box;return Vt.default.createElement(T.FlexBox,{className:Tr.root,direction:T.DIRECTION.vertical},Vt.default.createElement(T.Container,{className:(0,mn.default)(Tr.container,r&&Tr.okgLayout)},Vt.default.createElement(n,{className:(0,mn.default)(!r&&Tr.headerBox)},Vt.default.createElement(Ri,{...o,className:(0,mn.default)(Tr.header,o.className)})),t),Vt.default.createElement(Xd,null,e),Vt.default.createElement(nl,null))}var ir=$d;f();m();var Mt=N(K());var ls=N(Be());f();m();var Er={root:"_root_1f6pc_1",icon:"_icon_1f6pc_101",title:"_title_1f6pc_120",subtitle:"_subtitle_1f6pc_140",tip:"_tip_1f6pc_168",tipIcon:"_tipIcon_1f6pc_172"};function Jd(t){let{icon:e,title:r,subtitle:o,tip:n,className:a,titleClassName:i,subtitleClassName:l}=t;return Mt.default.createElement(T.Box,{className:(0,ls.default)(Er.root,a)},e&&Mt.default.createElement(T.Box,{className:Er.icon},e),Mt.default.createElement(T.Box,null,Mt.default.createElement(T.Box,{className:(0,ls.default)(Er.title,i)},r),Mt.default.createElement(T.Box,{className:Er.subtitle},Mt.default.createElement(T.Box,{className:l},o),n&&Mt.default.createElement(_r,{title:n,placement:_r.DIRECTION.bottom,maxWidth:240},Mt.default.createElement(T.Box,{className:Er.tip},Mt.default.createElement(ot,{className:`okds-question-mark-circle ${Er.tipIcon}`}))))))}var Yr=Jd;f();m();var it=N(K());f();m();var Qd={MANY_TO_MANY:"MANY_TO_MANY",ONE_TO_MANY:"ONE_TO_MANY",MANY_TO_ONE:"MANY_TO_ONE"},X=Qd;ne();var _o=N(Be());Ie();f();m();var Ge={root:"_root_1cmo5_2",select:"_select_1cmo5_99",titleBox:"_titleBox_1cmo5_120",title:"_title_1cmo5_120",tip:"_tip_1cmo5_147",card:"_card_1cmo5_163",icon:"_icon_1cmo5_236",checkBox:"_checkBox_1cmo5_252",check:"_check_1cmo5_252",disabled:"_disabled_1cmo5_268",active:"_active_1cmo5_272",disabledContent:"_disabledContent_1cmo5_275",name:"_name_1cmo5_278",subtitle:"_subtitle_1cmo5_285"};function ef(t){let{icon:e,name:r,mode:o,disable:n,active:a,onSelected:i,subtitle:l}=t,d=()=>{i(o);let c={[X.ONE_TO_MANY]:"1tomany",[X.MANY_TO_MANY]:"manytomany",[X.MANY_TO_ONE]:"manyto1"};Da({button_name:c[o]})};return it.default.createElement(T.Box,{className:(0,_o.default)(Ge.card,{[Ge.active]:a,[Ge.disabled]:n}),onClick:d},it.default.createElement("img",{src:e,height:72,alt:"",className:(0,_o.default)(Ge.icon,{[Ge.disabledContent]:n})}),it.default.createElement(T.Box,{className:(0,_o.default)(Ge.name,{[Ge.disabledContent]:n})},r),l&&it.default.createElement(T.Box,{className:(0,_o.default)(Ge.subtitle,{[Ge.disabledContent]:n})},l),a&&it.default.createElement(T.Box,{className:Ge.checkBox},it.default.createElement(sr.Circle,{checked:!0})))}function tf(){let t=y("wallet_extension_type_title_transaction_method");return it.default.createElement(T.FlexBox,{className:Ge.titleBox,align:T.ALIGN.center},it.default.createElement(T.Box,{className:Ge.title},t))}function rf(t){let{mode:e,onSelected:r,selectedNetwork:o}=t,n=Yo({light:"/cdn/assets/imgs/235/15D8A8A385BD668B.png",dark:"/cdn/assets/imgs/245/A1F7D56C14F82C12.png"}),a=Yo({light:"/cdn/assets/imgs/235/3043DD8BFB521773.png",dark:"/cdn/assets/imgs/245/5BE287EAEC2D70D7.png"}),i=Yo({light:"/cdn/assets/imgs/235/A1F8C8D99B9BE99C.png",dark:"/cdn/assets/imgs/245/2815C6DD084226C7.png"}),l={[X.ONE_TO_MANY]:{mode:X.ONE_TO_MANY,icon:n,disable:o?.localType===J,name:y("wallet_extension_type_pic_one_to_many")},[X.MANY_TO_ONE]:{mode:X.MANY_TO_ONE,icon:a,name:y("wallet_extension_type_pic_many_to_one")},[X.MANY_TO_MANY]:{mode:X.MANY_TO_MANY,icon:i,name:y("wallet_extension_type_pic_many_to_many")}};return it.default.createElement(T.Box,{className:Ge.root},it.default.createElement(tf,null),it.default.createElement(T.Box,{className:Ge.select},Object.values(l).map((d,c)=>it.default.createElement(ef,{key:c,onSelected:r,active:d.mode===e,...d}))))}var sl=rf;f();m();var xe=N(K());var us=N(Be()),al=N(_a());ne();Ie();f();m();var Pt={root:"_root_rlpgb_1",title:"_title_rlpgb_4",inputWrap:"_inputWrap_rlpgb_22",option:"_option_rlpgb_25",inputPopup:"_inputPopup_rlpgb_35",show:"_show_rlpgb_51",loadingWrap:"_loadingWrap_rlpgb_54","select-up-active":"_select-up-active_rlpgb_60",selectUpActive:"_select-up-active_rlpgb_60","item-image":"_item-image_rlpgb_64",itemImage:"_item-image_rlpgb_64","arrow-down-icon":"_arrow-down-icon_rlpgb_68",arrowDownIcon:"_arrow-down-icon_rlpgb_68"};var of="0x",nf=async(t,e)=>{try{return!Xa(e)||await t.eth.getCode(e)===of}catch{return!0}},sf=async(t,e)=>{let r=new e.eth.Contract(al.default,t),[o,n,a]=await Promise.all([r.methods.symbol().call(),r.methods.decimals().call(),r.methods.name().call()]);return{name:a,symbol:o,decimals:n}},cs=!1;function af(t,e){let{value:r,options:o,disabled:n,selectedNetwork:a,onSelect:i,onInputChange:l,onCustomContractChange:d,refreshInfiniteScrollRef:c,tokensLoadingMore:g}=t,x=(0,xe.useRef)(),[v,h]=(0,xe.useState)(!1),[p,s]=(0,xe.useState)(!1),[_,w]=(0,xe.useState)(!1),[S,k]=(0,xe.useState)(r?.address||""),C=j=>(cs=!0,w(!1),k(""),i(j?{...j,custom:!1}:null)),z=B(async({target:j})=>{k(j?.value)},[a?.rpcUrl]);(0,xe.useEffect)(()=>{l?.(S)},[S,l]);let U=async()=>{let j=o.find(({address:L})=>!!S&&L===S);if(j)C(j);else if(!cs&&S&&![se,re,Se,J].includes(a?.localType)){let L=await Xo(a?.rpcUrl);if(await nf(L,S)===!1){let W=await sf(S,L);d?.({...W,address:S,custom:!0}),w(!1)}else w(!0),d?.(null)}cs=!1};(0,xe.useEffect)(()=>{k(""),w(!1)},[a?.chainId]);let q=at();(0,xe.useEffect)(()=>{k(""),w(!1)},[q]);let M=S&&_,O=!!o?.length;(0,xe.useEffect)(()=>{!v||(O?O&&s(!0):s(!1))},[O]),(0,xe.useLayoutEffect)(()=>{p&&c?.()},[p,c]),Ea(()=>{h(!1),s(!1)},x);let G=y("wallet_extension_type_placeholder_select_crypto");return xe.default.createElement(T.Box,{className:Pt.root},xe.default.createElement(T.Box,{className:Pt.title},y("wallet_extension_type_title_select_coin")),xe.default.createElement("div",{className:Pt.inputWrap},xe.default.createElement(ve,{onRef:j=>{x.current=j},style:{width:"100%"},error:M&&y("wallet_manage_crypto_custom_crypto_errortip_invalid_address"),placeholder:G,value:r&&r?.custom===!1?r?.symbol:S||r?.address,onChange:z,onBlur:()=>{U()},onFocus:()=>{h(!0),O&&s(!0)},size:ve.SIZE.xl,disabled:n,cleanable:!0,readonly:r&&r?.custom===!1&&"readonly",suffix:xe.default.createElement(Ce,{className:(0,us.default)({[Pt["select-up-active"]]:p}),icon:"okds-arrow-chevron-down-md",size:Ce.SIZE.xs}),onClear:()=>C(null)}),!!p&&xe.default.createElement("div",{ref:e,className:(0,us.default)(Pt.inputPopup,{[Pt.show]:p})},o.map(j=>{let{image:L,imageUrl:P,symbol:W}=j;return xe.default.createElement("div",{className:Pt.option,key:W,onClick:()=>{C(j)}},xe.default.createElement(Ce,{className:Pt.itemImage,src:L||P,text:W,size:Ce.SIZE.md}),W)}),!!g&&xe.default.createElement("div",{className:Pt.loadingWrap},xe.default.createElement(At.Circle,{size:At.SIZE.md})))))}var il=xe.default.forwardRef(af);f();m();var vt=N(K());ne();f();m();var lf=t=>`${wa()}${t}`,ll=lf;f();m();var qr={root:"_root_tc3ej_2",title:"_title_tc3ej_99",item:"_item_tc3ej_122",question:"_question_tc3ej_138",answer:"_answer_tc3ej_155"};function cf(){let t=ll("/cdn/assets/files/235/C7BA61E964654AF6.csv"),e=y("wallet_extension_faq_maintitle_question"),r=[{question:y("wallet_extension_faq_title_distinction"),answer:vt.default.createElement("pre",null,y("wallet_extension_faq_text_one_to_many"))},{question:y("wallet_extension_sending_title_multisender_network"),answer:vt.default.createElement("pre",null,y("wallet_extension_sending_subtitle_multisender_evm"))},{question:y("wallet_extension_faq_title_what_transfer"),answer:vt.default.createElement("pre",null,y("wallet_extension_faq_text_transfer_definition"))},{question:y("wallet_extension_faq_title_how_transfer"),answer:vt.default.createElement("pre",null,y("wallet_extension_faq_text_transfer_method",{btn:vt.default.createElement(ro,{type:ro.TYPE.primary,href:t,weight:ro.WEIGHT.muted,size:ro.SIZE.sm},y("wallet_extension_multisender_btn_download"))}))}];return vt.default.createElement(T.Box,{className:qr.root},vt.default.createElement(T.Box,{className:qr.title},e),vt.default.createElement(T.Box,null,r.map((o,n)=>vt.default.createElement(T.Box,{key:n,className:qr.item},vt.default.createElement(T.Box,{className:qr.question},o.question),vt.default.createElement(T.Box,{className:qr.answer},o.answer)))))}var cl=cf;f();m();var Nt=N(K()),pn=N(ct());ne();f();m();var bt={root:"_root_sdbg5_2",footer:"_footer_sdbg5_11",network:"_network_sdbg5_112",networkTitle:"_networkTitle_sdbg5_220",networkSelectBox:"_networkSelectBox_sdbg5_239",networkSelect:"_networkSelect_sdbg5_239",tokenSelect:"_tokenSelect_sdbg5_301",icon:"_icon_sdbg5_358",loader:"_loader_sdbg5_361","network-icon":"_network-icon_sdbg5_364",networkIcon:"_network-icon_sdbg5_364"};var uf=()=>{let[t,e]=(0,Nt.useState)(!1),r=Ki(),[,o]=te(),{isRpcMode:n,currentNetworkUniqueId:a}=(0,pn.useSelector)(qo),i=r.find(h=>n?h.uniqueId===a:h.netWorkId===a),[l,d]=De(i),c=(0,Nt.useMemo)(()=>r.map(h=>{let{chainId:p,icon:s,chainName:_,rpcUrl:w}=h;return{network:h,value:p,searchKeyword:_,label:Nt.default.createElement(T.FlexBox,{align:T.ALIGN.center,style:{height:"20px",width:"100%"}},Nt.default.createElement(T.FlexBox,{align:T.ALIGN.center,style:{flex:1}},l?.rpcUrl===w&&t?Nt.default.createElement(At,{className:bt.loader,size:At.SIZE.md}):Nt.default.createElement(Ce,{className:bt.networkIcon,src:s,text:_,size:Ce.SIZE.md}),_))}}),[r,l?.rpcUrl,t]),g=async h=>{try{e(!0),await(await Xo(h)).eth.getGasPrice()}catch{let s=gr.warn({title:y("developer_mode_network_toast_connect_failed"),text:y("developer_mode_network_toast_changenetwork"),cancelText:y("wallet_extension_sending_btn_cancel"),confirmText:y("developer_mode_network_btn_retry"),confirmBtnProps:{type:Z.TYPE.highlight,size:Z.SIZE.lg},onCancel:()=>{s.destroy(),d(null)},onConfirm:()=>{s.destroy(),g(h)}})}finally{e(!1)}},x=B(({network:h={},label:p,...s})=>{d({...h,...s}),h?.appBaseChain==="ethereum"?g(h.rpcUrl).then(()=>{o(null)}).catch(()=>{}):o(null),Ma()},[]),v=(0,pn.useDispatch)();return(0,Nt.useEffect)(()=>{o(null),n&&v(rn(!1))},[n]),[t,l,c,x]},ul=uf;f();m();var dl=N(K());var df=t=>{let[e,r]=te(),[o,n]=(0,dl.useState)(""),a=at(),i=Ko(),{list:l,listRef:d,refreshDom:c,loadingMore:g}=Xi(t,o),x=async _=>{if(!_){r(null);return}let w=!_?.address,S=await Ia({coinId:_.coinId}),k;w?k=S:k=i.find(({coinId:z})=>z===_.baseCoinId);let{chainId:C}=t||{};S===null||!w&&k===null||r({chainId:C,..._,...S,baseCoin:w?void 0:k})},v=_=>{let w=!_?.address,{chainId:S}=t||{},k=i.find(({chainId:C})=>C===en(S));r({chainId:S,..._,baseCoin:w?void 0:k})},h=B(_=>{x(_)}),p=B(_=>{n(_)}),s=B(_=>{v(_)});return[e,l,d,c,g,{onBatchTokenChange:a?s:h,onBatchCustomTokenChange:s,onInputChange:p}]},fl=df;var ff=()=>{let{isSm:t}=Le(),{gotoAddressPage:e}=Ke(),[r,o]=mt(),[n,a,i,l]=ul(),[d,c,g,x,v,{onBatchTokenChange:h,onBatchCustomTokenChange:p,onInputChange:s}]=fl(a);return je.default.createElement(ir,{footer:je.default.createElement(T.FlexBox,{justify:"flex-end",className:bt.footer},je.default.createElement(Z,{block:t,category:Z.CATEGORY.fill,type:Z.TYPE.highlight,size:t?Z.SIZE.lg:Z.SIZE.xl,disabled:!a?.chainId||!r||!d?.symbol,onClick:e},y("wallet_extension_footer_btn_next")))},je.default.createElement(T.Box,{className:bt.root},je.default.createElement(Yr,{title:y("wallet_extension_type_title_select_type"),subtitle:y("wallet_extension_type_subtitle_select")}),je.default.createElement(T.Box,{className:bt.network},je.default.createElement(T.Box,{className:bt.networkSelectBox},je.default.createElement(T.Box,{className:bt.networkTitle},y("wallet_extension_type_title_select_internet")),je.default.createElement(Kn,{block:!0,placeholder:y("wallet_extension_type_placeholder_ethereum"),size:Kn.SIZE.xl,onChange:l,value:a?.chainId,options:i,className:bt.networkSelect,disabled:n,searchFocus:!1,searchPlaceholder:y("wallet_extension_sending_input_search_network"),scrollStyle:{height:360}})),je.default.createElement(T.Box,{className:bt.tokenSelect},je.default.createElement(il,{ref:g,disabled:!a?.chainId,value:d,options:c,onSelect:h,onInputChange:s,onCustomContractChange:p,selectedNetwork:a,tokensLoadingMore:v,refreshInfiniteScrollRef:x}))),je.default.createElement(sl,{mode:r,selectedNetwork:a,onSelected:o}),je.default.createElement(cl,null)))},ml=je.default.memo(ff);f();m();var Me=N(K());ne();var Hl=N(ct());f();m();var Xt=N(K()),pl=N(rt()),ds=N(ct());ne();var hn=()=>{let[t]=te(),[e]=De(),[r,o]=(0,Xt.useState)(0),[n,a]=(0,Xt.useState)(0),i=(0,ds.useSelector)(os),{usdToThisRate:l}=i,d=st(t),c=vo(),g=async()=>{if(d){let S=await c({chainId:t?.chainId,coinId:t?.coinId,contractAddress:t?.address});o(S),a(S)}else{let[S,k]=await Promise.all([c({chainId:t?.chainId,coinId:t?.baseCoin?.coinId,contractAddress:t?.address}),c({chainId:t?.chainId,coinId:t?.coinId,contractAddress:t?.address})]);a(S),o(k)}};(0,Xt.useEffect)(()=>{g()},[]);let[x]=_e(),v=(0,ds.useSelector)(Ze),h=x?.length,p=d?t:t?.baseCoin,s=(0,Xt.useMemo)(()=>x[0]?.realNetworkFee?x.reduce((k,{realNetworkFee:C})=>D.add(k,C),0):D.mul(v?.networkFee??0,h),[t,v]),_=(0,Xt.useMemo)(()=>{let S=x.reduce((k,{txAmount:C})=>D.add(k,C),0);return D.div(S,10**(t?.decimals||18))},[x]);return(0,Xt.useMemo)(()=>{let S=D.mul(l,D.mul(n,s)),k=D.mul(l,D.mul(r,_));return[{title:"wallet_extension_info_title_internet",icon:e?.icon,value:e?.chainName,showIcon:!0},{title:"wallet_extension_info_title_crypto",icon:t?.image,value:t?.symbol,showIcon:!0},{title:"wallet_extension_info_title_address_amount",value:D.thousandFormat(h)},{title:"wallet_extension_info_title_transfer_amount",value:so((0,pl.max)([_,0]),{symbol:t?.symbol??""}),market:k},{title:"wallet_extension_info_title_internet_fee",value:so(s,{symbol:p?.symbol??""}),market:S}]},[t,e,s,r,n,_,h])};f();m();var gt=N(K()),fs=N(Be());ne();f();m();var lr={root:"_root_z3ank_2",row:"_row_z3ank_97",nextRow:"_nextRow_z3ank_114",title:"_title_z3ank_124",subtitle:"_subtitle_z3ank_148",value:"_value_z3ank_174",icon:"_icon_z3ank_177"};function hl(t){let{icon:e,title:r,value:o,showIcon:n=!1,market:a}=t;return gt.default.createElement(T.Box,null,gt.default.createElement(T.Box,{className:lr.title},y(r)),gt.default.createElement(T.Box,{className:(0,fs.default)(lr.subtitle)},n&&(e||o)&&gt.default.createElement(Ce,{src:e,className:lr.icon,text:o,size:Ce.SIZE.md}),gt.default.createElement(T.Box,{className:lr.value},o)),a!==void 0&&gt.default.createElement(ae.DisplayAmount,{wrap:!0,useApproximate:!0,amount:a,mode:ae.LEGAL,type:ae.TYPE.secondary,size:ae.SIZE.sm,style:{display:"block",marginTop:"4px"}}))}function mf({className:t,statistics:e}){let{isSm:r}=Le(),o=Math.floor(e.length/2),n=r?o:e.length;return gt.default.createElement(T.Box,{className:(0,fs.default)(lr.root,t)},gt.default.createElement(T.Box,{className:lr.row},e.slice(0,n).filter(Boolean).map((a,i)=>gt.default.createElement(hl,{...a,key:i}))),gt.default.createElement(T.Box,{className:lr.nextRow},e.slice(n).filter(Boolean).map((a,i)=>gt.default.createElement(hl,{...a,key:i}))))}var vn=mf;f();m();var ms=N(K());f();m();var fe={root:"_root_1sugj_2",table:"_table_1sugj_54",row:"_row_1sugj_63",order:"_order_1sugj_68",addressError:"_addressError_1sugj_94",fromError:"_fromError_1sugj_97",text:"_text_1sugj_100",oneLineText:"_oneLineText_1sugj_122",moreLineText:"_moreLineText_1sugj_125",remove:"_remove_1sugj_128",success:"_success_1sugj_133",error:"_error_1sugj_146",open:"_open_1sugj_159",receiveError:"_receiveError_1sugj_162",errorIcon:"_errorIcon_1sugj_165",hash:"_hash_1sugj_170",hashText:"_hashText_1sugj_180",loader:"_loader_1sugj_191"};function pf({dataSource:t,columns:e,scroll:r}){let o=()=>({style:{background:"var(--okd-color-background-surface-primary)"}});return ms.default.createElement(T.Box,{className:fe.root},ms.default.createElement(ma,{columns:e,dataSource:t,className:fe.table,onHeaderCell:o,scroll:r}))}var gn=pf;var Eo=N(Be());Ie();var yn=N(rt());f();m();var _t={root:"_root_ysd61_1",statistics:"_statistics_ysd61_36",setting:"_setting_ysd61_57",amount:"_amount_ysd61_76",no_gas:"_no_gas_ysd61_227",noGas:"_no_gas_ysd61_227",interval:"_interval_ysd61_365",gas:"_gas_ysd61_644",address:"_address_ysd61_783",footer:"_footer_ysd61_899",alert:"_alert_ysd61_1002"};f();m();var Ve=N(K()),vl=N(Be());ne();Ie();f();m();var $t={root:"_root_iq84d_1",type:"_type_iq84d_32",title:"_title_iq84d_54",random:"_random_iq84d_77",input:"_input_iq84d_91",setting:"_setting_iq84d_95"};f();m();var ps=N(K());function hf(){let[t,e]=(0,ps.useState)(!1),[r,o]=(0,ps.useState)(!1),n=(d,c)=>d&&c&&Number(d)>Number(c);return{hasMinError:t,hasMaxError:r,checkMaxError:(d,c)=>{e(!1),o(n(d,c))},checkMinError:(d,c)=>{o(!1),e(n(d,c))},clearError:()=>{o(!1),e(!1)}}}var _n=hf;function vf({value:t,className:e,options:r,onChange:o}){let[n]=te(),[a]=sn(),i=Number(n?.decimals??18),{hasMinError:l,hasMaxError:d,checkMaxError:c,checkMinError:g,clearError:x}=_n(),v=S=>{o?.({min:S}),g(S,t.max)},h=S=>{o?.({max:S}),c(t.min,S)},p=S=>{o?.({amount:S})},s=B(S=>{S?.value!==t.type&&(o?.({type:S?.value,amount:"",min:"",max:""}),x())},[t]),_=D.thousandFormat("0.00"),w=(0,Ve.useMemo)(()=>n?.localType===re&&st(n)&&D.div(a,10**n?.decimals)||0,[a,n]);return Ve.default.createElement(T.Box,{className:(0,vl.default)($t.root,e)},Ve.default.createElement(T.Box,{className:$t.type},Ve.default.createElement(T.Box,{className:$t.title},y("wallet_extension_amount_title_transfer_amount")),Ve.default.createElement(T.Box,null,Ve.default.createElement(Mr,{options:r,value:t?.type,onChange:s,align:Mr.DIRECTION.right}))),Ve.default.createElement(T.Box,{className:$t.setting},t?.type===ie.RANDOM?Ve.default.createElement(T.Box,{className:$t.random},Ve.default.createElement(ve.Number,{enableMinus:!1,className:$t.input,suffix:n?.symbol,title:y("wallet_extension_amount_input_lowest"),value:t?.min,onChange:v,size:ve.SIZE.lg,precision:i,placeholder:_,min:w,error:l,errorType:ve.TIP_TYPE.always}),Ve.default.createElement(ve.Number,{suffix:n?.symbol,className:$t.input,title:y("wallet_extension_amount_input_highest"),value:t?.max,onChange:h,precision:i,size:ve.SIZE.lg,placeholder:_,min:w,error:d,errorType:ve.TIP_TYPE.always})):Ve.default.createElement(T.Box,{className:$t.custom},Ve.default.createElement(ve.Number,{enableMinus:!1,suffix:n?.symbol,title:y("wallet_extension_amount_subtitle_send_amount"),value:t?.amount,size:ve.SIZE.lg,onChange:p,disabled:t?.type===ie.ALL,precision:i,placeholder:t?.type===ie.ALL?y("wallet_extension_amount_dropdown_all_balance"):_,min:w}))))}var gl=vf;f();m();var Rt=N(K()),_l=N(Be());ne();f();m();var cr={root:"_root_rc0rn_1",title:"_title_rc0rn_27",type:"_type_rc0rn_45",random:"_random_rc0rn_56",input:"_input_rc0rn_76",setting:"_setting_rc0rn_80"};function gf({value:t,className:e,onChange:r}){let{type:n,min:a,max:i}=t,{hasMinError:l,hasMaxError:d,checkMaxError:c,checkMinError:g,clearError:x}=_n(),v=z=>{let U={...t,...z};r?.(U)},h=z=>{let U=z;v({min:U}),g(U,i)},p=z=>{v({max:z}),c(a,z)},s=y("wallet_extension_interval_title_send_interval"),_=[{value:Ue.NONE,label:y("wallet_extension_interval_select_no_interval")},{value:Ue.RANDOM,label:y("wallet_extension_interval_dropdown_random_interval")}],w=y("wallet_extension_interval_subtitle_lowest"),S=y("wallet_extension_interval_subtitle_highest"),k=z=>{let U=z.value;U!==n&&(v({type:U,min:"",max:""}),x())},C=n===Ue.NONE;return Rt.default.createElement(T.Box,{className:(0,_l.default)(cr.root,e)},Rt.default.createElement(T.Box,{className:cr.type},Rt.default.createElement(T.Box,{className:cr.title},s),Rt.default.createElement(T.Box,null,Rt.default.createElement(Mr,{options:_,value:n,onChange:k,align:Mr.DIRECTION.right}))),Rt.default.createElement(T.Box,{className:cr.setting},Rt.default.createElement(T.Box,{className:cr.random},Rt.default.createElement(ve.Number,{className:cr.input,title:w,value:a,onChange:h,size:ve.SIZE.lg,placeholder:"0",min:0,max:600,disabled:C,error:l,errorType:ve.TIP_TYPE.always}),Rt.default.createElement(ve.Number,{className:cr.input,title:S,value:i,onChange:p,size:ve.SIZE.lg,placeholder:"0",disabled:C,min:0,max:600,error:d,errorType:ve.TIP_TYPE.always}))))}var xl=gf;f();m();var me=N(K()),Ss=N(Be());ne();Jn();f();m();f();m();f();m();var Jt=N(K());ne();var xn=N(Be());f();m();var hs=N(K());var Sl=N(Be());var _f=({children:t,className:e,...r})=>hs.default.createElement(T.Box,{className:(0,Sl.default)(fe.row,e),...r},hs.default.createElement(T.Box,null),t),zt=_f;function xf(t){let{error:e,showShortAddress:r=!1,from:o,order:n,to:a,isFromAddress:i=!1,showTextOneLine:l=!1,showOrder:d=!1,showError:c=!1}=t,g=e===Dt.BALANCE_INSUFFICIENT,x=!!e,v=g?"okx-wallet-plugin-warning-circle-fill":"okx-wallet-plugin-gas",h=(0,Jt.useMemo)(()=>e===Dt.BALANCE_INSUFFICIENT?y("wallet_extension_list_tooltips_scarce_balance"):e===Dt.FEE_BALANCE_INSUFFICIENT?y("wallet_extension_list_tooltips_scarce_fee"):e,[e]),p=i?o:a,s=r?Ho(p):p;return Jt.default.createElement(zt,null,d&&Jt.default.createElement(T.Box,{className:fe.order},n,"."),Jt.default.createElement(T.Box,{className:(0,xn.default)(fe.text,{[fe.oneLineText]:l,[fe.moreLineText]:!l,[fe.receiveError]:c&&x})},s),c&&x&&Jt.default.createElement(T.Box,{className:(0,xn.default)(fe.addressError)},Jt.default.createElement(_r,{title:h},Jt.default.createElement(ot,{className:(0,xn.default)(v,fe.errorIcon)}))))}var wl=xf;f();m();var vs=N(K());var Tl=N(Be());ne();var El=N(rt());function Sf(t){let{txAmount:e,showTextOneLine:r}=t;return vs.default.createElement(zt,null,vs.default.createElement(T.Box,{className:(0,Tl.default)(fe.text,{[fe.oneLineText]:r,[fe.moreLineText]:!r})},D.thousandFormat((0,El.max)([e||0,0]))))}var yl=Sf;f();m();var ur=N(K()),Al=N(Id());ne();var gs=N(Be());function wf(t){let{txHash:e}=t,[r]=De(),o="",n=r.blockExplorerUrl||r.explorerUrl;n&&(o=ci(n,"tx",e));let a=()=>{e&&(o?globalThis.platform.openTab({url:o}):((0,Al.default)(e),Vn.success({desc:ur.default.createElement(ae.Text,{inherit:!0,forceWrap:!0},e),placement:Vn.DIRECTION.top,title:y("wallet_receive_toast_address_copied")})))};return ur.default.createElement(zt,{className:fe.hash,onClick:a},e?ur.default.createElement(ur.default.Fragment,null,ur.default.createElement(T.Box,{className:(0,gs.default)(fe.text,fe.hashText)},Ho(e)),ur.default.createElement(T.Box,null,ur.default.createElement(ot,{className:(0,gs.default)(fe.open,{"okx-wallet-plugin-open-link":o,"okx-wallet-plugin-copy":!o})}))):"-")}var bl=wf;f();m();var xo=N(K());var _s=N(Be());function Tf(t){let{txStatus:e}=t;return xo.default.createElement(zt,null,(()=>{switch(e){case V.SUCCEED:return xo.default.createElement(ot,{className:(0,_s.default)("okds-success-circle",fe.success)});case V.FAILED:case V.DROPPED:return xo.default.createElement(ot,{className:(0,_s.default)("okds-fail-circle",fe.error)});case V.PENDING:return xo.default.createElement(At,{size:At.SIZE.md,loaderClassName:fe.loader});default:return"-"}})())}var Nl=Tf;f();m();var Sn=N(K());var xs=N(Be());function Ef(t){let[e,r]=_e(),{gotoAddressPage:o}=Ke(),{index:n}=t,a=()=>{let i=[...e.slice(0,n),...e.slice(n+1)];r(i),i.length<=0&&o()};return Sn.default.createElement(zt,null,Sn.default.createElement(T.Box,{className:(0,xs.default)(fe.text),onClick:a},Sn.default.createElement(ot,{className:(0,xs.default)("okx-wallet-plugin-trash",fe.remove)})))}var kl=Ef;var He={ADDRESS:"address",AMOUNT:"amount",ACTION:"action",HASH:"hash",STATUS:"status"},wn={[He.ADDRESS]:wl,[He.AMOUNT]:yl,[He.ACTION]:kl,[He.HASH]:bl,[He.STATUS]:Nl};var Zr={FROM:"from",TO:"to",TX_AMOUNT:"txAmount",ACTION:"action"},Il=[{title:"wallet_extension_list_title_send_address",key:Zr.FROM,type:He.ADDRESS},{title:"wallet_extension_list_title_receive_address",key:Zr.TO,type:He.ADDRESS},{title:"wallet_extension_list_title_amount",key:Zr.TX_AMOUNT,type:He.AMOUNT,width:100},{title:"wallet_extension_list_title_operation",key:Zr.ACTION,type:He.ACTION,width:50}];var So={[qe.HIGH]:"wallet_extension_gas_select_fast",[qe.MEDIUM]:"wallet_extension_gas_select_average",[qe.LOW]:"wallet_extension_gas_select_slow",[qe.CUSTOM]:"commonall_filter_dropdown_custom"},Cl=[{value:ie.CUSTOM,label:"wallet_extension_amount_select_designated_amount"},{value:ie.ALL,label:"wallet_extension_amount_dropdown_all_balance"},{value:ie.RANDOM,label:"wallet_extension_amount_dropdown_random_size"}];f();m();var Xe={root:"_root_17dsg_1",title:"_title_17dsg_27",setting:"_setting_17dsg_46",item:"_item_17dsg_70",inactive:"_inactive_17dsg_106",active:"_active_17dsg_109",label:"_label_17dsg_112",fee:"_fee_17dsg_119",gweiText:"_gweiText_17dsg_143",customInput:"_customInput_17dsg_147",defaultTip:"_defaultTip_17dsg_153",defaultChecker:"_defaultChecker_17dsg_159"};function Ol(){return me.default.createElement("div",{className:Xe.gweiText},y("extension_wallet_transaction_input_gwei"))}function yf({custom:t,onClose:e,network:r,onConfirm:o,isSupportEip1559:n}){let{gasPrice:a,gasLimit:i,baseFeePerGas:l,maxFeePerGas:d,maxPriorityFeePerGas:c}=t,g=Jo(l),x=n?`${y("extension_wallet_transaction_text_maxbase_fee")} (${y("extension_wallet_transaction_text_current",{number:g})})`:y("wallet_extension_cosmos_title_gasfee"),v=Jo(n?Rr(d,c):a),[h,p]=(0,me.useState)(v),s=Jo(c),[_,w]=(0,me.useState)(s),{updateRpcNetwork:S}=Hr(),{extensionConfig:k,setExtensionConfig:C}=Wa("rpc_info"),[z,U]=(0,me.useState)(t.isDefault),q=j=>{let L=j.target.checked;if(L)U(L),Ra();else{let P=gr.tip({children:y("wallet_extension_mid_alert_checkbox_setting_uncheck"),confirmText:y("wallet_extension_btn_general_confirm"),cancelText:y("wallet_extension_btn_general_cancel"),btnFull:!1,async onConfirm(){let W={...r,defaultGasForRpc:{...r.defaultGasForRpc,[fo.batchTransfer]:null}};await S(W),uo(W,k)&&await C(W),U(L),P.destroy()},onCancel(){P.destroy()}})}},M=at(),[O]=(0,me.useState)(i),G=(0,me.useMemo)(()=>{let j=!Number(h);return n&&(j=j||!Number(_)),j},[h,_,n]);return me.default.createElement(gr.Confirmation,{maskClosable:!1,visible:!0,title:y("commonall_filter_dropdown_custom"),confirmText:y("commonall_text_btn_confirm"),cancelText:y("commonall_text_btn_cancel"),confirmDisabled:G,onConfirm:async()=>{let{price:j,usdToThisRate:L}=t,P=Wo(n?va(h,_):h),{networkFee:W,networkFeeInt:R,networkFeeMarket:le}=Kt({gasPrice:P,gasLimit:O,price:j,usdToThisRate:L}),ee={...t,isDefault:z,networkFee:W,networkFeeInt:R,networkFeeMarket:le,gasPrice:P,maxFeePerGas:P,maxPriorityFeePerGas:Wo(_),gasLimit:O};if(M&&z){let he={...r,defaultGasForRpc:{...r.defaultGasForRpc,[fo.batchTransfer]:{...ee,isSupportEip1559:n,baseFeePerGas:Rr(P,Wo(_))}}};await S(he),uo(r,k)&&await C(he)}o(ee)},onCancel:e,onClose:e},me.default.createElement(T.Box,null,me.default.createElement(ve.Number,{className:Xe.customInput,size:ve.SIZE.sm,title:x,placeholder:v,value:h,precision:9,enableMinus:!1,min:0,onChange:p,suffix:me.default.createElement(Ol,null)}),n&&me.default.createElement(ve.Number,{className:Xe.customInput,size:ve.SIZE.sm,placeholder:s,title:y("extension_wallet_transaction_text_priority_fee"),value:_,precision:9,enableMinus:!1,min:0,onChange:w,suffix:me.default.createElement(Ol,null)})),M?me.default.createElement(me.default.Fragment,null,me.default.createElement(T.Box,{className:Xe.defaultTip},y("wallet_extension_mid_checkbox_setting_default")),me.default.createElement(sr,{checked:z,onChange:q,className:Xe.defaultChecker},y("wallet_extension_bot_alert_default_gas",{networkName:r.name}))):null)}function Af({loading:t,value:e,network:r,className:o,options:n,onChange:a=()=>{},onCustomChange:i=()=>{}}){let[l]=jr(),[d,c]=(0,me.useState)(!1);return me.default.createElement(T.Spin,{loading:t&&!n?.length,className:(0,Ss.default)(Xe.root,o)},me.default.createElement(T.Box,{className:Xe.title},y("wallet_extension_gas_title_internet_fee")),me.default.createElement(T.Box,{className:Xe.setting},n.map(g=>{let{level:x,unitPriceDisplay:v}=g,h=y(So[x]);return me.default.createElement(T.Box,{className:(0,Ss.default)(Xe.item,e?.level===x?Xe.active:Xe.inactive),key:x,onClick:()=>{g.level===qe.CUSTOM?c(!0):a?.(g)}},me.default.createElement(T.Box,{className:Xe.label},h),me.default.createElement(T.Box,{className:Xe.fee},me.default.createElement(ae.Text,{type:ae.TYPE.secondary,size:ae.SIZE.xs,ellipsis:{tooltip:!0}},v),me.default.createElement(T.Box,null,y("extension_wallet_transaction_input_gwei"))))})),d&&me.default.createElement(yf,{network:r,isSupportEip1559:l,custom:n[n.length-1],onConfirm:g=>{i(g),c(!1)},onClose:()=>{c(!1)}}))}var Ll=Af;f();m();var wo=N(K());var bf=({dataSource:t,amountSetting:e,intervalSetting:r})=>{let{gotoSendPage:o}=Ke(),n=(0,wo.useMemo)(()=>{if(!e)return!0;if(e.type===ie.CUSTOM)return!e.amount||Number(e.amount)===0;if(e.type===ie.RANDOM){let{min:c,max:g}=e;return!c||!g||Number(c)>Number(g)||Number(g)===0}return!1},[e]),a=(0,wo.useMemo)(()=>{if(!r)return!0;if(r.type===Ue.RANDOM){let{min:c,max:g}=r;return!c||!g||Number(c)>Number(g)}return!1},[r]),i=(0,wo.useMemo)(()=>t?.some(({error:c})=>!!c),[t]),l=(0,wo.useMemo)(()=>n||a||i,[n,a,i]),d=B(()=>{Pa?.(),o()},[]);return[l,d]},Fl=bf;f();m();var Qt=N(K()),To=N(ct());ne();Ie();var Nf=21e3,Bl=({from:t,to:e,token:r,network:o,txAmount:n=0})=>{let a=(0,To.useDispatch)(),i=Ba(),l=(0,To.useSelector)(Ei),[d]=(0,Qt.useState)(!1),[c,g]=(0,Qt.useState)([]),[x,v]=(0,Qt.useState)(0),[h,p]=(0,Qt.useState)(Nf),s=Ka(),_=dn(),w=el(),S=tl(),k=fn(r?.coinId),C=(0,To.useSelector)(Ze),z=un(o?.rpcUrl),U=vo(),q=B(j=>{a(dt(j))},[]),M=B(j=>{a(dt(j)),g(L=>{let P=[...L],W=P.pop();return P.push({...W,...j,unitPriceDisplay:s(j.gasPrice)}),P})});Aa(()=>{[se,re,Se,J].includes(r?.localType)||(async()=>{let j=await z({value:n,to:ut(e,r?.localType),from:ut(t,r?.localType)},r?.address);p(j)})()},[n],{wait:500}),(0,Qt.useEffect)(()=>{(async()=>{let j=await U({coinId:r?.coinId,chainId:r?.chainId,contractAddress:r?.address});v(j)})()},[]);let{rpcNetworks:O}=Hr(),G=at();return(0,Qt.useEffect)(()=>{if(!(!O?.length&&G)&&![se,re,Se,J].includes(r?.localType)){let j,L=l.map(ee=>{let{level:he,gasPrice:ue}=ee,{networkFee:we,networkFeeInt:Ne,networkFeeMarket:Ee}=Kt({gasPrice:ue,gasLimit:h,price:x,usdToThisRate:i?.usdToThisRate}),ze={...ee,gasLimit:h,tokenPrice:x,networkFee:we,networkFeeInt:Ne,networkFeeMarket:Ee,currencySymbol:i?.symbol,label:y(So[he]),usdToThisRate:i?.usdToThisRate,unitPriceDisplay:s(ue)};return he===qe.MEDIUM&&(j=ze),ze}),P={...j},W=!1,R=C?.level;if(r?.coinId)R===qe.CUSTOM&&(P=[...c].pop()||j);else{let he=O.find(ue=>uo(ue,o))?.defaultGasForRpc?.[fo.batchTransfer];he&&(P=he,W=!0)}let le={...P,level:qe.CUSTOM,unitPriceDisplay:s(P.gasPrice),label:y(So[qe.CUSTOM])};if(L.push(le),g(L),R){let ee=L.find(he=>he.level===R);a(dt(ee||j))}else a(W?dt(le):dt(j))}},[h,l,O,G]),(0,Qt.useEffect)(()=>{let j=async()=>{let R=await _({to:e,from:t,coinId:r?.coinId,chainId:r?.chainId}),{solRent:le}=R||{};a(tn(le)),a(dt(R))},L=async()=>{let R=await w({to:e,from:t,value:n,coinId:r?.coinId,chainId:r?.chainId,baseCoinId:r?.baseCoinId});a(dt(R))},P=async()=>{let R=await k({to:e,chainId:r?.chainId,contractAddress:r?.address});a(dt(R))},W=async()=>{let R=await S({coinId:r?.coinId,address:t});a(dt(R))};r?.localType===J?P():r?.localType===re?j():r?.localType===Se?L():r?.localType===se&&W()},[]),[d,c,q,M]};f();m();var En=N(K());ne();f();m();var Dl=N(K()),Tn=(t,e={})=>(r,o)=>Dl.default.createElement(t,{...o,...e});Jn();Ie();f();m();var Ml=N(rt()),kf=(t,e,r=0)=>+(0,Ml.random)(t,e,!0).toFixed(r),xt=kf;f();m();ne();var ws=({balance:t,isBaseCoin:e,baseCoinBalance:r,usedCoinBalance:o,usedFeeCoinBalance:n})=>{if(D.lt(r,n))return Dt.FEE_BALANCE_INSUFFICIENT;if(e){if(D.lt(t,D.add(o,n)))return Dt.BALANCE_INSUFFICIENT}else if(D.lt(t,o))return Dt.BALANCE_INSUFFICIENT;return null},Pl=({balance:t,solRent:e,usedRent:r,txAmount:o,isBaseCoin:n,formattedSolRent:a,baseCoinBalance:i,usedCoinBalance:l,usedFeeCoinBalance:d})=>{let c,g=!0;if(D.lt(i,d))return Dt.FEE_BALANCE_INSUFFICIENT;if(n){if(D.lt(t,D.add(l,d))&&(g=!1),D.lt(o,e))return y("walletextension_toast_text_minimum_rent_fee",{number:a});c=D.sub(i,D.add(d,l))}return D.lt(i,D.add(d,r))?y("extension_wallet_transfer_alert_insufficient"):(n||(c=D.sub(i,D.add(d,r)),D.lt(t,l)&&(g=!1)),g?c!=="1"&&D.lt(c,e)&&D.gt(c,0)?y("walletextension_toast_text_reserve_rent_exempt",{number:a}):null:Dt.BALANCE_INSUFFICIENT)},Rl=async({coin:t,balance:e,txAmount:r,isBaseCoin:o,baseCoinBalance:n,usedCoinBalance:a,usedFeeCoinBalance:i})=>{let l=ws({balance:e,txAmount:r,isBaseCoin:o,baseCoinBalance:n,usedCoinBalance:a,usedFeeCoinBalance:i});if(l)return l;let{ZksyncWallet:d}=await Uo(),c=r&&await d.getCloseAmounts(r);return c&&!D.eq(c,r)?y("wallet_extension_placeholder_zksync_max_num",{amount:D.showFloorTruncation(D.div(c,10**t?.decimals),t?.decimals,!1)}):null};var If=9,zl=({token:t,networkFee:e,amountSetting:r})=>{let{isSm:o}=Le(),[n]=mt(),[a]=sn(),[i]=an(),[l,d]=(0,En.useState)([]),[c,g]=_e(),x=st(t);zr(async()=>{if(!r)return;let{type:s,amount:_,min:w,max:S}=r;s===ie.CUSTOM&&g(c?.map(k=>({...k,txAmount:D.mul(_,10**(t?.decimals??18))}))),s===ie.RANDOM&&g(c?.map(k=>{let C=w&&S&&Number(w)<=Number(S)?xt(w,S,6):0;return{...k,txAmount:D.mul(C,10**(t?.decimals||18))}}))},[r,c?.length,t?.decimals]);let v=async s=>{let{ZksyncWallet:_}=await Uo();return await Promise.all(s.map(async S=>({...S,txAmount:S?.txAmount&&await _.getCloseAmounts(S?.txAmount)})))};zr(async()=>{if(!r)return;let{type:s}=r;if(s===ie.ALL&&n===X.ONE_TO_MANY){let[{balance:_}]=c,w=c?.length,S=x?Rr(_,D.mul(e?.networkFeeInt,w)):_,k=$n(D.div(S,c?.length),0),C=$n(D.div(_,w),0);g(c.map((z,U)=>(U===w-1&&(C=D.sub(_,D.mul(C,w-1)),k=x?D.sub(C,e?.networkFeeInt):C),{...z,txAmount:k,usedBalance:C})))}if(s===ie.ALL&&n!==X.ONE_TO_MANY){let _=c.map(w=>{let{balance:S}=w,k=x?Rr(S,e?.networkFeeInt):S;return{...w,txAmount:k}});g(t?.localType===J?await v(_):_)}},[r.type,c?.length,t?.decimals,e?.networkFeeInt]),zr(async()=>{d(await(async()=>{let _=0,w=0,S=0,k=e?.networkFeeInt,C=ws;return t?.localType===re?C=Pl:t?.localType===J&&(C=Rl),await Promise.all(c.map(async(U,q)=>{let{to:M,txAmount:O,balance:G,baseCoinBalance:j}=U,L=i[M]||"0";return n===X.ONE_TO_MANY?(S=D.add(S,L),_=D.add(_,O),w=D.add(w,k)):(S=L,_=O,w=k),{...U,txAmount:D.truncate(D.div(O,10**(t?.decimals??18)),6,!1),index:q,showShortAddress:o,showTextOneLine:!1,order:q+1,error:await C({balance:G,needRent:L,usedRent:S,solRent:a,txAmount:O,isBaseCoin:x,formattedSolRent:so(a,{decimals:If}),baseCoinBalance:j,usedCoinBalance:_,usedFeeCoinBalance:w})}}))})())},[o,a,i,n,x,c,t?.decimals,e?.networkFeeInt]);let h=(0,En.useMemo)(()=>({[Zr.FROM]:{showOrder:!0,showError:!0,isFromAddress:!0}}),[]),p=Il.map(s=>{let{title:_,key:w,type:S,...k}=s;return{title:y(_),dataIndex:w,key:w,render:Tn(wn[S],{...h[w],address:w}),...k}});return{dataSource:l,columns:p}};f();m();ne();Ie();var Wl=N(K());var Ul=t=>{let[e,r]=pt(),n=Cl.filter(({value:i})=>!(t===J&&i===ie.RANDOM)).map(({label:i,value:l})=>({value:l,label:y(i)})),a=B((i={})=>{r({...e,...i})},[e]);return(0,Wl.useLayoutEffect)(()=>{t===J&&e?.type===ie.RANDOM&&r({type:ie.CUSTOM})},[t]),[e,n,a]};var Cf=()=>{let{gotoAddressPage:t}=Ke(),{isSm:e}=Le(),[r]=te(),[o]=De(),[n]=_e(),a=(0,Hl.useSelector)(Ze),i=(0,yn.reverse)((0,yn.sortBy)(n,"balance"))[0],l=![se,re,Se,J].includes(r?.localType),[d,c,g,x]=Bl({...i,network:o,token:r,isEvmTransaction:l}),[v,h,p]=Ul(r?.localType),{dataSource:s,columns:_}=zl({token:r,network:o,amountSetting:v,networkFee:a}),[w={},S]=ht(),[k,C]=Fl({dataSource:s,amountSetting:v,intervalSetting:w}),z=hn();return Me.default.createElement(ir,{footer:Me.default.createElement(T.Box,{className:_t.footer},Me.default.createElement(Z,{block:e,category:Z.CATEGORY.outline,type:Z.TYPE.primary,size:e?Z.SIZE.lg:Z.SIZE.xl,onClick:()=>{t()}},y("wallet_extension_footer_btn_back")),Me.default.createElement(Z,{block:e,category:Z.CATEGORY.fill,type:Z.TYPE.highlight,size:e?Z.SIZE.lg:Z.SIZE.xl,onClick:C,disabled:k||!a},y("wallet_extension_footer_btn_confirm"))),useOkg:!1},Me.default.createElement(T.Box,{className:(0,Eo.default)(_t.root)},Me.default.createElement(Yr,{title:y("wallet_extension_amount_title_input_amount"),subtitle:y("wallet_extension_amount_subtitle_input_number")}),Me.default.createElement(vn,{className:_t.statistics,statistics:z}),Me.default.createElement(T.Box,{className:_t.setting},Me.default.createElement(T.Box,{className:(0,Eo.default)(_t.amount,{[_t.no_gas]:!l})},Me.default.createElement(gl,{value:v,options:h,onChange:p})),Me.default.createElement(T.Box,{className:(0,Eo.default)(_t.interval,{[_t.no_gas]:!l})},Me.default.createElement(xl,{value:w,onChange:S})),l&&Me.default.createElement(T.Box,{className:_t.gas},Me.default.createElement(Ll,{loading:d,network:o,options:c,onChange:g,value:a,onCustomChange:x})))),Me.default.createElement(T.Box,{className:(0,Eo.default)(_t.address)},r?.localType===J&&v.type===ie.ALL&&Me.default.createElement(to,{closable:!1,className:_t.alert,title:y("wallet_extension_toast_zksync_max_num")}),Me.default.createElement(gn,{dataSource:s,columns:_})))},Gl=Me.default.memo(Cf);f();m();var Ct=N(K());ne();f();m();var rr=N(K()),wu=N(Be());ne();f();m();var pe=N(K());f();m();var Ys=N(Zl()),Bc=N(Cd()),Dc=N(Od()),b=N(K());f();m();f();m();function Kl(t){return typeof t=="object"&&t!=null&&t.nodeType===1}function Vl(t,e){return(!e||t!=="hidden")&&t!=="visible"&&t!=="clip"}function Ts(t,e){if(t.clientHeight<t.scrollHeight||t.clientWidth<t.scrollWidth){var r=getComputedStyle(t,null);return Vl(r.overflowY,e)||Vl(r.overflowX,e)||function(o){var n=function(a){if(!a.ownerDocument||!a.ownerDocument.defaultView)return null;try{return a.ownerDocument.defaultView.frameElement}catch{return null}}(o);return!!n&&(n.clientHeight<o.scrollHeight||n.clientWidth<o.scrollWidth)}(t)}return!1}function An(t,e,r,o,n,a,i,l){return a<t&&i>e||a>t&&i<e?0:a<=t&&l<=r||i>=e&&l>=r?a-t-o:i>e&&l<r||a<t&&l>r?i-e+n:0}var Es=function(t,e){var r=window,o=e.scrollMode,n=e.block,a=e.inline,i=e.boundary,l=e.skipOverflowHiddenElements,d=typeof i=="function"?i:function(Qe){return Qe!==i};if(!Kl(t))throw new TypeError("Invalid target");for(var c,g,x=document.scrollingElement||document.documentElement,v=[],h=t;Kl(h)&&d(h);){if((h=(g=(c=h).parentElement)==null?c.getRootNode().host||null:g)===x){v.push(h);break}h!=null&&h===document.body&&Ts(h)&&!Ts(document.documentElement)||h!=null&&Ts(h,l)&&v.push(h)}for(var p=r.visualViewport?r.visualViewport.width:innerWidth,s=r.visualViewport?r.visualViewport.height:innerHeight,_=window.scrollX||pageXOffset,w=window.scrollY||pageYOffset,S=t.getBoundingClientRect(),k=S.height,C=S.width,z=S.top,U=S.right,q=S.bottom,M=S.left,O=n==="start"||n==="nearest"?z:n==="end"?q:z+k/2,G=a==="center"?M+C/2:a==="end"?U:M,j=[],L=0;L<v.length;L++){var P=v[L],W=P.getBoundingClientRect(),R=W.height,le=W.width,ee=W.top,he=W.right,ue=W.bottom,we=W.left;if(o==="if-needed"&&z>=0&&M>=0&&q<=s&&U<=p&&z>=ee&&q<=ue&&M>=we&&U<=he)return j;var Ne=getComputedStyle(P),Ee=parseInt(Ne.borderLeftWidth,10),ze=parseInt(Ne.borderTopWidth,10),E=parseInt(Ne.borderRightWidth,10),Y=parseInt(Ne.borderBottomWidth,10),F=0,H=0,oe="offsetWidth"in P?P.offsetWidth-P.clientWidth-Ee-E:0,Q="offsetHeight"in P?P.offsetHeight-P.clientHeight-ze-Y:0,de="offsetWidth"in P?P.offsetWidth===0?0:le/P.offsetWidth:0,ke="offsetHeight"in P?P.offsetHeight===0?0:R/P.offsetHeight:0;if(x===P)F=n==="start"?O:n==="end"?O-s:n==="nearest"?An(w,w+s,s,ze,Y,w+O,w+O+k,k):O-s/2,H=a==="start"?G:a==="center"?G-p/2:a==="end"?G-p:An(_,_+p,p,Ee,E,_+G,_+G+C,C),F=Math.max(0,F+w),H=Math.max(0,H+_);else{F=n==="start"?O-ee-ze:n==="end"?O-ue+Y+Q:n==="nearest"?An(ee,ue,R,ze,Y+Q,O,O+k,k):O-(ee+R/2)+Q/2,H=a==="start"?G-we-Ee:a==="center"?G-(we+le/2)+oe/2:a==="end"?G-he+E+oe:An(we,he,le,Ee,E+oe,G,G+C,C);var Ae=P.scrollLeft,Pe=P.scrollTop;O+=Pe-(F=Math.max(0,Math.min(Pe+F/ke,P.scrollHeight-R/ke+Q))),G+=Ae-(H=Math.max(0,Math.min(Ae+H/de,P.scrollWidth-le/de+oe)))}j.push({el:P,top:F,left:H})}return j};function Xl(t){return t===Object(t)&&Object.keys(t).length!==0}function Bf(t,e){e===void 0&&(e="auto");var r="scrollBehavior"in document.body.style;t.forEach(function(o){var n=o.el,a=o.top,i=o.left;n.scroll&&r?n.scroll({top:a,left:i,behavior:e}):(n.scrollTop=a,n.scrollLeft=i)})}function Df(t){return t===!1?{block:"end",inline:"nearest"}:Xl(t)?t:{block:"start",inline:"nearest"}}function Mf(t,e){var r=t.isConnected||t.ownerDocument.documentElement.contains(t);if(Xl(e)&&typeof e.behavior=="function")return e.behavior(r?Es(t,e):[]);if(!!r){var o=Df(e);return Bf(Es(t,o),o.behavior)}}var $l=Mf;var u=N(yo());f();m();f();m();f();m();f();m();f();m();f();m();f();m();var St=[];var Ql=function(){return St.some(function(t){return t.activeTargets.length>0})};f();m();var ec=function(){return St.some(function(t){return t.skippedTargets.length>0})};f();m();var tc="ResizeObserver loop completed with undelivered notifications.",rc=function(){var t;typeof ErrorEvent=="function"?t=new ErrorEvent("error",{message:tc}):(t=document.createEvent("Event"),t.initEvent("error",!1,!1),t.message=tc),window.dispatchEvent(t)};f();m();f();m();f();m();f();m();var yr;(function(t){t.BORDER_BOX="border-box",t.CONTENT_BOX="content-box",t.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"})(yr||(yr={}));f();m();f();m();var kt=function(t){return Object.freeze(t)};var ys=function(){function t(e,r){this.inlineSize=e,this.blockSize=r,kt(this)}return t}();f();m();var As=function(){function t(e,r,o,n){return this.x=e,this.y=r,this.width=o,this.height=n,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,kt(this)}return t.prototype.toJSON=function(){var e=this,r=e.x,o=e.y,n=e.top,a=e.right,i=e.bottom,l=e.left,d=e.width,c=e.height;return{x:r,y:o,top:n,right:a,bottom:i,left:l,width:d,height:c}},t.fromRect=function(e){return new t(e.x,e.y,e.width,e.height)},t}();f();m();var Ao=function(t){return t instanceof SVGElement&&"getBBox"in t},bn=function(t){if(Ao(t)){var e=t.getBBox(),r=e.width,o=e.height;return!r&&!o}var n=t,a=n.offsetWidth,i=n.offsetHeight;return!(a||i||t.getClientRects().length)},bs=function(t){var e;if(t instanceof Element)return!0;var r=(e=t?.ownerDocument)===null||e===void 0?void 0:e.defaultView;return!!(r&&t instanceof r.Element)},oc=function(t){switch(t.tagName){case"INPUT":if(t.type!=="image")break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1};f();m();var Ar=typeof window<"u"?window:{};var Nn=new WeakMap,nc=/auto|scroll/,Pf=/^tb|vertical/,Rf=/msie|trident/i.test(Ar.navigator&&Ar.navigator.userAgent),Wt=function(t){return parseFloat(t||"0")},Kr=function(t,e,r){return t===void 0&&(t=0),e===void 0&&(e=0),r===void 0&&(r=!1),new ys((r?e:t)||0,(r?t:e)||0)},sc=kt({devicePixelContentBoxSize:Kr(),borderBoxSize:Kr(),contentBoxSize:Kr(),contentRect:new As(0,0,0,0)}),Ns=function(t,e){if(e===void 0&&(e=!1),Nn.has(t)&&!e)return Nn.get(t);if(bn(t))return Nn.set(t,sc),sc;var r=getComputedStyle(t),o=Ao(t)&&t.ownerSVGElement&&t.getBBox(),n=!Rf&&r.boxSizing==="border-box",a=Pf.test(r.writingMode||""),i=!o&&nc.test(r.overflowY||""),l=!o&&nc.test(r.overflowX||""),d=o?0:Wt(r.paddingTop),c=o?0:Wt(r.paddingRight),g=o?0:Wt(r.paddingBottom),x=o?0:Wt(r.paddingLeft),v=o?0:Wt(r.borderTopWidth),h=o?0:Wt(r.borderRightWidth),p=o?0:Wt(r.borderBottomWidth),s=o?0:Wt(r.borderLeftWidth),_=x+c,w=d+g,S=s+h,k=v+p,C=l?t.offsetHeight-k-t.clientHeight:0,z=i?t.offsetWidth-S-t.clientWidth:0,U=n?_+S:0,q=n?w+k:0,M=o?o.width:Wt(r.width)-U-z,O=o?o.height:Wt(r.height)-q-C,G=M+_+z+S,j=O+w+C+k,L=kt({devicePixelContentBoxSize:Kr(Math.round(M*devicePixelRatio),Math.round(O*devicePixelRatio),a),borderBoxSize:Kr(G,j,a),contentBoxSize:Kr(M,O,a),contentRect:new As(x,d,M,O)});return Nn.set(t,L),L},kn=function(t,e,r){var o=Ns(t,r),n=o.borderBoxSize,a=o.contentBoxSize,i=o.devicePixelContentBoxSize;switch(e){case yr.DEVICE_PIXEL_CONTENT_BOX:return i;case yr.BORDER_BOX:return n;default:return a}};var ks=function(){function t(e){var r=Ns(e);this.target=e,this.contentRect=r.contentRect,this.borderBoxSize=kt([r.borderBoxSize]),this.contentBoxSize=kt([r.contentBoxSize]),this.devicePixelContentBoxSize=kt([r.devicePixelContentBoxSize])}return t}();f();m();var In=function(t){if(bn(t))return 1/0;for(var e=0,r=t.parentNode;r;)e+=1,r=r.parentNode;return e};var ac=function(){var t=1/0,e=[];St.forEach(function(i){if(i.activeTargets.length!==0){var l=[];i.activeTargets.forEach(function(c){var g=new ks(c.target),x=In(c.target);l.push(g),c.lastReportedSize=kn(c.target,c.observedBox),x<t&&(t=x)}),e.push(function(){i.callback.call(i.observer,l,i.observer)}),i.activeTargets.splice(0,i.activeTargets.length)}});for(var r=0,o=e;r<o.length;r++){var n=o[r];n()}return t};f();m();var Is=function(t){St.forEach(function(r){r.activeTargets.splice(0,r.activeTargets.length),r.skippedTargets.splice(0,r.skippedTargets.length),r.observationTargets.forEach(function(n){n.isActive()&&(In(n.target)>t?r.activeTargets.push(n):r.skippedTargets.push(n))})})};var ic=function(){var t=0;for(Is(t);Ql();)t=ac(),Is(t);return ec()&&rc(),t>0};f();m();f();m();var Cs,lc=[],zf=function(){return lc.splice(0).forEach(function(t){return t()})},cc=function(t){if(!Cs){var e=0,r=document.createTextNode(""),o={characterData:!0};new MutationObserver(function(){return zf()}).observe(r,o),Cs=function(){r.textContent="".concat(e?e--:e++)}}lc.push(t),Cs()};var uc=function(t){cc(function(){requestAnimationFrame(t)})};var Cn=0,Wf=function(){return!!Cn},Uf=250,Hf={attributes:!0,characterData:!0,childList:!0,subtree:!0},dc=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],fc=function(t){return t===void 0&&(t=0),Date.now()+t},Os=!1,Gf=function(){function t(){var e=this;this.stopped=!0,this.listener=function(){return e.schedule()}}return t.prototype.run=function(e){var r=this;if(e===void 0&&(e=Uf),!Os){Os=!0;var o=fc(e);uc(function(){var n=!1;try{n=ic()}finally{if(Os=!1,e=o-fc(),!Wf())return;n?r.run(1e3):e>0?r.run(e):r.start()}})}},t.prototype.schedule=function(){this.stop(),this.run()},t.prototype.observe=function(){var e=this,r=function(){return e.observer&&e.observer.observe(document.body,Hf)};document.body?r():Ar.addEventListener("DOMContentLoaded",r)},t.prototype.start=function(){var e=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),dc.forEach(function(r){return Ar.addEventListener(r,e.listener,!0)}))},t.prototype.stop=function(){var e=this;this.stopped||(this.observer&&this.observer.disconnect(),dc.forEach(function(r){return Ar.removeEventListener(r,e.listener,!0)}),this.stopped=!0)},t}(),On=new Gf,Ls=function(t){!Cn&&t>0&&On.start(),Cn+=t,!Cn&&On.stop()};f();m();var jf=function(t){return!Ao(t)&&!oc(t)&&getComputedStyle(t).display==="inline"},mc=function(){function t(e,r){this.target=e,this.observedBox=r||yr.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return t.prototype.isActive=function(){var e=kn(this.target,this.observedBox,!0);return jf(this.target)&&(this.lastReportedSize=e),this.lastReportedSize.inlineSize!==e.inlineSize||this.lastReportedSize.blockSize!==e.blockSize},t}();f();m();var pc=function(){function t(e,r){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=e,this.callback=r}return t}();var Ln=new WeakMap,hc=function(t,e){for(var r=0;r<t.length;r+=1)if(t[r].target===e)return r;return-1},bo=function(){function t(){}return t.connect=function(e,r){var o=new pc(e,r);Ln.set(e,o)},t.observe=function(e,r,o){var n=Ln.get(e),a=n.observationTargets.length===0;hc(n.observationTargets,r)<0&&(a&&St.push(n),n.observationTargets.push(new mc(r,o&&o.box)),Ls(1),On.schedule())},t.unobserve=function(e,r){var o=Ln.get(e),n=hc(o.observationTargets,r),a=o.observationTargets.length===1;n>=0&&(a&&St.splice(St.indexOf(o),1),o.observationTargets.splice(n,1),Ls(-1))},t.disconnect=function(e){var r=this,o=Ln.get(e);o.observationTargets.slice().forEach(function(n){return r.unobserve(e,n.target)}),o.activeTargets.splice(0,o.activeTargets.length)},t}();var Fs=function(){function t(e){if(arguments.length===0)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if(typeof e!="function")throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");bo.connect(this,e)}return t.prototype.observe=function(e,r){if(arguments.length===0)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!bs(e))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");bo.observe(this,e,r)},t.prototype.unobserve=function(e){if(arguments.length===0)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!bs(e))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");bo.unobserve(this,e)},t.prototype.disconnect=function(){bo.disconnect(this)},t.toString=function(){return"function ResizeObserver () { [polyfill code] }"},t}();var Mn=N(Sc()),Mc=N(Nd());function Un(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Vf(t,e){if(t==null)return{};var r={},o=Object.keys(t),n,a;for(a=0;a<o.length;a++)n=o[a],!(e.indexOf(n)>=0)&&(r[n]=t[n]);return r}function Xr(t,e){if(t==null)return{};var r=Vf(t,e),o,n;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)o=a[n],!(e.indexOf(o)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,o)||(r[o]=t[o]))}return r}var qs=(0,b.createContext)(null),hr=()=>{var t=(0,b.useContext)(qs);if(!t)throw new Error("The `useSlateStatic` hook must be used inside the <Slate> component's context.");return t},Xf=parseInt(b.default.version.split(".")[0],10)>=17,$f=typeof navigator<"u"&&typeof window<"u"&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,wc=typeof navigator<"u"&&/Mac OS X/.test(navigator.userAgent),lt=typeof navigator<"u"&&/Android/.test(navigator.userAgent),zn=typeof navigator<"u"&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent),ko=typeof navigator<"u"&&/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),Jf=typeof navigator<"u"&&/Edge?\/(?:[0-6][0-9]|[0-7][0-8])(?:\.)/i.test(navigator.userAgent),Pc=typeof navigator<"u"&&/Chrome/i.test(navigator.userAgent),Qf=typeof navigator<"u"&&/Chrome?\/(?:[0-7][0-5]|[0-6][0-9])(?:\.)/i.test(navigator.userAgent),em=lt&&typeof navigator<"u"&&/Chrome?\/(?:[0-5]?\d)(?:\.)/i.test(navigator.userAgent),tm=typeof navigator<"u"&&/^(?!.*Seamonkey)(?=.*Firefox\/(?:[0-7][0-9]|[0-8][0-6])(?:\.)).*/i.test(navigator.userAgent),rm=typeof navigator<"u"&&/.*UCBrowser/.test(navigator.userAgent),om=typeof navigator<"u"&&/.*Wechat/.test(navigator.userAgent),Pn=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",dr=(!Qf||!em)&&!Jf&&typeof globalThis<"u"&&globalThis.InputEvent&&typeof globalThis.InputEvent.prototype.getTargetRanges=="function",Zs=new WeakMap,Ks=new WeakMap,Rc=new WeakMap,Rn=new WeakMap,Ps=new WeakMap,Co=new WeakMap,kr=new WeakMap,Rs=new WeakMap,Hn=new WeakMap,zs=new WeakMap,br=new WeakMap,Nr=new WeakMap,Io=new WeakMap,Ws=new WeakMap,Vs=new WeakMap,It=new WeakMap,er=new WeakMap,$e=new WeakMap,fr=new WeakMap,mr=new WeakMap,zc=new WeakMap,$r=Symbol("placeholder"),Wc=Symbol("mark-placeholder"),nm=globalThis.Text,Xs=t=>t&&t.ownerDocument&&t.ownerDocument.defaultView||null,sm=t=>pr(t)&&t.nodeType===8,wt=t=>pr(t)&&t.nodeType===1,pr=t=>{var e=Xs(t);return!!e&&t instanceof e.Node},Us=t=>{var e=t&&t.anchorNode&&Xs(t.anchorNode);return!!e&&t instanceof e.Selection},Uc=t=>pr(t)&&t.nodeType===3,am=t=>t.clipboardData&&t.clipboardData.getData("text/plain")!==""&&t.clipboardData.types.length===1,im=t=>{var[e,r]=t;if(wt(e)&&e.childNodes.length){var o=r===e.childNodes.length,n=o?r-1:r;for([e,n]=Hc(e,n,o?"backward":"forward"),o=n<r;wt(e)&&e.childNodes.length;){var a=o?e.childNodes.length-1:0;e=cm(e,a,o?"backward":"forward")}r=o&&e.textContent!=null?e.textContent.length:0}return[e,r]},lm=t=>{for(var e=t&&t.parentNode;e;){if(e.toString()==="[object ShadowRoot]")return!0;e=e.parentNode}return!1},Hc=(t,e,r)=>{for(var{childNodes:o}=t,n=o[e],a=e,i=!1,l=!1;(sm(n)||wt(n)&&n.childNodes.length===0||wt(n)&&n.getAttribute("contenteditable")==="false")&&!(i&&l);){if(a>=o.length){i=!0,a=e-1,r="backward";continue}if(a<0){l=!0,a=e+1,r="forward";continue}n=o[a],e=a,a+=r==="forward"?1:-1}return[n,e]},cm=(t,e,r)=>{var[o]=Hc(t,e,r);return o},Gc=t=>{var e="";if(Uc(t)&&t.nodeValue)return t.nodeValue;if(wt(t)){for(var r of Array.from(t.childNodes))e+=Gc(r);var o=getComputedStyle(t).getPropertyValue("display");(o==="block"||o==="list"||t.tagName==="BR")&&(e+=`
`)}return e},um=/data-slate-fragment="(.+?)"/m,dm=t=>{var e=t.getData("text/html"),[,r]=e.match(um)||[];return r},$s=(t,e,r)=>{var{target:o}=e;if(wt(o)&&o.matches('[contentEditable="false"]'))return!1;var{document:n}=I.getWindow(t);if(n.contains(o))return I.hasDOMNode(t,o,{editable:!0});var a=r.find(i=>{var{addedNodes:l,removedNodes:d}=i;for(var c of l)if(c===o||c.contains(o))return!0;for(var g of d)if(g===o||g.contains(o))return!0});return!a||a===e?!1:$s(t,a,r)},fm=0,Hs=class{constructor(){this.id="".concat(fm++)}},I={androidPendingDiffs:t=>$e.get(t),androidScheduleFlush:t=>{var e;(e=Vs.get(t))===null||e===void 0||e()},blur:t=>{var e=I.toDOMNode(t,t),r=I.findDocumentOrShadowRoot(t);br.set(t,!1),r.activeElement===e&&e.blur()},deselect:t=>{var{selection:e}=t,r=I.findDocumentOrShadowRoot(t),o=r.getSelection();o&&o.rangeCount>0&&o.removeAllRanges(),e&&u.Transforms.deselect(t)},findDocumentOrShadowRoot:t=>{var e=I.toDOMNode(t,t),r=e.getRootNode();return(r instanceof Document||r instanceof ShadowRoot)&&r.getSelection!=null?r:e.ownerDocument},findEventRange:(t,e)=>{"nativeEvent"in e&&(e=e.nativeEvent);var{clientX:r,clientY:o,target:n}=e;if(r==null||o==null)throw new Error("Cannot resolve a Slate range from a DOM event: ".concat(e));var a=I.toSlateNode(t,e.target),i=I.findPath(t,a);if(u.Element.isElement(a)&&u.Editor.isVoid(t,a)){var l=n.getBoundingClientRect(),d=t.isInline(a)?r-l.left<l.left+l.width-r:o-l.top<l.top+l.height-o,c=u.Editor.point(t,i,{edge:d?"start":"end"}),g=d?u.Editor.before(t,c):u.Editor.after(t,c);if(g){var x=u.Editor.range(t,g);return x}}var v,{document:h}=I.getWindow(t);if(h.caretRangeFromPoint)v=h.caretRangeFromPoint(r,o);else{var p=h.caretPositionFromPoint(r,o);p&&(v=h.createRange(),v.setStart(p.offsetNode,p.offset),v.setEnd(p.offsetNode,p.offset))}if(!v)throw new Error("Cannot resolve a Slate range from a DOM event: ".concat(e));var s=I.toSlateRange(t,v,{exactMatch:!1,suppressThrow:!1});return s},findKey:(t,e)=>{var r=Rs.get(e);return r||(r=new Hs,Rs.set(e,r)),r},findPath:(t,e)=>{for(var r=[],o=e;;){var n=Ks.get(o);if(n==null){if(u.Editor.isEditor(o))return r;break}var a=Zs.get(o);if(a==null)break;r.unshift(a),o=n}throw new Error("Unable to find the path for Slate node: ".concat(u.Scrubber.stringify(e)))},focus:t=>{var e=I.toDOMNode(t,t),r=I.findDocumentOrShadowRoot(t);br.set(t,!0),r.activeElement!==e&&e.focus({preventScroll:!0})},getWindow:t=>{var e=Rc.get(t);if(!e)throw new Error("Unable to find a host window element for this editor");return e},hasDOMNode:function(e,r){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},{editable:n=!1}=o,a=I.toDOMNode(e,e),i;try{i=wt(r)?r:r.parentElement}catch(l){if(!l.message.includes('Permission denied to access property "nodeType"'))throw l}return i?i.closest("[data-slate-editor]")===a&&(!n||i.isContentEditable?!0:typeof i.isContentEditable=="boolean"&&i.closest('[contenteditable="false"]')===a||!!i.getAttribute("data-slate-zero-width")):!1},hasEditableTarget:(t,e)=>pr(e)&&I.hasDOMNode(t,e,{editable:!0}),hasRange:(t,e)=>{var{anchor:r,focus:o}=e;return u.Editor.hasPath(t,r.path)&&u.Editor.hasPath(t,o.path)},hasSelectableTarget:(t,e)=>I.hasEditableTarget(t,e)||I.isTargetInsideNonReadonlyVoid(t,e),hasTarget:(t,e)=>pr(e)&&I.hasDOMNode(t,e),insertData:(t,e)=>{t.insertData(e)},insertFragmentData:(t,e)=>t.insertFragmentData(e),insertTextData:(t,e)=>t.insertTextData(e),isComposing:t=>!!Nr.get(t),isFocused:t=>!!br.get(t),isReadOnly:t=>!!zs.get(t),isTargetInsideNonReadonlyVoid:(t,e)=>{if(zs.get(t))return!1;var r=I.hasTarget(t,e)&&I.toSlateNode(t,e);return u.Element.isElement(r)&&u.Editor.isVoid(t,r)},setFragmentData:(t,e,r)=>t.setFragmentData(e,r),toDOMNode:(t,e)=>{var r=Hn.get(t),o=u.Editor.isEditor(e)?Rn.get(t):r?.get(I.findKey(t,e));if(!o)throw new Error("Cannot resolve a DOM node from Slate node: ".concat(u.Scrubber.stringify(e)));return o},toDOMPoint:(t,e)=>{var[r]=u.Editor.node(t,e.path),o=I.toDOMNode(t,r),n;u.Editor.void(t,{at:e})&&(e={path:e.path,offset:0});for(var a="[data-slate-string], [data-slate-zero-width]",i=Array.from(o.querySelectorAll(a)),l=0,d=0;d<i.length;d++){var c=i[d],g=c.childNodes[0];if(!(g==null||g.textContent==null)){var{length:x}=g.textContent,v=c.getAttribute("data-slate-length"),h=v==null?x:parseInt(v,10),p=l+h,s=i[d+1];if(e.offset===p&&s!==null&&s!==void 0&&s.hasAttribute("data-slate-mark-placeholder")){var _,w=s.childNodes[0];n=[w instanceof nm?w:s,(_=s.textContent)!==null&&_!==void 0&&_.startsWith("\uFEFF")?1:0];break}if(e.offset<=p){var S=Math.min(x,Math.max(0,e.offset-l));n=[g,S];break}l=p}}if(!n)throw new Error("Cannot resolve a DOM point from Slate point: ".concat(u.Scrubber.stringify(e)));return n},toDOMRange:(t,e)=>{var{anchor:r,focus:o}=e,n=u.Range.isBackward(e),a=I.toDOMPoint(t,r),i=u.Range.isCollapsed(e)?a:I.toDOMPoint(t,o),l=I.getWindow(t),d=l.document.createRange(),[c,g]=n?i:a,[x,v]=n?a:i,h=wt(c)?c:c.parentElement,p=!!h.getAttribute("data-slate-zero-width"),s=wt(x)?x:x.parentElement,_=!!s.getAttribute("data-slate-zero-width");return d.setStart(c,p?1:g),d.setEnd(x,_?1:v),d},toSlateNode:(t,e)=>{var r=wt(e)?e:e.parentElement;r&&!r.hasAttribute("data-slate-node")&&(r=r.closest("[data-slate-node]"));var o=r?Co.get(r):null;if(!o)throw new Error("Cannot resolve a Slate node from DOM node: ".concat(r));return o},toSlatePoint:(t,e,r)=>{var{exactMatch:o,suppressThrow:n}=r,[a,i]=o?e:im(e),l=a.parentNode,d=null,c=0;if(l){var g,x,v=I.toDOMNode(t,t),h=l.closest('[data-slate-void="true"]'),p=h&&v.contains(h)?h:null,s=l.closest("[data-slate-leaf]"),_=null;if(s){if(d=s.closest('[data-slate-node="text"]'),d){var w=I.getWindow(t),S=w.document.createRange();S.setStart(d,0),S.setEnd(a,i);var k=S.cloneContents(),C=[...Array.prototype.slice.call(k.querySelectorAll("[data-slate-zero-width]")),...Array.prototype.slice.call(k.querySelectorAll("[contenteditable=false]"))];C.forEach(W=>{if(lt&&!o&&W.hasAttribute("data-slate-zero-width")&&W.textContent.length>0&&W.textContext!=="\uFEFF"){W.textContent.startsWith("\uFEFF")&&(W.textContent=W.textContent.slice(1));return}W.parentNode.removeChild(W)}),c=k.textContent.length,_=d}}else if(p){for(var z=p.querySelectorAll("[data-slate-leaf]"),U=0;U<z.length;U++){var q=z[U];if(I.hasDOMNode(t,q)){s=q;break}}s?(d=s.closest('[data-slate-node="text"]'),_=s,c=_.textContent.length,_.querySelectorAll("[data-slate-zero-width]").forEach(W=>{c-=W.textContent.length})):c=1}_&&c===_.textContent.length&&lt&&_.getAttribute("data-slate-zero-width")==="z"&&(g=_.textContent)!==null&&g!==void 0&&g.startsWith("\uFEFF")&&(l.hasAttribute("data-slate-zero-width")||zn&&(x=_.textContent)!==null&&x!==void 0&&x.endsWith(`

`))&&c--}if(lt&&!d&&!o){var M=l.hasAttribute("data-slate-node")?l:l.closest("[data-slate-node]");if(M&&I.hasDOMNode(t,M,{editable:!0})){var O=I.toSlateNode(t,M),{path:G,offset:j}=u.Editor.start(t,I.findPath(t,O));return M.querySelector("[data-slate-leaf]")||(j=i),{path:G,offset:j}}}if(!d){if(n)return null;throw new Error("Cannot resolve a Slate point from DOM point: ".concat(e))}var L=I.toSlateNode(t,d),P=I.findPath(t,L);return{path:P,offset:c}},toSlateRange:(t,e,r)=>{var{exactMatch:o,suppressThrow:n}=r,a=Us(e)?e.anchorNode:e.startContainer,i,l,d,c,g;if(a&&(Us(e)?(i=e.anchorNode,l=e.anchorOffset,d=e.focusNode,c=e.focusOffset,Pc&&lm(i)?g=e.anchorNode===e.focusNode&&e.anchorOffset===e.focusOffset:g=e.isCollapsed):(i=e.startContainer,l=e.startOffset,d=e.endContainer,c=e.endOffset,g=e.collapsed)),i==null||d==null||l==null||c==null)throw new Error("Cannot resolve a Slate range from DOM range: ".concat(e));if("getAttribute"in d&&d.getAttribute("contenteditable")==="false"){var x;d=i,c=((x=i.textContent)===null||x===void 0?void 0:x.length)||0}var v=I.toSlatePoint(t,[i,l],{exactMatch:o,suppressThrow:n});if(!v)return null;var h=g?v:I.toSlatePoint(t,[d,c],{exactMatch:o,suppressThrow:n});if(!h)return null;if(zn&&!g&&i!==d){var p=u.Editor.isEnd(t,v,v.path),s=u.Editor.isStart(t,h,h.path);if(p){var _=u.Editor.after(t,v);v=_||v}if(s){var w=u.Editor.before(t,h);h=w||h}}var S={anchor:v,focus:h};return u.Range.isExpanded(S)&&u.Range.isForward(S)&&wt(d)&&u.Editor.void(t,{at:S.focus,mode:"highest"})&&(S=u.Editor.unhangRange(t,S,{voids:!0})),S}};function mm(t,e){var{path:r,diff:o}=e;if(!u.Editor.hasPath(t,r))return!1;var n=u.Node.get(t,r);if(!u.Text.isText(n))return!1;if(o.start!==n.text.length||o.text.length===0)return n.text.slice(o.start,o.start+o.text.length)===o.text;var a=u.Path.next(r);if(!u.Editor.hasPath(t,a))return!1;var i=u.Node.get(t,a);return u.Text.isText(i)&&i.text.startsWith(o.text)}function jc(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),o=1;o<e;o++)r[o-1]=arguments[o];return r.reduce((n,a)=>n.slice(0,a.start)+a.text+n.slice(a.end),t)}function pm(t,e){for(var r=Math.min(t.length,e.length),o=0;o<r;o++)if(t.charAt(o)!==e.charAt(o))return o;return r}function hm(t,e,r){for(var o=Math.min(t.length,e.length,r),n=0;n<o;n++)if(t.charAt(t.length-n-1)!==e.charAt(e.length-n-1))return n;return o}function Yc(t,e){var{start:r,end:o,text:n}=e,a=t.slice(r,o),i=pm(a,n),l=Math.min(a.length-i,n.length-i),d=hm(a,n,l),c={start:r+i,end:o-d,text:n.slice(i,n.length-d)};return c.start===c.end&&c.text.length===0?null:c}function vm(t,e,r){var o=Math.min(e.start,r.start),n=Math.max(0,Math.min(e.start+e.text.length,r.end)-r.start),a=jc(t,e,r),i=Math.max(r.start+r.text.length,e.start+e.text.length+(e.start+e.text.length>r.start?r.text.length:0)-n),l=a.slice(o,i),d=Math.max(e.end,r.end-e.text.length+(e.end-e.start));return Yc(t,{start:o,end:d,text:l})}function gm(t){var{path:e,diff:r}=t;return{anchor:{path:e,offset:r.start},focus:{path:e,offset:r.end}}}function Gs(t,e){var{path:r,offset:o}=e;if(!u.Editor.hasPath(t,r))return null;var n=u.Node.get(t,r);if(!u.Text.isText(n))return null;var a=u.Editor.above(t,{match:l=>u.Element.isElement(l)&&u.Editor.isBlock(t,l),at:r});if(!a)return null;for(;o>n.text.length;){var i=u.Editor.next(t,{at:r,match:u.Text.isText});if(!i||!u.Path.isDescendant(i[1],a[1]))return null;o-=n.text.length,n=i[0],r=i[1]}return{path:r,offset:o}}function Tc(t,e){var r=Gs(t,e.anchor);if(!r)return null;if(u.Range.isCollapsed(e))return{anchor:r,focus:r};var o=Gs(t,e.focus);return o?{anchor:r,focus:o}:null}function js(t,e,r){var o=$e.get(t),n=o?.find(g=>{var{path:x}=g;return u.Path.equals(x,e.path)});if(!n||e.offset<=n.diff.start)return u.Point.transform(e,r,{affinity:"backward"});var{diff:a}=n;if(e.offset<=a.start+a.text.length){var i={path:e.path,offset:a.start},l=u.Point.transform(i,r,{affinity:"backward"});return l?{path:l.path,offset:l.offset+e.offset-a.start}:null}var d={path:e.path,offset:e.offset-a.text.length+a.end-a.start},c=u.Point.transform(d,r,{affinity:"backward"});return c?r.type==="split_node"&&u.Path.equals(r.path,e.path)&&d.offset<r.position&&a.start<r.position?c:{path:c.path,offset:c.offset+a.text.length-a.end+a.start}:null}function Ec(t,e,r){var o=js(t,e.anchor,r);if(!o)return null;if(u.Range.isCollapsed(e))return{anchor:o,focus:o};var n=js(t,e.focus,r);return n?{anchor:o,focus:n}:null}function _m(t,e){var{path:r,diff:o,id:n}=t;switch(e.type){case"insert_text":return!u.Path.equals(e.path,r)||e.offset>=o.end?t:e.offset<=o.start?{diff:{start:e.text.length+o.start,end:e.text.length+o.end,text:o.text},id:n,path:r}:{diff:{start:o.start,end:o.end+e.text.length,text:o.text},id:n,path:r};case"remove_text":return!u.Path.equals(e.path,r)||e.offset>=o.end?t:e.offset+e.text.length<=o.start?{diff:{start:o.start-e.text.length,end:o.end-e.text.length,text:o.text},id:n,path:r}:{diff:{start:o.start,end:o.end-e.text.length,text:o.text},id:n,path:r};case"split_node":return!u.Path.equals(e.path,r)||e.position>=o.end?{diff:o,id:n,path:u.Path.transform(r,e,{affinity:"backward"})}:e.position>o.start?{diff:{start:o.start,end:Math.min(e.position,o.end),text:o.text},id:n,path:r}:{diff:{start:o.start-e.position,end:o.end-e.position,text:o.text},id:n,path:u.Path.transform(r,e,{affinity:"forward"})};case"merge_node":return u.Path.equals(e.path,r)?{diff:{start:o.start+e.position,end:o.end+e.position,text:o.text},id:n,path:u.Path.transform(r,e)}:{diff:o,id:n,path:u.Path.transform(r,e)}}var a=u.Path.transform(r,e);return a?{diff:o,path:a,id:n}:null}function yc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,o)}return r}function Bn(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?yc(Object(r),!0).forEach(function(o){Un(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):yc(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var xm=25,Sm=200,wm=function(){},Tm=t=>t?.constructor.name==="DataTransfer";function Em(t){var{editor:e,scheduleOnDOMSelectionChange:r,onDOMSelectionChange:o}=t,n=!1,a=null,i=null,l=null,d=0,c=!1,g=()=>{var L=mr.get(e);if(mr.delete(e),L){var{selection:P}=e,W=Tc(e,L);W&&(!P||!u.Range.equals(W,P))&&u.Transforms.select(e,W)}},x=()=>{var L=fr.get(e);if(fr.delete(e),!!L){if(L.at){var P=u.Point.isPoint(L.at)?Gs(e,L.at):Tc(e,L.at);if(!P)return;var W=u.Editor.range(e,P);(!e.selection||!u.Range.equals(e.selection,W))&&u.Transforms.select(e,P)}L.run()}},v=()=>{if(i&&(clearTimeout(i),i=null),l&&(clearTimeout(l),l=null),!C()&&!k()){g();return}n||(n=!0,setTimeout(()=>n=!1)),k()&&(n="action");var L=e.selection&&u.Editor.rangeRef(e,e.selection,{affinity:"forward"});er.set(e,e.marks),wm("flush",fr.get(e),$e.get(e));for(var P=C(),W;W=(R=$e.get(e))===null||R===void 0?void 0:R[0];){var R,le,ee=It.get(e);ee!==void 0&&(It.delete(e),e.marks=ee),ee&&c===!1&&(c=null);var he=gm(W);(!e.selection||!u.Range.equals(e.selection,he))&&u.Transforms.select(e,he),W.diff.text?u.Editor.insertText(e,W.diff.text):u.Editor.deleteFragment(e),$e.set(e,(le=$e.get(e))===null||le===void 0?void 0:le.filter(Ne=>{var{id:Ee}=Ne;return Ee!==W.id})),mm(e,W)||(P=!1,fr.delete(e),er.delete(e),n="action",mr.delete(e),r.cancel(),o.cancel(),L?.unref())}var ue=L?.unref();if(ue&&!mr.get(e)&&(!e.selection||!u.Range.equals(ue,e.selection))&&u.Transforms.select(e,ue),k()){x();return}P&&r(),r.flush(),o.flush(),g();var we=er.get(e);er.delete(e),we!==void 0&&(e.marks=we,e.onChange())},h=L=>{a&&clearTimeout(a),a=setTimeout(()=>{Nr.set(e,!1),v()},xm)},p=L=>{Nr.set(e,!0),a&&(clearTimeout(a),a=null)},s=function(){var P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,W=Ps.get(e);if(!!W){if(C()||P){W.style.display="none";return}W.style.removeProperty("display")}},_=(L,P)=>{var W,R=(W=$e.get(e))!==null&&W!==void 0?W:[];$e.set(e,R);var le=u.Node.leaf(e,L),ee=R.findIndex(we=>u.Path.equals(we.path,L));if(ee<0){var he=Yc(le.text,P);he&&R.push({path:L,diff:P,id:d++}),s();return}var ue=vm(le.text,R[ee].diff,P);if(!ue){R.splice(ee,1),s();return}R[ee]=Bn(Bn({},R[ee]),{},{diff:ue})},w=function(P){var{at:W}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};c=!1,mr.delete(e),r.cancel(),o.cancel(),k()&&v(),fr.set(e,{at:W,run:P}),l=setTimeout(v)},S=L=>{var P;i&&(clearTimeout(i),i=null);var{inputType:W}=L,R=null,le=L.dataTransfer||L.data||void 0;c!==!1&&W!=="insertText"&&W!=="insertCompositionText"&&(c=!1);var[ee]=L.getTargetRanges();ee&&(R=I.toSlateRange(e,ee,{exactMatch:!1,suppressThrow:!0}));var he=I.getWindow(e),ue=he.getSelection();if(!R&&ue&&(ee=ue,R=I.toSlateRange(e,ue,{exactMatch:!1,suppressThrow:!0})),R=(P=R)!==null&&P!==void 0?P:e.selection,!!R){var we=!0;if(W.startsWith("delete")){if(u.Range.isExpanded(R)){var[Ne,Ee]=u.Range.edges(R),ze=u.Node.leaf(e,Ne.path);if(ze.text.length===Ne.offset&&Ee.offset===0){var E=u.Editor.next(e,{at:Ne.path,match:u.Text.isText});E&&u.Path.equals(E[1],Ee.path)&&(R={anchor:Ee,focus:Ee})}}var Y=W.endsWith("Backward")?"backward":"forward",[F,H]=u.Range.edges(R),[oe,Q]=u.Editor.leaf(e,F.path),de={text:"",start:F.offset,end:H.offset},ke=$e.get(e),Ae=ke?.find(Po=>u.Path.equals(Po.path,Q)),Pe=Ae?[Ae.diff,de]:[de],Qe=jc(oe.text,...Pe);if(Qe.length===0&&(we=!1),u.Range.isExpanded(R)){if(we&&u.Path.equals(R.anchor.path,R.focus.path)){var et={path:R.anchor.path,offset:F.offset},tt=u.Editor.range(e,et,et);return q(tt),_(R.anchor.path,{text:"",end:H.offset,start:F.offset})}return w(()=>u.Editor.deleteFragment(e,{direction:Y}),{at:R})}}switch(W){case"deleteByComposition":case"deleteByCut":case"deleteByDrag":return w(()=>u.Editor.deleteFragment(e),{at:R});case"deleteContent":case"deleteContentForward":{var{anchor:We}=R;if(we&&u.Range.isCollapsed(R)){var qt=u.Node.leaf(e,We.path);if(We.offset<qt.text.length)return _(We.path,{text:"",start:We.offset,end:We.offset+1})}return w(()=>u.Editor.deleteForward(e),{at:R})}case"deleteContentBackward":{var Zt,{anchor:Et}=R,or=Us(ee)?ee.isCollapsed:!!((Zt=ee)!==null&&Zt!==void 0&&Zt.collapsed);return we&&or&&u.Range.isCollapsed(R)&&Et.offset>0?_(Et.path,{text:"",start:Et.offset-1,end:Et.offset}):w(()=>u.Editor.deleteBackward(e),{at:R})}case"deleteEntireSoftLine":return w(()=>{u.Editor.deleteBackward(e,{unit:"line"}),u.Editor.deleteForward(e,{unit:"line"})},{at:R});case"deleteHardLineBackward":return w(()=>u.Editor.deleteBackward(e,{unit:"block"}),{at:R});case"deleteSoftLineBackward":return w(()=>u.Editor.deleteBackward(e,{unit:"line"}),{at:R});case"deleteHardLineForward":return w(()=>u.Editor.deleteForward(e,{unit:"block"}),{at:R});case"deleteSoftLineForward":return w(()=>u.Editor.deleteForward(e,{unit:"line"}),{at:R});case"deleteWordBackward":return w(()=>u.Editor.deleteBackward(e,{unit:"word"}),{at:R});case"deleteWordForward":return w(()=>u.Editor.deleteForward(e,{unit:"word"}),{at:R});case"insertLineBreak":return w(()=>u.Editor.insertSoftBreak(e),{at:R});case"insertParagraph":return w(()=>u.Editor.insertBreak(e),{at:R});case"insertCompositionText":case"deleteCompositionText":case"insertFromComposition":case"insertFromDrop":case"insertFromPaste":case"insertFromYank":case"insertReplacementText":case"insertText":{if(Tm(le))return w(()=>I.insertData(e,le),{at:R});var ge=le??"";if(It.get(e)&&(ge=ge.replace("\uFEFF","")),W==="insertText"&&/.*\n.*\n$/.test(ge)&&(ge=ge.slice(0,-1)),ge.includes(`
`))return w(()=>{var Po=ge.split(`
`);Po.forEach((ca,Ad)=>{ca&&u.Editor.insertText(e,ca),Ad!==Po.length-1&&u.Editor.insertSoftBreak(e)})},{at:R});if(u.Path.equals(R.anchor.path,R.focus.path)){var[Dr,Zn]=u.Range.edges(R),Lt={start:Dr.offset,end:Zn.offset,text:ge};if(ge&&c&&W==="insertCompositionText"){var Mo=c.start+c.text.search(/\S|$/),yd=Lt.start+Lt.text.search(/\S|$/);yd===Mo+1&&Lt.end===c.start+c.text.length?(Lt.start-=1,c=null,G()):c=!1}else W==="insertText"?c===null?c=Lt:c&&u.Range.isCollapsed(R)&&c.end+c.text.length===Dr.offset?c=Bn(Bn({},c),{},{text:c.text+ge}):c=!1:c=!1;if(we){_(Dr.path,Lt);return}}return w(()=>u.Editor.insertText(e,ge),{at:R})}}}},k=()=>!!fr.get(e),C=()=>{var L;return!!((L=$e.get(e))!==null&&L!==void 0&&L.length)},z=()=>k()||C(),U=()=>n,q=L=>{mr.set(e,L),i&&(clearTimeout(i),i=null);var{selection:P}=e;if(!!L){var W=!P||!u.Path.equals(P.anchor.path,L.anchor.path),R=!P||!u.Path.equals(P.anchor.path.slice(0,-1),L.anchor.path.slice(0,-1));(W&&c||R)&&(c=!1),(W||C())&&(i=setTimeout(v,Sm))}},M=()=>{(k()||!C())&&v()},O=L=>{C()||(s(!0),setTimeout(s))},G=()=>{k()||(l=setTimeout(v))},j=L=>{if(!(C()||k())&&L.some(W=>$s(e,W,L))){var P;(P=zc.get(e))===null||P===void 0||P()}};return{flush:v,scheduleFlush:G,hasPendingDiffs:C,hasPendingAction:k,hasPendingChanges:z,isFlushing:U,handleUserSelect:q,handleCompositionEnd:h,handleCompositionStart:p,handleDOMBeforeInput:S,handleKeyDown:O,handleDomMutations:j,handleInput:M}}function ym(){var t=(0,b.useRef)(!1);return(0,b.useEffect)(()=>(t.current=!0,()=>{t.current=!1}),[]),t.current}var Oo=Pn?b.useLayoutEffect:b.useEffect;function Am(t,e,r){var[o]=(0,b.useState)(()=>new MutationObserver(e));Oo(()=>{o.takeRecords()}),(0,b.useEffect)(()=>{if(!t.current)throw new Error("Failed to attach MutationObserver, `node` is undefined");return o.observe(t.current,r),()=>o.disconnect()},[o,t,r])}var bm=["node"];function Ac(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,o)}return r}function Nm(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ac(Object(r),!0).forEach(function(o){Un(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ac(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var km={subtree:!0,childList:!0,characterData:!0},Im=lt?t=>{var{node:e}=t,r=Xr(t,bm);if(!lt)return null;var o=hr(),n=ym(),[a]=(0,b.useState)(()=>Em(Nm({editor:o},r)));return Am(e,a.handleDomMutations,km),Vs.set(o,a.scheduleFlush),n&&a.flush(),a}:()=>null,Cm=["anchor","focus"],Om=["anchor","focus"],Lm=(t,e)=>Object.keys(t).length===Object.keys(e).length&&Object.keys(t).every(r=>e.hasOwnProperty(r)&&t[r]===e[r]),qc=(t,e)=>{var r=Xr(t,Cm),o=Xr(e,Om);return t[$r]===e[$r]&&Lm(r,o)},Fm=(t,e)=>{if(t.length!==e.length)return!1;for(var r=0;r<t.length;r++){var o=t[r],n=e[r];if(!u.Range.equals(o,n)||!qc(o,n))return!1}return!0},Bm=(t,e)=>{if(t.length!==e.length)return!1;for(var r=0;r<t.length;r++){var o=t[r],n=e[r];if(o.anchor.offset!==n.anchor.offset||o.focus.offset!==n.focus.offset||!qc(o,n))return!1}return!0},Dm=t=>{var{isLast:e,leaf:r,parent:o,text:n}=t,a=hr(),i=I.findPath(a,n),l=u.Path.parent(i),d=r[Wc]===!0;return a.isVoid(o)?b.default.createElement(Ms,{length:u.Node.string(o).length}):r.text===""&&o.children[o.children.length-1]===n&&!a.isInline(o)&&u.Editor.string(a,l)===""?b.default.createElement(Ms,{isLineBreak:!0,isMarkPlaceholder:d}):r.text===""?b.default.createElement(Ms,{isMarkPlaceholder:d}):e&&r.text.slice(-1)===`
`?b.default.createElement(bc,{isTrailing:!0,text:r.text}):b.default.createElement(bc,{text:r.text})},bc=t=>{var{text:e,isTrailing:r=!1}=t,o=(0,b.useRef)(null),n=()=>"".concat(e??"").concat(r?`
`:""),[a]=(0,b.useState)(n);return Oo(()=>{var i=n();o.current&&o.current.textContent!==i&&(o.current.textContent=i)}),b.default.createElement(Mm,{ref:o},a)},Mm=(0,b.memo)((0,b.forwardRef)((t,e)=>b.default.createElement("span",{"data-slate-string":!0,ref:e},t.children))),Ms=t=>{var{length:e=0,isLineBreak:r=!1,isMarkPlaceholder:o=!1}=t,n={"data-slate-zero-width":r?"n":"z","data-slate-length":e};return o&&(n["data-slate-mark-placeholder"]=!0),b.default.createElement("span",Object.assign({},n),!lt||!r?"\uFEFF":null,r?b.default.createElement("br",null):null)};function Pm(t,e){t.current&&(t.current.disconnect(),e&&(t.current=null))}function Nc(t){t.current&&(clearTimeout(t.current),t.current=null)}var Rm=t=>{var{leaf:e,isLast:r,text:o,parent:n,renderPlaceholder:a,renderLeaf:i=S=>b.default.createElement(Wm,Object.assign({},S))}=t,l=hr(),d=(0,b.useRef)(null),c=(0,b.useRef)(null),[g,x]=(0,b.useState)(!1),v=(0,b.useRef)(null),h=(0,b.useCallback)(S=>{if(Pm(d,S==null),S==null){var k;Ps.delete(l),(k=e.onPlaceholderResize)===null||k===void 0||k.call(e,null)}else{if(Ps.set(l,S),!d.current){var C=window.ResizeObserver||Fs;d.current=new C(()=>{var z;(z=e.onPlaceholderResize)===null||z===void 0||z.call(e,S)})}d.current.observe(S),c.current=S}},[c,e,l]),p=b.default.createElement(Dm,{isLast:r,leaf:e,parent:n,text:o}),s=e[$r];if((0,b.useEffect)(()=>(s?v.current||(v.current=setTimeout(()=>{x(!0),v.current=null},300)):(Nc(v),x(!1)),()=>Nc(v)),[s,x]),s&&g){var _={children:e.placeholder,attributes:{"data-slate-placeholder":!0,style:{position:"absolute",pointerEvents:"none",width:"100%",maxWidth:"100%",display:"block",opacity:"0.333",userSelect:"none",textDecoration:"none",WebkitUserModify:ko?"inherit":void 0},contentEditable:!1,ref:h}};p=b.default.createElement(b.default.Fragment,null,a(_),p)}var w={"data-slate-leaf":!0};return i({attributes:w,children:p,leaf:e,text:o})},zm=b.default.memo(Rm,(t,e)=>e.parent===t.parent&&e.isLast===t.isLast&&e.renderLeaf===t.renderLeaf&&e.renderPlaceholder===t.renderPlaceholder&&e.text===t.text&&u.Text.equals(e.leaf,t.leaf)&&e.leaf[$r]===t.leaf[$r]),Wm=t=>{var{attributes:e,children:r}=t;return b.default.createElement("span",Object.assign({},e),r)},Um=t=>{for(var{decorations:e,isLast:r,parent:o,renderPlaceholder:n,renderLeaf:a,text:i}=t,l=hr(),d=(0,b.useRef)(null),c=u.Text.decorations(i,e),g=I.findKey(l,i),x=[],v=0;v<c.length;v++){var h=c[v];x.push(b.default.createElement(zm,{isLast:r&&v===c.length-1,key:"".concat(g.id,"-").concat(v),renderPlaceholder:n,leaf:h,text:i,parent:o,renderLeaf:a}))}var p=(0,b.useCallback)(s=>{var _=Hn.get(l);s?(_?.set(g,s),kr.set(i,s),Co.set(s,i)):(_?.delete(g),kr.delete(i),d.current&&Co.delete(d.current)),d.current=s},[d,l,g,i]);return b.default.createElement("span",{"data-slate-node":"text",ref:p},x)},Zc=b.default.memo(Um,(t,e)=>e.parent===t.parent&&e.isLast===t.isLast&&e.renderLeaf===t.renderLeaf&&e.renderPlaceholder===t.renderPlaceholder&&e.text===t.text&&Bm(e.decorations,t.decorations)),Hm=t=>{var{decorations:e,element:r,renderElement:o=S=>b.default.createElement(jm,Object.assign({},S)),renderPlaceholder:n,renderLeaf:a,selection:i}=t,l=hr(),d=Zm(),c=l.isInline(r),g=I.findKey(l,r),x=(0,b.useCallback)(S=>{var k=Hn.get(l);S?(k?.set(g,S),kr.set(r,S),Co.set(S,r)):(k?.delete(g),kr.delete(r))},[l,g,r]),v=Vc({decorations:e,node:r,renderElement:o,renderPlaceholder:n,renderLeaf:a,selection:i}),h={"data-slate-node":"element",ref:x};if(c&&(h["data-slate-inline"]=!0),!c&&u.Editor.hasInlines(l,r)){var p=u.Node.string(r),s=(0,Ys.default)(p);s==="rtl"&&(h.dir=s)}if(u.Editor.isVoid(l,r)){h["data-slate-void"]=!0,!d&&c&&(h.contentEditable=!1);var _=c?"span":"div",[[w]]=u.Node.texts(r);v=b.default.createElement(_,{"data-slate-spacer":!0,style:{height:"0",color:"transparent",outline:"none",position:"absolute"}},b.default.createElement(Zc,{renderPlaceholder:n,decorations:[],isLast:!1,parent:r,text:w})),Zs.set(w,0),Ks.set(w,r)}return o({attributes:h,children:v,element:r})},Gm=b.default.memo(Hm,(t,e)=>t.element===e.element&&t.renderElement===e.renderElement&&t.renderLeaf===e.renderLeaf&&t.renderPlaceholder===e.renderPlaceholder&&Fm(t.decorations,e.decorations)&&(t.selection===e.selection||!!t.selection&&!!e.selection&&u.Range.equals(t.selection,e.selection))),jm=t=>{var{attributes:e,children:r,element:o}=t,n=hr(),a=n.isInline(o)?"span":"div";return b.default.createElement(a,Object.assign({},e,{style:{position:"relative"}}),r)},Kc=(0,b.createContext)(()=>[]),Ym=()=>(0,b.useContext)(Kc),qm=(0,b.createContext)(!1);var Vc=t=>{for(var{decorations:e,node:r,renderElement:o,renderPlaceholder:n,renderLeaf:a,selection:i}=t,l=Ym(),d=hr(),c=I.findPath(d,r),g=[],x=u.Element.isElement(r)&&!d.isInline(r)&&u.Editor.hasInlines(d,r),v=0;v<r.children.length;v++){var h=c.concat(v),p=r.children[v],s=I.findKey(d,p),_=u.Editor.range(d,h),w=i&&u.Range.intersection(_,i),S=l([p,h]);for(var k of e){var C=u.Range.intersection(k,_);C&&S.push(C)}u.Element.isElement(p)?g.push(b.default.createElement(qm.Provider,{key:"provider-".concat(s.id),value:!!w},b.default.createElement(Gm,{decorations:S,element:p,key:s.id,renderElement:o,renderPlaceholder:n,renderLeaf:a,selection:w}))):g.push(b.default.createElement(Zc,{decorations:S,key:s.id,isLast:x&&v===r.children.length-1,parent:r,renderPlaceholder:n,renderLeaf:a,text:p})),Zs.set(p,v),Ks.set(p,r)}return g},Xc=(0,b.createContext)(!1),Zm=()=>(0,b.useContext)(Xc),$c=(0,b.createContext)(null),Km=()=>{var t=(0,b.useContext)($c);if(!t)throw new Error("The `useSlate` hook must be used inside the <Slate> component's context.");var{editor:e}=t;return e};function Vm(){var t=hr(),e=(0,b.useRef)(!1),r=(0,b.useRef)(0),o=(0,b.useCallback)(()=>{if(!e.current){e.current=!0;var n=I.getWindow(t);n.cancelAnimationFrame(r.current),r.current=n.requestAnimationFrame(()=>{e.current=!1})}},[t]);return(0,b.useEffect)(()=>()=>cancelAnimationFrame(r.current),[]),{receivedUserInput:e,onUserInput:o}}var Xm=3,$m={bold:"mod+b",compose:["down","left","right","up","backspace","enter"],moveBackward:"left",moveForward:"right",moveWordBackward:"ctrl+left",moveWordForward:"ctrl+right",deleteBackward:"shift?+backspace",deleteForward:"shift?+delete",extendBackward:"shift+left",extendForward:"shift+right",italic:"mod+i",insertSoftBreak:"shift+enter",splitBlock:"enter",undo:"mod+z"},Jm={moveLineBackward:"opt+up",moveLineForward:"opt+down",moveWordBackward:"opt+left",moveWordForward:"opt+right",deleteBackward:["ctrl+backspace","ctrl+h"],deleteForward:["ctrl+delete","ctrl+d"],deleteLineBackward:"cmd+shift?+backspace",deleteLineForward:["cmd+shift?+delete","ctrl+k"],deleteWordBackward:"opt+shift?+backspace",deleteWordForward:"opt+shift?+delete",extendLineBackward:"opt+shift+up",extendLineForward:"opt+shift+down",redo:"cmd+shift+z",transposeCharacter:"ctrl+t"},Qm={deleteWordBackward:"ctrl+shift?+backspace",deleteWordForward:"ctrl+shift?+delete",redo:["ctrl+y","ctrl+shift+z"]},Te=t=>{var e=$m[t],r=Jm[t],o=Qm[t],n=e&&(0,Mn.isKeyHotkey)(e),a=r&&(0,Mn.isKeyHotkey)(r),i=o&&(0,Mn.isKeyHotkey)(o);return l=>!!(n&&n(l)||wc&&a&&a(l)||!wc&&i&&i(l))},ye={isBold:Te("bold"),isCompose:Te("compose"),isMoveBackward:Te("moveBackward"),isMoveForward:Te("moveForward"),isDeleteBackward:Te("deleteBackward"),isDeleteForward:Te("deleteForward"),isDeleteLineBackward:Te("deleteLineBackward"),isDeleteLineForward:Te("deleteLineForward"),isDeleteWordBackward:Te("deleteWordBackward"),isDeleteWordForward:Te("deleteWordForward"),isExtendBackward:Te("extendBackward"),isExtendForward:Te("extendForward"),isExtendLineBackward:Te("extendLineBackward"),isExtendLineForward:Te("extendLineForward"),isItalic:Te("italic"),isMoveLineBackward:Te("moveLineBackward"),isMoveLineForward:Te("moveLineForward"),isMoveWordBackward:Te("moveWordBackward"),isMoveWordForward:Te("moveWordForward"),isRedo:Te("redo"),isSoftBreak:Te("insertSoftBreak"),isSplitBlock:Te("splitBlock"),isTransposeCharacter:Te("transposeCharacter"),isUndo:Te("undo")},ep=(t,e)=>{var r=[],o=()=>{r=[]},n=i=>{if(!!e.current){var l=i.filter(d=>$s(t,d,i));r.push(...l)}};function a(){r.length>0&&(r.reverse().forEach(i=>{i.type!=="characterData"&&(i.removedNodes.forEach(l=>{i.target.insertBefore(l,i.nextSibling)}),i.addedNodes.forEach(l=>{i.target.removeChild(l)}))}),o())}return{registerMutations:n,restoreDOM:a,clear:o}},tp={subtree:!0,childList:!0,characterData:!0,characterDataOldValue:!0},Wn=class extends b.Component{constructor(){super(...arguments),this.context=null,this.manager=null,this.mutationObserver=null}observe(){var e,{node:r}=this.props;if(!r.current)throw new Error("Failed to attach MutationObserver, `node` is undefined");(e=this.mutationObserver)===null||e===void 0||e.observe(r.current,tp)}componentDidMount(){var{receivedUserInput:e}=this.props,r=this.context;this.manager=ep(r,e),this.mutationObserver=new MutationObserver(this.manager.registerMutations),this.observe()}getSnapshotBeforeUpdate(){var e,r,o,n=(e=this.mutationObserver)===null||e===void 0?void 0:e.takeRecords();if(n!=null&&n.length){var a;(a=this.manager)===null||a===void 0||a.registerMutations(n)}return(r=this.mutationObserver)===null||r===void 0||r.disconnect(),(o=this.manager)===null||o===void 0||o.restoreDOM(),null}componentDidUpdate(){var e;(e=this.manager)===null||e===void 0||e.clear(),this.observe()}componentWillUnmount(){var e;(e=this.mutationObserver)===null||e===void 0||e.disconnect()}render(){return this.props.children}};Wn.contextType=qs;var rp=lt?Wn:t=>{var{children:e}=t;return b.default.createElement(b.default.Fragment,null,e)},op=["autoFocus","decorate","onDOMBeforeInput","placeholder","readOnly","renderElement","renderLeaf","renderPlaceholder","scrollSelectionIntoView","style","as","disableDefaultStyles"],np=["text"];function kc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,o)}return r}function Vr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?kc(Object(r),!0).forEach(function(o){Un(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):kc(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var sp=t=>b.default.createElement(b.default.Fragment,null,Vc(t)),Jc=t=>{var e=(0,b.useCallback)(E=>b.default.createElement(ap,Object.assign({},E)),[]),{autoFocus:r,decorate:o=ip,onDOMBeforeInput:n,placeholder:a,readOnly:i=!1,renderElement:l,renderLeaf:d,renderPlaceholder:c=e,scrollSelectionIntoView:g=lp,style:x={},as:v="div",disableDefaultStyles:h=!1}=t,p=Xr(t,op),s=Km(),[_,w]=(0,b.useState)(!1),S=(0,b.useRef)(null),k=(0,b.useRef)([]),[C,z]=(0,b.useState)(),{onUserInput:U,receivedUserInput:q}=Vm(),[,M]=(0,b.useReducer)(E=>E+1,0);zc.set(s,M),zs.set(s,i);var O=(0,b.useMemo)(()=>({isDraggingInternally:!1,isUpdatingSelection:!1,latestElement:null,hasMarkPlaceholder:!1}),[]);(0,b.useEffect)(()=>{S.current&&r&&S.current.focus()},[r]);var G=(0,b.useRef)(),j=(0,b.useMemo)(()=>(0,Dc.default)(()=>{var E=G.current;if((lt||!I.isComposing(s))&&(!O.isUpdatingSelection||E!=null&&E.isFlushing())&&!O.isDraggingInternally){var Y=I.findDocumentOrShadowRoot(s),{activeElement:F}=Y,H=I.toDOMNode(s,s),oe=Y.getSelection();if(F===H?(O.latestElement=F,br.set(s,!0)):br.delete(s),!oe)return u.Transforms.deselect(s);var{anchorNode:Q,focusNode:de}=oe,ke=I.hasEditableTarget(s,Q)||I.isTargetInsideNonReadonlyVoid(s,Q),Ae=I.hasEditableTarget(s,de)||I.isTargetInsideNonReadonlyVoid(s,de);if(ke&&Ae){var Pe=I.toSlateRange(s,oe,{exactMatch:!1,suppressThrow:!0});Pe&&(!I.isComposing(s)&&!(E!=null&&E.hasPendingChanges())&&!(E!=null&&E.isFlushing())?u.Transforms.select(s,Pe):E?.handleUserSelect(Pe))}i&&(!ke||!Ae)&&u.Transforms.deselect(s)}},100),[s,i,O]),L=(0,b.useMemo)(()=>(0,Bc.default)(j,0),[j]);G.current=Im({node:S,onDOMSelectionChange:j,scheduleOnDOMSelectionChange:L}),Oo(()=>{var E,Y,F;S.current&&(F=Xs(S.current))?(Rc.set(s,F),Rn.set(s,S.current),kr.set(s,S.current),Co.set(S.current,s)):kr.delete(s);var{selection:H}=s,oe=I.findDocumentOrShadowRoot(s),Q=oe.getSelection();if(!(!Q||!I.isFocused(s)||(E=G.current)!==null&&E!==void 0&&E.hasPendingAction())){var de=et=>{var tt=Q.type!=="None";if(!(!H&&!tt)){var We=Rn.get(s),qt=!1;if(We.contains(Q.anchorNode)&&We.contains(Q.focusNode)&&(qt=!0),tt&&qt&&H&&!et){var Zt=I.toSlateRange(s,Q,{exactMatch:!0,suppressThrow:!0});if(Zt&&u.Range.equals(Zt,H)){var Et;if(!O.hasMarkPlaceholder)return;var{anchorNode:or}=Q;if(or!=null&&(Et=or.parentElement)!==null&&Et!==void 0&&Et.hasAttribute("data-slate-mark-placeholder"))return}}if(H&&!I.hasRange(s,H)){s.selection=I.toSlateRange(s,Q,{exactMatch:!1,suppressThrow:!0});return}O.isUpdatingSelection=!0;var ge=H&&I.toDOMRange(s,H);return ge?(u.Range.isBackward(H)?Q.setBaseAndExtent(ge.endContainer,ge.endOffset,ge.startContainer,ge.startOffset):Q.setBaseAndExtent(ge.startContainer,ge.startOffset,ge.endContainer,ge.endOffset),g(s,ge)):Q.removeAllRanges(),ge}},ke=de(),Ae=((Y=G.current)===null||Y===void 0?void 0:Y.isFlushing())==="action";if(!lt||!Ae){setTimeout(()=>{if(ke&&zn){var et=I.toDOMNode(s,s);et.focus()}O.isUpdatingSelection=!1});return}var Pe=null,Qe=requestAnimationFrame(()=>{if(Ae){var et=tt=>{try{var We=I.toDOMNode(s,s);We.focus(),de(tt)}catch{}};et(),Pe=setTimeout(()=>{et(!0),O.isUpdatingSelection=!1})}});return()=>{cancelAnimationFrame(Qe),Pe&&clearTimeout(Pe)}}});var P=(0,b.useCallback)(E=>{if(U(),!i&&I.hasEditableTarget(s,E.target)&&!cp(E,n)){var Y;if(G.current)return G.current.handleDOMBeforeInput(E);L.flush(),j.flush();var{selection:F}=s,{inputType:H}=E,oe=E.dataTransfer||E.data||void 0,Q=H==="insertCompositionText"||H==="deleteCompositionText";if(Q&&I.isComposing(s))return;var de=!1;if(H==="insertText"&&F&&u.Range.isCollapsed(F)&&E.data&&E.data.length===1&&/[a-z ]/i.test(E.data)&&F.anchor.offset!==0){var ke,Ae;de=!0,s.marks&&(de=!1);var{anchor:Pe}=F,[Qe,et]=I.toDOMPoint(s,Pe),tt=(ke=Qe.parentElement)===null||ke===void 0?void 0:ke.closest("a"),We=I.getWindow(s);if(de&&tt&&I.hasDOMNode(s,tt)){var qt,Zt=We?.document.createTreeWalker(tt,NodeFilter.SHOW_TEXT).lastChild();Zt===Qe&&((qt=Zt.textContent)===null||qt===void 0?void 0:qt.length)===et&&(de=!1)}if(de&&Qe.parentElement&&(We==null||(Ae=We.getComputedStyle(Qe.parentElement))===null||Ae===void 0?void 0:Ae.whiteSpace)==="pre"){var Et=u.Editor.above(s,{at:Pe.path,match:Mo=>u.Element.isElement(Mo)&&u.Editor.isBlock(s,Mo)});Et&&u.Node.string(Et[0]).includes("	")&&(de=!1)}}if(!H.startsWith("delete")||H.startsWith("deleteBy")){var[or]=E.getTargetRanges();if(or){var ge=I.toSlateRange(s,or,{exactMatch:!1,suppressThrow:!1});if(!F||!u.Range.equals(F,ge)){de=!1;var Dr=!Q&&s.selection&&u.Editor.rangeRef(s,s.selection);u.Transforms.select(s,ge),Dr&&Io.set(s,Dr)}}}if(Q)return;if(de||E.preventDefault(),F&&u.Range.isExpanded(F)&&H.startsWith("delete")){var Zn=H.endsWith("Backward")?"backward":"forward";u.Editor.deleteFragment(s,{direction:Zn});return}switch(H){case"deleteByComposition":case"deleteByCut":case"deleteByDrag":{u.Editor.deleteFragment(s);break}case"deleteContent":case"deleteContentForward":{u.Editor.deleteForward(s);break}case"deleteContentBackward":{u.Editor.deleteBackward(s);break}case"deleteEntireSoftLine":{u.Editor.deleteBackward(s,{unit:"line"}),u.Editor.deleteForward(s,{unit:"line"});break}case"deleteHardLineBackward":{u.Editor.deleteBackward(s,{unit:"block"});break}case"deleteSoftLineBackward":{u.Editor.deleteBackward(s,{unit:"line"});break}case"deleteHardLineForward":{u.Editor.deleteForward(s,{unit:"block"});break}case"deleteSoftLineForward":{u.Editor.deleteForward(s,{unit:"line"});break}case"deleteWordBackward":{u.Editor.deleteBackward(s,{unit:"word"});break}case"deleteWordForward":{u.Editor.deleteForward(s,{unit:"word"});break}case"insertLineBreak":u.Editor.insertSoftBreak(s);break;case"insertParagraph":{u.Editor.insertBreak(s);break}case"insertFromComposition":case"insertFromDrop":case"insertFromPaste":case"insertFromYank":case"insertReplacementText":case"insertText":{H==="insertFromComposition"&&I.isComposing(s)&&(w(!1),Nr.set(s,!1)),oe?.constructor.name==="DataTransfer"?I.insertData(s,oe):typeof oe=="string"&&(de?k.current.push(()=>u.Editor.insertText(s,oe)):u.Editor.insertText(s,oe));break}}var Lt=(Y=Io.get(s))===null||Y===void 0?void 0:Y.unref();Io.delete(s),Lt&&(!s.selection||!u.Range.equals(s.selection,Lt))&&u.Transforms.select(s,Lt)}},[s,j,U,n,i,L]),W=(0,b.useCallback)(E=>{E==null?(j.cancel(),L.cancel(),Rn.delete(s),kr.delete(s),S.current&&dr&&S.current.removeEventListener("beforeinput",P)):dr&&E.addEventListener("beforeinput",P),S.current=E},[j,L,s,P]);Oo(()=>{var E=I.getWindow(s);return E.document.addEventListener("selectionchange",L),()=>{E.document.removeEventListener("selectionchange",L)}},[L]);var R=o([s,[]]),le=a&&s.children.length===1&&Array.from(u.Node.texts(s)).length===1&&u.Node.string(s)===""&&!_,ee=(0,b.useCallback)(E=>{if(E&&le){var Y;z((Y=E.getBoundingClientRect())===null||Y===void 0?void 0:Y.height)}else z(void 0)},[le]);if(le){var he=u.Editor.start(s,[]);R.push({[$r]:!0,placeholder:a,onPlaceholderResize:ee,anchor:he,focus:he})}var{marks:ue}=s;if(O.hasMarkPlaceholder=!1,s.selection&&u.Range.isCollapsed(s.selection)&&ue){var{anchor:we}=s.selection,Ne=u.Node.leaf(s,we.path),Ee=Xr(Ne,np);if(!u.Text.equals(Ne,ue,{loose:!0})){O.hasMarkPlaceholder=!0;var ze=Object.fromEntries(Object.keys(Ee).map(E=>[E,null]));R.push(Vr(Vr(Vr({[Wc]:!0},ze),ue),{},{anchor:we,focus:we}))}}return(0,b.useEffect)(()=>{setTimeout(()=>{var{selection:E}=s;if(E){var{anchor:Y}=E,F=u.Node.leaf(s,Y.path);if(ue&&!u.Text.equals(F,ue,{loose:!0})){It.set(s,ue);return}}It.delete(s)})}),b.default.createElement(Xc.Provider,{value:i},b.default.createElement(Kc.Provider,{value:o},b.default.createElement(rp,{node:S,receivedUserInput:q},b.default.createElement(v,Object.assign({role:i?void 0:"textbox","aria-multiline":i?void 0:!0},p,{spellCheck:dr||!Pn?p.spellCheck:!1,autoCorrect:dr||!Pn?p.autoCorrect:"false",autoCapitalize:dr||!Pn?p.autoCapitalize:"false","data-slate-editor":!0,"data-slate-node":"value",contentEditable:!i,zindex:-1,suppressContentEditableWarning:!0,ref:W,style:Vr(Vr({},h?{}:Vr({position:"relative",outline:"none",whiteSpace:"pre-wrap",wordWrap:"break-word"},C?{minHeight:C}:{})),x),onBeforeInput:(0,b.useCallback)(E=>{if(!dr&&!i&&!Ye(E,p.onBeforeInput)&&I.hasSelectableTarget(s,E.target)&&(E.preventDefault(),!I.isComposing(s))){var Y=E.data;u.Editor.insertText(s,Y)}},[p.onBeforeInput,s,i]),onInput:(0,b.useCallback)(E=>{if(!Ye(E,p.onInput)){if(G.current){G.current.handleInput();return}for(var Y of k.current)Y();k.current=[]}},[p.onInput]),onBlur:(0,b.useCallback)(E=>{if(!(i||O.isUpdatingSelection||!I.hasSelectableTarget(s,E.target)||Ye(E,p.onBlur))){var Y=I.findDocumentOrShadowRoot(s);if(O.latestElement!==Y.activeElement){var{relatedTarget:F}=E,H=I.toDOMNode(s,s);if(F!==H&&!(wt(F)&&F.hasAttribute("data-slate-spacer"))){if(F!=null&&pr(F)&&I.hasDOMNode(s,F)){var oe=I.toSlateNode(s,F);if(u.Element.isElement(oe)&&!s.isVoid(oe))return}if(ko){var Q=Y.getSelection();Q?.removeAllRanges()}br.delete(s)}}}},[i,O.isUpdatingSelection,O.latestElement,s,p.onBlur]),onClick:(0,b.useCallback)(E=>{if(I.hasTarget(s,E.target)&&!Ye(E,p.onClick)&&pr(E.target)){var Y=I.toSlateNode(s,E.target),F=I.findPath(s,Y);if(!u.Editor.hasPath(s,F)||u.Node.get(s,F)!==Y)return;if(E.detail===Xm&&F.length>=1){var H=F;if(!(u.Element.isElement(Y)&&u.Editor.isBlock(s,Y))){var oe,Q=u.Editor.above(s,{match:tt=>u.Element.isElement(tt)&&u.Editor.isBlock(s,tt),at:F});H=(oe=Q?.[1])!==null&&oe!==void 0?oe:F.slice(0,1)}var de=u.Editor.range(s,H);u.Transforms.select(s,de);return}if(i)return;var ke=u.Editor.start(s,F),Ae=u.Editor.end(s,F),Pe=u.Editor.void(s,{at:ke}),Qe=u.Editor.void(s,{at:Ae});if(Pe&&Qe&&u.Path.equals(Pe[1],Qe[1])){var et=u.Editor.range(s,ke);u.Transforms.select(s,et)}}},[s,p.onClick,i]),onCompositionEnd:(0,b.useCallback)(E=>{if(I.hasSelectableTarget(s,E.target)){var Y;if(I.isComposing(s)&&(w(!1),Nr.set(s,!1)),(Y=G.current)===null||Y===void 0||Y.handleCompositionEnd(E),Ye(E,p.onCompositionEnd)||lt)return;if(!ko&&!tm&&!$f&&!om&&!rm&&E.data){var F=It.get(s);It.delete(s),F!==void 0&&(er.set(s,s.marks),s.marks=F),u.Editor.insertText(s,E.data);var H=er.get(s);er.delete(s),H!==void 0&&(s.marks=H)}}},[p.onCompositionEnd,s]),onCompositionUpdate:(0,b.useCallback)(E=>{I.hasSelectableTarget(s,E.target)&&!Ye(E,p.onCompositionUpdate)&&(I.isComposing(s)||(w(!0),Nr.set(s,!0)))},[p.onCompositionUpdate,s]),onCompositionStart:(0,b.useCallback)(E=>{if(I.hasSelectableTarget(s,E.target)){var Y;if((Y=G.current)===null||Y===void 0||Y.handleCompositionStart(E),Ye(E,p.onCompositionStart)||lt)return;w(!0);var{selection:F}=s;if(F){if(u.Range.isExpanded(F)){u.Editor.deleteFragment(s);return}var H=u.Editor.above(s,{match:de=>u.Element.isElement(de)&&u.Editor.isInline(s,de),mode:"highest"});if(H){var[,oe]=H;if(u.Editor.isEnd(s,F.anchor,oe)){var Q=u.Editor.after(s,oe);u.Transforms.setSelection(s,{anchor:Q,focus:Q})}}}}},[p.onCompositionStart,s]),onCopy:(0,b.useCallback)(E=>{I.hasSelectableTarget(s,E.target)&&!Ye(E,p.onCopy)&&!Ic(E)&&(E.preventDefault(),I.setFragmentData(s,E.clipboardData,"copy"))},[p.onCopy,s]),onCut:(0,b.useCallback)(E=>{if(!i&&I.hasSelectableTarget(s,E.target)&&!Ye(E,p.onCut)&&!Ic(E)){E.preventDefault(),I.setFragmentData(s,E.clipboardData,"cut");var{selection:Y}=s;if(Y)if(u.Range.isExpanded(Y))u.Editor.deleteFragment(s);else{var F=u.Node.parent(s,Y.anchor.path);u.Editor.isVoid(s,F)&&u.Transforms.delete(s)}}},[i,s,p.onCut]),onDragOver:(0,b.useCallback)(E=>{if(I.hasTarget(s,E.target)&&!Ye(E,p.onDragOver)){var Y=I.toSlateNode(s,E.target);u.Element.isElement(Y)&&u.Editor.isVoid(s,Y)&&E.preventDefault()}},[p.onDragOver,s]),onDragStart:(0,b.useCallback)(E=>{if(!i&&I.hasTarget(s,E.target)&&!Ye(E,p.onDragStart)){var Y=I.toSlateNode(s,E.target),F=I.findPath(s,Y),H=u.Element.isElement(Y)&&u.Editor.isVoid(s,Y)||u.Editor.void(s,{at:F,voids:!0});if(H){var oe=u.Editor.range(s,F);u.Transforms.select(s,oe)}O.isDraggingInternally=!0,I.setFragmentData(s,E.dataTransfer,"drag")}},[i,s,p.onDragStart,O]),onDrop:(0,b.useCallback)(E=>{if(!i&&I.hasTarget(s,E.target)&&!Ye(E,p.onDrop)){E.preventDefault();var Y=s.selection,F=I.findEventRange(s,E),H=E.dataTransfer;u.Transforms.select(s,F),O.isDraggingInternally&&Y&&!u.Range.equals(Y,F)&&!u.Editor.void(s,{at:F,voids:!0})&&u.Transforms.delete(s,{at:Y}),I.insertData(s,H),I.isFocused(s)||I.focus(s)}O.isDraggingInternally=!1},[i,s,p.onDrop,O]),onDragEnd:(0,b.useCallback)(E=>{!i&&O.isDraggingInternally&&p.onDragEnd&&I.hasTarget(s,E.target)&&p.onDragEnd(E),O.isDraggingInternally=!1},[i,O,p,s]),onFocus:(0,b.useCallback)(E=>{if(!i&&!O.isUpdatingSelection&&I.hasEditableTarget(s,E.target)&&!Ye(E,p.onFocus)){var Y=I.toDOMNode(s,s),F=I.findDocumentOrShadowRoot(s);if(O.latestElement=F.activeElement,zn&&E.target!==Y){Y.focus();return}br.set(s,!0)}},[i,O,s,p.onFocus]),onKeyDown:(0,b.useCallback)(E=>{if(!i&&I.hasEditableTarget(s,E.target)){var Y;(Y=G.current)===null||Y===void 0||Y.handleKeyDown(E);var{nativeEvent:F}=E;if(I.isComposing(s)&&F.isComposing===!1&&(Nr.set(s,!1),w(!1)),Ye(E,p.onKeyDown)||I.isComposing(s))return;var{selection:H}=s,oe=s.children[H!==null?H.focus.path[0]:0],Q=(0,Ys.default)(u.Node.string(oe))==="rtl";if(ye.isRedo(F)){E.preventDefault();var de=s;typeof de.redo=="function"&&de.redo();return}if(ye.isUndo(F)){E.preventDefault();var ke=s;typeof ke.undo=="function"&&ke.undo();return}if(ye.isMoveLineBackward(F)){E.preventDefault(),u.Transforms.move(s,{unit:"line",reverse:!0});return}if(ye.isMoveLineForward(F)){E.preventDefault(),u.Transforms.move(s,{unit:"line"});return}if(ye.isExtendLineBackward(F)){E.preventDefault(),u.Transforms.move(s,{unit:"line",edge:"focus",reverse:!0});return}if(ye.isExtendLineForward(F)){E.preventDefault(),u.Transforms.move(s,{unit:"line",edge:"focus"});return}if(ye.isMoveBackward(F)){E.preventDefault(),H&&u.Range.isCollapsed(H)?u.Transforms.move(s,{reverse:!Q}):u.Transforms.collapse(s,{edge:"start"});return}if(ye.isMoveForward(F)){E.preventDefault(),H&&u.Range.isCollapsed(H)?u.Transforms.move(s,{reverse:Q}):u.Transforms.collapse(s,{edge:"end"});return}if(ye.isMoveWordBackward(F)){E.preventDefault(),H&&u.Range.isExpanded(H)&&u.Transforms.collapse(s,{edge:"focus"}),u.Transforms.move(s,{unit:"word",reverse:!Q});return}if(ye.isMoveWordForward(F)){E.preventDefault(),H&&u.Range.isExpanded(H)&&u.Transforms.collapse(s,{edge:"focus"}),u.Transforms.move(s,{unit:"word",reverse:Q});return}if(dr){if((Pc||ko)&&H&&(ye.isDeleteBackward(F)||ye.isDeleteForward(F))&&u.Range.isCollapsed(H)){var Ae=u.Node.parent(s,H.anchor.path);if(u.Element.isElement(Ae)&&u.Editor.isVoid(s,Ae)&&(u.Editor.isInline(s,Ae)||u.Editor.isBlock(s,Ae))){E.preventDefault(),u.Editor.deleteBackward(s,{unit:"block"});return}}}else{if(ye.isBold(F)||ye.isItalic(F)||ye.isTransposeCharacter(F)){E.preventDefault();return}if(ye.isSoftBreak(F)){E.preventDefault(),u.Editor.insertSoftBreak(s);return}if(ye.isSplitBlock(F)){E.preventDefault(),u.Editor.insertBreak(s);return}if(ye.isDeleteBackward(F)){E.preventDefault(),H&&u.Range.isExpanded(H)?u.Editor.deleteFragment(s,{direction:"backward"}):u.Editor.deleteBackward(s);return}if(ye.isDeleteForward(F)){E.preventDefault(),H&&u.Range.isExpanded(H)?u.Editor.deleteFragment(s,{direction:"forward"}):u.Editor.deleteForward(s);return}if(ye.isDeleteLineBackward(F)){E.preventDefault(),H&&u.Range.isExpanded(H)?u.Editor.deleteFragment(s,{direction:"backward"}):u.Editor.deleteBackward(s,{unit:"line"});return}if(ye.isDeleteLineForward(F)){E.preventDefault(),H&&u.Range.isExpanded(H)?u.Editor.deleteFragment(s,{direction:"forward"}):u.Editor.deleteForward(s,{unit:"line"});return}if(ye.isDeleteWordBackward(F)){E.preventDefault(),H&&u.Range.isExpanded(H)?u.Editor.deleteFragment(s,{direction:"backward"}):u.Editor.deleteBackward(s,{unit:"word"});return}if(ye.isDeleteWordForward(F)){E.preventDefault(),H&&u.Range.isExpanded(H)?u.Editor.deleteFragment(s,{direction:"forward"}):u.Editor.deleteForward(s,{unit:"word"});return}}}},[i,s,p.onKeyDown]),onPaste:(0,b.useCallback)(E=>{!i&&I.hasEditableTarget(s,E.target)&&!Ye(E,p.onPaste)&&(!dr||am(E.nativeEvent)||ko)&&(E.preventDefault(),I.insertData(s,E.clipboardData))},[i,s,p.onPaste])}),b.default.createElement(sp,{decorations:R,node:s,renderElement:l,renderPlaceholder:c,renderLeaf:d,selection:s.selection})))))},ap=t=>{var{attributes:e,children:r}=t;return b.default.createElement("span",Object.assign({},e),r,lt&&b.default.createElement("br",null))},ip=()=>[],lp=(t,e)=>{if(e.getBoundingClientRect&&(!t.selection||t.selection&&u.Range.isCollapsed(t.selection))){var r=e.startContainer.parentElement;r.getBoundingClientRect=e.getBoundingClientRect.bind(e),$l(r,{scrollMode:"if-needed"}),delete r.getBoundingClientRect}},Ye=(t,e)=>{if(!e)return!1;var r=e(t);return r??(t.isDefaultPrevented()||t.isPropagationStopped())},Ic=t=>pr(t.target)&&(t.target instanceof HTMLInputElement||t.target instanceof HTMLTextAreaElement),cp=(t,e)=>{if(!e)return!1;var r=e(t);return r??t.defaultPrevented},up=(0,b.createContext)(!1);var dp=(0,b.createContext)({});function fp(t){var e=(0,b.useRef)([]).current,r=(0,b.useRef)({editor:t}).current,o=(0,b.useCallback)(a=>{r.editor=a,e.forEach(i=>i(a))},[e,r]),n=(0,b.useMemo)(()=>({getSlate:()=>r.editor,addEventListener:a=>(e.push(a),()=>{e.splice(e.indexOf(a),1)})}),[e,r]);return{selectorContext:n,onChange:o}}var mp=["editor","children","onChange","value"],Qc=t=>{var{editor:e,children:r,onChange:o,value:n}=t,a=Xr(t,mp),i=(0,b.useRef)(!1),[l,d]=b.default.useState(()=>{if(!u.Node.isNodeList(n))throw new Error("[Slate] value is invalid! Expected a list of elements but got: ".concat(u.Scrubber.stringify(n)));if(!u.Editor.isEditor(e))throw new Error("[Slate] editor is invalid! You passed: ".concat(u.Scrubber.stringify(e)));return e.children=n,Object.assign(e,a),{v:0,editor:e}}),{selectorContext:c,onChange:g}=fp(e),x=(0,b.useCallback)(()=>{o&&o(e.children),d(p=>({v:p.v+1,editor:e})),g(e)},[e,g,o]);(0,b.useEffect)(()=>(Ws.set(e,x),()=>{Ws.set(e,()=>{}),i.current=!0}),[e,x]);var[v,h]=(0,b.useState)(I.isFocused(e));return(0,b.useEffect)(()=>{h(I.isFocused(e))},[e]),Oo(()=>{var p=()=>h(I.isFocused(e));return Xf?(document.addEventListener("focusin",p),document.addEventListener("focusout",p),()=>{document.removeEventListener("focusin",p),document.removeEventListener("focusout",p)}):(document.addEventListener("focus",p,!0),document.addEventListener("blur",p,!0),()=>{document.removeEventListener("focus",p,!0),document.removeEventListener("blur",p,!0)})},[]),b.default.createElement(dp.Provider,{value:c},b.default.createElement($c.Provider,{value:l},b.default.createElement(qs.Provider,{value:l.editor},b.default.createElement(up.Provider,{value:v},r))))};var Cc=(t,e)=>{var r=(e.top+e.bottom)/2;return t.top<=r&&t.bottom>=r},Oc=(t,e,r)=>{var o=I.toDOMRange(t,e).getBoundingClientRect(),n=I.toDOMRange(t,r).getBoundingClientRect();return Cc(o,n)&&Cc(n,o)},pp=(t,e)=>{var r=u.Editor.range(t,u.Range.end(e)),o=Array.from(u.Editor.positions(t,{at:e})),n=0,a=o.length,i=Math.floor(a/2);if(Oc(t,u.Editor.range(t,o[n]),r))return u.Editor.range(t,o[n],r);if(o.length<2)return u.Editor.range(t,o[o.length-1],r);for(;i!==o.length&&i!==n;)Oc(t,u.Editor.range(t,o[i]),r)?a=i:n=i,i=Math.floor((n+a)/2);return u.Editor.range(t,o[a],r)};function Lc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,o)}return r}function Fc(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Lc(Object(r),!0).forEach(function(o){Un(t,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Lc(Object(r)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(r,o))})}return t}var eu=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"x-slate-fragment",o=e,{apply:n,onChange:a,deleteBackward:i,addMark:l,removeMark:d}=o;return Hn.set(o,new WeakMap),o.addMark=(c,g)=>{var x,v;(x=Vs.get(o))===null||x===void 0||x(),!It.get(o)&&(v=$e.get(o))!==null&&v!==void 0&&v.length&&It.set(o,null),er.delete(o),l(c,g)},o.removeMark=c=>{var g;!It.get(o)&&(g=$e.get(o))!==null&&g!==void 0&&g.length&&It.set(o,null),er.delete(o),d(c)},o.deleteBackward=c=>{if(c!=="line")return i(c);if(o.selection&&u.Range.isCollapsed(o.selection)){var g=u.Editor.above(o,{match:p=>u.Element.isElement(p)&&u.Editor.isBlock(o,p),at:o.selection});if(g){var[,x]=g,v=u.Editor.range(o,x,o.selection.anchor),h=pp(o,v);u.Range.isCollapsed(h)||u.Transforms.delete(o,{at:h})}}},o.apply=c=>{var g=[],x=$e.get(o);if(x!=null&&x.length){var v=x.map(U=>_m(U,c)).filter(Boolean);$e.set(o,v)}var h=mr.get(o);h&&mr.set(o,Ec(o,h,c));var p=fr.get(o);if(p!=null&&p.at){var s=u.Point.isPoint(p?.at)?js(o,p.at,c):Ec(o,p.at,c);fr.set(o,s?Fc(Fc({},p),{},{at:s}):null)}switch(c.type){case"insert_text":case"remove_text":case"set_node":case"split_node":{g.push(...Dn(o,c.path));break}case"set_selection":{var _;(_=Io.get(o))===null||_===void 0||_.unref(),Io.delete(o);break}case"insert_node":case"remove_node":{g.push(...Dn(o,u.Path.parent(c.path)));break}case"merge_node":{var w=u.Path.previous(c.path);g.push(...Dn(o,w));break}case"move_node":{var S=u.Path.common(u.Path.parent(c.path),u.Path.parent(c.newPath));g.push(...Dn(o,S));break}}n(c);for(var[k,C]of g){var[z]=u.Editor.node(o,k);Rs.set(z,C)}},o.setFragmentData=c=>{var{selection:g}=o;if(!!g){var[x,v]=u.Range.edges(g),h=u.Editor.void(o,{at:x.path}),p=u.Editor.void(o,{at:v.path});if(!(u.Range.isCollapsed(g)&&!h)){var s=I.toDOMRange(o,g),_=s.cloneContents(),w=_.childNodes[0];if(_.childNodes.forEach(G=>{G.textContent&&G.textContent.trim()!==""&&(w=G)}),p){var[S]=p,k=s.cloneRange(),C=I.toDOMNode(o,S);k.setEndAfter(C),_=k.cloneContents()}if(h&&(w=_.querySelector("[data-slate-spacer]")),Array.from(_.querySelectorAll("[data-slate-zero-width]")).forEach(G=>{var j=G.getAttribute("data-slate-zero-width")==="n";G.textContent=j?`
`:""}),Uc(w)){var z=w.ownerDocument.createElement("span");z.style.whiteSpace="pre",z.appendChild(w),_.appendChild(z),w=z}var U=o.getFragment(),q=JSON.stringify(U),M=window.btoa(encodeURIComponent(q));w.setAttribute("data-slate-fragment",M),c.setData("application/".concat(r),M);var O=_.ownerDocument.createElement("div");return O.appendChild(_),O.setAttribute("hidden","true"),_.ownerDocument.body.appendChild(O),c.setData("text/html",O.innerHTML),c.setData("text/plain",Gc(O)),_.ownerDocument.body.removeChild(O),c}}},o.insertData=c=>{o.insertFragmentData(c)||o.insertTextData(c)},o.insertFragmentData=c=>{var g=c.getData("application/".concat(r))||dm(c);if(g){var x=decodeURIComponent(window.atob(g)),v=JSON.parse(x);return o.insertFragment(v),!0}return!1},o.insertTextData=c=>{var g=c.getData("text/plain");if(g){var x=g.split(/\r\n|\r|\n/),v=!1;for(var h of x)v&&u.Transforms.splitNodes(o,{always:!0}),o.insertText(h),v=!0;return!0}return!1},o.onChange=c=>{Mc.default.unstable_batchedUpdates(()=>{var g=Ws.get(o);g&&g(),a(c)})},o},Dn=(t,e)=>{var r=[];for(var[o,n]of u.Editor.levels(t,{at:e})){var a=I.findKey(t,o);r.push([n,a])}return r};var Ht=N(yo());f();m();f();m();function tu(t){return Object.prototype.toString.call(t)==="[object Object]"}function ru(t){var e,r;return tu(t)===!1?!1:(e=t.constructor,e===void 0?!0:(r=e.prototype,!(tu(r)===!1||r.hasOwnProperty("isPrototypeOf")===!1)))}var Je=N(yo()),hp={isHistory(t){return ru(t)&&Array.isArray(t.redos)&&Array.isArray(t.undos)&&(t.redos.length===0||Je.Operation.isOperationList(t.redos[0].operations))&&(t.undos.length===0||Je.Operation.isOperationList(t.undos[0].operations))}};var Js=new WeakMap,Qs=new WeakMap,Jr={isHistoryEditor(t){return hp.isHistory(t.history)&&Je.Editor.isEditor(t)},isMerging(t){return Qs.get(t)},isSaving(t){return Js.get(t)},redo(t){t.redo()},undo(t){t.undo()},withoutMerging(t,e){var r=Jr.isMerging(t);Qs.set(t,!1),e(),Qs.set(t,r)},withoutSaving(t,e){var r=Jr.isSaving(t);Js.set(t,!1),e(),Js.set(t,r)}},ou=t=>{var e=t,{apply:r}=e;return e.history={undos:[],redos:[]},e.redo=()=>{var{history:o}=e,{redos:n}=o;if(n.length>0){var a=n[n.length-1];a.selectionBefore&&Je.Transforms.setSelection(e,a.selectionBefore),Jr.withoutSaving(e,()=>{Je.Editor.withoutNormalizing(e,()=>{for(var i of a.operations)e.apply(i)})}),o.redos.pop(),e.writeHistory("undos",a)}},e.undo=()=>{var{history:o}=e,{undos:n}=o;if(n.length>0){var a=n[n.length-1];Jr.withoutSaving(e,()=>{Je.Editor.withoutNormalizing(e,()=>{var i=a.operations.map(Je.Operation.inverse).reverse();for(var l of i)e.apply(l);a.selectionBefore&&Je.Transforms.setSelection(e,a.selectionBefore)})}),e.writeHistory("redos",a),o.undos.pop()}},e.apply=o=>{var{operations:n,history:a}=e,{undos:i}=a,l=i[i.length-1],d=l&&l.operations[l.operations.length-1],c=Jr.isSaving(e),g=Jr.isMerging(e);if(c==null&&(c=gp(o)),c){if(g==null&&(l==null?g=!1:n.length!==0?g=!0:g=vp(o,d)),l&&g)l.operations.push(o);else{var x={operations:[o],selectionBefore:e.selection};e.writeHistory("undos",x)}for(;i.length>100;)i.shift();a.redos=[]}r(o)},e.writeHistory=(o,n)=>{e.history[o].push(n)},e},vp=(t,e)=>!!(e&&t.type==="insert_text"&&e.type==="insert_text"&&t.offset===e.offset+e.text.length&&Je.Path.equals(t.path,e.path)||e&&t.type==="remove_text"&&e.type==="remove_text"&&t.offset+t.text.length===e.offset&&Je.Path.equals(t.path,e.path)),gp=(t,e)=>t.type!=="set_selection";f();m();var be={"batch-send-address":"_batch-send-address_1gj1i_1",batchSendAddress:"_batch-send-address_1gj1i_1","batch-send-address-dialog-core":"_batch-send-address-dialog-core_1gj1i_30",batchSendAddressDialogCore:"_batch-send-address-dialog-core_1gj1i_30","batch-send-address-input":"_batch-send-address-input_1gj1i_35",batchSendAddressInput:"_batch-send-address-input_1gj1i_35","batch-send-address-accordion":"_batch-send-address-accordion_1gj1i_48",batchSendAddressAccordion:"_batch-send-address-accordion_1gj1i_48","batch-send-address-accordion-header":"_batch-send-address-accordion-header_1gj1i_51",batchSendAddressAccordionHeader:"_batch-send-address-accordion-header_1gj1i_51","batch-send-address-accordion-content":"_batch-send-address-accordion-content_1gj1i_55",batchSendAddressAccordionContent:"_batch-send-address-accordion-content_1gj1i_55","batch-send-address-accordion-checkbox":"_batch-send-address-accordion-checkbox_1gj1i_59",batchSendAddressAccordionCheckbox:"_batch-send-address-accordion-checkbox_1gj1i_59","batch-send-address-select-address-actions":"_batch-send-address-select-address-actions_1gj1i_64",batchSendAddressSelectAddressActions:"_batch-send-address-select-address-actions_1gj1i_64",upload:"_upload_1gj1i_74",uploadIcon:"_uploadIcon_1gj1i_89",uploadText:"_uploadText_1gj1i_92",addressPre:"_addressPre_1gj1i_95",selectAddress:"_selectAddress_1gj1i_99",selectedAddressInfo:"_selectedAddressInfo_1gj1i_104",addBtn:"_addBtn_1gj1i_112","circle-icon":"_circle-icon_1gj1i_116",circleIcon:"_circle-icon_1gj1i_116"};f();m();var Qr=N(K()),cu=N(Be());ne();f();m();var Gn=N(K());ne();f();m();var nu=N(si()),_p=(t,e={})=>new Promise((r,o)=>{nu.default.parse(t,{complete:n=>{r(n)},error:n=>{o(n)},...e})}),xp=(t,e={})=>_p(t,e).then(r=>(r?.data??[]).flat().filter(Boolean)),su=xp;f();m();var au=N(K());function Sp(t,{onDrop:e,onDragLeave:r,onDragEnter:o,onDragOver:n}){(0,au.useEffect)(()=>(t&&(t.addEventListener("drop",e),t.addEventListener("dragleave",r),t.addEventListener("dragenter",o),t.addEventListener("dragover",n)),()=>{t&&(t.removeEventListener("drop",e),t.removeEventListener("dragleave",r),t.removeEventListener("dragenter",o),t.removeEventListener("dragover",n))}),[e,r,o,n,t])}var ea=Sp;function wp(t){let e=t.scrollHeight;t.scrollTo(0,e)}var Tp=1024,Ep=1024*Tp,iu=1,yp=Ep*iu;function Ap(t,{onChange:e,slateRef:r,onError:o}={}){let[n,a]=(0,Gn.useState)(!1),i=x=>{r?.current&&(r.current.style.pointerEvents=x?"none":"auto")},l=B(x=>{x.preventDefault()});ea(document,{onDrop:l,onDragEnter:l,onDragLeave:l,onDragOver:l});let d=B(x=>{i(!1),a(!1);let v=x.dataTransfer?.files?.[0];if(!!v){if(v.type!=="text/csv"){o?.(y("wallet_extension_reminder_text_wrong_format"));return}if(v.size>yp){o?.(y("wallet_extension_reminder_text_large_doc",{num:iu}));return}su(v).then(h=>{e?.(h)}).catch(()=>{e?.([])})}});(0,Gn.useEffect)(()=>{n&&t.current&&wp(t.current)},[n,t]);let c=B(()=>{i(!0),a(!0)}),g=B(()=>{i(!1),a(!1)});return ea(t.current,{onDrop:d,onDragEnter:c,onDragLeave:g}),{show:n}}var lu=Ap;function bp(t){let{onChange:e,dropRef:r,slateRef:o,onError:n}=t,a=(0,Qr.useRef)(null),{show:i}=lu(r,{onChange:e,slateRef:o,onError:n});return i?Qr.default.createElement(T.Box,{ref:a,className:be.upload},Qr.default.createElement(ot,{className:(0,cu.default)("okds-plus-circle",be.uploadIcon)}),Qr.default.createElement(T.Box,{className:be.uploadText},y("wallet_extension_reminder_dropzone_input_address"))):void 0}var uu=bp;f();m();var Tt=N(K());var du=N(rt());ne();var Np=({type:t,title:e,children:r,dropError:o,actionTitle:n,addressErrors:a,onSelectWalletAddress:i})=>{let l=(0,Tt.useMemo)(()=>{if(o)return o;if(!a?.length)return null;let d=(0,du.uniqBy)(a,"error");return d?.length>1?y("wallet_extension_sending_text_address_error"):y(d[0]?.error,d[0]?.args)},[o,a]);return Tt.default.createElement(T.Space,{direction:T.DIRECTION.vertical,space:"12px"},Tt.default.createElement(T.FlexBox,{justify:"space-between",align:T.ALIGN.center},Tt.default.createElement(ae.Text,{strong:700,size:ae.SIZE.lg,style:{lineHeight:"24px"}},e,Tt.default.createElement(Ce,{className:be.circleIcon,icon:"okds-question-mark-circle",size:Ce.SIZE.xs,tooltip:{maxWidth:"300px",placement:_r?.DIRECTION.topRight,title:Tt.default.createElement("pre",{className:be.addressPre},y("wallet_extension_sending_tooltip_address_condition"))}})),Tt.default.createElement(T.Space,{direction:T.DIRECTION.horizontal,space:"6px",align:T.ALIGN.center,style:{cursor:"pointer"},onClick:()=>{i(t)}},Tt.default.createElement(Ce,{icon:"okx-wallet-plugin-tier-guide",size:Ce.SIZE.md}),Tt.default.createElement(ae.Text,{strong:!0,size:ae.SIZE.sm,style:{lineHeight:"16px"}},n))),r,l&&Tt.default.createElement(ae.Text,{size:ae.SIZE.xs,type:ae.TYPE.danger},l))},jn=Np;f();m();var fu=N(rt()),Ir=N(yo()),kp=[{type:"numbered-list",children:[{type:"list-item",children:[{text:""}]}]}],mu=(t=[])=>!t||!t?.length?kp:[{type:"numbered-list",children:t.map(e=>({type:"list-item",children:[{text:e}]}))}],pu=t=>{let[{children:e}]=t;return e.map(({children:r})=>(0,fu.trim)(r?.[0]?.text))},hu=(t=[],e=[])=>!e.some(r=>!t.includes(r)),vu=t=>{let{normalizeNode:e}=t;return t.normalizeNode=r=>{let[o,n]=r;if(Ir.Element.isElement(o)&&o.type==="numbered-list"){for(let[a,i]of Ir.Node.children(t,n))if(Ir.Element.isElement(a)&&a.type==="numbered-list"){Ir.Transforms.unwrapNodes(t,{at:i});return}}e(r)},t};var Ip="Enter",Cp=({attributes:t,children:e,element:r})=>{let{error:o}=r;switch(r.type){case"list-item":return pe.default.createElement("li",{style:{color:o&&"red"},...t},e);case"numbered-list":return pe.default.createElement("ol",{...t},e);default:return pe.default.createElement("p",{...t},e)}},Op=({attributes:t,children:e,leaf:r})=>{let{error:o}=r;return pe.default.createElement("span",{style:{color:o?"red":void 0},...t},e)},Lp=(0,pe.forwardRef)(({type:t,title:e,dropError:r,actionTitle:o,placeholder:n,value:a=[],onChange:i,addressErrors:l,onSelectWalletAddress:d,onDrop:c,onDropError:g},x)=>{let v=(0,pe.useRef)(0),h=(0,pe.useCallback)(C=>pe.default.createElement(Cp,{...C}),[]),p=(0,pe.useCallback)(C=>pe.default.createElement(Op,{...C}),[]),s=(0,pe.useMemo)(()=>vu(ou(eu((0,Ht.createEditor)()))),[]),_=(0,pe.useRef)(null),w=(0,pe.useRef)(null);(0,pe.useEffect)(()=>{s?.selection?.focus&&(v.current=s?.selection?.focus?.path?.[1])},[s.selection]),(0,pe.useEffect)(()=>{a.forEach((C,z)=>{Ht.Transforms.setNodes(s,{error:!1},{at:[0,z,0]})}),l?.forEach(({at:C})=>{Ht.Transforms.setNodes(s,{error:!0},{at:[0,C,0]})})},[l]);let S=B(C=>{let{path:z}=s.selection?.focus??{path:null},U=l?.find(M=>M.at===z?.[1])?.address,q=C?.[0]?.children?.[z?.[1]]?.children?.[0]?.text;(U&&q!==U||!q)&&Ht.Transforms.setNodes(s,{error:!1},{at:[0,z?.[1],0]}),i?.(C,t)},[l]),k=B(async C=>{let{path:z,offset:U}=s.selection?.focus||{};if(!z||!U)return!1;let q=z?.[1];if(C.key===Ip){a?.[q]?.length>U&&Ht.Transforms.setNodes(s,{error:!1},{at:[0,q,0]}),await Ya(10);let M=z[1]+1;Ht.Transforms.setNodes(s,{error:!1},{at:[0,M,0]})}return!0},[a,l]);return(0,pe.useImperativeHandle)(x,()=>({insertNodes:(C=[])=>{let z=C.map(q=>({type:"list-item",children:[{text:q}]}));Ht.Transforms.insertNodes(s,z);let U=v.current;a?.[U]||Ht.Transforms.removeNodes(s,{at:[0,U]})}})),pe.default.createElement(jn,{type:t,title:e,dropError:r,actionTitle:o,addressErrors:l,onSelectWalletAddress:d},pe.default.createElement(T.Box,{className:be["batch-send-address-input"],ref:_},pe.default.createElement(T.Box,{ref:w},pe.default.createElement(Qc,{editor:s,value:mu(a),onChange:S},pe.default.createElement(Jc,{autoFocus:!0,spellCheck:!0,renderLeaf:p,renderElement:h,placeholder:n,onKeyDown:k}))),pe.default.createElement(uu,{dropRef:_,onChange:c,slateRef:w,onError:g})))}),ta=Lp;f();m();var ce=N(K());ne();f();m();var Fe={SEND:"SEND",RECEIVE:"RECEIVE"};var gu=t=>Array.isArray(t)?t.map(({name:e,address:r,options:o})=>r&&!o?{value:r,style:{display:"flex",alignItems:"center"},label:ce.default.createElement(T.Space,{direction:T.DIRECTION.vertical,space:"2px"},e&&ce.default.createElement(ae.Text,{size:ae.SIZE.xs},e),r&&ce.default.createElement(ae.Text,{size:ae.SIZE.xs,type:ae.TYPE.secondary},r))}:{value:e,label:ce.default.createElement(ae.Text,{size:ae.SIZE.md},e),options:gu(o)}):[],Fp=t=>{let[e,r]=(0,ce.useState)([]),[o,n]=(0,ce.useState)(!1),a=(0,ce.useMemo)(()=>gu(t.options),[t.options]),i=(0,ce.useMemo)(()=>a?.map(h=>h.options?.map(({value:p})=>p))?.flat(),[a]),{mode:l,type:d}=t,c=(0,ce.useMemo)(()=>l===X.ONE_TO_MANY&&d===Fe.SEND||l===X.MANY_TO_ONE&&d===Fe.RECEIVE,[l,d]),g=B((h,p,s)=>{if(c){r([p]);return}let _=[...e];h&&p?_=[...e,p]:!h&&p?_=_.filter(w=>w!==p):h&&s&&s.length?_=[...e,...s]:!h&&s&&s.length&&(_=_.filter(w=>!s.includes(w))),r([...new Set(_)])},[c,e]),x=(0,ce.useCallback)(()=>{t?.onChange(e,t?.type)},[e,t]),v=h=>{let p=h.target.checked;r(p?i:[])};return(0,ce.useEffect)(()=>{n(e.length===i.length)},[e,i]),ce.default.createElement(T.Box,{className:be.selectAddress},ce.default.createElement(T.Box,{className:be["batch-send-address-dialog-core"]},a.map(({label:h,options:p})=>Array.isArray(p)&&p?.length?ce.default.createElement(da,{defaultExpanded:!0,className:be["batch-send-address-accordion"],headerClassName:be["batch-send-address-accordion-header"],contentClassName:be["batch-send-address-accordion-content"],title:c?h:ce.default.createElement(sr,{clickStopPropagation:!0,checked:hu(e,p.map(({value:s})=>s)),onChange:({target:{checked:s}})=>{g(s,void 0,p.map(({value:_})=>_))}},h)},p.map(({value:s,label:_})=>c?ce.default.createElement(fa,{checked:e?.includes(s),className:be["batch-send-address-accordion-checkbox"],onChange:({target:{checked:w}})=>{g(w,s)}},_):ce.default.createElement(sr,{checked:e?.includes(s),className:be["batch-send-address-accordion-checkbox"],onChange:({target:{checked:w}})=>{g(w,s)}},_))):ce.default.createElement(ce.default.Fragment,null))),ce.default.createElement(T.Box,{className:be["batch-send-address-select-address-actions"]},!c&&ce.default.createElement(T.Box,{className:be.selectedAddressInfo},ce.default.createElement(sr,{checked:o,onChange:v},y("wallet_extension_addressbook_text_select_all")),ce.default.createElement(ae.Text,{type:ae.TYPE.secondary,size:ae.SIZE.sm},y("wallet_extension_addressbook_text_selected_address",{wallet_extension_addressbook_text_selected_address:e?.length??0}))),ce.default.createElement(T.Box,{className:be.addBtn},ce.default.createElement(Z,{category:Z.CATEGORY.fill,type:Z.TYPE.highlight,size:Z.SIZE.lg,onClick:x,disabled:e.length<=0,block:!0},y("wallet_extension_addressbook_btn_add")))))},_u=Fp;f();m();var ra=N(K());var xu=N(rt());var Bp=({type:t,title:e,value:r,onChange:o,actionTitle:n,placeholder:a,addressErrors:i,onSelectWalletAddress:l})=>ra.default.createElement(jn,{type:t,title:e,actionTitle:n,addressErrors:i,onSelectWalletAddress:l},ra.default.createElement(ve,{size:ve.SIZE.xl,value:r?.[0],placeholder:a,onChange:({target:{value:d}})=>{o?.([(0,xu.trim)(d)],t,!0)}})),oa=Bp;f();m();var tr=N(K());var Su=({mode:t,walletAccounts:e,walletAccountsWithAddressBook:r,onChange:o})=>{let n=(0,tr.useRef)(null),a=(0,tr.useRef)(null),[i,l]=(0,tr.useState)(null),[d,c]=(0,tr.useState)(!1),[g,x]=(0,tr.useState)([]),[v,h]=(0,tr.useState)(""),[p,s]=(0,tr.useState)(""),_=B(()=>{c(!1)},[]),w=B((M,O)=>{O===Fe.SEND&&t===X.ONE_TO_MANY||O===Fe.RECEIVE&&t===X.MANY_TO_ONE?o?.(M,O):(O===Fe.SEND?n:a)?.current?.insertNodes(M),_()},[]),S=B(M=>{let O=M===Fe.SEND?e:r;c(!0),l(M),x(O)},[]),k=B((M=[])=>{n.current.insertNodes(M),h("")}),C=B((M=[])=>{a.current.insertNodes(M),s("")}),z=B((M,O,G=!1)=>{o?.(G?M:pu(M),O),h(""),s("")},[]),U=B(M=>{s(M)}),q=B(M=>{h(M)});return{visible:d,sendRef:n,receiveRef:a,addressType:i,addressOptions:g,onCloseDialog:_,onInsertAddresses:w,onSelectWalletAddress:S,onSendDrop:k,onReceiveDrop:C,onAddressInputChange:z,onReceiveDropError:U,onSendDropError:q,sendError:v,receiveError:p}};var Dp=t=>{let{mode:e,className:r,style:o,toAddresses:n,fromAddresses:a,addressErrors:i}=t,{visible:l,sendRef:d,receiveRef:c,addressType:g,addressOptions:x,onCloseDialog:v,onInsertAddresses:h,onSelectWalletAddress:p,onSendDrop:s,onReceiveDrop:_,onAddressInputChange:w,onReceiveDropError:S,onSendDropError:k,sendError:C,receiveError:z}=Su(t),{isSm:U}=Le();return rr.default.createElement(T.FlexBox,{style:o,direction:U?T.DIRECTION.vertical:T.DIRECTION.horizontal,className:(0,wu.default)(be["batch-send-address"],r)},e===X.ONE_TO_MANY?rr.default.createElement(oa,{value:a,type:Fe.SEND,addressErrors:i?.from,placeholder:y("wallet_extension_address_input_input_address"),title:y("wallet_extension_sending_title_send_address"),actionTitle:y("wallet_extension_address_anchor_address_book"),onChange:w,onSelectWalletAddress:p}):rr.default.createElement(ta,{ref:d,value:a,addressErrors:i?.from,type:Fe.SEND,placeholder:y("wallet_extension_address_input_input_address"),title:y("wallet_extension_sending_title_send_address"),actionTitle:y("wallet_extension_address_anchor_address_book"),onChange:w,onSelectWalletAddress:p,onDrop:s,onDropError:k,dropError:C}),e===X.MANY_TO_ONE?rr.default.createElement(oa,{value:n,type:Fe.RECEIVE,addressErrors:i?.to,placeholder:y("wallet_extension_address_input_input_address"),title:y("wallet_extension_receive_title_receive_address"),actionTitle:y("wallet_extension_address_anchor_address_book"),onChange:w,onSelectWalletAddress:p}):rr.default.createElement(ta,{ref:c,value:n,type:Fe.RECEIVE,addressErrors:i?.to,placeholder:y("wallet_extension_address_input_input_address"),title:y("wallet_extension_receive_title_receive_address"),actionTitle:y("wallet_extension_address_anchor_address_book"),onChange:w,onSelectWalletAddress:p,onDrop:_,onDropError:S,dropError:z}),rr.default.createElement(gr,{visible:l,noContentPadding:!0,windowStyle:{height:"685px",maxHeight:"685px"},title:y("wallet_extension_addressbook_title_address_book"),onClose:v},rr.default.createElement(_u,{mode:e,type:g,options:x,onChange:h})))},Tu=rr.default.memo(Dp);f();m();var Cr=N(K());var Or=N(rt());f();m();Ie();no();oo();var Mp=()=>B(async t=>{let{data:e}=await Ft(Bt.getSolRentBatch,{coinId:ar,addresses:t});return e}),Eu=Mp;Ie();no();oo();f();m();var yu=N(rt());Ie();var na=(t=[],e)=>e===Fe.SEND?t.map(({from:r})=>r):t.map(({to:r})=>r),Au=async({mode:t,localType:e,tokenSymbol:r,toAddresses:o,fromAddresses:n,walletAccounts:a,addressRegisterStatusMap:i})=>{let l=[],d=[],c=(0,yu.max)([o?.length,n?.length]),g=n[0],x=o[0];for(let v=0;v<c;v++){(t===X.MANY_TO_MANY||t===X.MANY_TO_ONE)&&(g=n[v]),(t===X.MANY_TO_MANY||t===X.ONE_TO_MANY)&&(x=o[v]),x=o[v],g&&!a?.includes(g)?d.push({address:g,error:"wallet_extension_sending_text_address_wallet_extension",at:v}):t!==X.ONE_TO_MANY&&g&&n.slice(0,v).includes(g)&&d.push({address:g,error:"wallet_extension_sending_text_address_duplicated",at:v});let h=ha;e===re?h=ar:e===Se?h=zo:e===J?h=Pr:e===se&&(h=Ro);let p=x&&ut(x,e),s=await Va(p,h);if(x&&!s&&l.push({address:x,error:"wallet_extension_sending_text_address_illegal",at:v}),e===J&&g||e===se&&x){let _=!0;e===J?_=i[g]??!0:_=i[x]??!0,_===!1&&e===J&&d.push({address:g,error:"wallet_extension_sending_error_address_no_register",at:v}),_===!1&&e===se&&l.push({address:x,error:"wallet_extension_sending_error_token_no_register",at:v,args:{token:r}})}}return{to:l,from:d}};f();m();var ku=N(rt());f();m();var bu=N(_a()),eo=N(rt());var Pp=10,Rp=({web3:t,addressList:e,contractAddress:r})=>{let o=new t.BatchRequest;return new Promise(n=>{let a=[],i=r&&new t.eth.Contract(bu.default,r),l=e?.length;e?.forEach(d=>{let c=r?i?.methods.balanceOf(d).call.request({from:d},(g,x)=>{a.push({from:d,balance:g?0:x}),a?.length===l&&n(a)}):t.eth.getBalance.request(d,"latest",(g,x)=>{a.push({from:d,balance:g?0:x,baseCoinBalance:g?0:x}),a?.length===l&&n(a)});o.add(c)}),o.execute()})},Nu=t=>{let e=wr(t);return B(async(r,o)=>{let n=await e(),a=(0,eo.uniq)(r),i=(0,eo.chunk)(a,Pp),l=await Promise.all(i.map(c=>Rp({web3:n,addressList:c,contractAddress:o}))),d=(0,eo.flatten)(l);return r?.length!==d?.length?r.map(c=>d.find(({from:x})=>x===c)):d},[e])};Ie();var zp=()=>{let[t]=te(),e=za(void 0,t?.localType),r=Fa();return B(async o=>{let n=st(t),a=o?.length,i=[];for(let l=0;l<a;l++){let d=o[l],{walletId:c}=e.find(x=>x.address===d)||{},{coinAmountInt:g}=await r(t?.coinId,c)||{};if(n)i.push({from:d,balance:g,baseCoinBalance:g});else{let{coinAmountInt:x}=await r(t?.baseCoinId,c)||{};i.push({from:d,balance:g,baseCoinBalance:x})}}return i})},Wp=()=>{let[t]=De(),[e]=te(),r=Nu(t?.rpcUrl);return B(async o=>{let n=!e?.address,a=[],i=o.map(d=>d&&ut(d,e?.localType)),l=await r(i,void 0);return n||(a=await r(i,e?.address)),(0,ku.merge)(l,a)},[e])},Up=()=>{let[t]=te(),e=Wp(),r=zp();return[se,re,Se,J].includes(t?.localType)?r:e},Iu=Up;var Hp=(t,e)=>{let[r]=te(),[o,n]=(0,Cr.useState)(!1),{gotoConfirmPage:a}=Ke(),i=oi(!0,e),[,l]=an(),d=Iu(),c=Eu(),[g,x]=_e(),[v,h]=(0,Cr.useState)(na(g,Fe.SEND)),[p,s]=(0,Cr.useState)(na(g,Fe.RECEIVE)),[_,w]=(0,Cr.useState)({}),S=B((U,q)=>{q===Fe.SEND?h(U):s(U)},[]),k=(0,Cr.useMemo)(()=>{let U=[];if(t===X.MANY_TO_MANY){let q=(0,Or.min)(v.length,p.length),M=p.slice(0,q);v.slice(0,q).forEach((G,j)=>{let L=M[j];G&&L&&U.push({to:L,from:G})})}else if(t===X.MANY_TO_ONE){let q=p.find(M=>!!M);v.forEach(M=>{M&&q&&U.push({to:q,from:M})})}else if(t===X.ONE_TO_MANY){let q=v.find(M=>!!M);p.forEach(M=>{q&&M&&U.push({to:M,from:q})})}return U},[v,t,p]),C=!k?.length,z=B(async()=>{n(!0);let U=[];r?.localType===J?U=v:r?.localType===se&&(U=p);let q={};if([se,J].includes(r?.localType))try{let{data:G}=await Ft(Bt.batchQueryAddressRegister,{chainId:r?.chainId,addresses:U,contractAddress:r?.localType===se?r?.address:void 0});q=G}catch(G){console.log(G)}let M=await Au({localType:e,toAddresses:p,fromAddresses:v,walletAccounts:i,mode:t,addressRegisterStatusMap:q,tokenSymbol:r?.symbol});if(M?.from?.length||M?.to?.length)return n(!1),w(M);let O=await d((0,Or.map)(k,"from"));if(r?.localType===re&&r?.baseCoinId!==0){let G=await c((0,Or.map)(k,"to"));l(G)}return O=O?.map((G,j)=>({...G,from:ba(G?.from,r?.localType),id:j})),x((0,Or.merge)([],k,O)),n(!1),a()},[p,v,i,k]);return{loading:o,addressErrors:_,sendAddresses:g,fromAddresses:v,toAddresses:p,nextDisabled:C,onNext:z,onAddressChange:S}},Cu=Hp;f();m();var sa={root:"_root_16y8t_2",footer:"_footer_16y8t_99"};var Gp=()=>{let{isSm:t}=Le(),[e]=te(),[r]=mt(),{loading:o,fromAddresses:n,toAddresses:a,addressErrors:i,nextDisabled:l,onNext:d,onAddressChange:c}=Cu(r,e?.localType),[g,x]=ni(e?.localType),{gotoHomePage:v}=Ke(),[h,p]=(0,Ct.useMemo)(()=>r===X.MANY_TO_MANY?[y("wallet_extension_multitomulti_subtitle_many_transfer"),y("wallet_extension_reminder_tooltips_portfolio_trading")]:r===X.ONE_TO_MANY?[y("wallet_extension_onetomulti_subtitle_one_to_many"),y("wallet_extension_reminder_tooltips_multisender_onetomulti")]:[y("wallet_extension_multitoone_subtitle_many_to_one"),y("wallet_extension_reminder_tooltips_multisender_multitoone")],[r,y]);return Ct.default.createElement(ir,{footer:Ct.default.createElement(T.Box,{className:sa.footer},Ct.default.createElement(Z,{block:t,category:Z.CATEGORY.outline,type:Z.TYPE.primary,size:t?Z.SIZE.lg:Z.SIZE.xl,onClick:()=>{v()}},y("wallet_extension_footer_btn_back")),Ct.default.createElement(Z,{block:t,loading:o,disabled:l,category:Z.CATEGORY.fill,type:Z.TYPE.highlight,size:t?Z.SIZE.lg:Z.SIZE.xl,onClick:d},y("wallet_extension_footer_btn_next")))},Ct.default.createElement(Yr,{tip:p,subtitle:h,title:y("wallet_extension_address_maintitle_add_address")}),Ct.default.createElement(T.Box,{className:sa.root},Ct.default.createElement(Tu,{mode:r,toAddresses:a,fromAddresses:n,addressErrors:i,walletAccounts:g,walletAccountsWithAddressBook:x,onChange:c})))},Ou=Ct.default.memo(Gp);f();m();var Re=N(K());Ie();var Td=N(Be()),Yn=N(rt());oo();no();f();m();var Oe={root:"_root_1juzk_1",header:"_header_1juzk_36",content:"_content_1juzk_36",alert:"_alert_1juzk_40",statistics:"_statistics_1juzk_81",address:"_address_1juzk_97",footer:"_footer_1juzk_136",loadingIcon:"_loadingIcon_1juzk_239",pauseLoadingIcon:"_pauseLoadingIcon_1juzk_254",finished:"_finished_1juzk_258",finishedIcon:"_finishedIcon_1juzk_261",failed:"_failed_1juzk_265",failedIcon:"_failedIcon_1juzk_268",sendError:"_sendError_1juzk_272",warning:"_warning_1juzk_275",export:"_export_1juzk_282",exportIcon:"_exportIcon_1juzk_305",finishedConfirm:"_finishedConfirm_1juzk_309","status-icon":"_status-icon_1juzk_351",statusIcon:"_status-icon_1juzk_351","status-icon-pause":"_status-icon-pause_1juzk_364",statusIconPause:"_status-icon-pause_1juzk_364","status-title":"_status-title_1juzk_367",statusTitle:"_status-title_1juzk_367","status-desc-text":"_status-desc-text_1juzk_376",statusDescText:"_status-desc-text_1juzk_376","status-desc-container":"_status-desc-container_1juzk_392",statusDescContainer:"_status-desc-container_1juzk_392","result-main":"_result-main_1juzk_401",resultMain:"_result-main_1juzk_401"};f();m();var Gt=N(K());ne();f();m();var Lr={FROM:"from",TO:"to",TX_AMOUNT:"txAmount",STATUS:"txStatus",HASH:"txHash"},Lo=[{title:"wallet_extension_list_title_send_address",key:Lr.FROM,type:He.ADDRESS},{title:"wallet_extension_list_title_receive_address",key:Lr.TO,type:He.ADDRESS},{title:"wallet_extension_list_title_amount",key:Lr.TX_AMOUNT,type:He.AMOUNT},{title:"wallet_extension_list_colheader_state",key:Lr.STATUS,type:He.STATUS},{title:"wallet_extension_list_colheader_hash",key:Lr.HASH,type:He.HASH,align:"center",width:"200px"}];var $={NONE:"NONE",SENDING:"SENDING",PAUSE:"PAUSE",FINISHED:"FINISHED",FAILED:"FAILED",CANCELED:"CANCELED",DONE:"DONE",BACK_TO_HOME:"BACK_TO_HOME"},Lu={[$.SENDING]:[{actionProps:{children:"wallet_extension_footer_btn_cancel",category:Z.CATEGORY.outline,type:Z.TYPE.primary},actionType:$.CANCELED},{actionProps:{children:"wallet_extension_footer_btn_stop",category:Z.CATEGORY.outline,type:Z.TYPE.primary},actionType:$.PAUSE}],[$.PAUSE]:[{actionProps:{children:"wallet_extension_footer_btn_cancel",category:Z.CATEGORY.outline,type:Z.TYPE.primary},actionType:$.CANCELED},{actionProps:{children:"wallet_extension_footer_btn_continue",category:Z.CATEGORY.fill,type:Z.TYPE.highlight},actionType:$.SENDING}],[$.CANCELED]:[{actionProps:{children:"wallet_extension_complete_btn_done",category:Z.CATEGORY.fill,type:Z.TYPE.highlight},actionType:$.DONE}],[$.FINISHED]:[{actionProps:{children:"wallet_transfer_success_btn_back_to_home",category:Z.CATEGORY.outline,type:Z.TYPE.primary},actionType:$.BACK_TO_HOME},{actionProps:{children:"wallet_extension_complete_btn_done",category:Z.CATEGORY.fill,type:Z.TYPE.highlight},actionType:$.DONE}],[$.FAILED]:[{actionProps:{children:"wallet_extension_failure_btn_cancel",category:Z.CATEGORY.outline,type:Z.TYPE.primary},actionType:$.DONE},{actionProps:{children:"wallet_extension_failure_btn_restart_transaction",category:Z.CATEGORY.fill,type:Z.TYPE.highlight},actionType:$.FAILED}]},Fu={[$.SENDING]:{title:"wallet_extension_sending_title_sending",style:{color:"var(--okd-color-content-primary)"}},[$.PAUSE]:{title:"wallet_extension_suspension_title_transaction_stop",style:{color:"var(--okd-color-content-primary)"}},[$.FAILED]:{title:"wallet_extension_failure_title_fail_transaction",style:{color:"var(--okd-color-semantic-negative)"}},[$.FINISHED]:{title:"wallet_extension_complete_title_complete_transaction",style:{color:"var(--okd-color-semantic-positive)"}}};var jp=({onExport:t,onSendStatusChange:e,sendStatus:r=$.SENDING})=>{let{isSm:o}=Le(),n=Lu[r],a=r===$.FINISHED,i=a?T.Box:Gt.default.Fragment;return Gt.default.createElement(T.FlexBox,{align:T.ALIGN.center,className:Oe.footer},Gt.default.createElement(T.Box,{className:Oe.warning},a&&Gt.default.createElement(T.Box,{className:Oe.export,onClick:t},Gt.default.createElement(Ce,{size:Ce.SIZE.sm,icon:"okx-wallet-plugin-export"}),Gt.default.createElement(T.Box,null,y("wallet_extension_complete_btn_export_transaction"))),!a&&!o&&y("wallet_extension_sending_text_no_close_page")),n.map(({actionProps:{children:l,...d},actionType:c})=>Gt.default.createElement(i,{className:o&&Oe.finishedConfirm},Gt.default.createElement(Z,{block:o,...d,size:o?Z.SIZE.lg:Z.SIZE.xl,onClick:()=>{e?.(c)}},y(l)))))},Bu=Gt.default.memo(jp);f();m();var Ot=N(K()),Du=N(Be());ne();var Yp=({sendStatus:t})=>{if([$.SENDING,$.PAUSE].includes(t))return Ot.default.createElement(At,{loaderClassName:(0,Du.default)(Oe.loadingIcon,{[Oe.pauseLoadingIcon]:t===$.PAUSE})});let e={className:Oe["status-icon"]};return t===$.FAILED?e=Object.assign(e,{icon:"okds-fail-circle",style:{color:"var(--okd-color-semantic-negative)"}}):t===$.FINISHED&&(e=Object.assign(e,{icon:"okds-success-circle",style:{color:"var(--okd-color-semantic-positive)"}})),Ot.default.createElement(Ce,{...e})},qp=({sendStatus:t,sendResult:e=[]})=>{let{isSm:r}=Le(),{title:o,style:n}=Fu[t],a=y(o),i=(0,Ot.useMemo)(()=>Ot.default.createElement(ae.Text,{strong:700,style:n,className:Oe["status-title"]},a),[n,a]);return Ot.default.createElement(T.Space,{className:Oe["result-main"],space:r?"16px":"22px",align:T.ALIGN.center,direction:r?T.DIRECTION.vertical:T.DIRECTION.horizontal},Ot.default.createElement(Yp,{sendStatus:t}),Ot.default.createElement(T.Space,{direction:T.DIRECTION.vertical,space:"8px"},i,Ot.default.createElement(T.Space,{space:r?"4px":"8px",direction:r?T.DIRECTION.vertical:T.DIRECTION.horizontal,className:Oe["status-desc-container"]},e.map(({title:l,args:d,style:c})=>Ot.default.createElement(ae.Text,{key:l,style:c,className:Oe["status-desc-text"]},y(l,d))))))},Mu=qp;f();m();var Fr=N(K());Ie();var ed=N(Qn());var td=N(ct());f();m();var Ku=N(ct());f();m();var ia=N(K()),Fo=N(ct());ne();f();m();var Pu=t=>{let e=Sr(t);return B(async r=>{if(e?.baseCoinId===0||!r)return{tokenAccountAddress:"",createAssociatedAddress:!1};let{data:o}=await ka({coinId:t,address:r});return{createAssociatedAddress:!o?.legal,tokenAccountAddress:o?.tokenAccountAddress}})};kd();Ie();f();m();var Ru=N(Ld());bd();var zu=({address:t,localType:e,contractAddress:r,symbol:o,errorMsg:n})=>{try{ua.captureEvent({tags:{address:t},message:"BIZ_ERROR_batch_transfer_publish",contexts:{report:{info:JSON.stringify({address:t,localType:e,contractAddress:r,symbol:o,errorMsg:n})}},exception:{values:[{type:"BIZ_ERROR_batch_transfer_publish",value:t}]},level:"error"})}catch{(0,Ru.default)()}};f();m();no();oo();var Wu=N(K()),Zp=()=>{let t=(0,Wu.useRef)();return B(e=>new Promise(r=>{let o=async()=>{let{data:n}=await Ft(Bt.batchGetTxStatus,{txHashList:[e]}),a=n[e];["SUCCESS","ERROR"].includes(a)&&(r(a),clearInterval(t.current))};t.current=setInterval(()=>{o()},2e3)}))},aa=Zp;f();m();var Kp=t=>{let e=wr(t);return B(async r=>await(await e()).eth.getTransactionCount(r,"latest"),[e])},Uu=Kp;f();m();Ie();var Vp=()=>{let t=nt(),e=Wr(re);return B(async()=>{let{recentBlockhash:r}=await t({isBatch:!0,coinId:ar,address:e});return r})},Hu=Vp;var Gu=t=>{let e=wr(t),[r]=mt(),o=(0,ia.useRef)(!1),n=(0,ia.useRef)({}),[a]=te(),[i]=De(),l=Uu(t),d=un(t),c=$a(),[g]=jr(),x=(0,Fo.useSelector)(Ze),v=Ga(),h=(0,Fo.useSelector)(Si);return o.current=h,n.current=x,B(async({to:p,from:s,value:_,usedBalance:w,balance:S,baseCoinBalance:k,transferAmountType:C,gasPrice:z})=>{let U=null,q=o.current||!1;try{let M=_,O=await e(),{chainId:G}=i,j=st(a),L=s&&ut(s,a?.localType),P=p&&ut(p,a?.localType),W=await v(a?.address,L,O)||S,R=await d({to:P,from:L,value:_},a?.address),le=await l(L),ee=n.current,he=z?.gasPrice||ee?.gasPrice,ue=z?.maxFeePerGas||ee?.maxFeePerGas,we=z?.maxPriorityFeePerGas||ee?.maxPriorityFeePerGas,{networkFeeInt:Ne}=Kt({gasPrice:he,gasLimit:R}),Ee={to:p,from:s,value:_,nonce:le,chainId:G,gasLimit:R,supportEip1559:g,contractAddress:a?.address,localType:a?.localType};g?Ee={maxFeePerGas:ue,maxPriorityFeePerGas:we,type:es.FEE_MARKET,...Ee}:Ee={gasPrice:he,type:es.LEGACY,...Ee};let ze=Qo({to:p,from:s,value:_,nonce:le,chainId:G,gasLimit:R,gasPrice:he,maxFeePerGas:ue,supportEip1559:g,maxPriorityFeePerGas:we,contractAddress:a?.address,localType:a?.localType});if(q){let H=await c({...ze,coinId:a?.coinId});Ne=D.add(Ne,H)}j&&r!==X.ONE_TO_MANY&&C===ie.ALL&&(M=D.sub(W,Ne),ze=Qo(Object.assign(Ee,{value:M}))),j&&r===X.ONE_TO_MANY&&C===ie.ALL&&(M=D.sub(w,Ne),ze=Qo(Object.assign(Ee,{value:M})));let E=Gr({isBaseCoin:j,balance:W,baseCoinBalance:k,txAmount:Ee?.value,networkFee:Ne}),Y=await ri(L);if(!E||!Y)return{to:p,from:s,txStatus:V?.FAILED};U=await Zo(ze,ze?.from,Xn);let F=await Vo(Xn,U);return await O.eth.sendSignedTransaction(U),{to:p,from:s,txHash:F,txAmount:M,txStatus:V?.SUCCEED}}catch(M){return zu({address:s,localType:i?.localType,contractAddress:a?.address,symbol:a?.symbol,errorMsg:M?.message}),{to:p,from:s,txStatus:V?.FAILED}}},[e])},ju=()=>{let[t]=te(),[e]=mt(),r=Ur({localType:re,coinId:t?.coinId}),o=Hu(),n=dn(),a=Pu(t?.coinId),i=(0,Fo.useSelector)(Ze);return B(async({to:l,from:d,amount:c,balance:g,usedBalance:x,baseCoinBalance:v,transferAmountType:h})=>{try{let p=c,s=st(t),_=await o(),w=await n({coinId:t?.coinId,chainId:t?.chainId,to:l,from:d}),{createAssociatedAddress:S}=await a(l),k=w||i||{},{computeUnitLimit:C,computeUnitPrice:z,networkFeeInt:U}=k;h===ie.ALL&&s&&e!==X.ONE_TO_MANY&&(p=D.sub(g,U)),h===ie.ALL&&s&&e===X.ONE_TO_MANY&&(p=D.sub(x,U));let q={to:l,from:d,blockHash:_,payer:d,computeUnitLimit:C,computeUnitPrice:z,amount:p,type:s?ts.TRANSFER:ts.TOKEN_TRANSFER};if(t?.baseCoinId!==0&&Object.assign(q,{mint:t.address,createAssociatedAddress:S}),t?.protocolType===ao.SPL_TOKEN_2022&&Object.assign(q,{token2022:!0,decimal:t?.decimals}),!Gr({isBaseCoin:s,balance:g,baseCoinBalance:v,txAmount:p,networkFee:U}))return{to:l,from:d,txStatus:V?.FAILED};let O=await Zo(q,d,re),G=await Vo(re,O);return await r(O,{txHash:G,signedTx:O,toAdr:l,fromAdr:d,coinAmount:p,serviceCharge:U,walletId:void 0}),{to:l,from:d,txHash:G,txAmount:p,startTime:Date.now(),txStatus:V?.PENDING}}catch{return{to:l,from:d,txStatus:V?.FAILED}}})},Yu=()=>{let[t]=te(),[e]=mt(),r=Ui(t?.coinId),o=Hi(t?.coinId),n=nn(),a=aa();return B(async({to:i,from:l,amount:d,balance:c,usedBalance:g,baseCoinBalance:x,transferAmountType:v})=>{try{let h=d,p=st(t),s=await n({to:i,from:l,value:d,coinId:t?.coinId,baseCoinId:t?.baseCoinId});if(v===ie.ALL&&p&&e!==X.ONE_TO_MANY&&(h=D.sub(c,s)),v===ie.ALL&&p&&e===X.ONE_TO_MANY&&(h=D.sub(g,s)),!Gr({isBaseCoin:p,balance:c,baseCoinBalance:x,txAmount:h,networkFee:s}))return{to:i,from:l,txStatus:V?.FAILED};let{tx:w,txBytes:S,signedTx:k}=await r({to:i,from:l,value:d,coinId:t?.coinId,baseCoinId:t?.baseCoinId}),{hash:C}=k||{};return await o({tx:w,txBytes:S,to:i,from:l,coinAmount:d,signedTx:k}),e===X.ONE_TO_MANY&&await a(C)==="ERROR"?{to:i,from:l,txStatus:V?.FAILED}:{to:i,from:l,txHash:C,txAmount:h,startTime:Date.now(),txStatus:V?.PENDING}}catch{return{to:i,from:l,txStatus:V?.FAILED}}})},qu=()=>{let[t]=te(),[e]=mt(),r=nt(),o=Ur({localType:J,coinId:t?.coinId}),n=(0,Fo.useSelector)(Ze),a=fn(t?.coinId);return B(async({to:i,from:l,amount:d,balance:c,baseCoinBalance:g,transferAmountType:x})=>{try{let v=d,h=st(t),p=await r({value:"0",toAddr:i,address:l,fromAddr:l,coinId:t?.coinId}),{accountId:s,nonce:_}=p||{},S=await a({to:i,chainId:t?.chainId,contractAddress:t?.address})||n||{},{networkFeeInt:k}=S;x===ie.ALL&&h&&e!==X.ONE_TO_MANY&&(v=D.sub(c,k));let C={to:i,from:l,type:"transfer",fees:k,amounts:v,decimals:t?.decimals,nonce:parseInt(_,10),accountId:parseInt(s,10),tokenSymbol:t?.originSymbol,tokenId:parseInt(t?.tokenId,10)};if(!Gr({isBaseCoin:h,balance:c,baseCoinBalance:g,txAmount:v,networkFee:k}))return{to:i,from:l,txStatus:V?.FAILED};let U=await Zo(C,l,J);if(U?.code)return{to:i,from:l,txStatus:V?.FAILED};let{signature:q,tx:M}=U,{txHash:O,...G}=M||{};return await o(JSON.stringify({signature:q,tx:G}),{txHash:O,signedTx:U,toAdr:M?.to,fromAdr:l,coinAmount:v,serviceCharge:M?.fee,walletId:void 0,extJson:JSON.stringify({serviceChargeCoinId:t?.coinId})}),{to:i,from:l,txHash:O,txAmount:v,startTime:Date.now(),txStatus:V?.PENDING}}catch(v){return console.log(v),{to:i,from:l,txStatus:V?.FAILED}}})},Zu=()=>{let[t]=te(),[e]=mt(),r=zi(),o=Ur({localType:se,coinId:t?.coinId}),n=on(),a=aa();return B(async({to:i,from:l,amount:d,balance:c,usedBalance:g,baseCoinBalance:x,transferAmountType:v})=>{try{let h=d,p=t?.baseCoinId===0,{tyArg:s,chainId:_,networkFee:w,sequenceNumber:S,maxGasAmount:k,gasUnitPrice:C,expirationTimestampSecs:z}=await n({address:l,coinId:t?.coinId});if(v===ie.ALL&&p&&e!==X.ONE_TO_MANY&&(h=D.sub(c,w)),v===ie.ALL&&p&&e===X.ONE_TO_MANY&&(h=D.sub(g,w)),!Gr({isBaseCoin:p,balance:c,baseCoinBalance:x,txAmount:h,networkFee:w}))return{to:i,from:l,txStatus:V?.FAILED};let q=await r({to:i,from:l,tyArg:s,chainId:_,gasUnitPrice:C,maxGasAmount:k,sequenceNumber:S,amount:h,coinId:t?.coinId,expirationTimestampSecs:z,baseCoinId:t?.baseCoinId,metaAddress:t?.address,protocolType:t?.protocolType}),M=await Vo(se,q);return await o(q,{txHash:M,signedTx:q,toAdr:i,fromAdr:l,coinAmount:h,serviceCharge:w,walletId:void 0,extJson:JSON.stringify({nonce:S})}),e===X.ONE_TO_MANY?(await a(M),{to:i,from:l,txHash:M,txAmount:h,txStatus:V?.SUCCEED}):{to:i,from:l,txHash:M,txAmount:h,startTime:Date.now(),txStatus:V?.PENDING}}catch{return{to:i,from:l,txStatus:V?.FAILED}}})};f();m();f();m();var jt={uninitialized:0,initialized:1,waiting:2,paused:3,working:4,canceled:5,unknown:6},Bo=class{constructor(e){yt(this,"status",jt.uninitialized);yt(this,"nextInfo",null);yt(this,"cb",null);yt(this,"args",[]);yt(this,"next",(...e)=>{[jt.waiting,jt.canceled,jt.paused].includes(this.status)||!this.cb||(e.length>0&&(this.args=e),this.nextInfo=this.generator(this.execute,...this.args),this.status=jt.waiting,this.nextInfo.execute())});yt(this,"execute",()=>{this.status=jt.working,this.cb?.(this.next)});yt(this,"cancel",()=>{this.status=jt.canceled,this.nextInfo?.cancel?.(),this.cb=void 0});yt(this,"pause",()=>{this.status=jt.paused,this.nextInfo?.pause?.()});yt(this,"start",(e,...r)=>{this.cb=e,r.length>0&&(this.args=r),this.next()});yt(this,"continue",()=>{this.status=jt.initialized,this.next()});this.generator=e,this.status=jt.initialized,this.nextInfo=null,this.cb=null}};function Xp(t){let e=(r,o)=>{let n;return{execute:()=>{n=setTimeout(r,o??t??0)},cancel:()=>{clearTimeout(n)},pause:()=>{clearTimeout(n)}}};return new Bo(e)}var Yt=Xp;var Vu=()=>{let[t]=ht(),[e]=pt(),[r,o]=_e(),n=Gu(),a=(0,Ku.useSelector)(Ze),i=a?.level===qe.CUSTOM;return B(async()=>{let l=0,{type:d,min:c,max:g}=t,x=r.map(h=>{let{to:p,from:s,txAmount:_,id:w}=h;return{to:p,from:s,interval:d===Ue.NONE?100:xt(c,g,0)*1e3,request:async()=>n({...h,from:s,value:_,transferAmountType:e.type,gasPrice:i?a:{}}),id:w}}),v=Yt();return v.start(async h=>{let p=x[l];if(p)try{o({to:p?.to,from:p?.from,txStatus:V.PENDING,id:p?.id});let{txStatus:s,txHash:_,from:w,txAmount:S}=await p.request();o({from:w,to:p?.to,txStatus:s,txHash:_,txAmount:S,id:p?.id})}catch(s){console.log(s)}finally{l++,h(p.interval)}}),v},[])};f();m();var Xu=()=>{let[t]=ht(),[e]=pt(),[r,o]=_e(),n=ju();return B(async()=>{let a=0,{type:i,min:l,max:d}=t,c=r.map(x=>{let{to:v,from:h,txAmount:p,id:s}=x;return{to:v,from:h,interval:i===Ue.NONE?100:xt(l,d,0)*1e3,request:async()=>n({...x,amount:p,transferAmountType:e.type}),id:s}}),g=Yt();return g.start(async x=>{let v=c[a];if(v)try{o({to:v?.to,from:v?.from,txStatus:V.PENDING,id:v?.id});let{txStatus:h,txHash:p,from:s,startTime:_,txAmount:w}=await v.request();o({from:s,startTime:_,to:v?.to,txStatus:h,txAmount:w,txHash:p,id:v?.id})}catch(h){console.log(h)}finally{a++,x(v.interval)}}),g},[])};f();m();var $u=()=>{let[t]=ht(),[e]=pt(),[r,o]=_e(),n=Yu();return B(async()=>{let a=0,{type:i,min:l,max:d}=t,c=r.map(x=>{let{to:v,from:h,txAmount:p,id:s}=x;return{to:v,from:h,interval:i===Ue.NONE?100:xt(l,d,0)*1e3,request:async()=>n({...x,amount:p,transferAmountType:e.type}),id:s}}),g=Yt();return g.start(async x=>{let v=c[a];if(v)try{o({to:v?.to,from:v?.from,txStatus:V.PENDING,id:v?.id});let{txStatus:h,txHash:p,from:s,startTime:_,txAmount:w}=await v.request();o({from:s,startTime:_,to:v?.to,txStatus:h,txAmount:w,txHash:p,id:v?.id})}catch(h){console.log(h)}finally{a++,x(v.interval)}}),g},[])};f();m();var Ju=()=>{let[t]=ht(),[e]=pt(),[r,o]=_e(),n=qu();return B(async()=>{let a=0,{type:i,min:l,max:d}=t,c=r.map(x=>{let{to:v,from:h,txAmount:p,id:s}=x;return{to:v,from:h,interval:i===Ue.NONE?100:xt(l,d,0)*1e3,request:async()=>n({...x,amount:p,transferAmountType:e.type}),id:s}}),g=Yt();return g.start(async x=>{let v=c[a];if(v)try{o({to:v?.to,from:v?.from,txStatus:V.PENDING,id:v?.id});let{txStatus:h,txHash:p,from:s,startTime:_,txAmount:w}=await v.request();o({from:s,startTime:_,to:v?.to,txStatus:h,txAmount:w,txHash:p,id:v?.id})}catch(h){console.log(h)}finally{a++,x(v.interval)}}),g},[])};f();m();var Qu=()=>{let[t]=ht(),[e]=pt(),[r,o]=_e(),n=Zu();return B(async()=>{let a=0,{type:i,min:l,max:d}=t,c=r.map(x=>{let{to:v,from:h,txAmount:p,id:s}=x;return{to:v,from:h,interval:i===Ue.NONE?100:xt(l,d,0)*1e3,request:async()=>n({...x,amount:p,transferAmountType:e.type}),id:s}}),g=Yt();return g.start(async x=>{let v=c[a];if(v)try{o({to:v?.to,from:v?.from,txStatus:V.PENDING,id:v?.id});let{txStatus:h,txHash:p,from:s,startTime:_,txAmount:w}=await v.request();o({from:s,startTime:_,to:v?.to,txStatus:h,txAmount:w,txHash:p,id:v?.id})}catch(h){console.log(h)}finally{a++,x(v.interval)}}),g},[])};var rd=t=>{let[e]=te(),r=(0,ed.useHistory)(),o=(0,td.useDispatch)(),n=(0,Fr.useRef)(),[a,i]=(0,Fr.useState)($.SENDING),l=qi(),d=Vu(a,e?.localType),c=Xu(a,e?.localType),g=$u(),x=Ju(),v=Qu(),h=d;e?.localType===re?h=c:e?.localType===Se?h=g:e?.localType===J?h=x:e?.localType===se&&(h=v),(0,Fr.useEffect)(()=>{let _=!t.some(({txStatus:S})=>S!==V.FAILED),w=!t.some(({txStatus:S})=>S===V.PENDING||!S);_?i($.FAILED):w&&i($.FINISHED)},[t]);let p=()=>{h().then(_=>{n.current=_}).catch(_=>{console.log(_)})};(0,Fr.useEffect)(()=>{p()},[]);let s=B(async _=>{if(_===$.DONE){let w=await globalThis.platform.getActiveTabs();await globalThis.platform.closeTab(w.map(({id:S})=>S))}else _===$.PAUSE?(n.current?.pause(),i($.PAUSE)):_===$.CANCELED?(n.current?.cancel(),i($.FINISHED)):_===$.SENDING?(n.current?.continue(),i($.SENDING)):_===$.FINISHED?i($.FINISHED):_===$.FAILED?(n.current?.cancel(),l(),i($.SENDING),p()):_===$.BACK_TO_HOME&&(r.replace(xr),o(Pi()))},[]);return[a,s]};f();m();var la=N(K());ne();var od=({sendStatus:t,sendAddress:e=[]})=>{let r=(0,la.useMemo)(()=>{let o=0,n=0,a=0,i=e?.length;return e.forEach(({txStatus:l})=>{l===V.FAILED&&o++,l===V.SUCCEED&&n++,l===V.PENDING&&a++}),{total:i,failed:o,success:n,notExecuted:i-o-a-n}},[e]);return(0,la.useMemo)(()=>{if(t===$.FAILED)return[{title:"wallet_extension_failure_subtitle_fail_resend"}];let{total:o,failed:n,success:a,notExecuted:i}=r,l=[{title:"wallet_extension_multisender_text_success_transaction",args:{amount:D.thousandFormat(a)}}];return n>0&&l.push({title:"wallet_extension_multisender_text_failed_transaction",args:{amount:D.thousandFormat(n)},style:{color:"var(--okd-color-semantic-negative)"}}),t===$.FINISHED?i>0&&l.push({title:"wallet_extension_multisender_text_not_executed_transaction",args:{amount:D.thousandFormat(i)}}):l.push({title:"wallet_extension_multisender_text_total_transaction",args:{amount:D.thousandFormat(o)}}),l},[t,r])};f();m();var Do=N(K());ne();function $p({sendStatus:t}){let{isSm:e}=Le(),[r,o]=(0,Do.useState)(!0),n=fi.FINISHED===t,a=y("wallet_extension_sending_text_no_close_page"),i=e&&r&&!n;return Do.default.createElement(T.Box,{className:Oe.alert},i?Do.default.createElement(to,{desc:a,type:to.TYPE.info,onClose:()=>{o(!1)}}):null)}var nd=$p;f();m();ne();var sd=N(K());var Jp=()=>{let[t]=te(),[e=[]]=_e(),r=e.map((a,i)=>({...a,showShortAddress:!0,showTextOneLine:!0,order:i+1,index:i,txAmount:D.truncate(D.div(a?.txAmount,10**(t?.decimals||18)),6,!1)})),o=(0,sd.useMemo)(()=>({[Lr.FROM]:{showOrder:!0,isFromAddress:!0}}),[]),n=Lo.map(a=>{let{title:i,key:l,type:d,...c}=a;return{title:y(i),dataIndex:l,key:l,render:Tn(wn[d],o[l]),...c}});return{dataSource:r,columns:n}},ad=Jp;f();m();var xd=N(K());var Sd=N(vd());ne();f();m();var gd=N(si()),hh=(t,e)=>{let r=window.URL||window.webkitURL||window,o=r.createObjectURL(t),n=document.createElement("a");n.href=o,n.download=e,n.click(),r.revokeObjectURL(o)},vh=(t=[],e="result.csv",r)=>{let o=gd.default.unparse(t,r),n="\uFEFF",a=new Blob([`${n}${o}`],{type:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"});hh(a,e)},_d=vh;function gh(t=[]){let e=(0,xd.useMemo)(()=>Lo.map(({key:n})=>n),[]),r=B(n=>{let a=y("wallet_extension_multisender_colbody_success"),i=y("wallet_extension_multisender_colbody_fail");switch(n){case V.SUCCEED:return a;case V.FAILED:case V.DROPPED:return i;default:return"-"}});return()=>{let n=`${y("wallet_extension_multisender_colheader_history")}.csv`,a=t.map(d=>{let c={...d,txAmount:D.thousandFormat(d.txAmount??0),txStatus:r(d.txStatus)};return Object.values((0,Sd.default)(c,e))}),l={fields:Lo.map(d=>y(d.title)),data:a};_d(l,n)}}var wd=gh;var _h={ERROR:V.FAILED,SUCCESS:V.SUCCEED},xh=()=>{let t=(0,Re.useRef)(),e=(0,Re.useRef)(),[r]=te(),[o=[],n]=_e(),{dataSource:a,columns:i}=ad(),{isSm:l}=Le(),[d,c]=rd(a),g=wd(a),x=od({sendStatus:d,sendAddress:a}),v=hn(),h=(0,Re.useMemo)(()=>(0,Yn.map)((0,Yn.filter)(o,({txStatus:s,txHash:_})=>_&&s===V.PENDING),"txHash"),[o]),p=async()=>{let{data:s}=await Ft(Bt.batchGetTxStatus,{txHashList:e.current});s&&Object.keys(s).forEach(_=>{let w=s[_];["SUCCESS","ERROR"].includes(w)&&n({txHash:_,txStatus:_h[w]})})};return(0,Re.useEffect)(()=>(t.current=setInterval(()=>{e.current?.length&&p()},2e3),()=>{clearInterval(t.current)}),[]),(0,Re.useEffect)(()=>{[se,re,Se,J].includes(r?.localType)&&(e.current=h)},[r?.localType,h]),Re.default.createElement(ir,{footer:Re.default.createElement(Bu,{sendStatus:d,onSendStatusChange:c,onExport:g}),useOkg:!1,headerProps:{className:(0,Td.default)(Oe.header,Oe.content)}},Re.default.createElement(T.Box,{className:Oe.root},Re.default.createElement(nd,{sendStatus:d}),Re.default.createElement(Mu,{sendStatus:d,sendResult:x}),Re.default.createElement(vn,{className:Oe.statistics,statistics:v})),Re.default.createElement(T.Box,{className:Oe.address},Re.default.createElement(gn,{dataSource:a,columns:i,scroll:{x:l}})))},Ed=Re.default.memo(xh);var YB=()=>{let[t]=te(),e=(0,qn.useDispatch)(),r=Qi(),o=(0,qn.useSelector)(Ze);return(0,vr.useEffect)(()=>{if(![se,re,Se,J].includes(t?.localType)&&r?.length&&o?.level){let{gasLimit:n,tokenPrice:a,usdToThisRate:i}=o,l=r.find(({level:d})=>d===o?.level);if(l){let{gasPrice:d}=l,{networkFee:c,networkFeeInt:g,networkFeeMarket:x}=Kt({gasPrice:d,gasLimit:n,price:a,usdToThisRate:i});e(dt({...o,...l,networkFee:c,networkFeeInt:g,networkFeeMarket:x,unitPriceDisplay:ga(d)}))}}},[e,r,t?.localType]),vr.default.createElement(Br.Switch,null,vr.default.createElement(Br.Route,{path:xr,component:ml,exact:!0}),vr.default.createElement(Br.Route,{path:io,component:Ou,exact:!0}),vr.default.createElement(Br.Route,{path:co,component:Ed,exact:!0}),vr.default.createElement(Br.Route,{path:lo,component:Gl,exact:!0}))};export{YB as default};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "prepub";

//# sourceMappingURL=BatchTransfer-MSYYV65N.js.map
