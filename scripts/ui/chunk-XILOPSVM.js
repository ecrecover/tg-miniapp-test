import{b as D}from"./chunk-Q4CU3DV4.js";import{a as M}from"./chunk-LI6XM372.js";import{a as A}from"./chunk-ZEWK7OGU.js";import{e as k}from"./chunk-VTLNAOHG.js";import{c as N}from"./chunk-TSR6RQYN.js";import{c as L}from"./chunk-DY54SY5O.js";import{d as C,e as P}from"./chunk-7KCWBFQ2.js";import{x as w}from"./chunk-6FOZGMAL.js";import{p as u}from"./chunk-IUIJ46C3.js";import{d as y,f as z}from"./chunk-MAIAJ7GD.js";import{H as l,na as c,za as j}from"./chunk-X7YMANPZ.js";import{I as K,w as m}from"./chunk-RPZQDAIQ.js";import{a as B}from"./chunk-6DDC4Y2S.js";import{f as b,m as R,o as F}from"./chunk-EQYVU4XP.js";R();F();var t=b(B());K();z();j();var G="0";function ct(d){let s=k(c)||{},n=A(l,d),[g,r]=(0,t.useState)(!0),[S,i]=(0,t.useState)(""),[p,E]=(0,t.useState)(""),f=async()=>{try{let o=await M({chainId:s?.chainId,coinId:c,address:n});E(o),o===u.NOT_STARTED?i(m("wallet_dialog_modal_not_registered")):o===u.PROCESSING?i(m("wallet_extension_transaction_notif_address_registering",{net:s?.chainName})):i("")}catch{i(m("wallet_extension_transaction_notif_address_register_fail",{net:s?.chainName}))}finally{r(!1)}},I=L("wallet-tx-status-toast",{onError:f});return(0,t.useEffect)(()=>{f()},[I]),{loading:g,registerError:S,registerStatus:p}}function ft(d,s){let{transactions:n}=d?.params||{},g=w(s),r=A(l,d?.walletId),[S,i]=(0,t.useState)(),{preExecuteRet:p,updateAndExecute:E}=D({coinId:c}),f=(0,t.useRef)(0),[I,o]=(0,t.useState)(!1),[U,_]=(0,t.useState)(!1),[O,v]=(0,t.useState)(null),q=async()=>{let e=await C({coinId:c,address:r},{fromAddr:r,toAddr:""});return v(e),e},h=async e=>{let a={type:"multi_contract_call",nonce:e?.info?.nonce,maxFee:f.current||G,chainId:N.StarknetChainId.SN_MAIN,multiContractCallData:{from:r,calls:n}};return(await y().signTransaction(a,r,l))?.signature},W=async e=>{let{data:a}=await P({coinId:c,address:r,inputData:e});return o(a?.queryGasLimitErrorUseDefault),a?.queryGasLimitErrorUseDefault?G:a?.gasLimit},T=async()=>{try{let e=await q(),a=await h(e),x=await W(a);f.current=x;let X=await h(e);E({value:0,from:r,to:n?.[0]?.contractAddress,txType:3,tokenAddress:n?.[0]?.contractAddress,data:X}),i(x)}catch{o(!0)}finally{_(!1)}};return(0,t.useEffect)(()=>{n&&(_(!0),T())},[n]),(0,t.useEffect)(()=>{g===u.PROCESSING&&s===u.COMPLETED&&(_(!0),T())},[s]),{feeInt:S,feeLoading:U,feeError:I,signInfo:O,preExecuteRet:p?.[0]}}export{ct as a,ft as b};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "prepub";

//# sourceMappingURL=chunk-XILOPSVM.js.map
