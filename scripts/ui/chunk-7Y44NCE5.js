import{f as xe}from"./chunk-BKPOG6ZD.js";import{a as Ue,f as ke,g as We}from"./chunk-OZMVWMFO.js";import{g as Te}from"./chunk-KTO7CPX7.js";import{a as U,b as oe}from"./chunk-P3XTPXPO.js";import{Aa as Z,B as J,Ba as _,C as Me,Cb as P,D as Q,Fa as $,db as B,i as H,jb as ne,qa as Y,qb as te,ta as G,ua as X,xb as re}from"./chunk-HPXM6RSK.js";import{Hc as ee,Kb as O,ib as D,kb as S,nb as z,pb as T,rb as R}from"./chunk-X7YMANPZ.js";import{c as V,f as x,m,o as C}from"./chunk-EQYVU4XP.js";var ce=V((rn,se)=>{m();C();function Re(e){var n=e==null?0:e.length;return n?e[n-1]:void 0}se.exports=Re});var j=V((sn,le)=>{m();C();var Oe=Ue(),Pe=xe(),je=ke(),Ee=Te(),ue=We(),ve=ce(),Ke=je(function(e){var n=ve(e);return ue(n)&&(n=void 0),Ee(Oe(e,1,ue,!0),Pe(n,2))});le.exports=Ke});m();C();function ie(e){return Object.keys(e).sort().reduce((n,r)=>(n[r]=e[r]instanceof Object?ie(e[r]):e[r],n),{})}function _e(e){let n=ie(e);return JSON.stringify(n)}function $e(e){if(!e||typeof e!="object")return null;let n={...e};for(let r in n)(n[r]===null||n[r]===void 0)&&delete n[r];return n}function ae({coins:e,walletId:n,walletIdentityMap:r,createdMap:o}){let t=o[n]||[],a=new Set(t.map(({coinId:s})=>s));return e.reduce((s,c)=>{let{coinId:i,baseCoinId:y}=c;return(typeof i>"u"&&typeof y>"u"||(a.has(y)||a.has(i))&&U({coin:c,walletId:n,walletIdentityMap:r}))&&s.push(c),s},[])}m();C();var ye=x(j()),h=x(Q());m();C();var me=x(j());O();m();C();var de=e=>({...e,currencyAmount:"0",currencyAmountUSD:"0",coinAmount:"0",coinAmountInt:"0"});function E(e,n,r){let o=null,t=n[e.coinId];e.coinAmount==="0"||t=="0"?o="0":typeof t<"u"&&(o=D(e.coinAmount,t)),e.currencyAmountUSD=o??e.currencyAmountUSD,e.currencyAmount=D(e.currencyAmountUSD,r?.usdToThisRate??"1")}function Ce(e,n){let r=[];return e.forEach(o=>{let t={...o};if(t.childrenCoin){if(t.childrenCoin.filter(s=>n(s,t.default)).length===0)return;r.push(t)}else{if(!n(t,t.default))return;r.push(t)}}),r.sort((o,t)=>R(t.currencyAmount,o.currencyAmount)?R(t.coinAmountInt,o.coinAmountInt)?T(o.rank,t.rank)?1:-1:T(t.coinAmountInt,o.coinAmountInt)?1:-1:T(t.currencyAmount,o.currencyAmount)?1:-1)}var Fe=[];function fe(e,n,r,{walletIdentityMap:o,createdMap:t,walletId:a}){if(!e[n])return Fe;let s=e[n]??{},c=s.coins?[...s.coins]:[],i=c.reduce((d,p)=>(d.set(p.aggregation?p.symbol:p.coinId,p),d),new Map),y=ae({coins:r,walletId:a,walletIdentityMap:o,createdMap:t}),u=new Map,l=[];return y.forEach(d=>{let p=de(d);if(d.aggregation){if(!u.get(d.symbol)){let M={...p,childrenCoin:[]};u.set(d.symbol,M),l.push(M)}u.get(d.symbol).childrenCoin.push(p)}else l.push(p)}),l.forEach(d=>{let p=i.get(d.aggregation?d.symbol:d.coinId);p?p.aggregation&&(p.childrenCoin=(0,me.default)(p.childrenCoin,d.childrenCoin,"coinId")):c.push(d)}),c}m();C();var qe=J({name:"currencySlice",initialState:{coinToUSDRate:{}},reducers:{updateCoinToUSDRate(e,n){e.coinToUSDRate=n.payload}}}),Ne={},ge=e=>e.currencySlice.coinToUSDRate||Ne,{actions:Le,reducer:Ve}=qe,{updateCoinToUSDRate:hn}=Le,In=Ve;O();var b=(e,n)=>n??B(e),ze=(0,h.createSelector)(e=>e.metamask.keyringIdentities,b,(e,n)=>{let r;for(let o=0;o<e.length;o++){let t=e[o];if(t.walletIdentities.find(a=>a.walletId===n)){r=t.keyringIdentityType;break}}return r===ee.PRIVATE_KEY}),He=(0,h.createSelector)(e=>{let{createdMap:n={}}=e.metamask;return n},b,ze,P,(e,n,r,o)=>{if(!r)return new Set([]);let t=e[n]||[];return new Set(t.map(({coinId:s})=>s))}),v=(0,h.createSelector)(He,P,(e,n)=>n.filter(r=>e.has(r.coinId))),K=$(e=>({keyringIdentities:e.metamask.keyringIdentities,createdMap:e.metamask.createdMap}),b,(e,n)=>{let{keyringIdentities:r,createdMap:o}=e;return{walletIdentityMap:ne({metamask:{keyringIdentities:r}}),createdMap:o,walletId:n}}),F=(0,h.createSelector)(b,G,(e,n)=>n?.[e]??[]),Se=(0,h.createSelector)(b,X,(e,n)=>n?.[e]??[]),Ae=(0,h.createSelector)(F,v,(e,n)=>(0,ye.default)(n,e,"coinId")),Je=(e,n,r,o,t)=>{let a=[];return e.forEach(s=>{let c=s.childrenCoin?.length||0,i={...r[s.coinId]??{},...s};if(i.childrenCoin){let y=i.childrenCoin.filter(l=>n.has(l.chainId)).map(l=>({...l,...r[l.coinId]??{}})),u=oe({coins:y,walletId:o,walletIdentityMap:t});if(u.length===0)return;u.length!==c&&Object.assign(i,u[0]),i.childrenCoin=u}else if(!U({coin:i,walletId:o,walletIdentityMap:t})||!n.has(i.chainId))return;a.push(i)}),a};function Qe(e,n,r){e.forEach(o=>{o.childrenCoin?(o.childrenCoin.forEach(t=>{E(t,n,r)}),o.currencyAmountUSD=o.childrenCoin.reduce((t,a)=>a.currencyAmountUSD?S(t,a.currencyAmountUSD):t,"0"),o.currencyAmount=D(o.currencyAmountUSD,r?.usdToThisRate??"1"),o.coinAmount=o.childrenCoin.reduce((t,a)=>S(t,a.coinAmount),"0"),o.coinAmountInt=o.childrenCoin.reduce((t,a)=>S(t,a.coinAmountInt),"0")):E(o,n,r)})}var Ye=(e,n,r,o,t,a,s)=>{let{coins:c,...i}=e,u=Je(c??[],n,r,o,t);return Qe(u,a,s),{...i,coins:u}},pe={},k=(0,h.createSelector)((e,n,r)=>r?{[r.balanceData.walletId]:r.balanceData}:e.metamask.balancesMap??e.balanceSlice.balanceMap,Y,_,Z,K,te,ge,b,(e,n,r,o,t,a,s,c)=>{if(!r||!Object.keys(e).length||!n?.length||Object.values(e)?.[0]?.v!==2)return pe;let{walletIdentityMap:i}=t,y=new Set(n);return Object.entries(e).reduce((u,[l,d])=>(c&&l!==c||(u[l]=Ye(d,y,o,l,i,s,a)),u),{})});m();C();O();function q({networkChainIdSet:e,defaultBaseCoinsCoinIdsSet:n,reducedCoinIdsSet:r,addedCoinIdsSet:o,balanceCoin:t,customFilter:a,isDefault:s,hiddenSmallAssets:c=!0}){let i=e&&!e.has(t.chainId);return r.has(t.coinId)||i||a&&!a(t)?{isFiltered:!0}:c&&z(t.currencyAmountUSD,"1")&&!o.has(t.coinId)&&!n.has(t.coinId)&&!H(t)&&!(s||t.isDefault)?{isSmallCurrency:!0}:{isFiltered:!1,isSmallCurrency:!1}}function qn({isReady:e,networks:n,defaultBaseCoinsCoinIds:r,addedCoins:o,reducedCoins:t,balanceCoins:a,defi:s,nft:c,customFilter:i,hiddenSmallAssets:y=!0}){if(!e)return null;let u="0",l="0",d=new Set(n?.map(({chainId:f})=>f)??[]),p=new Set(r),N=(t??[]).reduce((f,g)=>(f.add(g.coinId),f),new Set),M=(o??[]).reduce((f,g)=>(f.add(g.coinId),f),new Set);function he(f,g){return f.reduce((W,I)=>{if(I.currencyAmountUSD==="0")return W;let{isSmallCurrency:De,isFiltered:we}=q({networkChainIdSet:d,addedCoinIdsSet:M,reducedCoinIdsSet:N,isDefault:g,balanceCoin:I,defaultBaseCoinsCoinIdsSet:p,hiddenSmallAssets:y,customFilter:L=>!L.voucherToken&&(!i||i(L))});return we?W:(De&&(u=S(u,I.currencyAmountUSD)),I?.platformType===0&&(l=S(l,I.currencyAmountUSD)),S(W,I.currencyAmountUSD))},"0")}let Ie=a.reduce((f,g)=>S(f,he(g.childrenCoin?.length?g.childrenCoin:[g],g.default)),"0"),Be=s?s.reduce((f,g)=>i&&!i(g)?f:S(f,g.currencyAmountUSD),"0"):"0",be=c?c.reduce((f,g)=>i&&!i(g)?f:S(f,g.currencyAmountUSD),"0"):"0";return{tokenTotalAssetsUSD:Ie,defiTotalAssetsUSD:Be,nftTotalAssetsUSD:be,smallTotalAssetsUSD:u,platformTotalAssetsUSD:l}}m();C();var w=x(Q());var Yn=(0,w.createSelector)(k,e=>Object.entries(e).reduce((n,[r,o])=>{let a=(o?.coins??[]).reduce((s,c)=>c.childrenCoin?s.concat(c.childrenCoin):s.concat([c]),[]);return n[r]={...o,coins:a},n},{})),Gn=(0,w.createSelector)(k,B,(e,n)=>!Array.isArray(e[n]?.coins)),Ge=(0,w.createSelector)(k,B,Ae,K,fe),Xe=[],Xn=(0,w.createSelector)(e=>Ge(e,B(e)),F,Se,v,re,(e,n,r,o,t)=>{if(!e.length)return Xe;let a=new Set(r?.map(i=>i.coinId)??[]),s=new Set(n?.map(i=>i.coinId)??[]),c=new Set(o.map(i=>i.coinId));return Ce(e,(i,y)=>{let{isFiltered:u,isSmallCurrency:l}=q({defaultBaseCoinsCoinIdsSet:c,addedCoinIdsSet:s,reducedCoinIdsSet:a,balanceCoin:i,isDefault:y,hiddenSmallAssets:t});return!u&&!l})});export{hn as a,In as b,j as c,_e as d,$e as e,ae as f,de as g,He as h,k as i,qn as j,Yn as k,Gn as l,Ge as m,Xn as n};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "prepub";

//# sourceMappingURL=chunk-7Y44NCE5.js.map
