import{a as N$,b as rn,c as om,d as H$,e as uw}from"./chunk-YPETESI6.js";import{a as gT,f as bT}from"./chunk-FUQYZ7CU.js";import{I as yT}from"./chunk-EZDYYM4M.js";import{e as xT}from"./chunk-PUBSTRAA.js";import{h as wT,i as ko}from"./chunk-B6MC7I3C.js";import{j as mT}from"./chunk-HPIF6VQ5.js";import{a as hT,w as pT,x as F$,y as Id,z as Ed}from"./chunk-IQJNUW2D.js";import{a as oT,b as ow,c as Hl,d as cT,e as cw,f as dw,g as fw,h as lw,i as dT,j as fT,k as _s,l as lT}from"./chunk-MZY4QREK.js";import{a as U$,b as sm}from"./chunk-T22ZPYWM.js";import{a as uT,b as im}from"./chunk-Y3TC2HFX.js";import{a as Td,b as am}from"./chunk-CABO2JBZ.js";import{a as v0}from"./chunk-QAMAU5WM.js";import{A as iT,a as sT}from"./chunk-JBYIJGSA.js";import"./chunk-IY45K5V7.js";import{a as Wl}from"./chunk-QKBD2KSL.js";import{a as nm}from"./chunk-VTOQBCNE.js";import{a as iw}from"./chunk-IHPHIDUQ.js";import{a as aT}from"./chunk-H46QXNU2.js";import{a as S9}from"./chunk-IUXU7DTR.js";import{a as i9,b as aw,c as em,e as H5}from"./chunk-MODCVFVL.js";import{a as Cd}from"./chunk-5TLQ2D7N.js";import{c as G5}from"./chunk-KE3QQZYK.js";import{a as E$,f as $5}from"./chunk-5XXRPHJM.js";import{f as V5,g as sw}from"./chunk-YHZPBXHC.js";import"./chunk-ISL2MCWJ.js";import"./chunk-6B2YB6M3.js";import{a as j5}from"./chunk-DMBZQQ63.js";import{a as ba}from"./chunk-WRS2FTF4.js";import{a as B5}from"./chunk-NEFFYVGA.js";import{a as z5}from"./chunk-BLQO46DT.js";import{a as C9}from"./chunk-OUTTG7YQ.js";import"./chunk-LBJYBJBE.js";import{a as tm,b as rm}from"./chunk-LJBCNFS2.js";import{a as Q5,b as eT,c as tT}from"./chunk-WH33YWXJ.js";import{i as Z5}from"./chunk-TWZSLMIY.js";import"./chunk-C64P2PDF.js";import{a as X5}from"./chunk-IXKCAKQY.js";import{a as rT,d as nT}from"./chunk-KUI26AZJ.js";import{b as Z0,d as nw,e as Q0,f as U5,g as qa,h as F5}from"./chunk-E2XQ2FKN.js";import{h as W5,i as K5,p as q5}from"./chunk-GLID42E7.js";import"./chunk-VDMZHNTV.js";import{b as Y5,c as J5}from"./chunk-2E742IIC.js";import{a as D$}from"./chunk-RPYJR5XK.js";import{a as K4,d as q4,e as sA,f as iA,g as oA}from"./chunk-XWSNF46G.js";import{a as w5,b as Yx,c as W$,d as F0}from"./chunk-IQKWUGIV.js";import{a as p5,b as L$,c as pi,d as m5,e as g5,f as b5,g as y5}from"./chunk-TSR6RQYN.js";import{A as ew,B as M5,C as N5,D as R5,E as tw,F as k5,G as O5,H as $n,I as rw,J as Ro,K as D5,L as L5,a as U4,b as Ce,c as Jx,d as On,e as K$,f as q$,g as U,h as S5,i as Qe,j as _5,k as Xx,l as G0,m as Ye,n as A5,o as z0,p as Zx,q as j0,r as V0,s as Y0,t as C5,u as T5,v as J0,w as I5,x as Qx,y as E5,z as P5}from"./chunk-Y6FCLKTO.js";import{a as Pr}from"./chunk-R53OLZPP.js";import{a as _9}from"./chunk-ADKEXOTG.js";import{a as v5,b as H0}from"./chunk-ZFLSYWWA.js";import{a as B$,e as x5}from"./chunk-7PVSIZ6H.js";import{a as vs,b as Oe,d as hi,e as h5,f as Ss}from"./chunk-H7DITLB3.js";import{e as v9}from"./chunk-5NXPDYL5.js";import{a as $0,b as Ad}from"./chunk-2GMLPDYZ.js";import{a as A9,b as Mo,c as Ka,d as E9,e as Kl,f as k0,g as P9,h as M9}from"./chunk-DY54SY5O.js";import{a as X0}from"./chunk-3QMWMJVS.js";import"./chunk-REOQ3O2A.js";import{X as No,a as $x}from"./chunk-VQBK6IHT.js";import{a as n5}from"./chunk-CTT7GD4C.js";import{e as l9}from"./chunk-LQAOHG2H.js";import"./chunk-WNQ6F6VV.js";import"./chunk-LEADLFDQ.js";import{a as _d}from"./chunk-DGK7TBBE.js";import{a as G9}from"./chunk-6Y7ULJF6.js";import{b as a9,c as s9}from"./chunk-3YH3AGVS.js";import{d as a5,e as q0,f as U0}from"./chunk-3LB7TUPB.js";import"./chunk-TK6JYPIW.js";import{a as p9}from"./chunk-OS6E6KVM.js";import{a as jn}from"./chunk-GZRBUDXF.js";import"./chunk-WY46TT4P.js";import{a as fi,i as t9}from"./chunk-MTMUCMTY.js";import{o as s5}from"./chunk-S6N4IJX7.js";import{a as j9}from"./chunk-ZD4EJWX6.js";import{a as Vx,b as ui,c as K0,e as Ul,f as Fl}from"./chunk-WGCZSWYA.js";import{a as x9,b as w9}from"./chunk-IINHHLHP.js";import{b as c5,f as d5,n as f5}from"./chunk-DY2YURLY.js";import"./chunk-KXZSXP3G.js";import{a as r9,d as n9}from"./chunk-6HXVFU7V.js";import{b as i5,c as o5}from"./chunk-D5FMQLJG.js";import{d as Bl}from"./chunk-3I7UBQEQ.js";import{a as O9,b as W9,c as O0,g as z9}from"./chunk-DXRBY5MU.js";import{c as H9}from"./chunk-6FR2UIE7.js";import{a as T9,b as I9}from"./chunk-5GMHHIH5.js";import{A as X9,O as jx,Q as rr,d as Sd,e as V9,f as D0,g as tr,j as $9,k as Y9,n as zx,t as L0,v as J9,x as B0}from"./chunk-7KCWBFQ2.js";import"./chunk-QLUP7GYN.js";import{a as L9,b as B9,c as O$,j as F9}from"./chunk-7Y44NCE5.js";import{d as ql}from"./chunk-BKPOG6ZD.js";import{b as K9,d as R$,e as k$}from"./chunk-OZMVWMFO.js";import{a as D9,c as P$,e as M$}from"./chunk-KTO7CPX7.js";import{a as U9}from"./chunk-P3XTPXPO.js";import{a as l5,b as u5}from"./chunk-S6TPD26J.js";import"./chunk-4IY6P5HR.js";import{a as q9}from"./chunk-FQWGOLDH.js";import{a as r5}from"./chunk-QEPBNPHF.js";import"./chunk-3JLS3TGD.js";import"./chunk-KDP5Z4RF.js";import{a as W0,b as Z9,c as Q9,d as e5,e as t5,f as tn}from"./chunk-W234FNSM.js";import{a as k9}from"./chunk-6NUAAW6O.js";import"./chunk-MO7YHFES.js";import"./chunk-US6RZMUR.js";import{a as Q4,b as Gx,e as vd,f as N9,h as R9}from"./chunk-TUYGHQPT.js";import"./chunk-GVNVILUC.js";import"./chunk-DDO6HXRN.js";import"./chunk-CLWWTOKP.js";import"./chunk-KZ2PCELG.js";import{b as kn}from"./chunk-C7ZG4INB.js";import"./chunk-J5ANWCEO.js";import{a as cA,b as dA,c as _o,d as fA,e as lA}from"./chunk-VMO2INN3.js";import"./chunk-J4TF3RT7.js";import{a as kl,c as E8,d as P8,e as M8,g as S$,h as _$,j as N8,k as R8,q as Fx,t as k8,z as O8}from"./chunk-6FOZGMAL.js";import{$ as AC,$a as M0,A as Q8,B as eC,C as tC,D as rC,E as nC,F as aC,G as sC,H as iC,I as oC,Ia as GC,J as cC,K as dC,L as fC,M as lC,N as uC,Na as zC,O as hC,P as pC,Q as mC,Qa as jC,R as T0,Ra as VC,S as gC,Sa as $C,T as bC,U as I0,V as yC,Va as E0,W as xC,X as wC,Y as vC,Ya as P0,Z as SC,Za as YC,_ as _C,_a as JC,a as Vn,aa as CC,ab as XC,b as _0,ba as TC,bb as ZC,c as A0,ca as IC,cb as QC,d as q8,da as EC,db as e9,e as C0,ea as PC,f as U8,fa as MC,g as F8,ga as NC,h as H8,ha as RC,i as G8,ia as kC,ja as OC,k as z8,ka as DC,l as j8,m as V8,oa as LC,qa as BC,ra as WC,sa as KC,ta as qC,u as $8,ua as UC,v as Y8,va as FC,w as J8,wa as HC,x as X8,y as Z8,z as hd}from"./chunk-2MV3WEYP.js";import{A as XA,Ab as C8,B as od,Bb as T8,C as Bx,F as o0,Ga as Ux,Ha as o8,I as b$,Ia as c8,Ja as To,Ka as d8,Ma as dd,Na as f8,Oa as h0,Qa as x0,S as y$,Sa as g8,Ta as Rl,Ua as b8,Va as y8,X as x$,Xa as x8,Ya as w8,_ as w$,a as i$,db as v8,gb as S8,hb as di,ib as w0,la as v$,n as Gc,qb as _8,ra as ZA,s as U_,sa as QA,v as zc,va as c0,wa as ms,wb as A8,x as F_,y as ni,ya as d0}from"./chunk-HPXM6RSK.js";import{f as Ll,t as R0,v as wd}from"./chunk-NAI3K3VA.js";import"./chunk-56PELQWI.js";import{A as ii,B as qe,C as u8,D as g0,E as Te,F as Io,G as b0,H as oe,I as Kt,J as $r,K as ze,L as Wa,M as ga,N as bs,O as ys,P as br,Q as hn,R as ld,S as y0,T as Ze,U as oi,V as h8,W as ci,aa as ud,b as Er,ha as yr,ia as p8,ja as m8,k as fd,m as Nl,n as p0,v as si,x as l8,y as m0,z as gs}from"./chunk-IUIJ46C3.js";import{a as T$}from"./chunk-2RF4WEQ2.js";import{a as li,b as en,c as Ar}from"./chunk-XRXUVH6X.js";import"./chunk-KZ3ZU675.js";import{a as ai}from"./chunk-NJ5CWPUY.js";import{a as xd}from"./chunk-UH5YBH76.js";import{a as I$}from"./chunk-SLWN4ZJ3.js";import"./chunk-CGQV4V24.js";import{a as y9}from"./chunk-4X3PZECG.js";import{a as Fc,b as Ba,c as I_,d as n0,h as o9,i as c9,m as d9,p as f9}from"./chunk-UMJMJOW4.js";import"./chunk-YTJBYVBO.js";import{I as eA,J as tA,T as rA,U as nA,V as aA,X as g$,a as H_,d as G_,g as z_,h as j_,i as V_,j as $_,k as Y_,l as J_,m as X_,p as Z_,q as Q_}from"./chunk-QO3243S4.js";import{a as Fr}from"./chunk-O5JCC6KG.js";import{a as n$,b as E_,d as So,f as a0}from"./chunk-MAIAJ7GD.js";import{a as Ol,b as xs,c as pd,d as Eo,e as md,f as u9,g as h9}from"./chunk-4PGNX6E2.js";import{a as Qr}from"./chunk-DYBOX26H.js";import{a as B_}from"./chunk-XS4U5RGC.js";import{a as L_}from"./chunk-LNUUUDMO.js";import{a as s0}from"./chunk-GSXTJZO5.js";import"./chunk-2J5LX6I7.js";import{a as K_,b as q_}from"./chunk-364UZEKZ.js";import"./chunk-DBHB6SUD.js";import{a as g9}from"./chunk-6N2MHXTJ.js";import{a as b9}from"./chunk-3Z22DWGV.js";import{a as A$,b as C$}from"./chunk-6UYK5TIR.js";import"./chunk-I56VJWE4.js";import{a as Dl,b as bd,c as yd}from"./chunk-PS3S6BG3.js";import{j as N0}from"./chunk-RT4Y2U5N.js";import{b as Po,c as gd,d as Hx}from"./chunk-2VHH444P.js";import{a as $e,b as ws}from"./chunk-RIMU4JTV.js";import{c as Dx}from"./chunk-MGLVPWSV.js";import{$ as ad,A as Xc,B as IA,C as EA,D as zn,E as PA,F as MA,G as Zc,H as NA,I as RA,J as Ao,K as kA,L as OA,M as Qc,N as DA,O as LA,P as ed,Q as BA,R as WA,S as td,T as KA,U as qA,V as rd,W as UA,X as FA,Y as nd,Z as HA,_ as GA,a as Z4,aa as zA,b as ft,ba as jA,c as Gn,ca as sd,d as i0,da as VA,e as uA,ea as $A,f as wn,fa as id,g as hA,ga as YA,h as pA,ha as JA,i as jc,ia as ps,j as mA,k as gA,l as Rn,m as bA,n as yA,o as Vc,p as xA,q as wA,r as $c,s as vA,t as SA,u as Yc,v as _A,w as AA,x as Jc,y as CA,z as TA}from"./chunk-TXKWPME2.js";import{k as W_}from"./chunk-LF5ATXQA.js";import"./chunk-4D3M2I6W.js";import{a as D8,b as S0,d as L8,f as B8,g as W8,i as K8}from"./chunk-AMVK42SC.js";import{a as I8}from"./chunk-D6RIE45O.js";import{g as m9}from"./chunk-XCAARJ7Q.js";import{c as Lx}from"./chunk-JXCCIV3J.js";import{a as T_,b as ce,c as ur}from"./chunk-AOA7NX2Y.js";import{a as e_,b as e$,c as Nx,d as qc,e as Qp,g as zr,h as Cl,j as Pe,k as Tl,l as Uc,m as Wt}from"./chunk-HXZH2DHB.js";import{a as h_,b as p_,c as t$}from"./chunk-MZG4RHXJ.js";import{a as Jp,b as Xp,c as l_,d as Zp,e as u_,f as wo,g as Kc}from"./chunk-VTST2UXT.js";import{$ as s_,$a as f_,$b as S_,Ac as r8,Bc as Kx,Ca as J,Cc as Vr,Da as Cx,Dc as n8,E as ds,Ea as ke,Ec as f0,F as go,Fa as Pn,Fc as cd,G as fs,Ga as Un,Gc as $,H as xn,Ha as Gp,Hc as ue,I as Gr,Ic as a8,J as qn,Jc as fe,K as Qs,Kb as Hn,L as bo,La as Lc,Lb as g_,M as ln,Ma as Bc,Mb as b_,N as er,Na as us,Nb as y_,O as t_,Oa as zp,Ob as Rx,Oc as l0,Pa as jp,Pb as x_,Q as r_,Qa as Vp,Qb as w_,Qc as qx,R as n_,Rb as v_,Rc as s8,Sa as st,Sc as u0,Ta as me,Tb as Xe,Tc as i8,Ua as yo,Va as $p,Wb as un,Xa as Al,Xb as r0,Yb as r$,Z as ei,Za as Wc,Zb as hs,_ as a_,_a as Tx,_b as ti,a as Ae,aa as i_,ab as Ix,ac as gr,b as An,ba as Hp,bb as Ex,bc as vo,c as ma,cb as xo,cc as Me,d as xe,db as Yp,dc as __,e as Cn,eb as Px,ec as ri,f as os,fb as Mn,gb as Mx,gc as A_,h as vx,hb as ae,i as Xs,ib as Nn,ic as C_,j as W4,ja as o_,jc as Ge,kb as Fn,kc as R_,la as _l,m as te,ma as c_,na as ls,nb as e0,o as _r,oa as Ax,ob as m_,p as La,pb as t0,q as pe,qa as Dc,r as po,s as mo,t as En,tc as de,u as kc,ub as Il,v as Fp,va as d_,vc as e8,wc as Co,xc as Wx,yc as Ml,z as Oc,za as ne,zc as t8}from"./chunk-X7YMANPZ.js";import"./chunk-IRITFTWC.js";import{F as In,G as X4,H as Sl,a as QV,b as $4,c as Y4,g as Sx,j as J4,n as cs,q as _x,x as vl}from"./chunk-SOHTSUTI.js";import{A as j4,B as Hr,I as Tn,c as qp,i as F4,m as Up,p as H4,u as G4,v as z4,w as Qt}from"./chunk-RPZQDAIQ.js";import{a as yn}from"./chunk-LDRI4AYU.js";import"./chunk-4BSSOYU2.js";import"./chunk-ZAMSVR5I.js";import"./chunk-WZLED2TE.js";import"./chunk-E76NZO7M.js";import"./chunk-E24EBHFY.js";import"./chunk-P7E2TFMB.js";import"./chunk-Z2Q6BVZR.js";import"./chunk-FXOB5EDP.js";import"./chunk-FJEX4Z7I.js";import{a as m$}from"./chunk-W2IFVRPM.js";import{a as D_}from"./chunk-IWRH5BN5.js";import"./chunk-F3HP56Z5.js";import{Y as wl,c as V4,z as xl}from"./chunk-V4F2JFTP.js";import{a as Zt,g as yl}from"./chunk-6DDC4Y2S.js";import{a as O_}from"./chunk-JG7TO24X.js";import{a as p$}from"./chunk-3M27KURG.js";import{a as h$}from"./chunk-FGI37OSR.js";import{a as u$,b as Ox}from"./chunk-TEY24VZN.js";import"./chunk-RKHQOOTU.js";import{a as Hc}from"./chunk-KJOC4LFM.js";import{a as Pl,b as M_,c as a$,d as s$,e as N_}from"./chunk-6FDO4Y56.js";import"./chunk-NNZ5SU5W.js";import{a as l$}from"./chunk-F4JTGWJH.js";import"./chunk-MXK76QOX.js";import"./chunk-E7VUKZVU.js";import"./chunk-ZALGQC7G.js";import"./chunk-4OUGL4WS.js";import{a as jr,b as P_,c as El}from"./chunk-YUXYCITH.js";import"./chunk-B323DWMU.js";import"./chunk-JM2ML6BR.js";import"./chunk-33GQ3EEQ.js";import"./chunk-LJWKNDPR.js";import"./chunk-GBSH5BA3.js";import"./chunk-RMV3AS5X.js";import"./chunk-DQNWCSAJ.js";import"./chunk-2WNGMZUB.js";import"./chunk-A77VZBWT.js";import{a as kx,b as c$,c as d$}from"./chunk-IYL2DA3V.js";import"./chunk-MYDAWE3K.js";import"./chunk-3NG42BBY.js";import"./chunk-QYTYSNLW.js";import{a as k_}from"./chunk-QMAXXJCA.js";import{a as f$}from"./chunk-HFBVRVPB.js";import{b as o$}from"./chunk-SF2LTPAC.js";import{a as Zs}from"./chunk-TEKDZ77C.js";import{A as JV,C as O4,D as mr,E as Wp,F as D4,G as XV,H as ZV,I as Kp,J as L4,L as B4,a as ho,b as N4,c as Tr,d as ge,e as Ir,f as Be,g as Rc,h as Da,k as gl,l as R4,m as Lp,o as xx,t as YV,u as Bp,v as k4,w as bl,z as wx}from"./chunk-NC54RUAI.js";import{d as Dp}from"./chunk-YR74Q3QD.js";import{b as VV,c as D,d as yx,f as _,g as $V,h as le,l as process,m as d,n as p,o as f}from"./chunk-EQYVU4XP.js";var YT=D((ume,$T)=>{d();f();function lY(r,e,t){var n=-1,a=r.length;e<0&&(e=-e>a?0:a+e),t=t>a?a:t,t<0&&(t+=a),a=e>t?0:t-e>>>0,e>>>=0;for(var s=Array(a);++n<a;)s[n]=r[n+e];return s}$T.exports=lY});var Aw=D((mme,JT)=>{d();f();var uY=YT(),hY=E$(),pY=O9(),mY=Math.ceil,gY=Math.max;function bY(r,e,t){(t?hY(r,e,t):e===void 0)?e=1:e=gY(pY(e),0);var n=r==null?0:r.length;if(!n||e<1)return[];for(var a=0,s=0,i=Array(mY(n/e));a<n;)i[s++]=uY(r,a,a+=e);return i}JT.exports=bY});var iE=D(_m=>{"use strict";d();f();Object.defineProperty(_m,"__esModule",{value:!0});_m.storeAsStream=void 0;var GY=bl(),Hw=class extends GY.Duplex{constructor(e){super({objectMode:!0}),this.resume(),this.handler=t=>this.push(t),this.obsStore=e,this.obsStore.subscribe(this.handler)}pipe(e,t){let n=super.pipe(e,t);return e.write(this.obsStore.getState()),n}_write(e,t,n){this.obsStore.putState(e),n()}_read(e){}_destroy(e,t){this.obsStore.unsubscribe(this.handler),super._destroy(e,t)}};function zY(r){return new Hw(r)}_m.storeAsStream=zY});var cE=D(zw=>{"use strict";d();f();Object.defineProperty(zw,"__esModule",{value:!0});var jY=Rc();function oE(r,e,t){try{Reflect.apply(r,e,t)}catch(n){setTimeout(()=>{throw n})}}function VY(r){let e=r.length,t=new Array(e);for(let n=0;n<e;n+=1)t[n]=r[n];return t}var Gw=class extends jY.EventEmitter{emit(e,...t){let n=e==="error",a=this._events;if(a!==void 0)n=n&&a.error===void 0;else if(!n)return!1;if(n){let i;if(t.length>0&&([i]=t),i instanceof Error)throw i;let o=new Error(`Unhandled error.${i?` (${i.message})`:""}`);throw o.context=i,o}let s=a[e];if(s===void 0)return!1;if(typeof s=="function")oE(s,this,t);else{let i=s.length,o=VY(s);for(let c=0;c<i;c+=1)oE(o[c],this,t)}return!0}};zw.default=Gw});var Zl=D(Rd=>{"use strict";d();f();var $Y=Rd&&Rd.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Rd,"__esModule",{value:!0});Rd.ObservableStore=void 0;var YY=$Y(cE()),jw=class extends YY.default{constructor(e={}){super(),this._state=e}getState(){return this._getState()}putState(e,t=!0){this._putState(e),t&&this.emit("update",e)}updateState(e,t=!0){if(e&&typeof e=="object"){let n=this.getState(),a=Object.assign({},n,e);this.putState(a,t)}else this.putState(e,t)}subscribe(e){this.on("update",e)}unsubscribe(e){this.removeListener("update",e)}_getState(){return this._state}_putState(e){this._state=e}};Rd.ObservableStore=jw});var dE=D(Am=>{"use strict";d();f();Object.defineProperty(Am,"__esModule",{value:!0});Am.ComposedStore=void 0;var JY=Zl(),Vw=class extends JY.ObservableStore{constructor(e){super(),this.getState()||this.putState({}),this._children=e||{},Object.keys(this._children).forEach(n=>{let a=this._children[n];this._addChild(n,a)})}_addChild(e,t){let n=a=>{let s=this.getState();s[e]=a,this.putState(s)};t.subscribe(n),n(t.getState())}};Am.ComposedStore=Vw});var fE=D(Cm=>{"use strict";d();f();Object.defineProperty(Cm,"__esModule",{value:!0});Cm.LocalStorageStore=void 0;var XY=Zl(),$w=class extends XY.ObservableStore{constructor(e={}){if(!globalThis.localStorage)throw new Error("LocalStorageStore - can't find localStorage.");if(super(),!e.storageKey)throw new Error("LocalStorageStore - no storageKey specified.");this._storageKey=e.storageKey}_getState(){let e=globalThis.localStorage.getItem(this._storageKey);return e?JSON.parse(e):void 0}_putState(e){let t=JSON.stringify(e);return globalThis.localStorage.setItem(this._storageKey,t)}};Cm.LocalStorageStore=$w});var lE=D(Tm=>{"use strict";d();f();Object.defineProperty(Tm,"__esModule",{value:!0});Tm.MergedStore=void 0;var ZY=Zl(),Yw=class extends ZY.ObservableStore{constructor(e=[]){super(),this.getState()||this.putState({}),this._children=e,e.forEach(n=>this._addChild(n)),this._updateWholeState()}_addChild(e){e.subscribe(()=>this._updateWholeState())}_updateWholeState(){let e=this._children.map(n=>n.getState()),t=Object.assign({},...e);this.putState(t)}};Tm.MergedStore=Yw});var Ql=D((Dwe,Jw)=>{"use strict";d();f();typeof process>"u"||!process.version||process.version.indexOf("v0.")===0||process.version.indexOf("v1.")===0&&process.version.indexOf("v1.8.")!==0?Jw.exports={nextTick:QY}:Jw.exports=process;function QY(r,e,t,n){if(typeof r!="function")throw new TypeError('"callback" argument must be a function');var a=arguments.length,s,i;switch(a){case 0:case 1:return process.nextTick(r);case 2:return process.nextTick(function(){r.call(null,e)});case 3:return process.nextTick(function(){r.call(null,e,t)});case 4:return process.nextTick(function(){r.call(null,e,t,n)});default:for(s=new Array(a-1),i=0;i<s.length;)s[i++]=arguments[i];return process.nextTick(function(){r.apply(null,s)})}}});var hE=D((Wwe,uE)=>{d();f();var eJ={}.toString;uE.exports=Array.isArray||function(r){return eJ.call(r)=="[object Array]"}});var Xw=D((Uwe,pE)=>{d();f();pE.exports=Rc().EventEmitter});var eu=D((Zw,gE)=>{d();f();var Im=Dp(),Cs=Im.Buffer;function mE(r,e){for(var t in r)e[t]=r[t]}Cs.from&&Cs.alloc&&Cs.allocUnsafe&&Cs.allocUnsafeSlow?gE.exports=Im:(mE(Im,Zw),Zw.Buffer=kd);function kd(r,e,t){return Cs(r,e,t)}mE(Cs,kd);kd.from=function(r,e,t){if(typeof r=="number")throw new TypeError("Argument must not be a number");return Cs(r,e,t)};kd.alloc=function(r,e,t){if(typeof r!="number")throw new TypeError("Argument must be a number");var n=Cs(r);return e!==void 0?typeof t=="string"?n.fill(e,t):n.fill(e):n.fill(0),n};kd.allocUnsafe=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return Cs(r)};kd.allocUnsafeSlow=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return Im.SlowBuffer(r)}});var yE=D((jwe,Qw)=>{"use strict";d();f();function tJ(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}var bE=eu().Buffer,tu=Bp();function rJ(r,e,t){r.copy(e,t)}Qw.exports=function(){function r(){tJ(this,r),this.head=null,this.tail=null,this.length=0}return r.prototype.push=function(t){var n={data:t,next:null};this.length>0?this.tail.next=n:this.head=n,this.tail=n,++this.length},r.prototype.unshift=function(t){var n={data:t,next:this.head};this.length===0&&(this.tail=n),this.head=n,++this.length},r.prototype.shift=function(){if(this.length!==0){var t=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},r.prototype.clear=function(){this.head=this.tail=null,this.length=0},r.prototype.join=function(t){if(this.length===0)return"";for(var n=this.head,a=""+n.data;n=n.next;)a+=t+n.data;return a},r.prototype.concat=function(t){if(this.length===0)return bE.alloc(0);if(this.length===1)return this.head.data;for(var n=bE.allocUnsafe(t>>>0),a=this.head,s=0;a;)rJ(a.data,n,s),s+=a.data.length,a=a.next;return n},r}();tu&&tu.inspect&&tu.inspect.custom&&(Qw.exports.prototype[tu.inspect.custom]=function(){var r=tu.inspect({length:this.length});return this.constructor.name+" "+r})});var ev=D((Ywe,vE)=>{"use strict";d();f();var xE=Ql();function nJ(r,e){var t=this,n=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;return n||a?(e?e(r):r&&(!this._writableState||!this._writableState.errorEmitted)&&xE.nextTick(wE,this,r),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(r||null,function(s){!e&&s?(xE.nextTick(wE,t,s),t._writableState&&(t._writableState.errorEmitted=!0)):e&&e(s)}),this)}function aJ(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function wE(r,e){r.emit("error",e)}vE.exports={destroy:nJ,undestroy:aJ}});var rv=D((Zwe,PE)=>{"use strict";d();f();var Do=Ql();PE.exports=xr;function _E(r){var e=this;this.next=null,this.entry=null,this.finish=function(){SJ(e,r)}}var sJ=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:Do.nextTick,Od;xr.WritableState=nu;var AE=Object.create(Da());AE.inherits=Tr();var iJ={deprecate:k4()},CE=Xw(),Pm=eu().Buffer,oJ=globalThis.Uint8Array||function(){};function cJ(r){return Pm.from(r)}function dJ(r){return Pm.isBuffer(r)||r instanceof oJ}var TE=ev();AE.inherits(xr,CE);function fJ(){}function nu(r,e){Od=Od||Lo(),r=r||{};var t=e instanceof Od;this.objectMode=!!r.objectMode,t&&(this.objectMode=this.objectMode||!!r.writableObjectMode);var n=r.highWaterMark,a=r.writableHighWaterMark,s=this.objectMode?16:16*1024;n||n===0?this.highWaterMark=n:t&&(a||a===0)?this.highWaterMark=a:this.highWaterMark=s,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var i=r.decodeStrings===!1;this.decodeStrings=!i,this.defaultEncoding=r.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(o){bJ(e,o)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new _E(this)}nu.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t};(function(){try{Object.defineProperty(nu.prototype,"buffer",{get:iJ.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var Em;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(Em=Function.prototype[Symbol.hasInstance],Object.defineProperty(xr,Symbol.hasInstance,{value:function(r){return Em.call(this,r)?!0:this!==xr?!1:r&&r._writableState instanceof nu}})):Em=function(r){return r instanceof this};function xr(r){if(Od=Od||Lo(),!Em.call(xr,this)&&!(this instanceof Od))return new xr(r);this._writableState=new nu(r,this),this.writable=!0,r&&(typeof r.write=="function"&&(this._write=r.write),typeof r.writev=="function"&&(this._writev=r.writev),typeof r.destroy=="function"&&(this._destroy=r.destroy),typeof r.final=="function"&&(this._final=r.final)),CE.call(this)}xr.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function lJ(r,e){var t=new Error("write after end");r.emit("error",t),Do.nextTick(e,t)}function uJ(r,e,t,n){var a=!0,s=!1;return t===null?s=new TypeError("May not write null values to stream"):typeof t!="string"&&t!==void 0&&!e.objectMode&&(s=new TypeError("Invalid non-string/buffer chunk")),s&&(r.emit("error",s),Do.nextTick(n,s),a=!1),a}xr.prototype.write=function(r,e,t){var n=this._writableState,a=!1,s=!n.objectMode&&dJ(r);return s&&!Pm.isBuffer(r)&&(r=cJ(r)),typeof e=="function"&&(t=e,e=null),s?e="buffer":e||(e=n.defaultEncoding),typeof t!="function"&&(t=fJ),n.ended?lJ(this,t):(s||uJ(this,n,r,t))&&(n.pendingcb++,a=pJ(this,n,s,r,e,t)),a};xr.prototype.cork=function(){var r=this._writableState;r.corked++};xr.prototype.uncork=function(){var r=this._writableState;r.corked&&(r.corked--,!r.writing&&!r.corked&&!r.finished&&!r.bufferProcessing&&r.bufferedRequest&&IE(this,r))};xr.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this};function hJ(r,e,t){return!r.objectMode&&r.decodeStrings!==!1&&typeof e=="string"&&(e=Pm.from(e,t)),e}Object.defineProperty(xr.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function pJ(r,e,t,n,a,s){if(!t){var i=hJ(e,n,a);n!==i&&(t=!0,a="buffer",n=i)}var o=e.objectMode?1:n.length;e.length+=o;var c=e.length<e.highWaterMark;if(c||(e.needDrain=!0),e.writing||e.corked){var l=e.lastBufferedRequest;e.lastBufferedRequest={chunk:n,encoding:a,isBuf:t,callback:s,next:null},l?l.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else tv(r,e,!1,o,n,a,s);return c}function tv(r,e,t,n,a,s,i){e.writelen=n,e.writecb=i,e.writing=!0,e.sync=!0,t?r._writev(a,e.onwrite):r._write(a,s,e.onwrite),e.sync=!1}function mJ(r,e,t,n,a){--e.pendingcb,t?(Do.nextTick(a,n),Do.nextTick(ru,r,e),r._writableState.errorEmitted=!0,r.emit("error",n)):(a(n),r._writableState.errorEmitted=!0,r.emit("error",n),ru(r,e))}function gJ(r){r.writing=!1,r.writecb=null,r.length-=r.writelen,r.writelen=0}function bJ(r,e){var t=r._writableState,n=t.sync,a=t.writecb;if(gJ(t),e)mJ(r,t,n,e,a);else{var s=EE(t);!s&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&IE(r,t),n?sJ(SE,r,t,s,a):SE(r,t,s,a)}}function SE(r,e,t,n){t||yJ(r,e),e.pendingcb--,n(),ru(r,e)}function yJ(r,e){e.length===0&&e.needDrain&&(e.needDrain=!1,r.emit("drain"))}function IE(r,e){e.bufferProcessing=!0;var t=e.bufferedRequest;if(r._writev&&t&&t.next){var n=e.bufferedRequestCount,a=new Array(n),s=e.corkedRequestsFree;s.entry=t;for(var i=0,o=!0;t;)a[i]=t,t.isBuf||(o=!1),t=t.next,i+=1;a.allBuffers=o,tv(r,e,!0,e.length,a,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new _E(e),e.bufferedRequestCount=0}else{for(;t;){var c=t.chunk,l=t.encoding,u=t.callback,h=e.objectMode?1:c.length;if(tv(r,e,!1,h,c,l,u),t=t.next,e.bufferedRequestCount--,e.writing)break}t===null&&(e.lastBufferedRequest=null)}e.bufferedRequest=t,e.bufferProcessing=!1}xr.prototype._write=function(r,e,t){t(new Error("_write() is not implemented"))};xr.prototype._writev=null;xr.prototype.end=function(r,e,t){var n=this._writableState;typeof r=="function"?(t=r,r=null,e=null):typeof e=="function"&&(t=e,e=null),r!=null&&this.write(r,e),n.corked&&(n.corked=1,this.uncork()),!n.ending&&!n.finished&&vJ(this,n,t)};function EE(r){return r.ending&&r.length===0&&r.bufferedRequest===null&&!r.finished&&!r.writing}function xJ(r,e){r._final(function(t){e.pendingcb--,t&&r.emit("error",t),e.prefinished=!0,r.emit("prefinish"),ru(r,e)})}function wJ(r,e){!e.prefinished&&!e.finalCalled&&(typeof r._final=="function"?(e.pendingcb++,e.finalCalled=!0,Do.nextTick(xJ,r,e)):(e.prefinished=!0,r.emit("prefinish")))}function ru(r,e){var t=EE(e);return t&&(wJ(r,e),e.pendingcb===0&&(e.finished=!0,r.emit("finish"))),t}function vJ(r,e,t){e.ending=!0,ru(r,e),t&&(e.finished?Do.nextTick(t):r.once("finish",t)),e.ended=!0,r.writable=!1}function SJ(r,e,t){var n=r.entry;for(r.entry=null;n;){var a=n.callback;e.pendingcb--,a(t),n=n.next}e.corkedRequestsFree?e.corkedRequestsFree.next=r:e.corkedRequestsFree=r}Object.defineProperty(xr.prototype,"destroyed",{get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(r){!this._writableState||(this._writableState.destroyed=r)}});xr.prototype.destroy=TE.destroy;xr.prototype._undestroy=TE.undestroy;xr.prototype._destroy=function(r,e){this.end(),e(r)}});var Lo=D((tve,kE)=>{"use strict";d();f();var ME=Ql(),_J=Object.keys||function(r){var e=[];for(var t in r)e.push(t);return e};kE.exports=Ts;var NE=Object.create(Da());NE.inherits=Tr();var RE=sv(),av=rv();NE.inherits(Ts,RE);for(nv=_J(av.prototype),Mm=0;Mm<nv.length;Mm++)Nm=nv[Mm],Ts.prototype[Nm]||(Ts.prototype[Nm]=av.prototype[Nm]);var nv,Nm,Mm;function Ts(r){if(!(this instanceof Ts))return new Ts(r);RE.call(this,r),av.call(this,r),r&&r.readable===!1&&(this.readable=!1),r&&r.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,r&&r.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",AJ)}Object.defineProperty(Ts.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function AJ(){this.allowHalfOpen||this._writableState.ended||ME.nextTick(CJ,this)}function CJ(r){r.end()}Object.defineProperty(Ts.prototype,"destroyed",{get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(r){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=r,this._writableState.destroyed=r)}});Ts.prototype._destroy=function(r,e){this.push(null),this.end(),ME.nextTick(e,r)}});var cv=D(DE=>{"use strict";d();f();var ov=eu().Buffer,OE=ov.isEncoding||function(r){switch(r=""+r,r&&r.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function TJ(r){if(!r)return"utf8";for(var e;;)switch(r){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return r;default:if(e)return;r=(""+r).toLowerCase(),e=!0}}function IJ(r){var e=TJ(r);if(typeof e!="string"&&(ov.isEncoding===OE||!OE(r)))throw new Error("Unknown encoding: "+r);return e||r}DE.StringDecoder=au;function au(r){this.encoding=IJ(r);var e;switch(this.encoding){case"utf16le":this.text=kJ,this.end=OJ,e=4;break;case"utf8":this.fillLast=MJ,e=4;break;case"base64":this.text=DJ,this.end=LJ,e=3;break;default:this.write=BJ,this.end=WJ;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=ov.allocUnsafe(e)}au.prototype.write=function(r){if(r.length===0)return"";var e,t;if(this.lastNeed){if(e=this.fillLast(r),e===void 0)return"";t=this.lastNeed,this.lastNeed=0}else t=0;return t<r.length?e?e+this.text(r,t):this.text(r,t):e||""};au.prototype.end=RJ;au.prototype.text=NJ;au.prototype.fillLast=function(r){if(this.lastNeed<=r.length)return r.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);r.copy(this.lastChar,this.lastTotal-this.lastNeed,0,r.length),this.lastNeed-=r.length};function iv(r){return r<=127?0:r>>5===6?2:r>>4===14?3:r>>3===30?4:r>>6===2?-1:-2}function EJ(r,e,t){var n=e.length-1;if(n<t)return 0;var a=iv(e[n]);return a>=0?(a>0&&(r.lastNeed=a-1),a):--n<t||a===-2?0:(a=iv(e[n]),a>=0?(a>0&&(r.lastNeed=a-2),a):--n<t||a===-2?0:(a=iv(e[n]),a>=0?(a>0&&(a===2?a=0:r.lastNeed=a-3),a):0))}function PJ(r,e,t){if((e[0]&192)!==128)return r.lastNeed=0,"\uFFFD";if(r.lastNeed>1&&e.length>1){if((e[1]&192)!==128)return r.lastNeed=1,"\uFFFD";if(r.lastNeed>2&&e.length>2&&(e[2]&192)!==128)return r.lastNeed=2,"\uFFFD"}}function MJ(r){var e=this.lastTotal-this.lastNeed,t=PJ(this,r,e);if(t!==void 0)return t;if(this.lastNeed<=r.length)return r.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);r.copy(this.lastChar,e,0,r.length),this.lastNeed-=r.length}function NJ(r,e){var t=EJ(this,r,e);if(!this.lastNeed)return r.toString("utf8",e);this.lastTotal=t;var n=r.length-(t-this.lastNeed);return r.copy(this.lastChar,0,n),r.toString("utf8",e,n)}function RJ(r){var e=r&&r.length?this.write(r):"";return this.lastNeed?e+"\uFFFD":e}function kJ(r,e){if((r.length-e)%2===0){var t=r.toString("utf16le",e);if(t){var n=t.charCodeAt(t.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=r[r.length-2],this.lastChar[1]=r[r.length-1],t.slice(0,-1)}return t}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=r[r.length-1],r.toString("utf16le",e,r.length-1)}function OJ(r){var e=r&&r.length?this.write(r):"";if(this.lastNeed){var t=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,t)}return e}function DJ(r,e){var t=(r.length-e)%3;return t===0?r.toString("base64",e):(this.lastNeed=3-t,this.lastTotal=3,t===1?this.lastChar[0]=r[r.length-1]:(this.lastChar[0]=r[r.length-2],this.lastChar[1]=r[r.length-1]),r.toString("base64",e,r.length-t))}function LJ(r){var e=r&&r.length?this.write(r):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function BJ(r){return r.toString(this.encoding)}function WJ(r){return r&&r.length?this.write(r):""}});var sv=D((cve,VE)=>{"use strict";d();f();var Ld=Ql();VE.exports=lt;var KJ=hE(),su;lt.ReadableState=FE;var ove=Rc().EventEmitter,KE=function(r,e){return r.listeners(e).length},hv=Xw(),iu=eu().Buffer,qJ=globalThis.Uint8Array||function(){};function UJ(r){return iu.from(r)}function FJ(r){return iu.isBuffer(r)||r instanceof qJ}var qE=Object.create(Da());qE.inherits=Tr();var dv=Bp(),Ue=void 0;dv&&dv.debuglog?Ue=dv.debuglog("stream"):Ue=function(){};var HJ=yE(),UE=ev(),Dd;qE.inherits(lt,hv);var fv=["error","close","destroy","pause","resume"];function GJ(r,e,t){if(typeof r.prependListener=="function")return r.prependListener(e,t);!r._events||!r._events[e]?r.on(e,t):KJ(r._events[e])?r._events[e].unshift(t):r._events[e]=[t,r._events[e]]}function FE(r,e){su=su||Lo(),r=r||{};var t=e instanceof su;this.objectMode=!!r.objectMode,t&&(this.objectMode=this.objectMode||!!r.readableObjectMode);var n=r.highWaterMark,a=r.readableHighWaterMark,s=this.objectMode?16:16*1024;n||n===0?this.highWaterMark=n:t&&(a||a===0)?this.highWaterMark=a:this.highWaterMark=s,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new HJ,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=r.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,r.encoding&&(Dd||(Dd=cv().StringDecoder),this.decoder=new Dd(r.encoding),this.encoding=r.encoding)}function lt(r){if(su=su||Lo(),!(this instanceof lt))return new lt(r);this._readableState=new FE(r,this),this.readable=!0,r&&(typeof r.read=="function"&&(this._read=r.read),typeof r.destroy=="function"&&(this._destroy=r.destroy)),hv.call(this)}Object.defineProperty(lt.prototype,"destroyed",{get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(r){!this._readableState||(this._readableState.destroyed=r)}});lt.prototype.destroy=UE.destroy;lt.prototype._undestroy=UE.undestroy;lt.prototype._destroy=function(r,e){this.push(null),e(r)};lt.prototype.push=function(r,e){var t=this._readableState,n;return t.objectMode?n=!0:typeof r=="string"&&(e=e||t.defaultEncoding,e!==t.encoding&&(r=iu.from(r,e),e=""),n=!0),HE(this,r,e,!1,n)};lt.prototype.unshift=function(r){return HE(this,r,null,!0,!1)};function HE(r,e,t,n,a){var s=r._readableState;if(e===null)s.reading=!1,$J(r,s);else{var i;a||(i=zJ(s,e)),i?r.emit("error",i):s.objectMode||e&&e.length>0?(typeof e!="string"&&!s.objectMode&&Object.getPrototypeOf(e)!==iu.prototype&&(e=UJ(e)),n?s.endEmitted?r.emit("error",new Error("stream.unshift() after end event")):lv(r,s,e,!0):s.ended?r.emit("error",new Error("stream.push() after EOF")):(s.reading=!1,s.decoder&&!t?(e=s.decoder.write(e),s.objectMode||e.length!==0?lv(r,s,e,!1):GE(r,s)):lv(r,s,e,!1))):n||(s.reading=!1)}return jJ(s)}function lv(r,e,t,n){e.flowing&&e.length===0&&!e.sync?(r.emit("data",t),r.read(0)):(e.length+=e.objectMode?1:t.length,n?e.buffer.unshift(t):e.buffer.push(t),e.needReadable&&Rm(r)),GE(r,e)}function zJ(r,e){var t;return!FJ(e)&&typeof e!="string"&&e!==void 0&&!r.objectMode&&(t=new TypeError("Invalid non-string/buffer chunk")),t}function jJ(r){return!r.ended&&(r.needReadable||r.length<r.highWaterMark||r.length===0)}lt.prototype.isPaused=function(){return this._readableState.flowing===!1};lt.prototype.setEncoding=function(r){return Dd||(Dd=cv().StringDecoder),this._readableState.decoder=new Dd(r),this._readableState.encoding=r,this};var LE=8388608;function VJ(r){return r>=LE?r=LE:(r--,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r++),r}function BE(r,e){return r<=0||e.length===0&&e.ended?0:e.objectMode?1:r!==r?e.flowing&&e.length?e.buffer.head.data.length:e.length:(r>e.highWaterMark&&(e.highWaterMark=VJ(r)),r<=e.length?r:e.ended?e.length:(e.needReadable=!0,0))}lt.prototype.read=function(r){Ue("read",r),r=parseInt(r,10);var e=this._readableState,t=r;if(r!==0&&(e.emittedReadable=!1),r===0&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return Ue("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?uv(this):Rm(this),null;if(r=BE(r,e),r===0&&e.ended)return e.length===0&&uv(this),null;var n=e.needReadable;Ue("need readable",n),(e.length===0||e.length-r<e.highWaterMark)&&(n=!0,Ue("length less than watermark",n)),e.ended||e.reading?(n=!1,Ue("reading or ended",n)):n&&(Ue("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(r=BE(t,e)));var a;return r>0?a=zE(r,e):a=null,a===null?(e.needReadable=!0,r=0):e.length-=r,e.length===0&&(e.ended||(e.needReadable=!0),t!==r&&e.ended&&uv(this)),a!==null&&this.emit("data",a),a};function $J(r,e){if(!e.ended){if(e.decoder){var t=e.decoder.end();t&&t.length&&(e.buffer.push(t),e.length+=e.objectMode?1:t.length)}e.ended=!0,Rm(r)}}function Rm(r){var e=r._readableState;e.needReadable=!1,e.emittedReadable||(Ue("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?Ld.nextTick(WE,r):WE(r))}function WE(r){Ue("emit readable"),r.emit("readable"),pv(r)}function GE(r,e){e.readingMore||(e.readingMore=!0,Ld.nextTick(YJ,r,e))}function YJ(r,e){for(var t=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(Ue("maybeReadMore read 0"),r.read(0),t!==e.length);)t=e.length;e.readingMore=!1}lt.prototype._read=function(r){this.emit("error",new Error("_read() is not implemented"))};lt.prototype.pipe=function(r,e){var t=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=r;break;case 1:n.pipes=[n.pipes,r];break;default:n.pipes.push(r);break}n.pipesCount+=1,Ue("pipe count=%d opts=%j",n.pipesCount,e);var a=(!e||e.end!==!1)&&r!==process.stdout&&r!==process.stderr,s=a?o:R;n.endEmitted?Ld.nextTick(s):t.once("end",s),r.on("unpipe",i);function i(P,N){Ue("onunpipe"),P===t&&N&&N.hasUnpiped===!1&&(N.hasUnpiped=!0,u())}function o(){Ue("onend"),r.end()}var c=JJ(t);r.on("drain",c);var l=!1;function u(){Ue("cleanup"),r.removeListener("close",v),r.removeListener("finish",S),r.removeListener("drain",c),r.removeListener("error",y),r.removeListener("unpipe",i),t.removeListener("end",o),t.removeListener("end",R),t.removeListener("data",b),l=!0,n.awaitDrain&&(!r._writableState||r._writableState.needDrain)&&c()}var h=!1;t.on("data",b);function b(P){Ue("ondata"),h=!1;var N=r.write(P);N===!1&&!h&&((n.pipesCount===1&&n.pipes===r||n.pipesCount>1&&jE(n.pipes,r)!==-1)&&!l&&(Ue("false write response, pause",t._readableState.awaitDrain),t._readableState.awaitDrain++,h=!0),t.pause())}function y(P){Ue("onerror",P),R(),r.removeListener("error",y),KE(r,"error")===0&&r.emit("error",P)}GJ(r,"error",y);function v(){r.removeListener("finish",S),R()}r.once("close",v);function S(){Ue("onfinish"),r.removeListener("close",v),R()}r.once("finish",S);function R(){Ue("unpipe"),t.unpipe(r)}return r.emit("pipe",t),n.flowing||(Ue("pipe resume"),t.resume()),r};function JJ(r){return function(){var e=r._readableState;Ue("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,e.awaitDrain===0&&KE(r,"data")&&(e.flowing=!0,pv(r))}}lt.prototype.unpipe=function(r){var e=this._readableState,t={hasUnpiped:!1};if(e.pipesCount===0)return this;if(e.pipesCount===1)return r&&r!==e.pipes?this:(r||(r=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,r&&r.emit("unpipe",this,t),this);if(!r){var n=e.pipes,a=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var s=0;s<a;s++)n[s].emit("unpipe",this,t);return this}var i=jE(e.pipes,r);return i===-1?this:(e.pipes.splice(i,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),r.emit("unpipe",this,t),this)};lt.prototype.on=function(r,e){var t=hv.prototype.on.call(this,r,e);if(r==="data")this._readableState.flowing!==!1&&this.resume();else if(r==="readable"){var n=this._readableState;!n.endEmitted&&!n.readableListening&&(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&Rm(this):Ld.nextTick(XJ,this))}return t};lt.prototype.addListener=lt.prototype.on;function XJ(r){Ue("readable nexttick read 0"),r.read(0)}lt.prototype.resume=function(){var r=this._readableState;return r.flowing||(Ue("resume"),r.flowing=!0,ZJ(this,r)),this};function ZJ(r,e){e.resumeScheduled||(e.resumeScheduled=!0,Ld.nextTick(QJ,r,e))}function QJ(r,e){e.reading||(Ue("resume read 0"),r.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,r.emit("resume"),pv(r),e.flowing&&!e.reading&&r.read(0)}lt.prototype.pause=function(){return Ue("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(Ue("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function pv(r){var e=r._readableState;for(Ue("flow",e.flowing);e.flowing&&r.read()!==null;);}lt.prototype.wrap=function(r){var e=this,t=this._readableState,n=!1;r.on("end",function(){if(Ue("wrapped end"),t.decoder&&!t.ended){var i=t.decoder.end();i&&i.length&&e.push(i)}e.push(null)}),r.on("data",function(i){if(Ue("wrapped data"),t.decoder&&(i=t.decoder.write(i)),!(t.objectMode&&i==null)&&!(!t.objectMode&&(!i||!i.length))){var o=e.push(i);o||(n=!0,r.pause())}});for(var a in r)this[a]===void 0&&typeof r[a]=="function"&&(this[a]=function(i){return function(){return r[i].apply(r,arguments)}}(a));for(var s=0;s<fv.length;s++)r.on(fv[s],this.emit.bind(this,fv[s]));return this._read=function(i){Ue("wrapped _read",i),n&&(n=!1,r.resume())},this};Object.defineProperty(lt.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});lt._fromList=zE;function zE(r,e){if(e.length===0)return null;var t;return e.objectMode?t=e.buffer.shift():!r||r>=e.length?(e.decoder?t=e.buffer.join(""):e.buffer.length===1?t=e.buffer.head.data:t=e.buffer.concat(e.length),e.buffer.clear()):t=eX(r,e.buffer,e.decoder),t}function eX(r,e,t){var n;return r<e.head.data.length?(n=e.head.data.slice(0,r),e.head.data=e.head.data.slice(r)):r===e.head.data.length?n=e.shift():n=t?tX(r,e):rX(r,e),n}function tX(r,e){var t=e.head,n=1,a=t.data;for(r-=a.length;t=t.next;){var s=t.data,i=r>s.length?s.length:r;if(i===s.length?a+=s:a+=s.slice(0,r),r-=i,r===0){i===s.length?(++n,t.next?e.head=t.next:e.head=e.tail=null):(e.head=t,t.data=s.slice(i));break}++n}return e.length-=n,a}function rX(r,e){var t=iu.allocUnsafe(r),n=e.head,a=1;for(n.data.copy(t),r-=n.data.length;n=n.next;){var s=n.data,i=r>s.length?s.length:r;if(s.copy(t,t.length-r,0,i),r-=i,r===0){i===s.length?(++a,n.next?e.head=n.next:e.head=e.tail=null):(e.head=n,n.data=s.slice(i));break}++a}return e.length-=a,t}function uv(r){var e=r._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,Ld.nextTick(nX,e,r))}function nX(r,e){!r.endEmitted&&r.length===0&&(r.endEmitted=!0,e.readable=!1,e.emit("end"))}function jE(r,e){for(var t=0,n=r.length;t<n;t++)if(r[t]===e)return t;return-1}});var mv=D((lve,JE)=>{"use strict";d();f();JE.exports=Is;var km=Lo(),YE=Object.create(Da());YE.inherits=Tr();YE.inherits(Is,km);function aX(r,e){var t=this._transformState;t.transforming=!1;var n=t.writecb;if(!n)return this.emit("error",new Error("write callback called multiple times"));t.writechunk=null,t.writecb=null,e!=null&&this.push(e),n(r);var a=this._readableState;a.reading=!1,(a.needReadable||a.length<a.highWaterMark)&&this._read(a.highWaterMark)}function Is(r){if(!(this instanceof Is))return new Is(r);km.call(this,r),this._transformState={afterTransform:aX.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,r&&(typeof r.transform=="function"&&(this._transform=r.transform),typeof r.flush=="function"&&(this._flush=r.flush)),this.on("prefinish",sX)}function sX(){var r=this;typeof this._flush=="function"?this._flush(function(e,t){$E(r,e,t)}):$E(this,null,null)}Is.prototype.push=function(r,e){return this._transformState.needTransform=!1,km.prototype.push.call(this,r,e)};Is.prototype._transform=function(r,e,t){throw new Error("_transform() is not implemented")};Is.prototype._write=function(r,e,t){var n=this._transformState;if(n.writecb=t,n.writechunk=r,n.writeencoding=e,!n.transforming){var a=this._readableState;(n.needTransform||a.needReadable||a.length<a.highWaterMark)&&this._read(a.highWaterMark)}};Is.prototype._read=function(r){var e=this._transformState;e.writechunk!==null&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};Is.prototype._destroy=function(r,e){var t=this;km.prototype._destroy.call(this,r,function(n){e(n),t.emit("close")})};function $E(r,e,t){if(e)return r.emit("error",e);if(t!=null&&r.push(t),r._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(r._transformState.transforming)throw new Error("Calling transform done when still transforming");return r.push(null)}});var eP=D((pve,QE)=>{"use strict";d();f();QE.exports=ou;var XE=mv(),ZE=Object.create(Da());ZE.inherits=Tr();ZE.inherits(ou,XE);function ou(r){if(!(this instanceof ou))return new ou(r);XE.call(this,r)}ou.prototype._transform=function(r,e,t){t(null,r)}});var rP=D((Ua,tP)=>{d();f();Ua=tP.exports=sv();Ua.Stream=Ua;Ua.Readable=Ua;Ua.Writable=rv();Ua.Duplex=Lo();Ua.Transform=mv();Ua.PassThrough=eP()});var gv=D((xve,nP)=>{d();f();nP.exports=oX;var iX=Object.prototype.hasOwnProperty;function oX(){for(var r={},e=0;e<arguments.length;e++){var t=arguments[e];for(var n in t)iX.call(t,n)&&(r[n]=t[n])}return r}});var oP=D((Sve,Om)=>{d();f();var aP=rP().Transform,sP=Bp().inherits,iP=gv();function Bd(r){aP.call(this,r),this._destroyed=!1}sP(Bd,aP);Bd.prototype.destroy=function(r){if(!this._destroyed){this._destroyed=!0;var e=this;process.nextTick(function(){r&&e.emit("error",r),e.emit("close")})}};function cX(r,e,t){t(null,r)}function bv(r){return function(e,t,n){return typeof e=="function"&&(n=t,t=e,e={}),typeof t!="function"&&(t=cX),typeof n!="function"&&(n=null),r(e,t,n)}}Om.exports=bv(function(r,e,t){var n=new Bd(r);return n._transform=e,t&&(n._flush=t),n});Om.exports.ctor=bv(function(r,e,t){function n(a){if(!(this instanceof n))return new n(a);this.options=iP(r,a),Bd.call(this,this.options)}return sP(n,Bd),n.prototype._transform=e,t&&(n.prototype._flush=t),n});Om.exports.obj=bv(function(r,e,t){var n=new Bd(iP({objectMode:!0,highWaterMark:16},r));return n._transform=e,t&&(n._flush=t),n})});var cP=D(Dm=>{"use strict";d();f();Object.defineProperty(Dm,"__esModule",{value:!0});Dm.storeTransformStream=void 0;var dX=oP();function fX(r){return dX.obj((e,t,n)=>{try{let a=r(e);n(null,a);return}catch(a){n(a);return}})}Dm.storeTransformStream=fX});var Ne=D(Xn=>{"use strict";d();f();var lX=Xn&&Xn.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Wd=Xn&&Xn.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&lX(e,r,t)};Object.defineProperty(Xn,"__esModule",{value:!0});Wd(iE(),Xn);Wd(dE(),Xn);Wd(fE(),Xn);Wd(lE(),Xn);Wd(Zl(),Xn);Wd(cP(),Xn)});var lP=D((dP,fP)=>{d();f();var uX=bl();dP=fP.exports=yv;yv.through=yv;function yv(r,e,t){r=r||function(u){this.queue(u)},e=e||function(){this.queue(null)};var n=!1,a=!1,s=[],i=!1,o=new uX;o.readable=o.writable=!0,o.paused=!1,o.autoDestroy=!(t&&t.autoDestroy===!1),o.write=function(u){return r.call(this,u),!o.paused};function c(){for(;s.length&&!o.paused;){var u=s.shift();if(u===null)return o.emit("end");o.emit("data",u)}}o.queue=o.push=function(u){return i||(u===null&&(i=!0),s.push(u),c()),o},o.on("end",function(){o.readable=!1,!o.writable&&o.autoDestroy&&process.nextTick(function(){o.destroy()})});function l(){o.writable=!1,e.call(o),!o.readable&&o.autoDestroy&&o.destroy()}return o.end=function(u){if(!n)return n=!0,arguments.length&&o.write(u),l(),o},o.destroy=function(){if(!a)return a=!0,n=!0,s.length=0,o.writable=o.readable=!1,o.emit("close"),o},o.pause=function(){if(!o.paused)return o.paused=!0,o},o.resume=function(){return o.paused&&(o.paused=!1,o.emit("resume")),c(),o.paused||o.emit("drain"),o},o}});var pP=D((kve,hP)=>{d();f();var hX=bl(),pX=["write","end","destroy"],mX=["resume","pause"],gX=["data","close"],uP=Array.prototype.slice;hP.exports=bX;function xv(r,e){if(r.forEach)return r.forEach(e);for(var t=0;t<r.length;t++)e(r[t],t)}function bX(r,e){var t=new hX,n=!1;return xv(pX,a),xv(mX,s),xv(gX,i),e.on("end",o),r.on("drain",function(){t.emit("drain")}),r.on("error",c),e.on("error",c),t.writable=r.writable,t.readable=e.readable,t;function a(l){t[l]=u;function u(){return r[l].apply(r,arguments)}}function s(l){t[l]=u;function u(){t.emit(l);var h=e[l];if(h)return h.apply(e,arguments);e.emit(l)}}function i(l){e.on(l,u);function u(){var h=uP.call(arguments);h.unshift(l),t.emit.apply(t,h)}}function o(){if(!n){n=!0;var l=uP.call(arguments);l.unshift("end"),t.emit.apply(t,l)}}function c(l){t.emit("error",l)}}});var gP=D((Lve,mP)=>{d();f();mP.exports=function(e,t,n){var a,s,i,o,c;t==null&&(t=100);function l(){var h=Date.now()-o;h<t&&h>=0?a=setTimeout(l,t-h):(a=null,n||(c=e.apply(i,s),i=s=null))}var u=function(){i=this,s=arguments,o=Date.now();var h=n&&!a;return a||(a=setTimeout(l,t)),h&&(c=e.apply(i,s),i=s=null),c};return u.clear=function(){a&&(clearTimeout(a),a=null)},u.flush=function(){a&&(c=e.apply(i,s),i=s=null,clearTimeout(a),a=null)},u}});var xP=D((Kve,yP)=>{d();f();var bP=lP(),yX=pP(),xX=gP();yP.exports=wX;function wX(r,e){var t=r||100,n=bP(xX(s,t,e)),a=bP();return yX(n,a);function s(i){a.queue(i)}}});var du=D(vv=>{"use strict";d();f();var Wm=class{constructor(e){this.tasks=[],this.count=e}sched(){if(this.count>0&&this.tasks.length>0){this.count--;let e=this.tasks.shift();if(e===void 0)throw"Unexpected undefined value in tasks list";e()}}acquire(){return new Promise((e,t)=>{var n=()=>{var a=!1;e(()=>{a||(a=!0,this.count++,this.sched())})};this.tasks.push(n),process&&process.nextTick?process.nextTick(this.sched.bind(this)):setImmediate(this.sched.bind(this))})}use(e){return this.acquire().then(t=>e().then(n=>(t(),n)).catch(n=>{throw t(),n}))}};vv.Semaphore=Wm;var wv=class extends Wm{constructor(){super(1)}};vv.Mutex=wv});var Sv=D((a1e,CP)=>{d();f();var AP=v$(),_X=AP&&new AP;CP.exports=_X});var _v=D((o1e,IP)=>{d();f();var AX=P$(),TP=Sv(),CX=TP?function(r,e){return TP.set(r,e),r}:AX;IP.exports=CX});var lu=D((f1e,EP)=>{d();f();var TX=sw(),IX=b$();function EX(r){return function(){var e=arguments;switch(e.length){case 0:return new r;case 1:return new r(e[0]);case 2:return new r(e[0],e[1]);case 3:return new r(e[0],e[1],e[2]);case 4:return new r(e[0],e[1],e[2],e[3]);case 5:return new r(e[0],e[1],e[2],e[3],e[4]);case 6:return new r(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new r(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var t=TX(r.prototype),n=r.apply(t,e);return IX(n)?n:t}}EP.exports=EX});var MP=D((h1e,PP)=>{d();f();var PX=lu(),MX=o0(),NX=1;function RX(r,e,t){var n=e&NX,a=PX(r);function s(){var i=this&&this!==MX&&this instanceof s?a:r;return i.apply(n?t:this,arguments)}return s}PP.exports=RX});var Av=D((g1e,NP)=>{d();f();var kX=Math.max;function OX(r,e,t,n){for(var a=-1,s=r.length,i=t.length,o=-1,c=e.length,l=kX(s-i,0),u=Array(c+l),h=!n;++o<c;)u[o]=e[o];for(;++a<i;)(h||a<s)&&(u[t[a]]=r[a]);for(;l--;)u[o++]=r[a++];return u}NP.exports=OX});var Cv=D((x1e,RP)=>{d();f();var DX=Math.max;function LX(r,e,t,n){for(var a=-1,s=r.length,i=-1,o=t.length,c=-1,l=e.length,u=DX(s-o,0),h=Array(u+l),b=!n;++a<u;)h[a]=r[a];for(var y=a;++c<l;)h[y+c]=e[c];for(;++i<o;)(b||a<s)&&(h[y+t[i]]=r[a++]);return h}RP.exports=LX});var OP=D((S1e,kP)=>{d();f();function BX(r,e){for(var t=r.length,n=0;t--;)r[t]===e&&++n;return n}kP.exports=BX});var Km=D((C1e,DP)=>{d();f();function WX(){}DP.exports=WX});var Um=D((E1e,LP)=>{d();f();var KX=sw(),qX=Km(),UX=4294967295;function qm(r){this.__wrapped__=r,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=UX,this.__views__=[]}qm.prototype=KX(qX.prototype);qm.prototype.constructor=qm;LP.exports=qm});var Tv=D((N1e,WP)=>{d();f();var BP=Sv(),FX=D9(),HX=BP?function(r){return BP.get(r)}:FX;WP.exports=HX});var qP=D((O1e,KP)=>{d();f();var GX={};KP.exports=GX});var HP=D((B1e,FP)=>{d();f();var UP=qP(),zX=Object.prototype,jX=zX.hasOwnProperty;function VX(r){for(var e=r.name+"",t=UP[e],n=jX.call(UP,e)?t.length:0;n--;){var a=t[n],s=a.func;if(s==null||s==r)return a.name}return e}FP.exports=VX});var Iv=D((q1e,GP)=>{d();f();var $X=sw(),YX=Km();function Fm(r,e){this.__wrapped__=r,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=void 0}Fm.prototype=$X(YX.prototype);Fm.prototype.constructor=Fm;GP.exports=Fm});var jP=D((H1e,zP)=>{d();f();var JX=Um(),XX=Iv(),ZX=V5();function QX(r){if(r instanceof JX)return r.clone();var e=new XX(r.__wrapped__,r.__chain__);return e.__actions__=ZX(r.__actions__),e.__index__=r.__index__,e.__values__=r.__values__,e}zP.exports=QX});var YP=D((j1e,$P)=>{d();f();var eZ=Um(),VP=Iv(),tZ=Km(),rZ=y$(),nZ=x$(),aZ=jP(),sZ=Object.prototype,iZ=sZ.hasOwnProperty;function Hm(r){if(nZ(r)&&!rZ(r)&&!(r instanceof eZ)){if(r instanceof VP)return r;if(iZ.call(r,"__wrapped__"))return aZ(r)}return new VP(r)}Hm.prototype=tZ.prototype;Hm.prototype.constructor=Hm;$P.exports=Hm});var XP=D((Y1e,JP)=>{d();f();var oZ=Um(),cZ=Tv(),dZ=HP(),fZ=YP();function lZ(r){var e=dZ(r),t=fZ[e];if(typeof t!="function"||!(e in oZ.prototype))return!1;if(r===t)return!0;var n=cZ(t);return!!n&&r===n[0]}JP.exports=lZ});var Ev=D((Z1e,ZP)=>{d();f();var uZ=_v(),hZ=R$(),pZ=hZ(uZ);ZP.exports=pZ});var eM=D((tSe,QP)=>{d();f();var mZ=/\{\n\/\* \[wrapped with (.+)\] \*/,gZ=/,? & /;function bZ(r){var e=r.match(mZ);return e?e[1].split(gZ):[]}QP.exports=bZ});var rM=D((aSe,tM)=>{d();f();var yZ=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;function xZ(r,e){var t=e.length;if(!t)return r;var n=t-1;return e[n]=(t>1?"& ":"")+e[n],e=e.join(t>2?", ":" "),r.replace(yZ,`{
/* [wrapped with `+e+`] */
`)}tM.exports=xZ});var aM=D((oSe,nM)=>{d();f();var wZ=H$(),vZ=M$(),SZ=1,_Z=2,AZ=8,CZ=16,TZ=32,IZ=64,EZ=128,PZ=256,MZ=512,NZ=[["ary",EZ],["bind",SZ],["bindKey",_Z],["curry",AZ],["curryRight",CZ],["flip",MZ],["partial",TZ],["partialRight",IZ],["rearg",PZ]];function RZ(r,e){return wZ(NZ,function(t){var n="_."+t[0];e&t[1]&&!vZ(r,n)&&r.push(n)}),r.sort()}nM.exports=RZ});var Pv=D((fSe,sM)=>{d();f();var kZ=eM(),OZ=rM(),DZ=k$(),LZ=aM();function BZ(r,e,t){var n=e+"";return DZ(r,OZ(n,LZ(kZ(n),t)))}sM.exports=BZ});var Mv=D((hSe,cM)=>{d();f();var WZ=XP(),KZ=Ev(),qZ=Pv(),UZ=1,FZ=2,HZ=4,GZ=8,iM=32,oM=64;function zZ(r,e,t,n,a,s,i,o,c,l){var u=e&GZ,h=u?i:void 0,b=u?void 0:i,y=u?s:void 0,v=u?void 0:s;e|=u?iM:oM,e&=~(u?oM:iM),e&HZ||(e&=~(UZ|FZ));var S=[r,e,a,y,h,v,b,o,c,l],R=t.apply(void 0,S);return WZ(r)&&KZ(R,S),R.placeholder=n,qZ(R,r,e)}cM.exports=zZ});var Nv=D((gSe,dM)=>{d();f();function jZ(r){var e=r;return e.placeholder}dM.exports=jZ});var lM=D((xSe,fM)=>{d();f();var VZ=V5(),$Z=w$(),YZ=Math.min;function JZ(r,e){for(var t=r.length,n=YZ(e.length,t),a=VZ(r);n--;){var s=e[n];r[n]=$Z(s,t)?a[s]:void 0}return r}fM.exports=JZ});var Gm=D((SSe,hM)=>{d();f();var uM="__lodash_placeholder__";function XZ(r,e){for(var t=-1,n=r.length,a=0,s=[];++t<n;){var i=r[t];(i===e||i===uM)&&(r[t]=uM,s[a++]=t)}return s}hM.exports=XZ});var Rv=D((CSe,gM)=>{d();f();var ZZ=Av(),QZ=Cv(),eQ=OP(),pM=lu(),tQ=Mv(),rQ=Nv(),nQ=lM(),aQ=Gm(),sQ=o0(),iQ=1,oQ=2,cQ=8,dQ=16,fQ=128,lQ=512;function mM(r,e,t,n,a,s,i,o,c,l){var u=e&fQ,h=e&iQ,b=e&oQ,y=e&(cQ|dQ),v=e&lQ,S=b?void 0:pM(r);function R(){for(var P=arguments.length,N=Array(P),M=P;M--;)N[M]=arguments[M];if(y)var L=rQ(R),B=eQ(N,L);if(n&&(N=ZZ(N,n,a,y)),s&&(N=QZ(N,s,i,y)),P-=B,y&&P<l){var F=aQ(N,L);return tQ(r,e,mM,R.placeholder,t,N,F,o,c,l-P)}var K=h?t:this,H=b?K[r]:r;return P=N.length,o?N=nQ(N,o):v&&P>1&&N.reverse(),u&&c<P&&(N.length=c),this&&this!==sQ&&this instanceof R&&(H=S||pM(H)),H.apply(K,N)}return R}gM.exports=mM});var yM=D((ESe,bM)=>{d();f();var uQ=K9(),hQ=lu(),pQ=Rv(),mQ=Mv(),gQ=Nv(),bQ=Gm(),yQ=o0();function xQ(r,e,t){var n=hQ(r);function a(){for(var s=arguments.length,i=Array(s),o=s,c=gQ(a);o--;)i[o]=arguments[o];var l=s<3&&i[0]!==c&&i[s-1]!==c?[]:bQ(i,c);if(s-=l.length,s<t)return mQ(r,e,pQ,a.placeholder,void 0,i,l,void 0,void 0,t-s);var u=this&&this!==yQ&&this instanceof a?n:r;return uQ(u,this,i)}return a}bM.exports=xQ});var wM=D((NSe,xM)=>{d();f();var wQ=K9(),vQ=lu(),SQ=o0(),_Q=1;function AQ(r,e,t,n){var a=e&_Q,s=vQ(r);function i(){for(var o=-1,c=arguments.length,l=-1,u=n.length,h=Array(u+c),b=this&&this!==SQ&&this instanceof i?s:r;++l<u;)h[l]=n[l];for(;c--;)h[l++]=arguments[++o];return wQ(b,a?t:this,h)}return i}xM.exports=AQ});var TM=D((OSe,CM)=>{d();f();var CQ=Av(),TQ=Cv(),vM=Gm(),SM="__lodash_placeholder__",kv=1,IQ=2,EQ=4,_M=8,uu=128,AM=256,PQ=Math.min;function MQ(r,e){var t=r[1],n=e[1],a=t|n,s=a<(kv|IQ|uu),i=n==uu&&t==_M||n==uu&&t==AM&&r[7].length<=e[8]||n==(uu|AM)&&e[7].length<=e[8]&&t==_M;if(!(s||i))return r;n&kv&&(r[2]=e[2],a|=t&kv?0:EQ);var o=e[3];if(o){var c=r[3];r[3]=c?CQ(c,o,e[4]):o,r[4]=c?vM(r[3],SM):e[4]}return o=e[5],o&&(c=r[5],r[5]=c?TQ(c,o,e[6]):o,r[6]=c?vM(r[5],SM):e[6]),o=e[7],o&&(r[7]=o),n&uu&&(r[8]=r[8]==null?e[8]:PQ(r[8],e[8])),r[9]==null&&(r[9]=e[9]),r[0]=e[0],r[1]=a,r}CM.exports=MQ});var RM=D((BSe,NM)=>{d();f();var NQ=_v(),RQ=MP(),kQ=yM(),OQ=Rv(),DQ=wM(),LQ=Tv(),BQ=TM(),WQ=Ev(),KQ=Pv(),IM=O9(),qQ="Expected a function",EM=1,UQ=2,Ov=8,Dv=16,Lv=32,PM=64,MM=Math.max;function FQ(r,e,t,n,a,s,i,o){var c=e&UQ;if(!c&&typeof r!="function")throw new TypeError(qQ);var l=n?n.length:0;if(l||(e&=~(Lv|PM),n=a=void 0),i=i===void 0?i:MM(IM(i),0),o=o===void 0?o:IM(o),l-=a?a.length:0,e&PM){var u=n,h=a;n=a=void 0}var b=c?void 0:LQ(r),y=[r,e,t,n,a,u,h,s,i,o];if(b&&BQ(y,b),r=y[0],e=y[1],t=y[2],n=y[3],a=y[4],o=y[9]=y[9]===void 0?c?0:r.length:MM(y[9]-l,0),!o&&e&(Ov|Dv)&&(e&=~(Ov|Dv)),!e||e==EM)var v=RQ(r,e,t);else e==Ov||e==Dv?v=kQ(r,e,o):(e==Lv||e==(EM|Lv))&&!a.length?v=DQ(r,e,t,n):v=OQ.apply(void 0,y);var S=b?NQ:WQ;return KQ(S(v,y),r,e)}NM.exports=FQ});var OM=D((qSe,kM)=>{d();f();var HQ=RM(),GQ=128;function zQ(r,e,t){return e=t?void 0:e,e=r&&e==null?r.length:e,HQ(r,GQ,void 0,void 0,void 0,void 0,e)}kM.exports=zQ});var LM=D((HSe,DM)=>{d();f();var jQ=OM();function VQ(r){return jQ(r,1)}DM.exports=VQ});var Uv=D((g2e,GM)=>{d();f();var $Q=self.crypto||self.msCrypto,qv="-_",bi=36;for(;bi--;)qv+=bi.toString(36);bi=36;for(;bi---10;)qv+=bi.toString(36).toUpperCase();GM.exports=function(r){var e="",t=$Q.getRandomValues(new Uint8Array(r||21));for(bi=r||21;bi--;)e+=qv[t[bi]&63];return e}});var Wo=D((VM,Hv)=>{d();f();(function(r,e){"use strict";function t(T,m){if(!T)throw new Error(m||"Assertion failed")}function n(T,m){T.super_=m;var x=function(){};x.prototype=m.prototype,T.prototype=new x,T.prototype.constructor=T}function a(T,m,x){if(a.isBN(T))return T;this.negative=0,this.words=null,this.length=0,this.red=null,T!==null&&((m==="le"||m==="be")&&(x=m,m=10),this._init(T||0,m||10,x||"be"))}typeof r=="object"?r.exports=a:e.BN=a,a.BN=a,a.wordSize=26;var s;try{s=Dp().Buffer}catch{}a.isBN=function(m){return m instanceof a?!0:m!==null&&typeof m=="object"&&m.constructor.wordSize===a.wordSize&&Array.isArray(m.words)},a.max=function(m,x){return m.cmp(x)>0?m:x},a.min=function(m,x){return m.cmp(x)<0?m:x},a.prototype._init=function(m,x,w){if(typeof m=="number")return this._initNumber(m,x,w);if(typeof m=="object")return this._initArray(m,x,w);x==="hex"&&(x=16),t(x===(x|0)&&x>=2&&x<=36),m=m.toString().replace(/\s+/g,"");var I=0;m[0]==="-"&&I++,x===16?this._parseHex(m,I):this._parseBase(m,x,I),m[0]==="-"&&(this.negative=1),this._strip(),w==="le"&&this._initArray(this.toArray(),x,w)},a.prototype._initNumber=function(m,x,w){m<0&&(this.negative=1,m=-m),m<67108864?(this.words=[m&67108863],this.length=1):m<4503599627370496?(this.words=[m&67108863,m/67108864&67108863],this.length=2):(t(m<9007199254740992),this.words=[m&67108863,m/67108864&67108863,1],this.length=3),w==="le"&&this._initArray(this.toArray(),x,w)},a.prototype._initArray=function(m,x,w){if(t(typeof m.length=="number"),m.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(m.length/3),this.words=new Array(this.length);for(var I=0;I<this.length;I++)this.words[I]=0;var k,O,E=0;if(w==="be")for(I=m.length-1,k=0;I>=0;I-=3)O=m[I]|m[I-1]<<8|m[I-2]<<16,this.words[k]|=O<<E&67108863,this.words[k+1]=O>>>26-E&67108863,E+=24,E>=26&&(E-=26,k++);else if(w==="le")for(I=0,k=0;I<m.length;I+=3)O=m[I]|m[I+1]<<8|m[I+2]<<16,this.words[k]|=O<<E&67108863,this.words[k+1]=O>>>26-E&67108863,E+=24,E>=26&&(E-=26,k++);return this._strip()};function i(T,m,x){for(var w=0,I=Math.min(T.length,x),k=0,O=m;O<I;O++){var E=T.charCodeAt(O)-48;w<<=4;var A;E>=49&&E<=54?A=E-49+10:E>=17&&E<=22?A=E-17+10:A=E,w|=A,k|=A}return t(!(k&240),"Invalid character in "+T),w}a.prototype._parseHex=function(m,x){this.length=Math.ceil((m.length-x)/6),this.words=new Array(this.length);for(var w=0;w<this.length;w++)this.words[w]=0;var I,k,O=0;for(w=m.length-6,I=0;w>=x;w-=6)k=i(m,w,w+6),this.words[I]|=k<<O&67108863,this.words[I+1]|=k>>>26-O&4194303,O+=24,O>=26&&(O-=26,I++);w+6!==x&&(k=i(m,x,w+6),this.words[I]|=k<<O&67108863,this.words[I+1]|=k>>>26-O&4194303),this._strip()};function o(T,m,x,w){for(var I=0,k=0,O=Math.min(T.length,x),E=m;E<O;E++){var A=T.charCodeAt(E)-48;I*=w,A>=49?k=A-49+10:A>=17?k=A-17+10:k=A,t(A>=0&&k<w,"Invalid character"),I+=k}return I}a.prototype._parseBase=function(m,x,w){this.words=[0],this.length=1;for(var I=0,k=1;k<=67108863;k*=x)I++;I--,k=k/x|0;for(var O=m.length-w,E=O%I,A=Math.min(O,O-E)+w,g=0,C=w;C<A;C+=I)g=o(m,C,C+I,x),this.imuln(k),this.words[0]+g<67108864?this.words[0]+=g:this._iaddn(g);if(E!==0){var W=1;for(g=o(m,C,m.length,x),C=0;C<E;C++)W*=x;this.imuln(W),this.words[0]+g<67108864?this.words[0]+=g:this._iaddn(g)}},a.prototype.copy=function(m){m.words=new Array(this.length);for(var x=0;x<this.length;x++)m.words[x]=this.words[x];m.length=this.length,m.negative=this.negative,m.red=this.red};function c(T,m){T.words=m.words,T.length=m.length,T.negative=m.negative,T.red=m.red}if(a.prototype._move=function(m){c(m,this)},a.prototype.clone=function(){var m=new a(null);return this.copy(m),m},a.prototype._expand=function(m){for(;this.length<m;)this.words[this.length++]=0;return this},a.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},a.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{a.prototype[Symbol.for("nodejs.util.inspect.custom")]=l}catch{a.prototype.inspect=l}else a.prototype.inspect=l;function l(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var u=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],h=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],b=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];a.prototype.toString=function(m,x){m=m||10,x=x|0||1;var w;if(m===16||m==="hex"){w="";for(var I=0,k=0,O=0;O<this.length;O++){var E=this.words[O],A=((E<<I|k)&16777215).toString(16);k=E>>>24-I&16777215,k!==0||O!==this.length-1?w=u[6-A.length]+A+w:w=A+w,I+=2,I>=26&&(I-=26,O--)}for(k!==0&&(w=k.toString(16)+w);w.length%x!==0;)w="0"+w;return this.negative!==0&&(w="-"+w),w}if(m===(m|0)&&m>=2&&m<=36){var g=h[m],C=b[m];w="";var W=this.clone();for(W.negative=0;!W.isZero();){var V=W.modrn(C).toString(m);W=W.idivn(C),W.isZero()?w=V+w:w=u[g-V.length]+V+w}for(this.isZero()&&(w="0"+w);w.length%x!==0;)w="0"+w;return this.negative!==0&&(w="-"+w),w}t(!1,"Base should be between 2 and 36")},a.prototype.toNumber=function(){var m=this.words[0];return this.length===2?m+=this.words[1]*67108864:this.length===3&&this.words[2]===1?m+=4503599627370496+this.words[1]*67108864:this.length>2&&t(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-m:m},a.prototype.toJSON=function(){return this.toString(16,2)},s&&(a.prototype.toBuffer=function(m,x){return this.toArrayLike(s,m,x)}),a.prototype.toArray=function(m,x){return this.toArrayLike(Array,m,x)};var y=function(m,x){return m.allocUnsafe?m.allocUnsafe(x):new m(x)};a.prototype.toArrayLike=function(m,x,w){this._strip();var I=this.byteLength(),k=w||Math.max(1,I);t(I<=k,"byte array longer than desired length"),t(k>0,"Requested array length <= 0");var O=y(m,k),E=x==="le"?"LE":"BE";return this["_toArrayLike"+E](O,I),O},a.prototype._toArrayLikeLE=function(m,x){for(var w=0,I=0,k=0,O=0;k<this.length;k++){var E=this.words[k]<<O|I;m[w++]=E&255,w<m.length&&(m[w++]=E>>8&255),w<m.length&&(m[w++]=E>>16&255),O===6?(w<m.length&&(m[w++]=E>>24&255),I=0,O=0):(I=E>>>24,O+=2)}if(w<m.length)for(m[w++]=I;w<m.length;)m[w++]=0},a.prototype._toArrayLikeBE=function(m,x){for(var w=m.length-1,I=0,k=0,O=0;k<this.length;k++){var E=this.words[k]<<O|I;m[w--]=E&255,w>=0&&(m[w--]=E>>8&255),w>=0&&(m[w--]=E>>16&255),O===6?(w>=0&&(m[w--]=E>>24&255),I=0,O=0):(I=E>>>24,O+=2)}if(w>=0)for(m[w--]=I;w>=0;)m[w--]=0},Math.clz32?a.prototype._countBits=function(m){return 32-Math.clz32(m)}:a.prototype._countBits=function(m){var x=m,w=0;return x>=4096&&(w+=13,x>>>=13),x>=64&&(w+=7,x>>>=7),x>=8&&(w+=4,x>>>=4),x>=2&&(w+=2,x>>>=2),w+x},a.prototype._zeroBits=function(m){if(m===0)return 26;var x=m,w=0;return(x&8191)===0&&(w+=13,x>>>=13),(x&127)===0&&(w+=7,x>>>=7),(x&15)===0&&(w+=4,x>>>=4),(x&3)===0&&(w+=2,x>>>=2),(x&1)===0&&w++,w},a.prototype.bitLength=function(){var m=this.words[this.length-1],x=this._countBits(m);return(this.length-1)*26+x};function v(T){for(var m=new Array(T.bitLength()),x=0;x<m.length;x++){var w=x/26|0,I=x%26;m[x]=T.words[w]>>>I&1}return m}a.prototype.zeroBits=function(){if(this.isZero())return 0;for(var m=0,x=0;x<this.length;x++){var w=this._zeroBits(this.words[x]);if(m+=w,w!==26)break}return m},a.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},a.prototype.toTwos=function(m){return this.negative!==0?this.abs().inotn(m).iaddn(1):this.clone()},a.prototype.fromTwos=function(m){return this.testn(m-1)?this.notn(m).iaddn(1).ineg():this.clone()},a.prototype.isNeg=function(){return this.negative!==0},a.prototype.neg=function(){return this.clone().ineg()},a.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},a.prototype.iuor=function(m){for(;this.length<m.length;)this.words[this.length++]=0;for(var x=0;x<m.length;x++)this.words[x]=this.words[x]|m.words[x];return this._strip()},a.prototype.ior=function(m){return t((this.negative|m.negative)===0),this.iuor(m)},a.prototype.or=function(m){return this.length>m.length?this.clone().ior(m):m.clone().ior(this)},a.prototype.uor=function(m){return this.length>m.length?this.clone().iuor(m):m.clone().iuor(this)},a.prototype.iuand=function(m){var x;this.length>m.length?x=m:x=this;for(var w=0;w<x.length;w++)this.words[w]=this.words[w]&m.words[w];return this.length=x.length,this._strip()},a.prototype.iand=function(m){return t((this.negative|m.negative)===0),this.iuand(m)},a.prototype.and=function(m){return this.length>m.length?this.clone().iand(m):m.clone().iand(this)},a.prototype.uand=function(m){return this.length>m.length?this.clone().iuand(m):m.clone().iuand(this)},a.prototype.iuxor=function(m){var x,w;this.length>m.length?(x=this,w=m):(x=m,w=this);for(var I=0;I<w.length;I++)this.words[I]=x.words[I]^w.words[I];if(this!==x)for(;I<x.length;I++)this.words[I]=x.words[I];return this.length=x.length,this._strip()},a.prototype.ixor=function(m){return t((this.negative|m.negative)===0),this.iuxor(m)},a.prototype.xor=function(m){return this.length>m.length?this.clone().ixor(m):m.clone().ixor(this)},a.prototype.uxor=function(m){return this.length>m.length?this.clone().iuxor(m):m.clone().iuxor(this)},a.prototype.inotn=function(m){t(typeof m=="number"&&m>=0);var x=Math.ceil(m/26)|0,w=m%26;this._expand(x),w>0&&x--;for(var I=0;I<x;I++)this.words[I]=~this.words[I]&67108863;return w>0&&(this.words[I]=~this.words[I]&67108863>>26-w),this._strip()},a.prototype.notn=function(m){return this.clone().inotn(m)},a.prototype.setn=function(m,x){t(typeof m=="number"&&m>=0);var w=m/26|0,I=m%26;return this._expand(w+1),x?this.words[w]=this.words[w]|1<<I:this.words[w]=this.words[w]&~(1<<I),this._strip()},a.prototype.iadd=function(m){var x;if(this.negative!==0&&m.negative===0)return this.negative=0,x=this.isub(m),this.negative^=1,this._normSign();if(this.negative===0&&m.negative!==0)return m.negative=0,x=this.isub(m),m.negative=1,x._normSign();var w,I;this.length>m.length?(w=this,I=m):(w=m,I=this);for(var k=0,O=0;O<I.length;O++)x=(w.words[O]|0)+(I.words[O]|0)+k,this.words[O]=x&67108863,k=x>>>26;for(;k!==0&&O<w.length;O++)x=(w.words[O]|0)+k,this.words[O]=x&67108863,k=x>>>26;if(this.length=w.length,k!==0)this.words[this.length]=k,this.length++;else if(w!==this)for(;O<w.length;O++)this.words[O]=w.words[O];return this},a.prototype.add=function(m){var x;return m.negative!==0&&this.negative===0?(m.negative=0,x=this.sub(m),m.negative^=1,x):m.negative===0&&this.negative!==0?(this.negative=0,x=m.sub(this),this.negative=1,x):this.length>m.length?this.clone().iadd(m):m.clone().iadd(this)},a.prototype.isub=function(m){if(m.negative!==0){m.negative=0;var x=this.iadd(m);return m.negative=1,x._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(m),this.negative=1,this._normSign();var w=this.cmp(m);if(w===0)return this.negative=0,this.length=1,this.words[0]=0,this;var I,k;w>0?(I=this,k=m):(I=m,k=this);for(var O=0,E=0;E<k.length;E++)x=(I.words[E]|0)-(k.words[E]|0)+O,O=x>>26,this.words[E]=x&67108863;for(;O!==0&&E<I.length;E++)x=(I.words[E]|0)+O,O=x>>26,this.words[E]=x&67108863;if(O===0&&E<I.length&&I!==this)for(;E<I.length;E++)this.words[E]=I.words[E];return this.length=Math.max(this.length,E),I!==this&&(this.negative=1),this._strip()},a.prototype.sub=function(m){return this.clone().isub(m)};function S(T,m,x){x.negative=m.negative^T.negative;var w=T.length+m.length|0;x.length=w,w=w-1|0;var I=T.words[0]|0,k=m.words[0]|0,O=I*k,E=O&67108863,A=O/67108864|0;x.words[0]=E;for(var g=1;g<w;g++){for(var C=A>>>26,W=A&67108863,V=Math.min(g,m.length-1),Q=Math.max(0,g-T.length+1);Q<=V;Q++){var ie=g-Q|0;I=T.words[ie]|0,k=m.words[Q]|0,O=I*k+W,C+=O/67108864|0,W=O&67108863}x.words[g]=W|0,A=C|0}return A!==0?x.words[g]=A|0:x.length--,x._strip()}var R=function(m,x,w){var I=m.words,k=x.words,O=w.words,E=0,A,g,C,W=I[0]|0,V=W&8191,Q=W>>>13,ie=I[1]|0,he=ie&8191,ve=ie>>>13,pr=I[2]|0,Ve=pr&8191,nt=pr>>>13,fl=I[3]|0,Ft=fl&8191,Ht=fl>>>13,ll=I[4]|0,Gt=ll&8191,zt=ll>>>13,ul=I[5]|0,jt=ul&8191,Vt=ul>>>13,hl=I[6]|0,$t=hl&8191,Yt=hl>>>13,pl=I[7]|0,Jt=pl&8191,Xt=pl>>>13,ml=I[8]|0,pt=ml&8191,mt=ml>>>13,vc=I[9]|0,gt=vc&8191,bt=vc>>>13,Sc=k[0]|0,yt=Sc&8191,xt=Sc>>>13,_c=k[1]|0,wt=_c&8191,vt=_c>>>13,Ac=k[2]|0,St=Ac&8191,_t=Ac>>>13,Cc=k[3]|0,At=Cc&8191,Ct=Cc>>>13,Tc=k[4]|0,Tt=Tc&8191,It=Tc>>>13,Ic=k[5]|0,Et=Ic&8191,Pt=Ic>>>13,Ec=k[6]|0,Mt=Ec&8191,Nt=Ec>>>13,Pc=k[7]|0,Rt=Pc&8191,kt=Pc>>>13,Mc=k[8]|0,Ot=Mc&8191,Dt=Mc>>>13,Nc=k[9]|0,Lt=Nc&8191,Bt=Nc>>>13;w.negative=m.negative^x.negative,w.length=19,A=Math.imul(V,yt),g=Math.imul(V,xt),g=g+Math.imul(Q,yt)|0,C=Math.imul(Q,xt);var Xi=(E+A|0)+((g&8191)<<13)|0;E=(C+(g>>>13)|0)+(Xi>>>26)|0,Xi&=67108863,A=Math.imul(he,yt),g=Math.imul(he,xt),g=g+Math.imul(ve,yt)|0,C=Math.imul(ve,xt),A=A+Math.imul(V,wt)|0,g=g+Math.imul(V,vt)|0,g=g+Math.imul(Q,wt)|0,C=C+Math.imul(Q,vt)|0;var Zi=(E+A|0)+((g&8191)<<13)|0;E=(C+(g>>>13)|0)+(Zi>>>26)|0,Zi&=67108863,A=Math.imul(Ve,yt),g=Math.imul(Ve,xt),g=g+Math.imul(nt,yt)|0,C=Math.imul(nt,xt),A=A+Math.imul(he,wt)|0,g=g+Math.imul(he,vt)|0,g=g+Math.imul(ve,wt)|0,C=C+Math.imul(ve,vt)|0,A=A+Math.imul(V,St)|0,g=g+Math.imul(V,_t)|0,g=g+Math.imul(Q,St)|0,C=C+Math.imul(Q,_t)|0;var Qi=(E+A|0)+((g&8191)<<13)|0;E=(C+(g>>>13)|0)+(Qi>>>26)|0,Qi&=67108863,A=Math.imul(Ft,yt),g=Math.imul(Ft,xt),g=g+Math.imul(Ht,yt)|0,C=Math.imul(Ht,xt),A=A+Math.imul(Ve,wt)|0,g=g+Math.imul(Ve,vt)|0,g=g+Math.imul(nt,wt)|0,C=C+Math.imul(nt,vt)|0,A=A+Math.imul(he,St)|0,g=g+Math.imul(he,_t)|0,g=g+Math.imul(ve,St)|0,C=C+Math.imul(ve,_t)|0,A=A+Math.imul(V,At)|0,g=g+Math.imul(V,Ct)|0,g=g+Math.imul(Q,At)|0,C=C+Math.imul(Q,Ct)|0;var eo=(E+A|0)+((g&8191)<<13)|0;E=(C+(g>>>13)|0)+(eo>>>26)|0,eo&=67108863,A=Math.imul(Gt,yt),g=Math.imul(Gt,xt),g=g+Math.imul(zt,yt)|0,C=Math.imul(zt,xt),A=A+Math.imul(Ft,wt)|0,g=g+Math.imul(Ft,vt)|0,g=g+Math.imul(Ht,wt)|0,C=C+Math.imul(Ht,vt)|0,A=A+Math.imul(Ve,St)|0,g=g+Math.imul(Ve,_t)|0,g=g+Math.imul(nt,St)|0,C=C+Math.imul(nt,_t)|0,A=A+Math.imul(he,At)|0,g=g+Math.imul(he,Ct)|0,g=g+Math.imul(ve,At)|0,C=C+Math.imul(ve,Ct)|0,A=A+Math.imul(V,Tt)|0,g=g+Math.imul(V,It)|0,g=g+Math.imul(Q,Tt)|0,C=C+Math.imul(Q,It)|0;var to=(E+A|0)+((g&8191)<<13)|0;E=(C+(g>>>13)|0)+(to>>>26)|0,to&=67108863,A=Math.imul(jt,yt),g=Math.imul(jt,xt),g=g+Math.imul(Vt,yt)|0,C=Math.imul(Vt,xt),A=A+Math.imul(Gt,wt)|0,g=g+Math.imul(Gt,vt)|0,g=g+Math.imul(zt,wt)|0,C=C+Math.imul(zt,vt)|0,A=A+Math.imul(Ft,St)|0,g=g+Math.imul(Ft,_t)|0,g=g+Math.imul(Ht,St)|0,C=C+Math.imul(Ht,_t)|0,A=A+Math.imul(Ve,At)|0,g=g+Math.imul(Ve,Ct)|0,g=g+Math.imul(nt,At)|0,C=C+Math.imul(nt,Ct)|0,A=A+Math.imul(he,Tt)|0,g=g+Math.imul(he,It)|0,g=g+Math.imul(ve,Tt)|0,C=C+Math.imul(ve,It)|0,A=A+Math.imul(V,Et)|0,g=g+Math.imul(V,Pt)|0,g=g+Math.imul(Q,Et)|0,C=C+Math.imul(Q,Pt)|0;var ro=(E+A|0)+((g&8191)<<13)|0;E=(C+(g>>>13)|0)+(ro>>>26)|0,ro&=67108863,A=Math.imul($t,yt),g=Math.imul($t,xt),g=g+Math.imul(Yt,yt)|0,C=Math.imul(Yt,xt),A=A+Math.imul(jt,wt)|0,g=g+Math.imul(jt,vt)|0,g=g+Math.imul(Vt,wt)|0,C=C+Math.imul(Vt,vt)|0,A=A+Math.imul(Gt,St)|0,g=g+Math.imul(Gt,_t)|0,g=g+Math.imul(zt,St)|0,C=C+Math.imul(zt,_t)|0,A=A+Math.imul(Ft,At)|0,g=g+Math.imul(Ft,Ct)|0,g=g+Math.imul(Ht,At)|0,C=C+Math.imul(Ht,Ct)|0,A=A+Math.imul(Ve,Tt)|0,g=g+Math.imul(Ve,It)|0,g=g+Math.imul(nt,Tt)|0,C=C+Math.imul(nt,It)|0,A=A+Math.imul(he,Et)|0,g=g+Math.imul(he,Pt)|0,g=g+Math.imul(ve,Et)|0,C=C+Math.imul(ve,Pt)|0,A=A+Math.imul(V,Mt)|0,g=g+Math.imul(V,Nt)|0,g=g+Math.imul(Q,Mt)|0,C=C+Math.imul(Q,Nt)|0;var no=(E+A|0)+((g&8191)<<13)|0;E=(C+(g>>>13)|0)+(no>>>26)|0,no&=67108863,A=Math.imul(Jt,yt),g=Math.imul(Jt,xt),g=g+Math.imul(Xt,yt)|0,C=Math.imul(Xt,xt),A=A+Math.imul($t,wt)|0,g=g+Math.imul($t,vt)|0,g=g+Math.imul(Yt,wt)|0,C=C+Math.imul(Yt,vt)|0,A=A+Math.imul(jt,St)|0,g=g+Math.imul(jt,_t)|0,g=g+Math.imul(Vt,St)|0,C=C+Math.imul(Vt,_t)|0,A=A+Math.imul(Gt,At)|0,g=g+Math.imul(Gt,Ct)|0,g=g+Math.imul(zt,At)|0,C=C+Math.imul(zt,Ct)|0,A=A+Math.imul(Ft,Tt)|0,g=g+Math.imul(Ft,It)|0,g=g+Math.imul(Ht,Tt)|0,C=C+Math.imul(Ht,It)|0,A=A+Math.imul(Ve,Et)|0,g=g+Math.imul(Ve,Pt)|0,g=g+Math.imul(nt,Et)|0,C=C+Math.imul(nt,Pt)|0,A=A+Math.imul(he,Mt)|0,g=g+Math.imul(he,Nt)|0,g=g+Math.imul(ve,Mt)|0,C=C+Math.imul(ve,Nt)|0,A=A+Math.imul(V,Rt)|0,g=g+Math.imul(V,kt)|0,g=g+Math.imul(Q,Rt)|0,C=C+Math.imul(Q,kt)|0;var ao=(E+A|0)+((g&8191)<<13)|0;E=(C+(g>>>13)|0)+(ao>>>26)|0,ao&=67108863,A=Math.imul(pt,yt),g=Math.imul(pt,xt),g=g+Math.imul(mt,yt)|0,C=Math.imul(mt,xt),A=A+Math.imul(Jt,wt)|0,g=g+Math.imul(Jt,vt)|0,g=g+Math.imul(Xt,wt)|0,C=C+Math.imul(Xt,vt)|0,A=A+Math.imul($t,St)|0,g=g+Math.imul($t,_t)|0,g=g+Math.imul(Yt,St)|0,C=C+Math.imul(Yt,_t)|0,A=A+Math.imul(jt,At)|0,g=g+Math.imul(jt,Ct)|0,g=g+Math.imul(Vt,At)|0,C=C+Math.imul(Vt,Ct)|0,A=A+Math.imul(Gt,Tt)|0,g=g+Math.imul(Gt,It)|0,g=g+Math.imul(zt,Tt)|0,C=C+Math.imul(zt,It)|0,A=A+Math.imul(Ft,Et)|0,g=g+Math.imul(Ft,Pt)|0,g=g+Math.imul(Ht,Et)|0,C=C+Math.imul(Ht,Pt)|0,A=A+Math.imul(Ve,Mt)|0,g=g+Math.imul(Ve,Nt)|0,g=g+Math.imul(nt,Mt)|0,C=C+Math.imul(nt,Nt)|0,A=A+Math.imul(he,Rt)|0,g=g+Math.imul(he,kt)|0,g=g+Math.imul(ve,Rt)|0,C=C+Math.imul(ve,kt)|0,A=A+Math.imul(V,Ot)|0,g=g+Math.imul(V,Dt)|0,g=g+Math.imul(Q,Ot)|0,C=C+Math.imul(Q,Dt)|0;var so=(E+A|0)+((g&8191)<<13)|0;E=(C+(g>>>13)|0)+(so>>>26)|0,so&=67108863,A=Math.imul(gt,yt),g=Math.imul(gt,xt),g=g+Math.imul(bt,yt)|0,C=Math.imul(bt,xt),A=A+Math.imul(pt,wt)|0,g=g+Math.imul(pt,vt)|0,g=g+Math.imul(mt,wt)|0,C=C+Math.imul(mt,vt)|0,A=A+Math.imul(Jt,St)|0,g=g+Math.imul(Jt,_t)|0,g=g+Math.imul(Xt,St)|0,C=C+Math.imul(Xt,_t)|0,A=A+Math.imul($t,At)|0,g=g+Math.imul($t,Ct)|0,g=g+Math.imul(Yt,At)|0,C=C+Math.imul(Yt,Ct)|0,A=A+Math.imul(jt,Tt)|0,g=g+Math.imul(jt,It)|0,g=g+Math.imul(Vt,Tt)|0,C=C+Math.imul(Vt,It)|0,A=A+Math.imul(Gt,Et)|0,g=g+Math.imul(Gt,Pt)|0,g=g+Math.imul(zt,Et)|0,C=C+Math.imul(zt,Pt)|0,A=A+Math.imul(Ft,Mt)|0,g=g+Math.imul(Ft,Nt)|0,g=g+Math.imul(Ht,Mt)|0,C=C+Math.imul(Ht,Nt)|0,A=A+Math.imul(Ve,Rt)|0,g=g+Math.imul(Ve,kt)|0,g=g+Math.imul(nt,Rt)|0,C=C+Math.imul(nt,kt)|0,A=A+Math.imul(he,Ot)|0,g=g+Math.imul(he,Dt)|0,g=g+Math.imul(ve,Ot)|0,C=C+Math.imul(ve,Dt)|0,A=A+Math.imul(V,Lt)|0,g=g+Math.imul(V,Bt)|0,g=g+Math.imul(Q,Lt)|0,C=C+Math.imul(Q,Bt)|0;var io=(E+A|0)+((g&8191)<<13)|0;E=(C+(g>>>13)|0)+(io>>>26)|0,io&=67108863,A=Math.imul(gt,wt),g=Math.imul(gt,vt),g=g+Math.imul(bt,wt)|0,C=Math.imul(bt,vt),A=A+Math.imul(pt,St)|0,g=g+Math.imul(pt,_t)|0,g=g+Math.imul(mt,St)|0,C=C+Math.imul(mt,_t)|0,A=A+Math.imul(Jt,At)|0,g=g+Math.imul(Jt,Ct)|0,g=g+Math.imul(Xt,At)|0,C=C+Math.imul(Xt,Ct)|0,A=A+Math.imul($t,Tt)|0,g=g+Math.imul($t,It)|0,g=g+Math.imul(Yt,Tt)|0,C=C+Math.imul(Yt,It)|0,A=A+Math.imul(jt,Et)|0,g=g+Math.imul(jt,Pt)|0,g=g+Math.imul(Vt,Et)|0,C=C+Math.imul(Vt,Pt)|0,A=A+Math.imul(Gt,Mt)|0,g=g+Math.imul(Gt,Nt)|0,g=g+Math.imul(zt,Mt)|0,C=C+Math.imul(zt,Nt)|0,A=A+Math.imul(Ft,Rt)|0,g=g+Math.imul(Ft,kt)|0,g=g+Math.imul(Ht,Rt)|0,C=C+Math.imul(Ht,kt)|0,A=A+Math.imul(Ve,Ot)|0,g=g+Math.imul(Ve,Dt)|0,g=g+Math.imul(nt,Ot)|0,C=C+Math.imul(nt,Dt)|0,A=A+Math.imul(he,Lt)|0,g=g+Math.imul(he,Bt)|0,g=g+Math.imul(ve,Lt)|0,C=C+Math.imul(ve,Bt)|0;var oo=(E+A|0)+((g&8191)<<13)|0;E=(C+(g>>>13)|0)+(oo>>>26)|0,oo&=67108863,A=Math.imul(gt,St),g=Math.imul(gt,_t),g=g+Math.imul(bt,St)|0,C=Math.imul(bt,_t),A=A+Math.imul(pt,At)|0,g=g+Math.imul(pt,Ct)|0,g=g+Math.imul(mt,At)|0,C=C+Math.imul(mt,Ct)|0,A=A+Math.imul(Jt,Tt)|0,g=g+Math.imul(Jt,It)|0,g=g+Math.imul(Xt,Tt)|0,C=C+Math.imul(Xt,It)|0,A=A+Math.imul($t,Et)|0,g=g+Math.imul($t,Pt)|0,g=g+Math.imul(Yt,Et)|0,C=C+Math.imul(Yt,Pt)|0,A=A+Math.imul(jt,Mt)|0,g=g+Math.imul(jt,Nt)|0,g=g+Math.imul(Vt,Mt)|0,C=C+Math.imul(Vt,Nt)|0,A=A+Math.imul(Gt,Rt)|0,g=g+Math.imul(Gt,kt)|0,g=g+Math.imul(zt,Rt)|0,C=C+Math.imul(zt,kt)|0,A=A+Math.imul(Ft,Ot)|0,g=g+Math.imul(Ft,Dt)|0,g=g+Math.imul(Ht,Ot)|0,C=C+Math.imul(Ht,Dt)|0,A=A+Math.imul(Ve,Lt)|0,g=g+Math.imul(Ve,Bt)|0,g=g+Math.imul(nt,Lt)|0,C=C+Math.imul(nt,Bt)|0;var co=(E+A|0)+((g&8191)<<13)|0;E=(C+(g>>>13)|0)+(co>>>26)|0,co&=67108863,A=Math.imul(gt,At),g=Math.imul(gt,Ct),g=g+Math.imul(bt,At)|0,C=Math.imul(bt,Ct),A=A+Math.imul(pt,Tt)|0,g=g+Math.imul(pt,It)|0,g=g+Math.imul(mt,Tt)|0,C=C+Math.imul(mt,It)|0,A=A+Math.imul(Jt,Et)|0,g=g+Math.imul(Jt,Pt)|0,g=g+Math.imul(Xt,Et)|0,C=C+Math.imul(Xt,Pt)|0,A=A+Math.imul($t,Mt)|0,g=g+Math.imul($t,Nt)|0,g=g+Math.imul(Yt,Mt)|0,C=C+Math.imul(Yt,Nt)|0,A=A+Math.imul(jt,Rt)|0,g=g+Math.imul(jt,kt)|0,g=g+Math.imul(Vt,Rt)|0,C=C+Math.imul(Vt,kt)|0,A=A+Math.imul(Gt,Ot)|0,g=g+Math.imul(Gt,Dt)|0,g=g+Math.imul(zt,Ot)|0,C=C+Math.imul(zt,Dt)|0,A=A+Math.imul(Ft,Lt)|0,g=g+Math.imul(Ft,Bt)|0,g=g+Math.imul(Ht,Lt)|0,C=C+Math.imul(Ht,Bt)|0;var fo=(E+A|0)+((g&8191)<<13)|0;E=(C+(g>>>13)|0)+(fo>>>26)|0,fo&=67108863,A=Math.imul(gt,Tt),g=Math.imul(gt,It),g=g+Math.imul(bt,Tt)|0,C=Math.imul(bt,It),A=A+Math.imul(pt,Et)|0,g=g+Math.imul(pt,Pt)|0,g=g+Math.imul(mt,Et)|0,C=C+Math.imul(mt,Pt)|0,A=A+Math.imul(Jt,Mt)|0,g=g+Math.imul(Jt,Nt)|0,g=g+Math.imul(Xt,Mt)|0,C=C+Math.imul(Xt,Nt)|0,A=A+Math.imul($t,Rt)|0,g=g+Math.imul($t,kt)|0,g=g+Math.imul(Yt,Rt)|0,C=C+Math.imul(Yt,kt)|0,A=A+Math.imul(jt,Ot)|0,g=g+Math.imul(jt,Dt)|0,g=g+Math.imul(Vt,Ot)|0,C=C+Math.imul(Vt,Dt)|0,A=A+Math.imul(Gt,Lt)|0,g=g+Math.imul(Gt,Bt)|0,g=g+Math.imul(zt,Lt)|0,C=C+Math.imul(zt,Bt)|0;var lo=(E+A|0)+((g&8191)<<13)|0;E=(C+(g>>>13)|0)+(lo>>>26)|0,lo&=67108863,A=Math.imul(gt,Et),g=Math.imul(gt,Pt),g=g+Math.imul(bt,Et)|0,C=Math.imul(bt,Pt),A=A+Math.imul(pt,Mt)|0,g=g+Math.imul(pt,Nt)|0,g=g+Math.imul(mt,Mt)|0,C=C+Math.imul(mt,Nt)|0,A=A+Math.imul(Jt,Rt)|0,g=g+Math.imul(Jt,kt)|0,g=g+Math.imul(Xt,Rt)|0,C=C+Math.imul(Xt,kt)|0,A=A+Math.imul($t,Ot)|0,g=g+Math.imul($t,Dt)|0,g=g+Math.imul(Yt,Ot)|0,C=C+Math.imul(Yt,Dt)|0,A=A+Math.imul(jt,Lt)|0,g=g+Math.imul(jt,Bt)|0,g=g+Math.imul(Vt,Lt)|0,C=C+Math.imul(Vt,Bt)|0;var uo=(E+A|0)+((g&8191)<<13)|0;E=(C+(g>>>13)|0)+(uo>>>26)|0,uo&=67108863,A=Math.imul(gt,Mt),g=Math.imul(gt,Nt),g=g+Math.imul(bt,Mt)|0,C=Math.imul(bt,Nt),A=A+Math.imul(pt,Rt)|0,g=g+Math.imul(pt,kt)|0,g=g+Math.imul(mt,Rt)|0,C=C+Math.imul(mt,kt)|0,A=A+Math.imul(Jt,Ot)|0,g=g+Math.imul(Jt,Dt)|0,g=g+Math.imul(Xt,Ot)|0,C=C+Math.imul(Xt,Dt)|0,A=A+Math.imul($t,Lt)|0,g=g+Math.imul($t,Bt)|0,g=g+Math.imul(Yt,Lt)|0,C=C+Math.imul(Yt,Bt)|0;var px=(E+A|0)+((g&8191)<<13)|0;E=(C+(g>>>13)|0)+(px>>>26)|0,px&=67108863,A=Math.imul(gt,Rt),g=Math.imul(gt,kt),g=g+Math.imul(bt,Rt)|0,C=Math.imul(bt,kt),A=A+Math.imul(pt,Ot)|0,g=g+Math.imul(pt,Dt)|0,g=g+Math.imul(mt,Ot)|0,C=C+Math.imul(mt,Dt)|0,A=A+Math.imul(Jt,Lt)|0,g=g+Math.imul(Jt,Bt)|0,g=g+Math.imul(Xt,Lt)|0,C=C+Math.imul(Xt,Bt)|0;var mx=(E+A|0)+((g&8191)<<13)|0;E=(C+(g>>>13)|0)+(mx>>>26)|0,mx&=67108863,A=Math.imul(gt,Ot),g=Math.imul(gt,Dt),g=g+Math.imul(bt,Ot)|0,C=Math.imul(bt,Dt),A=A+Math.imul(pt,Lt)|0,g=g+Math.imul(pt,Bt)|0,g=g+Math.imul(mt,Lt)|0,C=C+Math.imul(mt,Bt)|0;var gx=(E+A|0)+((g&8191)<<13)|0;E=(C+(g>>>13)|0)+(gx>>>26)|0,gx&=67108863,A=Math.imul(gt,Lt),g=Math.imul(gt,Bt),g=g+Math.imul(bt,Lt)|0,C=Math.imul(bt,Bt);var bx=(E+A|0)+((g&8191)<<13)|0;return E=(C+(g>>>13)|0)+(bx>>>26)|0,bx&=67108863,O[0]=Xi,O[1]=Zi,O[2]=Qi,O[3]=eo,O[4]=to,O[5]=ro,O[6]=no,O[7]=ao,O[8]=so,O[9]=io,O[10]=oo,O[11]=co,O[12]=fo,O[13]=lo,O[14]=uo,O[15]=px,O[16]=mx,O[17]=gx,O[18]=bx,E!==0&&(O[19]=E,w.length++),w};Math.imul||(R=S);function P(T,m,x){x.negative=m.negative^T.negative,x.length=T.length+m.length;for(var w=0,I=0,k=0;k<x.length-1;k++){var O=I;I=0;for(var E=w&67108863,A=Math.min(k,m.length-1),g=Math.max(0,k-T.length+1);g<=A;g++){var C=k-g,W=T.words[C]|0,V=m.words[g]|0,Q=W*V,ie=Q&67108863;O=O+(Q/67108864|0)|0,ie=ie+E|0,E=ie&67108863,O=O+(ie>>>26)|0,I+=O>>>26,O&=67108863}x.words[k]=E,w=O,O=I}return w!==0?x.words[k]=w:x.length--,x._strip()}function N(T,m,x){return P(T,m,x)}a.prototype.mulTo=function(m,x){var w,I=this.length+m.length;return this.length===10&&m.length===10?w=R(this,m,x):I<63?w=S(this,m,x):I<1024?w=P(this,m,x):w=N(this,m,x),w};function M(T,m){this.x=T,this.y=m}M.prototype.makeRBT=function(m){for(var x=new Array(m),w=a.prototype._countBits(m)-1,I=0;I<m;I++)x[I]=this.revBin(I,w,m);return x},M.prototype.revBin=function(m,x,w){if(m===0||m===w-1)return m;for(var I=0,k=0;k<x;k++)I|=(m&1)<<x-k-1,m>>=1;return I},M.prototype.permute=function(m,x,w,I,k,O){for(var E=0;E<O;E++)I[E]=x[m[E]],k[E]=w[m[E]]},M.prototype.transform=function(m,x,w,I,k,O){this.permute(O,m,x,w,I,k);for(var E=1;E<k;E<<=1)for(var A=E<<1,g=Math.cos(2*Math.PI/A),C=Math.sin(2*Math.PI/A),W=0;W<k;W+=A)for(var V=g,Q=C,ie=0;ie<E;ie++){var he=w[W+ie],ve=I[W+ie],pr=w[W+ie+E],Ve=I[W+ie+E],nt=V*pr-Q*Ve;Ve=V*Ve+Q*pr,pr=nt,w[W+ie]=he+pr,I[W+ie]=ve+Ve,w[W+ie+E]=he-pr,I[W+ie+E]=ve-Ve,ie!==A&&(nt=g*V-C*Q,Q=g*Q+C*V,V=nt)}},M.prototype.guessLen13b=function(m,x){var w=Math.max(x,m)|1,I=w&1,k=0;for(w=w/2|0;w;w=w>>>1)k++;return 1<<k+1+I},M.prototype.conjugate=function(m,x,w){if(!(w<=1))for(var I=0;I<w/2;I++){var k=m[I];m[I]=m[w-I-1],m[w-I-1]=k,k=x[I],x[I]=-x[w-I-1],x[w-I-1]=-k}},M.prototype.normalize13b=function(m,x){for(var w=0,I=0;I<x/2;I++){var k=Math.round(m[2*I+1]/x)*8192+Math.round(m[2*I]/x)+w;m[I]=k&67108863,k<67108864?w=0:w=k/67108864|0}return m},M.prototype.convert13b=function(m,x,w,I){for(var k=0,O=0;O<x;O++)k=k+(m[O]|0),w[2*O]=k&8191,k=k>>>13,w[2*O+1]=k&8191,k=k>>>13;for(O=2*x;O<I;++O)w[O]=0;t(k===0),t((k&-8192)===0)},M.prototype.stub=function(m){for(var x=new Array(m),w=0;w<m;w++)x[w]=0;return x},M.prototype.mulp=function(m,x,w){var I=2*this.guessLen13b(m.length,x.length),k=this.makeRBT(I),O=this.stub(I),E=new Array(I),A=new Array(I),g=new Array(I),C=new Array(I),W=new Array(I),V=new Array(I),Q=w.words;Q.length=I,this.convert13b(m.words,m.length,E,I),this.convert13b(x.words,x.length,C,I),this.transform(E,O,A,g,I,k),this.transform(C,O,W,V,I,k);for(var ie=0;ie<I;ie++){var he=A[ie]*W[ie]-g[ie]*V[ie];g[ie]=A[ie]*V[ie]+g[ie]*W[ie],A[ie]=he}return this.conjugate(A,g,I),this.transform(A,g,Q,O,I,k),this.conjugate(Q,O,I),this.normalize13b(Q,I),w.negative=m.negative^x.negative,w.length=m.length+x.length,w._strip()},a.prototype.mul=function(m){var x=new a(null);return x.words=new Array(this.length+m.length),this.mulTo(m,x)},a.prototype.mulf=function(m){var x=new a(null);return x.words=new Array(this.length+m.length),N(this,m,x)},a.prototype.imul=function(m){return this.clone().mulTo(m,this)},a.prototype.imuln=function(m){var x=m<0;x&&(m=-m),t(typeof m=="number"),t(m<67108864);for(var w=0,I=0;I<this.length;I++){var k=(this.words[I]|0)*m,O=(k&67108863)+(w&67108863);w>>=26,w+=k/67108864|0,w+=O>>>26,this.words[I]=O&67108863}return w!==0&&(this.words[I]=w,this.length++),x?this.ineg():this},a.prototype.muln=function(m){return this.clone().imuln(m)},a.prototype.sqr=function(){return this.mul(this)},a.prototype.isqr=function(){return this.imul(this.clone())},a.prototype.pow=function(m){var x=v(m);if(x.length===0)return new a(1);for(var w=this,I=0;I<x.length&&x[I]===0;I++,w=w.sqr());if(++I<x.length)for(var k=w.sqr();I<x.length;I++,k=k.sqr())x[I]!==0&&(w=w.mul(k));return w},a.prototype.iushln=function(m){t(typeof m=="number"&&m>=0);var x=m%26,w=(m-x)/26,I=67108863>>>26-x<<26-x,k;if(x!==0){var O=0;for(k=0;k<this.length;k++){var E=this.words[k]&I,A=(this.words[k]|0)-E<<x;this.words[k]=A|O,O=E>>>26-x}O&&(this.words[k]=O,this.length++)}if(w!==0){for(k=this.length-1;k>=0;k--)this.words[k+w]=this.words[k];for(k=0;k<w;k++)this.words[k]=0;this.length+=w}return this._strip()},a.prototype.ishln=function(m){return t(this.negative===0),this.iushln(m)},a.prototype.iushrn=function(m,x,w){t(typeof m=="number"&&m>=0);var I;x?I=(x-x%26)/26:I=0;var k=m%26,O=Math.min((m-k)/26,this.length),E=67108863^67108863>>>k<<k,A=w;if(I-=O,I=Math.max(0,I),A){for(var g=0;g<O;g++)A.words[g]=this.words[g];A.length=O}if(O!==0)if(this.length>O)for(this.length-=O,g=0;g<this.length;g++)this.words[g]=this.words[g+O];else this.words[0]=0,this.length=1;var C=0;for(g=this.length-1;g>=0&&(C!==0||g>=I);g--){var W=this.words[g]|0;this.words[g]=C<<26-k|W>>>k,C=W&E}return A&&C!==0&&(A.words[A.length++]=C),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},a.prototype.ishrn=function(m,x,w){return t(this.negative===0),this.iushrn(m,x,w)},a.prototype.shln=function(m){return this.clone().ishln(m)},a.prototype.ushln=function(m){return this.clone().iushln(m)},a.prototype.shrn=function(m){return this.clone().ishrn(m)},a.prototype.ushrn=function(m){return this.clone().iushrn(m)},a.prototype.testn=function(m){t(typeof m=="number"&&m>=0);var x=m%26,w=(m-x)/26,I=1<<x;if(this.length<=w)return!1;var k=this.words[w];return!!(k&I)},a.prototype.imaskn=function(m){t(typeof m=="number"&&m>=0);var x=m%26,w=(m-x)/26;if(t(this.negative===0,"imaskn works only with positive numbers"),this.length<=w)return this;if(x!==0&&w++,this.length=Math.min(w,this.length),x!==0){var I=67108863^67108863>>>x<<x;this.words[this.length-1]&=I}return this._strip()},a.prototype.maskn=function(m){return this.clone().imaskn(m)},a.prototype.iaddn=function(m){return t(typeof m=="number"),t(m<67108864),m<0?this.isubn(-m):this.negative!==0?this.length===1&&(this.words[0]|0)<=m?(this.words[0]=m-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(m),this.negative=1,this):this._iaddn(m)},a.prototype._iaddn=function(m){this.words[0]+=m;for(var x=0;x<this.length&&this.words[x]>=67108864;x++)this.words[x]-=67108864,x===this.length-1?this.words[x+1]=1:this.words[x+1]++;return this.length=Math.max(this.length,x+1),this},a.prototype.isubn=function(m){if(t(typeof m=="number"),t(m<67108864),m<0)return this.iaddn(-m);if(this.negative!==0)return this.negative=0,this.iaddn(m),this.negative=1,this;if(this.words[0]-=m,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var x=0;x<this.length&&this.words[x]<0;x++)this.words[x]+=67108864,this.words[x+1]-=1;return this._strip()},a.prototype.addn=function(m){return this.clone().iaddn(m)},a.prototype.subn=function(m){return this.clone().isubn(m)},a.prototype.iabs=function(){return this.negative=0,this},a.prototype.abs=function(){return this.clone().iabs()},a.prototype._ishlnsubmul=function(m,x,w){var I=m.length+w,k;this._expand(I);var O,E=0;for(k=0;k<m.length;k++){O=(this.words[k+w]|0)+E;var A=(m.words[k]|0)*x;O-=A&67108863,E=(O>>26)-(A/67108864|0),this.words[k+w]=O&67108863}for(;k<this.length-w;k++)O=(this.words[k+w]|0)+E,E=O>>26,this.words[k+w]=O&67108863;if(E===0)return this._strip();for(t(E===-1),E=0,k=0;k<this.length;k++)O=-(this.words[k]|0)+E,E=O>>26,this.words[k]=O&67108863;return this.negative=1,this._strip()},a.prototype._wordDiv=function(m,x){var w=this.length-m.length,I=this.clone(),k=m,O=k.words[k.length-1]|0,E=this._countBits(O);w=26-E,w!==0&&(k=k.ushln(w),I.iushln(w),O=k.words[k.length-1]|0);var A=I.length-k.length,g;if(x!=="mod"){g=new a(null),g.length=A+1,g.words=new Array(g.length);for(var C=0;C<g.length;C++)g.words[C]=0}var W=I.clone()._ishlnsubmul(k,1,A);W.negative===0&&(I=W,g&&(g.words[A]=1));for(var V=A-1;V>=0;V--){var Q=(I.words[k.length+V]|0)*67108864+(I.words[k.length+V-1]|0);for(Q=Math.min(Q/O|0,67108863),I._ishlnsubmul(k,Q,V);I.negative!==0;)Q--,I.negative=0,I._ishlnsubmul(k,1,V),I.isZero()||(I.negative^=1);g&&(g.words[V]=Q)}return g&&g._strip(),I._strip(),x!=="div"&&w!==0&&I.iushrn(w),{div:g||null,mod:I}},a.prototype.divmod=function(m,x,w){if(t(!m.isZero()),this.isZero())return{div:new a(0),mod:new a(0)};var I,k,O;return this.negative!==0&&m.negative===0?(O=this.neg().divmod(m,x),x!=="mod"&&(I=O.div.neg()),x!=="div"&&(k=O.mod.neg(),w&&k.negative!==0&&k.iadd(m)),{div:I,mod:k}):this.negative===0&&m.negative!==0?(O=this.divmod(m.neg(),x),x!=="mod"&&(I=O.div.neg()),{div:I,mod:O.mod}):(this.negative&m.negative)!==0?(O=this.neg().divmod(m.neg(),x),x!=="div"&&(k=O.mod.neg(),w&&k.negative!==0&&k.isub(m)),{div:O.div,mod:k}):m.length>this.length||this.cmp(m)<0?{div:new a(0),mod:this}:m.length===1?x==="div"?{div:this.divn(m.words[0]),mod:null}:x==="mod"?{div:null,mod:new a(this.modrn(m.words[0]))}:{div:this.divn(m.words[0]),mod:new a(this.modrn(m.words[0]))}:this._wordDiv(m,x)},a.prototype.div=function(m){return this.divmod(m,"div",!1).div},a.prototype.mod=function(m){return this.divmod(m,"mod",!1).mod},a.prototype.umod=function(m){return this.divmod(m,"mod",!0).mod},a.prototype.divRound=function(m){var x=this.divmod(m);if(x.mod.isZero())return x.div;var w=x.div.negative!==0?x.mod.isub(m):x.mod,I=m.ushrn(1),k=m.andln(1),O=w.cmp(I);return O<0||k===1&&O===0?x.div:x.div.negative!==0?x.div.isubn(1):x.div.iaddn(1)},a.prototype.modrn=function(m){var x=m<0;x&&(m=-m),t(m<=67108863);for(var w=(1<<26)%m,I=0,k=this.length-1;k>=0;k--)I=(w*I+(this.words[k]|0))%m;return x?-I:I},a.prototype.modn=function(m){return this.modrn(m)},a.prototype.idivn=function(m){var x=m<0;x&&(m=-m),t(m<=67108863);for(var w=0,I=this.length-1;I>=0;I--){var k=(this.words[I]|0)+w*67108864;this.words[I]=k/m|0,w=k%m}return this._strip(),x?this.ineg():this},a.prototype.divn=function(m){return this.clone().idivn(m)},a.prototype.egcd=function(m){t(m.negative===0),t(!m.isZero());var x=this,w=m.clone();x.negative!==0?x=x.umod(m):x=x.clone();for(var I=new a(1),k=new a(0),O=new a(0),E=new a(1),A=0;x.isEven()&&w.isEven();)x.iushrn(1),w.iushrn(1),++A;for(var g=w.clone(),C=x.clone();!x.isZero();){for(var W=0,V=1;(x.words[0]&V)===0&&W<26;++W,V<<=1);if(W>0)for(x.iushrn(W);W-- >0;)(I.isOdd()||k.isOdd())&&(I.iadd(g),k.isub(C)),I.iushrn(1),k.iushrn(1);for(var Q=0,ie=1;(w.words[0]&ie)===0&&Q<26;++Q,ie<<=1);if(Q>0)for(w.iushrn(Q);Q-- >0;)(O.isOdd()||E.isOdd())&&(O.iadd(g),E.isub(C)),O.iushrn(1),E.iushrn(1);x.cmp(w)>=0?(x.isub(w),I.isub(O),k.isub(E)):(w.isub(x),O.isub(I),E.isub(k))}return{a:O,b:E,gcd:w.iushln(A)}},a.prototype._invmp=function(m){t(m.negative===0),t(!m.isZero());var x=this,w=m.clone();x.negative!==0?x=x.umod(m):x=x.clone();for(var I=new a(1),k=new a(0),O=w.clone();x.cmpn(1)>0&&w.cmpn(1)>0;){for(var E=0,A=1;(x.words[0]&A)===0&&E<26;++E,A<<=1);if(E>0)for(x.iushrn(E);E-- >0;)I.isOdd()&&I.iadd(O),I.iushrn(1);for(var g=0,C=1;(w.words[0]&C)===0&&g<26;++g,C<<=1);if(g>0)for(w.iushrn(g);g-- >0;)k.isOdd()&&k.iadd(O),k.iushrn(1);x.cmp(w)>=0?(x.isub(w),I.isub(k)):(w.isub(x),k.isub(I))}var W;return x.cmpn(1)===0?W=I:W=k,W.cmpn(0)<0&&W.iadd(m),W},a.prototype.gcd=function(m){if(this.isZero())return m.abs();if(m.isZero())return this.abs();var x=this.clone(),w=m.clone();x.negative=0,w.negative=0;for(var I=0;x.isEven()&&w.isEven();I++)x.iushrn(1),w.iushrn(1);do{for(;x.isEven();)x.iushrn(1);for(;w.isEven();)w.iushrn(1);var k=x.cmp(w);if(k<0){var O=x;x=w,w=O}else if(k===0||w.cmpn(1)===0)break;x.isub(w)}while(!0);return w.iushln(I)},a.prototype.invm=function(m){return this.egcd(m).a.umod(m)},a.prototype.isEven=function(){return(this.words[0]&1)===0},a.prototype.isOdd=function(){return(this.words[0]&1)===1},a.prototype.andln=function(m){return this.words[0]&m},a.prototype.bincn=function(m){t(typeof m=="number");var x=m%26,w=(m-x)/26,I=1<<x;if(this.length<=w)return this._expand(w+1),this.words[w]|=I,this;for(var k=I,O=w;k!==0&&O<this.length;O++){var E=this.words[O]|0;E+=k,k=E>>>26,E&=67108863,this.words[O]=E}return k!==0&&(this.words[O]=k,this.length++),this},a.prototype.isZero=function(){return this.length===1&&this.words[0]===0},a.prototype.cmpn=function(m){var x=m<0;if(this.negative!==0&&!x)return-1;if(this.negative===0&&x)return 1;this._strip();var w;if(this.length>1)w=1;else{x&&(m=-m),t(m<=67108863,"Number is too big");var I=this.words[0]|0;w=I===m?0:I<m?-1:1}return this.negative!==0?-w|0:w},a.prototype.cmp=function(m){if(this.negative!==0&&m.negative===0)return-1;if(this.negative===0&&m.negative!==0)return 1;var x=this.ucmp(m);return this.negative!==0?-x|0:x},a.prototype.ucmp=function(m){if(this.length>m.length)return 1;if(this.length<m.length)return-1;for(var x=0,w=this.length-1;w>=0;w--){var I=this.words[w]|0,k=m.words[w]|0;if(I!==k){I<k?x=-1:I>k&&(x=1);break}}return x},a.prototype.gtn=function(m){return this.cmpn(m)===1},a.prototype.gt=function(m){return this.cmp(m)===1},a.prototype.gten=function(m){return this.cmpn(m)>=0},a.prototype.gte=function(m){return this.cmp(m)>=0},a.prototype.ltn=function(m){return this.cmpn(m)===-1},a.prototype.lt=function(m){return this.cmp(m)===-1},a.prototype.lten=function(m){return this.cmpn(m)<=0},a.prototype.lte=function(m){return this.cmp(m)<=0},a.prototype.eqn=function(m){return this.cmpn(m)===0},a.prototype.eq=function(m){return this.cmp(m)===0},a.red=function(m){return new X(m)},a.prototype.toRed=function(m){return t(!this.red,"Already a number in reduction context"),t(this.negative===0,"red works only with positives"),m.convertTo(this)._forceRed(m)},a.prototype.fromRed=function(){return t(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},a.prototype._forceRed=function(m){return this.red=m,this},a.prototype.forceRed=function(m){return t(!this.red,"Already a number in reduction context"),this._forceRed(m)},a.prototype.redAdd=function(m){return t(this.red,"redAdd works only with red numbers"),this.red.add(this,m)},a.prototype.redIAdd=function(m){return t(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,m)},a.prototype.redSub=function(m){return t(this.red,"redSub works only with red numbers"),this.red.sub(this,m)},a.prototype.redISub=function(m){return t(this.red,"redISub works only with red numbers"),this.red.isub(this,m)},a.prototype.redShl=function(m){return t(this.red,"redShl works only with red numbers"),this.red.shl(this,m)},a.prototype.redMul=function(m){return t(this.red,"redMul works only with red numbers"),this.red._verify2(this,m),this.red.mul(this,m)},a.prototype.redIMul=function(m){return t(this.red,"redMul works only with red numbers"),this.red._verify2(this,m),this.red.imul(this,m)},a.prototype.redSqr=function(){return t(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},a.prototype.redISqr=function(){return t(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},a.prototype.redSqrt=function(){return t(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},a.prototype.redInvm=function(){return t(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},a.prototype.redNeg=function(){return t(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},a.prototype.redPow=function(m){return t(this.red&&!m.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,m)};var L={k256:null,p224:null,p192:null,p25519:null};function B(T,m){this.name=T,this.p=new a(m,16),this.n=this.p.bitLength(),this.k=new a(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}B.prototype._tmp=function(){var m=new a(null);return m.words=new Array(Math.ceil(this.n/13)),m},B.prototype.ireduce=function(m){var x=m,w;do this.split(x,this.tmp),x=this.imulK(x),x=x.iadd(this.tmp),w=x.bitLength();while(w>this.n);var I=w<this.n?-1:x.ucmp(this.p);return I===0?(x.words[0]=0,x.length=1):I>0?x.isub(this.p):x.strip!==void 0?x.strip():x._strip(),x},B.prototype.split=function(m,x){m.iushrn(this.n,0,x)},B.prototype.imulK=function(m){return m.imul(this.k)};function F(){B.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}n(F,B),F.prototype.split=function(m,x){for(var w=4194303,I=Math.min(m.length,9),k=0;k<I;k++)x.words[k]=m.words[k];if(x.length=I,m.length<=9){m.words[0]=0,m.length=1;return}var O=m.words[9];for(x.words[x.length++]=O&w,k=10;k<m.length;k++){var E=m.words[k]|0;m.words[k-10]=(E&w)<<4|O>>>22,O=E}O>>>=22,m.words[k-10]=O,O===0&&m.length>10?m.length-=10:m.length-=9},F.prototype.imulK=function(m){m.words[m.length]=0,m.words[m.length+1]=0,m.length+=2;for(var x=0,w=0;w<m.length;w++){var I=m.words[w]|0;x+=I*977,m.words[w]=x&67108863,x=I*64+(x/67108864|0)}return m.words[m.length-1]===0&&(m.length--,m.words[m.length-1]===0&&m.length--),m};function K(){B.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}n(K,B);function H(){B.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}n(H,B);function j(){B.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}n(j,B),j.prototype.imulK=function(m){for(var x=0,w=0;w<m.length;w++){var I=(m.words[w]|0)*19+x,k=I&67108863;I>>>=26,m.words[w]=k,x=I}return x!==0&&(m.words[m.length++]=x),m},a._prime=function(m){if(L[m])return L[m];var x;if(m==="k256")x=new F;else if(m==="p224")x=new K;else if(m==="p192")x=new H;else if(m==="p25519")x=new j;else throw new Error("Unknown prime "+m);return L[m]=x,x};function X(T){if(typeof T=="string"){var m=a._prime(T);this.m=m.p,this.prime=m}else t(T.gtn(1),"modulus must be greater than 1"),this.m=T,this.prime=null}X.prototype._verify1=function(m){t(m.negative===0,"red works only with positives"),t(m.red,"red works only with red numbers")},X.prototype._verify2=function(m,x){t((m.negative|x.negative)===0,"red works only with positives"),t(m.red&&m.red===x.red,"red works only with red numbers")},X.prototype.imod=function(m){return this.prime?this.prime.ireduce(m)._forceRed(this):(c(m,m.umod(this.m)._forceRed(this)),m)},X.prototype.neg=function(m){return m.isZero()?m.clone():this.m.sub(m)._forceRed(this)},X.prototype.add=function(m,x){this._verify2(m,x);var w=m.add(x);return w.cmp(this.m)>=0&&w.isub(this.m),w._forceRed(this)},X.prototype.iadd=function(m,x){this._verify2(m,x);var w=m.iadd(x);return w.cmp(this.m)>=0&&w.isub(this.m),w},X.prototype.sub=function(m,x){this._verify2(m,x);var w=m.sub(x);return w.cmpn(0)<0&&w.iadd(this.m),w._forceRed(this)},X.prototype.isub=function(m,x){this._verify2(m,x);var w=m.isub(x);return w.cmpn(0)<0&&w.iadd(this.m),w},X.prototype.shl=function(m,x){return this._verify1(m),this.imod(m.ushln(x))},X.prototype.imul=function(m,x){return this._verify2(m,x),this.imod(m.imul(x))},X.prototype.mul=function(m,x){return this._verify2(m,x),this.imod(m.mul(x))},X.prototype.isqr=function(m){return this.imul(m,m.clone())},X.prototype.sqr=function(m){return this.mul(m,m)},X.prototype.sqrt=function(m){if(m.isZero())return m.clone();var x=this.m.andln(3);if(t(x%2===1),x===3){var w=this.m.add(new a(1)).iushrn(2);return this.pow(m,w)}for(var I=this.m.subn(1),k=0;!I.isZero()&&I.andln(1)===0;)k++,I.iushrn(1);t(!I.isZero());var O=new a(1).toRed(this),E=O.redNeg(),A=this.m.subn(1).iushrn(1),g=this.m.bitLength();for(g=new a(2*g*g).toRed(this);this.pow(g,A).cmp(E)!==0;)g.redIAdd(E);for(var C=this.pow(g,I),W=this.pow(m,I.addn(1).iushrn(1)),V=this.pow(m,I),Q=k;V.cmp(O)!==0;){for(var ie=V,he=0;ie.cmp(O)!==0;he++)ie=ie.redSqr();t(he<Q);var ve=this.pow(C,new a(1).iushln(Q-he-1));W=W.redMul(ve),C=ve.redSqr(),V=V.redMul(C),Q=he}return W},X.prototype.invm=function(m){var x=m._invmp(this.m);return x.negative!==0?(x.negative=0,this.imod(x).redNeg()):this.imod(x)},X.prototype.pow=function(m,x){if(x.isZero())return new a(1).toRed(this);if(x.cmpn(1)===0)return m.clone();var w=4,I=new Array(1<<w);I[0]=new a(1).toRed(this),I[1]=m;for(var k=2;k<I.length;k++)I[k]=this.mul(I[k-1],m);var O=I[0],E=0,A=0,g=x.bitLength()%26;for(g===0&&(g=26),k=x.length-1;k>=0;k--){for(var C=x.words[k],W=g-1;W>=0;W--){var V=C>>W&1;if(O!==I[0]&&(O=this.sqr(O)),V===0&&E===0){A=0;continue}E<<=1,E|=V,A++,!(A!==w&&(k!==0||W!==0))&&(O=this.mul(O,I[E]),A=0,E=0)}g=26}return O},X.prototype.convertTo=function(m){var x=m.umod(this.m);return x===m?x.clone():x},X.prototype.convertFrom=function(m){var x=m.clone();return x.red=null,x},a.mont=function(m){return new z(m)};function z(T){X.call(this,T),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new a(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}n(z,X),z.prototype.convertTo=function(m){return this.imod(m.ushln(this.shift))},z.prototype.convertFrom=function(m){var x=this.imod(m.mul(this.rinv));return x.red=null,x},z.prototype.imul=function(m,x){if(m.isZero()||x.isZero())return m.words[0]=0,m.length=1,m;var w=m.imul(x),I=w.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),k=w.isub(I).iushrn(this.shift),O=k;return k.cmp(this.m)>=0?O=k.isub(this.m):k.cmpn(0)<0&&(O=k.iadd(this.m)),O._forceRed(this)},z.prototype.mul=function(m,x){if(m.isZero()||x.isZero())return new a(0)._forceRed(this);var w=m.mul(x),I=w.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),k=w.isub(I).iushrn(this.shift),O=k;return k.cmp(this.m)>=0?O=k.isub(this.m):k.cmpn(0)<0&&(O=k.iadd(this.m)),O._forceRed(this)},z.prototype.invm=function(m){var x=this.imod(m._invmp(this.m).mul(this.r2));return x._forceRed(this)}})(typeof Hv>"u"||Hv,VM)});var zv=D(hr=>{"use strict";d();f();Object.defineProperty(hr,"__esModule",{value:!0});hr.KECCAK256_RLP=hr.KECCAK256_RLP_S=hr.KECCAK256_RLP_ARRAY=hr.KECCAK256_RLP_ARRAY_S=hr.KECCAK256_NULL=hr.KECCAK256_NULL_S=hr.TWO_POW256=hr.MAX_INTEGER=void 0;var Gv=Dp().Buffer,$M=Wo();hr.MAX_INTEGER=new $M("ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",16);hr.TWO_POW256=new $M("10000000000000000000000000000000000000000000000000000000000000000",16);hr.KECCAK256_NULL_S="c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470";hr.KECCAK256_NULL=Gv.from(hr.KECCAK256_NULL_S,"hex");hr.KECCAK256_RLP_ARRAY_S="1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347";hr.KECCAK256_RLP_ARRAY=Gv.from(hr.KECCAK256_RLP_ARRAY_S,"hex");hr.KECCAK256_RLP_S="56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421";hr.KECCAK256_RLP=Gv.from(hr.KECCAK256_RLP_S,"hex")});var mu=D(Fa=>{"use strict";d();f();Object.defineProperty(Fa,"__esModule",{value:!0});Fa.assertIsString=Fa.assertIsArray=Fa.assertIsBuffer=Fa.assertIsHexString=void 0;var YQ=Hc();Fa.assertIsHexString=function(r){if(!YQ.isHexString(r)){var e="This method only supports 0x-prefixed hex strings but input was: "+r;throw new Error(e)}};Fa.assertIsBuffer=function(r){if(!p.Buffer.isBuffer(r)){var e="This method only supports Buffer but input was: "+r;throw new Error(e)}};Fa.assertIsArray=function(r){if(!Array.isArray(r)){var e="This method only supports number arrays but input was: "+r;throw new Error(e)}};Fa.assertIsString=function(r){if(typeof r!="string"){var e="This method only supports strings but input was: "+r;throw new Error(e)}}});var xi=D(We=>{"use strict";d();f();Object.defineProperty(We,"__esModule",{value:!0});We.baToJSON=We.addHexPrefix=We.toUnsigned=We.fromSigned=We.bufferToHex=We.bufferToInt=We.toBuffer=We.unpadHexString=We.unpadArray=We.unpadBuffer=We.setLengthRight=We.setLengthLeft=We.zeros=void 0;var jv=Wo(),Kd=Hc(),gu=mu();We.zeros=function(r){return p.Buffer.allocUnsafe(r).fill(0)};We.setLengthLeft=function(r,e){return gu.assertIsBuffer(r),YM(r,e,!1)};We.setLengthRight=function(r,e){return gu.assertIsBuffer(r),YM(r,e,!0)};var YM=function(r,e,t){var n=We.zeros(e);return t?r.length<e?(r.copy(n),n):r.slice(0,e):r.length<e?(r.copy(n,e-r.length),n):r.slice(-e)};We.unpadBuffer=function(r){return gu.assertIsBuffer(r),Vv(r)};We.unpadArray=function(r){return gu.assertIsArray(r),Vv(r)};We.unpadHexString=function(r){return gu.assertIsHexString(r),r=Kd.stripHexPrefix(r),Vv(r)};var Vv=function(r){for(var e=r[0];r.length>0&&e.toString()==="0";)r=r.slice(1),e=r[0];return r};We.toBuffer=function(r){if(r==null)return p.Buffer.allocUnsafe(0);if(p.Buffer.isBuffer(r))return p.Buffer.from(r);if(Array.isArray(r)||r instanceof Uint8Array)return p.Buffer.from(r);if(typeof r=="string"){if(!Kd.isHexString(r))throw new Error("Cannot convert string to buffer. toBuffer only supports 0x-prefixed hex strings and this string was given: "+r);return p.Buffer.from(Kd.padToEven(Kd.stripHexPrefix(r)),"hex")}if(typeof r=="number")return Kd.intToBuffer(r);if(jv.isBN(r))return r.toArrayLike(p.Buffer);if(r.toArray)return p.Buffer.from(r.toArray());if(r.toBuffer)return p.Buffer.from(r.toBuffer());throw new Error("invalid type")};We.bufferToInt=function(r){return new jv(We.toBuffer(r)).toNumber()};We.bufferToHex=function(r){return r=We.toBuffer(r),"0x"+r.toString("hex")};We.fromSigned=function(r){return new jv(r).fromTwos(256)};We.toUnsigned=function(r){return p.Buffer.from(r.toTwos(256).toArray())};We.addHexPrefix=function(r){return typeof r!="string"||Kd.isHexPrefixed(r)?r:"0x"+r};We.baToJSON=function(r){if(p.Buffer.isBuffer(r))return"0x"+r.toString("hex");if(r instanceof Array){for(var e=[],t=0;t<r.length;t++)e.push(We.baToJSON(r[t]));return e}}});var Vm=D(Fe=>{"use strict";d();f();Object.defineProperty(Fe,"__esModule",{value:!0});Fe.rlphash=Fe.ripemd160FromArray=Fe.ripemd160FromString=Fe.ripemd160=Fe.sha256FromArray=Fe.sha256FromString=Fe.sha256=Fe.keccakFromArray=Fe.keccakFromHexString=Fe.keccakFromString=Fe.keccak256=Fe.keccak=void 0;var jm=a$(),JQ=jm.keccak224,XQ=jm.keccak384,ZQ=jm.keccak256,QQ=jm.keccak512,JM=wx(),eee=Pl(),bu=xi(),Ha=mu();Fe.keccak=function(r,e){switch(e===void 0&&(e=256),Ha.assertIsBuffer(r),e){case 224:return JQ(r);case 256:return ZQ(r);case 384:return XQ(r);case 512:return QQ(r);default:throw new Error("Invald algorithm: keccak"+e)}};Fe.keccak256=function(r){return Fe.keccak(r)};Fe.keccakFromString=function(r,e){e===void 0&&(e=256),Ha.assertIsString(r);var t=p.Buffer.from(r,"utf8");return Fe.keccak(t,e)};Fe.keccakFromHexString=function(r,e){return e===void 0&&(e=256),Ha.assertIsHexString(r),Fe.keccak(bu.toBuffer(r),e)};Fe.keccakFromArray=function(r,e){return e===void 0&&(e=256),Ha.assertIsArray(r),Fe.keccak(bu.toBuffer(r),e)};Fe.sha256=function(r){return Ha.assertIsBuffer(r),$v(r)};Fe.sha256FromString=function(r){return Ha.assertIsString(r),$v(r)};Fe.sha256FromArray=function(r){return Ha.assertIsArray(r),$v(r)};var $v=function(r){return r=bu.toBuffer(r),JM("sha256").update(r).digest()};Fe.ripemd160=function(r,e){return Ha.assertIsBuffer(r),Yv(r,e)};Fe.ripemd160FromString=function(r,e){return Ha.assertIsString(r),Yv(r,e)};Fe.ripemd160FromArray=function(r,e){return Ha.assertIsArray(r),Yv(r,e)};var Yv=function(r,e){r=bu.toBuffer(r);var t=JM("rmd160").update(r).digest();return e===!0?bu.setLengthLeft(t,32):t};Fe.rlphash=function(r){return Fe.keccak(eee.encode(r))}});var Jv=D(qd=>{"use strict";d();f();Object.defineProperty(qd,"__esModule",{value:!0});qd.bnToRlp=qd.bnToHex=void 0;var tee=xi();function ree(r){return"0x"+r.toString(16)}qd.bnToHex=ree;function nee(r){return tee.unpadBuffer(r.toArrayLike(p.Buffer))}qd.bnToRlp=nee});var Zv=D(Se=>{"use strict";d();f();Object.defineProperty(Se,"__esModule",{value:!0});Se.isZeroAddress=Se.zeroAddress=Se.importPublic=Se.privateToPublic=Se.privateToAddress=Se.publicToAddress=Se.pubToAddress=Se.isValidPublic=Se.isValidPrivate=Se.generateAddress2=Se.generateAddress=Se.isValidChecksumAddress=Se.toChecksumAddress=Se.isValidAddress=Se.Account=void 0;var Xv=El(),Es=Wo(),XM=Pl(),aee=Hc(),$m=zv(),Ud=xi(),Fd=Vm(),Zn=mu(),ZM=Jv(),Ym=N_(),see=Ym.privateKeyVerify,iee=Ym.publicKeyCreate,QM=Ym.publicKeyVerify,eN=Ym.publicKeyConvert,oee=function(){function r(e,t,n,a){e===void 0&&(e=new Es(0)),t===void 0&&(t=new Es(0)),n===void 0&&(n=$m.KECCAK256_RLP),a===void 0&&(a=$m.KECCAK256_NULL),this.nonce=e,this.balance=t,this.stateRoot=n,this.codeHash=a,this._validate()}return r.fromAccountData=function(e){var t=e.nonce,n=e.balance,a=e.stateRoot,s=e.codeHash;return new r(t?new Es(Ud.toBuffer(t)):void 0,n?new Es(Ud.toBuffer(n)):void 0,a?Ud.toBuffer(a):void 0,s?Ud.toBuffer(s):void 0)},r.fromRlpSerializedAccount=function(e){var t=XM.decode(e);if(!Array.isArray(t))throw new Error("Invalid serialized account input. Must be array");return this.fromValuesArray(t)},r.fromValuesArray=function(e){var t=e[0],n=e[1],a=e[2],s=e[3];return new r(t?new Es(t):void 0,n?new Es(n):void 0,a,s)},r.prototype._validate=function(){if(this.nonce.lt(new Es(0)))throw new Error("nonce must be greater than zero");if(this.balance.lt(new Es(0)))throw new Error("balance must be greater than zero");if(this.stateRoot.length!==32)throw new Error("stateRoot must have a length of 32");if(this.codeHash.length!==32)throw new Error("codeHash must have a length of 32")},r.prototype.raw=function(){return[ZM.bnToRlp(this.nonce),ZM.bnToRlp(this.balance),this.stateRoot,this.codeHash]},r.prototype.serialize=function(){return XM.encode(this.raw())},r.prototype.isContract=function(){return!this.codeHash.equals($m.KECCAK256_NULL)},r.prototype.isEmpty=function(){return this.balance.isZero()&&this.nonce.isZero()&&this.codeHash.equals($m.KECCAK256_NULL)},r}();Se.Account=oee;Se.isValidAddress=function(r){return Zn.assertIsHexString(r),/^0x[0-9a-fA-F]{40}$/.test(r)};Se.toChecksumAddress=function(r,e){Zn.assertIsHexString(r);for(var t=aee.stripHexPrefix(r).toLowerCase(),n=e!==void 0?e.toString()+"0x":"",a=Fd.keccakFromString(n+t).toString("hex"),s="0x",i=0;i<t.length;i++)parseInt(a[i],16)>=8?s+=t[i].toUpperCase():s+=t[i];return s};Se.isValidChecksumAddress=function(r,e){return Se.isValidAddress(r)&&Se.toChecksumAddress(r,e)===r};Se.generateAddress=function(r,e){Zn.assertIsBuffer(r),Zn.assertIsBuffer(e);var t=new Es(e);return t.isZero()?Fd.rlphash([r,null]).slice(-20):Fd.rlphash([r,p.Buffer.from(t.toArray())]).slice(-20)};Se.generateAddress2=function(r,e,t){Zn.assertIsBuffer(r),Zn.assertIsBuffer(e),Zn.assertIsBuffer(t),Xv(r.length===20),Xv(e.length===32);var n=Fd.keccak256(p.Buffer.concat([p.Buffer.from("ff","hex"),r,e,Fd.keccak256(t)]));return n.slice(-20)};Se.isValidPrivate=function(r){return see(r)};Se.isValidPublic=function(r,e){return e===void 0&&(e=!1),Zn.assertIsBuffer(r),r.length===64?QM(p.Buffer.concat([p.Buffer.from([4]),r])):e?QM(r):!1};Se.pubToAddress=function(r,e){return e===void 0&&(e=!1),Zn.assertIsBuffer(r),e&&r.length!==64&&(r=p.Buffer.from(eN(r,!1).slice(1))),Xv(r.length===64),Fd.keccak(r).slice(-20)};Se.publicToAddress=Se.pubToAddress;Se.privateToAddress=function(r){return Se.publicToAddress(Se.privateToPublic(r))};Se.privateToPublic=function(r){return Zn.assertIsBuffer(r),p.Buffer.from(iee(r,!1)).slice(1)};Se.importPublic=function(r){return Zn.assertIsBuffer(r),r.length!==64&&(r=p.Buffer.from(eN(r,!1).slice(1))),r};Se.zeroAddress=function(){var r=20,e=Ud.zeros(r);return Ud.bufferToHex(e)};Se.isZeroAddress=function(r){Zn.assertIsHexString(r);var e=Se.zeroAddress();return e===r}});var rN=D(Jm=>{"use strict";d();f();Object.defineProperty(Jm,"__esModule",{value:!0});Jm.Address=void 0;var Ko=El(),cee=Wo(),tN=xi(),yu=Zv(),dee=function(){function r(e){Ko(e.length===20,"Invalid address length"),this.buf=e}return r.zero=function(){return new r(tN.zeros(20))},r.fromString=function(e){return Ko(yu.isValidAddress(e),"Invalid address"),new r(tN.toBuffer(e))},r.fromPublicKey=function(e){Ko(p.Buffer.isBuffer(e),"Public key should be Buffer");var t=yu.pubToAddress(e);return new r(t)},r.fromPrivateKey=function(e){Ko(p.Buffer.isBuffer(e),"Private key should be Buffer");var t=yu.privateToAddress(e);return new r(t)},r.generate=function(e,t){return Ko(cee.isBN(t)),new r(yu.generateAddress(e.buf,t.toArrayLike(p.Buffer)))},r.generate2=function(e,t,n){return Ko(p.Buffer.isBuffer(t)),Ko(p.Buffer.isBuffer(n)),new r(yu.generateAddress2(e.buf,t,n))},r.prototype.equals=function(e){return this.buf.equals(e.buf)},r.prototype.isZero=function(){return this.equals(r.zero())},r.prototype.toString=function(){return"0x"+this.buf.toString("hex")},r.prototype.toBuffer=function(){return p.Buffer.from(this.buf)},r}();Jm.Address=dee});var nN=D(vn=>{"use strict";d();f();Object.defineProperty(vn,"__esModule",{value:!0});vn.hashPersonalMessage=vn.isValidSignature=vn.fromRpcSig=vn.toRpcSig=vn.ecrecover=vn.ecsign=void 0;var Qv=N_(),fee=Qv.ecdsaSign,lee=Qv.ecdsaRecover,uee=Qv.publicKeyConvert,Xm=Wo(),wi=xi(),hee=Vm(),pee=mu();vn.ecsign=function(r,e,t){var n=fee(r,e),a=n.recid,s={r:p.Buffer.from(n.signature.slice(0,32)),s:p.Buffer.from(n.signature.slice(32,64)),v:t?a+(t*2+35):a+27};return s};vn.ecrecover=function(r,e,t,n,a){var s=p.Buffer.concat([wi.setLengthLeft(t,32),wi.setLengthLeft(n,32)],64),i=e1(e,a);if(!t1(i))throw new Error("Invalid signature v value");var o=lee(s,i,r);return p.Buffer.from(uee(o,!1).slice(1))};vn.toRpcSig=function(r,e,t,n){var a=e1(r,n);if(!t1(a))throw new Error("Invalid signature v value");return wi.bufferToHex(p.Buffer.concat([wi.setLengthLeft(e,32),wi.setLengthLeft(t,32),wi.toBuffer(r)]))};vn.fromRpcSig=function(r){var e=wi.toBuffer(r);if(e.length<65)throw new Error("Invalid signature length");var t=wi.bufferToInt(e.slice(64));return t<27&&(t+=27),{v:t,r:e.slice(0,32),s:e.slice(32,64)}};vn.isValidSignature=function(r,e,t,n,a){n===void 0&&(n=!0);var s=new Xm("7fffffffffffffffffffffffffffffff5d576e7357a4501ddfe92f46681b20a0",16),i=new Xm("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",16);if(e.length!==32||t.length!==32||!t1(e1(r,a)))return!1;var o=new Xm(e),c=new Xm(t);return!(o.isZero()||o.gt(i)||c.isZero()||c.gt(i)||n&&c.cmp(s)===1)};vn.hashPersonalMessage=function(r){pee.assertIsBuffer(r);var e=p.Buffer.from(`Ethereum Signed Message:
`+r.length.toString(),"utf-8");return hee.keccak(p.Buffer.concat([e,r]))};function e1(r,e){return e?r-(2*e+35):r-27}function t1(r){return r===0||r===1}});var iN=D(Qm=>{"use strict";d();f();Object.defineProperty(Qm,"__esModule",{value:!0});Qm.defineProperties=void 0;var mee=Hc(),aN=El(),sN=Pl(),Zm=xi();Qm.defineProperties=function(r,e,t){if(r.raw=[],r._fields=[],r.toJSON=function(a){if(a===void 0&&(a=!1),a){var s={};return r._fields.forEach(function(i){s[i]="0x"+r[i].toString("hex")}),s}return Zm.baToJSON(r.raw)},r.serialize=function(){return sN.encode(r.raw)},e.forEach(function(a,s){r._fields.push(a.name);function i(){return r.raw[s]}function o(c){c=Zm.toBuffer(c),c.toString("hex")==="00"&&!a.allowZero&&(c=p.Buffer.allocUnsafe(0)),a.allowLess&&a.length?(c=Zm.unpadBuffer(c),aN(a.length>=c.length,"The field "+a.name+" must not have more "+a.length+" bytes")):!(a.allowZero&&c.length===0)&&a.length&&aN(a.length===c.length,"The field "+a.name+" must have byte length of "+a.length),r.raw[s]=c}Object.defineProperty(r,a.name,{enumerable:!0,configurable:!0,get:i,set:o}),a.default&&(r[a.name]=a.default),a.alias&&Object.defineProperty(r,a.alias,{enumerable:!1,configurable:!0,set:o,get:i})}),t)if(typeof t=="string"&&(t=p.Buffer.from(mee.stripHexPrefix(t),"hex")),p.Buffer.isBuffer(t)&&(t=sN.decode(t)),Array.isArray(t)){if(t.length>r._fields.length)throw new Error("wrong number of fields in data");t.forEach(function(a,s){r[r._fields[s]]=Zm.toBuffer(a)})}else if(typeof t=="object"){var n=Object.keys(t);e.forEach(function(a){n.indexOf(a.name)!==-1&&(r[a.name]=t[a.name]),n.indexOf(a.alias)!==-1&&(r[a.alias]=t[a.alias])})}else throw new Error("invalid data")}});var oN=D(Hd=>{"use strict";d();f();Object.defineProperty(Hd,"__esModule",{value:!0});Hd.rlp=Hd.BN=void 0;var gee=Wo();Hd.BN=gee;var bee=Pl();Hd.rlp=bee});var r1=D(an=>{"use strict";d();f();var yee=an&&an.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Ga=an&&an.__exportStar||function(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&yee(e,r,t)};Object.defineProperty(an,"__esModule",{value:!0});Ga(zv(),an);Ga(Zv(),an);Ga(rN(),an);Ga(Vm(),an);Ga(nN(),an);Ga(xi(),an);Ga(iN(),an);Ga(oN(),an);Ga(Jv(),an);Ga(Hc(),an)});var cN=D(n1=>{"use strict";d();f();Object.defineProperty(n1,"__esModule",{value:!0});var xee=ZV().ripemd160,wee=M_();n1.ripemd160=wee.createHashFunction(function(){return new xee})});var dN=D(a1=>{"use strict";d();f();Object.defineProperty(a1,"__esModule",{value:!0});var vee=XV(),See=M_();a1.sha256=See.createHashFunction(function(){return new vee})});var lN=D(xu=>{"use strict";d();f();Object.defineProperty(xu,"__esModule",{value:!0});var _ee=cN(),Aee=dN();xu.createHmac=JV();xu.randomBytes=N4();var fN=function(){function r(e){this.hashFunction=e,this.buffers=[]}return r.prototype.update=function(e){if(!p.Buffer.isBuffer(e))throw new Error("hdkey-crypto shim is outdated");return this.buffers.push(e),this},r.prototype.digest=function(e){if(e)throw new Error("hdkey-crypto shim is outdated");return this.hashFunction(p.Buffer.concat(this.buffers))},r}();xu.createHash=function(r){if(r==="ripemd160")return new fN(_ee.ripemd160);if(r==="sha256")return new fN(Aee.sha256);throw new Error("hdkey-crypto shim is outdated")}});var uN=D(Qn=>{"use strict";d();f();var Cee=Qn&&Qn.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e};Object.defineProperty(Qn,"__esModule",{value:!0});var vi=Cee(s$());function Tee(r){return vi.privateKeyVerify(r)}Qn.privateKeyVerify=Tee;function Iee(r,e){return e===void 0&&(e=!0),p.Buffer.from(vi.publicKeyCreate(r,e))}Qn.publicKeyCreate=Iee;function Eee(r){return vi.publicKeyVerify(r)}Qn.publicKeyVerify=Eee;function Pee(r,e){return e===void 0&&(e=!0),p.Buffer.from(vi.publicKeyConvert(r,e))}Qn.publicKeyConvert=Pee;function Mee(r,e){return p.Buffer.from(vi.privateKeyTweakAdd(p.Buffer.from(r),e))}Qn.privateKeyTweakAdd=Mee;function Nee(r,e,t){return t===void 0&&(t=!0),p.Buffer.from(vi.publicKeyTweakAdd(p.Buffer.from(r),e,t))}Qn.publicKeyTweakAdd=Nee;function Ree(r,e){var t=vi.ecdsaSign(r,e);return{signature:p.Buffer.from(t.signature),recovery:t.recid}}Qn.sign=Ree;function kee(r,e,t){return vi.ecdsaVerify(e,r,t)}Qn.verify=kee});var hN=D(eg=>{"use strict";d();f();function Oee(r){for(var e in r)eg.hasOwnProperty(e)||(eg[e]=r[e])}Object.defineProperty(eg,"__esModule",{value:!0});Oee(uN())});var yN=D((S6e,bN)=>{"use strict";d();f();function s1(r){return r&&typeof r=="object"&&"default"in r?r.default:r}var za=s1(El()),Dee=s1(ho()),i1=s1(k_()),wu=lN(),Si=hN(),Ps=Dee.Buffer,Lee=Ps.from("Bitcoin seed","utf8"),tg=2147483648,Bee=78,pN={private:76066276,public:76067358};function ar(r){this.versions=r||pN,this.depth=0,this.index=0,this._privateKey=null,this._publicKey=null,this.chainCode=null,this._fingerprint=0,this.parentFingerprint=0}Object.defineProperty(ar.prototype,"fingerprint",{get:function(){return this._fingerprint}});Object.defineProperty(ar.prototype,"identifier",{get:function(){return this._identifier}});Object.defineProperty(ar.prototype,"pubKeyHash",{get:function(){return this.identifier}});Object.defineProperty(ar.prototype,"privateKey",{get:function(){return this._privateKey},set:function(r){za.equal(r.length,32,"Private key must be 32 bytes."),za(Si.privateKeyVerify(r)===!0,"Invalid private key"),this._privateKey=r,this._publicKey=Si.publicKeyCreate(r,!0),this._identifier=gN(this.publicKey),this._fingerprint=this._identifier.slice(0,4).readUInt32BE(0)}});Object.defineProperty(ar.prototype,"publicKey",{get:function(){return this._publicKey},set:function(r){za(r.length===33||r.length===65,"Public key must be 33 or 65 bytes."),za(Si.publicKeyVerify(r)===!0,"Invalid public key"),this._publicKey=Si.publicKeyConvert(r,!0),this._identifier=gN(this.publicKey),this._fingerprint=this._identifier.slice(0,4).readUInt32BE(0),this._privateKey=null}});Object.defineProperty(ar.prototype,"privateExtendedKey",{get:function(){return this._privateKey?i1.encode(mN(this,this.versions.private,Ps.concat([Ps.alloc(1,0),this.privateKey]))):null}});Object.defineProperty(ar.prototype,"publicExtendedKey",{get:function(){return i1.encode(mN(this,this.versions.public,this.publicKey))}});ar.prototype.derive=function(r){if(r==="m"||r==="M"||r==="m'"||r==="M'")return this;var e=r.split("/"),t=this;return e.forEach(function(n,a){if(a===0){za(/^[mM]{1}/.test(n),'Path must start with "m" or "M"');return}var s=n.length>1&&n[n.length-1]==="'",i=parseInt(n,10);za(i<tg,"Invalid index"),s&&(i+=tg),t=t.deriveChild(i)}),t};ar.prototype.deriveChild=function(r){var e=r>=tg,t=Ps.allocUnsafe(4);t.writeUInt32BE(r,0);var n;if(e){za(this.privateKey,"Could not derive hardened child key");var a=this.privateKey,s=Ps.alloc(1,0);a=Ps.concat([s,a]),n=Ps.concat([a,t])}else n=Ps.concat([this.publicKey,t]);var i=wu.createHmac("sha512",this.chainCode).update(n).digest(),o=i.slice(0,32),c=i.slice(32),l=new ar(this.versions);if(this.privateKey)try{l.privateKey=Si.privateKeyTweakAdd(this.privateKey,o)}catch{return this.deriveChild(r+1)}else try{l.publicKey=Si.publicKeyTweakAdd(this.publicKey,o,!0)}catch{return this.deriveChild(r+1)}return l.chainCode=c,l.depth=this.depth+1,l.parentFingerprint=this.fingerprint,l.index=r,l};ar.prototype.sign=function(r){return Si.sign(r,this.privateKey).signature};ar.prototype.verify=function(r,e){return Si.verify(r,e,this.publicKey)};ar.prototype.wipePrivateData=function(){return this._privateKey&&wu.randomBytes(this._privateKey.length).copy(this._privateKey),this._privateKey=null,this};ar.prototype.toJSON=function(){return{xpriv:this.privateExtendedKey,xpub:this.publicExtendedKey}};ar.fromMasterSeed=function(r,e){var t=wu.createHmac("sha512",Lee).update(r).digest(),n=t.slice(0,32),a=t.slice(32),s=new ar(e);return s.chainCode=a,s.privateKey=n,s};ar.fromExtendedKey=function(r,e){e=e||pN;var t=new ar(e),n=i1.decode(r),a=n.readUInt32BE(0);za(a===e.private||a===e.public,"Version mismatch: does not match private or public"),t.depth=n.readUInt8(4),t.parentFingerprint=n.readUInt32BE(5),t.index=n.readUInt32BE(9),t.chainCode=n.slice(13,45);var s=n.slice(45);return s.readUInt8(0)===0?(za(a===e.private,"Version mismatch: version does not match private"),t.privateKey=s.slice(1)):(za(a===e.public,"Version mismatch: version does not match public"),t.publicKey=s),t};ar.fromJSON=function(r){return ar.fromExtendedKey(r.xpriv)};function mN(r,e,t){var n=Ps.allocUnsafe(Bee);n.writeUInt32BE(e,0),n.writeUInt8(r.depth,4);var a=r.depth?r.parentFingerprint:0;return n.writeUInt32BE(a,5),n.writeUInt32BE(r.index,9),r.chainCode.copy(n,13),t.copy(n,45),n}function gN(r){var e=wu.createHash("sha256").update(r).digest();return wu.createHash("ripemd160").update(e).digest()}ar.HARDENED_OFFSET=tg;var Wee=ar;bN.exports=Wee});var xN=D(o1=>{"use strict";d();f();Object.defineProperty(o1,"__esModule",{value:!0});var Kee=yN();o1.HDKey=Kee});var SN=D(c1=>{"use strict";d();f();Object.defineProperty(c1,"__esModule",{value:!0});var wN=rg(),vN=xN(),qee=function(){function r(e){this._hdkey=e}return r.fromMasterSeed=function(e){return new r(vN.HDKey.fromMasterSeed(e))},r.fromExtendedKey=function(e){return new r(vN.HDKey.fromExtendedKey(e))},r.prototype.privateExtendedKey=function(){if(!this._hdkey.privateExtendedKey)throw new Error("This is a public key only wallet");return this._hdkey.privateExtendedKey},r.prototype.publicExtendedKey=function(){return this._hdkey.publicExtendedKey},r.prototype.derivePath=function(e){return new r(this._hdkey.derive(e))},r.prototype.deriveChild=function(e){return new r(this._hdkey.deriveChild(e))},r.prototype.getWallet=function(){return this._hdkey._privateKey?wN.default.fromPrivateKey(this._hdkey._privateKey):wN.default.fromPublicKey(this._hdkey._publicKey,!0)},r}();c1.default=qee});var AN=D((d1,_N)=>{d();f();(function(r){"use strict";function e(E){return parseInt(E)===E}function t(E){if(!e(E.length))return!1;for(var A=0;A<E.length;A++)if(!e(E[A])||E[A]<0||E[A]>255)return!1;return!0}function n(E,A){if(E.buffer&&E.name==="Uint8Array")return A&&(E.slice?E=E.slice():E=Array.prototype.slice.call(E)),E;if(Array.isArray(E)){if(!t(E))throw new Error("Array contains invalid value: "+E);return new Uint8Array(E)}if(e(E.length)&&t(E))return new Uint8Array(E);throw new Error("unsupported array-like object")}function a(E){return new Uint8Array(E)}function s(E,A,g,C,W){(C!=null||W!=null)&&(E.slice?E=E.slice(C,W):E=Array.prototype.slice.call(E,C,W)),A.set(E,g)}var i=function(){function E(g){var C=[],W=0;for(g=encodeURI(g);W<g.length;){var V=g.charCodeAt(W++);V===37?(C.push(parseInt(g.substr(W,2),16)),W+=2):C.push(V)}return n(C)}function A(g){for(var C=[],W=0;W<g.length;){var V=g[W];V<128?(C.push(String.fromCharCode(V)),W++):V>191&&V<224?(C.push(String.fromCharCode((V&31)<<6|g[W+1]&63)),W+=2):(C.push(String.fromCharCode((V&15)<<12|(g[W+1]&63)<<6|g[W+2]&63)),W+=3)}return C.join("")}return{toBytes:E,fromBytes:A}}(),o=function(){function E(C){for(var W=[],V=0;V<C.length;V+=2)W.push(parseInt(C.substr(V,2),16));return W}var A="0123456789abcdef";function g(C){for(var W=[],V=0;V<C.length;V++){var Q=C[V];W.push(A[(Q&240)>>4]+A[Q&15])}return W.join("")}return{toBytes:E,fromBytes:g}}(),c={16:10,24:12,32:14},l=[1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145],u=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],h=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125],b=[3328402341,4168907908,4000806809,4135287693,4294111757,3597364157,3731845041,2445657428,1613770832,33620227,3462883241,1445669757,3892248089,3050821474,1303096294,3967186586,2412431941,528646813,2311702848,4202528135,4026202645,2992200171,2387036105,4226871307,1101901292,3017069671,1604494077,1169141738,597466303,1403299063,3832705686,2613100635,1974974402,3791519004,1033081774,1277568618,1815492186,2118074177,4126668546,2211236943,1748251740,1369810420,3521504564,4193382664,3799085459,2883115123,1647391059,706024767,134480908,2512897874,1176707941,2646852446,806885416,932615841,168101135,798661301,235341577,605164086,461406363,3756188221,3454790438,1311188841,2142417613,3933566367,302582043,495158174,1479289972,874125870,907746093,3698224818,3025820398,1537253627,2756858614,1983593293,3084310113,2108928974,1378429307,3722699582,1580150641,327451799,2790478837,3117535592,0,3253595436,1075847264,3825007647,2041688520,3059440621,3563743934,2378943302,1740553945,1916352843,2487896798,2555137236,2958579944,2244988746,3151024235,3320835882,1336584933,3992714006,2252555205,2588757463,1714631509,293963156,2319795663,3925473552,67240454,4269768577,2689618160,2017213508,631218106,1269344483,2723238387,1571005438,2151694528,93294474,1066570413,563977660,1882732616,4059428100,1673313503,2008463041,2950355573,1109467491,537923632,3858759450,4260623118,3218264685,2177748300,403442708,638784309,3287084079,3193921505,899127202,2286175436,773265209,2479146071,1437050866,4236148354,2050833735,3362022572,3126681063,840505643,3866325909,3227541664,427917720,2655997905,2749160575,1143087718,1412049534,999329963,193497219,2353415882,3354324521,1807268051,672404540,2816401017,3160301282,369822493,2916866934,3688947771,1681011286,1949973070,336202270,2454276571,201721354,1210328172,3093060836,2680341085,3184776046,1135389935,3294782118,965841320,831886756,3554993207,4068047243,3588745010,2345191491,1849112409,3664604599,26054028,2983581028,2622377682,1235855840,3630984372,2891339514,4092916743,3488279077,3395642799,4101667470,1202630377,268961816,1874508501,4034427016,1243948399,1546530418,941366308,1470539505,1941222599,2546386513,3421038627,2715671932,3899946140,1042226977,2521517021,1639824860,227249030,260737669,3765465232,2084453954,1907733956,3429263018,2420656344,100860677,4160157185,470683154,3261161891,1781871967,2924959737,1773779408,394692241,2579611992,974986535,664706745,3655459128,3958962195,731420851,571543859,3530123707,2849626480,126783113,865375399,765172662,1008606754,361203602,3387549984,2278477385,2857719295,1344809080,2782912378,59542671,1503764984,160008576,437062935,1707065306,3622233649,2218934982,3496503480,2185314755,697932208,1512910199,504303377,2075177163,2824099068,1841019862,739644986],y=[2781242211,2230877308,2582542199,2381740923,234877682,3184946027,2984144751,1418839493,1348481072,50462977,2848876391,2102799147,434634494,1656084439,3863849899,2599188086,1167051466,2636087938,1082771913,2281340285,368048890,3954334041,3381544775,201060592,3963727277,1739838676,4250903202,3930435503,3206782108,4149453988,2531553906,1536934080,3262494647,484572669,2923271059,1783375398,1517041206,1098792767,49674231,1334037708,1550332980,4098991525,886171109,150598129,2481090929,1940642008,1398944049,1059722517,201851908,1385547719,1699095331,1587397571,674240536,2704774806,252314885,3039795866,151914247,908333586,2602270848,1038082786,651029483,1766729511,3447698098,2682942837,454166793,2652734339,1951935532,775166490,758520603,3000790638,4004797018,4217086112,4137964114,1299594043,1639438038,3464344499,2068982057,1054729187,1901997871,2534638724,4121318227,1757008337,0,750906861,1614815264,535035132,3363418545,3988151131,3201591914,1183697867,3647454910,1265776953,3734260298,3566750796,3903871064,1250283471,1807470800,717615087,3847203498,384695291,3313910595,3617213773,1432761139,2484176261,3481945413,283769337,100925954,2180939647,4037038160,1148730428,3123027871,3813386408,4087501137,4267549603,3229630528,2315620239,2906624658,3156319645,1215313976,82966005,3747855548,3245848246,1974459098,1665278241,807407632,451280895,251524083,1841287890,1283575245,337120268,891687699,801369324,3787349855,2721421207,3431482436,959321879,1469301956,4065699751,2197585534,1199193405,2898814052,3887750493,724703513,2514908019,2696962144,2551808385,3516813135,2141445340,1715741218,2119445034,2872807568,2198571144,3398190662,700968686,3547052216,1009259540,2041044702,3803995742,487983883,1991105499,1004265696,1449407026,1316239930,504629770,3683797321,168560134,1816667172,3837287516,1570751170,1857934291,4014189740,2797888098,2822345105,2754712981,936633572,2347923833,852879335,1133234376,1500395319,3084545389,2348912013,1689376213,3533459022,3762923945,3034082412,4205598294,133428468,634383082,2949277029,2398386810,3913789102,403703816,3580869306,2297460856,1867130149,1918643758,607656988,4049053350,3346248884,1368901318,600565992,2090982877,2632479860,557719327,3717614411,3697393085,2249034635,2232388234,2430627952,1115438654,3295786421,2865522278,3633334344,84280067,33027830,303828494,2747425121,1600795957,4188952407,3496589753,2434238086,1486471617,658119965,3106381470,953803233,334231800,3005978776,857870609,3151128937,1890179545,2298973838,2805175444,3056442267,574365214,2450884487,550103529,1233637070,4289353045,2018519080,2057691103,2399374476,4166623649,2148108681,387583245,3664101311,836232934,3330556482,3100665960,3280093505,2955516313,2002398509,287182607,3413881008,4238890068,3597515707,975967766],v=[1671808611,2089089148,2006576759,2072901243,4061003762,1807603307,1873927791,3310653893,810573872,16974337,1739181671,729634347,4263110654,3613570519,2883997099,1989864566,3393556426,2191335298,3376449993,2106063485,4195741690,1508618841,1204391495,4027317232,2917941677,3563566036,2734514082,2951366063,2629772188,2767672228,1922491506,3227229120,3082974647,4246528509,2477669779,644500518,911895606,1061256767,4144166391,3427763148,878471220,2784252325,3845444069,4043897329,1905517169,3631459288,827548209,356461077,67897348,3344078279,593839651,3277757891,405286936,2527147926,84871685,2595565466,118033927,305538066,2157648768,3795705826,3945188843,661212711,2999812018,1973414517,152769033,2208177539,745822252,439235610,455947803,1857215598,1525593178,2700827552,1391895634,994932283,3596728278,3016654259,695947817,3812548067,795958831,2224493444,1408607827,3513301457,0,3979133421,543178784,4229948412,2982705585,1542305371,1790891114,3410398667,3201918910,961245753,1256100938,1289001036,1491644504,3477767631,3496721360,4012557807,2867154858,4212583931,1137018435,1305975373,861234739,2241073541,1171229253,4178635257,33948674,2139225727,1357946960,1011120188,2679776671,2833468328,1374921297,2751356323,1086357568,2408187279,2460827538,2646352285,944271416,4110742005,3168756668,3066132406,3665145818,560153121,271589392,4279952895,4077846003,3530407890,3444343245,202643468,322250259,3962553324,1608629855,2543990167,1154254916,389623319,3294073796,2817676711,2122513534,1028094525,1689045092,1575467613,422261273,1939203699,1621147744,2174228865,1339137615,3699352540,577127458,712922154,2427141008,2290289544,1187679302,3995715566,3100863416,339486740,3732514782,1591917662,186455563,3681988059,3762019296,844522546,978220090,169743370,1239126601,101321734,611076132,1558493276,3260915650,3547250131,2901361580,1655096418,2443721105,2510565781,3828863972,2039214713,3878868455,3359869896,928607799,1840765549,2374762893,3580146133,1322425422,2850048425,1823791212,1459268694,4094161908,3928346602,1706019429,2056189050,2934523822,135794696,3134549946,2022240376,628050469,779246638,472135708,2800834470,3032970164,3327236038,3894660072,3715932637,1956440180,522272287,1272813131,3185336765,2340818315,2323976074,1888542832,1044544574,3049550261,1722469478,1222152264,50660867,4127324150,236067854,1638122081,895445557,1475980887,3117443513,2257655686,3243809217,489110045,2662934430,3778599393,4162055160,2561878936,288563729,1773916777,3648039385,2391345038,2493985684,2612407707,505560094,2274497927,3911240169,3460925390,1442818645,678973480,3749357023,2358182796,2717407649,2306869641,219617805,3218761151,3862026214,1120306242,1756942440,1103331905,2578459033,762796589,252780047,2966125488,1425844308,3151392187,372911126],S=[1667474886,2088535288,2004326894,2071694838,4075949567,1802223062,1869591006,3318043793,808472672,16843522,1734846926,724270422,4278065639,3621216949,2880169549,1987484396,3402253711,2189597983,3385409673,2105378810,4210693615,1499065266,1195886990,4042263547,2913856577,3570689971,2728590687,2947541573,2627518243,2762274643,1920112356,3233831835,3082273397,4261223649,2475929149,640051788,909531756,1061110142,4160160501,3435941763,875846760,2779116625,3857003729,4059105529,1903268834,3638064043,825316194,353713962,67374088,3351728789,589522246,3284360861,404236336,2526454071,84217610,2593830191,117901582,303183396,2155911963,3806477791,3958056653,656894286,2998062463,1970642922,151591698,2206440989,741110872,437923380,454765878,1852748508,1515908788,2694904667,1381168804,993742198,3604373943,3014905469,690584402,3823320797,791638366,2223281939,1398011302,3520161977,0,3991743681,538992704,4244381667,2981218425,1532751286,1785380564,3419096717,3200178535,960056178,1246420628,1280103576,1482221744,3486468741,3503319995,4025428677,2863326543,4227536621,1128514950,1296947098,859002214,2240123921,1162203018,4193849577,33687044,2139062782,1347481760,1010582648,2678045221,2829640523,1364325282,2745433693,1077985408,2408548869,2459086143,2644360225,943212656,4126475505,3166494563,3065430391,3671750063,555836226,269496352,4294908645,4092792573,3537006015,3452783745,202118168,320025894,3974901699,1600119230,2543297077,1145359496,387397934,3301201811,2812801621,2122220284,1027426170,1684319432,1566435258,421079858,1936954854,1616945344,2172753945,1330631070,3705438115,572679748,707427924,2425400123,2290647819,1179044492,4008585671,3099120491,336870440,3739122087,1583276732,185277718,3688593069,3772791771,842159716,976899700,168435220,1229577106,101059084,606366792,1549591736,3267517855,3553849021,2897014595,1650632388,2442242105,2509612081,3840161747,2038008818,3890688725,3368567691,926374254,1835907034,2374863873,3587531953,1313788572,2846482505,1819063512,1448540844,4109633523,3941213647,1701162954,2054852340,2930698567,134748176,3132806511,2021165296,623210314,774795868,471606328,2795958615,3031746419,3334885783,3907527627,3722280097,1953799400,522133822,1263263126,3183336545,2341176845,2324333839,1886425312,1044267644,3048588401,1718004428,1212733584,50529542,4143317495,235803164,1633788866,892690282,1465383342,3115962473,2256965911,3250673817,488449850,2661202215,3789633753,4177007595,2560144171,286339874,1768537042,3654906025,2391705863,2492770099,2610673197,505291324,2273808917,3924369609,3469625735,1431699370,673740880,3755965093,2358021891,2711746649,2307489801,218961690,3217021541,3873845719,1111672452,1751693520,1094828930,2576986153,757954394,252645662,2964376443,1414855848,3149649517,370555436],R=[1374988112,2118214995,437757123,975658646,1001089995,530400753,2902087851,1273168787,540080725,2910219766,2295101073,4110568485,1340463100,3307916247,641025152,3043140495,3736164937,632953703,1172967064,1576976609,3274667266,2169303058,2370213795,1809054150,59727847,361929877,3211623147,2505202138,3569255213,1484005843,1239443753,2395588676,1975683434,4102977912,2572697195,666464733,3202437046,4035489047,3374361702,2110667444,1675577880,3843699074,2538681184,1649639237,2976151520,3144396420,4269907996,4178062228,1883793496,2403728665,2497604743,1383856311,2876494627,1917518562,3810496343,1716890410,3001755655,800440835,2261089178,3543599269,807962610,599762354,33778362,3977675356,2328828971,2809771154,4077384432,1315562145,1708848333,101039829,3509871135,3299278474,875451293,2733856160,92987698,2767645557,193195065,1080094634,1584504582,3178106961,1042385657,2531067453,3711829422,1306967366,2438237621,1908694277,67556463,1615861247,429456164,3602770327,2302690252,1742315127,2968011453,126454664,3877198648,2043211483,2709260871,2084704233,4169408201,0,159417987,841739592,504459436,1817866830,4245618683,260388950,1034867998,908933415,168810852,1750902305,2606453969,607530554,202008497,2472011535,3035535058,463180190,2160117071,1641816226,1517767529,470948374,3801332234,3231722213,1008918595,303765277,235474187,4069246893,766945465,337553864,1475418501,2943682380,4003061179,2743034109,4144047775,1551037884,1147550661,1543208500,2336434550,3408119516,3069049960,3102011747,3610369226,1113818384,328671808,2227573024,2236228733,3535486456,2935566865,3341394285,496906059,3702665459,226906860,2009195472,733156972,2842737049,294930682,1206477858,2835123396,2700099354,1451044056,573804783,2269728455,3644379585,2362090238,2564033334,2801107407,2776292904,3669462566,1068351396,742039012,1350078989,1784663195,1417561698,4136440770,2430122216,775550814,2193862645,2673705150,1775276924,1876241833,3475313331,3366754619,270040487,3902563182,3678124923,3441850377,1851332852,3969562369,2203032232,3868552805,2868897406,566021896,4011190502,3135740889,1248802510,3936291284,699432150,832877231,708780849,3332740144,899835584,1951317047,4236429990,3767586992,866637845,4043610186,1106041591,2144161806,395441711,1984812685,1139781709,3433712980,3835036895,2664543715,1282050075,3240894392,1181045119,2640243204,25965917,4203181171,4211818798,3009879386,2463879762,3910161971,1842759443,2597806476,933301370,1509430414,3943906441,3467192302,3076639029,3776767469,2051518780,2631065433,1441952575,404016761,1942435775,1408749034,1610459739,3745345300,2017778566,3400528769,3110650942,941896748,3265478751,371049330,3168937228,675039627,4279080257,967311729,135050206,3635733660,1683407248,2076935265,3576870512,1215061108,3501741890],P=[1347548327,1400783205,3273267108,2520393566,3409685355,4045380933,2880240216,2471224067,1428173050,4138563181,2441661558,636813900,4233094615,3620022987,2149987652,2411029155,1239331162,1730525723,2554718734,3781033664,46346101,310463728,2743944855,3328955385,3875770207,2501218972,3955191162,3667219033,768917123,3545789473,692707433,1150208456,1786102409,2029293177,1805211710,3710368113,3065962831,401639597,1724457132,3028143674,409198410,2196052529,1620529459,1164071807,3769721975,2226875310,486441376,2499348523,1483753576,428819965,2274680428,3075636216,598438867,3799141122,1474502543,711349675,129166120,53458370,2592523643,2782082824,4063242375,2988687269,3120694122,1559041666,730517276,2460449204,4042459122,2706270690,3446004468,3573941694,533804130,2328143614,2637442643,2695033685,839224033,1973745387,957055980,2856345839,106852767,1371368976,4181598602,1033297158,2933734917,1179510461,3046200461,91341917,1862534868,4284502037,605657339,2547432937,3431546947,2003294622,3182487618,2282195339,954669403,3682191598,1201765386,3917234703,3388507166,0,2198438022,1211247597,2887651696,1315723890,4227665663,1443857720,507358933,657861945,1678381017,560487590,3516619604,975451694,2970356327,261314535,3535072918,2652609425,1333838021,2724322336,1767536459,370938394,182621114,3854606378,1128014560,487725847,185469197,2918353863,3106780840,3356761769,2237133081,1286567175,3152976349,4255350624,2683765030,3160175349,3309594171,878443390,1988838185,3704300486,1756818940,1673061617,3403100636,272786309,1075025698,545572369,2105887268,4174560061,296679730,1841768865,1260232239,4091327024,3960309330,3497509347,1814803222,2578018489,4195456072,575138148,3299409036,446754879,3629546796,4011996048,3347532110,3252238545,4270639778,915985419,3483825537,681933534,651868046,2755636671,3828103837,223377554,2607439820,1649704518,3270937875,3901806776,1580087799,4118987695,3198115200,2087309459,2842678573,3016697106,1003007129,2802849917,1860738147,2077965243,164439672,4100872472,32283319,2827177882,1709610350,2125135846,136428751,3874428392,3652904859,3460984630,3572145929,3593056380,2939266226,824852259,818324884,3224740454,930369212,2801566410,2967507152,355706840,1257309336,4148292826,243256656,790073846,2373340630,1296297904,1422699085,3756299780,3818836405,457992840,3099667487,2135319889,77422314,1560382517,1945798516,788204353,1521706781,1385356242,870912086,325965383,2358957921,2050466060,2388260884,2313884476,4006521127,901210569,3990953189,1014646705,1503449823,1062597235,2031621326,3212035895,3931371469,1533017514,350174575,2256028891,2177544179,1052338372,741876788,1606591296,1914052035,213705253,2334669897,1107234197,1899603969,3725069491,2631447780,2422494913,1635502980,1893020342,1950903388,1120974935],N=[2807058932,1699970625,2764249623,1586903591,1808481195,1173430173,1487645946,59984867,4199882800,1844882806,1989249228,1277555970,3623636965,3419915562,1149249077,2744104290,1514790577,459744698,244860394,3235995134,1963115311,4027744588,2544078150,4190530515,1608975247,2627016082,2062270317,1507497298,2200818878,567498868,1764313568,3359936201,2305455554,2037970062,1047239e3,1910319033,1337376481,2904027272,2892417312,984907214,1243112415,830661914,861968209,2135253587,2011214180,2927934315,2686254721,731183368,1750626376,4246310725,1820824798,4172763771,3542330227,48394827,2404901663,2871682645,671593195,3254988725,2073724613,145085239,2280796200,2779915199,1790575107,2187128086,472615631,3029510009,4075877127,3802222185,4107101658,3201631749,1646252340,4270507174,1402811438,1436590835,3778151818,3950355702,3963161475,4020912224,2667994737,273792366,2331590177,104699613,95345982,3175501286,2377486676,1560637892,3564045318,369057872,4213447064,3919042237,1137477952,2658625497,1119727848,2340947849,1530455833,4007360968,172466556,266959938,516552836,0,2256734592,3980931627,1890328081,1917742170,4294704398,945164165,3575528878,958871085,3647212047,2787207260,1423022939,775562294,1739656202,3876557655,2530391278,2443058075,3310321856,547512796,1265195639,437656594,3121275539,719700128,3762502690,387781147,218828297,3350065803,2830708150,2848461854,428169201,122466165,3720081049,1627235199,648017665,4122762354,1002783846,2117360635,695634755,3336358691,4234721005,4049844452,3704280881,2232435299,574624663,287343814,612205898,1039717051,840019705,2708326185,793451934,821288114,1391201670,3822090177,376187827,3113855344,1224348052,1679968233,2361698556,1058709744,752375421,2431590963,1321699145,3519142200,2734591178,188127444,2177869557,3727205754,2384911031,3215212461,2648976442,2450346104,3432737375,1180849278,331544205,3102249176,4150144569,2952102595,2159976285,2474404304,766078933,313773861,2570832044,2108100632,1668212892,3145456443,2013908262,418672217,3070356634,2594734927,1852171925,3867060991,3473416636,3907448597,2614737639,919489135,164948639,2094410160,2997825956,590424639,2486224549,1723872674,3157750862,3399941250,3501252752,3625268135,2555048196,3673637356,1343127501,4130281361,3599595085,2957853679,1297403050,81781910,3051593425,2283490410,532201772,1367295589,3926170974,895287692,1953757831,1093597963,492483431,3528626907,1446242576,1192455638,1636604631,209336225,344873464,1015671571,669961897,3375740769,3857572124,2973530695,3747192018,1933530610,3464042516,935293895,3454686199,2858115069,1863638845,3683022916,4085369519,3292445032,875313188,1080017571,3279033885,621591778,1233856572,2504130317,24197544,3017672716,3835484340,3247465558,2220981195,3060847922,1551124588,1463996600],M=[4104605777,1097159550,396673818,660510266,2875968315,2638606623,4200115116,3808662347,821712160,1986918061,3430322568,38544885,3856137295,718002117,893681702,1654886325,2975484382,3122358053,3926825029,4274053469,796197571,1290801793,1184342925,3556361835,2405426947,2459735317,1836772287,1381620373,3196267988,1948373848,3764988233,3385345166,3263785589,2390325492,1480485785,3111247143,3780097726,2293045232,548169417,3459953789,3746175075,439452389,1362321559,1400849762,1685577905,1806599355,2174754046,137073913,1214797936,1174215055,3731654548,2079897426,1943217067,1258480242,529487843,1437280870,3945269170,3049390895,3313212038,923313619,679998e3,3215307299,57326082,377642221,3474729866,2041877159,133361907,1776460110,3673476453,96392454,878845905,2801699524,777231668,4082475170,2330014213,4142626212,2213296395,1626319424,1906247262,1846563261,562755902,3708173718,1040559837,3871163981,1418573201,3294430577,114585348,1343618912,2566595609,3186202582,1078185097,3651041127,3896688048,2307622919,425408743,3371096953,2081048481,1108339068,2216610296,0,2156299017,736970802,292596766,1517440620,251657213,2235061775,2933202493,758720310,265905162,1554391400,1532285339,908999204,174567692,1474760595,4002861748,2610011675,3234156416,3693126241,2001430874,303699484,2478443234,2687165888,585122620,454499602,151849742,2345119218,3064510765,514443284,4044981591,1963412655,2581445614,2137062819,19308535,1928707164,1715193156,4219352155,1126790795,600235211,3992742070,3841024952,836553431,1669664834,2535604243,3323011204,1243905413,3141400786,4180808110,698445255,2653899549,2989552604,2253581325,3252932727,3004591147,1891211689,2487810577,3915653703,4237083816,4030667424,2100090966,865136418,1229899655,953270745,3399679628,3557504664,4118925222,2061379749,3079546586,2915017791,983426092,2022837584,1607244650,2118541908,2366882550,3635996816,972512814,3283088770,1568718495,3499326569,3576539503,621982671,2895723464,410887952,2623762152,1002142683,645401037,1494807662,2595684844,1335535747,2507040230,4293295786,3167684641,367585007,3885750714,1865862730,2668221674,2960971305,2763173681,1059270954,2777952454,2724642869,1320957812,2194319100,2429595872,2815956275,77089521,3973773121,3444575871,2448830231,1305906550,4021308739,2857194700,2516901860,3518358430,1787304780,740276417,1699839814,1592394909,2352307457,2272556026,188821243,1729977011,3687994002,274084841,3594982253,3613494426,2701949495,4162096729,322734571,2837966542,1640576439,484830689,1202797690,3537852828,4067639125,349075736,3342319475,4157467219,4255800159,1030690015,1155237496,2951971274,1757691577,607398968,2738905026,499347990,3794078908,1011452712,227885567,2818666809,213114376,3034881240,1455525988,3414450555,850817237,1817998408,3092726480],L=[0,235474187,470948374,303765277,941896748,908933415,607530554,708780849,1883793496,2118214995,1817866830,1649639237,1215061108,1181045119,1417561698,1517767529,3767586992,4003061179,4236429990,4069246893,3635733660,3602770327,3299278474,3400528769,2430122216,2664543715,2362090238,2193862645,2835123396,2801107407,3035535058,3135740889,3678124923,3576870512,3341394285,3374361702,3810496343,3977675356,4279080257,4043610186,2876494627,2776292904,3076639029,3110650942,2472011535,2640243204,2403728665,2169303058,1001089995,899835584,666464733,699432150,59727847,226906860,530400753,294930682,1273168787,1172967064,1475418501,1509430414,1942435775,2110667444,1876241833,1641816226,2910219766,2743034109,2976151520,3211623147,2505202138,2606453969,2302690252,2269728455,3711829422,3543599269,3240894392,3475313331,3843699074,3943906441,4178062228,4144047775,1306967366,1139781709,1374988112,1610459739,1975683434,2076935265,1775276924,1742315127,1034867998,866637845,566021896,800440835,92987698,193195065,429456164,395441711,1984812685,2017778566,1784663195,1683407248,1315562145,1080094634,1383856311,1551037884,101039829,135050206,437757123,337553864,1042385657,807962610,573804783,742039012,2531067453,2564033334,2328828971,2227573024,2935566865,2700099354,3001755655,3168937228,3868552805,3902563182,4203181171,4102977912,3736164937,3501741890,3265478751,3433712980,1106041591,1340463100,1576976609,1408749034,2043211483,2009195472,1708848333,1809054150,832877231,1068351396,766945465,599762354,159417987,126454664,361929877,463180190,2709260871,2943682380,3178106961,3009879386,2572697195,2538681184,2236228733,2336434550,3509871135,3745345300,3441850377,3274667266,3910161971,3877198648,4110568485,4211818798,2597806476,2497604743,2261089178,2295101073,2733856160,2902087851,3202437046,2968011453,3936291284,3835036895,4136440770,4169408201,3535486456,3702665459,3467192302,3231722213,2051518780,1951317047,1716890410,1750902305,1113818384,1282050075,1584504582,1350078989,168810852,67556463,371049330,404016761,841739592,1008918595,775550814,540080725,3969562369,3801332234,4035489047,4269907996,3569255213,3669462566,3366754619,3332740144,2631065433,2463879762,2160117071,2395588676,2767645557,2868897406,3102011747,3069049960,202008497,33778362,270040487,504459436,875451293,975658646,675039627,641025152,2084704233,1917518562,1615861247,1851332852,1147550661,1248802510,1484005843,1451044056,933301370,967311729,733156972,632953703,260388950,25965917,328671808,496906059,1206477858,1239443753,1543208500,1441952575,2144161806,1908694277,1675577880,1842759443,3610369226,3644379585,3408119516,3307916247,4011190502,3776767469,4077384432,4245618683,2809771154,2842737049,3144396420,3043140495,2673705150,2438237621,2203032232,2370213795],B=[0,185469197,370938394,487725847,741876788,657861945,975451694,824852259,1483753576,1400783205,1315723890,1164071807,1950903388,2135319889,1649704518,1767536459,2967507152,3152976349,2801566410,2918353863,2631447780,2547432937,2328143614,2177544179,3901806776,3818836405,4270639778,4118987695,3299409036,3483825537,3535072918,3652904859,2077965243,1893020342,1841768865,1724457132,1474502543,1559041666,1107234197,1257309336,598438867,681933534,901210569,1052338372,261314535,77422314,428819965,310463728,3409685355,3224740454,3710368113,3593056380,3875770207,3960309330,4045380933,4195456072,2471224067,2554718734,2237133081,2388260884,3212035895,3028143674,2842678573,2724322336,4138563181,4255350624,3769721975,3955191162,3667219033,3516619604,3431546947,3347532110,2933734917,2782082824,3099667487,3016697106,2196052529,2313884476,2499348523,2683765030,1179510461,1296297904,1347548327,1533017514,1786102409,1635502980,2087309459,2003294622,507358933,355706840,136428751,53458370,839224033,957055980,605657339,790073846,2373340630,2256028891,2607439820,2422494913,2706270690,2856345839,3075636216,3160175349,3573941694,3725069491,3273267108,3356761769,4181598602,4063242375,4011996048,3828103837,1033297158,915985419,730517276,545572369,296679730,446754879,129166120,213705253,1709610350,1860738147,1945798516,2029293177,1239331162,1120974935,1606591296,1422699085,4148292826,4233094615,3781033664,3931371469,3682191598,3497509347,3446004468,3328955385,2939266226,2755636671,3106780840,2988687269,2198438022,2282195339,2501218972,2652609425,1201765386,1286567175,1371368976,1521706781,1805211710,1620529459,2105887268,1988838185,533804130,350174575,164439672,46346101,870912086,954669403,636813900,788204353,2358957921,2274680428,2592523643,2441661558,2695033685,2880240216,3065962831,3182487618,3572145929,3756299780,3270937875,3388507166,4174560061,4091327024,4006521127,3854606378,1014646705,930369212,711349675,560487590,272786309,457992840,106852767,223377554,1678381017,1862534868,1914052035,2031621326,1211247597,1128014560,1580087799,1428173050,32283319,182621114,401639597,486441376,768917123,651868046,1003007129,818324884,1503449823,1385356242,1333838021,1150208456,1973745387,2125135846,1673061617,1756818940,2970356327,3120694122,2802849917,2887651696,2637442643,2520393566,2334669897,2149987652,3917234703,3799141122,4284502037,4100872472,3309594171,3460984630,3545789473,3629546796,2050466060,1899603969,1814803222,1730525723,1443857720,1560382517,1075025698,1260232239,575138148,692707433,878443390,1062597235,243256656,91341917,409198410,325965383,3403100636,3252238545,3704300486,3620022987,3874428392,3990953189,4042459122,4227665663,2460449204,2578018489,2226875310,2411029155,3198115200,3046200461,2827177882,2743944855],F=[0,218828297,437656594,387781147,875313188,958871085,775562294,590424639,1750626376,1699970625,1917742170,2135253587,1551124588,1367295589,1180849278,1265195639,3501252752,3720081049,3399941250,3350065803,3835484340,3919042237,4270507174,4085369519,3102249176,3051593425,2734591178,2952102595,2361698556,2177869557,2530391278,2614737639,3145456443,3060847922,2708326185,2892417312,2404901663,2187128086,2504130317,2555048196,3542330227,3727205754,3375740769,3292445032,3876557655,3926170974,4246310725,4027744588,1808481195,1723872674,1910319033,2094410160,1608975247,1391201670,1173430173,1224348052,59984867,244860394,428169201,344873464,935293895,984907214,766078933,547512796,1844882806,1627235199,2011214180,2062270317,1507497298,1423022939,1137477952,1321699145,95345982,145085239,532201772,313773861,830661914,1015671571,731183368,648017665,3175501286,2957853679,2807058932,2858115069,2305455554,2220981195,2474404304,2658625497,3575528878,3625268135,3473416636,3254988725,3778151818,3963161475,4213447064,4130281361,3599595085,3683022916,3432737375,3247465558,3802222185,4020912224,4172763771,4122762354,3201631749,3017672716,2764249623,2848461854,2331590177,2280796200,2431590963,2648976442,104699613,188127444,472615631,287343814,840019705,1058709744,671593195,621591778,1852171925,1668212892,1953757831,2037970062,1514790577,1463996600,1080017571,1297403050,3673637356,3623636965,3235995134,3454686199,4007360968,3822090177,4107101658,4190530515,2997825956,3215212461,2830708150,2779915199,2256734592,2340947849,2627016082,2443058075,172466556,122466165,273792366,492483431,1047239e3,861968209,612205898,695634755,1646252340,1863638845,2013908262,1963115311,1446242576,1530455833,1277555970,1093597963,1636604631,1820824798,2073724613,1989249228,1436590835,1487645946,1337376481,1119727848,164948639,81781910,331544205,516552836,1039717051,821288114,669961897,719700128,2973530695,3157750862,2871682645,2787207260,2232435299,2283490410,2667994737,2450346104,3647212047,3564045318,3279033885,3464042516,3980931627,3762502690,4150144569,4199882800,3070356634,3121275539,2904027272,2686254721,2200818878,2384911031,2570832044,2486224549,3747192018,3528626907,3310321856,3359936201,3950355702,3867060991,4049844452,4234721005,1739656202,1790575107,2108100632,1890328081,1402811438,1586903591,1233856572,1149249077,266959938,48394827,369057872,418672217,1002783846,919489135,567498868,752375421,209336225,24197544,376187827,459744698,945164165,895287692,574624663,793451934,1679968233,1764313568,2117360635,1933530610,1343127501,1560637892,1243112415,1192455638,3704280881,3519142200,3336358691,3419915562,3907448597,3857572124,4075877127,4294704398,3029510009,3113855344,2927934315,2744104290,2159976285,2377486676,2594734927,2544078150],K=[0,151849742,303699484,454499602,607398968,758720310,908999204,1059270954,1214797936,1097159550,1517440620,1400849762,1817998408,1699839814,2118541908,2001430874,2429595872,2581445614,2194319100,2345119218,3034881240,3186202582,2801699524,2951971274,3635996816,3518358430,3399679628,3283088770,4237083816,4118925222,4002861748,3885750714,1002142683,850817237,698445255,548169417,529487843,377642221,227885567,77089521,1943217067,2061379749,1640576439,1757691577,1474760595,1592394909,1174215055,1290801793,2875968315,2724642869,3111247143,2960971305,2405426947,2253581325,2638606623,2487810577,3808662347,3926825029,4044981591,4162096729,3342319475,3459953789,3576539503,3693126241,1986918061,2137062819,1685577905,1836772287,1381620373,1532285339,1078185097,1229899655,1040559837,923313619,740276417,621982671,439452389,322734571,137073913,19308535,3871163981,4021308739,4104605777,4255800159,3263785589,3414450555,3499326569,3651041127,2933202493,2815956275,3167684641,3049390895,2330014213,2213296395,2566595609,2448830231,1305906550,1155237496,1607244650,1455525988,1776460110,1626319424,2079897426,1928707164,96392454,213114376,396673818,514443284,562755902,679998e3,865136418,983426092,3708173718,3557504664,3474729866,3323011204,4180808110,4030667424,3945269170,3794078908,2507040230,2623762152,2272556026,2390325492,2975484382,3092726480,2738905026,2857194700,3973773121,3856137295,4274053469,4157467219,3371096953,3252932727,3673476453,3556361835,2763173681,2915017791,3064510765,3215307299,2156299017,2307622919,2459735317,2610011675,2081048481,1963412655,1846563261,1729977011,1480485785,1362321559,1243905413,1126790795,878845905,1030690015,645401037,796197571,274084841,425408743,38544885,188821243,3613494426,3731654548,3313212038,3430322568,4082475170,4200115116,3780097726,3896688048,2668221674,2516901860,2366882550,2216610296,3141400786,2989552604,2837966542,2687165888,1202797690,1320957812,1437280870,1554391400,1669664834,1787304780,1906247262,2022837584,265905162,114585348,499347990,349075736,736970802,585122620,972512814,821712160,2595684844,2478443234,2293045232,2174754046,3196267988,3079546586,2895723464,2777952454,3537852828,3687994002,3234156416,3385345166,4142626212,4293295786,3841024952,3992742070,174567692,57326082,410887952,292596766,777231668,660510266,1011452712,893681702,1108339068,1258480242,1343618912,1494807662,1715193156,1865862730,1948373848,2100090966,2701949495,2818666809,3004591147,3122358053,2235061775,2352307457,2535604243,2653899549,3915653703,3764988233,4219352155,4067639125,3444575871,3294430577,3746175075,3594982253,836553431,953270745,600235211,718002117,367585007,484830689,133361907,251657213,2041877159,1891211689,1806599355,1654886325,1568718495,1418573201,1335535747,1184342925];function H(E){for(var A=[],g=0;g<E.length;g+=4)A.push(E[g]<<24|E[g+1]<<16|E[g+2]<<8|E[g+3]);return A}var j=function(E){if(!(this instanceof j))throw Error("AES must be instanitated with `new`");Object.defineProperty(this,"key",{value:n(E,!0)}),this._prepare()};j.prototype._prepare=function(){var E=c[this.key.length];if(E==null)throw new Error("invalid key size (must be 16, 24 or 32 bytes)");this._Ke=[],this._Kd=[];for(var A=0;A<=E;A++)this._Ke.push([0,0,0,0]),this._Kd.push([0,0,0,0]);for(var g=(E+1)*4,C=this.key.length/4,W=H(this.key),V,A=0;A<C;A++)V=A>>2,this._Ke[V][A%4]=W[A],this._Kd[E-V][A%4]=W[A];for(var Q=0,ie=C,he;ie<g;){if(he=W[C-1],W[0]^=u[he>>16&255]<<24^u[he>>8&255]<<16^u[he&255]<<8^u[he>>24&255]^l[Q]<<24,Q+=1,C!=8)for(var A=1;A<C;A++)W[A]^=W[A-1];else{for(var A=1;A<C/2;A++)W[A]^=W[A-1];he=W[C/2-1],W[C/2]^=u[he&255]^u[he>>8&255]<<8^u[he>>16&255]<<16^u[he>>24&255]<<24;for(var A=C/2+1;A<C;A++)W[A]^=W[A-1]}for(var A=0,ve,pr;A<C&&ie<g;)ve=ie>>2,pr=ie%4,this._Ke[ve][pr]=W[A],this._Kd[E-ve][pr]=W[A++],ie++}for(var ve=1;ve<E;ve++)for(var pr=0;pr<4;pr++)he=this._Kd[ve][pr],this._Kd[ve][pr]=L[he>>24&255]^B[he>>16&255]^F[he>>8&255]^K[he&255]},j.prototype.encrypt=function(E){if(E.length!=16)throw new Error("invalid plaintext size (must be 16 bytes)");for(var A=this._Ke.length-1,g=[0,0,0,0],C=H(E),W=0;W<4;W++)C[W]^=this._Ke[0][W];for(var V=1;V<A;V++){for(var W=0;W<4;W++)g[W]=b[C[W]>>24&255]^y[C[(W+1)%4]>>16&255]^v[C[(W+2)%4]>>8&255]^S[C[(W+3)%4]&255]^this._Ke[V][W];C=g.slice()}for(var Q=a(16),ie,W=0;W<4;W++)ie=this._Ke[A][W],Q[4*W]=(u[C[W]>>24&255]^ie>>24)&255,Q[4*W+1]=(u[C[(W+1)%4]>>16&255]^ie>>16)&255,Q[4*W+2]=(u[C[(W+2)%4]>>8&255]^ie>>8)&255,Q[4*W+3]=(u[C[(W+3)%4]&255]^ie)&255;return Q},j.prototype.decrypt=function(E){if(E.length!=16)throw new Error("invalid ciphertext size (must be 16 bytes)");for(var A=this._Kd.length-1,g=[0,0,0,0],C=H(E),W=0;W<4;W++)C[W]^=this._Kd[0][W];for(var V=1;V<A;V++){for(var W=0;W<4;W++)g[W]=R[C[W]>>24&255]^P[C[(W+3)%4]>>16&255]^N[C[(W+2)%4]>>8&255]^M[C[(W+1)%4]&255]^this._Kd[V][W];C=g.slice()}for(var Q=a(16),ie,W=0;W<4;W++)ie=this._Kd[A][W],Q[4*W]=(h[C[W]>>24&255]^ie>>24)&255,Q[4*W+1]=(h[C[(W+3)%4]>>16&255]^ie>>16)&255,Q[4*W+2]=(h[C[(W+2)%4]>>8&255]^ie>>8)&255,Q[4*W+3]=(h[C[(W+1)%4]&255]^ie)&255;return Q};var X=function(E){if(!(this instanceof X))throw Error("AES must be instanitated with `new`");this.description="Electronic Code Block",this.name="ecb",this._aes=new j(E)};X.prototype.encrypt=function(E){if(E=n(E),E.length%16!==0)throw new Error("invalid plaintext size (must be multiple of 16 bytes)");for(var A=a(E.length),g=a(16),C=0;C<E.length;C+=16)s(E,g,0,C,C+16),g=this._aes.encrypt(g),s(g,A,C);return A},X.prototype.decrypt=function(E){if(E=n(E),E.length%16!==0)throw new Error("invalid ciphertext size (must be multiple of 16 bytes)");for(var A=a(E.length),g=a(16),C=0;C<E.length;C+=16)s(E,g,0,C,C+16),g=this._aes.decrypt(g),s(g,A,C);return A};var z=function(E,A){if(!(this instanceof z))throw Error("AES must be instanitated with `new`");if(this.description="Cipher Block Chaining",this.name="cbc",!A)A=a(16);else if(A.length!=16)throw new Error("invalid initialation vector size (must be 16 bytes)");this._lastCipherblock=n(A,!0),this._aes=new j(E)};z.prototype.encrypt=function(E){if(E=n(E),E.length%16!==0)throw new Error("invalid plaintext size (must be multiple of 16 bytes)");for(var A=a(E.length),g=a(16),C=0;C<E.length;C+=16){s(E,g,0,C,C+16);for(var W=0;W<16;W++)g[W]^=this._lastCipherblock[W];this._lastCipherblock=this._aes.encrypt(g),s(this._lastCipherblock,A,C)}return A},z.prototype.decrypt=function(E){if(E=n(E),E.length%16!==0)throw new Error("invalid ciphertext size (must be multiple of 16 bytes)");for(var A=a(E.length),g=a(16),C=0;C<E.length;C+=16){s(E,g,0,C,C+16),g=this._aes.decrypt(g);for(var W=0;W<16;W++)A[C+W]=g[W]^this._lastCipherblock[W];s(E,this._lastCipherblock,0,C,C+16)}return A};var T=function(E,A,g){if(!(this instanceof T))throw Error("AES must be instanitated with `new`");if(this.description="Cipher Feedback",this.name="cfb",!A)A=a(16);else if(A.length!=16)throw new Error("invalid initialation vector size (must be 16 size)");g||(g=1),this.segmentSize=g,this._shiftRegister=n(A,!0),this._aes=new j(E)};T.prototype.encrypt=function(E){if(E.length%this.segmentSize!=0)throw new Error("invalid plaintext size (must be segmentSize bytes)");for(var A=n(E,!0),g,C=0;C<A.length;C+=this.segmentSize){g=this._aes.encrypt(this._shiftRegister);for(var W=0;W<this.segmentSize;W++)A[C+W]^=g[W];s(this._shiftRegister,this._shiftRegister,0,this.segmentSize),s(A,this._shiftRegister,16-this.segmentSize,C,C+this.segmentSize)}return A},T.prototype.decrypt=function(E){if(E.length%this.segmentSize!=0)throw new Error("invalid ciphertext size (must be segmentSize bytes)");for(var A=n(E,!0),g,C=0;C<A.length;C+=this.segmentSize){g=this._aes.encrypt(this._shiftRegister);for(var W=0;W<this.segmentSize;W++)A[C+W]^=g[W];s(this._shiftRegister,this._shiftRegister,0,this.segmentSize),s(E,this._shiftRegister,16-this.segmentSize,C,C+this.segmentSize)}return A};var m=function(E,A){if(!(this instanceof m))throw Error("AES must be instanitated with `new`");if(this.description="Output Feedback",this.name="ofb",!A)A=a(16);else if(A.length!=16)throw new Error("invalid initialation vector size (must be 16 bytes)");this._lastPrecipher=n(A,!0),this._lastPrecipherIndex=16,this._aes=new j(E)};m.prototype.encrypt=function(E){for(var A=n(E,!0),g=0;g<A.length;g++)this._lastPrecipherIndex===16&&(this._lastPrecipher=this._aes.encrypt(this._lastPrecipher),this._lastPrecipherIndex=0),A[g]^=this._lastPrecipher[this._lastPrecipherIndex++];return A},m.prototype.decrypt=m.prototype.encrypt;var x=function(E){if(!(this instanceof x))throw Error("Counter must be instanitated with `new`");E!==0&&!E&&(E=1),typeof E=="number"?(this._counter=a(16),this.setValue(E)):this.setBytes(E)};x.prototype.setValue=function(E){if(typeof E!="number"||parseInt(E)!=E)throw new Error("invalid counter value (must be an integer)");if(E>Number.MAX_SAFE_INTEGER)throw new Error("integer value out of safe range");for(var A=15;A>=0;--A)this._counter[A]=E%256,E=parseInt(E/256)},x.prototype.setBytes=function(E){if(E=n(E,!0),E.length!=16)throw new Error("invalid counter bytes size (must be 16 bytes)");this._counter=E},x.prototype.increment=function(){for(var E=15;E>=0;E--)if(this._counter[E]===255)this._counter[E]=0;else{this._counter[E]++;break}};var w=function(E,A){if(!(this instanceof w))throw Error("AES must be instanitated with `new`");this.description="Counter",this.name="ctr",A instanceof x||(A=new x(A)),this._counter=A,this._remainingCounter=null,this._remainingCounterIndex=16,this._aes=new j(E)};w.prototype.encrypt=function(E){for(var A=n(E,!0),g=0;g<A.length;g++)this._remainingCounterIndex===16&&(this._remainingCounter=this._aes.encrypt(this._counter._counter),this._remainingCounterIndex=0,this._counter.increment()),A[g]^=this._remainingCounter[this._remainingCounterIndex++];return A},w.prototype.decrypt=w.prototype.encrypt;function I(E){E=n(E,!0);var A=16-E.length%16,g=a(E.length+A);s(E,g);for(var C=E.length;C<g.length;C++)g[C]=A;return g}function k(E){if(E=n(E,!0),E.length<16)throw new Error("PKCS#7 invalid length");var A=E[E.length-1];if(A>16)throw new Error("PKCS#7 padding byte out of range");for(var g=E.length-A,C=0;C<A;C++)if(E[g+C]!==A)throw new Error("PKCS#7 invalid padding byte");var W=a(g);return s(E,W,0,0,g),W}var O={AES:j,Counter:x,ModeOfOperation:{ecb:X,cbc:z,cfb:T,ofb:m,ctr:w},utils:{hex:o,utf8:i},padding:{pkcs7:{pad:I,strip:k}},_arrayTest:{coerceArray:n,createArray:a,copyArray:s}};typeof d1<"u"?_N.exports=O:typeof define=="function"&&define.amd?define([],function(){return O}):(r.aesjs&&(O._aesjs=r.aesjs),r.aesjs=O)})(d1)});var PN=D(pn=>{"use strict";d();f();var Uee=pn&&pn.__awaiter||function(r,e,t,n){function a(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function o(u){try{l(n.next(u))}catch(h){i(h)}}function c(u){try{l(n.throw(u))}catch(h){i(h)}}function l(u){u.done?s(u.value):a(u.value).then(o,c)}l((n=n.apply(r,e||[])).next())})},Fee=pn&&pn.__generator||function(r,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,a,s,i;return i={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function o(l){return function(u){return c([l,u])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,a&&(s=l[0]&2?a.return:l[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,l[1])).done)return s;switch(a=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,a=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){t.label=l[1];break}if(l[0]===6&&t.label<s[1]){t.label=s[1],s=l;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(l);break}s[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(r,t)}catch(u){l=[6,u],a=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(pn,"__esModule",{value:!0});pn.fromQuorumWallet=pn.fromKryptoKit=pn.fromEtherCamp=pn.fromEtherWallet=void 0;var ng=B4(),Gd=r1(),Hee=W_(),ag=rg(),Gee=B$(),zee=AN();function jee(r,e){return p.Buffer.concat([r.update(e),r.final()])}var vu={count:1,keysize:16,ivsize:16,digest:"md5"};function Vee(r){return r?{count:r.count||vu.count,keysize:r.keysize||vu.keysize,ivsize:r.ivsize||vu.ivsize,digest:r.digest||vu.digest}:vu}function $ee(r,e,t){var n=Vee(t);function a(c){var l=ng.createHash(n.digest);l.update(c),l.update(r),l.update(e),c=l.digest();for(var u=1,h=n.count;u<h;u++)l=ng.createHash(n.digest),l.update(c),c=l.digest();return c}for(var s=[],i=0;p.Buffer.concat(s).length<n.keysize+n.ivsize;)s[i]=a(i===0?p.Buffer.alloc(0):s[i-1]),i++;var o=p.Buffer.concat(s);return{key:o.slice(0,n.keysize),iv:o.slice(n.keysize,n.keysize+n.ivsize)}}function Yee(r){var e=p.Buffer.from(r,"base64");return e.slice(0,8).toString()==="Salted__"?{salt:e.slice(8,16),ciphertext:e.slice(16)}:{ciphertext:e}}function CN(r,e){var t=typeof r=="object"?r:JSON.parse(r),n;if(t.locked){if(typeof e!="string")throw new Error("Password required");if(e.length<7)throw new Error("Password must be at least 7 characters");var a=t.encrypted?t.private.slice(0,128):t.private,s=Yee(a);if(!s.salt)throw new Error("Unsupported EtherWallet key format");var i=$ee(p.Buffer.from(e),s.salt,{keysize:32,ivsize:16}),o=ng.createDecipheriv("aes-256-cbc",i.key,i.iv);n=jee(o,p.Buffer.from(s.ciphertext)),n=p.Buffer.from(Gee.decode(n.toString()),"hex")}else{if(t.private.length!==64)throw new Error("Invalid private key length");n=p.Buffer.from(t.private,"hex")}var c=new ag.default(n);if(c.getAddressString()!==t.address)throw new Error("Invalid private key or address");return c}pn.fromEtherWallet=CN;function TN(r){return new ag.default(Gd.keccak256(p.Buffer.from(r)))}pn.fromEtherCamp=TN;function IN(r,e){return Uee(this,void 0,void 0,function(){function t(u){function h(S){try{return decodeURIComponent(S)}catch{return String.fromCharCode(65533)}}for(var b="",y="",v=0;v<u.length;v++)u[v]<=127?(b+=h(y)+String.fromCharCode(u[v]),y=""):y+="%"+u[v].toString(16);return p.Buffer.from(b+h(y))}var n,a,s,i,o,c,l;return Fee(this,function(u){switch(u.label){case 0:return r[0]==="#"&&(r=r.slice(1)),n=r[0],r=r.slice(1),n!=="d"?[3,1]:(a=Gd.sha256(Gd.toBuffer(r)),[3,4]);case 1:if(n!=="q")return[3,3];if(typeof e!="string")throw new Error("Password required");return s=Gd.sha256(p.Buffer.from(r.slice(0,30))),i=r.slice(30,46),o=t(s),[4,Hee.scrypt(p.Buffer.from(e,"utf8"),o,16384,8,1,32)];case 2:if(c=u.sent(),l=new zee.ModeOfOperation.ecb(c),a=p.Buffer.concat([p.Buffer.from(l.decrypt(s.slice(0,16))),p.Buffer.from(l.decrypt(s.slice(16,32)))]),i.length>0&&i!==Gd.sha256(Gd.sha256(a)).slice(0,8).toString("hex"))throw new Error("Failed to decrypt input - possibly invalid passphrase");return[3,4];case 3:throw new Error("Unsupported or invalid entropy type");case 4:return[2,new ag.default(a)]}})})}pn.fromKryptoKit=IN;function EN(r,e){if(r.length<10)throw new Error("Passphrase must be at least 10 characters");if(e.length<10)throw new Error("User id must be at least 10 characters");var t=r+e,n=ng.pbkdf2Sync(t,t,2e3,32,"sha256");return new ag.default(n)}pn.fromQuorumWallet=EN;var Jee={fromEtherWallet:CN,fromEtherCamp:TN,fromKryptoKit:IN,fromQuorumWallet:EN};pn.default=Jee});var NN=D((L6e,u1)=>{d();f();var MN=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);MN?(f1=new Uint8Array(16),u1.exports=function(){return MN(f1),f1}):(l1=new Array(16),u1.exports=function(){for(var e=0,t;e<16;e++)(e&3)===0&&(t=Math.random()*4294967296),l1[e]=t>>>((e&3)<<3)&255;return l1});var f1,l1});var ON=D((K6e,kN)=>{d();f();var RN=[];for(Su=0;Su<256;++Su)RN[Su]=(Su+256).toString(16).substr(1);var Su;function Xee(r,e){var t=e||0,n=RN;return[n[r[t++]],n[r[t++]],n[r[t++]],n[r[t++]],"-",n[r[t++]],n[r[t++]],"-",n[r[t++]],n[r[t++]],"-",n[r[t++]],n[r[t++]],"-",n[r[t++]],n[r[t++]],n[r[t++]],n[r[t++]],n[r[t++]],n[r[t++]]].join("")}kN.exports=Xee});var LN=D((F6e,DN)=>{d();f();var Zee=NN(),Qee=ON();function ete(r,e,t){var n=e&&t||0;typeof r=="string"&&(e=r==="binary"?new Array(16):null,r=null),r=r||{};var a=r.random||(r.rng||Zee)();if(a[6]=a[6]&15|64,a[8]=a[8]&63|128,e)for(var s=0;s<16;++s)e[n+s]=a[s];return e||Qee(a)}DN.exports=ete});var rg=D(wa=>{"use strict";d();f();var jd=wa&&wa.__assign||function(){return jd=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(r[a]=e[a])}return r},jd.apply(this,arguments)},sg=wa&&wa.__awaiter||function(r,e,t,n){function a(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function o(u){try{l(n.next(u))}catch(h){i(h)}}function c(u){try{l(n.throw(u))}catch(h){i(h)}}function l(u){u.done?s(u.value):a(u.value).then(o,c)}l((n=n.apply(r,e||[])).next())})},ig=wa&&wa.__generator||function(r,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,a,s,i;return i={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function o(l){return function(u){return c([l,u])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,a&&(s=l[0]&2?a.return:l[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,l[1])).done)return s;switch(a=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,a=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){t.label=l[1];break}if(l[0]===6&&t.label<s[1]){t.label=s[1],s=l;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(l);break}s[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(r,t)}catch(u){l=[6,u],a=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(wa,"__esModule",{value:!0});var qo=B4(),Mr=r1(),h1=W_(),tte=SN();Object.defineProperty(wa,"hdkey",{enumerable:!0,get:function(){return tte.default}});var rte=PN();Object.defineProperty(wa,"thirdparty",{enumerable:!0,get:function(){return rte.default}});var BN=k_(),zd=N4(),nte=LN();function p1(r,e,t){if(e.toLowerCase().startsWith("0x")&&(e=e.slice(2)),!e&&!t)return e;if(t%2)throw new Error("Invalid length argument, must be an even number");if(typeof t=="number"&&e.length!==t)throw new Error("Invalid "+r+", string must be "+t+" hex characters");if(!/^([0-9a-f]{2})+$/i.test(e)){var n=typeof t=="number"?t:"empty or a non-zero even number of";throw new Error("Invalid "+r+", string must be "+n+" hex characters")}return e}function m1(r,e,t){if(!p.Buffer.isBuffer(e)){var n=typeof t=="number"?""+t*2:"empty or a non-zero even number of",a=typeof t=="number"?" ("+t+" bytes)":"";throw new Error("Invalid "+r+", must be a string ("+n+" hex characters) or buffer"+a)}if(typeof t=="number"&&e.length!==t)throw new Error("Invalid "+r+", buffer must be "+t+" bytes");return e}function ate(r){var e={cipher:"aes-128-ctr",kdf:"scrypt",salt:zd(32),iv:zd(16),uuid:zd(16),dklen:32,c:262144,n:262144,r:8,p:1};return r?(typeof r.salt=="string"&&(r.salt=p.Buffer.from(p1("salt",r.salt),"hex")),typeof r.iv=="string"&&(r.iv=p.Buffer.from(p1("iv",r.iv,32),"hex")),typeof r.uuid=="string"&&(r.uuid=p.Buffer.from(p1("uuid",r.uuid,32),"hex")),r.salt&&m1("salt",r.salt),r.iv&&m1("iv",r.iv,16),r.uuid&&m1("uuid",r.uuid,16),jd(jd({},e),r)):e}function ste(r){return{dklen:r.dklen,salt:r.salt,c:r.c,prf:"hmac-sha256"}}function ite(r){return{dklen:r.dklen,salt:r.salt,n:r.n,r:r.r,p:r.p}}var ote=function(){function r(e,t){if(t===void 0&&(t=void 0),this.privateKey=e,this.publicKey=t,e&&t)throw new Error("Cannot supply both a private and a public key to the constructor");if(e&&!Mr.isValidPrivate(e))throw new Error("Private key does not satisfy the curve requirements (ie. it is invalid)");if(t&&!Mr.isValidPublic(t))throw new Error("Invalid public key")}return r.generate=function(e){if(e===void 0&&(e=!1),e)for(var t=new Mr.BN("088f924eeceeda7fe92e1f5b0fffffffffffffff",16);;){var n=zd(32);if(new Mr.BN(Mr.privateToAddress(n)).lte(t))return new r(n)}else return new r(zd(32))},r.generateVanityAddress=function(e){for(e instanceof RegExp||(e=new RegExp(e));;){var t=zd(32),n=Mr.privateToAddress(t);if(e.test(n.toString("hex")))return new r(t)}},r.fromPublicKey=function(e,t){return t===void 0&&(t=!1),t&&(e=Mr.importPublic(e)),new r(void 0,e)},r.fromExtendedPublicKey=function(e){if(e.slice(0,4)!=="xpub")throw new Error("Not an extended public key");var t=BN.decode(e).slice(45);return r.fromPublicKey(t,!0)},r.fromPrivateKey=function(e){return new r(e)},r.fromExtendedPrivateKey=function(e){if(e.slice(0,4)!=="xprv")throw new Error("Not an extended private key");var t=BN.decode(e);if(t[45]!==0)throw new Error("Invalid extended private key");return r.fromPrivateKey(t.slice(46))},r.fromV1=function(e,t){return sg(this,void 0,void 0,function(){var n,a,s,i,o,c,l;return ig(this,function(u){switch(u.label){case 0:if(n=typeof e=="object"?e:JSON.parse(e),n.Version!=="1")throw new Error("Not a V1 Wallet");if(n.Crypto.KeyHeader.Kdf!=="scrypt")throw new Error("Unsupported key derivation scheme");return a=n.Crypto.KeyHeader.KdfParams,[4,h1.scrypt(p.Buffer.from(t),p.Buffer.from(n.Crypto.Salt,"hex"),a.N,a.R,a.P,a.DkLen)];case 1:if(s=u.sent(),i=p.Buffer.from(n.Crypto.CipherText,"hex"),o=Mr.keccak256(p.Buffer.concat([s.slice(16,32),i])),o.toString("hex")!==n.Crypto.MAC)throw new Error("Key derivation failed - possibly wrong passphrase");return c=qo.createDecipheriv("aes-128-cbc",Mr.keccak256(s.slice(0,16)).slice(0,16),p.Buffer.from(n.Crypto.IV,"hex")),l=og(c,i),[2,new r(l)]}})})},r.fromV3=function(e,t,n){return n===void 0&&(n=!1),sg(this,void 0,void 0,function(){var a,s,i,o,c,l,u;return ig(this,function(h){switch(h.label){case 0:if(a=typeof e=="object"?e:JSON.parse(n?e.toLowerCase():e),a.version!==3)throw new Error("Not a V3 wallet");return a.crypto.kdf!=="scrypt"?[3,2]:(i=a.crypto.kdfparams,[4,h1.scrypt(p.Buffer.from(t),p.Buffer.from(i.salt,"hex"),i.n,i.r,i.p,i.dklen)]);case 1:return s=h.sent(),[3,3];case 2:if(a.crypto.kdf==="pbkdf2"){if(i=a.crypto.kdfparams,i.prf!=="hmac-sha256")throw new Error("Unsupported parameters to PBKDF2");s=qo.pbkdf2Sync(p.Buffer.from(t),p.Buffer.from(i.salt,"hex"),i.c,i.dklen,"sha256")}else throw new Error("Unsupported key derivation scheme");h.label=3;case 3:if(o=p.Buffer.from(a.crypto.ciphertext,"hex"),c=Mr.keccak256(p.Buffer.concat([p.Buffer.from(s.slice(16,32)),o])),c.toString("hex")!==a.crypto.mac)throw new Error("Key derivation failed - possibly wrong passphrase");return l=qo.createDecipheriv(a.crypto.cipher,s.slice(0,16),p.Buffer.from(a.crypto.cipherparams.iv,"hex")),u=og(l,o),[2,new r(u)]}})})},r.fromEthSale=function(e,t){var n=typeof e=="object"?e:JSON.parse(e),a=p.Buffer.from(n.encseed,"hex"),s=qo.pbkdf2Sync(t,t,2e3,32,"sha256").slice(0,16),i=qo.createDecipheriv("aes-128-cbc",s,a.slice(0,16)),o=og(i,a.slice(16)),c=new r(Mr.keccak256(o));if(c.getAddress().toString("hex")!==n.ethaddr)throw new Error("Decoded key mismatch - possibly wrong passphrase");return c},Object.defineProperty(r.prototype,"pubKey",{get:function(){return g1(this.publicKey)||(this.publicKey=Mr.privateToPublic(this.privateKey)),this.publicKey},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"privKey",{get:function(){if(!g1(this.privateKey))throw new Error("This is a public key only wallet");return this.privateKey},enumerable:!1,configurable:!0}),r.prototype.getPrivateKey=function(){return this.privKey},r.prototype.getPrivateKeyString=function(){return Mr.bufferToHex(this.privKey)},r.prototype.getPublicKey=function(){return this.pubKey},r.prototype.getPublicKeyString=function(){return Mr.bufferToHex(this.getPublicKey())},r.prototype.getAddress=function(){return Mr.publicToAddress(this.pubKey)},r.prototype.getAddressString=function(){return Mr.bufferToHex(this.getAddress())},r.prototype.getChecksumAddressString=function(){return Mr.toChecksumAddress(this.getAddressString())},r.prototype.toV3=function(e,t){return sg(this,void 0,void 0,function(){var n,a,s,i,o,c,l;return ig(this,function(u){switch(u.label){case 0:if(!g1(this.privateKey))throw new Error("This is a public key only wallet");switch(n=ate(t),i=n.kdf,i){case"pbkdf2":return[3,1];case"scrypt":return[3,2]}return[3,4];case 1:return a=ste(n),s=qo.pbkdf2Sync(p.Buffer.from(e),a.salt,a.c,a.dklen,"sha256"),[3,5];case 2:return a=ite(n),[4,h1.scrypt(p.Buffer.from(e),a.salt,a.n,a.r,a.p,a.dklen)];case 3:return s=u.sent(),[3,5];case 4:throw new Error("Unsupported kdf");case 5:if(o=qo.createCipheriv(n.cipher,s.slice(0,16),n.iv),!o)throw new Error("Unsupported cipher");return c=og(o,this.privKey),l=Mr.keccak256(p.Buffer.concat([p.Buffer.from(s.slice(16,32)),p.Buffer.from(c)])),[2,{version:3,id:nte({random:n.uuid}),address:this.getAddress().toString("hex"),crypto:{ciphertext:c.toString("hex"),cipherparams:{iv:n.iv.toString("hex")},cipher:n.cipher,kdf:n.kdf,kdfparams:jd(jd({},a),{salt:a.salt.toString("hex")}),mac:l.toString("hex")}}]}})})},r.prototype.getV3Filename=function(e){var t=e?new Date(e):new Date;return["UTC--",t.toJSON().replace(/:/g,"-"),"--",this.getAddress().toString("hex")].join("")},r.prototype.toV3String=function(e,t){return sg(this,void 0,void 0,function(){var n,a;return ig(this,function(s){switch(s.label){case 0:return a=(n=JSON).stringify,[4,this.toV3(e,t)];case 1:return[2,a.apply(n,[s.sent()])]}})})},r}();wa.default=ote;function og(r,e){return p.Buffer.concat([r.update(e),r.final()])}function g1(r){return r!=null}});var _R=D((AAe,Bte)=>{Bte.exports={name:"elliptic",version:"6.5.7",description:"EC cryptography",main:"lib/elliptic.js",files:["lib"],scripts:{lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},repository:{type:"git",url:"git@github.com:indutny/elliptic"},keywords:["EC","Elliptic","curve","Cryptography"],author:"Fedor Indutny <fedor@indutny.com>",license:"MIT",bugs:{url:"https://github.com/indutny/elliptic/issues"},homepage:"https://github.com/indutny/elliptic",devDependencies:{brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},dependencies:{"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"}}});var Ln=D(AR=>{"use strict";d();f();var va=AR,Wte=mr(),Kte=O4(),pg=D4();va.assert=Kte;va.toArray=pg.toArray;va.zero2=pg.zero2;va.toHex=pg.toHex;va.encode=pg.encode;function qte(r,e,t){var n=new Array(Math.max(r.bitLength(),t)+1),a;for(a=0;a<n.length;a+=1)n[a]=0;var s=1<<e+1,i=r.clone();for(a=0;a<n.length;a++){var o,c=i.andln(s-1);i.isOdd()?(c>(s>>1)-1?o=(s>>1)-c:o=c,i.isubn(o)):o=0,n[a]=o,i.iushrn(1)}return n}va.getNAF=qte;function Ute(r,e){var t=[[],[]];r=r.clone(),e=e.clone();for(var n=0,a=0,s;r.cmpn(-n)>0||e.cmpn(-a)>0;){var i=r.andln(3)+n&3,o=e.andln(3)+a&3;i===3&&(i=-1),o===3&&(o=-1);var c;(i&1)===0?c=0:(s=r.andln(7)+n&7,(s===3||s===5)&&o===2?c=-i:c=i),t[0].push(c);var l;(o&1)===0?l=0:(s=e.andln(7)+a&7,(s===3||s===5)&&i===2?l=-o:l=o),t[1].push(l),2*n===c+1&&(n=1-n),2*a===l+1&&(a=1-a),r.iushrn(1),e.iushrn(1)}return t}va.getJSF=Ute;function Fte(r,e,t){var n="_"+e;r.prototype[e]=function(){return this[n]!==void 0?this[n]:this[n]=t.call(this)}}va.cachedProperty=Fte;function Hte(r){return typeof r=="string"?va.toArray(r,"hex"):r}va.parseBytes=Hte;function Gte(r){return new Wte(r,"hex","le")}va.intFromLE=Gte});var Mu=D((EAe,CR)=>{"use strict";d();f();var Fo=mr(),Pu=Ln(),mg=Pu.getNAF,zte=Pu.getJSF,gg=Pu.assert;function _i(r,e){this.type=r,this.p=new Fo(e.p,16),this.red=e.prime?Fo.red(e.prime):Fo.mont(this.p),this.zero=new Fo(0).toRed(this.red),this.one=new Fo(1).toRed(this.red),this.two=new Fo(2).toRed(this.red),this.n=e.n&&new Fo(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var t=this.n&&this.p.div(this.n);!t||t.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}CR.exports=_i;_i.prototype.point=function(){throw new Error("Not implemented")};_i.prototype.validate=function(){throw new Error("Not implemented")};_i.prototype._fixedNafMul=function(e,t){gg(e.precomputed);var n=e._getDoubles(),a=mg(t,1,this._bitLength),s=(1<<n.step+1)-(n.step%2===0?2:1);s/=3;var i=[],o,c;for(o=0;o<a.length;o+=n.step){c=0;for(var l=o+n.step-1;l>=o;l--)c=(c<<1)+a[l];i.push(c)}for(var u=this.jpoint(null,null,null),h=this.jpoint(null,null,null),b=s;b>0;b--){for(o=0;o<i.length;o++)c=i[o],c===b?h=h.mixedAdd(n.points[o]):c===-b&&(h=h.mixedAdd(n.points[o].neg()));u=u.add(h)}return u.toP()};_i.prototype._wnafMul=function(e,t){var n=4,a=e._getNAFPoints(n);n=a.wnd;for(var s=a.points,i=mg(t,n,this._bitLength),o=this.jpoint(null,null,null),c=i.length-1;c>=0;c--){for(var l=0;c>=0&&i[c]===0;c--)l++;if(c>=0&&l++,o=o.dblp(l),c<0)break;var u=i[c];gg(u!==0),e.type==="affine"?u>0?o=o.mixedAdd(s[u-1>>1]):o=o.mixedAdd(s[-u-1>>1].neg()):u>0?o=o.add(s[u-1>>1]):o=o.add(s[-u-1>>1].neg())}return e.type==="affine"?o.toP():o};_i.prototype._wnafMulAdd=function(e,t,n,a,s){var i=this._wnafT1,o=this._wnafT2,c=this._wnafT3,l=0,u,h,b;for(u=0;u<a;u++){b=t[u];var y=b._getNAFPoints(e);i[u]=y.wnd,o[u]=y.points}for(u=a-1;u>=1;u-=2){var v=u-1,S=u;if(i[v]!==1||i[S]!==1){c[v]=mg(n[v],i[v],this._bitLength),c[S]=mg(n[S],i[S],this._bitLength),l=Math.max(c[v].length,l),l=Math.max(c[S].length,l);continue}var R=[t[v],null,null,t[S]];t[v].y.cmp(t[S].y)===0?(R[1]=t[v].add(t[S]),R[2]=t[v].toJ().mixedAdd(t[S].neg())):t[v].y.cmp(t[S].y.redNeg())===0?(R[1]=t[v].toJ().mixedAdd(t[S]),R[2]=t[v].add(t[S].neg())):(R[1]=t[v].toJ().mixedAdd(t[S]),R[2]=t[v].toJ().mixedAdd(t[S].neg()));var P=[-3,-1,-5,-7,0,7,5,1,3],N=zte(n[v],n[S]);for(l=Math.max(N[0].length,l),c[v]=new Array(l),c[S]=new Array(l),h=0;h<l;h++){var M=N[0][h]|0,L=N[1][h]|0;c[v][h]=P[(M+1)*3+(L+1)],c[S][h]=0,o[v]=R}}var B=this.jpoint(null,null,null),F=this._wnafT4;for(u=l;u>=0;u--){for(var K=0;u>=0;){var H=!0;for(h=0;h<a;h++)F[h]=c[h][u]|0,F[h]!==0&&(H=!1);if(!H)break;K++,u--}if(u>=0&&K++,B=B.dblp(K),u<0)break;for(h=0;h<a;h++){var j=F[h];j!==0&&(j>0?b=o[h][j-1>>1]:j<0&&(b=o[h][-j-1>>1].neg()),b.type==="affine"?B=B.mixedAdd(b):B=B.add(b))}}for(u=0;u<a;u++)o[u]=null;return s?B:B.toP()};function ea(r,e){this.curve=r,this.type=e,this.precomputed=null}_i.BasePoint=ea;ea.prototype.eq=function(){throw new Error("Not implemented")};ea.prototype.validate=function(){return this.curve.validate(this)};_i.prototype.decodePoint=function(e,t){e=Pu.toArray(e,t);var n=this.p.byteLength();if((e[0]===4||e[0]===6||e[0]===7)&&e.length-1===2*n){e[0]===6?gg(e[e.length-1]%2===0):e[0]===7&&gg(e[e.length-1]%2===1);var a=this.point(e.slice(1,1+n),e.slice(1+n,1+2*n));return a}else if((e[0]===2||e[0]===3)&&e.length-1===n)return this.pointFromX(e.slice(1,1+n),e[0]===3);throw new Error("Unknown point format")};ea.prototype.encodeCompressed=function(e){return this.encode(e,!0)};ea.prototype._encode=function(e){var t=this.curve.p.byteLength(),n=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(n):[4].concat(n,this.getY().toArray("be",t))};ea.prototype.encode=function(e,t){return Pu.encode(this._encode(t),e)};ea.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this};ea.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return t?t.points.length>=Math.ceil((e.bitLength()+1)/t.step):!1};ea.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var n=[this],a=this,s=0;s<t;s+=e){for(var i=0;i<e;i++)a=a.dbl();n.push(a)}return{step:e,points:n}};ea.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],n=(1<<e)-1,a=n===1?null:this.dbl(),s=1;s<n;s++)t[s]=t[s-1].add(a);return{wnd:e,points:t}};ea.prototype._getBeta=function(){return null};ea.prototype.dblp=function(e){for(var t=this,n=0;n<e;n++)t=t.dbl();return t}});var IR=D((NAe,TR)=>{"use strict";d();f();var jte=Ln(),sr=mr(),R1=Tr(),Yd=Mu(),Vte=jte.assert;function ta(r){Yd.call(this,"short",r),this.a=new sr(r.a,16).toRed(this.red),this.b=new sr(r.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(r),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}R1(ta,Yd);TR.exports=ta;ta.prototype._getEndomorphism=function(e){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var t,n;if(e.beta)t=new sr(e.beta,16).toRed(this.red);else{var a=this._getEndoRoots(this.p);t=a[0].cmp(a[1])<0?a[0]:a[1],t=t.toRed(this.red)}if(e.lambda)n=new sr(e.lambda,16);else{var s=this._getEndoRoots(this.n);this.g.mul(s[0]).x.cmp(this.g.x.redMul(t))===0?n=s[0]:(n=s[1],Vte(this.g.mul(n).x.cmp(this.g.x.redMul(t))===0))}var i;return e.basis?i=e.basis.map(function(o){return{a:new sr(o.a,16),b:new sr(o.b,16)}}):i=this._getEndoBasis(n),{beta:t,lambda:n,basis:i}}};ta.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:sr.mont(e),n=new sr(2).toRed(t).redInvm(),a=n.redNeg(),s=new sr(3).toRed(t).redNeg().redSqrt().redMul(n),i=a.redAdd(s).fromRed(),o=a.redSub(s).fromRed();return[i,o]};ta.prototype._getEndoBasis=function(e){for(var t=this.n.ushrn(Math.floor(this.n.bitLength()/2)),n=e,a=this.n.clone(),s=new sr(1),i=new sr(0),o=new sr(0),c=new sr(1),l,u,h,b,y,v,S,R=0,P,N;n.cmpn(0)!==0;){var M=a.div(n);P=a.sub(M.mul(n)),N=o.sub(M.mul(s));var L=c.sub(M.mul(i));if(!h&&P.cmp(t)<0)l=S.neg(),u=s,h=P.neg(),b=N;else if(h&&++R===2)break;S=P,a=n,n=P,o=s,s=N,c=i,i=L}y=P.neg(),v=N;var B=h.sqr().add(b.sqr()),F=y.sqr().add(v.sqr());return F.cmp(B)>=0&&(y=l,v=u),h.negative&&(h=h.neg(),b=b.neg()),y.negative&&(y=y.neg(),v=v.neg()),[{a:h,b},{a:y,b:v}]};ta.prototype._endoSplit=function(e){var t=this.endo.basis,n=t[0],a=t[1],s=a.b.mul(e).divRound(this.n),i=n.b.neg().mul(e).divRound(this.n),o=s.mul(n.a),c=i.mul(a.a),l=s.mul(n.b),u=i.mul(a.b),h=e.sub(o).sub(c),b=l.add(u).neg();return{k1:h,k2:b}};ta.prototype.pointFromX=function(e,t){e=new sr(e,16),e.red||(e=e.toRed(this.red));var n=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),a=n.redSqrt();if(a.redSqr().redSub(n).cmp(this.zero)!==0)throw new Error("invalid point");var s=a.fromRed().isOdd();return(t&&!s||!t&&s)&&(a=a.redNeg()),this.point(e,a)};ta.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,n=e.y,a=this.a.redMul(t),s=t.redSqr().redMul(t).redIAdd(a).redIAdd(this.b);return n.redSqr().redISub(s).cmpn(0)===0};ta.prototype._endoWnafMulAdd=function(e,t,n){for(var a=this._endoWnafT1,s=this._endoWnafT2,i=0;i<e.length;i++){var o=this._endoSplit(t[i]),c=e[i],l=c._getBeta();o.k1.negative&&(o.k1.ineg(),c=c.neg(!0)),o.k2.negative&&(o.k2.ineg(),l=l.neg(!0)),a[i*2]=c,a[i*2+1]=l,s[i*2]=o.k1,s[i*2+1]=o.k2}for(var u=this._wnafMulAdd(1,a,s,i*2,n),h=0;h<i*2;h++)a[h]=null,s[h]=null;return u};function Nr(r,e,t,n){Yd.BasePoint.call(this,r,"affine"),e===null&&t===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new sr(e,16),this.y=new sr(t,16),n&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}R1(Nr,Yd.BasePoint);ta.prototype.point=function(e,t,n){return new Nr(this,e,t,n)};ta.prototype.pointFromJSON=function(e,t){return Nr.fromJSON(this,e,t)};Nr.prototype._getBeta=function(){if(!!this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var n=this.curve,a=function(s){return n.point(s.x.redMul(n.endo.beta),s.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(a)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(a)}}}return t}};Nr.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};Nr.fromJSON=function(e,t,n){typeof t=="string"&&(t=JSON.parse(t));var a=e.point(t[0],t[1],n);if(!t[2])return a;function s(o){return e.point(o[0],o[1],n)}var i=t[2];return a.precomputed={beta:null,doubles:i.doubles&&{step:i.doubles.step,points:[a].concat(i.doubles.points.map(s))},naf:i.naf&&{wnd:i.naf.wnd,points:[a].concat(i.naf.points.map(s))}},a};Nr.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};Nr.prototype.isInfinity=function(){return this.inf};Nr.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(this.x.cmp(e.x)===0)return this.curve.point(null,null);var t=this.y.redSub(e.y);t.cmpn(0)!==0&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var n=t.redSqr().redISub(this.x).redISub(e.x),a=t.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,a)};Nr.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.cmpn(0)===0)return this.curve.point(null,null);var t=this.curve.a,n=this.x.redSqr(),a=e.redInvm(),s=n.redAdd(n).redIAdd(n).redIAdd(t).redMul(a),i=s.redSqr().redISub(this.x.redAdd(this.x)),o=s.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,o)};Nr.prototype.getX=function(){return this.x.fromRed()};Nr.prototype.getY=function(){return this.y.fromRed()};Nr.prototype.mul=function(e){return e=new sr(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)};Nr.prototype.mulAdd=function(e,t,n){var a=[this,t],s=[e,n];return this.curve.endo?this.curve._endoWnafMulAdd(a,s):this.curve._wnafMulAdd(1,a,s,2)};Nr.prototype.jmulAdd=function(e,t,n){var a=[this,t],s=[e,n];return this.curve.endo?this.curve._endoWnafMulAdd(a,s,!0):this.curve._wnafMulAdd(1,a,s,2,!0)};Nr.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||this.x.cmp(e.x)===0&&this.y.cmp(e.y)===0)};Nr.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var n=this.precomputed,a=function(s){return s.neg()};t.precomputed={naf:n.naf&&{wnd:n.naf.wnd,points:n.naf.points.map(a)},doubles:n.doubles&&{step:n.doubles.step,points:n.doubles.points.map(a)}}}return t};Nr.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var e=this.curve.jpoint(this.x,this.y,this.curve.one);return e};function Jr(r,e,t,n){Yd.BasePoint.call(this,r,"jacobian"),e===null&&t===null&&n===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new sr(0)):(this.x=new sr(e,16),this.y=new sr(t,16),this.z=new sr(n,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}R1(Jr,Yd.BasePoint);ta.prototype.jpoint=function(e,t,n){return new Jr(this,e,t,n)};Jr.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),n=this.x.redMul(t),a=this.y.redMul(t).redMul(e);return this.curve.point(n,a)};Jr.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};Jr.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),n=this.z.redSqr(),a=this.x.redMul(t),s=e.x.redMul(n),i=this.y.redMul(t.redMul(e.z)),o=e.y.redMul(n.redMul(this.z)),c=a.redSub(s),l=i.redSub(o);if(c.cmpn(0)===0)return l.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var u=c.redSqr(),h=u.redMul(c),b=a.redMul(u),y=l.redSqr().redIAdd(h).redISub(b).redISub(b),v=l.redMul(b.redISub(y)).redISub(i.redMul(h)),S=this.z.redMul(e.z).redMul(c);return this.curve.jpoint(y,v,S)};Jr.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),n=this.x,a=e.x.redMul(t),s=this.y,i=e.y.redMul(t).redMul(this.z),o=n.redSub(a),c=s.redSub(i);if(o.cmpn(0)===0)return c.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var l=o.redSqr(),u=l.redMul(o),h=n.redMul(l),b=c.redSqr().redIAdd(u).redISub(h).redISub(h),y=c.redMul(h.redISub(b)).redISub(s.redMul(u)),v=this.z.redMul(o);return this.curve.jpoint(b,y,v)};Jr.prototype.dblp=function(e){if(e===0)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var t;if(this.curve.zeroA||this.curve.threeA){var n=this;for(t=0;t<e;t++)n=n.dbl();return n}var a=this.curve.a,s=this.curve.tinv,i=this.x,o=this.y,c=this.z,l=c.redSqr().redSqr(),u=o.redAdd(o);for(t=0;t<e;t++){var h=i.redSqr(),b=u.redSqr(),y=b.redSqr(),v=h.redAdd(h).redIAdd(h).redIAdd(a.redMul(l)),S=i.redMul(b),R=v.redSqr().redISub(S.redAdd(S)),P=S.redISub(R),N=v.redMul(P);N=N.redIAdd(N).redISub(y);var M=u.redMul(c);t+1<e&&(l=l.redMul(y)),i=R,c=M,u=N}return this.curve.jpoint(i,u.redMul(s),c)};Jr.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};Jr.prototype._zeroDbl=function(){var e,t,n;if(this.zOne){var a=this.x.redSqr(),s=this.y.redSqr(),i=s.redSqr(),o=this.x.redAdd(s).redSqr().redISub(a).redISub(i);o=o.redIAdd(o);var c=a.redAdd(a).redIAdd(a),l=c.redSqr().redISub(o).redISub(o),u=i.redIAdd(i);u=u.redIAdd(u),u=u.redIAdd(u),e=l,t=c.redMul(o.redISub(l)).redISub(u),n=this.y.redAdd(this.y)}else{var h=this.x.redSqr(),b=this.y.redSqr(),y=b.redSqr(),v=this.x.redAdd(b).redSqr().redISub(h).redISub(y);v=v.redIAdd(v);var S=h.redAdd(h).redIAdd(h),R=S.redSqr(),P=y.redIAdd(y);P=P.redIAdd(P),P=P.redIAdd(P),e=R.redISub(v).redISub(v),t=S.redMul(v.redISub(e)).redISub(P),n=this.y.redMul(this.z),n=n.redIAdd(n)}return this.curve.jpoint(e,t,n)};Jr.prototype._threeDbl=function(){var e,t,n;if(this.zOne){var a=this.x.redSqr(),s=this.y.redSqr(),i=s.redSqr(),o=this.x.redAdd(s).redSqr().redISub(a).redISub(i);o=o.redIAdd(o);var c=a.redAdd(a).redIAdd(a).redIAdd(this.curve.a),l=c.redSqr().redISub(o).redISub(o);e=l;var u=i.redIAdd(i);u=u.redIAdd(u),u=u.redIAdd(u),t=c.redMul(o.redISub(l)).redISub(u),n=this.y.redAdd(this.y)}else{var h=this.z.redSqr(),b=this.y.redSqr(),y=this.x.redMul(b),v=this.x.redSub(h).redMul(this.x.redAdd(h));v=v.redAdd(v).redIAdd(v);var S=y.redIAdd(y);S=S.redIAdd(S);var R=S.redAdd(S);e=v.redSqr().redISub(R),n=this.y.redAdd(this.z).redSqr().redISub(b).redISub(h);var P=b.redSqr();P=P.redIAdd(P),P=P.redIAdd(P),P=P.redIAdd(P),t=v.redMul(S.redISub(e)).redISub(P)}return this.curve.jpoint(e,t,n)};Jr.prototype._dbl=function(){var e=this.curve.a,t=this.x,n=this.y,a=this.z,s=a.redSqr().redSqr(),i=t.redSqr(),o=n.redSqr(),c=i.redAdd(i).redIAdd(i).redIAdd(e.redMul(s)),l=t.redAdd(t);l=l.redIAdd(l);var u=l.redMul(o),h=c.redSqr().redISub(u.redAdd(u)),b=u.redISub(h),y=o.redSqr();y=y.redIAdd(y),y=y.redIAdd(y),y=y.redIAdd(y);var v=c.redMul(b).redISub(y),S=n.redAdd(n).redMul(a);return this.curve.jpoint(h,v,S)};Jr.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),n=this.z.redSqr(),a=t.redSqr(),s=e.redAdd(e).redIAdd(e),i=s.redSqr(),o=this.x.redAdd(t).redSqr().redISub(e).redISub(a);o=o.redIAdd(o),o=o.redAdd(o).redIAdd(o),o=o.redISub(i);var c=o.redSqr(),l=a.redIAdd(a);l=l.redIAdd(l),l=l.redIAdd(l),l=l.redIAdd(l);var u=s.redIAdd(o).redSqr().redISub(i).redISub(c).redISub(l),h=t.redMul(u);h=h.redIAdd(h),h=h.redIAdd(h);var b=this.x.redMul(c).redISub(h);b=b.redIAdd(b),b=b.redIAdd(b);var y=this.y.redMul(u.redMul(l.redISub(u)).redISub(o.redMul(c)));y=y.redIAdd(y),y=y.redIAdd(y),y=y.redIAdd(y);var v=this.z.redAdd(o).redSqr().redISub(n).redISub(c);return this.curve.jpoint(b,y,v)};Jr.prototype.mul=function(e,t){return e=new sr(e,t),this.curve._wnafMul(this,e)};Jr.prototype.eq=function(e){if(e.type==="affine")return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),n=e.z.redSqr();if(this.x.redMul(n).redISub(e.x.redMul(t)).cmpn(0)!==0)return!1;var a=t.redMul(this.z),s=n.redMul(e.z);return this.y.redMul(s).redISub(e.y.redMul(a)).cmpn(0)===0};Jr.prototype.eqXToP=function(e){var t=this.z.redSqr(),n=e.toRed(this.curve.red).redMul(t);if(this.x.cmp(n)===0)return!0;for(var a=e.clone(),s=this.curve.redN.redMul(t);;){if(a.iadd(this.curve.n),a.cmp(this.curve.p)>=0)return!1;if(n.redIAdd(s),this.x.cmp(n)===0)return!0}};Jr.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};Jr.prototype.isInfinity=function(){return this.z.cmpn(0)===0}});var MR=D((OAe,PR)=>{"use strict";d();f();var Jd=mr(),ER=Tr(),bg=Mu(),$te=Ln();function Xd(r){bg.call(this,"mont",r),this.a=new Jd(r.a,16).toRed(this.red),this.b=new Jd(r.b,16).toRed(this.red),this.i4=new Jd(4).toRed(this.red).redInvm(),this.two=new Jd(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}ER(Xd,bg);PR.exports=Xd;Xd.prototype.validate=function(e){var t=e.normalize().x,n=t.redSqr(),a=n.redMul(t).redAdd(n.redMul(this.a)).redAdd(t),s=a.redSqrt();return s.redSqr().cmp(a)===0};function Rr(r,e,t){bg.BasePoint.call(this,r,"projective"),e===null&&t===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new Jd(e,16),this.z=new Jd(t,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}ER(Rr,bg.BasePoint);Xd.prototype.decodePoint=function(e,t){return this.point($te.toArray(e,t),1)};Xd.prototype.point=function(e,t){return new Rr(this,e,t)};Xd.prototype.pointFromJSON=function(e){return Rr.fromJSON(this,e)};Rr.prototype.precompute=function(){};Rr.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())};Rr.fromJSON=function(e,t){return new Rr(e,t[0],t[1]||e.one)};Rr.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};Rr.prototype.isInfinity=function(){return this.z.cmpn(0)===0};Rr.prototype.dbl=function(){var e=this.x.redAdd(this.z),t=e.redSqr(),n=this.x.redSub(this.z),a=n.redSqr(),s=t.redSub(a),i=t.redMul(a),o=s.redMul(a.redAdd(this.curve.a24.redMul(s)));return this.curve.point(i,o)};Rr.prototype.add=function(){throw new Error("Not supported on Montgomery curve")};Rr.prototype.diffAdd=function(e,t){var n=this.x.redAdd(this.z),a=this.x.redSub(this.z),s=e.x.redAdd(e.z),i=e.x.redSub(e.z),o=i.redMul(n),c=s.redMul(a),l=t.z.redMul(o.redAdd(c).redSqr()),u=t.x.redMul(o.redISub(c).redSqr());return this.curve.point(l,u)};Rr.prototype.mul=function(e){for(var t=e.clone(),n=this,a=this.curve.point(null,null),s=this,i=[];t.cmpn(0)!==0;t.iushrn(1))i.push(t.andln(1));for(var o=i.length-1;o>=0;o--)i[o]===0?(n=n.diffAdd(a,s),a=a.dbl()):(a=n.diffAdd(a,s),n=n.dbl());return a};Rr.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")};Rr.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")};Rr.prototype.eq=function(e){return this.getX().cmp(e.getX())===0};Rr.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this};Rr.prototype.getX=function(){return this.normalize(),this.x.fromRed()}});var kR=D((BAe,RR)=>{"use strict";d();f();var Yte=Ln(),Ms=mr(),NR=Tr(),yg=Mu(),Jte=Yte.assert;function Va(r){this.twisted=(r.a|0)!==1,this.mOneA=this.twisted&&(r.a|0)===-1,this.extended=this.mOneA,yg.call(this,"edwards",r),this.a=new Ms(r.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new Ms(r.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new Ms(r.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),Jte(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(r.c|0)===1}NR(Va,yg);RR.exports=Va;Va.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)};Va.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)};Va.prototype.jpoint=function(e,t,n,a){return this.point(e,t,n,a)};Va.prototype.pointFromX=function(e,t){e=new Ms(e,16),e.red||(e=e.toRed(this.red));var n=e.redSqr(),a=this.c2.redSub(this.a.redMul(n)),s=this.one.redSub(this.c2.redMul(this.d).redMul(n)),i=a.redMul(s.redInvm()),o=i.redSqrt();if(o.redSqr().redSub(i).cmp(this.zero)!==0)throw new Error("invalid point");var c=o.fromRed().isOdd();return(t&&!c||!t&&c)&&(o=o.redNeg()),this.point(e,o)};Va.prototype.pointFromY=function(e,t){e=new Ms(e,16),e.red||(e=e.toRed(this.red));var n=e.redSqr(),a=n.redSub(this.c2),s=n.redMul(this.d).redMul(this.c2).redSub(this.a),i=a.redMul(s.redInvm());if(i.cmp(this.zero)===0){if(t)throw new Error("invalid point");return this.point(this.zero,e)}var o=i.redSqrt();if(o.redSqr().redSub(i).cmp(this.zero)!==0)throw new Error("invalid point");return o.fromRed().isOdd()!==t&&(o=o.redNeg()),this.point(o,e)};Va.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var t=e.x.redSqr(),n=e.y.redSqr(),a=t.redMul(this.a).redAdd(n),s=this.c2.redMul(this.one.redAdd(this.d.redMul(t).redMul(n)));return a.cmp(s)===0};function ot(r,e,t,n,a){yg.BasePoint.call(this,r,"projective"),e===null&&t===null&&n===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new Ms(e,16),this.y=new Ms(t,16),this.z=n?new Ms(n,16):this.curve.one,this.t=a&&new Ms(a,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}NR(ot,yg.BasePoint);Va.prototype.pointFromJSON=function(e){return ot.fromJSON(this,e)};Va.prototype.point=function(e,t,n,a){return new ot(this,e,t,n,a)};ot.fromJSON=function(e,t){return new ot(e,t[0],t[1],t[2])};ot.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};ot.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)};ot.prototype._extDbl=function(){var e=this.x.redSqr(),t=this.y.redSqr(),n=this.z.redSqr();n=n.redIAdd(n);var a=this.curve._mulA(e),s=this.x.redAdd(this.y).redSqr().redISub(e).redISub(t),i=a.redAdd(t),o=i.redSub(n),c=a.redSub(t),l=s.redMul(o),u=i.redMul(c),h=s.redMul(c),b=o.redMul(i);return this.curve.point(l,u,b,h)};ot.prototype._projDbl=function(){var e=this.x.redAdd(this.y).redSqr(),t=this.x.redSqr(),n=this.y.redSqr(),a,s,i,o,c,l;if(this.curve.twisted){o=this.curve._mulA(t);var u=o.redAdd(n);this.zOne?(a=e.redSub(t).redSub(n).redMul(u.redSub(this.curve.two)),s=u.redMul(o.redSub(n)),i=u.redSqr().redSub(u).redSub(u)):(c=this.z.redSqr(),l=u.redSub(c).redISub(c),a=e.redSub(t).redISub(n).redMul(l),s=u.redMul(o.redSub(n)),i=u.redMul(l))}else o=t.redAdd(n),c=this.curve._mulC(this.z).redSqr(),l=o.redSub(c).redSub(c),a=this.curve._mulC(e.redISub(o)).redMul(l),s=this.curve._mulC(o).redMul(t.redISub(n)),i=o.redMul(l);return this.curve.point(a,s,i)};ot.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()};ot.prototype._extAdd=function(e){var t=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),n=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),a=this.t.redMul(this.curve.dd).redMul(e.t),s=this.z.redMul(e.z.redAdd(e.z)),i=n.redSub(t),o=s.redSub(a),c=s.redAdd(a),l=n.redAdd(t),u=i.redMul(o),h=c.redMul(l),b=i.redMul(l),y=o.redMul(c);return this.curve.point(u,h,y,b)};ot.prototype._projAdd=function(e){var t=this.z.redMul(e.z),n=t.redSqr(),a=this.x.redMul(e.x),s=this.y.redMul(e.y),i=this.curve.d.redMul(a).redMul(s),o=n.redSub(i),c=n.redAdd(i),l=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(a).redISub(s),u=t.redMul(o).redMul(l),h,b;return this.curve.twisted?(h=t.redMul(c).redMul(s.redSub(this.curve._mulA(a))),b=o.redMul(c)):(h=t.redMul(c).redMul(s.redSub(a)),b=this.curve._mulC(o).redMul(c)),this.curve.point(u,h,b)};ot.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)};ot.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)};ot.prototype.mulAdd=function(e,t,n){return this.curve._wnafMulAdd(1,[this,t],[e,n],2,!1)};ot.prototype.jmulAdd=function(e,t,n){return this.curve._wnafMulAdd(1,[this,t],[e,n],2,!0)};ot.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this};ot.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())};ot.prototype.getX=function(){return this.normalize(),this.x.fromRed()};ot.prototype.getY=function(){return this.normalize(),this.y.fromRed()};ot.prototype.eq=function(e){return this===e||this.getX().cmp(e.getX())===0&&this.getY().cmp(e.getY())===0};ot.prototype.eqXToP=function(e){var t=e.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(t)===0)return!0;for(var n=e.clone(),a=this.curve.redN.redMul(this.z);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(t.redIAdd(a),this.x.cmp(t)===0)return!0}};ot.prototype.toP=ot.prototype.normalize;ot.prototype.mixedAdd=ot.prototype.add});var k1=D(OR=>{"use strict";d();f();var xg=OR;xg.base=Mu();xg.short=IR();xg.mont=MR();xg.edwards=kR()});var LR=D((HAe,DR)=>{d();f();DR.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}});var wg=D(KR=>{"use strict";d();f();var D1=KR,Ai=Kp(),O1=k1(),Xte=Ln(),BR=Xte.assert;function WR(r){r.type==="short"?this.curve=new O1.short(r):r.type==="edwards"?this.curve=new O1.edwards(r):this.curve=new O1.mont(r),this.g=this.curve.g,this.n=this.curve.n,this.hash=r.hash,BR(this.g.validate(),"Invalid curve"),BR(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}D1.PresetCurve=WR;function Ci(r,e){Object.defineProperty(D1,r,{configurable:!0,enumerable:!0,get:function(){var t=new WR(e);return Object.defineProperty(D1,r,{configurable:!0,enumerable:!0,value:t}),t}})}Ci("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:Ai.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]});Ci("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:Ai.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]});Ci("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:Ai.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]});Ci("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:Ai.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]});Ci("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:Ai.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]});Ci("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:Ai.sha256,gRed:!1,g:["9"]});Ci("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:Ai.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var L1;try{L1=LR()}catch{L1=void 0}Ci("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:Ai.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",L1]})});var UR=D((YAe,qR)=>{"use strict";d();f();var Zte=mr(),Qte=Ln(),B1=Qte.assert;function sn(r,e){this.ec=r,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}qR.exports=sn;sn.fromPublic=function(e,t,n){return t instanceof sn?t:new sn(e,{pub:t,pubEnc:n})};sn.fromPrivate=function(e,t,n){return t instanceof sn?t:new sn(e,{priv:t,privEnc:n})};sn.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};sn.prototype.getPublic=function(e,t){return typeof e=="string"&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,e):this.pub};sn.prototype.getPrivate=function(e){return e==="hex"?this.priv.toString(16,2):this.priv};sn.prototype._importPrivate=function(e,t){this.priv=new Zte(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)};sn.prototype._importPublic=function(e,t){if(e.x||e.y){this.ec.curve.type==="mont"?B1(e.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&B1(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,t)};sn.prototype.derive=function(e){return e.validate()||B1(e.validate(),"public point not validated"),e.mul(this.priv).getX()};sn.prototype.sign=function(e,t,n){return this.ec.sign(e,this,t,n)};sn.prototype.verify=function(e,t){return this.ec.verify(e,t,this)};sn.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}});var GR=D((ZAe,HR)=>{"use strict";d();f();var vg=mr(),q1=Ln(),ere=q1.assert;function Sg(r,e){if(r instanceof Sg)return r;this._importDER(r,e)||(ere(r.r&&r.s,"Signature without r or s"),this.r=new vg(r.r,16),this.s=new vg(r.s,16),r.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=r.recoveryParam)}HR.exports=Sg;function tre(){this.place=0}function W1(r,e){var t=r[e.place++];if(!(t&128))return t;var n=t&15;if(n===0||n>4||r[e.place]===0)return!1;for(var a=0,s=0,i=e.place;s<n;s++,i++)a<<=8,a|=r[i],a>>>=0;return a<=127?!1:(e.place=i,a)}function FR(r){for(var e=0,t=r.length-1;!r[e]&&!(r[e+1]&128)&&e<t;)e++;return e===0?r:r.slice(e)}Sg.prototype._importDER=function(e,t){e=q1.toArray(e,t);var n=new tre;if(e[n.place++]!==48)return!1;var a=W1(e,n);if(a===!1||a+n.place!==e.length||e[n.place++]!==2)return!1;var s=W1(e,n);if(s===!1||(e[n.place]&128)!==0)return!1;var i=e.slice(n.place,s+n.place);if(n.place+=s,e[n.place++]!==2)return!1;var o=W1(e,n);if(o===!1||e.length!==o+n.place||(e[n.place]&128)!==0)return!1;var c=e.slice(n.place,o+n.place);if(i[0]===0)if(i[1]&128)i=i.slice(1);else return!1;if(c[0]===0)if(c[1]&128)c=c.slice(1);else return!1;return this.r=new vg(i),this.s=new vg(c),this.recoveryParam=null,!0};function K1(r,e){if(e<128){r.push(e);return}var t=1+(Math.log(e)/Math.LN2>>>3);for(r.push(t|128);--t;)r.push(e>>>(t<<3)&255);r.push(e)}Sg.prototype.toDER=function(e){var t=this.r.toArray(),n=this.s.toArray();for(t[0]&128&&(t=[0].concat(t)),n[0]&128&&(n=[0].concat(n)),t=FR(t),n=FR(n);!n[0]&&!(n[1]&128);)n=n.slice(1);var a=[2];K1(a,t.length),a=a.concat(t),a.push(2),K1(a,n.length);var s=a.concat(n),i=[48];return K1(i,s.length),i=i.concat(s),q1.encode(i,e)}});var $R=D((t8e,VR)=>{"use strict";d();f();var Ho=mr(),zR=L4(),rre=Ln(),U1=wg(),nre=Wp(),jR=rre.assert,F1=UR(),_g=GR();function ra(r){if(!(this instanceof ra))return new ra(r);typeof r=="string"&&(jR(Object.prototype.hasOwnProperty.call(U1,r),"Unknown curve "+r),r=U1[r]),r instanceof U1.PresetCurve&&(r={curve:r}),this.curve=r.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=r.curve.g,this.g.precompute(r.curve.n.bitLength()+1),this.hash=r.hash||r.curve.hash}VR.exports=ra;ra.prototype.keyPair=function(e){return new F1(this,e)};ra.prototype.keyFromPrivate=function(e,t){return F1.fromPrivate(this,e,t)};ra.prototype.keyFromPublic=function(e,t){return F1.fromPublic(this,e,t)};ra.prototype.genKeyPair=function(e){e||(e={});for(var t=new zR({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||nre(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),n=this.n.byteLength(),a=this.n.sub(new Ho(2));;){var s=new Ho(t.generate(n));if(!(s.cmp(a)>0))return s.iaddn(1),this.keyFromPrivate(s)}};ra.prototype._truncateToN=function(e,t){var n=e.byteLength()*8-this.n.bitLength();return n>0&&(e=e.ushrn(n)),!t&&e.cmp(this.n)>=0?e.sub(this.n):e};ra.prototype.sign=function(e,t,n,a){typeof n=="object"&&(a=n,n=null),a||(a={}),t=this.keyFromPrivate(t,n),e=this._truncateToN(new Ho(e,16));for(var s=this.n.byteLength(),i=t.getPrivate().toArray("be",s),o=e.toArray("be",s),c=new zR({hash:this.hash,entropy:i,nonce:o,pers:a.pers,persEnc:a.persEnc||"utf8"}),l=this.n.sub(new Ho(1)),u=0;;u++){var h=a.k?a.k(u):new Ho(c.generate(this.n.byteLength()));if(h=this._truncateToN(h,!0),!(h.cmpn(1)<=0||h.cmp(l)>=0)){var b=this.g.mul(h);if(!b.isInfinity()){var y=b.getX(),v=y.umod(this.n);if(v.cmpn(0)!==0){var S=h.invm(this.n).mul(v.mul(t.getPrivate()).iadd(e));if(S=S.umod(this.n),S.cmpn(0)!==0){var R=(b.getY().isOdd()?1:0)|(y.cmp(v)!==0?2:0);return a.canonical&&S.cmp(this.nh)>0&&(S=this.n.sub(S),R^=1),new _g({r:v,s:S,recoveryParam:R})}}}}}};ra.prototype.verify=function(e,t,n,a){e=this._truncateToN(new Ho(e,16)),n=this.keyFromPublic(n,a),t=new _g(t,"hex");var s=t.r,i=t.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0||i.cmpn(1)<0||i.cmp(this.n)>=0)return!1;var o=i.invm(this.n),c=o.mul(e).umod(this.n),l=o.mul(s).umod(this.n),u;return this.curve._maxwellTrick?(u=this.g.jmulAdd(c,n.getPublic(),l),u.isInfinity()?!1:u.eqXToP(s)):(u=this.g.mulAdd(c,n.getPublic(),l),u.isInfinity()?!1:u.getX().umod(this.n).cmp(s)===0)};ra.prototype.recoverPubKey=function(r,e,t,n){jR((3&t)===t,"The recovery param is more than two bits"),e=new _g(e,n);var a=this.n,s=new Ho(r),i=e.r,o=e.s,c=t&1,l=t>>1;if(i.cmp(this.curve.p.umod(this.curve.n))>=0&&l)throw new Error("Unable to find sencond key candinate");l?i=this.curve.pointFromX(i.add(this.curve.n),c):i=this.curve.pointFromX(i,c);var u=e.r.invm(a),h=a.sub(s).mul(u).umod(a),b=o.mul(u).umod(a);return this.g.mulAdd(h,i,b)};ra.prototype.getKeyRecoveryParam=function(r,e,t,n){if(e=new _g(e,n),e.recoveryParam!==null)return e.recoveryParam;for(var a=0;a<4;a++){var s;try{s=this.recoverPubKey(r,e,a)}catch{continue}if(s.eq(t))return a}throw new Error("Unable to find valid recovery factor")}});var ZR=D((a8e,XR)=>{"use strict";d();f();var Nu=Ln(),JR=Nu.assert,YR=Nu.parseBytes,Zd=Nu.cachedProperty;function kr(r,e){this.eddsa=r,this._secret=YR(e.secret),r.isPoint(e.pub)?this._pub=e.pub:this._pubBytes=YR(e.pub)}kr.fromPublic=function(e,t){return t instanceof kr?t:new kr(e,{pub:t})};kr.fromSecret=function(e,t){return t instanceof kr?t:new kr(e,{secret:t})};kr.prototype.secret=function(){return this._secret};Zd(kr,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())});Zd(kr,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())});Zd(kr,"privBytes",function(){var e=this.eddsa,t=this.hash(),n=e.encodingLength-1,a=t.slice(0,e.encodingLength);return a[0]&=248,a[n]&=127,a[n]|=64,a});Zd(kr,"priv",function(){return this.eddsa.decodeInt(this.privBytes())});Zd(kr,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()});Zd(kr,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)});kr.prototype.sign=function(e){return JR(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)};kr.prototype.verify=function(e,t){return this.eddsa.verify(e,t,this)};kr.prototype.getSecret=function(e){return JR(this._secret,"KeyPair is public only"),Nu.encode(this.secret(),e)};kr.prototype.getPublic=function(e){return Nu.encode(this.pubBytes(),e)};XR.exports=kr});var tk=D((o8e,ek)=>{"use strict";d();f();var are=mr(),Ag=Ln(),QR=Ag.assert,Cg=Ag.cachedProperty,sre=Ag.parseBytes;function Go(r,e){this.eddsa=r,typeof e!="object"&&(e=sre(e)),Array.isArray(e)&&(QR(e.length===r.encodingLength*2,"Signature has invalid size"),e={R:e.slice(0,r.encodingLength),S:e.slice(r.encodingLength)}),QR(e.R&&e.S,"Signature without R or S"),r.isPoint(e.R)&&(this._R=e.R),e.S instanceof are&&(this._S=e.S),this._Rencoded=Array.isArray(e.R)?e.R:e.Rencoded,this._Sencoded=Array.isArray(e.S)?e.S:e.Sencoded}Cg(Go,"S",function(){return this.eddsa.decodeInt(this.Sencoded())});Cg(Go,"R",function(){return this.eddsa.decodePoint(this.Rencoded())});Cg(Go,"Rencoded",function(){return this.eddsa.encodePoint(this.R())});Cg(Go,"Sencoded",function(){return this.eddsa.encodeInt(this.S())});Go.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())};Go.prototype.toHex=function(){return Ag.encode(this.toBytes(),"hex").toUpperCase()};ek.exports=Go});var ik=D((f8e,sk)=>{"use strict";d();f();var ire=Kp(),ore=wg(),Qd=Ln(),cre=Qd.assert,nk=Qd.parseBytes,ak=ZR(),rk=tk();function Sn(r){if(cre(r==="ed25519","only tested with ed25519 so far"),!(this instanceof Sn))return new Sn(r);r=ore[r].curve,this.curve=r,this.g=r.g,this.g.precompute(r.n.bitLength()+1),this.pointClass=r.point().constructor,this.encodingLength=Math.ceil(r.n.bitLength()/8),this.hash=ire.sha512}sk.exports=Sn;Sn.prototype.sign=function(e,t){e=nk(e);var n=this.keyFromSecret(t),a=this.hashInt(n.messagePrefix(),e),s=this.g.mul(a),i=this.encodePoint(s),o=this.hashInt(i,n.pubBytes(),e).mul(n.priv()),c=a.add(o).umod(this.curve.n);return this.makeSignature({R:s,S:c,Rencoded:i})};Sn.prototype.verify=function(e,t,n){if(e=nk(e),t=this.makeSignature(t),t.S().gte(t.eddsa.curve.n)||t.S().isNeg())return!1;var a=this.keyFromPublic(n),s=this.hashInt(t.Rencoded(),a.pubBytes(),e),i=this.g.mul(t.S()),o=t.R().add(a.pub().mul(s));return o.eq(i)};Sn.prototype.hashInt=function(){for(var e=this.hash(),t=0;t<arguments.length;t++)e.update(arguments[t]);return Qd.intFromLE(e.digest()).umod(this.curve.n)};Sn.prototype.keyFromPublic=function(e){return ak.fromPublic(this,e)};Sn.prototype.keyFromSecret=function(e){return ak.fromSecret(this,e)};Sn.prototype.makeSignature=function(e){return e instanceof rk?e:new rk(this,e)};Sn.prototype.encodePoint=function(e){var t=e.getY().toArray("le",this.encodingLength);return t[this.encodingLength-1]|=e.getX().isOdd()?128:0,t};Sn.prototype.decodePoint=function(e){e=Qd.parseBytes(e);var t=e.length-1,n=e.slice(0,t).concat(e[t]&-129),a=(e[t]&128)!==0,s=Qd.intFromLE(n);return this.curve.pointFromY(s,a)};Sn.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)};Sn.prototype.decodeInt=function(e){return Qd.intFromLE(e)};Sn.prototype.isPoint=function(e){return e instanceof this.pointClass}});var ck=D(ok=>{"use strict";d();f();var zo=ok;zo.version=_R().version;zo.utils=Ln();zo.rand=Wp();zo.curve=k1();zo.curves=wg();zo.ec=$R();zo.eddsa=ik()});var LS=D((Dke,rL)=>{d();f();var Ene=Pr();rL.exports=Pne;function Pne(r){let e=new Ene;return e.sendAsync=r.handle.bind(r),e.send=(t,n)=>{if(!n)throw new Error('Web3 Provider - must provider callback to "send" method');r.handle(t,n)},r.on&&r.on("notification",t=>{e.emit("data",null,t)}),e}});var aL=D((Wke,nL)=>{d();f();nL.exports=function(e){let t=e;return new Proxy({},{get:(s,i)=>i==="setTarget"?a:t[i],set:(s,i,o)=>i==="setTarget"?(a=o,!0):(t[i]=o,!0)});function a(s){t=s}}});var iL=D((Uke,sL)=>{d();f();var Mne=()=>!0,Nne=["newListener","removeListener"],Rne=r=>!Nne.includes(r);sL.exports=function(e,t){t=t||{};let n=t.eventFilter||Mne;if(n==="skipInternal"&&(n=Rne),typeof n!="function")throw new Error("createEventEmitterProxy - Invalid eventFilter");let a=e;return new Proxy({},{get:(o,c)=>c==="setTarget"?i:a[c],set:(o,c,l)=>c==="setTarget"?(i=l,!0):(a[c]=l,!0)});function i(o){let c=a;a=o,c.eventNames().filter(n).forEach(l=>{kne(c,l).forEach(u=>o.on(l,u))}),c.removeAllListeners()}};function kne(r,e){if(r.rawListeners)return r.rawListeners(e);let t=r._events[e]||[];return Array.isArray(t)||(t=[t]),t.slice()}});var cL=D((Gke,oL)=>{d();f();var One=aL(),Dne=iL();oL.exports={createSwappableProxy:One,createEventEmitterProxy:Dne}});var fL=D((df,dL)=>{"use strict";d();f();var Lne=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof globalThis<"u")return globalThis;throw new Error("unable to locate global object")},Yo=Lne();dL.exports=df=Yo.fetch;Yo.fetch&&(df.default=Yo.fetch.bind(Yo));df.Headers=Yo.Headers;df.Request=Yo.Request;df.Response=Yo.Response});var xL={};yx(xL,{Url:()=>Ia,default:()=>Bne,format:()=>mL,parse:()=>ch,resolve:()=>gL,resolveObject:()=>bL});function Ia(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function ch(r,e,t){if(r&&xx(r)&&r instanceof Ia)return r;var n=new Ia;return n.parse(r,e,t),n}function pL(r,e,t,n){if(!Lp(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var a=e.indexOf("?"),s=a!==-1&&a<e.indexOf("#")?"?":"#",i=e.split(s),o=/\\/g;i[0]=i[0].replace(o,"/"),e=i.join(s);var c=e;if(c=c.trim(),!n&&e.split("#").length===1){var l=qne.exec(c);if(l)return r.path=c,r.href=c,r.pathname=l[1],l[2]?(r.search=l[2],t?r.query=Yx(r.search.substr(1)):r.query=r.search.substr(1)):t&&(r.search="",r.query={}),r}var u=Wne.exec(c);if(u){u=u[0];var h=u.toLowerCase();r.protocol=h,c=c.substr(u.length)}if(n||u||c.match(/^\/\/[^@\/]+@[^@\/]+/)){var b=c.substr(0,2)==="//";b&&!(u&&WS[u])&&(c=c.substr(2),r.slashes=!0)}var y,v,S,R;if(!WS[u]&&(b||u&&!ff[u])){var P=-1;for(y=0;y<uL.length;y++)v=c.indexOf(uL[y]),v!==-1&&(P===-1||v<P)&&(P=v);var N,M;for(P===-1?M=c.lastIndexOf("@"):M=c.lastIndexOf("@",P),M!==-1&&(N=c.slice(0,M),c=c.slice(M+1),r.auth=decodeURIComponent(N)),P=-1,y=0;y<lL.length;y++)v=c.indexOf(lL[y]),v!==-1&&(P===-1||v<P)&&(P=v);P===-1&&(P=c.length),r.host=c.slice(0,P),c=c.slice(P),yL(r),r.hostname=r.hostname||"";var L=r.hostname[0]==="["&&r.hostname[r.hostname.length-1]==="]";if(!L){var B=r.hostname.split(/\./);for(y=0,S=B.length;y<S;y++){var F=B[y];if(!!F&&!F.match(hL)){for(var K="",H=0,j=F.length;H<j;H++)F.charCodeAt(H)>127?K+="x":K+=F[H];if(!K.match(hL)){var X=B.slice(0,y),z=B.slice(y+1),T=F.match(Gne);T&&(X.push(T[1]),z.unshift(T[2])),z.length&&(c="/"+z.join(".")+c),r.hostname=X.join(".");break}}}}r.hostname.length>Hne?r.hostname="":r.hostname=r.hostname.toLowerCase(),L||(r.hostname=p5(r.hostname)),R=r.port?":"+r.port:"";var m=r.hostname||"";r.host=m+R,r.href+=r.host,L&&(r.hostname=r.hostname.substr(1,r.hostname.length-2),c[0]!=="/"&&(c="/"+c))}if(!zne[h])for(y=0,S=BS.length;y<S;y++){var x=BS[y];if(c.indexOf(x)!==-1){var w=encodeURIComponent(x);w===x&&(w=escape(x)),c=c.split(x).join(w)}}var I=c.indexOf("#");I!==-1&&(r.hash=c.substr(I),c=c.slice(0,I));var k=c.indexOf("?");if(k!==-1?(r.search=c.substr(k),r.query=c.substr(k+1),t&&(r.query=Yx(r.query)),c=c.slice(0,k)):t&&(r.search="",r.query={}),c&&(r.pathname=c),ff[h]&&r.hostname&&!r.pathname&&(r.pathname="/"),r.pathname||r.search){R=r.pathname||"";var O=r.search||"";r.path=R+O}return r.href=KS(r),r}function mL(r){return Lp(r)&&(r=pL({},r)),KS(r)}function KS(r){var e=r.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=r.protocol||"",n=r.pathname||"",a=r.hash||"",s=!1,i="";r.host?s=e+r.host:r.hostname&&(s=e+(r.hostname.indexOf(":")===-1?r.hostname:"["+this.hostname+"]"),r.port&&(s+=":"+r.port)),r.query&&xx(r.query)&&Object.keys(r.query).length&&(i=w5(r.query));var o=r.search||i&&"?"+i||"";return t&&t.substr(-1)!==":"&&(t+=":"),r.slashes||(!t||ff[t])&&s!==!1?(s="//"+(s||""),n&&n.charAt(0)!=="/"&&(n="/"+n)):s||(s=""),a&&a.charAt(0)!=="#"&&(a="#"+a),o&&o.charAt(0)!=="?"&&(o="?"+o),n=n.replace(/[?#]/g,function(c){return encodeURIComponent(c)}),o=o.replace("#","%23"),t+s+n+o+a}function gL(r,e){return ch(r,!1,!0).resolve(e)}function bL(r,e){return r?ch(r,!1,!0).resolveObject(e):e}function yL(r){var e=r.host,t=Kne.exec(e);t&&(t=t[0],t!==":"&&(r.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(r.hostname=e)}var Bne,Wne,Kne,qne,Une,Fne,BS,lL,uL,Hne,hL,Gne,zne,WS,ff,wL=VV(()=>{d();f();L$();YV();W$();Bne={parse:ch,resolve:gL,resolveObject:bL,format:mL,Url:Ia};Wne=/^([a-z0-9.+-]+:)/i,Kne=/:[0-9]*$/,qne=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,Une=["<",">",'"',"`"," ","\r",`
`,"	"],Fne=["{","}","|","\\","^","`"].concat(Une),BS=["'"].concat(Fne),lL=["%","/","?",";","#"].concat(BS),uL=["/","?","#"],Hne=255,hL=/^[+a-z0-9A-Z_-]{0,63}$/,Gne=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,zne={javascript:!0,"javascript:":!0},WS={javascript:!0,"javascript:":!0},ff={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};Ia.prototype.parse=function(r,e,t){return pL(this,r,e,t)};Ia.prototype.format=function(){return KS(this)};Ia.prototype.resolve=function(r){return this.resolveObject(ch(r,!1,!0)).format()};Ia.prototype.resolveObject=function(r){if(Lp(r)){var e=new Ia;e.parse(r,!1,!0),r=e}for(var t=new Ia,n=Object.keys(this),a=0;a<n.length;a++){var s=n[a];t[s]=this[s]}if(t.hash=r.hash,r.href==="")return t.href=t.format(),t;if(r.slashes&&!r.protocol){for(var i=Object.keys(r),o=0;o<i.length;o++){var c=i[o];c!=="protocol"&&(t[c]=r[c])}return ff[t.protocol]&&t.hostname&&!t.pathname&&(t.path=t.pathname="/"),t.href=t.format(),t}var l;if(r.protocol&&r.protocol!==t.protocol){if(!ff[r.protocol]){for(var u=Object.keys(r),h=0;h<u.length;h++){var b=u[h];t[b]=r[b]}return t.href=t.format(),t}if(t.protocol=r.protocol,!r.host&&!WS[r.protocol]){for(l=(r.pathname||"").split("/");l.length&&!(r.host=l.shift()););r.host||(r.host=""),r.hostname||(r.hostname=""),l[0]!==""&&l.unshift(""),l.length<2&&l.unshift(""),t.pathname=l.join("/")}else t.pathname=r.pathname;if(t.search=r.search,t.query=r.query,t.host=r.host||"",t.auth=r.auth,t.hostname=r.hostname||r.host,t.port=r.port,t.pathname||t.search){var y=t.pathname||"",v=t.search||"";t.path=y+v}return t.slashes=t.slashes||r.slashes,t.href=t.format(),t}var S=t.pathname&&t.pathname.charAt(0)==="/",R=r.host||r.pathname&&r.pathname.charAt(0)==="/",P=R||S||t.host&&r.pathname,N=P,M=t.pathname&&t.pathname.split("/")||[],L=t.protocol&&!ff[t.protocol];l=r.pathname&&r.pathname.split("/")||[],L&&(t.hostname="",t.port=null,t.host&&(M[0]===""?M[0]=t.host:M.unshift(t.host)),t.host="",r.protocol&&(r.hostname=null,r.port=null,r.host&&(l[0]===""?l[0]=r.host:l.unshift(r.host)),r.host=null),P=P&&(l[0]===""||M[0]===""));var B;if(R)t.host=r.host||r.host===""?r.host:t.host,t.hostname=r.hostname||r.hostname===""?r.hostname:t.hostname,t.search=r.search,t.query=r.query,M=l;else if(l.length)M||(M=[]),M.pop(),M=M.concat(l),t.search=r.search,t.query=r.query;else if(!R4(r.search))return L&&(t.hostname=t.host=M.shift(),B=t.host&&t.host.indexOf("@")>0?t.host.split("@"):!1,B&&(t.auth=B.shift(),t.host=t.hostname=B.shift())),t.search=r.search,t.query=r.query,(!gl(t.pathname)||!gl(t.search))&&(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.href=t.format(),t;if(!M.length)return t.pathname=null,t.search?t.path="/"+t.search:t.path=null,t.href=t.format(),t;for(var F=M.slice(-1)[0],K=(t.host||r.host||M.length>1)&&(F==="."||F==="..")||F==="",H=0,j=M.length;j>=0;j--)F=M[j],F==="."?M.splice(j,1):F===".."?(M.splice(j,1),H++):H&&(M.splice(j,1),H--);if(!P&&!N)for(;H--;H)M.unshift("..");P&&M[0]!==""&&(!M[0]||M[0].charAt(0)!=="/")&&M.unshift(""),K&&M.join("/").substr(-1)!=="/"&&M.push("");var X=M[0]===""||M[0]&&M[0].charAt(0)==="/";return L&&(t.hostname=t.host=X?"":M.length?M.shift():"",B=t.host&&t.host.indexOf("@")>0?t.host.split("@"):!1,B&&(t.auth=B.shift(),t.host=t.hostname=B.shift())),P=P||t.host&&M.length,P&&!X&&M.unshift(""),M.length?t.pathname=M.join("/"):(t.pathname=null,t.path=null),(!gl(t.pathname)||!gl(t.search))&&(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.auth=r.auth||t.auth,t.slashes=t.slashes||r.slashes,t.href=t.format(),t};Ia.prototype.parseHost=function(){return yL(this)}});var dh=D((eOe,$g)=>{d();f();var Jo=(wL(),$V(xL));if(Jo&&Jo.default){$g.exports=Jo.default;for(let r in Jo)$g.exports[r]=Jo[r]}else Jo&&($g.exports=Jo)});var Jg=D((nOe,vL)=>{d();f();var jne=U4(),Yg=class extends Error{constructor(e,t,n){if(!Number.isInteger(e))throw new Error('"code" must be an integer.');if(!t||typeof t!="string")throw new Error('"message" must be a nonempty string.');super(t),this.code=e,n!==void 0&&(this.data=n)}serialize(){let e={code:this.code,message:this.message};return this.data!==void 0&&(e.data=this.data),this.stack&&(e.stack=this.stack),e}toString(){return jne(this.serialize(),$ne,2)}},qS=class extends Yg{constructor(e,t,n){if(!Vne(e))throw new Error('"code" must be an integer such that: 1000 <= code <= 4999');super(e,t,n)}};function Vne(r){return Number.isInteger(r)&&r>=1e3&&r<=4999}function $ne(r,e){if(e!=="[Circular]")return e}vL.exports={EthereumRpcError:Yg,EthereumProviderError:qS}});var SL=D((iOe,Yne)=>{Yne.exports={"-32700":{standard:"JSON RPC 2.0",message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},"-32600":{standard:"JSON RPC 2.0",message:"The JSON sent is not a valid Request object."},"-32601":{standard:"JSON RPC 2.0",message:"The method does not exist / is not available."},"-32602":{standard:"JSON RPC 2.0",message:"Invalid method parameter(s)."},"-32603":{standard:"JSON RPC 2.0",message:"Internal JSON-RPC error."},"-32000":{standard:"EIP 1474",message:"Invalid input."},"-32001":{standard:"EIP 1474",message:"Resource not found."},"-32002":{standard:"EIP 1474",message:"Resource unavailable."},"-32003":{standard:"EIP 1474",message:"Transaction rejected."},"-32004":{standard:"EIP 1474",message:"Method not supported."},"-32005":{standard:"EIP 1474",message:"Request limit exceeded."},"4001":{standard:"EIP 1193",message:"User rejected the request."},"4100":{standard:"EIP 1193",message:"The requested account and/or method has not been authorized by the user."},"4200":{standard:"EIP 1193",message:"The requested method is not supported by this Ethereum provider."},"4900":{standard:"EIP 1193",message:"The provider is disconnected from all chains."},"4901":{standard:"EIP 1193",message:"The provider is disconnected from the specified chain."}}});var Xg=D((oOe,Jne)=>{Jne.exports={rpc:{invalidInput:-32e3,resourceNotFound:-32001,resourceUnavailable:-32002,transactionRejected:-32003,methodNotSupported:-32004,limitExceeded:-32005,parse:-32700,invalidRequest:-32600,methodNotFound:-32601,invalidParams:-32602,internal:-32603},provider:{userRejectedRequest:4001,unauthorized:4100,unsupportedMethod:4200,disconnected:4900,chainDisconnected:4901}}});var HS=D((cOe,EL)=>{d();f();var US=SL(),_L=Xg().rpc.internal,{EthereumRpcError:Xne}=Jg(),CL="Unspecified server error.",Zne="Unspecified error message. This is a bug, please report it.",Qne={code:_L,message:FS(_L)};function FS(r,e=Zne){if(Number.isInteger(r)){let t=r.toString();if(US[t])return US[t].message;if(IL(r))return CL}return e}function TL(r){if(!Number.isInteger(r))return!1;let e=r.toString();return!!(US[e]||IL(r))}function eae(r,{fallbackError:e=Qne,shouldIncludeStack:t=!1}={}){if(!e||!Number.isInteger(e.code)||typeof e.message!="string")throw new Error("Must provide fallback error with integer number code and string message.");if(r instanceof Xne)return r.serialize();let n={};return r&&TL(r.code)?(n.code=r.code,r.message&&typeof r.message=="string"?(n.message=r.message,"data"in r&&(n.data=r.data)):(n.message=FS(n.code),n.data={originalError:AL(r)})):(n.code=e.code,n.message=r&&r.message?r.message:e.message,n.data={originalError:AL(r)}),t&&r&&typeof r.stack=="string"&&(n.stack=r.stack),n}function IL(r){return r>=-32099&&r<=-32e3}function AL(r){return r&&typeof r=="object"&&!Array.isArray(r)?{...r}:r}EL.exports={getMessageFromCode:FS,isValidCode:TL,serializeError:eae,JSON_RPC_SERVER_ERROR_MESSAGE:CL}});var kL=D((lOe,RL)=>{d();f();var{EthereumRpcError:tae,EthereumProviderError:PL}=Jg(),{getMessageFromCode:ML}=HS(),cn=Xg();RL.exports={rpc:{parse:r=>ia(cn.rpc.parse,r),invalidRequest:r=>ia(cn.rpc.invalidRequest,r),invalidParams:r=>ia(cn.rpc.invalidParams,r),methodNotFound:r=>ia(cn.rpc.methodNotFound,r),internal:r=>ia(cn.rpc.internal,r),server:r=>{if(!r||typeof r!="object"||Array.isArray(r))throw new Error("Ethereum RPC Server errors must provide single object argument.");let{code:e}=r;if(!Number.isInteger(e)||e>-32005||e<-32099)throw new Error('"code" must be an integer such that: -32099 <= code <= -32005');return ia(e,r)},invalidInput:r=>ia(cn.rpc.invalidInput,r),resourceNotFound:r=>ia(cn.rpc.resourceNotFound,r),resourceUnavailable:r=>ia(cn.rpc.resourceUnavailable,r),transactionRejected:r=>ia(cn.rpc.transactionRejected,r),methodNotSupported:r=>ia(cn.rpc.methodNotSupported,r),limitExceeded:r=>ia(cn.rpc.limitExceeded,r)},provider:{userRejectedRequest:r=>fh(cn.provider.userRejectedRequest,r),unauthorized:r=>fh(cn.provider.unauthorized,r),unsupportedMethod:r=>fh(cn.provider.unsupportedMethod,r),disconnected:r=>fh(cn.provider.disconnected,r),chainDisconnected:r=>fh(cn.provider.chainDisconnected,r),custom:r=>{if(!r||typeof r!="object"||Array.isArray(r))throw new Error("Ethereum Provider custom errors must provide single object argument.");let{code:e,message:t,data:n}=r;if(!t||typeof t!="string")throw new Error('"message" must be a nonempty string');return new PL(e,t,n)}}};function ia(r,e){let[t,n]=NL(e);return new tae(r,t||ML(r),n)}function fh(r,e){let[t,n]=NL(e);return new PL(r,t||ML(r),n)}function NL(r){if(r){if(typeof r=="string")return[r];if(typeof r=="object"&&!Array.isArray(r)){let{message:e,data:t}=r;return[e,t]}}return[]}});var Zg=D((pOe,OL)=>{d();f();var{EthereumRpcError:rae,EthereumProviderError:nae}=Jg(),{serializeError:aae,getMessageFromCode:sae}=HS(),iae=kL(),oae=Xg();OL.exports={ethErrors:iae,EthereumRpcError:rae,EthereumProviderError:nae,serializeError:aae,getMessageFromCode:sae,ERROR_CODES:oae}});var LL=D((bOe,DL)=>{d();f();(function(){"use strict";function r(e){var t;return e instanceof p.Buffer?t=e:t=p.Buffer.from(e.toString(),"binary"),t.toString("base64")}DL.exports=r})()});var Xo=D((wOe,BL)=>{d();f();BL.exports=function(e){return(t,n,a,s)=>{let i,o=new Promise(h=>{i=h}),c,l;e(t,n,async()=>{l=!0,a(h=>{c=h,i()}),await o}).then(async()=>{l?(await o,c(null)):s(null)}).catch(h=>{c?c(h):s(h)})}}});var KL=D((_Oe,GS)=>{d();f();var cae=globalThis.fetch||fL(),dae=dh(),{ethErrors:lh}=Zg(),fae=LL(),lae=Xo();GS.exports=hae;GS.exports.createFetchConfigFromReq=WL;var uae=["Gateway timeout","ETIMEDOUT","failed to parse response body","Failed to fetch"];function hae({rpcUrl:r,originHttpHeaderKey:e}){return lae(async(t,n,a)=>{let{fetchUrl:s,fetchParams:i}=WL({req:t,rpcUrl:r,originHttpHeaderKey:e}),o=5,c=1e3;for(let l=0;l<o;l++){try{let u=await cae(s,i);pae(u);let h=await u.text(),b;try{b=JSON.parse(h)}catch{throw new Error(`FetchMiddleware - failed to parse response body: "${h}"`)}let y=mae(u,b);n.result=y;return}catch(u){let h=u.toString();if(!uae.some(y=>h.includes(y)))throw u?.data?.code?u.data:u}await xae(c)}})}function pae(r){switch(r.status){case 405:throw lh.rpc.methodNotFound();case 418:throw bae();case 503:case 504:throw yae()}}function mae(r,e){if(r.status!==200)throw lh.rpc.internal({message:`Non-200 status code: '${r.status}'`,data:e});if(e.error)throw lh.rpc.internal({data:e.error});return e.result}function WL({req:r,rpcUrl:e,originHttpHeaderKey:t}){let n=dae.parse(e),a=gae(n),s={id:r.id,jsonrpc:r.jsonrpc,method:r.method,params:r.params},i=r.origin,o=JSON.stringify(s),c={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:o};if(n.auth){let l=fae(n.auth);c.headers.Authorization=`Basic ${l}`}return t&&i&&(c.headers[t]=i),{fetchUrl:a,fetchParams:c}}function gae(r){let e="";return e+=r.protocol,r.slashes&&(e+="//"),e+=r.hostname,r.port&&(e+=`:${r.port}`),e+=`${r.path}`,e}function bae(){return lh.rpc.internal({message:"Request is being rate limited."})}function yae(){let r="Gateway timeout. The request took too long to process. ";return r+="This can happen when querying logs over too wide a block range.",lh.rpc.internal({message:r})}function xae(r){return new Promise(e=>setTimeout(e,r))}});var GL=D((TOe,HL)=>{d();f();var Qg,be,qL={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"},zS,Ri=function(r){throw{name:"SyntaxError",message:r,at:Qg,text:zS}},De=function(r){return r&&r!==be&&Ri("Expected '"+r+"' instead of '"+be+"'"),be=zS.charAt(Qg),Qg+=1,be},UL=function(){var r,e="";for(be==="-"&&(e="-",De("-"));be>="0"&&be<="9";)e+=be,De();if(be===".")for(e+=".";De()&&be>="0"&&be<="9";)e+=be;if(be==="e"||be==="E")for(e+=be,De(),(be==="-"||be==="+")&&(e+=be,De());be>="0"&&be<="9";)e+=be,De();if(r=+e,!isFinite(r))Ri("Bad number");else return r},FL=function(){var r,e,t="",n;if(be==='"')for(;De();){if(be==='"')return De(),t;if(be==="\\")if(De(),be==="u"){for(n=0,e=0;e<4&&(r=parseInt(De(),16),!!isFinite(r));e+=1)n=n*16+r;t+=String.fromCharCode(n)}else if(typeof qL[be]=="string")t+=qL[be];else break;else t+=be}Ri("Bad string")},Os=function(){for(;be&&be<=" ";)De()},wae=function(){switch(be){case"t":return De("t"),De("r"),De("u"),De("e"),!0;case"f":return De("f"),De("a"),De("l"),De("s"),De("e"),!1;case"n":return De("n"),De("u"),De("l"),De("l"),null}Ri("Unexpected '"+be+"'")},eb,vae=function(){var r=[];if(be==="["){if(De("["),Os(),be==="]")return De("]"),r;for(;be;){if(r.push(eb()),Os(),be==="]")return De("]"),r;De(","),Os()}}Ri("Bad array")},Sae=function(){var r,e={};if(be==="{"){if(De("{"),Os(),be==="}")return De("}"),e;for(;be;){if(r=FL(),Os(),De(":"),Object.hasOwnProperty.call(e,r)&&Ri('Duplicate key "'+r+'"'),e[r]=eb(),Os(),be==="}")return De("}"),e;De(","),Os()}}Ri("Bad object")};eb=function(){switch(Os(),be){case"{":return Sae();case"[":return vae();case'"':return FL();case"-":return UL();default:return be>="0"&&be<="9"?UL():wae()}};HL.exports=function(r,e){var t;return zS=r,Qg=0,be=" ",t=eb(),Os(),be&&Ri("Syntax error"),typeof e=="function"?function n(a,s){var i,o,c=a[s];if(c&&typeof c=="object")for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(o=n(c,i),o!==void 0?c[i]=o:delete c[i]);return e.call(a,s,c)}({"":t},""):t}});var jL=D((POe,zL)=>{d();f();var jS=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,Bn,tb,_ae={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},Zo;function VS(r){return jS.lastIndex=0,jS.test(r)?'"'+r.replace(jS,function(e){var t=_ae[e];return typeof t=="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+r+'"'}function rb(r,e){var t,n,a,s,i=Bn,o,c=e[r];switch(c&&typeof c=="object"&&typeof c.toJSON=="function"&&(c=c.toJSON(r)),typeof Zo=="function"&&(c=Zo.call(e,r,c)),typeof c){case"string":return VS(c);case"number":return isFinite(c)?String(c):"null";case"boolean":case"null":return String(c);case"object":if(!c)return"null";if(Bn+=tb,o=[],Object.prototype.toString.apply(c)==="[object Array]"){for(s=c.length,t=0;t<s;t+=1)o[t]=rb(t,c)||"null";return a=o.length===0?"[]":Bn?`[
`+Bn+o.join(`,
`+Bn)+`
`+i+"]":"["+o.join(",")+"]",Bn=i,a}if(Zo&&typeof Zo=="object")for(s=Zo.length,t=0;t<s;t+=1)n=Zo[t],typeof n=="string"&&(a=rb(n,c),a&&o.push(VS(n)+(Bn?": ":":")+a));else for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(a=rb(n,c),a&&o.push(VS(n)+(Bn?": ":":")+a));return a=o.length===0?"{}":Bn?`{
`+Bn+o.join(`,
`+Bn)+`
`+i+"}":"{"+o.join(",")+"}",Bn=i,a}}zL.exports=function(r,e,t){var n;if(Bn="",tb="",typeof t=="number")for(n=0;n<t;n+=1)tb+=" ";else typeof t=="string"&&(tb=t);if(Zo=e,e&&typeof e!="function"&&(typeof e!="object"||typeof e.length!="number"))throw new Error("JSON.stringify");return rb("",{"":r})}});var VL=D($S=>{d();f();$S.parse=GL();$S.stringify=jL()});var YL=D((DOe,$L)=>{d();f();var nb=typeof JSON<"u"?JSON:VL();$L.exports=function(r,e){e||(e={}),typeof e=="function"&&(e={cmp:e});var t=e.space||"";typeof t=="number"&&(t=Array(t+1).join(" "));var n=typeof e.cycles=="boolean"?e.cycles:!1,a=e.replacer||function(o,c){return c},s=e.cmp&&function(o){return function(c){return function(l,u){var h={key:l,value:c[l]},b={key:u,value:c[u]};return o(h,b)}}}(e.cmp),i=[];return function o(c,l,u,h){var b=t?`
`+new Array(h+1).join(t):"",y=t?": ":":";if(u&&u.toJSON&&typeof u.toJSON=="function"&&(u=u.toJSON()),u=a.call(c,l,u),u!==void 0){if(typeof u!="object"||u===null)return nb.stringify(u);if(Aae(u)){for(var v=[],S=0;S<u.length;S++){var R=o(u,S,u[S],h+1)||nb.stringify(null);v.push(b+t+R)}return"["+v.join(",")+b+"]"}else{if(i.indexOf(u)!==-1){if(n)return nb.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}else i.push(u);for(var P=Cae(u).sort(s&&s(u)),v=[],S=0;S<P.length;S++){var l=P[S],N=o(u,l,u[l],h+1);if(!!N){var M=nb.stringify(l)+y+N;v.push(b+t+M)}}return i.splice(i.indexOf(u),1),"{"+v.join(",")+b+"}"}}}({"":r},"",r,0)};var Aae=Array.isArray||function(r){return{}.toString.call(r)==="[object Array]"},Cae=Object.keys||function(r){var e=Object.prototype.hasOwnProperty||function(){return!0},t=[];for(var n in r)e.call(r,n)&&t.push(n);return t}});var ab=D((WOe,QL)=>{d();f();var Tae=YL();QL.exports={cacheIdentifierForPayload:Iae,canCache:JL,blockTagForPayload:Eae,paramsWithoutBlockTag:XL,blockTagParamIndex:YS,cacheTypeForPayload:ZL};function Iae(r,e){let t=e?XL(r):r.params;return JL(r)?r.method+":"+Tae(t):null}function JL(r){return ZL(r)!=="never"}function Eae(r){let e=YS(r);return e>=r.params.length?null:r.params[e]}function XL(r){let e=YS(r);return e>=r.params.length?r.params:r.method==="eth_getBlockByNumber"?r.params.slice(1):r.params.slice(0,e)}function YS(r){switch(r.method){case"eth_getStorageAt":return 2;case"eth_getBalance":case"eth_getCode":case"eth_getTransactionCount":case"eth_call":return 1;case"eth_getBlockByNumber":return 0;default:return}}function ZL(r){switch(r.method){case"web3_clientVersion":case"web3_sha3":case"eth_protocolVersion":case"eth_getBlockTransactionCountByHash":case"eth_getUncleCountByBlockHash":case"eth_getCode":case"eth_getBlockByHash":case"eth_getTransactionByHash":case"eth_getTransactionByBlockHashAndIndex":case"eth_getTransactionReceipt":case"eth_getUncleByBlockHashAndIndex":case"eth_getCompilers":case"eth_compileLLL":case"eth_compileSolidity":case"eth_compileSerpent":case"shh_version":case"test_permaCache":return"perma";case"eth_getBlockByNumber":case"eth_getBlockTransactionCountByNumber":case"eth_getUncleCountByBlockNumber":case"eth_getTransactionByBlockNumberAndIndex":case"eth_getUncleByBlockNumberAndIndex":case"test_forkCache":return"fork";case"eth_gasPrice":case"eth_blockNumber":case"eth_getBalance":case"eth_getStorageAt":case"eth_getTransactionCount":case"eth_call":case"eth_estimateGas":case"eth_getFilterLogs":case"eth_getLogs":case"test_blockCache":return"block";case"net_version":case"net_peerCount":case"net_listening":case"eth_syncing":case"eth_sign":case"eth_coinbase":case"eth_mining":case"eth_hashrate":case"eth_accounts":case"eth_sendTransaction":case"eth_sendRawTransaction":case"eth_newFilter":case"eth_newBlockFilter":case"eth_newPendingTransactionFilter":case"eth_uninstallFilter":case"eth_getFilterChanges":case"eth_getWork":case"eth_submitWork":case"eth_submitHashrate":case"db_putString":case"db_getString":case"db_putHex":case"db_getHex":case"shh_post":case"shh_newIdentity":case"shh_hasIdentity":case"shh_newGroup":case"shh_addToGroup":case"shh_newFilter":case"shh_uninstallFilter":case"shh_getFilterChanges":case"shh_getMessages":case"test_neverCache":return"never"}}});var tB=D((UOe,eB)=>{d();f();var Pae=Xo(),Mae=ab().blockTagParamIndex;eB.exports=Nae;function Nae(r={}){let{blockTracker:e}=r;if(!e)throw Error('BlockRefRewriteMiddleware - mandatory "blockTracker" option is missing.');return Pae(async(t,n,a)=>{let s=Mae(t);if(s===void 0)return a();let i=t.params[s];if(i===void 0&&(i="latest"),i!=="latest")return a();a()})}});var nB=D((GOe,rB)=>{d();f();var lf=ab(),Rae=Xo(),kae=[void 0,null,"<nil>"];rB.exports=Oae;function Oae(r={}){let{blockTracker:e}=r;if(!e)throw new Error("createBlockCacheMiddleware - No BlockTracker specified");let t=new JS,n={perma:t,block:t,fork:t};return Rae(async(a,s,i)=>{if(a.skipCache)return i();let o=lf.cacheTypeForPayload(a),c=n[o];if(!c||!c.canCacheRequest(a))return i();let l=lf.blockTagForPayload(a);l||(l="latest");let u;if(l==="earliest")u="0x00";else if(l==="latest"){let b=await e.getLatestBlock();t.clearBefore(b),u=b}else u=l;let h=await c.get(a,u);h===void 0?(await i(),await c.set(a,u,s.result)):s.result=h})}var JS=class{constructor(){this.cache={}}getBlockCacheForPayload(e,t){let n=Number.parseInt(t,16),a=this.cache[n];if(!a){let s={};this.cache[n]=s,a=s}return a}async get(e,t){let n=this.getBlockCacheForPayload(e,t);if(!n)return;let a=lf.cacheIdentifierForPayload(e,!0);return n[a]}async set(e,t,n){if(!this.canCacheResult(e,n))return;let s=this.getBlockCacheForPayload(e,t),i=lf.cacheIdentifierForPayload(e,!0);s[i]=n}canCacheRequest(e){return!(!lf.canCache(e)||lf.blockTagForPayload(e)==="pending")}canCacheResult(e,t){if(!kae.includes(t))return!(["eth_getTransactionByHash","eth_getTransactionReceipt"].includes(e.method)&&(!t||!t.blockHash||t.blockHash==="0x0000000000000000000000000000000000000000000000000000000000000000"))}clearBefore(e){let t=this,n=Number.parseInt(e,16);Object.keys(t.cache).map(Number).filter(a=>a<n).forEach(a=>delete t.cache[a])}}});var aB=D((VOe,sb)=>{d();f();var Dae=function(){"use strict";function r(u,h){return h!=null&&u instanceof h}var e;try{e=Map}catch{e=function(){}}var t;try{t=Set}catch{t=function(){}}var n;try{n=Promise}catch{n=function(){}}function a(u,h,b,y,v){typeof h=="object"&&(b=h.depth,y=h.prototype,v=h.includeNonEnumerable,h=h.circular);var S=[],R=[],P=typeof p.Buffer<"u";typeof h>"u"&&(h=!0),typeof b>"u"&&(b=1/0);function N(M,L){if(M===null)return null;if(L===0)return M;var B,F;if(typeof M!="object")return M;if(r(M,e))B=new e;else if(r(M,t))B=new t;else if(r(M,n))B=new n(function(w,I){M.then(function(k){w(N(k,L-1))},function(k){I(N(k,L-1))})});else if(a.__isArray(M))B=[];else if(a.__isRegExp(M))B=new RegExp(M.source,l(M)),M.lastIndex&&(B.lastIndex=M.lastIndex);else if(a.__isDate(M))B=new Date(M.getTime());else{if(P&&p.Buffer.isBuffer(M))return p.Buffer.allocUnsafe?B=p.Buffer.allocUnsafe(M.length):B=new p.Buffer(M.length),M.copy(B),B;r(M,Error)?B=Object.create(M):typeof y>"u"?(F=Object.getPrototypeOf(M),B=Object.create(F)):(B=Object.create(y),F=y)}if(h){var K=S.indexOf(M);if(K!=-1)return R[K];S.push(M),R.push(B)}r(M,e)&&M.forEach(function(w,I){var k=N(I,L-1),O=N(w,L-1);B.set(k,O)}),r(M,t)&&M.forEach(function(w){var I=N(w,L-1);B.add(I)});for(var H in M){var j;F&&(j=Object.getOwnPropertyDescriptor(F,H)),!(j&&j.set==null)&&(B[H]=N(M[H],L-1))}if(Object.getOwnPropertySymbols)for(var X=Object.getOwnPropertySymbols(M),H=0;H<X.length;H++){var z=X[H],T=Object.getOwnPropertyDescriptor(M,z);T&&!T.enumerable&&!v||(B[z]=N(M[z],L-1),T.enumerable||Object.defineProperty(B,z,{enumerable:!1}))}if(v)for(var m=Object.getOwnPropertyNames(M),H=0;H<m.length;H++){var x=m[H],T=Object.getOwnPropertyDescriptor(M,x);T&&T.enumerable||(B[x]=N(M[x],L-1),Object.defineProperty(B,x,{enumerable:!1}))}return B}return N(u,b)}a.clonePrototype=function(h){if(h===null)return null;var b=function(){};return b.prototype=h,new b};function s(u){return Object.prototype.toString.call(u)}a.__objToStr=s;function i(u){return typeof u=="object"&&s(u)==="[object Date]"}a.__isDate=i;function o(u){return typeof u=="object"&&s(u)==="[object Array]"}a.__isArray=o;function c(u){return typeof u=="object"&&s(u)==="[object RegExp]"}a.__isRegExp=c;function l(u){var h="";return u.global&&(h+="g"),u.ignoreCase&&(h+="i"),u.multiline&&(h+="m"),h}return a.__getRegExpFlags=l,a}();typeof sb=="object"&&sb.exports&&(sb.exports=Dae)});var oB=D((JOe,iB)=>{d();f();var sB=aB(),Lae=Xo(),Bae=ab().cacheIdentifierForPayload;iB.exports=Wae;function Wae(){let r={};return Lae(async(n,a,s)=>{if(n.skipCache)return s();let i=Bae(n);if(!i)return s();let o=r[i];if(o){await e(a,o);return}o=[],r[i]=o,await s(),delete r[i],t(a,o)});function e(n,a){let{resolve:s,promise:i}=Kae();return a.push(o=>{n.result=sB(o.result),n.error=sB(o.error),s()}),i}function t(n,a){setTimeout(()=>{a.forEach(s=>{try{s(n)}catch(i){console.error(i)}})})}}function Kae(){let r,e=new Promise(t=>{r=t});return{resolve:r,promise:e}}});var dB=D((QOe,cB)=>{d();f();var qae=Xo(),Uae=["eth_getTransactionByHash","eth_getTransactionReceipt"];cB.exports=Fae;function Fae({blockTracker:r}){return qae(async(e,t,n)=>{if(!Uae.includes(e.method))return n();if(await n(),!t.result||!t.result.blockNumber)return;let a=Number.parseInt(t.result.blockNumber,16),s=Number.parseInt(r.getCurrentBlock(),16);a>s&&await r.checkForLatestBlock()})}});var mB=D((rDe,pB)=>{"use strict";d();f();var Hae=Pr(),{serializeError:fB,EthereumRpcError:lB,ERROR_CODES:uB}=Zg();pB.exports=class hB extends Hae{constructor(){super(),this._middleware=[]}push(e){this._middleware.push(e)}handle(e,t){if(Array.isArray(e)){if(t){this._handleBatch(e).then(n=>t(null,n)).catch(n=>t(n));return}return this._handleBatch(e)}return t?this._handle(e,t):this._promiseHandle(e)}async _handleBatch(e){return await Promise.all(e.map(this._promiseHandle.bind(this)))}_promiseHandle(e){return new Promise(t=>{this._handle(e,(n,a)=>{t(a)})})}_handle(e,t){let n=Object.assign({},e),a={id:n.id,jsonrpc:n.jsonrpc},s;this._processRequest(n,a).catch(i=>{s=i}).finally(()=>{let i=a._originalError;delete a._originalError;let o=i||s||null;o&&(delete a.result,a.error||(a.error=fB(o))),t(o,a)})}async _processRequest(e,t){let{isComplete:n,returnHandlers:a}=await this._runAllMiddleware(e,t);this._checkForCompletion(e,t,n),await this._runReturnHandlers(a)}async _runReturnHandlers(e){for(let t of e)await new Promise((n,a)=>{t(s=>s?a(s):n())})}_checkForCompletion(e,t,n){if(!("result"in t)&&!("error"in t)){let s=`JsonRpcEngine: Response has no error or result for request:
${JSON.stringify(e,null,2)}`;throw new lB(uB.rpc.internal,s,e)}if(!n){let s=`JsonRpcEngine: Nothing ended request:
${JSON.stringify(e,null,2)}`;throw new lB(uB.rpc.internal,s,e)}}async _runAllMiddleware(e,t){let n=[],a=!1;for(let s of this._middleware)if(a=await hB._runMiddleware(e,t,s,n),a)break;return{isComplete:a,returnHandlers:n.reverse()}}static _runMiddleware(e,t,n,a){return new Promise(s=>{let i=c=>{let l=c||t&&t.error;l&&(t.error=fB(l),t._originalError=l),s(!0)},o=c=>{t.error?i(t.error):(c&&a.push(c),s(!1))};try{n(e,t,o,i)}catch(c){i(c)}})}}});var bB=D((sDe,gB)=>{d();f();var Gae=mB(),zae=LS();gB.exports=jae;function jae(r){let e=new Gae;return e.push(r),zae(e)}});var xB=D(ZS=>{"use strict";d();f();Object.defineProperty(ZS,"__esModule",{value:!0});var Vae=Rc();function yB(r,e,t){try{Reflect.apply(r,e,t)}catch(n){setTimeout(()=>{throw n})}}function $ae(r){let e=r.length,t=new Array(e);for(let n=0;n<e;n+=1)t[n]=r[n];return t}var XS=class extends Vae.EventEmitter{emit(e,...t){let n=e==="error",a=this._events;if(a!==void 0)n=n&&a.error===void 0;else if(!n)return!1;if(n){let i;if(t.length>0&&([i]=t),i instanceof Error)throw i;let o=new Error(`Unhandled error.${i?` (${i.message})`:""}`);throw o.context=i,o}let s=a[e];if(s===void 0)return!1;if(typeof s=="function")yB(s,this,t);else{let i=s.length,o=$ae(s);for(let c=0;c<i;c+=1)yB(o[c],this,t)}return!0}};ZS.default=XS});var ib=D(uf=>{"use strict";d();f();var Yae=uf&&uf.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(uf,"__esModule",{value:!0});uf.BaseBlockTracker=void 0;var Jae=Yae(xB()),Xae=1e3,Zae=(r,e)=>r+e,wB=["sync","latest"],QS=class extends Jae.default{constructor(e={}){super(),this._blockResetDuration=e.blockResetDuration||20*Xae,this._currentBlock=null,this._isRunning=!1,this._onNewListener=this._onNewListener.bind(this),this._onRemoveListener=this._onRemoveListener.bind(this),this._resetCurrentBlock=this._resetCurrentBlock.bind(this),this._setupInternalEvents()}isRunning(){return this._isRunning}getCurrentBlock(){return this._currentBlock}async getLatestBlock(){return this._currentBlock?this._currentBlock:await new Promise(t=>this.once("latest",t))}removeAllListeners(e){return e?super.removeAllListeners(e):super.removeAllListeners(),this._setupInternalEvents(),this._onRemoveListener(),this}_start(){}_end(){}_setupInternalEvents(){this.removeListener("newListener",this._onNewListener),this.removeListener("removeListener",this._onRemoveListener),this.on("newListener",this._onNewListener),this.on("removeListener",this._onRemoveListener)}_onNewListener(e){wB.includes(e)&&this._maybeStart()}_onRemoveListener(){this._getBlockTrackerEventCount()>0||this._maybeEnd()}_maybeStart(){this._isRunning||(this._isRunning=!0,this._cancelBlockResetTimeout(),this._start())}_maybeEnd(){!this._isRunning||(this._isRunning=!1,this._setupBlockResetTimeout(),this._end())}_getBlockTrackerEventCount(){return wB.map(e=>this.listenerCount(e)).reduce(Zae)}_newPotentialLatest(e){let t=this._currentBlock;t&&vB(e)<=vB(t)||this._setCurrentBlock(e)}_setCurrentBlock(e){let t=this._currentBlock;this._currentBlock=e,this.emit("latest",e),this.emit("sync",{oldBlock:t,newBlock:e})}_setupBlockResetTimeout(){this._cancelBlockResetTimeout(),this._blockResetTimeout=setTimeout(this._resetCurrentBlock,this._blockResetDuration),this._blockResetTimeout.unref&&this._blockResetTimeout.unref()}_cancelBlockResetTimeout(){this._blockResetTimeout&&clearTimeout(this._blockResetTimeout)}_resetCurrentBlock(){this._currentBlock=null}};uf.BaseBlockTracker=QS;function vB(r){return Number.parseInt(r,16)}});var ob=D((pDe,SB)=>{d();f();SB.exports=Qae;function Qae(r){r=r||{};var e=r.max||Number.MAX_SAFE_INTEGER,t=typeof r.start<"u"?r.start:Math.floor(Math.random()*e);return function(){return t=t%e,t++}}});var CB=D((bDe,AB)=>{"use strict";d();f();var _B=(r,e)=>function(){let t=e.promiseModule,n=new Array(arguments.length);for(let a=0;a<arguments.length;a++)n[a]=arguments[a];return new t((a,s)=>{e.errorFirst?n.push(function(i,o){if(e.multiArgs){let c=new Array(arguments.length-1);for(let l=1;l<arguments.length;l++)c[l-1]=arguments[l];i?(c.unshift(i),s(c)):a(c)}else i?s(i):a(o)}):n.push(function(i){if(e.multiArgs){let o=new Array(arguments.length-1);for(let c=0;c<arguments.length;c++)o[c]=arguments[c];a(o)}else a(i)}),r.apply(this,n)})};AB.exports=(r,e)=>{e=Object.assign({exclude:[/.+(Sync|Stream)$/],errorFirst:!0,promiseModule:Promise},e);let t=a=>{let s=i=>typeof i=="string"?a===i:i.test(a);return e.include?e.include.some(s):!e.exclude.some(s)},n;typeof r=="function"?n=function(){return e.excludeMain?r.apply(this,arguments):_B(r,e).apply(this,arguments)}:n=Object.create(Object.getPrototypeOf(r));for(let a in r){let s=r[a];n[a]=typeof s=="function"&&t(a)?_B(s,e):s}return n}});var EB=D(hf=>{"use strict";d();f();var IB=hf&&hf.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(hf,"__esModule",{value:!0});hf.PollingBlockTracker=void 0;var ese=IB(ob()),tse=IB(CB()),rse=ib(),nse=ese.default(),ase=1e3,e2=class extends rse.BaseBlockTracker{constructor(e={}){if(!e.provider)throw new Error("PollingBlockTracker - no provider specified.");super({blockResetDuration:e.pollingInterval}),this._provider=e.provider,this._pollingInterval=e.pollingInterval||20*ase,this._retryTimeout=e.retryTimeout||this._pollingInterval/10,this._keepEventLoopActive=e.keepEventLoopActive===void 0?!0:e.keepEventLoopActive,this._setSkipCacheFlag=e.setSkipCacheFlag||!1}async checkForLatestBlock(){return await this._updateLatestBlock(),await this.getLatestBlock()}_start(){this._synchronize().catch(e=>this.emit("error",e))}async _synchronize(){for(;this._isRunning;)try{await this._updateLatestBlock(),await TB(this._pollingInterval,!this._keepEventLoopActive)}catch(e){let t=new Error(`PollingBlockTracker - encountered an error while attempting to update latest block:
${e.stack}`);try{this.emit("error",t)}catch{console.error(t)}await TB(this._retryTimeout,!this._keepEventLoopActive)}}async _updateLatestBlock(){let e=await this._fetchLatestBlock();this._newPotentialLatest(e)}async _fetchLatestBlock(){let e={jsonrpc:"2.0",id:nse(),method:"eth_blockNumber",params:[]};this._setSkipCacheFlag&&(e.skipCache=!0);let t=await tse.default(n=>this._provider.sendAsync(e,n))();if(t.error)throw new Error(`PollingBlockTracker - encountered error fetching block:
${t.error}`);return t.result}};hf.PollingBlockTracker=e2;function TB(r,e){return new Promise(t=>{let n=setTimeout(t,r);n.unref&&e&&n.unref()})}});var PB=D(pf=>{"use strict";d();f();var sse=pf&&pf.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(pf,"__esModule",{value:!0});pf.SubscribeBlockTracker=void 0;var ise=sse(ob()),ose=ib(),cse=ise.default(),t2=class extends ose.BaseBlockTracker{constructor(e={}){if(!e.provider)throw new Error("SubscribeBlockTracker - no provider specified.");super(e),this._provider=e.provider,this._subscriptionId=null}async checkForLatestBlock(){return await this.getLatestBlock()}async _start(){if(this._subscriptionId===void 0||this._subscriptionId===null)try{let e=await this._call("eth_blockNumber");this._subscriptionId=await this._call("eth_subscribe","newHeads",{}),this._provider.on("data",this._handleSubData.bind(this)),this._newPotentialLatest(e)}catch(e){this.emit("error",e)}}async _end(){if(this._subscriptionId!==null&&this._subscriptionId!==void 0)try{await this._call("eth_unsubscribe",this._subscriptionId),this._subscriptionId=null}catch(e){this.emit("error",e)}}_call(e,...t){return new Promise((n,a)=>{this._provider.sendAsync({id:cse(),method:e,params:t,jsonrpc:"2.0"},(s,i)=>{s?a(s):n(i.result)})})}_handleSubData(e,t){var n;t.method==="eth_subscription"&&((n=t.params)===null||n===void 0?void 0:n.subscription)===this._subscriptionId&&this._newPotentialLatest(t.params.result.number)}};pf.SubscribeBlockTracker=t2});var MB=D(Ds=>{"use strict";d();f();var dse=Ds&&Ds.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),r2=Ds&&Ds.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&dse(e,r,t)};Object.defineProperty(Ds,"__esModule",{value:!0});r2(ib(),Ds);r2(EB(),Ds);r2(PB(),Ds)});var n2=D((RDe,KB)=>{d();f();KB.exports=function(e){return(t,n,a,s)=>{let i=e[t.method];return i===void 0?a():typeof i=="function"?i(t,n,a,s):(n.result=i,s())}}});var FB=D((DDe,UB)=>{"use strict";d();f();var a2=ho().Buffer,qB=bl().Transform,pse=Tr();UB.exports=function(r){function e(t,n,a,s,i){qB.call(this,i),this._rate=t,this._capacity=n,this._delimitedSuffix=a,this._hashBitLength=s,this._options=i,this._state=new r,this._state.initialize(t,n),this._finalized=!1}return pse(e,qB),e.prototype._transform=function(t,n,a){var s=null;try{this.update(t,n)}catch(i){s=i}a(s)},e.prototype._flush=function(t){var n=null;try{this.push(this.digest())}catch(a){n=a}t(n)},e.prototype.update=function(t,n){if(!a2.isBuffer(t)&&typeof t!="string")throw new TypeError("Data must be a string or a buffer");if(this._finalized)throw new Error("Digest already called");return a2.isBuffer(t)||(t=a2.from(t,n)),this._state.absorb(t),this},e.prototype.digest=function(t){if(this._finalized)throw new Error("Digest already called");this._finalized=!0,this._delimitedSuffix&&this._state.absorbLastFewBits(this._delimitedSuffix);var n=this._state.squeeze(this._hashBitLength/8);return t!==void 0&&(n=n.toString(t)),this._resetState(),n},e.prototype._resetState=function(){return this._state.initialize(this._rate,this._capacity),this},e.prototype._clone=function(){var t=new e(this._rate,this._capacity,this._delimitedSuffix,this._hashBitLength,this._options);return this._state.copy(t._state),t._finalized=this._finalized,t},e}});var zB=D((WDe,GB)=>{"use strict";d();f();var s2=ho().Buffer,HB=bl().Transform,mse=Tr();GB.exports=function(r){function e(t,n,a,s){HB.call(this,s),this._rate=t,this._capacity=n,this._delimitedSuffix=a,this._options=s,this._state=new r,this._state.initialize(t,n),this._finalized=!1}return mse(e,HB),e.prototype._transform=function(t,n,a){var s=null;try{this.update(t,n)}catch(i){s=i}a(s)},e.prototype._flush=function(){},e.prototype._read=function(t){this.push(this.squeeze(t))},e.prototype.update=function(t,n){if(!s2.isBuffer(t)&&typeof t!="string")throw new TypeError("Data must be a string or a buffer");if(this._finalized)throw new Error("Squeeze already called");return s2.isBuffer(t)||(t=s2.from(t,n)),this._state.absorb(t),this},e.prototype.squeeze=function(t,n){this._finalized||(this._finalized=!0,this._state.absorbLastFewBits(this._delimitedSuffix));var a=this._state.squeeze(t);return n!==void 0&&(a=a.toString(n)),a},e.prototype._resetState=function(){return this._state.initialize(this._rate,this._capacity),this},e.prototype._clone=function(){var t=new e(this._rate,this._capacity,this._delimitedSuffix,this._options);return this._state.copy(t._state),t._finalized=this._finalized,t},e}});var VB=D((UDe,jB)=>{"use strict";d();f();var gse=FB(),bse=zB();jB.exports=function(r){var e=gse(r),t=bse(r);return function(n,a){var s=typeof n=="string"?n.toLowerCase():n;switch(s){case"keccak224":return new e(1152,448,null,224,a);case"keccak256":return new e(1088,512,null,256,a);case"keccak384":return new e(832,768,null,384,a);case"keccak512":return new e(576,1024,null,512,a);case"sha3-224":return new e(1152,448,6,224,a);case"sha3-256":return new e(1088,512,6,256,a);case"sha3-384":return new e(832,768,6,384,a);case"sha3-512":return new e(576,1024,6,512,a);case"shake128":return new t(1344,256,31,a);case"shake256":return new t(1088,512,31,a);default:throw new Error("Invald algorithm: "+n)}}}});var JB=D(YB=>{"use strict";d();f();var $B=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648];YB.p1600=function(r){for(var e=0;e<24;++e){var t=r[0]^r[10]^r[20]^r[30]^r[40],n=r[1]^r[11]^r[21]^r[31]^r[41],a=r[2]^r[12]^r[22]^r[32]^r[42],s=r[3]^r[13]^r[23]^r[33]^r[43],i=r[4]^r[14]^r[24]^r[34]^r[44],o=r[5]^r[15]^r[25]^r[35]^r[45],c=r[6]^r[16]^r[26]^r[36]^r[46],l=r[7]^r[17]^r[27]^r[37]^r[47],u=r[8]^r[18]^r[28]^r[38]^r[48],h=r[9]^r[19]^r[29]^r[39]^r[49],b=u^(a<<1|s>>>31),y=h^(s<<1|a>>>31),v=r[0]^b,S=r[1]^y,R=r[10]^b,P=r[11]^y,N=r[20]^b,M=r[21]^y,L=r[30]^b,B=r[31]^y,F=r[40]^b,K=r[41]^y;b=t^(i<<1|o>>>31),y=n^(o<<1|i>>>31);var H=r[2]^b,j=r[3]^y,X=r[12]^b,z=r[13]^y,T=r[22]^b,m=r[23]^y,x=r[32]^b,w=r[33]^y,I=r[42]^b,k=r[43]^y;b=a^(c<<1|l>>>31),y=s^(l<<1|c>>>31);var O=r[4]^b,E=r[5]^y,A=r[14]^b,g=r[15]^y,C=r[24]^b,W=r[25]^y,V=r[34]^b,Q=r[35]^y,ie=r[44]^b,he=r[45]^y;b=i^(u<<1|h>>>31),y=o^(h<<1|u>>>31);var ve=r[6]^b,pr=r[7]^y,Ve=r[16]^b,nt=r[17]^y,fl=r[26]^b,Ft=r[27]^y,Ht=r[36]^b,ll=r[37]^y,Gt=r[46]^b,zt=r[47]^y;b=c^(t<<1|n>>>31),y=l^(n<<1|t>>>31);var ul=r[8]^b,jt=r[9]^y,Vt=r[18]^b,hl=r[19]^y,$t=r[28]^b,Yt=r[29]^y,pl=r[38]^b,Jt=r[39]^y,Xt=r[48]^b,ml=r[49]^y,pt=v,mt=S,vc=P<<4|R>>>28,gt=R<<4|P>>>28,bt=N<<3|M>>>29,Sc=M<<3|N>>>29,yt=B<<9|L>>>23,xt=L<<9|B>>>23,_c=F<<18|K>>>14,wt=K<<18|F>>>14,vt=H<<1|j>>>31,Ac=j<<1|H>>>31,St=z<<12|X>>>20,_t=X<<12|z>>>20,Cc=T<<10|m>>>22,At=m<<10|T>>>22,Ct=w<<13|x>>>19,Tc=x<<13|w>>>19,Tt=I<<2|k>>>30,It=k<<2|I>>>30,Ic=E<<30|O>>>2,Et=O<<30|E>>>2,Pt=A<<6|g>>>26,Ec=g<<6|A>>>26,Mt=W<<11|C>>>21,Nt=C<<11|W>>>21,Pc=V<<15|Q>>>17,Rt=Q<<15|V>>>17,kt=he<<29|ie>>>3,Mc=ie<<29|he>>>3,Ot=ve<<28|pr>>>4,Dt=pr<<28|ve>>>4,Nc=nt<<23|Ve>>>9,Lt=Ve<<23|nt>>>9,Bt=fl<<25|Ft>>>7,Xi=Ft<<25|fl>>>7,Zi=Ht<<21|ll>>>11,Qi=ll<<21|Ht>>>11,eo=zt<<24|Gt>>>8,to=Gt<<24|zt>>>8,ro=ul<<27|jt>>>5,no=jt<<27|ul>>>5,ao=Vt<<20|hl>>>12,so=hl<<20|Vt>>>12,io=Yt<<7|$t>>>25,oo=$t<<7|Yt>>>25,co=pl<<8|Jt>>>24,fo=Jt<<8|pl>>>24,lo=Xt<<14|ml>>>18,uo=ml<<14|Xt>>>18;r[0]=pt^~St&Mt,r[1]=mt^~_t&Nt,r[10]=Ot^~ao&bt,r[11]=Dt^~so&Sc,r[20]=vt^~Pt&Bt,r[21]=Ac^~Ec&Xi,r[30]=ro^~vc&Cc,r[31]=no^~gt&At,r[40]=Ic^~Nc&io,r[41]=Et^~Lt&oo,r[2]=St^~Mt&Zi,r[3]=_t^~Nt&Qi,r[12]=ao^~bt&Ct,r[13]=so^~Sc&Tc,r[22]=Pt^~Bt&co,r[23]=Ec^~Xi&fo,r[32]=vc^~Cc&Pc,r[33]=gt^~At&Rt,r[42]=Nc^~io&yt,r[43]=Lt^~oo&xt,r[4]=Mt^~Zi&lo,r[5]=Nt^~Qi&uo,r[14]=bt^~Ct&kt,r[15]=Sc^~Tc&Mc,r[24]=Bt^~co&_c,r[25]=Xi^~fo&wt,r[34]=Cc^~Pc&eo,r[35]=At^~Rt&to,r[44]=io^~yt&Tt,r[45]=oo^~xt&It,r[6]=Zi^~lo&pt,r[7]=Qi^~uo&mt,r[16]=Ct^~kt&Ot,r[17]=Tc^~Mc&Dt,r[26]=co^~_c&vt,r[27]=fo^~wt&Ac,r[36]=Pc^~eo&ro,r[37]=Rt^~to&no,r[46]=yt^~Tt&Ic,r[47]=xt^~It&Et,r[8]=lo^~pt&St,r[9]=uo^~mt&_t,r[18]=kt^~Ot&ao,r[19]=Mc^~Dt&so,r[28]=_c^~vt&Pt,r[29]=wt^~Ac&Ec,r[38]=eo^~ro&vc,r[39]=to^~no&gt,r[48]=Tt^~Ic&Nc,r[49]=It^~Et&Lt,r[0]^=$B[e*2],r[1]^=$B[e*2+1]}}});var ZB=D((VDe,XB)=>{"use strict";d();f();var yse=ho().Buffer,fb=JB();function mf(){this.state=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.blockSize=null,this.count=0,this.squeezing=!1}mf.prototype.initialize=function(r,e){for(var t=0;t<50;++t)this.state[t]=0;this.blockSize=r/8,this.count=0,this.squeezing=!1};mf.prototype.absorb=function(r){for(var e=0;e<r.length;++e)this.state[~~(this.count/4)]^=r[e]<<8*(this.count%4),this.count+=1,this.count===this.blockSize&&(fb.p1600(this.state),this.count=0)};mf.prototype.absorbLastFewBits=function(r){this.state[~~(this.count/4)]^=r<<8*(this.count%4),(r&128)!==0&&this.count===this.blockSize-1&&fb.p1600(this.state),this.state[~~((this.blockSize-1)/4)]^=128<<8*((this.blockSize-1)%4),fb.p1600(this.state),this.count=0,this.squeezing=!0};mf.prototype.squeeze=function(r){this.squeezing||this.absorbLastFewBits(1);for(var e=yse.alloc(r),t=0;t<r;++t)e[t]=this.state[~~(this.count/4)]>>>8*(this.count%4)&255,this.count+=1,this.count===this.blockSize&&(fb.p1600(this.state),this.count=0);return e};mf.prototype.copy=function(r){for(var e=0;e<50;++e)r.state[e]=this.state[e];r.blockSize=this.blockSize,r.count=this.count,r.squeezing=this.squeezing};XB.exports=mf});var eW=D((JDe,QB)=>{"use strict";d();f();QB.exports=VB()(ZB())});var tW=D(Ea=>{"use strict";d();f();var lb=Object.prototype.toString;Ea.isArray=function(r,e){if(!Array.isArray(r))throw TypeError(e)};Ea.isBoolean=function(r,e){if(lb.call(r)!=="[object Boolean]")throw TypeError(e)};Ea.isBuffer=function(r,e){if(!p.Buffer.isBuffer(r))throw TypeError(e)};Ea.isFunction=function(r,e){if(lb.call(r)!=="[object Function]")throw TypeError(e)};Ea.isNumber=function(r,e){if(lb.call(r)!=="[object Number]")throw TypeError(e)};Ea.isObject=function(r,e){if(lb.call(r)!=="[object Object]")throw TypeError(e)};Ea.isBufferLength=function(r,e,t){if(r.length!==e)throw RangeError(t)};Ea.isBufferLength2=function(r,e,t,n){if(r.length!==e&&r.length!==t)throw RangeError(n)};Ea.isLengthGTZero=function(r,e){if(r.length===0)throw RangeError(e)};Ea.isNumberInInterval=function(r,e,t,n){if(r<=e||r>=t)throw RangeError(n)}});var nW=D(gf=>{"use strict";d();f();var Pa=ho().Buffer,rW=l$(),xse=Pa.from([48,129,211,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,133,48,129,130,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,33,2,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,36,3,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),wse=Pa.from([48,130,1,19,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,165,48,129,162,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,65,4,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,72,58,218,119,38,163,196,101,93,164,251,252,14,17,8,168,253,23,180,72,166,133,84,25,156,71,208,143,251,16,212,184,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,68,3,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);gf.privateKeyExport=function(r,e,t){var n=Pa.from(t?xse:wse);return r.copy(n,t?8:9),e.copy(n,t?181:214),n};gf.privateKeyImport=function(r){var e=r.length,t=0;if(!(e<t+1||r[t]!==48)&&(t+=1,!(e<t+1||!(r[t]&128)))){var n=r[t]&127;if(t+=1,!(n<1||n>2)&&!(e<t+n)){var a=r[t+n-1]|(n>1?r[t+n-2]<<8:0);if(t+=n,!(e<t+a)&&!(e<t+3||r[t]!==2||r[t+1]!==1||r[t+2]!==1)&&(t+=3,!(e<t+2||r[t]!==4||r[t+1]>32||e<t+2+r[t+1])))return r.slice(t+2,t+2+r[t+1])}}};gf.signatureExport=function(r){for(var e=Pa.concat([Pa.from([0]),r.r]),t=33,n=0;t>1&&e[n]===0&&!(e[n+1]&128);--t,++n);for(var a=Pa.concat([Pa.from([0]),r.s]),s=33,i=0;s>1&&a[i]===0&&!(a[i+1]&128);--s,++i);return rW.encode(e.slice(n),a.slice(i))};gf.signatureImport=function(r){var e=Pa.alloc(32,0),t=Pa.alloc(32,0);try{var n=rW.decode(r);if(n.r.length===33&&n.r[0]===0&&(n.r=n.r.slice(1)),n.r.length>32)throw new Error("R length is too long");if(n.s.length===33&&n.s[0]===0&&(n.s=n.s.slice(1)),n.s.length>32)throw new Error("S length is too long")}catch{return}return n.r.copy(e,32-n.r.length),n.s.copy(t,32-n.s.length),{r:e,s:t}};gf.signatureImportLax=function(r){var e=Pa.alloc(32,0),t=Pa.alloc(32,0),n=r.length,a=0;if(r[a++]===48){var s=r[a++];if(!(s&128&&(a+=s-128,a>n))&&r[a++]===2){var i=r[a++];if(i&128){if(s=i-128,a+s>n)return;for(;s>0&&r[a]===0;a+=1,s-=1);for(i=0;s>0;a+=1,s-=1)i=(i<<8)+r[a]}if(!(i>n-a)){var o=a;if(a+=i,r[a++]===2){var c=r[a++];if(c&128){if(s=c-128,a+s>n)return;for(;s>0&&r[a]===0;a+=1,s-=1);for(c=0;s>0;a+=1,s-=1)c=(c<<8)+r[a]}if(!(c>n-a)){var l=a;for(a+=c;i>0&&r[o]===0;i-=1,o+=1);if(!(i>32)){var u=r.slice(o,o+i);for(u.copy(e,32-u.length);c>0&&r[l]===0;c-=1,l+=1);if(!(c>32)){var h=r.slice(l,l+c);return h.copy(t,32-h.length),{r:e,s:t}}}}}}}}}});var i2=D((sLe,vse)=>{vse.exports={COMPRESSED_TYPE_INVALID:"compressed should be a boolean",EC_PRIVATE_KEY_TYPE_INVALID:"private key should be a Buffer",EC_PRIVATE_KEY_LENGTH_INVALID:"private key length is invalid",EC_PRIVATE_KEY_RANGE_INVALID:"private key range is invalid",EC_PRIVATE_KEY_TWEAK_ADD_FAIL:"tweak out of range or resulting private key is invalid",EC_PRIVATE_KEY_TWEAK_MUL_FAIL:"tweak out of range",EC_PRIVATE_KEY_EXPORT_DER_FAIL:"couldn't export to DER format",EC_PRIVATE_KEY_IMPORT_DER_FAIL:"couldn't import from DER format",EC_PUBLIC_KEYS_TYPE_INVALID:"public keys should be an Array",EC_PUBLIC_KEYS_LENGTH_INVALID:"public keys Array should have at least 1 element",EC_PUBLIC_KEY_TYPE_INVALID:"public key should be a Buffer",EC_PUBLIC_KEY_LENGTH_INVALID:"public key length is invalid",EC_PUBLIC_KEY_PARSE_FAIL:"the public key could not be parsed or is invalid",EC_PUBLIC_KEY_CREATE_FAIL:"private was invalid, try again",EC_PUBLIC_KEY_TWEAK_ADD_FAIL:"tweak out of range or resulting public key is invalid",EC_PUBLIC_KEY_TWEAK_MUL_FAIL:"tweak out of range",EC_PUBLIC_KEY_COMBINE_FAIL:"the sum of the public keys is not valid",ECDH_FAIL:"scalar was invalid (zero or overflow)",ECDSA_SIGNATURE_TYPE_INVALID:"signature should be a Buffer",ECDSA_SIGNATURE_LENGTH_INVALID:"signature length is invalid",ECDSA_SIGNATURE_PARSE_FAIL:"couldn't parse signature",ECDSA_SIGNATURE_PARSE_DER_FAIL:"couldn't parse DER signature",ECDSA_SIGNATURE_SERIALIZE_DER_FAIL:"couldn't serialize signature to DER format",ECDSA_SIGN_FAIL:"nonce generation function failed or private key is invalid",ECDSA_RECOVER_FAIL:"couldn't recover public key from signature",MSG32_TYPE_INVALID:"message should be a Buffer",MSG32_LENGTH_INVALID:"message length is invalid",OPTIONS_TYPE_INVALID:"options should be an Object",OPTIONS_DATA_TYPE_INVALID:"options.data should be a Buffer",OPTIONS_DATA_LENGTH_INVALID:"options.data length is invalid",OPTIONS_NONCEFN_TYPE_INVALID:"options.noncefn should be a Function",RECOVERY_ID_TYPE_INVALID:"recovery should be a Number",RECOVERY_ID_VALUE_INVALID:"recovery should have value between -1 and 4",TWEAK_TYPE_INVALID:"tweak should be a Buffer",TWEAK_LENGTH_INVALID:"tweak length is invalid"}});var sW=D((iLe,aW)=>{"use strict";d();f();var re=tW(),uh=nW(),ee=i2();function ki(r,e){return r===void 0?e:(re.isBoolean(r,ee.COMPRESSED_TYPE_INVALID),r)}aW.exports=function(r){return{privateKeyVerify:function(e){return re.isBuffer(e,ee.EC_PRIVATE_KEY_TYPE_INVALID),e.length===32&&r.privateKeyVerify(e)},privateKeyExport:function(e,t){re.isBuffer(e,ee.EC_PRIVATE_KEY_TYPE_INVALID),re.isBufferLength(e,32,ee.EC_PRIVATE_KEY_LENGTH_INVALID),t=ki(t,!0);var n=r.privateKeyExport(e,t);return uh.privateKeyExport(e,n,t)},privateKeyImport:function(e){if(re.isBuffer(e,ee.EC_PRIVATE_KEY_TYPE_INVALID),e=uh.privateKeyImport(e),e&&e.length===32&&r.privateKeyVerify(e))return e;throw new Error(ee.EC_PRIVATE_KEY_IMPORT_DER_FAIL)},privateKeyNegate:function(e){return re.isBuffer(e,ee.EC_PRIVATE_KEY_TYPE_INVALID),re.isBufferLength(e,32,ee.EC_PRIVATE_KEY_LENGTH_INVALID),r.privateKeyNegate(e)},privateKeyModInverse:function(e){return re.isBuffer(e,ee.EC_PRIVATE_KEY_TYPE_INVALID),re.isBufferLength(e,32,ee.EC_PRIVATE_KEY_LENGTH_INVALID),r.privateKeyModInverse(e)},privateKeyTweakAdd:function(e,t){return re.isBuffer(e,ee.EC_PRIVATE_KEY_TYPE_INVALID),re.isBufferLength(e,32,ee.EC_PRIVATE_KEY_LENGTH_INVALID),re.isBuffer(t,ee.TWEAK_TYPE_INVALID),re.isBufferLength(t,32,ee.TWEAK_LENGTH_INVALID),r.privateKeyTweakAdd(e,t)},privateKeyTweakMul:function(e,t){return re.isBuffer(e,ee.EC_PRIVATE_KEY_TYPE_INVALID),re.isBufferLength(e,32,ee.EC_PRIVATE_KEY_LENGTH_INVALID),re.isBuffer(t,ee.TWEAK_TYPE_INVALID),re.isBufferLength(t,32,ee.TWEAK_LENGTH_INVALID),r.privateKeyTweakMul(e,t)},publicKeyCreate:function(e,t){return re.isBuffer(e,ee.EC_PRIVATE_KEY_TYPE_INVALID),re.isBufferLength(e,32,ee.EC_PRIVATE_KEY_LENGTH_INVALID),t=ki(t,!0),r.publicKeyCreate(e,t)},publicKeyConvert:function(e,t){return re.isBuffer(e,ee.EC_PUBLIC_KEY_TYPE_INVALID),re.isBufferLength2(e,33,65,ee.EC_PUBLIC_KEY_LENGTH_INVALID),t=ki(t,!0),r.publicKeyConvert(e,t)},publicKeyVerify:function(e){return re.isBuffer(e,ee.EC_PUBLIC_KEY_TYPE_INVALID),r.publicKeyVerify(e)},publicKeyTweakAdd:function(e,t,n){return re.isBuffer(e,ee.EC_PUBLIC_KEY_TYPE_INVALID),re.isBufferLength2(e,33,65,ee.EC_PUBLIC_KEY_LENGTH_INVALID),re.isBuffer(t,ee.TWEAK_TYPE_INVALID),re.isBufferLength(t,32,ee.TWEAK_LENGTH_INVALID),n=ki(n,!0),r.publicKeyTweakAdd(e,t,n)},publicKeyTweakMul:function(e,t,n){return re.isBuffer(e,ee.EC_PUBLIC_KEY_TYPE_INVALID),re.isBufferLength2(e,33,65,ee.EC_PUBLIC_KEY_LENGTH_INVALID),re.isBuffer(t,ee.TWEAK_TYPE_INVALID),re.isBufferLength(t,32,ee.TWEAK_LENGTH_INVALID),n=ki(n,!0),r.publicKeyTweakMul(e,t,n)},publicKeyCombine:function(e,t){re.isArray(e,ee.EC_PUBLIC_KEYS_TYPE_INVALID),re.isLengthGTZero(e,ee.EC_PUBLIC_KEYS_LENGTH_INVALID);for(var n=0;n<e.length;++n)re.isBuffer(e[n],ee.EC_PUBLIC_KEY_TYPE_INVALID),re.isBufferLength2(e[n],33,65,ee.EC_PUBLIC_KEY_LENGTH_INVALID);return t=ki(t,!0),r.publicKeyCombine(e,t)},signatureNormalize:function(e){return re.isBuffer(e,ee.ECDSA_SIGNATURE_TYPE_INVALID),re.isBufferLength(e,64,ee.ECDSA_SIGNATURE_LENGTH_INVALID),r.signatureNormalize(e)},signatureExport:function(e){re.isBuffer(e,ee.ECDSA_SIGNATURE_TYPE_INVALID),re.isBufferLength(e,64,ee.ECDSA_SIGNATURE_LENGTH_INVALID);var t=r.signatureExport(e);return uh.signatureExport(t)},signatureImport:function(e){re.isBuffer(e,ee.ECDSA_SIGNATURE_TYPE_INVALID),re.isLengthGTZero(e,ee.ECDSA_SIGNATURE_LENGTH_INVALID);var t=uh.signatureImport(e);if(t)return r.signatureImport(t);throw new Error(ee.ECDSA_SIGNATURE_PARSE_DER_FAIL)},signatureImportLax:function(e){re.isBuffer(e,ee.ECDSA_SIGNATURE_TYPE_INVALID),re.isLengthGTZero(e,ee.ECDSA_SIGNATURE_LENGTH_INVALID);var t=uh.signatureImportLax(e);if(t)return r.signatureImport(t);throw new Error(ee.ECDSA_SIGNATURE_PARSE_DER_FAIL)},sign:function(e,t,n){re.isBuffer(e,ee.MSG32_TYPE_INVALID),re.isBufferLength(e,32,ee.MSG32_LENGTH_INVALID),re.isBuffer(t,ee.EC_PRIVATE_KEY_TYPE_INVALID),re.isBufferLength(t,32,ee.EC_PRIVATE_KEY_LENGTH_INVALID);var a=null,s=null;return n!==void 0&&(re.isObject(n,ee.OPTIONS_TYPE_INVALID),n.data!==void 0&&(re.isBuffer(n.data,ee.OPTIONS_DATA_TYPE_INVALID),re.isBufferLength(n.data,32,ee.OPTIONS_DATA_LENGTH_INVALID),a=n.data),n.noncefn!==void 0&&(re.isFunction(n.noncefn,ee.OPTIONS_NONCEFN_TYPE_INVALID),s=n.noncefn)),r.sign(e,t,s,a)},verify:function(e,t,n){return re.isBuffer(e,ee.MSG32_TYPE_INVALID),re.isBufferLength(e,32,ee.MSG32_LENGTH_INVALID),re.isBuffer(t,ee.ECDSA_SIGNATURE_TYPE_INVALID),re.isBufferLength(t,64,ee.ECDSA_SIGNATURE_LENGTH_INVALID),re.isBuffer(n,ee.EC_PUBLIC_KEY_TYPE_INVALID),re.isBufferLength2(n,33,65,ee.EC_PUBLIC_KEY_LENGTH_INVALID),r.verify(e,t,n)},recover:function(e,t,n,a){return re.isBuffer(e,ee.MSG32_TYPE_INVALID),re.isBufferLength(e,32,ee.MSG32_LENGTH_INVALID),re.isBuffer(t,ee.ECDSA_SIGNATURE_TYPE_INVALID),re.isBufferLength(t,64,ee.ECDSA_SIGNATURE_LENGTH_INVALID),re.isNumber(n,ee.RECOVERY_ID_TYPE_INVALID),re.isNumberInInterval(n,-1,4,ee.RECOVERY_ID_VALUE_INVALID),a=ki(a,!0),r.recover(e,t,n,a)},ecdh:function(e,t){return re.isBuffer(e,ee.EC_PUBLIC_KEY_TYPE_INVALID),re.isBufferLength2(e,33,65,ee.EC_PUBLIC_KEY_LENGTH_INVALID),re.isBuffer(t,ee.EC_PRIVATE_KEY_TYPE_INVALID),re.isBufferLength(t,32,ee.EC_PRIVATE_KEY_LENGTH_INVALID),r.ecdh(e,t)},ecdhUnsafe:function(e,t,n){return re.isBuffer(e,ee.EC_PUBLIC_KEY_TYPE_INVALID),re.isBufferLength2(e,33,65,ee.EC_PUBLIC_KEY_LENGTH_INVALID),re.isBuffer(t,ee.EC_PRIVATE_KEY_TYPE_INVALID),re.isBufferLength(t,32,ee.EC_PRIVATE_KEY_LENGTH_INVALID),n=ki(n,!0),r.ecdhUnsafe(e,t,n)}}}});var iW=D((dLe,Sse)=>{Sse.exports={name:"elliptic",version:"6.5.4",description:"EC cryptography",main:"lib/elliptic.js",files:["lib"],scripts:{lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},repository:{type:"git",url:"git@github.com:indutny/elliptic"},keywords:["EC","Elliptic","curve","Cryptography"],author:"Fedor Indutny <fedor@indutny.com>",license:"MIT",bugs:{url:"https://github.com/indutny/elliptic/issues"},homepage:"https://github.com/indutny/elliptic",devDependencies:{brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},dependencies:{"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"}}});var Wn=D(oW=>{"use strict";d();f();var Ma=oW,_se=mr(),Ase=O4(),ub=D4();Ma.assert=Ase;Ma.toArray=ub.toArray;Ma.zero2=ub.zero2;Ma.toHex=ub.toHex;Ma.encode=ub.encode;function Cse(r,e,t){var n=new Array(Math.max(r.bitLength(),t)+1);n.fill(0);for(var a=1<<e+1,s=r.clone(),i=0;i<n.length;i++){var o,c=s.andln(a-1);s.isOdd()?(c>(a>>1)-1?o=(a>>1)-c:o=c,s.isubn(o)):o=0,n[i]=o,s.iushrn(1)}return n}Ma.getNAF=Cse;function Tse(r,e){var t=[[],[]];r=r.clone(),e=e.clone();for(var n=0,a=0,s;r.cmpn(-n)>0||e.cmpn(-a)>0;){var i=r.andln(3)+n&3,o=e.andln(3)+a&3;i===3&&(i=-1),o===3&&(o=-1);var c;(i&1)===0?c=0:(s=r.andln(7)+n&7,(s===3||s===5)&&o===2?c=-i:c=i),t[0].push(c);var l;(o&1)===0?l=0:(s=e.andln(7)+a&7,(s===3||s===5)&&i===2?l=-o:l=o),t[1].push(l),2*n===c+1&&(n=1-n),2*a===l+1&&(a=1-a),r.iushrn(1),e.iushrn(1)}return t}Ma.getJSF=Tse;function Ise(r,e,t){var n="_"+e;r.prototype[e]=function(){return this[n]!==void 0?this[n]:this[n]=t.call(this)}}Ma.cachedProperty=Ise;function Ese(r){return typeof r=="string"?Ma.toArray(r,"hex"):r}Ma.parseBytes=Ese;function Pse(r){return new _se(r,"hex","le")}Ma.intFromLE=Pse});var ph=D((hLe,cW)=>{"use strict";d();f();var Qo=mr(),hh=Wn(),hb=hh.getNAF,Mse=hh.getJSF,pb=hh.assert;function Oi(r,e){this.type=r,this.p=new Qo(e.p,16),this.red=e.prime?Qo.red(e.prime):Qo.mont(this.p),this.zero=new Qo(0).toRed(this.red),this.one=new Qo(1).toRed(this.red),this.two=new Qo(2).toRed(this.red),this.n=e.n&&new Qo(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var t=this.n&&this.p.div(this.n);!t||t.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}cW.exports=Oi;Oi.prototype.point=function(){throw new Error("Not implemented")};Oi.prototype.validate=function(){throw new Error("Not implemented")};Oi.prototype._fixedNafMul=function(e,t){pb(e.precomputed);var n=e._getDoubles(),a=hb(t,1,this._bitLength),s=(1<<n.step+1)-(n.step%2===0?2:1);s/=3;var i=[],o,c;for(o=0;o<a.length;o+=n.step){c=0;for(var l=o+n.step-1;l>=o;l--)c=(c<<1)+a[l];i.push(c)}for(var u=this.jpoint(null,null,null),h=this.jpoint(null,null,null),b=s;b>0;b--){for(o=0;o<i.length;o++)c=i[o],c===b?h=h.mixedAdd(n.points[o]):c===-b&&(h=h.mixedAdd(n.points[o].neg()));u=u.add(h)}return u.toP()};Oi.prototype._wnafMul=function(e,t){var n=4,a=e._getNAFPoints(n);n=a.wnd;for(var s=a.points,i=hb(t,n,this._bitLength),o=this.jpoint(null,null,null),c=i.length-1;c>=0;c--){for(var l=0;c>=0&&i[c]===0;c--)l++;if(c>=0&&l++,o=o.dblp(l),c<0)break;var u=i[c];pb(u!==0),e.type==="affine"?u>0?o=o.mixedAdd(s[u-1>>1]):o=o.mixedAdd(s[-u-1>>1].neg()):u>0?o=o.add(s[u-1>>1]):o=o.add(s[-u-1>>1].neg())}return e.type==="affine"?o.toP():o};Oi.prototype._wnafMulAdd=function(e,t,n,a,s){var i=this._wnafT1,o=this._wnafT2,c=this._wnafT3,l=0,u,h,b;for(u=0;u<a;u++){b=t[u];var y=b._getNAFPoints(e);i[u]=y.wnd,o[u]=y.points}for(u=a-1;u>=1;u-=2){var v=u-1,S=u;if(i[v]!==1||i[S]!==1){c[v]=hb(n[v],i[v],this._bitLength),c[S]=hb(n[S],i[S],this._bitLength),l=Math.max(c[v].length,l),l=Math.max(c[S].length,l);continue}var R=[t[v],null,null,t[S]];t[v].y.cmp(t[S].y)===0?(R[1]=t[v].add(t[S]),R[2]=t[v].toJ().mixedAdd(t[S].neg())):t[v].y.cmp(t[S].y.redNeg())===0?(R[1]=t[v].toJ().mixedAdd(t[S]),R[2]=t[v].add(t[S].neg())):(R[1]=t[v].toJ().mixedAdd(t[S]),R[2]=t[v].toJ().mixedAdd(t[S].neg()));var P=[-3,-1,-5,-7,0,7,5,1,3],N=Mse(n[v],n[S]);for(l=Math.max(N[0].length,l),c[v]=new Array(l),c[S]=new Array(l),h=0;h<l;h++){var M=N[0][h]|0,L=N[1][h]|0;c[v][h]=P[(M+1)*3+(L+1)],c[S][h]=0,o[v]=R}}var B=this.jpoint(null,null,null),F=this._wnafT4;for(u=l;u>=0;u--){for(var K=0;u>=0;){var H=!0;for(h=0;h<a;h++)F[h]=c[h][u]|0,F[h]!==0&&(H=!1);if(!H)break;K++,u--}if(u>=0&&K++,B=B.dblp(K),u<0)break;for(h=0;h<a;h++){var j=F[h];j!==0&&(j>0?b=o[h][j-1>>1]:j<0&&(b=o[h][-j-1>>1].neg()),b.type==="affine"?B=B.mixedAdd(b):B=B.add(b))}}for(u=0;u<a;u++)o[u]=null;return s?B:B.toP()};function oa(r,e){this.curve=r,this.type=e,this.precomputed=null}Oi.BasePoint=oa;oa.prototype.eq=function(){throw new Error("Not implemented")};oa.prototype.validate=function(){return this.curve.validate(this)};Oi.prototype.decodePoint=function(e,t){e=hh.toArray(e,t);var n=this.p.byteLength();if((e[0]===4||e[0]===6||e[0]===7)&&e.length-1===2*n){e[0]===6?pb(e[e.length-1]%2===0):e[0]===7&&pb(e[e.length-1]%2===1);var a=this.point(e.slice(1,1+n),e.slice(1+n,1+2*n));return a}else if((e[0]===2||e[0]===3)&&e.length-1===n)return this.pointFromX(e.slice(1,1+n),e[0]===3);throw new Error("Unknown point format")};oa.prototype.encodeCompressed=function(e){return this.encode(e,!0)};oa.prototype._encode=function(e){var t=this.curve.p.byteLength(),n=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(n):[4].concat(n,this.getY().toArray("be",t))};oa.prototype.encode=function(e,t){return hh.encode(this._encode(t),e)};oa.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this};oa.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return t?t.points.length>=Math.ceil((e.bitLength()+1)/t.step):!1};oa.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var n=[this],a=this,s=0;s<t;s+=e){for(var i=0;i<e;i++)a=a.dbl();n.push(a)}return{step:e,points:n}};oa.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],n=(1<<e)-1,a=n===1?null:this.dbl(),s=1;s<n;s++)t[s]=t[s-1].add(a);return{wnd:e,points:t}};oa.prototype._getBeta=function(){return null};oa.prototype.dblp=function(e){for(var t=this,n=0;n<e;n++)t=t.dbl();return t}});var fW=D((gLe,dW)=>{"use strict";d();f();var Nse=Wn(),ir=mr(),o2=Tr(),bf=ph(),Rse=Nse.assert;function ca(r){bf.call(this,"short",r),this.a=new ir(r.a,16).toRed(this.red),this.b=new ir(r.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(r),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}o2(ca,bf);dW.exports=ca;ca.prototype._getEndomorphism=function(e){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var t,n;if(e.beta)t=new ir(e.beta,16).toRed(this.red);else{var a=this._getEndoRoots(this.p);t=a[0].cmp(a[1])<0?a[0]:a[1],t=t.toRed(this.red)}if(e.lambda)n=new ir(e.lambda,16);else{var s=this._getEndoRoots(this.n);this.g.mul(s[0]).x.cmp(this.g.x.redMul(t))===0?n=s[0]:(n=s[1],Rse(this.g.mul(n).x.cmp(this.g.x.redMul(t))===0))}var i;return e.basis?i=e.basis.map(function(o){return{a:new ir(o.a,16),b:new ir(o.b,16)}}):i=this._getEndoBasis(n),{beta:t,lambda:n,basis:i}}};ca.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:ir.mont(e),n=new ir(2).toRed(t).redInvm(),a=n.redNeg(),s=new ir(3).toRed(t).redNeg().redSqrt().redMul(n),i=a.redAdd(s).fromRed(),o=a.redSub(s).fromRed();return[i,o]};ca.prototype._getEndoBasis=function(e){for(var t=this.n.ushrn(Math.floor(this.n.bitLength()/2)),n=e,a=this.n.clone(),s=new ir(1),i=new ir(0),o=new ir(0),c=new ir(1),l,u,h,b,y,v,S,R=0,P,N;n.cmpn(0)!==0;){var M=a.div(n);P=a.sub(M.mul(n)),N=o.sub(M.mul(s));var L=c.sub(M.mul(i));if(!h&&P.cmp(t)<0)l=S.neg(),u=s,h=P.neg(),b=N;else if(h&&++R===2)break;S=P,a=n,n=P,o=s,s=N,c=i,i=L}y=P.neg(),v=N;var B=h.sqr().add(b.sqr()),F=y.sqr().add(v.sqr());return F.cmp(B)>=0&&(y=l,v=u),h.negative&&(h=h.neg(),b=b.neg()),y.negative&&(y=y.neg(),v=v.neg()),[{a:h,b},{a:y,b:v}]};ca.prototype._endoSplit=function(e){var t=this.endo.basis,n=t[0],a=t[1],s=a.b.mul(e).divRound(this.n),i=n.b.neg().mul(e).divRound(this.n),o=s.mul(n.a),c=i.mul(a.a),l=s.mul(n.b),u=i.mul(a.b),h=e.sub(o).sub(c),b=l.add(u).neg();return{k1:h,k2:b}};ca.prototype.pointFromX=function(e,t){e=new ir(e,16),e.red||(e=e.toRed(this.red));var n=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),a=n.redSqrt();if(a.redSqr().redSub(n).cmp(this.zero)!==0)throw new Error("invalid point");var s=a.fromRed().isOdd();return(t&&!s||!t&&s)&&(a=a.redNeg()),this.point(e,a)};ca.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,n=e.y,a=this.a.redMul(t),s=t.redSqr().redMul(t).redIAdd(a).redIAdd(this.b);return n.redSqr().redISub(s).cmpn(0)===0};ca.prototype._endoWnafMulAdd=function(e,t,n){for(var a=this._endoWnafT1,s=this._endoWnafT2,i=0;i<e.length;i++){var o=this._endoSplit(t[i]),c=e[i],l=c._getBeta();o.k1.negative&&(o.k1.ineg(),c=c.neg(!0)),o.k2.negative&&(o.k2.ineg(),l=l.neg(!0)),a[i*2]=c,a[i*2+1]=l,s[i*2]=o.k1,s[i*2+1]=o.k2}for(var u=this._wnafMulAdd(1,a,s,i*2,n),h=0;h<i*2;h++)a[h]=null,s[h]=null;return u};function Lr(r,e,t,n){bf.BasePoint.call(this,r,"affine"),e===null&&t===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new ir(e,16),this.y=new ir(t,16),n&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}o2(Lr,bf.BasePoint);ca.prototype.point=function(e,t,n){return new Lr(this,e,t,n)};ca.prototype.pointFromJSON=function(e,t){return Lr.fromJSON(this,e,t)};Lr.prototype._getBeta=function(){if(!!this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var n=this.curve,a=function(s){return n.point(s.x.redMul(n.endo.beta),s.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(a)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(a)}}}return t}};Lr.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};Lr.fromJSON=function(e,t,n){typeof t=="string"&&(t=JSON.parse(t));var a=e.point(t[0],t[1],n);if(!t[2])return a;function s(o){return e.point(o[0],o[1],n)}var i=t[2];return a.precomputed={beta:null,doubles:i.doubles&&{step:i.doubles.step,points:[a].concat(i.doubles.points.map(s))},naf:i.naf&&{wnd:i.naf.wnd,points:[a].concat(i.naf.points.map(s))}},a};Lr.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};Lr.prototype.isInfinity=function(){return this.inf};Lr.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(this.x.cmp(e.x)===0)return this.curve.point(null,null);var t=this.y.redSub(e.y);t.cmpn(0)!==0&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var n=t.redSqr().redISub(this.x).redISub(e.x),a=t.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,a)};Lr.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.cmpn(0)===0)return this.curve.point(null,null);var t=this.curve.a,n=this.x.redSqr(),a=e.redInvm(),s=n.redAdd(n).redIAdd(n).redIAdd(t).redMul(a),i=s.redSqr().redISub(this.x.redAdd(this.x)),o=s.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,o)};Lr.prototype.getX=function(){return this.x.fromRed()};Lr.prototype.getY=function(){return this.y.fromRed()};Lr.prototype.mul=function(e){return e=new ir(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)};Lr.prototype.mulAdd=function(e,t,n){var a=[this,t],s=[e,n];return this.curve.endo?this.curve._endoWnafMulAdd(a,s):this.curve._wnafMulAdd(1,a,s,2)};Lr.prototype.jmulAdd=function(e,t,n){var a=[this,t],s=[e,n];return this.curve.endo?this.curve._endoWnafMulAdd(a,s,!0):this.curve._wnafMulAdd(1,a,s,2,!0)};Lr.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||this.x.cmp(e.x)===0&&this.y.cmp(e.y)===0)};Lr.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var n=this.precomputed,a=function(s){return s.neg()};t.precomputed={naf:n.naf&&{wnd:n.naf.wnd,points:n.naf.points.map(a)},doubles:n.doubles&&{step:n.doubles.step,points:n.doubles.points.map(a)}}}return t};Lr.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var e=this.curve.jpoint(this.x,this.y,this.curve.one);return e};function Xr(r,e,t,n){bf.BasePoint.call(this,r,"jacobian"),e===null&&t===null&&n===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new ir(0)):(this.x=new ir(e,16),this.y=new ir(t,16),this.z=new ir(n,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}o2(Xr,bf.BasePoint);ca.prototype.jpoint=function(e,t,n){return new Xr(this,e,t,n)};Xr.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),n=this.x.redMul(t),a=this.y.redMul(t).redMul(e);return this.curve.point(n,a)};Xr.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};Xr.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),n=this.z.redSqr(),a=this.x.redMul(t),s=e.x.redMul(n),i=this.y.redMul(t.redMul(e.z)),o=e.y.redMul(n.redMul(this.z)),c=a.redSub(s),l=i.redSub(o);if(c.cmpn(0)===0)return l.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var u=c.redSqr(),h=u.redMul(c),b=a.redMul(u),y=l.redSqr().redIAdd(h).redISub(b).redISub(b),v=l.redMul(b.redISub(y)).redISub(i.redMul(h)),S=this.z.redMul(e.z).redMul(c);return this.curve.jpoint(y,v,S)};Xr.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),n=this.x,a=e.x.redMul(t),s=this.y,i=e.y.redMul(t).redMul(this.z),o=n.redSub(a),c=s.redSub(i);if(o.cmpn(0)===0)return c.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var l=o.redSqr(),u=l.redMul(o),h=n.redMul(l),b=c.redSqr().redIAdd(u).redISub(h).redISub(h),y=c.redMul(h.redISub(b)).redISub(s.redMul(u)),v=this.z.redMul(o);return this.curve.jpoint(b,y,v)};Xr.prototype.dblp=function(e){if(e===0)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var t;if(this.curve.zeroA||this.curve.threeA){var n=this;for(t=0;t<e;t++)n=n.dbl();return n}var a=this.curve.a,s=this.curve.tinv,i=this.x,o=this.y,c=this.z,l=c.redSqr().redSqr(),u=o.redAdd(o);for(t=0;t<e;t++){var h=i.redSqr(),b=u.redSqr(),y=b.redSqr(),v=h.redAdd(h).redIAdd(h).redIAdd(a.redMul(l)),S=i.redMul(b),R=v.redSqr().redISub(S.redAdd(S)),P=S.redISub(R),N=v.redMul(P);N=N.redIAdd(N).redISub(y);var M=u.redMul(c);t+1<e&&(l=l.redMul(y)),i=R,c=M,u=N}return this.curve.jpoint(i,u.redMul(s),c)};Xr.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};Xr.prototype._zeroDbl=function(){var e,t,n;if(this.zOne){var a=this.x.redSqr(),s=this.y.redSqr(),i=s.redSqr(),o=this.x.redAdd(s).redSqr().redISub(a).redISub(i);o=o.redIAdd(o);var c=a.redAdd(a).redIAdd(a),l=c.redSqr().redISub(o).redISub(o),u=i.redIAdd(i);u=u.redIAdd(u),u=u.redIAdd(u),e=l,t=c.redMul(o.redISub(l)).redISub(u),n=this.y.redAdd(this.y)}else{var h=this.x.redSqr(),b=this.y.redSqr(),y=b.redSqr(),v=this.x.redAdd(b).redSqr().redISub(h).redISub(y);v=v.redIAdd(v);var S=h.redAdd(h).redIAdd(h),R=S.redSqr(),P=y.redIAdd(y);P=P.redIAdd(P),P=P.redIAdd(P),e=R.redISub(v).redISub(v),t=S.redMul(v.redISub(e)).redISub(P),n=this.y.redMul(this.z),n=n.redIAdd(n)}return this.curve.jpoint(e,t,n)};Xr.prototype._threeDbl=function(){var e,t,n;if(this.zOne){var a=this.x.redSqr(),s=this.y.redSqr(),i=s.redSqr(),o=this.x.redAdd(s).redSqr().redISub(a).redISub(i);o=o.redIAdd(o);var c=a.redAdd(a).redIAdd(a).redIAdd(this.curve.a),l=c.redSqr().redISub(o).redISub(o);e=l;var u=i.redIAdd(i);u=u.redIAdd(u),u=u.redIAdd(u),t=c.redMul(o.redISub(l)).redISub(u),n=this.y.redAdd(this.y)}else{var h=this.z.redSqr(),b=this.y.redSqr(),y=this.x.redMul(b),v=this.x.redSub(h).redMul(this.x.redAdd(h));v=v.redAdd(v).redIAdd(v);var S=y.redIAdd(y);S=S.redIAdd(S);var R=S.redAdd(S);e=v.redSqr().redISub(R),n=this.y.redAdd(this.z).redSqr().redISub(b).redISub(h);var P=b.redSqr();P=P.redIAdd(P),P=P.redIAdd(P),P=P.redIAdd(P),t=v.redMul(S.redISub(e)).redISub(P)}return this.curve.jpoint(e,t,n)};Xr.prototype._dbl=function(){var e=this.curve.a,t=this.x,n=this.y,a=this.z,s=a.redSqr().redSqr(),i=t.redSqr(),o=n.redSqr(),c=i.redAdd(i).redIAdd(i).redIAdd(e.redMul(s)),l=t.redAdd(t);l=l.redIAdd(l);var u=l.redMul(o),h=c.redSqr().redISub(u.redAdd(u)),b=u.redISub(h),y=o.redSqr();y=y.redIAdd(y),y=y.redIAdd(y),y=y.redIAdd(y);var v=c.redMul(b).redISub(y),S=n.redAdd(n).redMul(a);return this.curve.jpoint(h,v,S)};Xr.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),n=this.z.redSqr(),a=t.redSqr(),s=e.redAdd(e).redIAdd(e),i=s.redSqr(),o=this.x.redAdd(t).redSqr().redISub(e).redISub(a);o=o.redIAdd(o),o=o.redAdd(o).redIAdd(o),o=o.redISub(i);var c=o.redSqr(),l=a.redIAdd(a);l=l.redIAdd(l),l=l.redIAdd(l),l=l.redIAdd(l);var u=s.redIAdd(o).redSqr().redISub(i).redISub(c).redISub(l),h=t.redMul(u);h=h.redIAdd(h),h=h.redIAdd(h);var b=this.x.redMul(c).redISub(h);b=b.redIAdd(b),b=b.redIAdd(b);var y=this.y.redMul(u.redMul(l.redISub(u)).redISub(o.redMul(c)));y=y.redIAdd(y),y=y.redIAdd(y),y=y.redIAdd(y);var v=this.z.redAdd(o).redSqr().redISub(n).redISub(c);return this.curve.jpoint(b,y,v)};Xr.prototype.mul=function(e,t){return e=new ir(e,t),this.curve._wnafMul(this,e)};Xr.prototype.eq=function(e){if(e.type==="affine")return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),n=e.z.redSqr();if(this.x.redMul(n).redISub(e.x.redMul(t)).cmpn(0)!==0)return!1;var a=t.redMul(this.z),s=n.redMul(e.z);return this.y.redMul(s).redISub(e.y.redMul(a)).cmpn(0)===0};Xr.prototype.eqXToP=function(e){var t=this.z.redSqr(),n=e.toRed(this.curve.red).redMul(t);if(this.x.cmp(n)===0)return!0;for(var a=e.clone(),s=this.curve.redN.redMul(t);;){if(a.iadd(this.curve.n),a.cmp(this.curve.p)>=0)return!1;if(n.redIAdd(s),this.x.cmp(n)===0)return!0}};Xr.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};Xr.prototype.isInfinity=function(){return this.z.cmpn(0)===0}});var hW=D((xLe,uW)=>{"use strict";d();f();var yf=mr(),lW=Tr(),mb=ph(),kse=Wn();function xf(r){mb.call(this,"mont",r),this.a=new yf(r.a,16).toRed(this.red),this.b=new yf(r.b,16).toRed(this.red),this.i4=new yf(4).toRed(this.red).redInvm(),this.two=new yf(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}lW(xf,mb);uW.exports=xf;xf.prototype.validate=function(e){var t=e.normalize().x,n=t.redSqr(),a=n.redMul(t).redAdd(n.redMul(this.a)).redAdd(t),s=a.redSqrt();return s.redSqr().cmp(a)===0};function Br(r,e,t){mb.BasePoint.call(this,r,"projective"),e===null&&t===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new yf(e,16),this.z=new yf(t,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}lW(Br,mb.BasePoint);xf.prototype.decodePoint=function(e,t){return this.point(kse.toArray(e,t),1)};xf.prototype.point=function(e,t){return new Br(this,e,t)};xf.prototype.pointFromJSON=function(e){return Br.fromJSON(this,e)};Br.prototype.precompute=function(){};Br.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())};Br.fromJSON=function(e,t){return new Br(e,t[0],t[1]||e.one)};Br.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};Br.prototype.isInfinity=function(){return this.z.cmpn(0)===0};Br.prototype.dbl=function(){var e=this.x.redAdd(this.z),t=e.redSqr(),n=this.x.redSub(this.z),a=n.redSqr(),s=t.redSub(a),i=t.redMul(a),o=s.redMul(a.redAdd(this.curve.a24.redMul(s)));return this.curve.point(i,o)};Br.prototype.add=function(){throw new Error("Not supported on Montgomery curve")};Br.prototype.diffAdd=function(e,t){var n=this.x.redAdd(this.z),a=this.x.redSub(this.z),s=e.x.redAdd(e.z),i=e.x.redSub(e.z),o=i.redMul(n),c=s.redMul(a),l=t.z.redMul(o.redAdd(c).redSqr()),u=t.x.redMul(o.redISub(c).redSqr());return this.curve.point(l,u)};Br.prototype.mul=function(e){for(var t=e.clone(),n=this,a=this.curve.point(null,null),s=this,i=[];t.cmpn(0)!==0;t.iushrn(1))i.push(t.andln(1));for(var o=i.length-1;o>=0;o--)i[o]===0?(n=n.diffAdd(a,s),a=a.dbl()):(a=n.diffAdd(a,s),n=n.dbl());return a};Br.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")};Br.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")};Br.prototype.eq=function(e){return this.getX().cmp(e.getX())===0};Br.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this};Br.prototype.getX=function(){return this.normalize(),this.x.fromRed()}});var gW=D((SLe,mW)=>{"use strict";d();f();var Ose=Wn(),Ls=mr(),pW=Tr(),gb=ph(),Dse=Ose.assert;function Xa(r){this.twisted=(r.a|0)!==1,this.mOneA=this.twisted&&(r.a|0)===-1,this.extended=this.mOneA,gb.call(this,"edwards",r),this.a=new Ls(r.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new Ls(r.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new Ls(r.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),Dse(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(r.c|0)===1}pW(Xa,gb);mW.exports=Xa;Xa.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)};Xa.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)};Xa.prototype.jpoint=function(e,t,n,a){return this.point(e,t,n,a)};Xa.prototype.pointFromX=function(e,t){e=new Ls(e,16),e.red||(e=e.toRed(this.red));var n=e.redSqr(),a=this.c2.redSub(this.a.redMul(n)),s=this.one.redSub(this.c2.redMul(this.d).redMul(n)),i=a.redMul(s.redInvm()),o=i.redSqrt();if(o.redSqr().redSub(i).cmp(this.zero)!==0)throw new Error("invalid point");var c=o.fromRed().isOdd();return(t&&!c||!t&&c)&&(o=o.redNeg()),this.point(e,o)};Xa.prototype.pointFromY=function(e,t){e=new Ls(e,16),e.red||(e=e.toRed(this.red));var n=e.redSqr(),a=n.redSub(this.c2),s=n.redMul(this.d).redMul(this.c2).redSub(this.a),i=a.redMul(s.redInvm());if(i.cmp(this.zero)===0){if(t)throw new Error("invalid point");return this.point(this.zero,e)}var o=i.redSqrt();if(o.redSqr().redSub(i).cmp(this.zero)!==0)throw new Error("invalid point");return o.fromRed().isOdd()!==t&&(o=o.redNeg()),this.point(o,e)};Xa.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var t=e.x.redSqr(),n=e.y.redSqr(),a=t.redMul(this.a).redAdd(n),s=this.c2.redMul(this.one.redAdd(this.d.redMul(t).redMul(n)));return a.cmp(s)===0};function ct(r,e,t,n,a){gb.BasePoint.call(this,r,"projective"),e===null&&t===null&&n===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new Ls(e,16),this.y=new Ls(t,16),this.z=n?new Ls(n,16):this.curve.one,this.t=a&&new Ls(a,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}pW(ct,gb.BasePoint);Xa.prototype.pointFromJSON=function(e){return ct.fromJSON(this,e)};Xa.prototype.point=function(e,t,n,a){return new ct(this,e,t,n,a)};ct.fromJSON=function(e,t){return new ct(e,t[0],t[1],t[2])};ct.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};ct.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)};ct.prototype._extDbl=function(){var e=this.x.redSqr(),t=this.y.redSqr(),n=this.z.redSqr();n=n.redIAdd(n);var a=this.curve._mulA(e),s=this.x.redAdd(this.y).redSqr().redISub(e).redISub(t),i=a.redAdd(t),o=i.redSub(n),c=a.redSub(t),l=s.redMul(o),u=i.redMul(c),h=s.redMul(c),b=o.redMul(i);return this.curve.point(l,u,b,h)};ct.prototype._projDbl=function(){var e=this.x.redAdd(this.y).redSqr(),t=this.x.redSqr(),n=this.y.redSqr(),a,s,i,o,c,l;if(this.curve.twisted){o=this.curve._mulA(t);var u=o.redAdd(n);this.zOne?(a=e.redSub(t).redSub(n).redMul(u.redSub(this.curve.two)),s=u.redMul(o.redSub(n)),i=u.redSqr().redSub(u).redSub(u)):(c=this.z.redSqr(),l=u.redSub(c).redISub(c),a=e.redSub(t).redISub(n).redMul(l),s=u.redMul(o.redSub(n)),i=u.redMul(l))}else o=t.redAdd(n),c=this.curve._mulC(this.z).redSqr(),l=o.redSub(c).redSub(c),a=this.curve._mulC(e.redISub(o)).redMul(l),s=this.curve._mulC(o).redMul(t.redISub(n)),i=o.redMul(l);return this.curve.point(a,s,i)};ct.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()};ct.prototype._extAdd=function(e){var t=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),n=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),a=this.t.redMul(this.curve.dd).redMul(e.t),s=this.z.redMul(e.z.redAdd(e.z)),i=n.redSub(t),o=s.redSub(a),c=s.redAdd(a),l=n.redAdd(t),u=i.redMul(o),h=c.redMul(l),b=i.redMul(l),y=o.redMul(c);return this.curve.point(u,h,y,b)};ct.prototype._projAdd=function(e){var t=this.z.redMul(e.z),n=t.redSqr(),a=this.x.redMul(e.x),s=this.y.redMul(e.y),i=this.curve.d.redMul(a).redMul(s),o=n.redSub(i),c=n.redAdd(i),l=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(a).redISub(s),u=t.redMul(o).redMul(l),h,b;return this.curve.twisted?(h=t.redMul(c).redMul(s.redSub(this.curve._mulA(a))),b=o.redMul(c)):(h=t.redMul(c).redMul(s.redSub(a)),b=this.curve._mulC(o).redMul(c)),this.curve.point(u,h,b)};ct.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)};ct.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)};ct.prototype.mulAdd=function(e,t,n){return this.curve._wnafMulAdd(1,[this,t],[e,n],2,!1)};ct.prototype.jmulAdd=function(e,t,n){return this.curve._wnafMulAdd(1,[this,t],[e,n],2,!0)};ct.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this};ct.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())};ct.prototype.getX=function(){return this.normalize(),this.x.fromRed()};ct.prototype.getY=function(){return this.normalize(),this.y.fromRed()};ct.prototype.eq=function(e){return this===e||this.getX().cmp(e.getX())===0&&this.getY().cmp(e.getY())===0};ct.prototype.eqXToP=function(e){var t=e.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(t)===0)return!0;for(var n=e.clone(),a=this.curve.redN.redMul(this.z);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(t.redIAdd(a),this.x.cmp(t)===0)return!0}};ct.prototype.toP=ct.prototype.normalize;ct.prototype.mixedAdd=ct.prototype.add});var c2=D(bW=>{"use strict";d();f();var bb=bW;bb.base=ph();bb.short=fW();bb.mont=hW();bb.edwards=gW()});var xW=D((ELe,yW)=>{d();f();yW.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}});var yb=D(SW=>{"use strict";d();f();var f2=SW,Di=Kp(),d2=c2(),Lse=Wn(),wW=Lse.assert;function vW(r){r.type==="short"?this.curve=new d2.short(r):r.type==="edwards"?this.curve=new d2.edwards(r):this.curve=new d2.mont(r),this.g=this.curve.g,this.n=this.curve.n,this.hash=r.hash,wW(this.g.validate(),"Invalid curve"),wW(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}f2.PresetCurve=vW;function Li(r,e){Object.defineProperty(f2,r,{configurable:!0,enumerable:!0,get:function(){var t=new vW(e);return Object.defineProperty(f2,r,{configurable:!0,enumerable:!0,value:t}),t}})}Li("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:Di.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]});Li("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:Di.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]});Li("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:Di.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]});Li("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:Di.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]});Li("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:Di.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]});Li("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:Di.sha256,gRed:!1,g:["9"]});Li("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:Di.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var l2;try{l2=xW()}catch{l2=void 0}Li("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:Di.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",l2]})});var AW=D((OLe,_W)=>{"use strict";d();f();var Bse=mr(),Wse=Wn(),u2=Wse.assert;function dn(r,e){this.ec=r,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}_W.exports=dn;dn.fromPublic=function(e,t,n){return t instanceof dn?t:new dn(e,{pub:t,pubEnc:n})};dn.fromPrivate=function(e,t,n){return t instanceof dn?t:new dn(e,{priv:t,privEnc:n})};dn.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};dn.prototype.getPublic=function(e,t){return typeof e=="string"&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,e):this.pub};dn.prototype.getPrivate=function(e){return e==="hex"?this.priv.toString(16,2):this.priv};dn.prototype._importPrivate=function(e,t){this.priv=new Bse(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)};dn.prototype._importPublic=function(e,t){if(e.x||e.y){this.ec.curve.type==="mont"?u2(e.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&u2(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,t)};dn.prototype.derive=function(e){return e.validate()||u2(e.validate(),"public point not validated"),e.mul(this.priv).getX()};dn.prototype.sign=function(e,t,n){return this.ec.sign(e,this,t,n)};dn.prototype.verify=function(e,t){return this.ec.verify(e,t,this)};dn.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}});var IW=D((BLe,TW)=>{"use strict";d();f();var xb=mr(),m2=Wn(),Kse=m2.assert;function wb(r,e){if(r instanceof wb)return r;this._importDER(r,e)||(Kse(r.r&&r.s,"Signature without r or s"),this.r=new xb(r.r,16),this.s=new xb(r.s,16),r.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=r.recoveryParam)}TW.exports=wb;function qse(){this.place=0}function h2(r,e){var t=r[e.place++];if(!(t&128))return t;var n=t&15;if(n===0||n>4)return!1;for(var a=0,s=0,i=e.place;s<n;s++,i++)a<<=8,a|=r[i],a>>>=0;return a<=127?!1:(e.place=i,a)}function CW(r){for(var e=0,t=r.length-1;!r[e]&&!(r[e+1]&128)&&e<t;)e++;return e===0?r:r.slice(e)}wb.prototype._importDER=function(e,t){e=m2.toArray(e,t);var n=new qse;if(e[n.place++]!==48)return!1;var a=h2(e,n);if(a===!1||a+n.place!==e.length||e[n.place++]!==2)return!1;var s=h2(e,n);if(s===!1)return!1;var i=e.slice(n.place,s+n.place);if(n.place+=s,e[n.place++]!==2)return!1;var o=h2(e,n);if(o===!1||e.length!==o+n.place)return!1;var c=e.slice(n.place,o+n.place);if(i[0]===0)if(i[1]&128)i=i.slice(1);else return!1;if(c[0]===0)if(c[1]&128)c=c.slice(1);else return!1;return this.r=new xb(i),this.s=new xb(c),this.recoveryParam=null,!0};function p2(r,e){if(e<128){r.push(e);return}var t=1+(Math.log(e)/Math.LN2>>>3);for(r.push(t|128);--t;)r.push(e>>>(t<<3)&255);r.push(e)}wb.prototype.toDER=function(e){var t=this.r.toArray(),n=this.s.toArray();for(t[0]&128&&(t=[0].concat(t)),n[0]&128&&(n=[0].concat(n)),t=CW(t),n=CW(n);!n[0]&&!(n[1]&128);)n=n.slice(1);var a=[2];p2(a,t.length),a=a.concat(t),a.push(2),p2(a,n.length);var s=a.concat(n),i=[48];return p2(i,s.length),i=i.concat(s),m2.encode(i,e)}});var NW=D((qLe,MW)=>{"use strict";d();f();var ec=mr(),EW=L4(),Use=Wn(),g2=yb(),Fse=Wp(),PW=Use.assert,b2=AW(),vb=IW();function da(r){if(!(this instanceof da))return new da(r);typeof r=="string"&&(PW(Object.prototype.hasOwnProperty.call(g2,r),"Unknown curve "+r),r=g2[r]),r instanceof g2.PresetCurve&&(r={curve:r}),this.curve=r.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=r.curve.g,this.g.precompute(r.curve.n.bitLength()+1),this.hash=r.hash||r.curve.hash}MW.exports=da;da.prototype.keyPair=function(e){return new b2(this,e)};da.prototype.keyFromPrivate=function(e,t){return b2.fromPrivate(this,e,t)};da.prototype.keyFromPublic=function(e,t){return b2.fromPublic(this,e,t)};da.prototype.genKeyPair=function(e){e||(e={});for(var t=new EW({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||Fse(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),n=this.n.byteLength(),a=this.n.sub(new ec(2));;){var s=new ec(t.generate(n));if(!(s.cmp(a)>0))return s.iaddn(1),this.keyFromPrivate(s)}};da.prototype._truncateToN=function(e,t){var n=e.byteLength()*8-this.n.bitLength();return n>0&&(e=e.ushrn(n)),!t&&e.cmp(this.n)>=0?e.sub(this.n):e};da.prototype.sign=function(e,t,n,a){typeof n=="object"&&(a=n,n=null),a||(a={}),t=this.keyFromPrivate(t,n),e=this._truncateToN(new ec(e,16));for(var s=this.n.byteLength(),i=t.getPrivate().toArray("be",s),o=e.toArray("be",s),c=new EW({hash:this.hash,entropy:i,nonce:o,pers:a.pers,persEnc:a.persEnc||"utf8"}),l=this.n.sub(new ec(1)),u=0;;u++){var h=a.k?a.k(u):new ec(c.generate(this.n.byteLength()));if(h=this._truncateToN(h,!0),!(h.cmpn(1)<=0||h.cmp(l)>=0)){var b=this.g.mul(h);if(!b.isInfinity()){var y=b.getX(),v=y.umod(this.n);if(v.cmpn(0)!==0){var S=h.invm(this.n).mul(v.mul(t.getPrivate()).iadd(e));if(S=S.umod(this.n),S.cmpn(0)!==0){var R=(b.getY().isOdd()?1:0)|(y.cmp(v)!==0?2:0);return a.canonical&&S.cmp(this.nh)>0&&(S=this.n.sub(S),R^=1),new vb({r:v,s:S,recoveryParam:R})}}}}}};da.prototype.verify=function(e,t,n,a){e=this._truncateToN(new ec(e,16)),n=this.keyFromPublic(n,a),t=new vb(t,"hex");var s=t.r,i=t.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0||i.cmpn(1)<0||i.cmp(this.n)>=0)return!1;var o=i.invm(this.n),c=o.mul(e).umod(this.n),l=o.mul(s).umod(this.n),u;return this.curve._maxwellTrick?(u=this.g.jmulAdd(c,n.getPublic(),l),u.isInfinity()?!1:u.eqXToP(s)):(u=this.g.mulAdd(c,n.getPublic(),l),u.isInfinity()?!1:u.getX().umod(this.n).cmp(s)===0)};da.prototype.recoverPubKey=function(r,e,t,n){PW((3&t)===t,"The recovery param is more than two bits"),e=new vb(e,n);var a=this.n,s=new ec(r),i=e.r,o=e.s,c=t&1,l=t>>1;if(i.cmp(this.curve.p.umod(this.curve.n))>=0&&l)throw new Error("Unable to find sencond key candinate");l?i=this.curve.pointFromX(i.add(this.curve.n),c):i=this.curve.pointFromX(i,c);var u=e.r.invm(a),h=a.sub(s).mul(u).umod(a),b=o.mul(u).umod(a);return this.g.mulAdd(h,i,b)};da.prototype.getKeyRecoveryParam=function(r,e,t,n){if(e=new vb(e,n),e.recoveryParam!==null)return e.recoveryParam;for(var a=0;a<4;a++){var s;try{s=this.recoverPubKey(r,e,a)}catch{continue}if(s.eq(t))return a}throw new Error("Unable to find valid recovery factor")}});var DW=D((HLe,OW)=>{"use strict";d();f();var mh=Wn(),kW=mh.assert,RW=mh.parseBytes,wf=mh.cachedProperty;function Wr(r,e){this.eddsa=r,this._secret=RW(e.secret),r.isPoint(e.pub)?this._pub=e.pub:this._pubBytes=RW(e.pub)}Wr.fromPublic=function(e,t){return t instanceof Wr?t:new Wr(e,{pub:t})};Wr.fromSecret=function(e,t){return t instanceof Wr?t:new Wr(e,{secret:t})};Wr.prototype.secret=function(){return this._secret};wf(Wr,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())});wf(Wr,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())});wf(Wr,"privBytes",function(){var e=this.eddsa,t=this.hash(),n=e.encodingLength-1,a=t.slice(0,e.encodingLength);return a[0]&=248,a[n]&=127,a[n]|=64,a});wf(Wr,"priv",function(){return this.eddsa.decodeInt(this.privBytes())});wf(Wr,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()});wf(Wr,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)});Wr.prototype.sign=function(e){return kW(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)};Wr.prototype.verify=function(e,t){return this.eddsa.verify(e,t,this)};Wr.prototype.getSecret=function(e){return kW(this._secret,"KeyPair is public only"),mh.encode(this.secret(),e)};Wr.prototype.getPublic=function(e){return mh.encode(this.pubBytes(),e)};OW.exports=Wr});var BW=D((jLe,LW)=>{"use strict";d();f();var Hse=mr(),Sb=Wn(),Gse=Sb.assert,_b=Sb.cachedProperty,zse=Sb.parseBytes;function tc(r,e){this.eddsa=r,typeof e!="object"&&(e=zse(e)),Array.isArray(e)&&(e={R:e.slice(0,r.encodingLength),S:e.slice(r.encodingLength)}),Gse(e.R&&e.S,"Signature without R or S"),r.isPoint(e.R)&&(this._R=e.R),e.S instanceof Hse&&(this._S=e.S),this._Rencoded=Array.isArray(e.R)?e.R:e.Rencoded,this._Sencoded=Array.isArray(e.S)?e.S:e.Sencoded}_b(tc,"S",function(){return this.eddsa.decodeInt(this.Sencoded())});_b(tc,"R",function(){return this.eddsa.decodePoint(this.Rencoded())});_b(tc,"Rencoded",function(){return this.eddsa.encodePoint(this.R())});_b(tc,"Sencoded",function(){return this.eddsa.encodeInt(this.S())});tc.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())};tc.prototype.toHex=function(){return Sb.encode(this.toBytes(),"hex").toUpperCase()};LW.exports=tc});var FW=D((YLe,UW)=>{"use strict";d();f();var jse=Kp(),Vse=yb(),vf=Wn(),$se=vf.assert,KW=vf.parseBytes,qW=DW(),WW=BW();function _n(r){if($se(r==="ed25519","only tested with ed25519 so far"),!(this instanceof _n))return new _n(r);r=Vse[r].curve,this.curve=r,this.g=r.g,this.g.precompute(r.n.bitLength()+1),this.pointClass=r.point().constructor,this.encodingLength=Math.ceil(r.n.bitLength()/8),this.hash=jse.sha512}UW.exports=_n;_n.prototype.sign=function(e,t){e=KW(e);var n=this.keyFromSecret(t),a=this.hashInt(n.messagePrefix(),e),s=this.g.mul(a),i=this.encodePoint(s),o=this.hashInt(i,n.pubBytes(),e).mul(n.priv()),c=a.add(o).umod(this.curve.n);return this.makeSignature({R:s,S:c,Rencoded:i})};_n.prototype.verify=function(e,t,n){e=KW(e),t=this.makeSignature(t);var a=this.keyFromPublic(n),s=this.hashInt(t.Rencoded(),a.pubBytes(),e),i=this.g.mul(t.S()),o=t.R().add(a.pub().mul(s));return o.eq(i)};_n.prototype.hashInt=function(){for(var e=this.hash(),t=0;t<arguments.length;t++)e.update(arguments[t]);return vf.intFromLE(e.digest()).umod(this.curve.n)};_n.prototype.keyFromPublic=function(e){return qW.fromPublic(this,e)};_n.prototype.keyFromSecret=function(e){return qW.fromSecret(this,e)};_n.prototype.makeSignature=function(e){return e instanceof WW?e:new WW(this,e)};_n.prototype.encodePoint=function(e){var t=e.getY().toArray("le",this.encodingLength);return t[this.encodingLength-1]|=e.getX().isOdd()?128:0,t};_n.prototype.decodePoint=function(e){e=vf.parseBytes(e);var t=e.length-1,n=e.slice(0,t).concat(e[t]&-129),a=(e[t]&128)!==0,s=vf.intFromLE(n);return this.curve.pointFromY(s,a)};_n.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)};_n.prototype.decodeInt=function(e){return vf.intFromLE(e)};_n.prototype.isPoint=function(e){return e instanceof this.pointClass}});var GW=D(HW=>{"use strict";d();f();var rc=HW;rc.version=iW().version;rc.utils=Wn();rc.rand=Wp();rc.curve=c2();rc.curves=yb();rc.ec=NW();rc.eddsa=FW()});var zW=D(cr=>{"use strict";d();f();var or=ho().Buffer,Yse=wx(),Je=mr(),Jse=GW().ec,qt=i2(),Za=new Jse("secp256k1"),Ie=Za.curve;function Xse(r,e){var t=new Je(e);if(t.cmp(Ie.p)>=0)return null;t=t.toRed(Ie.red);var n=t.redSqr().redIMul(t).redIAdd(Ie.b).redSqrt();return r===3!==n.isOdd()&&(n=n.redNeg()),Za.keyPair({pub:{x:t,y:n}})}function Zse(r,e,t){var n=new Je(e),a=new Je(t);if(n.cmp(Ie.p)>=0||a.cmp(Ie.p)>=0||(n=n.toRed(Ie.red),a=a.toRed(Ie.red),(r===6||r===7)&&a.isOdd()!==(r===7)))return null;var s=n.redSqr().redIMul(n);return a.redSqr().redISub(s.redIAdd(Ie.b)).isZero()?Za.keyPair({pub:{x:n,y:a}}):null}function nc(r){var e=r[0];switch(e){case 2:case 3:return r.length!==33?null:Xse(e,r.slice(1,33));case 4:case 6:case 7:return r.length!==65?null:Zse(e,r.slice(1,33),r.slice(33,65));default:return null}}cr.privateKeyVerify=function(r){var e=new Je(r);return e.cmp(Ie.n)<0&&!e.isZero()};cr.privateKeyExport=function(r,e){var t=new Je(r);if(t.cmp(Ie.n)>=0||t.isZero())throw new Error(qt.EC_PRIVATE_KEY_EXPORT_DER_FAIL);return or.from(Za.keyFromPrivate(r).getPublic(e,!0))};cr.privateKeyNegate=function(r){var e=new Je(r);return e.isZero()?or.alloc(32):Ie.n.sub(e).umod(Ie.n).toArrayLike(or,"be",32)};cr.privateKeyModInverse=function(r){var e=new Je(r);if(e.cmp(Ie.n)>=0||e.isZero())throw new Error(qt.EC_PRIVATE_KEY_RANGE_INVALID);return e.invm(Ie.n).toArrayLike(or,"be",32)};cr.privateKeyTweakAdd=function(r,e){var t=new Je(e);if(t.cmp(Ie.n)>=0)throw new Error(qt.EC_PRIVATE_KEY_TWEAK_ADD_FAIL);if(t.iadd(new Je(r)),t.cmp(Ie.n)>=0&&t.isub(Ie.n),t.isZero())throw new Error(qt.EC_PRIVATE_KEY_TWEAK_ADD_FAIL);return t.toArrayLike(or,"be",32)};cr.privateKeyTweakMul=function(r,e){var t=new Je(e);if(t.cmp(Ie.n)>=0||t.isZero())throw new Error(qt.EC_PRIVATE_KEY_TWEAK_MUL_FAIL);return t.imul(new Je(r)),t.cmp(Ie.n)&&(t=t.umod(Ie.n)),t.toArrayLike(or,"be",32)};cr.publicKeyCreate=function(r,e){var t=new Je(r);if(t.cmp(Ie.n)>=0||t.isZero())throw new Error(qt.EC_PUBLIC_KEY_CREATE_FAIL);return or.from(Za.keyFromPrivate(r).getPublic(e,!0))};cr.publicKeyConvert=function(r,e){var t=nc(r);if(t===null)throw new Error(qt.EC_PUBLIC_KEY_PARSE_FAIL);return or.from(t.getPublic(e,!0))};cr.publicKeyVerify=function(r){return nc(r)!==null};cr.publicKeyTweakAdd=function(r,e,t){var n=nc(r);if(n===null)throw new Error(qt.EC_PUBLIC_KEY_PARSE_FAIL);if(e=new Je(e),e.cmp(Ie.n)>=0)throw new Error(qt.EC_PUBLIC_KEY_TWEAK_ADD_FAIL);var a=Ie.g.mul(e).add(n.pub);if(a.isInfinity())throw new Error(qt.EC_PUBLIC_KEY_TWEAK_ADD_FAIL);return or.from(a.encode(!0,t))};cr.publicKeyTweakMul=function(r,e,t){var n=nc(r);if(n===null)throw new Error(qt.EC_PUBLIC_KEY_PARSE_FAIL);if(e=new Je(e),e.cmp(Ie.n)>=0||e.isZero())throw new Error(qt.EC_PUBLIC_KEY_TWEAK_MUL_FAIL);return or.from(n.pub.mul(e).encode(!0,t))};cr.publicKeyCombine=function(r,e){for(var t=new Array(r.length),n=0;n<r.length;++n)if(t[n]=nc(r[n]),t[n]===null)throw new Error(qt.EC_PUBLIC_KEY_PARSE_FAIL);for(var a=t[0].pub,s=1;s<t.length;++s)a=a.add(t[s].pub);if(a.isInfinity())throw new Error(qt.EC_PUBLIC_KEY_COMBINE_FAIL);return or.from(a.encode(!0,e))};cr.signatureNormalize=function(r){var e=new Je(r.slice(0,32)),t=new Je(r.slice(32,64));if(e.cmp(Ie.n)>=0||t.cmp(Ie.n)>=0)throw new Error(qt.ECDSA_SIGNATURE_PARSE_FAIL);var n=or.from(r);return t.cmp(Za.nh)===1&&Ie.n.sub(t).toArrayLike(or,"be",32).copy(n,32),n};cr.signatureExport=function(r){var e=r.slice(0,32),t=r.slice(32,64);if(new Je(e).cmp(Ie.n)>=0||new Je(t).cmp(Ie.n)>=0)throw new Error(qt.ECDSA_SIGNATURE_PARSE_FAIL);return{r:e,s:t}};cr.signatureImport=function(r){var e=new Je(r.r);e.cmp(Ie.n)>=0&&(e=new Je(0));var t=new Je(r.s);return t.cmp(Ie.n)>=0&&(t=new Je(0)),or.concat([e.toArrayLike(or,"be",32),t.toArrayLike(or,"be",32)])};cr.sign=function(r,e,t,n){if(typeof t=="function"){var a=t;t=function(o){var c=a(r,e,null,n,o);if(!or.isBuffer(c)||c.length!==32)throw new Error(qt.ECDSA_SIGN_FAIL);return new Je(c)}}var s=new Je(e);if(s.cmp(Ie.n)>=0||s.isZero())throw new Error(qt.ECDSA_SIGN_FAIL);var i=Za.sign(r,e,{canonical:!0,k:t,pers:n});return{signature:or.concat([i.r.toArrayLike(or,"be",32),i.s.toArrayLike(or,"be",32)]),recovery:i.recoveryParam}};cr.verify=function(r,e,t){var n={r:e.slice(0,32),s:e.slice(32,64)},a=new Je(n.r),s=new Je(n.s);if(a.cmp(Ie.n)>=0||s.cmp(Ie.n)>=0)throw new Error(qt.ECDSA_SIGNATURE_PARSE_FAIL);if(s.cmp(Za.nh)===1||a.isZero()||s.isZero())return!1;var i=nc(t);if(i===null)throw new Error(qt.EC_PUBLIC_KEY_PARSE_FAIL);return Za.verify(r,n,{x:i.pub.x,y:i.pub.y})};cr.recover=function(r,e,t,n){var a={r:e.slice(0,32),s:e.slice(32,64)},s=new Je(a.r),i=new Je(a.s);if(s.cmp(Ie.n)>=0||i.cmp(Ie.n)>=0)throw new Error(qt.ECDSA_SIGNATURE_PARSE_FAIL);try{if(s.isZero()||i.isZero())throw new Error;var o=Za.recoverPubKey(r,a,t);return or.from(o.encode(!0,n))}catch{throw new Error(qt.ECDSA_RECOVER_FAIL)}};cr.ecdh=function(r,e){var t=cr.ecdhUnsafe(r,e,!0);return Yse("sha256").update(t).digest()};cr.ecdhUnsafe=function(r,e,t){var n=nc(r);if(n===null)throw new Error(qt.EC_PUBLIC_KEY_PARSE_FAIL);var a=new Je(e);if(a.cmp(Ie.n)>=0||a.isZero())throw new Error(qt.ECDH_FAIL);return or.from(n.pub.mul(a).encode(!0,t))}});var VW=D((aBe,jW)=>{"use strict";d();f();jW.exports=sW()(zW())});var YW=D(G=>{"use strict";d();f();var Qse=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},eie=eW(),Qa=VW(),y2=El(),Ab=Pl(),fa=mr(),$W=wx(),dr=ho().Buffer;Object.assign(G,Hc());G.MAX_INTEGER=new fa("ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",16);G.TWO_POW256=new fa("10000000000000000000000000000000000000000000000000000000000000000",16);G.KECCAK256_NULL_S="c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470";G.SHA3_NULL_S=G.KECCAK256_NULL_S;G.KECCAK256_NULL=dr.from(G.KECCAK256_NULL_S,"hex");G.SHA3_NULL=G.KECCAK256_NULL;G.KECCAK256_RLP_ARRAY_S="1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347";G.SHA3_RLP_ARRAY_S=G.KECCAK256_RLP_ARRAY_S;G.KECCAK256_RLP_ARRAY=dr.from(G.KECCAK256_RLP_ARRAY_S,"hex");G.SHA3_RLP_ARRAY=G.KECCAK256_RLP_ARRAY;G.KECCAK256_RLP_S="56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421";G.SHA3_RLP_S=G.KECCAK256_RLP_S;G.KECCAK256_RLP=dr.from(G.KECCAK256_RLP_S,"hex");G.SHA3_RLP=G.KECCAK256_RLP;G.BN=fa;G.rlp=Ab;G.secp256k1=Qa;G.zeros=function(r){return dr.allocUnsafe(r).fill(0)};G.zeroAddress=function(){var r=20,e=G.zeros(r);return G.bufferToHex(e)};G.setLengthLeft=G.setLength=function(r,e,t){var n=G.zeros(e);return r=G.toBuffer(r),t?r.length<e?(r.copy(n),n):r.slice(0,e):r.length<e?(r.copy(n,e-r.length),n):r.slice(-e)};G.setLengthRight=function(r,e){return G.setLength(r,e,!0)};G.unpad=G.stripZeros=function(r){r=G.stripHexPrefix(r);for(var e=r[0];r.length>0&&e.toString()==="0";)r=r.slice(1),e=r[0];return r};G.toBuffer=function(r){if(!dr.isBuffer(r))if(Array.isArray(r))r=dr.from(r);else if(typeof r=="string")G.isHexString(r)?r=dr.from(G.padToEven(G.stripHexPrefix(r)),"hex"):r=dr.from(r);else if(typeof r=="number")r=G.intToBuffer(r);else if(r==null)r=dr.allocUnsafe(0);else if(fa.isBN(r))r=r.toArrayLike(dr);else if(r.toArray)r=dr.from(r.toArray());else throw new Error("invalid type");return r};G.bufferToInt=function(r){return new fa(G.toBuffer(r)).toNumber()};G.bufferToHex=function(r){return r=G.toBuffer(r),"0x"+r.toString("hex")};G.fromSigned=function(r){return new fa(r).fromTwos(256)};G.toUnsigned=function(r){return dr.from(r.toTwos(256).toArray())};G.keccak=function(r,e){return r=G.toBuffer(r),e||(e=256),eie("keccak"+e).update(r).digest()};G.keccak256=function(r){return G.keccak(r)};G.sha3=G.keccak;G.sha256=function(r){return r=G.toBuffer(r),$W("sha256").update(r).digest()};G.ripemd160=function(r,e){r=G.toBuffer(r);var t=$W("rmd160").update(r).digest();return e===!0?G.setLength(t,32):t};G.rlphash=function(r){return G.keccak(Ab.encode(r))};G.isValidPrivate=function(r){return Qa.privateKeyVerify(r)};G.isValidPublic=function(r,e){return r.length===64?Qa.publicKeyVerify(dr.concat([dr.from([4]),r])):e?Qa.publicKeyVerify(r):!1};G.pubToAddress=G.publicToAddress=function(r,e){return r=G.toBuffer(r),e&&r.length!==64&&(r=Qa.publicKeyConvert(r,!1).slice(1)),y2(r.length===64),G.keccak(r).slice(-20)};var tie=G.privateToPublic=function(r){return r=G.toBuffer(r),Qa.publicKeyCreate(r,!1).slice(1)};G.importPublic=function(r){return r=G.toBuffer(r),r.length!==64&&(r=Qa.publicKeyConvert(r,!1).slice(1)),r};G.ecsign=function(r,e){var t=Qa.sign(r,e),n={};return n.r=t.signature.slice(0,32),n.s=t.signature.slice(32,64),n.v=t.recovery+27,n};G.hashPersonalMessage=function(r){var e=G.toBuffer(`Ethereum Signed Message:
`+r.length.toString());return G.keccak(dr.concat([e,r]))};G.ecrecover=function(r,e,t,n){var a=dr.concat([G.setLength(t,32),G.setLength(n,32)],64),s=e-27;if(s!==0&&s!==1)throw new Error("Invalid signature v value");var i=Qa.recover(r,a,s);return Qa.publicKeyConvert(i,!1).slice(1)};G.toRpcSig=function(r,e,t){if(r!==27&&r!==28)throw new Error("Invalid recovery id");return G.bufferToHex(dr.concat([G.setLengthLeft(e,32),G.setLengthLeft(t,32),G.toBuffer(r-27)]))};G.fromRpcSig=function(r){if(r=G.toBuffer(r),r.length!==65)throw new Error("Invalid signature length");var e=r[64];return e<27&&(e+=27),{v:e,r:r.slice(0,32),s:r.slice(32,64)}};G.privateToAddress=function(r){return G.publicToAddress(tie(r))};G.isValidAddress=function(r){return/^0x[0-9a-fA-F]{40}$/.test(r)};G.isZeroAddress=function(r){var e=G.zeroAddress();return e===G.addHexPrefix(r)};G.toChecksumAddress=function(r){r=G.stripHexPrefix(r).toLowerCase();for(var e=G.keccak(r).toString("hex"),t="0x",n=0;n<r.length;n++)parseInt(e[n],16)>=8?t+=r[n].toUpperCase():t+=r[n];return t};G.isValidChecksumAddress=function(r){return G.isValidAddress(r)&&G.toChecksumAddress(r)===r};G.generateAddress=function(r,e){return r=G.toBuffer(r),e=new fa(e),e.isZero()?e=null:e=dr.from(e.toArray()),G.rlphash([r,e]).slice(-20)};G.isPrecompiled=function(r){var e=G.unpad(r);return e.length===1&&e[0]>=1&&e[0]<=8};G.addHexPrefix=function(r){return typeof r!="string"||G.isHexPrefixed(r)?r:"0x"+r};G.isValidSignature=function(r,e,t,n){var a=new fa("7fffffffffffffffffffffffffffffff5d576e7357a4501ddfe92f46681b20a0",16),s=new fa("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",16);return!(e.length!==32||t.length!==32||r!==27&&r!==28||(e=new fa(e),t=new fa(t),e.isZero()||e.gt(s)||t.isZero()||t.gt(s))||n===!1&&new fa(t).cmp(a)===1)};G.baToJSON=function(r){if(dr.isBuffer(r))return"0x"+r.toString("hex");if(r instanceof Array){for(var e=[],t=0;t<r.length;t++)e.push(G.baToJSON(r[t]));return e}};G.defineProperties=function(r,e,t){if(r.raw=[],r._fields=[],r.toJSON=function(a){if(a){var s={};return r._fields.forEach(function(i){s[i]="0x"+r[i].toString("hex")}),s}return G.baToJSON(this.raw)},r.serialize=function(){return Ab.encode(r.raw)},e.forEach(function(a,s){r._fields.push(a.name);function i(){return r.raw[s]}function o(c){c=G.toBuffer(c),c.toString("hex")==="00"&&!a.allowZero&&(c=dr.allocUnsafe(0)),a.allowLess&&a.length?(c=G.stripZeros(c),y2(a.length>=c.length,"The field "+a.name+" must not have more "+a.length+" bytes")):!(a.allowZero&&c.length===0)&&a.length&&y2(a.length===c.length,"The field "+a.name+" must have byte length of "+a.length),r.raw[s]=c}Object.defineProperty(r,a.name,{enumerable:!0,configurable:!0,get:i,set:o}),a.default&&(r[a.name]=a.default),a.alias&&Object.defineProperty(r,a.alias,{enumerable:!1,configurable:!0,set:o,get:i})}),t)if(typeof t=="string"&&(t=dr.from(G.stripHexPrefix(t),"hex")),dr.isBuffer(t)&&(t=Ab.decode(t)),Array.isArray(t)){if(t.length>r._fields.length)throw new Error("wrong number of fields in data");t.forEach(function(a,s){r[r._fields[s]]=G.toBuffer(a)})}else if((typeof t>"u"?"undefined":Qse(t))==="object"){var n=Object.keys(t);e.forEach(function(a){n.indexOf(a.name)!==-1&&(r[a.name]=t[a.name]),n.indexOf(a.alias)!==-1&&(r[a.alias]=t[a.alias])})}else throw new Error("invalid data")}});var eK=D((fBe,QW)=>{d();f();var et=YW(),x2=u$();QW.exports={concatSig:function(r,e,t){let n=et.fromSigned(e),a=et.fromSigned(t),s=et.bufferToInt(r),i=XW(et.toUnsigned(n).toString("hex"),64),o=XW(et.toUnsigned(a).toString("hex"),64),c=et.stripHexPrefix(et.intToHex(s));return et.addHexPrefix(i.concat(o,c)).toString("hex")},normalize:function(r){if(!!r){if(typeof r=="number"){let t=et.toBuffer(r);r=et.bufferToHex(t)}if(typeof r!="string"){var e="eth-sig-util.normalize() requires hex string or integer input.";throw e+=" received "+typeof r+": "+r,new Error(e)}return et.addHexPrefix(r.toLowerCase())}},personalSign:function(r,e){var t=et.toBuffer(e.data),n=et.hashPersonalMessage(t),a=et.ecsign(n,r),s=et.bufferToHex(this.concatSig(a.v,a.r,a.s));return s},recoverPersonalSignature:function(r){let e=JW(r),t=et.publicToAddress(e);return et.bufferToHex(t)},extractPublicKey:function(r){let e=JW(r);return"0x"+e.toString("hex")},typedSignatureHash:function(r){let e=w2(r);return et.bufferToHex(e)},signTypedData:function(r,e){let t=w2(e.data),n=et.ecsign(t,r);return et.bufferToHex(this.concatSig(n.v,n.r,n.s))},recoverTypedSignature:function(r){let e=w2(r.data),t=ZW(e,r.sig),n=et.publicToAddress(t);return et.bufferToHex(n)}};function w2(r){let e=new Error("Expect argument to be non-empty array");if(typeof r!="object"||!r.length)throw e;let t=r.map(function(s){return s.type==="bytes"?et.toBuffer(s.value):s.value}),n=r.map(function(s){return s.type}),a=r.map(function(s){if(!s.name)throw e;return s.type+" "+s.name});return x2.soliditySHA3(["bytes32","bytes32"],[x2.soliditySHA3(new Array(r.length).fill("string"),a),x2.soliditySHA3(n,t)])}function ZW(r,e){let t=et.toBuffer(e),n=et.fromRpcSig(t);return et.ecrecover(r,n.v,n.r,n.s)}function JW(r){let e=et.toBuffer(r.data),t=et.hashPersonalMessage(e);return ZW(t,r.sig)}function XW(r,e){for(var t=""+r;t.length<e;)t="0"+t;return t}});var nK=D((hBe,rK)=>{d();f();var Na=Xo(),rie=n2(),nie=eK(),{ethErrors:Bs}=Zg();rK.exports=function(e={}){let t=e.getAccounts,n=e.processTypedMessage,a=e.processTypedMessageV3,s=e.processTypedMessageV4,i=e.processPersonalMessage,o=e.processEthSignMessage,c=e.processTransaction,l=e.processDecryptMessage,u=e.processEncryptionPublicKey;if(!t)throw new Error("opts.getAccounts is required");return rie({eth_accounts:Na(h),eth_coinbase:Na(b),eth_sendTransaction:Na(y),eth_sign:Na(v),eth_signTypedData:Na(S),eth_signTypedData_v3:Na(R),eth_signTypedData_v4:Na(P),personal_sign:Na(N),eth_getEncryptionPublicKey:Na(L),eth_decrypt:Na(B),personal_ecRecover:Na(M)});async function h(K,H){H.result=await t(K)}async function b(K,H){let j=await t(K);H.result=j[0]||null}async function y(K,H){if(!c)throw Bs.rpc.methodNotSupported();let j=K.params[0]||{};j.from=await F(j.from,K),H.result=await c(j,K)}async function v(K,H){if(!o)throw Bs.rpc.methodNotSupported();let j=await F(K.params[0],K),X=K.params[1],z=K.params[2]||{},T=Object.assign({},z,{from:j,data:X});H.result=await o(T,K)}async function S(K,H){if(!n)throw Bs.rpc.methodNotSupported();let j=K.params[0],X=await F(K.params[1],K),z="V1",T=K.params[2]||{},m=Object.assign({},T,{from:X,data:j});H.result=await n(m,K,z)}async function R(K,H){if(!a)throw Bs.rpc.methodNotSupported();let j=await F(K.params[0],K),X=K.params[1],z="V3",T={data:X,from:j,version:z};H.result=await a(T,K,z)}async function P(K,H){if(!s)throw Bs.rpc.methodNotSupported();let j=await F(K.params[0],K),X=K.params[1],z="V4",T={data:X,from:j,version:z};H.result=await s(T,K,z)}async function N(K,H){if(!i)throw Bs.rpc.methodNotSupported();let j=K.params[0],X=K.params[1],z=K.params[2]||{},T,m;if(tK(j)&&!tK(X)){let w="The eth_personalSign method requires params ordered ";w+="[message, address]. This was previously handled incorrectly, ",w+="and has been corrected automatically. ",w+="Please switch this param order for smooth behavior in the future.",H.warning=w,T=j,m=X}else m=j,T=X;T=await F(T,K);let x=Object.assign({},z,{from:T,data:m});H.result=await i(x,K)}async function M(K,H){let j=K.params[0],X=K.params[1],z=K.params[2]||{},T=Object.assign({},z,{sig:X,data:j}),m=nie.recoverPersonalSignature(T);H.result=m}async function L(K,H){if(!u)throw Bs.rpc.methodNotSupported();let j=await F(K.params[0],K);H.result=await u(j,K)}async function B(K,H){if(!l)throw Bs.rpc.methodNotSupported();let j=K.params[0],X=await F(K.params[1],K),z=K.params[2]||{},T=Object.assign({},z,{from:X,data:j});H.result=await l(T,K)}async function F(K,H){if(typeof K=="string"&&K.length>0){let X=(await t(H)).map(T=>T.toLowerCase()),z=K.toLowerCase();if(X.includes(z))return z}throw Bs.rpc.invalidParams({message:"Invalid parameters: must provide an Ethereum address."})}};function tK(r){return r.length===2+20*2}});var tq=D((es,eq)=>{"use strict";d();f();Object.defineProperty(es,"__esModule",{value:!0});function Ra(r){return typeof r=="object"&&!("toString"in r)?Object.prototype.toString.call(r).slice(8,-1):r}var bie=typeof process=="object"&&!0;function la(r,e){if(!r)throw bie?new Error("Invariant failed"):new Error(e())}es.invariant=la;var F2=Object.prototype.hasOwnProperty,yie=Array.prototype.splice,xie=Object.prototype.toString;function ic(r){return xie.call(r).slice(8,-1)}var Wb=Object.assign||function(r,e){return H2(e).forEach(function(t){F2.call(e,t)&&(r[t]=e[t])}),r},H2=typeof Object.getOwnPropertySymbols=="function"?function(r){return Object.keys(r).concat(Object.getOwnPropertySymbols(r))}:function(r){return Object.keys(r)};function Ui(r){return Array.isArray(r)?Wb(r.constructor(r.length),r):ic(r)==="Map"?new Map(r):ic(r)==="Set"?new Set(r):r&&typeof r=="object"?Wb(Object.create(Object.getPrototypeOf(r)),r):r}var ZK=function(){function r(){this.commands=Wb({},wie),this.update=this.update.bind(this),this.update.extend=this.extend=this.extend.bind(this),this.update.isEquals=function(e,t){return e===t},this.update.newContext=function(){return new r().update}}return Object.defineProperty(r.prototype,"isEquals",{get:function(){return this.update.isEquals},set:function(e){this.update.isEquals=e},enumerable:!0,configurable:!0}),r.prototype.extend=function(e,t){this.commands[e]=t},r.prototype.update=function(e,t){var n=this,a=typeof t=="function"?{$apply:t}:t;Array.isArray(e)&&Array.isArray(a)||la(!Array.isArray(a),function(){return"update(): You provided an invalid spec to update(). The spec may not contain an array except as the value of $set, $push, $unshift, $splice or any custom command allowing an array value."}),la(typeof a=="object"&&a!==null,function(){return"update(): You provided an invalid spec to update(). The spec and every included key path must be plain objects containing one of the "+("following commands: "+Object.keys(n.commands).join(", ")+".")});var s=e;return H2(a).forEach(function(i){if(F2.call(n.commands,i)){var o=e===s;s=n.commands[i](a[i],s,a,e),o&&n.isEquals(s,e)&&(s=e)}else{var c=ic(e)==="Map"?n.update(e.get(i),a[i]):n.update(e[i],a[i]),l=ic(s)==="Map"?s.get(i):s[i];(!n.isEquals(c,l)||typeof c>"u"&&!F2.call(e,i))&&(s===e&&(s=Ui(e)),ic(s)==="Map"?s.set(i,c):s[i]=c)}}),s},r}();es.Context=ZK;var wie={$push:function(r,e,t){return JK(e,t,"$push"),r.length?e.concat(r):e},$unshift:function(r,e,t){return JK(e,t,"$unshift"),r.length?r.concat(e):e},$splice:function(r,e,t,n){return vie(e,t),r.forEach(function(a){QK(a),e===n&&a.length&&(e=Ui(n)),yie.apply(e,a)}),e},$set:function(r,e,t){return _ie(t),r},$toggle:function(r,e){Ih(r,"$toggle");var t=r.length?Ui(e):e;return r.forEach(function(n){t[n]=!e[n]}),t},$unset:function(r,e,t,n){return Ih(r,"$unset"),r.forEach(function(a){Object.hasOwnProperty.call(e,a)&&(e===n&&(e=Ui(n)),delete e[a])}),e},$add:function(r,e,t,n){return XK(e,"$add"),Ih(r,"$add"),ic(e)==="Map"?r.forEach(function(a){var s=a[0],i=a[1];e===n&&e.get(s)!==i&&(e=Ui(n)),e.set(s,i)}):r.forEach(function(a){e===n&&!e.has(a)&&(e=Ui(n)),e.add(a)}),e},$remove:function(r,e,t,n){return XK(e,"$remove"),Ih(r,"$remove"),r.forEach(function(a){e===n&&e.has(a)&&(e=Ui(n)),e.delete(a)}),e},$merge:function(r,e,t,n){return Aie(e,r),H2(r).forEach(function(a){r[a]!==e[a]&&(e===n&&(e=Ui(n)),e[a]=r[a])}),e},$apply:function(r,e){return Sie(r),r(e)}},G2=new ZK;es.isEquals=G2.update.isEquals;es.extend=G2.extend;es.default=G2.update;es.default.default=eq.exports=Wb(es.default,es);function JK(r,e,t){la(Array.isArray(r),function(){return"update(): expected target of "+Ra(t)+" to be an array; got "+Ra(r)+"."}),Ih(e[t],t)}function Ih(r,e){la(Array.isArray(r),function(){return"update(): expected spec of "+Ra(e)+" to be an array; got "+Ra(r)+". Did you forget to wrap your parameter in an array?"})}function vie(r,e){la(Array.isArray(r),function(){return"Expected $splice target to be an array; got "+Ra(r)}),QK(e.$splice)}function QK(r){la(Array.isArray(r),function(){return"update(): expected spec of $splice to be an array of arrays; got "+Ra(r)+". Did you forget to wrap your parameters in an array?"})}function Sie(r){la(typeof r=="function",function(){return"update(): expected spec of $apply to be a function; got "+Ra(r)+"."})}function _ie(r){la(Object.keys(r).length===1,function(){return"Cannot have more than one key in an object with $set"})}function Aie(r,e){la(e&&typeof e=="object",function(){return"update(): $merge expects a spec of type 'object'; got "+Ra(e)}),la(r&&typeof r=="object",function(){return"update(): $merge expects a target of type 'object'; got "+Ra(r)})}function XK(r,e){var t=ic(r);la(t==="Map"||t==="Set",function(){return"update(): "+Ra(e)+" expects a target of type Set or Map; got "+Ra(t)})}});var dc=D((ua,Xq)=>{"use strict";d();f();var Jq=dh(),l6=ua.ValidationError=function(e,t,n,a,s,i){a&&(this.property=a),e&&(this.message=e),n&&(n.id?this.schema=n.id:this.schema=n),t&&(this.instance=t),this.name=s,this.argument=i,this.stack=this.toString()};l6.prototype.toString=function(){return this.property+" "+this.message};var Qb=ua.ValidatorResult=function(e,t,n,a){this.instance=e,this.schema=t,this.propertyPath=a.propertyPath,this.errors=[],this.throwError=n&&n.throwError,this.disableFormat=n&&n.disableFormat===!0};Qb.prototype.addError=function(e){var t;if(typeof e=="string")t=new l6(e,this.instance,this.schema,this.propertyPath);else{if(!e)throw new Error("Missing error detail");if(!e.message)throw new Error("Missing error message");if(!e.name)throw new Error("Missing validator type");t=new l6(e.message,this.instance,this.schema,this.propertyPath,e.name,e.argument)}if(this.throwError)throw t;return this.errors.push(t),t};Qb.prototype.importErrors=function(e){typeof e=="string"||e&&e.validatorType?this.addError(e):e&&e.errors&&Array.prototype.push.apply(this.errors,e.errors)};function zie(r,e){return e+": "+r.toString()+`
`}Qb.prototype.toString=function(e){return this.errors.map(zie).join("")};Object.defineProperty(Qb.prototype,"valid",{get:function(){return!this.errors.length}});var Yq=ua.SchemaError=function r(e,t){this.message=e,this.schema=t,Error.call(this,e),Error.captureStackTrace(this,r)};Yq.prototype=Object.create(Error.prototype,{constructor:{value:Yq,enumerable:!1},name:{value:"SchemaError",enumerable:!1}});var u6=ua.SchemaContext=function(e,t,n,a,s){this.schema=e,this.options=t,this.propertyPath=n,this.base=a,this.schemas=s};u6.prototype.resolve=function(e){return Jq.resolve(this.base,e)};u6.prototype.makeChild=function(e,t){var n=t===void 0?this.propertyPath:this.propertyPath+jie(t),a=Jq.resolve(this.base,e.id||""),s=new u6(e,this.options,n,a,Object.create(this.schemas));return e.id&&!s.schemas[a]&&(s.schemas[a]=e),s};var ka=ua.FORMAT_REGEXPS={"date-time":/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])[tT ](2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])(\.\d+)?([zZ]|[+-]([0-5][0-9]):(60|[0-5][0-9]))$/,date:/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])$/,time:/^(2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])$/,email:/^(?:[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+\.)*[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+@(?:(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!\.)){0,61}[a-zA-Z0-9]?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!$)){0,61}[a-zA-Z0-9]?)|(?:\[(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\]))$/,"ip-address":/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,ipv6:/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,uri:/^[a-zA-Z][a-zA-Z0-9+-.]*:[^\s]*$/,color:/^(#?([0-9A-Fa-f]{3}){1,2}\b|aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|(rgb\(\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*\))|(rgb\(\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*\)))$/,hostname:/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,"host-name":/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,alpha:/^[a-zA-Z]+$/,alphanumeric:/^[a-zA-Z0-9]+$/,"utc-millisec":function(r){return typeof r=="string"&&parseFloat(r)===parseInt(r,10)&&!isNaN(r)},regex:function(r){var e=!0;try{new RegExp(r)}catch{e=!1}return e},style:/\s*(.+?):\s*([^;]+);?/g,phone:/^\+(?:[0-9] ?){6,14}[0-9]$/};ka.regexp=ka.regex;ka.pattern=ka.regex;ka.ipv4=ka["ip-address"];ua.isFormat=function(e,t,n){if(typeof e=="string"&&ka[t]!==void 0){if(ka[t]instanceof RegExp)return ka[t].test(e);if(typeof ka[t]=="function")return ka[t](e)}else if(n&&n.customFormats&&typeof n.customFormats[t]=="function")return n.customFormats[t](e);return!0};var jie=ua.makeSuffix=function(e){return e=e.toString(),!e.match(/[.\s\[\]]/)&&!e.match(/^[\d]/)?"."+e:e.match(/^\d+$/)?"["+e+"]":"["+JSON.stringify(e)+"]"};ua.deepCompareStrict=function r(e,t){if(typeof e!=typeof t)return!1;if(e instanceof Array)return!(t instanceof Array)||e.length!==t.length?!1:e.every(function(s,i){return r(e[i],t[i])});if(typeof e=="object"){if(!e||!t)return e===t;var n=Object.keys(e),a=Object.keys(t);return n.length!==a.length?!1:n.every(function(s){return r(e[s],t[s])})}return e===t};function Vie(r,e,t,n){typeof t=="object"?e[n]=h6(r[n],t):r.indexOf(t)===-1&&e.push(t)}function $ie(r,e,t){e[t]=r[t]}function Yie(r,e,t,n){typeof e[n]!="object"||!e[n]?t[n]=e[n]:r[n]?t[n]=h6(r[n],e[n]):t[n]=e[n]}function h6(r,e){var t=Array.isArray(e),n=t&&[]||{};return t?(r=r||[],n=n.concat(r),e.forEach(Vie.bind(null,r,n))):(r&&typeof r=="object"&&Object.keys(r).forEach($ie.bind(null,r,n)),Object.keys(e).forEach(Yie.bind(null,r,e,n))),n}Xq.exports.deepMerge=h6;ua.objectGetPath=function(e,t){for(var n=t.split("/").slice(1),a;typeof(a=n.shift())=="string";){var s=decodeURIComponent(a.replace(/~0/,"~").replace(/~1/g,"/"));if(!(s in e))return;e=e[s]}return e};function Jie(r){return"/"+encodeURIComponent(r).replace(/~/g,"%7E")}ua.encodePath=function(e){return e.map(Jie).join("")};ua.getDecimalPlaces=function(e){var t=0;if(isNaN(e))return t;typeof e!="number"&&(e=Number(e));var n=e.toString().split("e");if(n.length===2){if(n[1][0]!=="-")return t;t=Number(n[1].slice(1))}var a=n[0].split(".");return a.length===2&&(t+=a[1].length),t}});var rU=D((AGe,tU)=>{"use strict";d();f();var qs=dc(),tt=qs.ValidatorResult,Gh=qs.SchemaError,p6={};p6.ignoreProperties={id:!0,default:!0,description:!0,title:!0,exclusiveMinimum:!0,exclusiveMaximum:!0,additionalItems:!0,$schema:!0,$ref:!0,extends:!0};var rt=p6.validators={};rt.type=function(e,t,n,a){if(e===void 0)return null;var s=new tt(e,t,n,a),i=Array.isArray(t.type)?t.type:[t.type];if(!i.some(this.testType.bind(this,e,t,n,a))){var o=i.map(function(c){return c.id&&"<"+c.id+">"||c+""});s.addError({name:"type",argument:o,message:"is not of a type(s) "+o})}return s};function Zq(r,e,t,n,a){var s=e.throwError;e.throwError=!1;var i=this.validateSchema(r,a,e,t);return e.throwError=s,!i.valid&&n instanceof Function&&n(i),i.valid}rt.anyOf=function(e,t,n,a){if(e===void 0)return null;var s=new tt(e,t,n,a),i=new tt(e,t,n,a);if(!Array.isArray(t.anyOf))throw new Gh("anyOf must be an array");if(!t.anyOf.some(Zq.bind(this,e,n,a,function(c){i.importErrors(c)}))){var o=t.anyOf.map(function(c,l){return c.id&&"<"+c.id+">"||c.title&&JSON.stringify(c.title)||c.$ref&&"<"+c.$ref+">"||"[subschema "+l+"]"});n.nestedErrors&&s.importErrors(i),s.addError({name:"anyOf",argument:o,message:"is not any of "+o.join(",")})}return s};rt.allOf=function(e,t,n,a){if(e===void 0)return null;if(!Array.isArray(t.allOf))throw new Gh("allOf must be an array");var s=new tt(e,t,n,a),i=this;return t.allOf.forEach(function(o,c){var l=i.validateSchema(e,o,n,a);if(!l.valid){var u=o.id&&"<"+o.id+">"||o.title&&JSON.stringify(o.title)||o.$ref&&"<"+o.$ref+">"||"[subschema "+c+"]";s.addError({name:"allOf",argument:{id:u,length:l.errors.length,valid:l},message:"does not match allOf schema "+u+" with "+l.errors.length+" error[s]:"}),s.importErrors(l)}}),s};rt.oneOf=function(e,t,n,a){if(e===void 0)return null;if(!Array.isArray(t.oneOf))throw new Gh("oneOf must be an array");var s=new tt(e,t,n,a),i=new tt(e,t,n,a),o=t.oneOf.filter(Zq.bind(this,e,n,a,function(l){i.importErrors(l)})).length,c=t.oneOf.map(function(l,u){return l.id&&"<"+l.id+">"||l.title&&JSON.stringify(l.title)||l.$ref&&"<"+l.$ref+">"||"[subschema "+u+"]"});return o!==1&&(n.nestedErrors&&s.importErrors(i),s.addError({name:"oneOf",argument:c,message:"is not exactly one from "+c.join(",")})),s};rt.properties=function(e,t,n,a){if(!!this.types.object(e)){var s=new tt(e,t,n,a),i=t.properties||{};for(var o in i){typeof n.preValidateProperty=="function"&&n.preValidateProperty(e,o,i[o],n,a);var c=Object.hasOwnProperty.call(e,o)?e[o]:void 0,l=this.validateSchema(c,i[o],n,a.makeChild(i[o],o));l.instance!==s.instance[o]&&(s.instance[o]=l.instance),s.importErrors(l)}return s}};function Qq(r,e,t,n,a,s){if(!!this.types.object(r)&&!(e.properties&&e.properties[a]!==void 0))if(e.additionalProperties===!1)s.addError({name:"additionalProperties",argument:a,message:"additionalProperty "+JSON.stringify(a)+" exists in instance when not allowed"});else{var i=e.additionalProperties||{};typeof t.preValidateProperty=="function"&&t.preValidateProperty(r,a,i,t,n);var o=this.validateSchema(r[a],i,t,n.makeChild(i,a));o.instance!==s.instance[a]&&(s.instance[a]=o.instance),s.importErrors(o)}}rt.patternProperties=function(e,t,n,a){if(!!this.types.object(e)){var s=new tt(e,t,n,a),i=t.patternProperties||{};for(var o in e){var c=!0;for(var l in i){var u=new RegExp(l);if(!!u.test(o)){c=!1,typeof n.preValidateProperty=="function"&&n.preValidateProperty(e,o,i[l],n,a);var h=this.validateSchema(e[o],i[l],n,a.makeChild(i[l],o));h.instance!==s.instance[o]&&(s.instance[o]=h.instance),s.importErrors(h)}}c&&Qq.call(this,e,t,n,a,o,s)}return s}};rt.additionalProperties=function(e,t,n,a){if(!!this.types.object(e)){if(t.patternProperties)return null;var s=new tt(e,t,n,a);for(var i in e)Qq.call(this,e,t,n,a,i,s);return s}};rt.minProperties=function(e,t,n,a){if(!!this.types.object(e)){var s=new tt(e,t,n,a),i=Object.keys(e);return i.length>=t.minProperties||s.addError({name:"minProperties",argument:t.minProperties,message:"does not meet minimum property length of "+t.minProperties}),s}};rt.maxProperties=function(e,t,n,a){if(!!this.types.object(e)){var s=new tt(e,t,n,a),i=Object.keys(e);return i.length<=t.maxProperties||s.addError({name:"maxProperties",argument:t.maxProperties,message:"does not meet maximum property length of "+t.maxProperties}),s}};rt.items=function(e,t,n,a){var s=this;if(!!this.types.array(e)&&!!t.items){var i=new tt(e,t,n,a);return e.every(function(o,c){var l=Array.isArray(t.items)?t.items[c]||t.additionalItems:t.items;if(l===void 0)return!0;if(l===!1)return i.addError({name:"items",message:"additionalItems not permitted"}),!1;var u=s.validateSchema(o,l,n,a.makeChild(l,c));return u.instance!==i.instance[c]&&(i.instance[c]=u.instance),i.importErrors(u),!0}),i}};rt.minimum=function(e,t,n,a){if(!!this.types.number(e)){var s=new tt(e,t,n,a),i=!0;return t.exclusiveMinimum&&t.exclusiveMinimum===!0?i=e>t.minimum:i=e>=t.minimum,i||s.addError({name:"minimum",argument:t.minimum,message:"must have a minimum value of "+t.minimum}),s}};rt.maximum=function(e,t,n,a){if(!!this.types.number(e)){var s=new tt(e,t,n,a),i;return t.exclusiveMaximum&&t.exclusiveMaximum===!0?i=e<t.maximum:i=e<=t.maximum,i||s.addError({name:"maximum",argument:t.maximum,message:"must have a maximum value of "+t.maximum}),s}};var eU=function(e,t,n,a,s,i){if(!!this.types.number(e)){var o=t[s];if(o==0)throw new Gh(s+" cannot be zero");var c=new tt(e,t,n,a),l=qs.getDecimalPlaces(e),u=qs.getDecimalPlaces(o),h=Math.max(l,u),b=Math.pow(10,h);return Math.round(e*b)%Math.round(o*b)!==0&&c.addError({name:s,argument:o,message:i+JSON.stringify(o)}),c}};rt.multipleOf=function(e,t,n,a){return eU.call(this,e,t,n,a,"multipleOf","is not a multiple of (divisible by) ")};rt.divisibleBy=function(e,t,n,a){return eU.call(this,e,t,n,a,"divisibleBy","is not divisible by (multiple of) ")};rt.required=function(e,t,n,a){var s=new tt(e,t,n,a);return e===void 0&&t.required===!0?s.addError({name:"required",message:"is required"}):this.types.object(e)&&Array.isArray(t.required)&&t.required.forEach(function(i){e[i]===void 0&&s.addError({name:"required",argument:i,message:"requires property "+JSON.stringify(i)})}),s};rt.pattern=function(e,t,n,a){if(!!this.types.string(e)){var s=new tt(e,t,n,a);return e.match(t.pattern)||s.addError({name:"pattern",argument:t.pattern,message:"does not match pattern "+JSON.stringify(t.pattern)}),s}};rt.format=function(e,t,n,a){if(e!==void 0){var s=new tt(e,t,n,a);return!s.disableFormat&&!qs.isFormat(e,t.format,this)&&s.addError({name:"format",argument:t.format,message:"does not conform to the "+JSON.stringify(t.format)+" format"}),s}};rt.minLength=function(e,t,n,a){if(!!this.types.string(e)){var s=new tt(e,t,n,a),i=e.match(/[\uDC00-\uDFFF]/g),o=e.length-(i?i.length:0);return o>=t.minLength||s.addError({name:"minLength",argument:t.minLength,message:"does not meet minimum length of "+t.minLength}),s}};rt.maxLength=function(e,t,n,a){if(!!this.types.string(e)){var s=new tt(e,t,n,a),i=e.match(/[\uDC00-\uDFFF]/g),o=e.length-(i?i.length:0);return o<=t.maxLength||s.addError({name:"maxLength",argument:t.maxLength,message:"does not meet maximum length of "+t.maxLength}),s}};rt.minItems=function(e,t,n,a){if(!!this.types.array(e)){var s=new tt(e,t,n,a);return e.length>=t.minItems||s.addError({name:"minItems",argument:t.minItems,message:"does not meet minimum length of "+t.minItems}),s}};rt.maxItems=function(e,t,n,a){if(!!this.types.array(e)){var s=new tt(e,t,n,a);return e.length<=t.maxItems||s.addError({name:"maxItems",argument:t.maxItems,message:"does not meet maximum length of "+t.maxItems}),s}};rt.uniqueItems=function(e,t,n,a){if(!this.types.array(e))return;var s=new tt(e,t,n,a);function i(o,c,l){for(var u=c+1;u<l.length;u++)if(qs.deepCompareStrict(o,l[u]))return!1;return!0}return e.every(i)||s.addError({name:"uniqueItems",message:"contains duplicate item"}),s};function Xie(r,e,t){var n,a=t.length;for(n=e+1,a;n<a;n++)if(qs.deepCompareStrict(r,t[n]))return!1;return!0}rt.uniqueItems=function(e,t,n,a){if(!!this.types.array(e)){var s=new tt(e,t,n,a);return e.every(Xie)||s.addError({name:"uniqueItems",message:"contains duplicate item"}),s}};rt.dependencies=function(e,t,n,a){if(!!this.types.object(e)){var s=new tt(e,t,n,a);for(var i in t.dependencies)if(e[i]!==void 0){var o=t.dependencies[i],c=a.makeChild(o,i);if(typeof o=="string"&&(o=[o]),Array.isArray(o))o.forEach(function(u){e[u]===void 0&&s.addError({name:"dependencies",argument:c.propertyPath,message:"property "+u+" not found, required by "+c.propertyPath})});else{var l=this.validateSchema(e,o,n,c);s.instance!==l.instance&&(s.instance=l.instance),l&&l.errors.length&&(s.addError({name:"dependencies",argument:c.propertyPath,message:"does not meet dependency required by "+c.propertyPath}),s.importErrors(l))}}return s}};rt.enum=function(e,t,n,a){if(e===void 0)return null;if(!Array.isArray(t.enum))throw new Gh("enum expects an array",t);var s=new tt(e,t,n,a);return t.enum.some(qs.deepCompareStrict.bind(null,e))||s.addError({name:"enum",argument:t.enum,message:"is not one of enum values: "+t.enum.map(String).join(",")}),s};rt.const=function(e,t,n,a){if(e===void 0)return null;var s=new tt(e,t,n,a);return qs.deepCompareStrict(t.const,e)||s.addError({name:"const",argument:t.const,message:"does not exactly match expected constant: "+t.const}),s};rt.not=rt.disallow=function(e,t,n,a){var s=this;if(e===void 0)return null;var i=new tt(e,t,n,a),o=t.not||t.disallow;return o?(Array.isArray(o)||(o=[o]),o.forEach(function(c){if(s.testType(e,t,n,a,c)){var l=c&&c.id&&"<"+c.id+">"||c;i.addError({name:"not",argument:l,message:"is of prohibited type "+l})}}),i):null};tU.exports=p6});var ey=D((IGe,m6)=>{d();f();var nU=dh(),Zie=dc();m6.exports.SchemaScanResult=aU;function aU(r,e){this.id=r,this.ref=e}m6.exports.scan=function(e,t){function n(l,u){if(!(!u||typeof u!="object")){if(u.$ref){var h=nU.resolve(l,u.$ref);o[h]=o[h]?o[h]+1:0;return}var b=u.id?nU.resolve(l,u.id):l;if(b){if(b.indexOf("#")<0&&(b+="#"),i[b]){if(!Zie.deepCompareStrict(i[b],u))throw new Error("Schema <"+u+"> already exists with different definition");return i[b]}i[b]=u,b[b.length-1]=="#"&&(i[b.substring(0,b.length-1)]=u)}a(b+"/items",u.items instanceof Array?u.items:[u.items]),a(b+"/extends",u.extends instanceof Array?u.extends:[u.extends]),n(b+"/additionalItems",u.additionalItems),s(b+"/properties",u.properties),n(b+"/additionalProperties",u.additionalProperties),s(b+"/definitions",u.definitions),s(b+"/patternProperties",u.patternProperties),s(b+"/dependencies",u.dependencies),a(b+"/disallow",u.disallow),a(b+"/allOf",u.allOf),a(b+"/anyOf",u.anyOf),a(b+"/oneOf",u.oneOf),n(b+"/not",u.not)}}function a(l,u){if(u instanceof Array)for(var h=0;h<u.length;h++)n(l+"/"+h,u[h])}function s(l,u){if(!(!u||typeof u!="object"))for(var h in u)n(l+"/"+h,u[h])}var i={},o={},c=e;return n(e,t),new aU(i,o)}});var uU=D((MGe,lU)=>{"use strict";d();f();var sU=dh(),iU=rU(),Mf=dc(),oU=ey().scan,Qie=Mf.ValidatorResult,ty=Mf.SchemaError,cU=Mf.SchemaContext,dU="/",qr=function r(){this.customFormats=Object.create(r.prototype.customFormats),this.schemas={},this.unresolvedRefs=[],this.types=Object.create(rs),this.attributes=Object.create(iU.validators)};qr.prototype.customFormats={};qr.prototype.schemas=null;qr.prototype.types=null;qr.prototype.attributes=null;qr.prototype.unresolvedRefs=null;qr.prototype.addSchema=function(e,t){var n=this;if(!e)return null;var a=oU(t||dU,e),s=t||e.id;for(var i in a.id)this.schemas[i]=a.id[i];for(var i in a.ref)this.unresolvedRefs.push(i);return this.unresolvedRefs=this.unresolvedRefs.filter(function(o){return typeof n.schemas[o]>"u"}),this.schemas[s]};qr.prototype.addSubSchemaArray=function(e,t){if(t instanceof Array)for(var n=0;n<t.length;n++)this.addSubSchema(e,t[n])};qr.prototype.addSubSchemaObject=function(e,t){if(!(!t||typeof t!="object"))for(var n in t)this.addSubSchema(e,t[n])};qr.prototype.setSchemas=function(e){this.schemas=e};qr.prototype.getSchema=function(e){return this.schemas[e]};qr.prototype.validate=function(e,t,n,a){n||(n={});var s=n.propertyName||"instance",i=sU.resolve(n.base||dU,t.id||"");if(!a){a=new cU(t,n,s,i,Object.create(this.schemas)),a.schemas[i]||(a.schemas[i]=t);var o=oU(i,t);for(var c in o.id){var l=o.id[c];a.schemas[c]=l}}if(t){var u=this.validateSchema(e,t,n,a);if(!u)throw new Error("Result undefined");return u}throw new ty("no schema specified",t)};function fU(r){var e=typeof r=="string"?r:r.$ref;return typeof e=="string"?e:!1}qr.prototype.validateSchema=function(e,t,n,a){var s=new Qie(e,t,n,a);if(typeof t=="boolean")t===!0?t={}:t===!1&&(t={type:[]});else if(!t)throw new Error("schema is undefined");if(t.extends)if(t.extends instanceof Array){var i={schema:t,ctx:a};t.extends.forEach(this.schemaTraverser.bind(this,i)),t=i.schema,i.schema=null,i.ctx=null,i=null}else t=Mf.deepMerge(t,this.superResolve(t.extends,a));var o;if(o=fU(t)){var c=this.resolve(t,o,a),l=new cU(c.subschema,n,a.propertyPath,c.switchSchema,a.schemas);return this.validateSchema(e,c.subschema,n,l)}var u=n&&n.skipAttributes||[];for(var h in t)if(!iU.ignoreProperties[h]&&u.indexOf(h)<0){var b=null,y=this.attributes[h];if(y)b=y.call(this,e,t,n,a);else if(n.allowUnknownAttributes===!1)throw new ty("Unsupported attribute: "+h,t);b&&s.importErrors(b)}if(typeof n.rewrite=="function"){var v=n.rewrite.call(this,e,t,n,a);s.instance=v}return s};qr.prototype.schemaTraverser=function(e,t){e.schema=Mf.deepMerge(e.schema,this.superResolve(t,e.ctx))};qr.prototype.superResolve=function(e,t){var n;return(n=fU(e))?this.resolve(e,n,t).subschema:e};qr.prototype.resolve=function(e,t,n){if(t=n.resolve(t),n.schemas[t])return{subschema:n.schemas[t],switchSchema:t};var a=sU.parse(t),s=a&&a.hash,i=s&&s.length&&t.substr(0,t.length-s.length);if(!i||!n.schemas[i])throw new ty("no such schema <"+t+">",e);var o=Mf.objectGetPath(n.schemas[i],s.substr(1));if(o===void 0)throw new ty("no such schema "+s+" located in <"+i+">",e);return{subschema:o,switchSchema:t}};qr.prototype.testType=function(e,t,n,a,s){if(typeof this.types[s]=="function")return this.types[s].call(this,e);if(s&&typeof s=="object"){var i=this.validateSchema(e,s,n,a);return i===void 0||!(i&&i.errors.length)}return!0};var rs=qr.prototype.types={};rs.string=function(e){return typeof e=="string"};rs.number=function(e){return typeof e=="number"&&isFinite(e)};rs.integer=function(e){return typeof e=="number"&&e%1===0};rs.boolean=function(e){return typeof e=="boolean"};rs.array=function(e){return Array.isArray(e)};rs.null=function(e){return e===null};rs.date=function(e){return e instanceof Date};rs.any=function(e){return!0};rs.object=function(e){return e&&typeof e=="object"&&!(e instanceof Array)&&!(e instanceof Date)};lU.exports=qr});var hU=D((kGe,Fi)=>{"use strict";d();f();var eoe=Fi.exports.Validator=uU();Fi.exports.ValidatorResult=dc().ValidatorResult;Fi.exports.ValidationError=dc().ValidationError;Fi.exports.SchemaError=dc().SchemaError;Fi.exports.SchemaScanResult=ey().SchemaScanResult;Fi.exports.scan=ey().scan;Fi.exports.validate=function(r,e,t){var n=new eoe;return n.validate(r,e,t)}});var y6=D((Zze,SU)=>{d();f();SU.exports=function(e){return(t,n,a,s)=>{let i,o=new Promise(h=>{i=h}),c,l;e(t,n,async()=>{l=!0,a(h=>{c=h,i()}),await o}).then(async()=>{l?(await o,c(null)):s(null)}).catch(h=>{c?c(h):s(h)})}}});var x6=D((tje,_U)=>{d();f();_U.exports=n2()});var CU=D((aje,AU)=>{d();f();var roe=gv(),noe=ob()();AU.exports=ye;function ye(r){let e=this;e.currentProvider=r}ye.prototype.getBalance=$h(2,"eth_getBalance");ye.prototype.getCode=$h(2,"eth_getCode");ye.prototype.getTransactionCount=$h(2,"eth_getTransactionCount");ye.prototype.getStorageAt=$h(3,"eth_getStorageAt");ye.prototype.call=$h(2,"eth_call");ye.prototype.protocolVersion=_e("eth_protocolVersion");ye.prototype.syncing=_e("eth_syncing");ye.prototype.coinbase=_e("eth_coinbase");ye.prototype.mining=_e("eth_mining");ye.prototype.hashrate=_e("eth_hashrate");ye.prototype.gasPrice=_e("eth_gasPrice");ye.prototype.accounts=_e("eth_accounts");ye.prototype.blockNumber=_e("eth_blockNumber");ye.prototype.getBlockTransactionCountByHash=_e("eth_getBlockTransactionCountByHash");ye.prototype.getBlockTransactionCountByNumber=_e("eth_getBlockTransactionCountByNumber");ye.prototype.getUncleCountByBlockHash=_e("eth_getUncleCountByBlockHash");ye.prototype.getUncleCountByBlockNumber=_e("eth_getUncleCountByBlockNumber");ye.prototype.sign=_e("eth_sign");ye.prototype.sendTransaction=_e("eth_sendTransaction");ye.prototype.sendRawTransaction=_e("eth_sendRawTransaction");ye.prototype.estimateGas=_e("eth_estimateGas");ye.prototype.getBlockByHash=_e("eth_getBlockByHash");ye.prototype.getBlockByNumber=_e("eth_getBlockByNumber");ye.prototype.getTransactionByHash=_e("eth_getTransactionByHash");ye.prototype.getTransactionByBlockHashAndIndex=_e("eth_getTransactionByBlockHashAndIndex");ye.prototype.getTransactionByBlockNumberAndIndex=_e("eth_getTransactionByBlockNumberAndIndex");ye.prototype.getTransactionReceipt=_e("eth_getTransactionReceipt");ye.prototype.getUncleByBlockHashAndIndex=_e("eth_getUncleByBlockHashAndIndex");ye.prototype.getUncleByBlockNumberAndIndex=_e("eth_getUncleByBlockNumberAndIndex");ye.prototype.getCompilers=_e("eth_getCompilers");ye.prototype.compileLLL=_e("eth_compileLLL");ye.prototype.compileSolidity=_e("eth_compileSolidity");ye.prototype.compileSerpent=_e("eth_compileSerpent");ye.prototype.newFilter=_e("eth_newFilter");ye.prototype.newBlockFilter=_e("eth_newBlockFilter");ye.prototype.newPendingTransactionFilter=_e("eth_newPendingTransactionFilter");ye.prototype.uninstallFilter=_e("eth_uninstallFilter");ye.prototype.getFilterChanges=_e("eth_getFilterChanges");ye.prototype.getFilterLogs=_e("eth_getFilterLogs");ye.prototype.getLogs=_e("eth_getLogs");ye.prototype.getWork=_e("eth_getWork");ye.prototype.submitWork=_e("eth_submitWork");ye.prototype.submitHashrate=_e("eth_submitHashrate");ye.prototype.sendAsync=function(r,e){this.currentProvider.sendAsync(aoe(r),function(n,a){if(!n&&a.error&&(n=new Error("EthQuery - RPC Error - "+a.error.message)),n)return e(n);e(null,a.result)})};function _e(r){return function(){let e=this;var t=[].slice.call(arguments),n=t.pop();e.sendAsync({method:r,params:t},n)}}function $h(r,e){return function(){let t=this;var n=[].slice.call(arguments),a=n.pop();n.length<r&&n.push("latest"),t.sendAsync({method:e,params:n},a)}}function aoe(r){return roe({id:noe(),jsonrpc:"2.0",params:[]},r)}});var ry=D((oje,TU)=>{d();f();var soe=Pr(),w6=class extends soe{constructor(){super(),this.updates=[]}async initialize(){}async update(){throw new Error("BaseFilter - no update method specified")}addResults(e){this.updates=this.updates.concat(e),e.forEach(t=>this.emit("update",t))}addInitialResults(e){}getChangesAndClear(){let e=this.updates;return this.updates=[],e}};TU.exports=w6});var EU=D((fje,IU)=>{d();f();var ioe=ry(),v6=class extends ioe{constructor(){super(),this.allResults=[]}async update(){throw new Error("BaseFilterWithHistory - no update method specified")}addResults(e){this.allResults=this.allResults.concat(e),super.addResults(e)}addInitialResults(e){this.allResults=this.allResults.concat(e),super.addInitialResults(e)}getAllResults(){return this.allResults}};IU.exports=v6});var Nf=D((hje,NU)=>{d();f();NU.exports={minBlockRef:ooe,maxBlockRef:coe,sortBlockRefs:S6,bnToHex:doe,blockRefIsNumber:foe,hexToInt:ny,incrementHexInt:loe,intToHex:MU,unsafeRandomBytes:uoe};function ooe(...r){return S6(r)[0]}function coe(...r){let e=S6(r);return e[e.length-1]}function S6(r){return r.sort((e,t)=>e==="latest"||t==="earliest"?1:t==="latest"||e==="earliest"?-1:ny(e)-ny(t))}function doe(r){return"0x"+r.toString(16)}function foe(r){return r&&!["earliest","latest","pending"].includes(r)}function ny(r){return r==null?r:Number.parseInt(r,16)}function loe(r){if(r==null)return r;let e=ny(r);return MU(e+1)}function MU(r){if(r==null)return r;let e=r.toString(16);return e.length%2&&(e="0"+e),"0x"+e}function uoe(r){let e="0x";for(let t=0;t<r;t++)e+=PU(),e+=PU();return e}function PU(){return Math.floor(Math.random()*16).toString(16)}});var kU=D((bje,RU)=>{d();f();var hoe=CU(),poe=n$(),moe=EU(),{bnToHex:gje,hexToInt:ay,incrementHexInt:goe,minBlockRef:boe,blockRefIsNumber:yoe}=Nf(),_6=class extends moe{constructor({provider:e,params:t}){super(),this.type="log",this.ethQuery=new hoe(e),this.params=Object.assign({fromBlock:"latest",toBlock:"latest",address:void 0,topics:[]},t),this.params.address&&(Array.isArray(this.params.address)||(this.params.address=[this.params.address]),this.params.address=this.params.address.map(n=>n.toLowerCase()))}async initialize({currentBlock:e}){let t=this.params.fromBlock;["latest","pending"].includes(t)&&(t=e),t==="earliest"&&(t="0x0"),this.params.fromBlock=t;let n=boe(this.params.toBlock,e),a=Object.assign({},this.params,{toBlock:n}),s=await this._fetchLogs(a);this.addInitialResults(s)}async update({oldBlock:e,newBlock:t}){let n=t,a;e?a=goe(e):a=t;let s=Object.assign({},this.params,{fromBlock:a,toBlock:n}),o=(await this._fetchLogs(s)).filter(c=>this.matchLog(c));this.addResults(o)}async _fetchLogs(e){return await poe(n=>this.ethQuery.getLogs(e,n))()}matchLog(e){if(ay(this.params.fromBlock)>=ay(e.blockNumber)||yoe(this.params.toBlock)&&ay(this.params.toBlock)<=ay(e.blockNumber))return!1;let t=e.address&&e.address.toLowerCase();return this.params.address&&t&&!this.params.address.includes(t)?!1:this.params.topics.every((a,s)=>{let i=e.topics[s];if(!i)return!1;i=i.toLowerCase();let o=Array.isArray(a)?a:[a];return o.includes(null)?!0:(o=o.map(u=>u.toLowerCase()),o.includes(i))})}};RU.exports=_6});var sy=D((wje,DU)=>{d();f();DU.exports=xoe;async function xoe({provider:r,fromBlock:e,toBlock:t}){e||(e=t);let n=OU(e),s=OU(t)-n+1,i=Array(s).fill().map((c,l)=>n+l).map(woe);return await Promise.all(i.map(c=>voe(r,"eth_getBlockByNumber",[c,!1])))}function OU(r){return r==null?r:Number.parseInt(r,16)}function woe(r){if(r==null)return r;let e=r.toString(16);return"0x"+e}function voe(r,e,t){return new Promise((n,a)=>{r.sendAsync({id:1,jsonrpc:"2.0",method:e,params:t},(s,i)=>{if(s)return a(s);n(i.result)})})}});var BU=D((_je,LU)=>{d();f();var Soe=ry(),_oe=sy(),{incrementHexInt:Aoe}=Nf(),A6=class extends Soe{constructor({provider:e,params:t}){super(),this.type="block",this.provider=e}async update({oldBlock:e,newBlock:t}){let n=t,a=Aoe(e),i=(await _oe({provider:this.provider,fromBlock:a,toBlock:n})).map(o=>o.hash);this.addResults(i)}};LU.exports=A6});var gF=D((Yh,kf)=>{d();f();var Coe=200,Toe="Expected a function",O6="__lodash_hash_undefined__",py=1,Of=2,VU=1/0,$U=9007199254740991,iy="[object Arguments]",I6="[object Array]",YU="[object Boolean]",JU="[object Date]",XU="[object Error]",ZU="[object Function]",Ioe="[object GeneratorFunction]",oy="[object Map]",QU="[object Number]",Rf="[object Object]",WU="[object Promise]",eF="[object RegExp]",cy="[object Set]",tF="[object String]",rF="[object Symbol]",E6="[object WeakMap]",nF="[object ArrayBuffer]",dy="[object DataView]",Eoe="[object Float32Array]",Poe="[object Float64Array]",Moe="[object Int8Array]",Noe="[object Int16Array]",Roe="[object Int32Array]",koe="[object Uint8Array]",Ooe="[object Uint8ClampedArray]",Doe="[object Uint16Array]",Loe="[object Uint32Array]",Boe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Woe=/^\w*$/,Koe=/^\./,qoe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Uoe=/[\\^$.*+?()[\]{}|]/g,Foe=/\\(\\)?/g,Hoe=/^\[object .+?Constructor\]$/,Goe=/^(?:0|[1-9]\d*)$/,ut={};ut[Eoe]=ut[Poe]=ut[Moe]=ut[Noe]=ut[Roe]=ut[koe]=ut[Ooe]=ut[Doe]=ut[Loe]=!0;ut[iy]=ut[I6]=ut[nF]=ut[YU]=ut[dy]=ut[JU]=ut[XU]=ut[ZU]=ut[oy]=ut[QU]=ut[Rf]=ut[eF]=ut[cy]=ut[tF]=ut[E6]=!1;var aF=typeof globalThis=="object"&&globalThis&&globalThis.Object===Object&&globalThis,zoe=typeof self=="object"&&self&&self.Object===Object&&self,Gi=aF||zoe||Function("return this")(),sF=typeof Yh=="object"&&Yh&&!Yh.nodeType&&Yh,KU=sF&&typeof kf=="object"&&kf&&!kf.nodeType&&kf,joe=KU&&KU.exports===sF,qU=joe&&aF.process,UU=function(){try{return qU&&qU.binding("util")}catch{}}(),FU=UU&&UU.isTypedArray;function Voe(r,e){for(var t=-1,n=r?r.length:0,a=Array(n);++t<n;)a[t]=e(r[t],t,r);return a}function $oe(r,e){for(var t=-1,n=e.length,a=r.length;++t<n;)r[a+t]=e[t];return r}function Yoe(r,e){for(var t=-1,n=r?r.length:0;++t<n;)if(e(r[t],t,r))return!0;return!1}function Joe(r){return function(e){return e?.[r]}}function Xoe(r,e){for(var t=-1,n=Array(r);++t<r;)n[t]=e(t);return n}function Zoe(r){return function(e){return r(e)}}function Qoe(r,e){return r?.[e]}function P6(r){var e=!1;if(r!=null&&typeof r.toString!="function")try{e=!!(r+"")}catch{}return e}function ece(r){var e=-1,t=Array(r.size);return r.forEach(function(n,a){t[++e]=[a,n]}),t}function tce(r,e){return function(t){return r(e(t))}}function rce(r){var e=-1,t=Array(r.size);return r.forEach(function(n){t[++e]=n}),t}var nce=Array.prototype,ace=Function.prototype,my=Object.prototype,C6=Gi["__core-js_shared__"],HU=function(){var r=/[^.]+$/.exec(C6&&C6.keys&&C6.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),iF=ace.toString,Fs=my.hasOwnProperty,Df=my.toString,sce=RegExp("^"+iF.call(Fs).replace(Uoe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),fy=Gi.Symbol,GU=Gi.Uint8Array,ice=my.propertyIsEnumerable,oce=nce.splice,zU=fy?fy.isConcatSpreadable:void 0,cce=tce(Object.keys,Object),M6=Lf(Gi,"DataView"),Jh=Lf(Gi,"Map"),N6=Lf(Gi,"Promise"),R6=Lf(Gi,"Set"),k6=Lf(Gi,"WeakMap"),Xh=Lf(Object,"create"),dce=lc(M6),fce=lc(Jh),lce=lc(N6),uce=lc(R6),hce=lc(k6),ly=fy?fy.prototype:void 0,T6=ly?ly.valueOf:void 0,jU=ly?ly.toString:void 0;function fc(r){var e=-1,t=r?r.length:0;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}function pce(){this.__data__=Xh?Xh(null):{}}function mce(r){return this.has(r)&&delete this.__data__[r]}function gce(r){var e=this.__data__;if(Xh){var t=e[r];return t===O6?void 0:t}return Fs.call(e,r)?e[r]:void 0}function bce(r){var e=this.__data__;return Xh?e[r]!==void 0:Fs.call(e,r)}function yce(r,e){var t=this.__data__;return t[r]=Xh&&e===void 0?O6:e,this}fc.prototype.clear=pce;fc.prototype.delete=mce;fc.prototype.get=gce;fc.prototype.has=bce;fc.prototype.set=yce;function Gs(r){var e=-1,t=r?r.length:0;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}function xce(){this.__data__=[]}function wce(r){var e=this.__data__,t=gy(e,r);if(t<0)return!1;var n=e.length-1;return t==n?e.pop():oce.call(e,t,1),!0}function vce(r){var e=this.__data__,t=gy(e,r);return t<0?void 0:e[t][1]}function Sce(r){return gy(this.__data__,r)>-1}function _ce(r,e){var t=this.__data__,n=gy(t,r);return n<0?t.push([r,e]):t[n][1]=e,this}Gs.prototype.clear=xce;Gs.prototype.delete=wce;Gs.prototype.get=vce;Gs.prototype.has=Sce;Gs.prototype.set=_ce;function zs(r){var e=-1,t=r?r.length:0;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}function Ace(){this.__data__={hash:new fc,map:new(Jh||Gs),string:new fc}}function Cce(r){return by(this,r).delete(r)}function Tce(r){return by(this,r).get(r)}function Ice(r){return by(this,r).has(r)}function Ece(r,e){return by(this,r).set(r,e),this}zs.prototype.clear=Ace;zs.prototype.delete=Cce;zs.prototype.get=Tce;zs.prototype.has=Ice;zs.prototype.set=Ece;function uy(r){var e=-1,t=r?r.length:0;for(this.__data__=new zs;++e<t;)this.add(r[e])}function Pce(r){return this.__data__.set(r,O6),this}function Mce(r){return this.__data__.has(r)}uy.prototype.add=uy.prototype.push=Pce;uy.prototype.has=Mce;function Us(r){this.__data__=new Gs(r)}function Nce(){this.__data__=new Gs}function Rce(r){return this.__data__.delete(r)}function kce(r){return this.__data__.get(r)}function Oce(r){return this.__data__.has(r)}function Dce(r,e){var t=this.__data__;if(t instanceof Gs){var n=t.__data__;if(!Jh||n.length<Coe-1)return n.push([r,e]),this;t=this.__data__=new zs(n)}return t.set(r,e),this}Us.prototype.clear=Nce;Us.prototype.delete=Rce;Us.prototype.get=kce;Us.prototype.has=Oce;Us.prototype.set=Dce;function Lce(r,e){var t=Hs(r)||B6(r)?Xoe(r.length,String):[],n=t.length,a=!!n;for(var s in r)(e||Fs.call(r,s))&&!(a&&(s=="length"||lF(s,n)))&&t.push(s);return t}function gy(r,e){for(var t=r.length;t--;)if(pF(r[t][0],e))return t;return-1}var Bce=Qce(Kce);function oF(r,e,t,n,a){var s=-1,i=r.length;for(t||(t=sde),a||(a=[]);++s<i;){var o=r[s];e>0&&t(o)?e>1?oF(o,e-1,t,n,a):$oe(a,o):n||(a[a.length]=o)}return a}var Wce=ede();function Kce(r,e){return r&&Wce(r,e,hy)}function cF(r,e){e=yy(e,r)?[e]:dF(e);for(var t=0,n=e.length;r!=null&&t<n;)r=r[xy(e[t++])];return t&&t==n?r:void 0}function qce(r){return Df.call(r)}function Uce(r,e){return r!=null&&e in Object(r)}function D6(r,e,t,n,a){return r===e?!0:r==null||e==null||!vy(r)&&!Sy(e)?r!==r&&e!==e:Fce(r,e,D6,t,n,a)}function Fce(r,e,t,n,a,s){var i=Hs(r),o=Hs(e),c=I6,l=I6;i||(c=Hi(r),c=c==iy?Rf:c),o||(l=Hi(e),l=l==iy?Rf:l);var u=c==Rf&&!P6(r),h=l==Rf&&!P6(e),b=c==l;if(b&&!u)return s||(s=new Us),i||hde(r)?fF(r,e,t,n,a,s):tde(r,e,c,t,n,a,s);if(!(a&Of)){var y=u&&Fs.call(r,"__wrapped__"),v=h&&Fs.call(e,"__wrapped__");if(y||v){var S=y?r.value():r,R=v?e.value():e;return s||(s=new Us),t(S,R,n,a,s)}}return b?(s||(s=new Us),rde(r,e,t,n,a,s)):!1}function Hce(r,e,t,n){var a=t.length,s=a,i=!n;if(r==null)return!s;for(r=Object(r);a--;){var o=t[a];if(i&&o[2]?o[1]!==r[o[0]]:!(o[0]in r))return!1}for(;++a<s;){o=t[a];var c=o[0],l=r[c],u=o[1];if(i&&o[2]){if(l===void 0&&!(c in r))return!1}else{var h=new Us;if(n)var b=n(l,u,c,r,e,h);if(!(b===void 0?D6(u,l,n,py|Of,h):b))return!1}}return!0}function Gce(r){if(!vy(r)||ode(r))return!1;var e=mF(r)||P6(r)?sce:Hoe;return e.test(lc(r))}function zce(r){return Sy(r)&&W6(r.length)&&!!ut[Df.call(r)]}function jce(r){return typeof r=="function"?r:r==null?bde:typeof r=="object"?Hs(r)?Jce(r[0],r[1]):Yce(r):yde(r)}function Vce(r){if(!cde(r))return cce(r);var e=[];for(var t in Object(r))Fs.call(r,t)&&t!="constructor"&&e.push(t);return e}function $ce(r,e){var t=-1,n=wy(r)?Array(r.length):[];return Bce(r,function(a,s,i){n[++t]=e(a,s,i)}),n}function Yce(r){var e=nde(r);return e.length==1&&e[0][2]?hF(e[0][0],e[0][1]):function(t){return t===r||Hce(t,r,e)}}function Jce(r,e){return yy(r)&&uF(e)?hF(xy(r),e):function(t){var n=mde(t,r);return n===void 0&&n===e?gde(t,r):D6(e,n,void 0,py|Of)}}function Xce(r){return function(e){return cF(e,r)}}function Zce(r){if(typeof r=="string")return r;if(K6(r))return jU?jU.call(r):"";var e=r+"";return e=="0"&&1/r==-VU?"-0":e}function dF(r){return Hs(r)?r:dde(r)}function Qce(r,e){return function(t,n){if(t==null)return t;if(!wy(t))return r(t,n);for(var a=t.length,s=e?a:-1,i=Object(t);(e?s--:++s<a)&&n(i[s],s,i)!==!1;);return t}}function ede(r){return function(e,t,n){for(var a=-1,s=Object(e),i=n(e),o=i.length;o--;){var c=i[r?o:++a];if(t(s[c],c,s)===!1)break}return e}}function fF(r,e,t,n,a,s){var i=a&Of,o=r.length,c=e.length;if(o!=c&&!(i&&c>o))return!1;var l=s.get(r);if(l&&s.get(e))return l==e;var u=-1,h=!0,b=a&py?new uy:void 0;for(s.set(r,e),s.set(e,r);++u<o;){var y=r[u],v=e[u];if(n)var S=i?n(v,y,u,e,r,s):n(y,v,u,r,e,s);if(S!==void 0){if(S)continue;h=!1;break}if(b){if(!Yoe(e,function(R,P){if(!b.has(P)&&(y===R||t(y,R,n,a,s)))return b.add(P)})){h=!1;break}}else if(!(y===v||t(y,v,n,a,s))){h=!1;break}}return s.delete(r),s.delete(e),h}function tde(r,e,t,n,a,s,i){switch(t){case dy:if(r.byteLength!=e.byteLength||r.byteOffset!=e.byteOffset)return!1;r=r.buffer,e=e.buffer;case nF:return!(r.byteLength!=e.byteLength||!n(new GU(r),new GU(e)));case YU:case JU:case QU:return pF(+r,+e);case XU:return r.name==e.name&&r.message==e.message;case eF:case tF:return r==e+"";case oy:var o=ece;case cy:var c=s&Of;if(o||(o=rce),r.size!=e.size&&!c)return!1;var l=i.get(r);if(l)return l==e;s|=py,i.set(r,e);var u=fF(o(r),o(e),n,a,s,i);return i.delete(r),u;case rF:if(T6)return T6.call(r)==T6.call(e)}return!1}function rde(r,e,t,n,a,s){var i=a&Of,o=hy(r),c=o.length,l=hy(e),u=l.length;if(c!=u&&!i)return!1;for(var h=c;h--;){var b=o[h];if(!(i?b in e:Fs.call(e,b)))return!1}var y=s.get(r);if(y&&s.get(e))return y==e;var v=!0;s.set(r,e),s.set(e,r);for(var S=i;++h<c;){b=o[h];var R=r[b],P=e[b];if(n)var N=i?n(P,R,b,e,r,s):n(R,P,b,r,e,s);if(!(N===void 0?R===P||t(R,P,n,a,s):N)){v=!1;break}S||(S=b=="constructor")}if(v&&!S){var M=r.constructor,L=e.constructor;M!=L&&"constructor"in r&&"constructor"in e&&!(typeof M=="function"&&M instanceof M&&typeof L=="function"&&L instanceof L)&&(v=!1)}return s.delete(r),s.delete(e),v}function by(r,e){var t=r.__data__;return ide(e)?t[typeof e=="string"?"string":"hash"]:t.map}function nde(r){for(var e=hy(r),t=e.length;t--;){var n=e[t],a=r[n];e[t]=[n,a,uF(a)]}return e}function Lf(r,e){var t=Qoe(r,e);return Gce(t)?t:void 0}var Hi=qce;(M6&&Hi(new M6(new ArrayBuffer(1)))!=dy||Jh&&Hi(new Jh)!=oy||N6&&Hi(N6.resolve())!=WU||R6&&Hi(new R6)!=cy||k6&&Hi(new k6)!=E6)&&(Hi=function(r){var e=Df.call(r),t=e==Rf?r.constructor:void 0,n=t?lc(t):void 0;if(n)switch(n){case dce:return dy;case fce:return oy;case lce:return WU;case uce:return cy;case hce:return E6}return e});function ade(r,e,t){e=yy(e,r)?[e]:dF(e);for(var n,a=-1,i=e.length;++a<i;){var s=xy(e[a]);if(!(n=r!=null&&t(r,s)))break;r=r[s]}if(n)return n;var i=r?r.length:0;return!!i&&W6(i)&&lF(s,i)&&(Hs(r)||B6(r))}function sde(r){return Hs(r)||B6(r)||!!(zU&&r&&r[zU])}function lF(r,e){return e=e??$U,!!e&&(typeof r=="number"||Goe.test(r))&&r>-1&&r%1==0&&r<e}function yy(r,e){if(Hs(r))return!1;var t=typeof r;return t=="number"||t=="symbol"||t=="boolean"||r==null||K6(r)?!0:Woe.test(r)||!Boe.test(r)||e!=null&&r in Object(e)}function ide(r){var e=typeof r;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?r!=="__proto__":r===null}function ode(r){return!!HU&&HU in r}function cde(r){var e=r&&r.constructor,t=typeof e=="function"&&e.prototype||my;return r===t}function uF(r){return r===r&&!vy(r)}function hF(r,e){return function(t){return t==null?!1:t[r]===e&&(e!==void 0||r in Object(t))}}var dde=L6(function(r){r=pde(r);var e=[];return Koe.test(r)&&e.push(""),r.replace(qoe,function(t,n,a,s){e.push(a?s.replace(Foe,"$1"):n||t)}),e});function xy(r){if(typeof r=="string"||K6(r))return r;var e=r+"";return e=="0"&&1/r==-VU?"-0":e}function lc(r){if(r!=null){try{return iF.call(r)}catch{}try{return r+""}catch{}}return""}function fde(r,e){return oF(lde(r,e),1)}function lde(r,e){var t=Hs(r)?Voe:$ce;return t(r,jce(e,3))}function L6(r,e){if(typeof r!="function"||e&&typeof e!="function")throw new TypeError(Toe);var t=function(){var n=arguments,a=e?e.apply(this,n):n[0],s=t.cache;if(s.has(a))return s.get(a);var i=r.apply(this,n);return t.cache=s.set(a,i),i};return t.cache=new(L6.Cache||zs),t}L6.Cache=zs;function pF(r,e){return r===e||r!==r&&e!==e}function B6(r){return ude(r)&&Fs.call(r,"callee")&&(!ice.call(r,"callee")||Df.call(r)==iy)}var Hs=Array.isArray;function wy(r){return r!=null&&W6(r.length)&&!mF(r)}function ude(r){return Sy(r)&&wy(r)}function mF(r){var e=vy(r)?Df.call(r):"";return e==ZU||e==Ioe}function W6(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=$U}function vy(r){var e=typeof r;return!!r&&(e=="object"||e=="function")}function Sy(r){return!!r&&typeof r=="object"}function K6(r){return typeof r=="symbol"||Sy(r)&&Df.call(r)==rF}var hde=FU?Zoe(FU):zce;function pde(r){return r==null?"":Zce(r)}function mde(r,e,t){var n=r==null?void 0:cF(r,e);return n===void 0?t:n}function gde(r,e){return r!=null&&ade(r,e,Uce)}function hy(r){return wy(r)?Lce(r):Vce(r)}function bde(r){return r}function yde(r){return yy(r)?Joe(xy(r)):Xce(r)}kf.exports=fde});var yF=D((Eje,bF)=>{d();f();var xde=gF(),wde=ry(),vde=sy(),{incrementHexInt:Sde}=Nf(),q6=class extends wde{constructor({provider:e}){super(),this.type="tx",this.provider=e}async update({oldBlock:e}){let t=e,n=Sde(e),a=await vde({provider:this.provider,fromBlock:n,toBlock:t}),s=xde(a,i=>i.transactions);this.addResults(s)}};bF.exports=q6});var H6=D((Nje,wF)=>{d();f();var _de=du().Mutex,Ade=y6(),Cde=x6(),Tde=kU(),Ide=BU(),Ede=yF(),{intToHex:xF,hexToInt:U6}=Nf();wF.exports=Pde;function Pde({blockTracker:r,provider:e}){let t=0,n={},a=new _de,s=Mde({mutex:a}),i=Cde({eth_newFilter:s(F6(c)),eth_newBlockFilter:s(F6(l)),eth_newPendingTransactionFilter:s(F6(u)),eth_uninstallFilter:s(_y(y)),eth_getFilterChanges:s(_y(h)),eth_getFilterLogs:s(_y(b))}),o=async({oldBlock:N,newBlock:M})=>{if(n.length===0)return;let L=await a.acquire();try{await Promise.all(Bf(n).map(async B=>{try{await B.update({oldBlock:N,newBlock:M})}catch(F){console.error(F)}}))}catch(B){console.error(B)}L()};return i.newLogFilter=c,i.newBlockFilter=l,i.newPendingTransactionFilter=u,i.uninstallFilter=y,i.getFilterChanges=h,i.getFilterLogs=b,i.destroy=()=>{R()},i;async function c(N){let M=new Tde({provider:e,params:N}),L=await v(M);return M}async function l(){let N=new Ide({provider:e}),M=await v(N);return N}async function u(){let N=new Ede({provider:e}),M=await v(N);return N}async function h(N){let M=U6(N),L=n[M];if(!L)throw new Error(`No filter for index "${M}"`);return L.getChangesAndClear()}async function b(N){let M=U6(N),L=n[M];if(!L)throw new Error(`No filter for index "${M}"`);return L.type==="log"?results=L.getAllResults():results=[],results}async function y(N){let M=U6(N),L=n[M],B=Boolean(L);return B&&await S(M),B}async function v(N){let M=Bf(n).length,L=await r.getLatestBlock();await N.initialize({currentBlock:L}),t++,n[t]=N,N.id=t,N.idHex=xF(t);let B=Bf(n).length;return P({prevFilterCount:M,newFilterCount:B}),t}async function S(N){let M=Bf(n).length;delete n[N];let L=Bf(n).length;P({prevFilterCount:M,newFilterCount:L})}async function R(){let N=Bf(n).length;n={},P({prevFilterCount:N,newFilterCount:0})}function P({prevFilterCount:N,newFilterCount:M}){if(N===0&&M>0){r.on("sync",o);return}if(N>0&&M===0){r.removeListener("sync",o);return}}}function F6(r){return _y(async(...e)=>{let t=await r(...e);return xF(t.id)})}function _y(r){return Ade(async(e,t)=>{let n=await r.apply(null,e.params);t.result=n})}function Mde({mutex:r}){return e=>async(t,n,a,s)=>{(await r.acquire())(),e(t,n,a,s)}}function Bf(r,e){let t=[];for(let n in r)t.push(r[n]);return t}});var _F=D((Oje,SF)=>{d();f();var Nde=Pr(),Rde=x6(),vF=y6(),kde=H6(),{unsafeRandomBytes:Ode,incrementHexInt:Dde}=Nf(),Lde=sy();SF.exports=Bde;function Bde({blockTracker:r,provider:e}){let t={},n=kde({blockTracker:r,provider:e}),a=!1,s=new Nde,i=Rde({eth_subscribe:vF(o),eth_unsubscribe:vF(c)});return i.destroy=u,{events:s,middleware:i};async function o(h,b){if(a)throw new Error("SubscriptionManager - attempting to use after destroying");let y=h.params[0],v=Ode(16),S;switch(y){case"newHeads":S=R({subId:v});break;case"logs":let N=h.params[1],M=await n.newLogFilter(N);S=P({subId:v,filter:M});break;default:throw new Error(`SubscriptionManager - unsupported subscription type "${y}"`)}t[v]=S,b.result=v;return;function R({subId:N}){let M={type:y,destroy:async()=>{r.removeListener("sync",M.update)},update:async({oldBlock:L,newBlock:B})=>{let F=B,K=Dde(L);(await Lde({provider:e,fromBlock:K,toBlock:F})).map(Wde).forEach(X=>{l(N,X)})}};return r.on("sync",M.update),M}function P({subId:N,filter:M}){return M.on("update",B=>l(N,B)),{type:y,destroy:async()=>await n.uninstallFilter(M.idHex)}}}async function c(h,b){if(a)throw new Error("SubscriptionManager - attempting to use after destroying");let y=h.params[0],v=t[y];if(!v){b.result=!1;return}delete t[y],await v.destroy(),b.result=!0}function l(h,b){s.emit("notification",{jsonrpc:"2.0",method:"eth_subscription",params:{subscription:h,result:b}})}function u(){s.removeAllListeners();for(let h in t)t[h].destroy(),delete t[h];a=!0}}function Wde(r){return{hash:r.hash,parentHash:r.parentHash,sha3Uncles:r.sha3Uncles,miner:r.miner,stateRoot:r.stateRoot,transactionsRoot:r.transactionsRoot,receiptsRoot:r.receiptsRoot,logsBloom:r.logsBloom,difficulty:r.difficulty,number:r.number,gasLimit:r.gasLimit,gasUsed:r.gasUsed,nonce:r.nonce,mixHash:r.mixHash,timestamp:r.timestamp,extraData:r.extraData}}});var CF=D((Bje,AF)=>{d();f();AF.exports=Kde;function Kde(r){return(e,t,n,a)=>{r.sendAsync(e,(s,i)=>{if(s)return a(s);Object.assign(t,i),a()})}}});var IF=D((qje,TF)=>{d();f();var qde=K$().Duplex;TF.exports=Ude;function Ude({engine:r}){if(!r)throw new Error("Missing engine parameter!");let e=new qde({objectMode:!0,read:t,write:n});return r.on&&r.on("notification",a=>{e.push(a)}),e;function t(){return!1}function n(a,s,i){r.handle(a,(o,c)=>{this.push(c)}),i()}}});var Zh=D((Hje,G6)=>{"use strict";d();f();!process.version||process.version.indexOf("v0.")===0||process.version.indexOf("v1.")===0&&process.version.indexOf("v1.8.")!==0?G6.exports=Fde:G6.exports=process.nextTick;function Fde(r,e,t,n){if(typeof r!="function")throw new TypeError('"callback" argument must be a function');var a=arguments.length,s,i;switch(a){case 0:case 1:return process.nextTick(r);case 2:return process.nextTick(function(){r.call(null,e)});case 3:return process.nextTick(function(){r.call(null,e,t)});case 4:return process.nextTick(function(){r.call(null,e,t,n)});default:for(s=new Array(a-1),i=0;i<s.length;)s[i++]=arguments[i];return process.nextTick(function(){r.apply(null,s)})}}});var PF=D((jje,EF)=>{d();f();var Hde={}.toString;EF.exports=Array.isArray||function(r){return Hde.call(r)=="[object Array]"}});var z6=D((Yje,MF)=>{d();f();MF.exports=Rc().EventEmitter});var Qh=D((j6,RF)=>{d();f();var Ay=Dp(),js=Ay.Buffer;function NF(r,e){for(var t in r)e[t]=r[t]}js.from&&js.alloc&&js.allocUnsafe&&js.allocUnsafeSlow?RF.exports=Ay:(NF(Ay,j6),j6.Buffer=Wf);function Wf(r,e,t){return js(r,e,t)}NF(js,Wf);Wf.from=function(r,e,t){if(typeof r=="number")throw new TypeError("Argument must not be a number");return js(r,e,t)};Wf.alloc=function(r,e,t){if(typeof r!="number")throw new TypeError("Argument must be a number");var n=js(r);return e!==void 0?typeof t=="string"?n.fill(e,t):n.fill(e):n.fill(0),n};Wf.allocUnsafe=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return js(r)};Wf.allocUnsafeSlow=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return Ay.SlowBuffer(r)}});var DF=D((eVe,OF)=>{"use strict";d();f();function Gde(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}var kF=Qh().Buffer;function zde(r,e,t){r.copy(e,t)}OF.exports=function(){function r(){Gde(this,r),this.head=null,this.tail=null,this.length=0}return r.prototype.push=function(t){var n={data:t,next:null};this.length>0?this.tail.next=n:this.head=n,this.tail=n,++this.length},r.prototype.unshift=function(t){var n={data:t,next:this.head};this.length===0&&(this.tail=n),this.head=n,++this.length},r.prototype.shift=function(){if(this.length!==0){var t=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},r.prototype.clear=function(){this.head=this.tail=null,this.length=0},r.prototype.join=function(t){if(this.length===0)return"";for(var n=this.head,a=""+n.data;n=n.next;)a+=t+n.data;return a},r.prototype.concat=function(t){if(this.length===0)return kF.alloc(0);if(this.length===1)return this.head.data;for(var n=kF.allocUnsafe(t>>>0),a=this.head,s=0;a;)zde(a.data,n,s),s+=a.data.length,a=a.next;return n},r}()});var V6=D((nVe,WF)=>{"use strict";d();f();var LF=Zh();function jde(r,e){var t=this,n=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;if(n||a){e?e(r):r&&(!this._writableState||!this._writableState.errorEmitted)&&LF(BF,this,r);return}this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(r||null,function(s){!e&&s?(LF(BF,t,s),t._writableState&&(t._writableState.errorEmitted=!0)):e&&e(s)})}function Vde(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function BF(r,e){r.emit("error",e)}WF.exports={destroy:jde,undestroy:Vde}});var Y6=D((iVe,jF)=>{"use strict";d();f();var uc=Zh();jF.exports=Ur;function qF(r){var e=this;this.next=null,this.entry=null,this.finish=function(){lfe(e,r)}}var $de=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:uc,Kf;Ur.WritableState=tp;var UF=Da();UF.inherits=Tr();var Yde={deprecate:k4()},FF=z6(),Ty=Qh().Buffer,Jde=globalThis.Uint8Array||function(){};function Xde(r){return Ty.from(r)}function Zde(r){return Ty.isBuffer(r)||r instanceof Jde}var HF=V6();UF.inherits(Ur,FF);function Qde(){}function tp(r,e){Kf=Kf||hc(),r=r||{},this.objectMode=!!r.objectMode,e instanceof Kf&&(this.objectMode=this.objectMode||!!r.writableObjectMode);var t=r.highWaterMark,n=this.objectMode?16:16*1024;this.highWaterMark=t||t===0?t:n,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var a=r.decodeStrings===!1;this.decodeStrings=!a,this.defaultEncoding=r.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(s){ife(e,s)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new qF(this)}tp.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t};(function(){try{Object.defineProperty(tp.prototype,"buffer",{get:Yde.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var Cy;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(Cy=Function.prototype[Symbol.hasInstance],Object.defineProperty(Ur,Symbol.hasInstance,{value:function(r){return Cy.call(this,r)?!0:r&&r._writableState instanceof tp}})):Cy=function(r){return r instanceof this};function Ur(r){if(Kf=Kf||hc(),!Cy.call(Ur,this)&&!(this instanceof Kf))return new Ur(r);this._writableState=new tp(r,this),this.writable=!0,r&&(typeof r.write=="function"&&(this._write=r.write),typeof r.writev=="function"&&(this._writev=r.writev),typeof r.destroy=="function"&&(this._destroy=r.destroy),typeof r.final=="function"&&(this._final=r.final)),FF.call(this)}Ur.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function efe(r,e){var t=new Error("write after end");r.emit("error",t),uc(e,t)}function tfe(r,e,t,n){var a=!0,s=!1;return t===null?s=new TypeError("May not write null values to stream"):typeof t!="string"&&t!==void 0&&!e.objectMode&&(s=new TypeError("Invalid non-string/buffer chunk")),s&&(r.emit("error",s),uc(n,s),a=!1),a}Ur.prototype.write=function(r,e,t){var n=this._writableState,a=!1,s=Zde(r)&&!n.objectMode;return s&&!Ty.isBuffer(r)&&(r=Xde(r)),typeof e=="function"&&(t=e,e=null),s?e="buffer":e||(e=n.defaultEncoding),typeof t!="function"&&(t=Qde),n.ended?efe(this,t):(s||tfe(this,n,r,t))&&(n.pendingcb++,a=nfe(this,n,s,r,e,t)),a};Ur.prototype.cork=function(){var r=this._writableState;r.corked++};Ur.prototype.uncork=function(){var r=this._writableState;r.corked&&(r.corked--,!r.writing&&!r.corked&&!r.finished&&!r.bufferProcessing&&r.bufferedRequest&&GF(this,r))};Ur.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this};function rfe(r,e,t){return!r.objectMode&&r.decodeStrings!==!1&&typeof e=="string"&&(e=Ty.from(e,t)),e}function nfe(r,e,t,n,a,s){if(!t){var i=rfe(e,n,a);n!==i&&(t=!0,a="buffer",n=i)}var o=e.objectMode?1:n.length;e.length+=o;var c=e.length<e.highWaterMark;if(c||(e.needDrain=!0),e.writing||e.corked){var l=e.lastBufferedRequest;e.lastBufferedRequest={chunk:n,encoding:a,isBuf:t,callback:s,next:null},l?l.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else $6(r,e,!1,o,n,a,s);return c}function $6(r,e,t,n,a,s,i){e.writelen=n,e.writecb=i,e.writing=!0,e.sync=!0,t?r._writev(a,e.onwrite):r._write(a,s,e.onwrite),e.sync=!1}function afe(r,e,t,n,a){--e.pendingcb,t?(uc(a,n),uc(ep,r,e),r._writableState.errorEmitted=!0,r.emit("error",n)):(a(n),r._writableState.errorEmitted=!0,r.emit("error",n),ep(r,e))}function sfe(r){r.writing=!1,r.writecb=null,r.length-=r.writelen,r.writelen=0}function ife(r,e){var t=r._writableState,n=t.sync,a=t.writecb;if(sfe(t),e)afe(r,t,n,e,a);else{var s=zF(t);!s&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&GF(r,t),n?$de(KF,r,t,s,a):KF(r,t,s,a)}}function KF(r,e,t,n){t||ofe(r,e),e.pendingcb--,n(),ep(r,e)}function ofe(r,e){e.length===0&&e.needDrain&&(e.needDrain=!1,r.emit("drain"))}function GF(r,e){e.bufferProcessing=!0;var t=e.bufferedRequest;if(r._writev&&t&&t.next){var n=e.bufferedRequestCount,a=new Array(n),s=e.corkedRequestsFree;s.entry=t;for(var i=0,o=!0;t;)a[i]=t,t.isBuf||(o=!1),t=t.next,i+=1;a.allBuffers=o,$6(r,e,!0,e.length,a,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new qF(e)}else{for(;t;){var c=t.chunk,l=t.encoding,u=t.callback,h=e.objectMode?1:c.length;if($6(r,e,!1,h,c,l,u),t=t.next,e.writing)break}t===null&&(e.lastBufferedRequest=null)}e.bufferedRequestCount=0,e.bufferedRequest=t,e.bufferProcessing=!1}Ur.prototype._write=function(r,e,t){t(new Error("_write() is not implemented"))};Ur.prototype._writev=null;Ur.prototype.end=function(r,e,t){var n=this._writableState;typeof r=="function"?(t=r,r=null,e=null):typeof e=="function"&&(t=e,e=null),r!=null&&this.write(r,e),n.corked&&(n.corked=1,this.uncork()),!n.ending&&!n.finished&&ffe(this,n,t)};function zF(r){return r.ending&&r.length===0&&r.bufferedRequest===null&&!r.finished&&!r.writing}function cfe(r,e){r._final(function(t){e.pendingcb--,t&&r.emit("error",t),e.prefinished=!0,r.emit("prefinish"),ep(r,e)})}function dfe(r,e){!e.prefinished&&!e.finalCalled&&(typeof r._final=="function"?(e.pendingcb++,e.finalCalled=!0,uc(cfe,r,e)):(e.prefinished=!0,r.emit("prefinish")))}function ep(r,e){var t=zF(e);return t&&(dfe(r,e),e.pendingcb===0&&(e.finished=!0,r.emit("finish"))),t}function ffe(r,e,t){e.ending=!0,ep(r,e),t&&(e.finished?uc(t):r.once("finish",t)),e.ended=!0,r.writable=!1}function lfe(r,e,t){var n=r.entry;for(r.entry=null;n;){var a=n.callback;e.pendingcb--,a(t),n=n.next}e.corkedRequestsFree?e.corkedRequestsFree.next=r:e.corkedRequestsFree=r}Object.defineProperty(Ur.prototype,"destroyed",{get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(r){!this._writableState||(this._writableState.destroyed=r)}});Ur.prototype.destroy=HF.destroy;Ur.prototype._undestroy=HF.undestroy;Ur.prototype._destroy=function(r,e){this.end(),e(r)}});var hc=D((dVe,XF)=>{"use strict";d();f();var $F=Zh(),ufe=Object.keys||function(r){var e=[];for(var t in r)e.push(t);return e};XF.exports=zi;var YF=Da();YF.inherits=Tr();var JF=X6(),J6=Y6();YF.inherits(zi,JF);var VF=ufe(J6.prototype);for(Iy=0;Iy<VF.length;Iy++)Ey=VF[Iy],zi.prototype[Ey]||(zi.prototype[Ey]=J6.prototype[Ey]);var Ey,Iy;function zi(r){if(!(this instanceof zi))return new zi(r);JF.call(this,r),J6.call(this,r),r&&r.readable===!1&&(this.readable=!1),r&&r.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,r&&r.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",hfe)}function hfe(){this.allowHalfOpen||this._writableState.ended||$F(pfe,this)}function pfe(r){r.end()}Object.defineProperty(zi.prototype,"destroyed",{get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(r){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=r,this._writableState.destroyed=r)}});zi.prototype._destroy=function(r,e){this.push(null),this.end(),$F(e,r)}});var e3=D(QF=>{"use strict";d();f();var Q6=Qh().Buffer,ZF=Q6.isEncoding||function(r){switch(r=""+r,r&&r.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function mfe(r){if(!r)return"utf8";for(var e;;)switch(r){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return r;default:if(e)return;r=(""+r).toLowerCase(),e=!0}}function gfe(r){var e=mfe(r);if(typeof e!="string"&&(Q6.isEncoding===ZF||!ZF(r)))throw new Error("Unknown encoding: "+r);return e||r}QF.StringDecoder=rp;function rp(r){this.encoding=gfe(r);var e;switch(this.encoding){case"utf16le":this.text=Sfe,this.end=_fe,e=4;break;case"utf8":this.fillLast=xfe,e=4;break;case"base64":this.text=Afe,this.end=Cfe,e=3;break;default:this.write=Tfe,this.end=Ife;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=Q6.allocUnsafe(e)}rp.prototype.write=function(r){if(r.length===0)return"";var e,t;if(this.lastNeed){if(e=this.fillLast(r),e===void 0)return"";t=this.lastNeed,this.lastNeed=0}else t=0;return t<r.length?e?e+this.text(r,t):this.text(r,t):e||""};rp.prototype.end=vfe;rp.prototype.text=wfe;rp.prototype.fillLast=function(r){if(this.lastNeed<=r.length)return r.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);r.copy(this.lastChar,this.lastTotal-this.lastNeed,0,r.length),this.lastNeed-=r.length};function Z6(r){return r<=127?0:r>>5===6?2:r>>4===14?3:r>>3===30?4:-1}function bfe(r,e,t){var n=e.length-1;if(n<t)return 0;var a=Z6(e[n]);return a>=0?(a>0&&(r.lastNeed=a-1),a):--n<t?0:(a=Z6(e[n]),a>=0?(a>0&&(r.lastNeed=a-2),a):--n<t?0:(a=Z6(e[n]),a>=0?(a>0&&(a===2?a=0:r.lastNeed=a-3),a):0))}function yfe(r,e,t){if((e[0]&192)!==128)return r.lastNeed=0,"\uFFFD".repeat(t);if(r.lastNeed>1&&e.length>1){if((e[1]&192)!==128)return r.lastNeed=1,"\uFFFD".repeat(t+1);if(r.lastNeed>2&&e.length>2&&(e[2]&192)!==128)return r.lastNeed=2,"\uFFFD".repeat(t+2)}}function xfe(r){var e=this.lastTotal-this.lastNeed,t=yfe(this,r,e);if(t!==void 0)return t;if(this.lastNeed<=r.length)return r.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);r.copy(this.lastChar,e,0,r.length),this.lastNeed-=r.length}function wfe(r,e){var t=bfe(this,r,e);if(!this.lastNeed)return r.toString("utf8",e);this.lastTotal=t;var n=r.length-(t-this.lastNeed);return r.copy(this.lastChar,0,n),r.toString("utf8",e,n)}function vfe(r){var e=r&&r.length?this.write(r):"";return this.lastNeed?e+"\uFFFD".repeat(this.lastTotal-this.lastNeed):e}function Sfe(r,e){if((r.length-e)%2===0){var t=r.toString("utf16le",e);if(t){var n=t.charCodeAt(t.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=r[r.length-2],this.lastChar[1]=r[r.length-1],t.slice(0,-1)}return t}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=r[r.length-1],r.toString("utf16le",e,r.length-1)}function _fe(r){var e=r&&r.length?this.write(r):"";if(this.lastNeed){var t=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,t)}return e}function Afe(r,e){var t=(r.length-e)%3;return t===0?r.toString("base64",e):(this.lastNeed=3-t,this.lastTotal=3,t===1?this.lastChar[0]=r[r.length-1]:(this.lastChar[0]=r[r.length-2],this.lastChar[1]=r[r.length-1]),r.toString("base64",e,r.length-t))}function Cfe(r){var e=r&&r.length?this.write(r):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function Tfe(r){return r.toString(this.encoding)}function Ife(r){return r&&r.length?this.write(r):""}});var X6=D((gVe,lH)=>{"use strict";d();f();var Uf=Zh();lH.exports=Ut;var Efe=PF(),np;Ut.ReadableState=iH;var mVe=Rc().EventEmitter,nH=function(r,e){return r.listeners(e).length},s3=z6(),ap=Qh().Buffer,Pfe=globalThis.Uint8Array||function(){};function Mfe(r){return ap.from(r)}function Nfe(r){return ap.isBuffer(r)||r instanceof Pfe}var aH=Da();aH.inherits=Tr();var t3=Bp(),He=void 0;t3&&t3.debuglog?He=t3.debuglog("stream"):He=function(){};var Rfe=DF(),sH=V6(),qf;aH.inherits(Ut,s3);var r3=["error","close","destroy","pause","resume"];function kfe(r,e,t){if(typeof r.prependListener=="function")return r.prependListener(e,t);!r._events||!r._events[e]?r.on(e,t):Efe(r._events[e])?r._events[e].unshift(t):r._events[e]=[t,r._events[e]]}function iH(r,e){np=np||hc(),r=r||{},this.objectMode=!!r.objectMode,e instanceof np&&(this.objectMode=this.objectMode||!!r.readableObjectMode);var t=r.highWaterMark,n=this.objectMode?16:16*1024;this.highWaterMark=t||t===0?t:n,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new Rfe,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=r.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,r.encoding&&(qf||(qf=e3().StringDecoder),this.decoder=new qf(r.encoding),this.encoding=r.encoding)}function Ut(r){if(np=np||hc(),!(this instanceof Ut))return new Ut(r);this._readableState=new iH(r,this),this.readable=!0,r&&(typeof r.read=="function"&&(this._read=r.read),typeof r.destroy=="function"&&(this._destroy=r.destroy)),s3.call(this)}Object.defineProperty(Ut.prototype,"destroyed",{get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(r){!this._readableState||(this._readableState.destroyed=r)}});Ut.prototype.destroy=sH.destroy;Ut.prototype._undestroy=sH.undestroy;Ut.prototype._destroy=function(r,e){this.push(null),e(r)};Ut.prototype.push=function(r,e){var t=this._readableState,n;return t.objectMode?n=!0:typeof r=="string"&&(e=e||t.defaultEncoding,e!==t.encoding&&(r=ap.from(r,e),e=""),n=!0),oH(this,r,e,!1,n)};Ut.prototype.unshift=function(r){return oH(this,r,null,!0,!1)};function oH(r,e,t,n,a){var s=r._readableState;if(e===null)s.reading=!1,Bfe(r,s);else{var i;a||(i=Ofe(s,e)),i?r.emit("error",i):s.objectMode||e&&e.length>0?(typeof e!="string"&&!s.objectMode&&Object.getPrototypeOf(e)!==ap.prototype&&(e=Mfe(e)),n?s.endEmitted?r.emit("error",new Error("stream.unshift() after end event")):n3(r,s,e,!0):s.ended?r.emit("error",new Error("stream.push() after EOF")):(s.reading=!1,s.decoder&&!t?(e=s.decoder.write(e),s.objectMode||e.length!==0?n3(r,s,e,!1):cH(r,s)):n3(r,s,e,!1))):n||(s.reading=!1)}return Dfe(s)}function n3(r,e,t,n){e.flowing&&e.length===0&&!e.sync?(r.emit("data",t),r.read(0)):(e.length+=e.objectMode?1:t.length,n?e.buffer.unshift(t):e.buffer.push(t),e.needReadable&&Py(r)),cH(r,e)}function Ofe(r,e){var t;return!Nfe(e)&&typeof e!="string"&&e!==void 0&&!r.objectMode&&(t=new TypeError("Invalid non-string/buffer chunk")),t}function Dfe(r){return!r.ended&&(r.needReadable||r.length<r.highWaterMark||r.length===0)}Ut.prototype.isPaused=function(){return this._readableState.flowing===!1};Ut.prototype.setEncoding=function(r){return qf||(qf=e3().StringDecoder),this._readableState.decoder=new qf(r),this._readableState.encoding=r,this};var eH=8388608;function Lfe(r){return r>=eH?r=eH:(r--,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r++),r}function tH(r,e){return r<=0||e.length===0&&e.ended?0:e.objectMode?1:r!==r?e.flowing&&e.length?e.buffer.head.data.length:e.length:(r>e.highWaterMark&&(e.highWaterMark=Lfe(r)),r<=e.length?r:e.ended?e.length:(e.needReadable=!0,0))}Ut.prototype.read=function(r){He("read",r),r=parseInt(r,10);var e=this._readableState,t=r;if(r!==0&&(e.emittedReadable=!1),r===0&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return He("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?a3(this):Py(this),null;if(r=tH(r,e),r===0&&e.ended)return e.length===0&&a3(this),null;var n=e.needReadable;He("need readable",n),(e.length===0||e.length-r<e.highWaterMark)&&(n=!0,He("length less than watermark",n)),e.ended||e.reading?(n=!1,He("reading or ended",n)):n&&(He("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(r=tH(t,e)));var a;return r>0?a=dH(r,e):a=null,a===null?(e.needReadable=!0,r=0):e.length-=r,e.length===0&&(e.ended||(e.needReadable=!0),t!==r&&e.ended&&a3(this)),a!==null&&this.emit("data",a),a};function Bfe(r,e){if(!e.ended){if(e.decoder){var t=e.decoder.end();t&&t.length&&(e.buffer.push(t),e.length+=e.objectMode?1:t.length)}e.ended=!0,Py(r)}}function Py(r){var e=r._readableState;e.needReadable=!1,e.emittedReadable||(He("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?Uf(rH,r):rH(r))}function rH(r){He("emit readable"),r.emit("readable"),i3(r)}function cH(r,e){e.readingMore||(e.readingMore=!0,Uf(Wfe,r,e))}function Wfe(r,e){for(var t=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(He("maybeReadMore read 0"),r.read(0),t!==e.length);)t=e.length;e.readingMore=!1}Ut.prototype._read=function(r){this.emit("error",new Error("_read() is not implemented"))};Ut.prototype.pipe=function(r,e){var t=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=r;break;case 1:n.pipes=[n.pipes,r];break;default:n.pipes.push(r);break}n.pipesCount+=1,He("pipe count=%d opts=%j",n.pipesCount,e);var a=(!e||e.end!==!1)&&r!==process.stdout&&r!==process.stderr,s=a?o:R;n.endEmitted?Uf(s):t.once("end",s),r.on("unpipe",i);function i(P,N){He("onunpipe"),P===t&&N&&N.hasUnpiped===!1&&(N.hasUnpiped=!0,u())}function o(){He("onend"),r.end()}var c=Kfe(t);r.on("drain",c);var l=!1;function u(){He("cleanup"),r.removeListener("close",v),r.removeListener("finish",S),r.removeListener("drain",c),r.removeListener("error",y),r.removeListener("unpipe",i),t.removeListener("end",o),t.removeListener("end",R),t.removeListener("data",b),l=!0,n.awaitDrain&&(!r._writableState||r._writableState.needDrain)&&c()}var h=!1;t.on("data",b);function b(P){He("ondata"),h=!1;var N=r.write(P);N===!1&&!h&&((n.pipesCount===1&&n.pipes===r||n.pipesCount>1&&fH(n.pipes,r)!==-1)&&!l&&(He("false write response, pause",t._readableState.awaitDrain),t._readableState.awaitDrain++,h=!0),t.pause())}function y(P){He("onerror",P),R(),r.removeListener("error",y),nH(r,"error")===0&&r.emit("error",P)}kfe(r,"error",y);function v(){r.removeListener("finish",S),R()}r.once("close",v);function S(){He("onfinish"),r.removeListener("close",v),R()}r.once("finish",S);function R(){He("unpipe"),t.unpipe(r)}return r.emit("pipe",t),n.flowing||(He("pipe resume"),t.resume()),r};function Kfe(r){return function(){var e=r._readableState;He("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,e.awaitDrain===0&&nH(r,"data")&&(e.flowing=!0,i3(r))}}Ut.prototype.unpipe=function(r){var e=this._readableState,t={hasUnpiped:!1};if(e.pipesCount===0)return this;if(e.pipesCount===1)return r&&r!==e.pipes?this:(r||(r=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,r&&r.emit("unpipe",this,t),this);if(!r){var n=e.pipes,a=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var s=0;s<a;s++)n[s].emit("unpipe",this,t);return this}var i=fH(e.pipes,r);return i===-1?this:(e.pipes.splice(i,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),r.emit("unpipe",this,t),this)};Ut.prototype.on=function(r,e){var t=s3.prototype.on.call(this,r,e);if(r==="data")this._readableState.flowing!==!1&&this.resume();else if(r==="readable"){var n=this._readableState;!n.endEmitted&&!n.readableListening&&(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&Py(this):Uf(qfe,this))}return t};Ut.prototype.addListener=Ut.prototype.on;function qfe(r){He("readable nexttick read 0"),r.read(0)}Ut.prototype.resume=function(){var r=this._readableState;return r.flowing||(He("resume"),r.flowing=!0,Ufe(this,r)),this};function Ufe(r,e){e.resumeScheduled||(e.resumeScheduled=!0,Uf(Ffe,r,e))}function Ffe(r,e){e.reading||(He("resume read 0"),r.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,r.emit("resume"),i3(r),e.flowing&&!e.reading&&r.read(0)}Ut.prototype.pause=function(){return He("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(He("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function i3(r){var e=r._readableState;for(He("flow",e.flowing);e.flowing&&r.read()!==null;);}Ut.prototype.wrap=function(r){var e=this._readableState,t=!1,n=this;r.on("end",function(){if(He("wrapped end"),e.decoder&&!e.ended){var i=e.decoder.end();i&&i.length&&n.push(i)}n.push(null)}),r.on("data",function(i){if(He("wrapped data"),e.decoder&&(i=e.decoder.write(i)),!(e.objectMode&&i==null)&&!(!e.objectMode&&(!i||!i.length))){var o=n.push(i);o||(t=!0,r.pause())}});for(var a in r)this[a]===void 0&&typeof r[a]=="function"&&(this[a]=function(i){return function(){return r[i].apply(r,arguments)}}(a));for(var s=0;s<r3.length;s++)r.on(r3[s],n.emit.bind(n,r3[s]));return n._read=function(i){He("wrapped _read",i),t&&(t=!1,r.resume())},n};Ut._fromList=dH;function dH(r,e){if(e.length===0)return null;var t;return e.objectMode?t=e.buffer.shift():!r||r>=e.length?(e.decoder?t=e.buffer.join(""):e.buffer.length===1?t=e.buffer.head.data:t=e.buffer.concat(e.length),e.buffer.clear()):t=Hfe(r,e.buffer,e.decoder),t}function Hfe(r,e,t){var n;return r<e.head.data.length?(n=e.head.data.slice(0,r),e.head.data=e.head.data.slice(r)):r===e.head.data.length?n=e.shift():n=t?Gfe(r,e):zfe(r,e),n}function Gfe(r,e){var t=e.head,n=1,a=t.data;for(r-=a.length;t=t.next;){var s=t.data,i=r>s.length?s.length:r;if(i===s.length?a+=s:a+=s.slice(0,r),r-=i,r===0){i===s.length?(++n,t.next?e.head=t.next:e.head=e.tail=null):(e.head=t,t.data=s.slice(i));break}++n}return e.length-=n,a}function zfe(r,e){var t=ap.allocUnsafe(r),n=e.head,a=1;for(n.data.copy(t),r-=n.data.length;n=n.next;){var s=n.data,i=r>s.length?s.length:r;if(s.copy(t,t.length-r,0,i),r-=i,r===0){i===s.length?(++a,n.next?e.head=n.next:e.head=e.tail=null):(e.head=n,n.data=s.slice(i));break}++a}return e.length-=a,t}function a3(r){var e=r._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,Uf(jfe,e,r))}function jfe(r,e){!r.endEmitted&&r.length===0&&(r.endEmitted=!0,e.readable=!1,e.emit("end"))}function fH(r,e){for(var t=0,n=r.length;t<n;t++)if(r[t]===e)return t;return-1}});var o3=D((xVe,pH)=>{"use strict";d();f();pH.exports=Vs;var My=hc(),hH=Da();hH.inherits=Tr();hH.inherits(Vs,My);function Vfe(r){this.afterTransform=function(e,t){return $fe(r,e,t)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function $fe(r,e,t){var n=r._transformState;n.transforming=!1;var a=n.writecb;if(!a)return r.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,t!=null&&r.push(t),a(e);var s=r._readableState;s.reading=!1,(s.needReadable||s.length<s.highWaterMark)&&r._read(s.highWaterMark)}function Vs(r){if(!(this instanceof Vs))return new Vs(r);My.call(this,r),this._transformState=new Vfe(this);var e=this;this._readableState.needReadable=!0,this._readableState.sync=!1,r&&(typeof r.transform=="function"&&(this._transform=r.transform),typeof r.flush=="function"&&(this._flush=r.flush)),this.once("prefinish",function(){typeof this._flush=="function"?this._flush(function(t,n){uH(e,t,n)}):uH(e)})}Vs.prototype.push=function(r,e){return this._transformState.needTransform=!1,My.prototype.push.call(this,r,e)};Vs.prototype._transform=function(r,e,t){throw new Error("_transform() is not implemented")};Vs.prototype._write=function(r,e,t){var n=this._transformState;if(n.writecb=t,n.writechunk=r,n.writeencoding=e,!n.transforming){var a=this._readableState;(n.needTransform||a.needReadable||a.length<a.highWaterMark)&&this._read(a.highWaterMark)}};Vs.prototype._read=function(r){var e=this._transformState;e.writechunk!==null&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};Vs.prototype._destroy=function(r,e){var t=this;My.prototype._destroy.call(this,r,function(n){e(n),t.emit("close")})};function uH(r,e,t){if(e)return r.emit("error",e);t!=null&&r.push(t);var n=r._writableState,a=r._transformState;if(n.length)throw new Error("Calling transform done when ws.length != 0");if(a.transforming)throw new Error("Calling transform done when still transforming");return r.push(null)}});var yH=D((SVe,bH)=>{"use strict";d();f();bH.exports=sp;var mH=o3(),gH=Da();gH.inherits=Tr();gH.inherits(sp,mH);function sp(r){if(!(this instanceof sp))return new sp(r);mH.call(this,r)}sp.prototype._transform=function(r,e,t){t(null,r)}});var c3=D((ns,xH)=>{d();f();ns=xH.exports=X6();ns.Stream=ns;ns.Readable=ns;ns.Writable=Y6();ns.Duplex=hc();ns.Transform=o3();ns.PassThrough=yH()});d();f();d();f();An();globalThis.setupSentry=async()=>await q4();globalThis.setupSentry();globalThis.sentry=Ae;globalThis.Sentry=Ae;d();f();(function(r){typeof define=="function"&&define.amd?define(r):r()})(function(){"use strict";function r(S,R){if(!(S instanceof R))throw new TypeError("Cannot call a class as a function")}function e(S,R){for(var P=0;P<R.length;P++){var N=R[P];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(S,N.key,N)}}function t(S,R,P){return R&&e(S.prototype,R),P&&e(S,P),S}function n(S,R){if(typeof R!="function"&&R!==null)throw new TypeError("Super expression must either be null or a function");S.prototype=Object.create(R&&R.prototype,{constructor:{value:S,writable:!0,configurable:!0}}),R&&s(S,R)}function a(S){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(P){return P.__proto__||Object.getPrototypeOf(P)},a(S)}function s(S,R){return s=Object.setPrototypeOf||function(N,M){return N.__proto__=M,N},s(S,R)}function i(S){if(S===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S}function o(S,R){return R&&(typeof R=="object"||typeof R=="function")?R:i(S)}function c(S,R){for(;!Object.prototype.hasOwnProperty.call(S,R)&&(S=a(S),S!==null););return S}function l(S,R,P){return typeof Reflect<"u"&&Reflect.get?l=Reflect.get:l=function(M,L,B){var F=c(M,L);if(!!F){var K=Object.getOwnPropertyDescriptor(F,L);return K.get?K.get.call(B):K.value}},l(S,R,P||S)}var u=function(){function S(){r(this,S),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return t(S,[{key:"addEventListener",value:function(P,N){P in this.listeners||(this.listeners[P]=[]),this.listeners[P].push(N)}},{key:"removeEventListener",value:function(P,N){if(P in this.listeners){for(var M=this.listeners[P],L=0,B=M.length;L<B;L++)if(M[L]===N){M.splice(L,1);return}}}},{key:"dispatchEvent",value:function(P){var N=this;if(P.type in this.listeners){for(var M=function(H){setTimeout(function(){return H.call(N,P)})},L=this.listeners[P.type],B=0,F=L.length;B<F;B++)M(L[B]);return!P.defaultPrevented}}}]),S}(),h=function(S){n(R,S);function R(){var P;return r(this,R),P=o(this,a(R).call(this)),P.listeners||u.call(i(P)),Object.defineProperty(i(P),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(i(P),"onabort",{value:null,writable:!0,configurable:!0}),P}return t(R,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(N){N.type==="abort"&&(this.aborted=!0,typeof this.onabort=="function"&&this.onabort.call(this,N)),l(a(R.prototype),"dispatchEvent",this).call(this,N)}}]),R}(u),b=function(){function S(){r(this,S),Object.defineProperty(this,"signal",{value:new h,writable:!0,configurable:!0})}return t(S,[{key:"abort",value:function(){var P;try{P=new Event("abort")}catch{typeof document<"u"?document.createEvent?(P=document.createEvent("Event"),P.initEvent("abort",!1,!1)):(P=document.createEventObject(),P.type="abort"):P={type:"abort",bubbles:!1,cancelable:!1}}this.signal.dispatchEvent(P)}},{key:"toString",value:function(){return"[object AbortController]"}}]),S}();typeof Symbol<"u"&&Symbol.toStringTag&&(b.prototype[Symbol.toStringTag]="AbortController",h.prototype[Symbol.toStringTag]="AbortSignal");function y(S){return S.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL?(console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill"),!0):typeof S.Request=="function"&&!S.Request.prototype.hasOwnProperty("signal")||!S.AbortController}function v(S){typeof S=="function"&&(S={fetch:S});var R=S,P=R.fetch,N=R.Request,M=N===void 0?P.Request:N,L=R.AbortController,B=R.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL,F=B===void 0?!1:B;if(!y({fetch:P,Request:M,AbortController:L,__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL:F}))return{fetch:P,Request:K};var K=M;(K&&!K.prototype.hasOwnProperty("signal")||F)&&(K=function(z,T){var m;T&&T.signal&&(m=T.signal,delete T.signal);var x=new M(z,T);return m&&Object.defineProperty(x,"signal",{writable:!1,enumerable:!1,configurable:!0,value:m}),x},K.prototype=M.prototype);var H=P,j=function(z,T){var m=K&&K.prototype.isPrototypeOf(z)?z.signal:T?T.signal:void 0;if(m){var x;try{x=new DOMException("Aborted","AbortError")}catch{x=new Error("Aborted"),x.name="AbortError"}if(m.aborted)return Promise.reject(x);var w=new Promise(function(I,k){m.addEventListener("abort",function(){return k(x)},{once:!0})});return T&&T.signal&&delete T.signal,Promise.race([w,H(z,T)])}return H(z,T)};return{fetch:j,Request:K}}(function(S){if(!!y(S)){if(!S.fetch){console.warn("fetch() is not available, cannot install abortcontroller-polyfill");return}var R=v(S),P=R.fetch,N=R.Request;S.fetch=P,S.Request=N,Object.defineProperty(S,"AbortController",{writable:!0,enumerable:!1,configurable:!0,value:b}),Object.defineProperty(S,"AbortSignal",{writable:!0,enumerable:!1,configurable:!0,value:h})}})(typeof self<"u"?self:globalThis)});var Op=_(Ce()),jV=_(Fr());d();f();d();f();var rE=_(Zt()),nE=_(te()),aE=_(Fr()),sE=_(QV());Tn();vx();d();f();async function cm(r){try{await(await ft.permissions_log).set(r,{clear:!0})}catch{console.log("set data failed")}}async function dm(r){return(await ft.permissions_log).query(r)}Wt();n0();Kc();a0();var Uw=_(t$());d();f();var Jn=_(Zt()),Rw=_(ni()),kI=_(ai()),OI=_(yl());Tn();An();d();f();var ya=_(Zt()),fm=_(ni()),ST=_(yl());Tn();vx();var hw={fetchConfig:{project:"okx_extension_wallet",site:"okx"}};var pw=0,z$=1,mw=null;function _T(){return r=>(hw.fetchConfig.locale=r.locale,ya.default.createElement(j4,{localeData:r.localeData,isDev:!0,noRemoteData:!0,fetchConfig:hw.fetchConfig},r.children))}var j$=_T(),V$=_T(),$$=process.env.ASSETS_BUILD_TYPE===os.DEV||process.env.ASSETS_BUILD_TYPE===os.DAILY,vT=(0,ya.createContext)(r=>`[${r}]`),Gl=r=>{let e=window.localStorage.getItem("languageKeyMode"),t=$$&&e==="multilingualMode",n=(0,fm.useSelector)(lA),a=dA(n),s=(0,fm.useSelector)(iA),i=(0,fm.useSelector)(oA),o=(0,ya.useMemo)(()=>(_o(n,window),mw=mw===pw?z$:pw,Object.keys(s).reduce((c,l)=>{let u=s[l].message;return c[l]=t?`${u}${u}${u}`:u,c},{})),[a,s,t]);return(0,ya.useMemo)(()=>{xl.setConfig({frozenScroll:!1,localeProviderProps:{fetchConfig:{noFetch:!0},isDev:!0,localeData:i}})},[n]),mw===pw?ya.default.createElement(j$,{localeData:o,locale:a},ya.default.createElement(vT.Provider,{value:Hr},r.children)):ya.default.createElement(V$,{localeData:o,locale:a},ya.default.createElement(vT.Provider,{value:Hr},r.children))};Gl.propTypes={children:ST.default.node};Gl.defaultProps={children:void 0};d();f();d();f();var Yr=_(Zt());var AT=_(V4()),gw=_(yl()),CT=_(yn());Tn();r$();Ge();un();ur();Wt();a0();var zl=class extends Yr.PureComponent{constructor(){super(...arguments);le(this,"state",{downloadUrl:!1})}renderErrorDetail(t){return Yr.default.createElement("li",null,Yr.default.createElement("p",null,t))}renderErrorStack(t,n){return Yr.default.createElement("li",null,Yr.default.createElement("span",null,t),Yr.default.createElement("pre",{className:"error-page__stack"},n))}componentDidMount(){zr(ce.getExtensionVersion).then(({data:t})=>{let n=r0(),a=CT.default.runtime.getManifest().version;if(n===w_&&t.edge!==a){this.setState({downloadUrl:"https://microsoftedge.microsoft.com/addons/detail/pbpjkcldjiffchgbbndmhojiacbgflha"});return}t.chrome!==a&&this.setState({downloadUrl:"https://chrome.google.com/webstore/detail/okx-wallet/mcohilncbfahbmgdjkbpemcciiolgcge?hl=zh-CN"})}).catch(t=>{console.log(t)})}render(){let{error:t}=this.props,{downloadUrl:n}=this.state,s=hs()===g_?Qt("wallet_home_subtitle_errortip_error_popup_message"):Qt("wallet_home_subtitle_errortip_errorpage_message"),i=J4(),o=vl.State.getImgMap(i),c=`${I8()}${o[vl.State.TYPE.systemError]}`;return Yr.default.createElement("div",{className:"error-page"},Yr.default.createElement("div",{className:"error-page__header"},Qt("wallet_home_maintitle_errortip_error_page_title"),window.location.hash&&Yr.default.createElement(kn,{className:"okx-wallet-plugin-close error-page__right",onClick:async()=>{await So().clearDappData(),window.location.href=window.location.pathname}})),Yr.default.createElement("div",{className:"error-page__details"},Yr.default.createElement(vl.State,{type:vl.State.TYPE.systemError,title:n?Qt("extension_wallet_mid_text_update_latest_version"):s,imgSrc:c,renderButton:()=>Yr.default.createElement(wl,{category:wl.CATEGORY.fill,type:wl.TYPE.primary,size:wl.SIZE.s,onClick:()=>{globalThis.platform.openTab({url:n})}},Qt("extension_wallet_mid_btn_goto_store")," ")}),Yr.default.createElement($4,{className:"error-page__accordion",titleClass:"error-page__accordion-title",customHeaderIcon:l=>Yr.default.createElement(kn,{icon:"okds-arrow-chevron-down-md",size:kn.SIZE.xs,className:(0,AT.default)("error-page__icon",{"okui-accordion-header-icon-expanded":l})}),title:Qt("wallet_home_subtitle_errortip_errordetail"),onToggle:l=>{this.setState({expand:l})}}),this.state.expand?Yr.default.createElement("ul",{className:"error-page__list"},t.message?this.renderErrorDetail(Qt("wallet_home_subtitle_errortip_errormessage",{errorMessage:t.message})):null,t.code?this.renderErrorDetail(Qt("wallet_home_subtitle_errortip_errorcode",{errorCode:t.code})):null,t.name?this.renderErrorDetail(Qt("wallet_home_subtitle_errortip_errorname",{errorName:t.name})):null,t.stack?this.renderErrorStack(Qt("wallet_home_subtitle_errortip_error_stack"),t.stack):null):null))}};zl.contextTypes={t:gw.default.func.isRequired};zl.propTypes={error:gw.default.object.isRequired};var bw=zl;d();f();var xa=_(Zt()),mi=_(ni()),PI=_(ai());var MI=_(V4()),NI=_(te());Tn();d();f();var um=_(Zt());Kc();d();f();d();f();var TT=r=>jn("allowShowComponent",{...ba,componentName:r,location:window.location.href})?.data;var yw=_(Zt()),lm=({children:r,componentName:e})=>TT(e)?yw.default.createElement(yw.default.Fragment,null,r):null;d();f();var xw={noRadius:"_noRadius_e5d59_1",scale:"_scale_e5d59_15"};var IT=()=>um.default.createElement(lm,{componentName:"EnvAlert"},um.default.createElement(Y4,{className:xw.noRadius,type:"warn",showIcon:!1,title:um.default.createElement("div",{className:xw.scale},`${process.env.ASSETS_BUILD_TYPE}-${process.env.COMMIT_HASH}, API: ${Xp()} WSS: ${u_()} STATIC: ${wo()}`),closable:!1}));d();f();var Y$={mostRecentOverviewPage:Vn},J$="history",X$=od({name:J$,initialState:Y$,reducers:{pageChanged:(r,e)=>{let t=e.payload;(t===Vn||t.startsWith(C0))&&(r.mostRecentOverviewPage=t)}}}),{actions:Z$,reducer:Q$}=X$,ET=Q$;var{pageChanged:PT}=Z$;d();f();var hm=_(Zt());var jl=_(ni());var pm=_(ai());function eY(r){return r}var MT=()=>{let r=(0,jl.useSelector)(eY),e=P8(r),t=(0,pm.useHistory)(),n=(0,jl.useSelector)(w0),a=(0,jl.useSelector)(di),s=(0,jl.useSelector)(s9),i=(0,hm.useRef)(s),c=(0,pm.useLocation)()?.pathname;return(0,hm.useEffect)(()=>{if(s!==i.current){if(n&&a&&![Vn,_0].includes(c)){let l=e.current,u={isRpcMode:n9(l)?.isRpcMode,permissionsRequestId:t9(l),isNotBackup:T8(l),lastOptType:a9(l)},h=i9(u);h&&t.replace(h)}i.current=s}},[c,s,n,a]),null};ur();vx();Wt();f9();d();f();var at=_(Zt());Cn();var Dn=_(p_());d();f();var ww={"wallet-helper":"_wallet-helper_16jpw_1",walletHelper:"_wallet-helper_16jpw_1","wallet-helper-enter":"_wallet-helper-enter_16jpw_11",walletHelperEnter:"_wallet-helper-enter_16jpw_11"};var tY=[{label:Dn.default.development_environment,value:"http://base-defi.defi.swim.env"},{label:Dn.default.pre_environment,value:"https://beta.okex.org"},{label:Dn.default.prod_environment,value:"https://wallet.okex.org"}],rY=[{label:Dn.default.normalMode,value:"normalMode"},{label:Dn.default.keyMode,value:"keyMode"},{label:Dn.default.multilingualMode,value:"multilingualMode"}],nY=()=>{let{width:r}=O8(document.querySelector("body")),[e,t]=(0,at.useState)("https://beta.okex.org");(0,at.useEffect)(()=>{(async()=>{let{envApiDomain:y}=await xe.get("envApiDomain");y&&t(y)})()},[]);let n=()=>{window.location.reload()},a=window.localStorage,s=a.getItem("languageKeyMode")||"normalMode",i=(0,at.useCallback)(y=>{y==="normalMode"?(a.removeItem("languageKeyMode"),zc(!1)):y==="keyMode"?(a.setItem("languageKeyMode",y),zc(!0)):(a.setItem("languageKeyMode",y),zc(!1)),n()},[s]),o=R8(),c=()=>{let y=L8()===S0.LIGHT?S0.DARK:S0.LIGHT;B8(y),o()},l=a.getItem("speedUp")||!1,[u,h]=(0,at.useState)(l);(0,at.useEffect)(()=>{h(l)},[l]);let b=(0,at.useCallback)(()=>{l?(a.removeItem("speedUp"),h(!1)):(a.setItem("speedUp",!0),h(!0)),chrome.runtime.reload()},[l]);return at.default.createElement(lm,{componentName:"walletHelper"},at.default.createElement(Lx.Box,{className:ww["wallet-helper"]},at.default.createElement(Sl,{description:at.default.createElement(Lx.Space,{space:"8px"},at.default.createElement(kn.IconButton,{icon:"okx-wallet-plugin-slow",tooltip:Dn.default.select_language_mode,onClick:()=>{cs.show({alignBottom:!1,noContentPadding:!0,hideCloseBtn:!0,maskClosable:!0,children:at.default.createElement(Bl,{dataSource:rY,renderItem:({label:y,value:v})=>at.default.createElement(Bl.Cell,{title:y,onClick:()=>{i(v)}},s===v&&at.default.createElement(_x.Circle,{checked:!0}))})})}}),at.default.createElement(kn.IconButton,{icon:"okx-wallet-plugin-fast",tooltip:`${Dn.default.current_api_environment}${e}`,onClick:()=>{cs.show({alignBottom:!1,noContentPadding:!0,hideCloseBtn:!0,maskClosable:!0,children:at.default.createElement(Bl,{dataSource:tY,renderItem:({label:y,value:v})=>at.default.createElement(Bl.Cell,{title:y,onClick:async()=>{await xe.set({envApiDomain:v}),n()}},e===v&&at.default.createElement(_x.Circle,{checked:!0}))})})}}),at.default.createElement(kn.IconButton,{icon:"okx-wallet-plugin-swap",tooltip:Dn.default.switchRtl,onClick:()=>{let v=document.documentElement.getAttribute("dir");v0(v==="rtl"?void 0:"rtl")}}),r>360&&at.default.createElement(kn.IconButton,{icon:"okx-wallet-plugin-switch",tooltip:Dn.default.fullscreenMode,onClick:()=>{let y=document.querySelector("#app");["notification","popup"].includes(y.className)?y.className="fullscreen":y.className="popup"}}),at.default.createElement(kn.IconButton,{style:{color:u?"orange":"unset"},icon:"okx-wallet-plugin-coin-quick-withdraw",tooltip:Dn.default.accelerateSetInterval,onClick:b}),at.default.createElement(kn.IconButton,{icon:"okx-wallet-plugin-swap-1",tooltip:Dn.default.theme,onClick:()=>{c()}})),trigger:Sl.TRIGGER.click,placement:document.documentElement.getAttribute("dir")==="rtl"?Sl.DIRECTION.topLeft:Sl.DIRECTION.topRight,autoHeight:{marginBottom:50},smartMode:!1},at.default.createElement(kn,{bordered:!0,size:kn.SIZE.lg,className:ww["wallet-helper-enter"],icon:"okx-wallet-plugin-wrenches"}))))},NT=nY;d();f();var Y=_(Zt());d();f();var OT=_(Zt()),nn=_(yl()),aY=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},sY=function(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")},iY=function(){function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),oY=function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)},cY=function(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||typeof e!="object"&&typeof e!="function"?r:e},vw=(typeof window>"u"||typeof window>"u"?"undefined":aY(window))==="object",dY=vw?document:{},fY=["mousemove","keydown","wheel","DOMMouseScroll","mouseWheel","mousedown","touchstart","touchmove","MSPointerDown","MSPointerMove"],Sw=function(r){function e(t){sY(this,e);var n=cY(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));if(n.state={idle:!1,oldDate:+new Date,lastActive:+new Date,remaining:null,pageX:null,pageY:null},n.tId=null,n._handleEvent=function(a){var s=n.state,i=s.remaining,o=s.pageX,c=s.pageY,l=s.idle,u=n.props,h=u.timeout,b=u.onAction,y=u.debounce,v=u.throttle,S=u.stopOnIdle;if(y>0?n.debouncedAction(a):v>0?n.throttledAction(a):b(a),!i){if(a.type==="mousemove"&&(a.pageX===o&&a.pageY===c||a.pageX===void 0&&a.pageY===void 0||n.getElapsedTime()<200))return;clearTimeout(n.tId),n.tId=null,l&&!S&&n.toggleIdleState(a),n.setState({lastActive:+new Date,pageX:a.pageX,pageY:a.pageY}),l&&S||(n.tId=setTimeout(n.toggleIdleState,h))}},t.debounce>0&&t.throttle>0)throw new Error("onAction can either be throttled or debounced (not both)");return t.debounce>0&&(n.debouncedAction=RT(t.onAction,t.debounce)),t.throttle>0&&(n.throttledAction=kT(t.onAction,t.throttle)),t.startOnMount||(n.state.idle=!0),n.toggleIdleState=n._toggleIdleState.bind(n),n.reset=n._reset.bind(n),n.pause=n._pause.bind(n),n.resume=n._resume.bind(n),n.getRemainingTime=n._getRemainingTime.bind(n),n.getElapsedTime=n._getElapsedTime.bind(n),n.getLastActiveTime=n._getLastActiveTime.bind(n),n.isIdle=n._isIdle.bind(n),n}return oY(e,OT.Component),iY(e,[{key:"componentWillMount",value:function(){this._bindEvents()}},{key:"componentDidMount",value:function(){this.props.startOnMount&&this.reset()}},{key:"componentDidUpdate",value:function(t){t.debounce!==this.props.debounce&&(this.debouncedAction=RT(this.props.onAction,this.props.debounce)),t.throttle!==this.props.throttle&&(this.throttledAction=kT(this.props.onAction,this.props.throttle))}},{key:"componentWillUnmount",value:function(){clearTimeout(this.tId),this._unbindEvents()}},{key:"render",value:function(){return this.props.children||null}},{key:"_bindEvents",value:function(){var t=this;if(vw){var n=this.state.eventsBound,a=this.props,s=a.element,i=a.events,o=a.passive,c=a.capture;n||(i.forEach(function(l){s.addEventListener(l,t._handleEvent,{capture:c,passive:o})}),this.setState({eventsBound:!0}))}}},{key:"_unbindEvents",value:function(){var t=this;if(vw){var n=this.props,a=n.element,s=n.events,i=n.passive,o=n.capture;this.state.eventsBound&&(s.forEach(function(c){a.removeEventListener(c,t._handleEvent,{capture:o,passive:i})}),this.setState({eventsBound:!1}))}}},{key:"_toggleIdleState",value:function(t){var n=this,a=this.state.idle,s=this.props,i=s.onActive,o=s.onIdle,c=s.stopOnIdle;this.setState({idle:!a},function(){a?c||(n._bindEvents(),i(t)):(c&&(clearTimeout(n.tId),n.tId=null,n._unbindEvents()),o(t))})}},{key:"_reset",value:function(){clearTimeout(this.tId),this.tId=null,this._bindEvents(),this.setState({idle:!1,oldDate:+new Date,lastActive:this.state.oldDate,remaining:null});var t=this.props.timeout;this.tId=setTimeout(this.toggleIdleState,t)}},{key:"_pause",value:function(){this.state.remaining===null&&(this._unbindEvents(),clearTimeout(this.tId),this.tId=null,this.setState({remaining:this.getRemainingTime()}))}},{key:"_resume",value:function(){var t=this.state,n=t.remaining,a=t.idle;n!==null&&(this._bindEvents(),a||(this.setState({remaining:null}),this.tId=setTimeout(this.toggleIdleState,n)))}},{key:"_getRemainingTime",value:function(){var t=this.state,n=t.remaining,a=t.idle,s=t.lastActive;if(a)return 0;if(n!==null)return n;var i=this.props.timeout-(+new Date-s);return i<0&&(i=0),i}},{key:"_getElapsedTime",value:function(){var t=this.state.oldDate;return+new Date-t}},{key:"_getLastActiveTime",value:function(){return this.state.lastActive}},{key:"_isIdle",value:function(){return this.state.idle}}]),e}();function RT(r,e){var t=void 0;return function(){for(var n=arguments.length,a=Array(n),s=0;s<n;s++)a[s]=arguments[s];t&&clearTimeout(t),t=setTimeout(function(){r.apply(void 0,a),t=null},e)}}function kT(r,e){var t=0;return function(){var n=new Date().getTime();if(!(n-t<e))return t=n,r.apply(void 0,arguments)}}Sw.propTypes={timeout:nn.default.number,events:nn.default.arrayOf(nn.default.string),onIdle:nn.default.func,onActive:nn.default.func,onAction:nn.default.func,debounce:nn.default.number,throttle:nn.default.number,element:nn.default.oneOfType([nn.default.object,nn.default.element]),startOnMount:nn.default.bool,stopOnIdle:nn.default.bool,passive:nn.default.bool,capture:nn.default.bool},Sw.defaultProps={timeout:12e5,element:dY,events:fY,onIdle:function(){},onActive:function(){},onAction:function(){},debounce:0,throttle:0,startOnMount:!0,stopOnIdle:!1,capture:!0,passive:!0};var DT=Sw;var Yn=_(ai());d();f();var it=_(Zt()),Jl=_(ni()),Oo=_(ai()),Tw=_(yl()),Iw=_(yn());Tn();An();d();f();var LT=(r,e)=>{if(e&&e.includes("{")&&!e.includes("first")){let n=/\{(.+?)\}/gi,a={};return e.match(n).forEach((s,i)=>{let o=s.replace("{","").replace("}","");a[`${o}`]=r[i]}),a}let t=["first","second","third","fourth"];return r.filter((n,a)=>a in t).reduce((n,a,s)=>(n[t[s]]=a,n),{})};d();f();var BT=()=>{let r=jn("lockPage",{...ba,location:window.location.href});return r?r.data:null};d();f();var WT=_(Zt());Cn();var KT=()=>{let r=jn("changeLocalStorage",{...ba,location:window.location.href});(0,WT.useEffect)(()=>{r&&(r?.data?.windowLocalStorage&&Object.keys(r?.data.windowLocalStorage).forEach(e=>{window.localStorage.setItem(e,r?.data?.windowLocalStorage[e])}),r?.data?.localStorage&&Object.keys(r?.data.localStorage).forEach(e=>{e==="data"||e==="apiDomain"||e==="envApiDomain"||e==="staticDomain"||xe.set({[e]:r?.data?.localStorage[e]})}))},[r])};d();f();var qT=_(Zt());var UT=()=>{let r=jn("resetExtension",{...ba,location:window.location.href});return(0,qT.useMemo)(()=>{if(r){if(!r.data?.needReload)return!1;let t=window.localStorage.getItem("extensionReload");return!t||t!=r?.data.time?r.data.time:!1}return!1},[r])};d();f();var FT=_(Zt());Kc();var HT=()=>{let r=jn("staticDomain");(0,FT.useEffect)(()=>{window.okGlobal||(window.okGlobal={}),r?(window.okGlobal.cdnBaseUrl=`https://${wo()}`,window.okGlobal.cdnDomainMap=r.data):(window.okGlobal.cdnBaseUrl=`https://${wo()}`,window.okGlobal.cdnDomainMap={default:"https://static.okx.com",CN:"https://static.coinall.ltd",RU:"https://static.okx.cab",ID:"https://static.okx.cab"})},[r])};d();f();var GT=_(Zt());var zT=()=>{let r=jn("versionExtensionUpdate",{...ba,location:window.location.href});return(0,GT.useMemo)(()=>{if(r){if(!r.data?.needUpdate)return!1;let t=window.localStorage.getItem("versionExtensionUpdate");if(t&&t===r?.data.version&&!r.data?.repeat)return!1;if(ba.version!==r.data.version)return{version:r?.data.version,repeat:r.data?.repeat}}return!1},[r])};d();f();var jT=[];d();f();var Vl=_(Zt()),VT=_(ai());function _w(r){let[e,t]=(0,Vl.useState)(!1);return e?Vl.default.createElement(VT.Route,{...r}):Vl.default.createElement(k9,{guard:!0,callback:()=>{t(!0)}})}d();f();var $l=_(Zt()),ZT=_(ni());var mm=_(Aw()),QT=_(D9()),e7=_(N$());ur();Wt();var Cw=300,t7=()=>{let r=T9(),e=(0,ZT.useDispatch)(),t=H9(r),n=G9(),a=(0,$l.useRef)({}),s=(0,$l.useRef)({}),{data:i,set:o}=W9(O0.coinTickers),c=z9();(0,$l.useEffect)(()=>{e(L9(c))},[e,c]);let l=N=>{o({...i,...N})},u=kl(async N=>{let M=(0,mm.default)(N,Cw),L=[];try{(await Promise.all(M.map(K=>{let H={coinIds:K},j={headers:{currency:"usd"}};return Pe(ce.postMarketUrl,H,j)})))?.forEach(K=>{Array.isArray(K?.data)&&(L=L.concat(K.data))})}catch{(0,QT.default)()}let B=L.reduce((F,K)=>(K?.coinId&&(F[K.coinId]={coinToUSDRate:K?.currencyAmount,coinPriceChangePercent24h:K?.priceChangePercent24h}),F),{});l(B)}),{needFetchCoinIds:h,needFetchData:b}=E8(()=>{if(t.length||n.length){let N=t.concat(n).filter(B=>Boolean(B?.coinId));return(0,e7.default)(N,"coinId").reduce((B,F)=>(B.needFetchCoinIds.push(F.coinId),B.needFetchData.push({coinId:F.coinId,baseCoinId:F?.baseCoinId,chainIndex:F?.chainId,tokenAddress:F?.address}),B),{needFetchCoinIds:[],needFetchData:[]})}return{needFetchCoinIds:[],needFetchData:[]}},[t,n]),y=kl(N=>{if(!N?.length)return;let M=N.reduce((K,H)=>{let{coinId:j,baseCoinId:X,chainIndex:z,tokenAddress:T}=H,m="";return X===0?m=`${z}`:m=`${z}-${T}`,K[j]=m,K},{}),L=[],B=Object.entries(M).reduce((K,[H,j])=>(a.current[H]||(a.current[H]=j,L.push(H),K.push({channel:k0,instId:j})),K),[]);(0,mm.default)(B,Cw).forEach(K=>{Mo.sendChannel({op:"subscribe",args:K})}),L.length&&u(L)}),{run:v}=Fx(y,{wait:200}),{run:S}=Fx(()=>{l(s.current)},{wait:1e3}),R=kl(()=>{u(Object.keys(a.current))}),P=kl(N=>{if(!N||!Array.isArray(N?.data))return;let{data:M}=N;M[0]?.coinId&&(s.current[M[0]?.coinId]={coinToUSDRate:M[0]?.price,coinPriceChangePercent24h:M[0]?.priceChangePercent24h},S())});Ka(k0,{onError:R,onSuccess:P,pollingInterval:30*1e3}),k8(()=>{v(b)},[h]),M8(()=>{let N=Object.values(a.current).map(L=>({channel:k0,instId:L}));(0,mm.default)(N,Cw).forEach(L=>{Mo.sendChannel({op:"unsubscribe",args:L})}),a.current={}})};d();f();var Yl=_(Zt());Tn();var yY=20,gm=[];function r7(){let r=Ka("dex-across-order-info");(0,Yl.useEffect)(()=>{if(!r?.data)return;let{dexData:e,type:t}=r.data,{status:n,type:a,orderId:s,fromAmount:i,fromTokenSymbol:o,toAmount:c,toTokenSymbol:l,solanaToast:u,exploreUrl:h,fromChildOrder:b={}}=e,y=null;if(a==="gasStation"){if(n==="0"?y={type:"success",titleKey:"swaptrade_extension_feedback_toast_transaction_submitted",id:`toast-${s}-${n}`}:n==="-1"?y={type:"error",titleKey:"swaptrade_extension_feedback_toast_fillup_gas_failed",titleParams:{nativeToken:l},id:`toast-${s}-${n}`}:n==="1"&&(y={type:"success",titleKey:"swaptrade_extension_feedback_toast_swapped_successfully",titleParams:{payValue:i,paySymbol:o,receiveValue:j9(c,{fixed:6,wipeTailZero:!0}),receiveSymbol:l},id:`toast-${s}-${n}`}),!y)return;In[y.type]({title:Qt(y.titleKey,y.titleParams),key:y.id})}if(t==="1"&&e&&a==="approve"){if(n==="1"?y={type:"success",titleKey:"swaptrade_extension_notif_desc_token_approved",titleParams:{tokenSymbol:o},url:h,id:`toast-${n}-${s}`}:n==="-1"?y={type:"error",titleKey:"swaptrade_extension_notif_desc_token_not_approved",titleParams:{tokenSymbol:o},url:h,id:`toast-${n}-${s}`}:u==="1"&&(y={type:"success",titleKey:"swaptrade_extension_notif_desc_transaction_submit",id:`toast-${u}`}),!y)return;In[y.type]({title:Qt(y.titleKey,y.titleParams),key:y.id,desc:y.url?Yl.default.createElement(Wl,{url:y.url,urlText:Qt("wallet_transfer_notif_view_on_explorer")}):null})}if((t==="1"||t==="3")&&e&&a!=="approve"&&a!=="register"&&a!=="gasStation"){let v=`${s}_${n}`;if(gm.includes(v))return;let S=()=>{gm.unshift(v),gm=gm.slice(0,yY)},R=b?.receiveTokenStatus!=="3";if(n==="0"&&b?.status=="0"?(S(),y={type:"success",titleKey:"swaptrade_extension_notif_desc_transaction_submit",id:`toast-${n}-${s}`}):n==="1"&&R?(S(),y={type:"success",titleKey:"swaptrade_extension_notif_desc_swap_info",titleParams:{fromTokenAmount:i,fromTokenSymbol:o,toTokenAmount:c,toTokenSymbol:l},url:h,id:`toast-${n}-${s}`}):n==="-1"&&R?(S(),y={type:"error",titleKey:"swaptrade_extension_notif_desc_swap_fail",url:h,id:`toast-${n}-${s}`}):n==="-2"&&R&&(S(),y={type:"success",titleKey:"swaptrade_extension_notif_desc_swap_canceled",url:h,id:`toast-${n}-${s}`}),!y)return;In[y.type]({title:Qt(y.titleKey,y.titleParams),key:y.id,desc:y.url?Yl.default.createElement(Wl,{url:y.url,urlText:Qt("wallet_transfer_notif_view_on_explorer")}):null})}},[r])}d();f();var n7=_(Zt());Tn();function a7(){let r=Ka("wallet-nft");(0,n7.useEffect)(()=>{!r||In.success({title:Qt("wallet_transfer_notif_nft_transaction_success"),key:"toast8"})},[r])}d();f();var Pd={link:"_link_1p29i_1",updateCotainer:"_updateCotainer_1p29i_9",centerImage:"_centerImage_1p29i_12",titleUpdate:"_titleUpdate_1p29i_21",textUpdate:"_textUpdate_1p29i_25",updateMb32:"_updateMb32_1p29i_30"};function xY({walletId:r,keyringIdentities:e}){let t;return e.find(n=>(t=n.walletIdentities.find(a=>a.walletId===r),t)),t?[...new Set(Object.values(t.account))]:[]}function se(r){let{guard:e}=r,t=(0,Jl.useSelector)(w0),n=(0,Jl.useSelector)(di),a=(0,Jl.useSelector)(v8),s=(0,Jl.useSelector)(S8),i=Ka("login"),o=Ka("wallet-tx-status-toast"),c=Ka("nft-operate"),l=(0,Oo.useHistory)(),[u,h]=(0,it.useState)(null),b=I9();(0,it.useEffect)(()=>{if(b){let{initialType:B}=b,{path:F}=r;if(p9()&&xs(B)&&!jT.includes(F)){let{location:K}=r||{},{pathname:H,search:j=""}=K||{};setTimeout(()=>{globalThis.platform.openExtensionInPopup(H+j||"")},200)}}},[b?.initialType]);let y=BT(),v=UT(),S=zT();HT(),KT(),(0,it.useEffect)(()=>{v&&cs.warn({alignBottom:!1,title:Hr("wallet_extension_home_popup_title_update_now"),text:Hr("wallet_extension_home_popup_text_update_now"),confirmText:Hr("wallet_extension_home_popup_btn_update"),maskClosable:!1,onConfirm:()=>{window.localStorage.setItem("extensionReload",v),Iw.default.runtime.reload()}})},[v]);let[R,P]=(0,it.useState)(!1),[N]=(0,it.useState)(Iw.default.runtime.getManifest().version),M=C9(),L=W8({dark:"/cdn/assets/imgs/246/F624BDAD9E2C018D.png",light:"/cdn/assets/imgs/246/234578340DAE2A80.png"});return(0,it.useEffect)(()=>{N!==S.version&&!R&&S&&cs.action({mobileWidth:"77.777%",noTopRadius:!1,alignBottom:!1,hideCloseBtn:!0,children:it.default.createElement("div",{className:Pd.updateMb32},it.default.createElement("div",{className:Pd.centerImage},it.default.createElement("img",{src:L,alt:"update"})),it.default.createElement("div",{className:Pd.titleUpdate},Hr("wallet_extension_home_popup_title_update_available")),it.default.createElement("div",{className:Pd.textUpdate},Hr("wallet_extension_home_popup_text_update_available")),it.default.createElement(Sx,{size:Sx.SIZE.sm,className:Pd.link,onClick:()=>{globalThis.platform.openTab({url:`https://${M}/help/how-do-i-update-my-okx-wallet-extension-on-google-chrome`})}},Hr("wallet_extension_home_popup_link_update_available"))),confirmText:Hr("wallet_extension_home_popup_text_ok"),maskClosable:!1,onConfirm:B=>{S.repeat?P(!0):window.localStorage.setItem("versionExtensionUpdate",S.version),B.destroy()}})},[R,S,N]),(0,it.useEffect)(()=>{y&&cs.warn({alignBottom:!1,maskClosable:!1,title:Hr("wallet_extension_clearcache_modaltitle_step_locked"),text:Hr("wallet_extension_clearcache_modaldesc_step_locked"),confirmText:Hr("wallet_extension_btn_general_gotit"),onConfirm:B=>{B.destroy(),l.go(-1)}})},[y]),(0,it.useEffect)(()=>{if(t&&n){u&&Array.isArray(u)&&Mo.sendChannel({op:"logout",args:u});let F=xY({walletId:a,keyringIdentities:s}).map(K=>({token:K}));Mo.sendChannel({op:"login",args:F}),h(F)}},[t,n,a]),(0,it.useEffect)(()=>{if(c){let{scene:B,status:F}=c.data;B===21&&F===2&&In.success({title:Hr("extension_home_toast_receivecompleted")})}},[c]),(0,it.useEffect)(()=>{if(i){let B=Object.keys(Kl).map(F=>({channel:Kl[F]}));Mo.sendChannel({op:"subscribe",args:B})}},[i]),(0,it.useEffect)(()=>{let F=l.location.pathname.match(E0);if(o&&!F){let{data:K}=o,{pushToastCode:H,pushToastParams:j=[],txStatus:X,url:z}=K,T;H===20||H===21?T={amount:j[0],crypto:j[1]}:H===23?T={num:j[0],symbol:j[1]}:T=LT(j),In[P9[X]]({title:Hr(M9[H],T),desc:z?it.default.createElement(Wl,{url:z,urlText:Hr("wallet_transfer_notif_view_on_explorer")}):null})}},[o]),(0,it.useEffect)(()=>{let B=new PerformanceObserver(F=>{let K={};F.getEntries().forEach(H=>{K[H.name]=H.startTime}),performance.memory&&(K.memory={totalJSHeapSize:performance.memory?.totalJSHeapSize,usedJSHeapSize:performance.memory?.usedJSHeapSize,jsHeapSizeLimit:performance.memory?.jsHeapSizeLimit}),K["first-contentful-paint"]>1e3&&Ae.captureEvent({message:`PERFORMANCE_WARN_1s ${l.location.pathname}`,contexts:{report:{info:JSON.stringify(K)}},exception:{values:[{type:`PERFORMANCE_WARN_1s ${l.location.pathname}`,value:"Performance Data"}]},level:"info"})});return B.observe({type:"paint",buffered:!0}),()=>{B.disconnect()}},[l.location.pathname]),r7(),a7(),t7(),t?n?e?it.default.createElement(_w,{...r}):it.default.createElement(Oo.Route,{...r}):it.default.createElement(Oo.Redirect,{to:{pathname:hd}}):it.default.createElement(Oo.Redirect,{to:{pathname:A0}})}se.propTypes={isUnlocked:Tw.default.bool.isRequired,completedOnboarding:Tw.default.bool.isRequired};d();f();var Ew=_(Zt()),s7=_(ni()),bm=_(ai());function ym(r){return(0,s7.useSelector)(di)?Ew.default.createElement(bm.Route,{...r}):Ew.default.createElement(bm.Redirect,{to:{pathname:hd}})}d();f();var Pw=_(Zt()),i7=_(ni()),xm=_(ai());function Xl(r){return(0,i7.useSelector)(di)?Pw.default.createElement(xm.Redirect,{to:{pathname:Vn}}):Pw.default.createElement(xm.Route,{...r})}d();f();var Z=_(Zt()),o7=(0,Z.lazy)(()=>import("./dex-K4DLOJLO.js")),c7=(0,Z.lazy)(()=>import("./new-home-page-LPLZ6Y3W.js")),d7=(0,Z.lazy)(()=>import("./wallet-aggregate-NDLLPBWF.js")),f7=(0,Z.lazy)(()=>import("./new-home-page-LPLZ6Y3W.js")),l7=(0,Z.lazy)(()=>import("./ConnectHardware-6RMMWLRC.js")),Mw=(0,Z.lazy)(()=>import("./ImportSeedPhraseAndPrivateKey-I3T3BTPT.js")),Nw=(0,Z.lazy)(()=>import("./WalletMnemonicBackup-A44FINWB.js")),u7=(0,Z.lazy)(()=>import("./WalletMnemonicBackupLandingPage-QJMUJSXY.js")),h7=(0,Z.lazy)(()=>import("./WalletList-7MJKAMED.js")),p7=(0,Z.lazy)(()=>import("./WalletEdit-FGRKPXAM.js")),m7=(0,Z.lazy)(()=>import("./WalletBackUp-PTJOKZA4.js")),g7=(0,Z.lazy)(()=>import("./WalletAccountAddress-4TG5XB3A.js")),b7=(0,Z.lazy)(()=>import("./WalletAccountPrivateKey-HDWCBVEY.js")),y7=(0,Z.lazy)(()=>import("./WalletMnemonicAndPrivateKey-NU5G5PV2.js")),x7=(0,Z.lazy)(()=>import("./LedgerNetworkManage-NVF53RVQ.js")),w7=(0,Z.lazy)(()=>import("./WalletDetail-AUXB4DRD.js")),v7=(0,Z.lazy)(()=>import("./WalletAccountDetail-JYVSLYXJ.js")),S7=(0,Z.lazy)(()=>import("./CreatePassword-Y4BJ3PH4.js")),_7=(0,Z.lazy)(()=>import("./VerifyPassword-TIHILA7W.js")),A7=(0,Z.lazy)(()=>import("./Onboard-QMHVZO6Q.js")),C7=(0,Z.lazy)(()=>import("./InitialCreate-S4KG53O3.js")),T7=(0,Z.lazy)(()=>import("./InitialImport-RIMIG75M.js")),I7=(0,Z.lazy)(()=>import("./wallet-add-page-WMTZLCNR.js")),E7=(0,Z.lazy)(()=>import("./walletAddImport-U6E7XBAF.js")),P7=(0,Z.lazy)(()=>import("./Login-GF3TPTKX.js")),M7=(0,Z.lazy)(()=>import("./Import-4KNYXCUT.js")),N7=(0,Z.lazy)(()=>import("./show-supported-chains-LQZTP74H.js")),R7=(0,Z.lazy)(()=>import("./Unlock-ALNKK3S6.js")),k7=(0,Z.lazy)(()=>import("./Receive-Z4VPEH5W.js")),O7=(0,Z.lazy)(()=>import("./Lock-UES5CLTE.js")),D7=(0,Z.lazy)(()=>import("./ForgetPassword-MOIPGLWK.js")),L7=(0,Z.lazy)(()=>import("./ResetPassword-PBEOKCPL.js")),B7=(0,Z.lazy)(()=>import("./select-network-PE4JJRUF.js")),W7=(0,Z.lazy)(()=>import("./select-coin-6TSIPJ4B.js")),K7=(0,Z.lazy)(()=>import("./SelectNetwork-5TFJ3LXJ.js")),q7=(0,Z.lazy)(()=>import("./SelectProtocol-UBUN7SXI.js")),U7=(0,Z.lazy)(()=>import("./SendNft-GYALOGUF.js")),F7=(0,Z.lazy)(()=>import("./SendPageContainer-AHLMU5WK.js")),H7=(0,Z.lazy)(()=>import("./CoinManage-5HUUJJIE.js")),G7=(0,Z.lazy)(()=>import("./CustomCrypto-53OROD6Z.js")),z7=(0,Z.lazy)(()=>import("./Setting-2BO3SGRE.js")),j7=(0,Z.lazy)(()=>import("./Preference-52W26XXS.js")),V7=(0,Z.lazy)(()=>import("./WalletSafely-IGGCBTBH.js")),$7=(0,Z.lazy)(()=>import("./SafetyLevel-PRSBEGKG.js")),Y7=(0,Z.lazy)(()=>import("./DefaultWallet-AECH4ZRC.js")),J7=(0,Z.lazy)(()=>import("./SwitchRandomPassword-ICMMTFZD.js")),X7=(0,Z.lazy)(()=>import("./AboutWallet-PP2PXQAV.js")),Z7=(0,Z.lazy)(()=>import("./WalletHistory-5EQ2H26O.js")),Q7=(0,Z.lazy)(()=>import("./Selector-522K5YAI.js")),eI=(0,Z.lazy)(()=>import("./RpcMode-KUW3DOBA.js")),tI=(0,Z.lazy)(()=>import("./DappEntry-5FAPG74Z.js")),rI=(0,Z.lazy)(()=>import("./NetworkManagement-DVQMAZ7Z.js")),nI=(0,Z.lazy)(()=>import("./Form-LWREFT4B.js")),aI=(0,Z.lazy)(()=>import("./PermissionsConnect-5VVJ4GLI.js")),sI=(0,Z.lazy)(()=>import("./Detail-QKBRZTZI.js")),iI=(0,Z.lazy)(()=>import("./NftFilter-TBRD3KIU.js")),oI=(0,Z.lazy)(()=>import("./DAppNetworkManage-XJ552RX2.js")),cI=(0,Z.lazy)(()=>import("./CoinDetail-TZKZG7UK.js")),dI=(0,Z.lazy)(()=>import("./address-PSFN32D4.js")),fI=(0,Z.lazy)(()=>import("./Aptos-3FNOURXJ.js")),lI=(0,Z.lazy)(()=>import("./ZKSpace-CXBNTML3.js")),uI=(0,Z.lazy)(()=>import("./ZKSyncLite-EFFLZU6L.js")),hI=(0,Z.lazy)(()=>import("./Starknet-YR3ASZUG.js")),pI=(0,Z.lazy)(()=>import("./CreateAccount-X4TAI5KT.js")),mI=(0,Z.lazy)(()=>import("./ConfirmPay-HK6UGNLI.js")),gI=(0,Z.lazy)(()=>import("./rpc-mode-PQFJOHIQ.js")),bI=(0,Z.lazy)(()=>import("./BatchTransfer-OV5CYSSS.js")),yI=(0,Z.lazy)(()=>import("./Bitcoin-5OFVFRX6.js")),xI=(0,Z.lazy)(()=>import("./BatchAddAccount-6LHHHPSC.js")),wI=(0,Z.lazy)(()=>import("./BulkRename-ENNW4HGY.js")),vI=(0,Z.lazy)(()=>import("./Edit-U676CTUW.js")),SI=(0,Z.lazy)(()=>import("./Confirm-4DDN32WV.js")),_I=(0,Z.lazy)(()=>import("./ManageUtxo-KUX3EZXC.js")),AI=(0,Z.lazy)(()=>import("./CoinInfo-YBYNPC4Z.js")),CI=(0,Z.lazy)(()=>import("./DownloadAddresses-OFMALDU7.js")),TI=(0,Z.lazy)(()=>import("./GasTracker-KUHKRO7P.js")),II=(0,Z.lazy)(()=>import("./Advanced-6DVQ7C2C.js"));var EI=({autoLockTimeLimit:r,setLastActiveTime:e})=>{let t=Y.default.createElement(Y.Suspense,null,Y.default.createElement(Yn.Switch,null,Y.default.createElement(Yn.Route,{path:V8,component:l7}),Y.default.createElement(se,{path:vC,component:Mw,exact:!0}),Y.default.createElement(Yn.Route,{path:jC,component:vI,exact:!0}),Y.default.createElement(Yn.Route,{path:VC,component:SI,exact:!0}),Y.default.createElement(se,{path:NC,guard:!0,component:Nw,exact:!0}),Y.default.createElement(se,{path:RC,component:Nw,exact:!0}),Y.default.createElement(se,{path:kC,component:u7,exact:!0}),Y.default.createElement(se,{path:AC,component:h7,exact:!0}),Y.default.createElement(se,{path:CC,component:p7,exact:!0}),Y.default.createElement(se,{path:cC,component:m7,exact:!0}),Y.default.createElement(se,{path:MC,guard:!0,component:y7,exact:!0}),Y.default.createElement(Yn.Route,{path:tC,component:S7,exact:!0}),Y.default.createElement(se,{path:rC,component:_7}),Y.default.createElement(Xl,{path:nC,component:Mw,exact:!0}),Y.default.createElement(Yn.Route,{path:`${aC}/:type`,component:N7}),Y.default.createElement(se,{path:TC,component:w7}),Y.default.createElement(se,{path:OC,component:x7}),Y.default.createElement(se,{path:IC,component:v7}),Y.default.createElement(se,{path:EC,component:g7}),Y.default.createElement(se,{path:PC,guard:!0,component:b7}),Y.default.createElement(Yn.Route,{path:P0,component:d7}),Y.default.createElement(se,{path:J8,component:k7,exact:!0}),Y.default.createElement(Yn.Route,{path:q8,component:O7,exact:!0}),Y.default.createElement(Xl,{path:hd,component:A7}),Y.default.createElement(Xl,{path:eC,component:C7,exact:!0}),Y.default.createElement(Xl,{path:Q8,component:T7,exact:!0}),Y.default.createElement(se,{path:SC,component:I7,exact:!0}),Y.default.createElement(se,{path:_C,component:E7,exact:!0}),Y.default.createElement(Yn.Route,{path:JC,component:P7,exact:!0}),Y.default.createElement(Yn.Route,{path:M0,component:M7,exact:!0}),Y.default.createElement(ym,{path:A0,exact:!0,component:R7}),Y.default.createElement(ym,{path:X8,component:D7}),Y.default.createElement(se,{path:Z8,component:L7}),Y.default.createElement(se,{path:HC,component:gI}),Y.default.createElement(se,{path:GC,component:bI}),Y.default.createElement(se,{path:zC,component:xI}),Y.default.createElement(se,{path:$C,component:wI}),Y.default.createElement(se,{path:j8,component:q7}),Y.default.createElement(se,{path:z8,component:K7}),Y.default.createElement(se,{path:wC,component:B7}),Y.default.createElement(se,{path:xC,component:W7}),Y.default.createElement(se,{path:`${F8}/:nftPath`,component:U7,exact:!0}),Y.default.createElement(se,{path:`${U8}/:coinId?`,component:F7}),Y.default.createElement(se,{path:sC,component:H7}),Y.default.createElement(se,{path:iC,component:G7}),Y.default.createElement(se,{path:oC,component:z7}),Y.default.createElement(se,{path:dC,component:j7}),Y.default.createElement(se,{path:fC,component:V7}),Y.default.createElement(se,{path:lC,component:$7}),Y.default.createElement(se,{path:uC,component:Y7}),Y.default.createElement(se,{path:mC,component:J7}),Y.default.createElement(se,{path:hC,component:X7}),Y.default.createElement(se,{path:DC,component:Z7,exact:!0}),Y.default.createElement(se,{path:pC,component:Q7}),Y.default.createElement(se,{path:T0,component:eI}),Y.default.createElement(se,{path:I0,component:tI}),Y.default.createElement(se,{path:gC,component:rI}),Y.default.createElement(se,{path:bC,component:nI}),Y.default.createElement(se,{path:`${H8}/:id`,component:aI}),Y.default.createElement(se,{path:`${$8}`,component:sI,exact:!0}),Y.default.createElement(se,{path:Y8,component:iI,exact:!0}),Y.default.createElement(se,{path:`${G8}`,component:oI}),Y.default.createElement(se,{path:C0,component:cI,exact:!0}),Y.default.createElement(se,{path:XC,component:AI}),Y.default.createElement(se,{path:ZC,component:CI}),Y.default.createElement(se,{path:LC,component:dI}),Y.default.createElement(se,{path:BC,component:fI}),Y.default.createElement(se,{path:WC,component:lI}),Y.default.createElement(se,{path:KC,component:uI}),Y.default.createElement(se,{path:qC,component:hI}),Y.default.createElement(se,{path:UC,component:pI}),Y.default.createElement(se,{path:FC,component:mI}),Y.default.createElement(se,{path:yC,component:yI}),Y.default.createElement(se,{path:_0,component:f7}),Y.default.createElement(se,{path:E0},Y.default.createElement(Y.Suspense,{fallback:Y.default.createElement(_9,null)},Y.default.createElement(o7,null))),Y.default.createElement(se,{path:YC,component:_I}),Y.default.createElement(se,{path:QC,component:TI}),Y.default.createElement(se,{path:e9,component:II}),Y.default.createElement(se,{path:Vn,component:c7})));return r>0?Y.default.createElement(DT,{onAction:e,throttle:1e3},t):t};In.config({duration:3,top:10,left:16,right:16,maxCount:3,placement:In.DIRECTION.top,isInline:!0});var RI=()=>{let r=(0,PI.useHistory)(),e=(0,mi.useDispatch)(),t=(0,mi.useSelector)(y=>y.appState.isLoading),{os:n,browser:a}=(0,mi.useSelector)(y=>y.metamask.browserEnvironment)||{},{autoLockTimeLimit:s=0}=(0,mi.useSelector)(A8),i=(0,mi.useSelector)(C8),o=(0,mi.useSelector)(_8)?.isoCode||"usd",c=process.env.ASSETS_BUILD_TYPE===os.DEV||process.env.ASSETS_BUILD_TYPE===os.DAILY,l=()=>{r.listen((y,v)=>{v==="PUSH"&&PT(y.pathname)})},u=()=>{o||e(v9("usd"))},h=()=>{e(d9())},b=()=>{zr(ce.getCheckCountryLimit).then(y=>{try{let{data:{web3:{limit:v,displayCountryName:S}}}=y;v&&cs.warn({maskClosable:!1,renderFooter:()=>xa.default.createElement("div",null),alignBottom:!1,title:Qt("wallet_extension_login_title_access_restricted"),text:Qt("wallet_extension_login_toast_unavailable_inyourregion",{area:S})})}catch{In.error({title:Qt("wallet_home_toast_network_error")})}}).catch(NI.noop)};return N8(()=>{l(),K8(),v0(i),u(),b()}),xa.default.createElement(xa.default.Fragment,null,xa.default.createElement("div",{className:(0,MI.default)("app-content",{[`os-${n}`]:n,[`browser-${a}`]:a})},xa.default.createElement(IT,null),xa.default.createElement(MT,null),xa.default.createElement("div",{className:"main-container-wrapper"},t&&xa.default.createElement(S9,null),xa.default.createElement(EI,{autoLockTimeLimit:s,setLastActiveTime:h}))),!!c&&xa.default.createElement(NT,null))};d();f();var wm=class extends Jn.PureComponent{constructor(){super(...arguments);le(this,"state",{})}static getDerivedStateFromError(t){return{error:t}}componentDidCatch(t){Ae.captureException(t)}render(){let{error:t}=this.state,{store:n}=this.props;return t?Jn.default.createElement(Rw.Provider,{store:n},Jn.default.createElement(Gl,null,Jn.default.createElement(bw,{error:t}))):Jn.default.createElement(Rw.Provider,{store:n},Jn.default.createElement(kI.HashRouter,null,Jn.default.createElement(Gl,null,Jn.default.createElement(H4,{options:Z4},Jn.default.createElement(G4,null,Jn.default.createElement(RI,null))))))}};wm.propTypes={store:OI.default.object.isRequired};var DI=wm;f9();d();f();var vm=_(F_());d();f();a0();An();d();f();function Md(r){return typeof r=="string"?r:typeof r>"u"?"Undefined error":r instanceof DOMException?`Error Name: ${r.name}, Message: ${r.message}, Code: ${r.code}`:`Error Object: ${JSON.stringify(r,["message","arguments","type","name"])}`}var wY=od({name:"balanceSlice",initialState:{balanceMap:{}},reducers:{setBalance:(r,e)=>{r.balanceMap=e.payload}}}),{actions:vY,reducer:SY}=wY;function LI(r){Ae.captureEvent({message:"STORE_WARN_indexeddb_error",exception:{values:[{type:"STORE_WARN_indexeddb_error",value:r}]},level:"error"})}var BI=()=>async r=>{(await ft.balance).liveQuery().subscribe((t,n)=>{if(n)LI(`subscribe balance error, ${Md(n)}`),So().fallbackBalancesData();else{if(!t||t.filter?.(s=>!s).length>0){LI(`subscribe balance null, ${JSON.stringify(t)}`),So().fallbackBalancesData();return}let a=t.reduce((s,i)=>(s[i.walletId]=i,s),{});r(vY.setBalance(a))}})},WI=SY;d();f();a0();An();var _Y=od({name:"coins",initialState:{coinsMap:{},ready:!1},reducers:{updateCoinsMap(r,e){r.coinsMap=e.payload,r.ready=!0}}}),{actions:AY,reducer:CY}=_Y,{updateCoinsMap:TY}=AY;var KI=()=>async r=>{(await ft.common_coins).liveQuery().subscribe(async(t,n)=>{if(n)Ae.captureEvent({message:"STORE_WARN_indexeddb_error",exception:{values:[{type:"STORE_WARN_indexeddb_error",value:`subscribe coins error, ${Md(n)}`}]},level:"error"}),So().fallbackAllCoinsMap();else{t.sort((s,i)=>s.rank-i.rank);let a=t.reduce((s,i)=>(s[String(i.coinId)]=i,s),{});r(TY(a))}})},qI=CY;d();f();var zI=_(F_());d();f();var IY="SET_ACTIVE_TAB";function kw(r={},e){let t={...r};switch(e.type){case IY:return e.value;default:return t}}d();f();g$();function Ow(r={},e){let t={shouldClose:!1,modal:{open:!1,modalState:{name:null,props:{}},previousModalState:{name:null}},sidebar:{transitionName:"",type:"",props:{}},accountDetail:{subview:"transactions"},isLoading:!1,warning:null,requestAccountTabs:{},currentWindowTab:{},showSupportedChainsFlag:!1,...r};switch(e.type){case G_:return{...t,forgottenPassword:e.value};case V_:return{...t,warning:null};case H_:return{...t,accountDetail:{subview:"transactions",accountExport:"none",privateKey:""},warning:null};case J_:return{...t,isLoading:!1,warning:null,scrollToBottom:!1,forgottenPassword:!1};case X_:return{...t,txId:e.id,warning:null,isLoading:!1};case Z_:return e.value.unconfirmedActionsCount>0?{...t,txId:null,warning:null}:{...t,shouldClose:!0,warning:null,txId:null,accountDetail:{subview:"transactions"}};case Q_:return{...t};case z_:return{...t,warning:e.value||"Incorrect password. Try again."};case j_:return{...t,warning:""};case eA:return{...t,isLoading:!0,loadingMessage:e.value};case tA:return{...t,isLoading:!1};case $_:return{...t,warning:e.value,isLoading:!1};case Y_:return{...t,warning:void 0};case rA:return{...t,requestAccountTabs:e.value};case nA:return{...t,currentWindowTab:e.value};case aA:return{...t,showSupportedChainsFlag:e.value};default:return t}}d();f();d();f();var UI={[hT]:pT};d();f();var FI={[rT]:nT,[d5]:f5,[sT]:iT,[gT]:bT};var HI={...UI,...FI};d();f();var EY="metamask/send/OPEN_TO_DROPDOWN",PY="metamask/send/CLOSE_TO_DROPDOWN",MY="metamask/send/UPDATE_SEND_ERRORS",NY="metamask/send/RESET_SEND_STATE",RY="metamask/send/SHOW_GAS_BUTTON_GROUP",kY="metamask/send/HIDE_GAS_BUTTON_GROUP",GI={toDropdownOpen:!1,gasButtonGroupShown:!0,errors:{}};function Dw(r=GI,e){switch(e.type){case EY:return{...r,toDropdownOpen:!0};case PY:return{...r,toDropdownOpen:!1};case MY:return{...r,errors:{...r.errors,...e.value}};case RY:return{...r,gasButtonGroupShown:!0};case kY:return{...r,gasButtonGroupShown:!1};case NY:return{...GI};default:return r}}d();f();var jI=(0,zI.combineReducers)({activeTab:kw,metamask:fA,appState:Ow,history:ET,send:Dw,nftSend:j5,newDapp:s5,localeMessages:sA,importAccount:X5,coinDetail:G5,txHistory:$5,balanceSlice:WI,currencySlice:B9,networksSlice:QA,providerSlice:w8,coins:qI,assetsSlice:o5,Nft:q5,addressBookState:mT,batchTransfer:yT,batchAddAccount:xT,batchImportPrivateKey:Z5,bulkRename:wT,commonSend:$x,walletConfig:r9,businessSend:iw,wallet:J5,...HI,activityBanners:H5});function Lw(r){return(0,vm.createStore)(jI,r,(0,vm.applyMiddleware)(XA))}var VI=()=>r=>{r(ZA()),r(x8()),r(KI()),r(BI()),r(Y5()),r(i5())};d();f();An();var $I=!1;function OY(r,e){$I=!0;try{Ae.captureEvent({message:`selectedWalletError: ${r}`,contexts:{report:{info:JSON.stringify({...e,selectedWallet:typeof r>"u"?"undefined":r})}},exception:{values:[{type:"BIZ_ERROR_selectedWalletError",value:r}]},level:"error"})}catch{}}function YI(r){if(!r||$I||!r.isUnlocked||!r.completedOnboarding)return;let{selectedWallet:e,keyringIdentities:t,wallets:n}=r,a=!1,s=[],i=[],o;if(typeof e!="string"||!e)a=!0;else{t&&Array.isArray(t)&&(s=t.reduce((l,u)=>(l.push(...(u?.walletIdentities??[]).map(h=>h.walletId)),l),[])),n&&Array.isArray(n)&&(i=n.map(l=>l.walletId)),s.sort(),i.sort();let c=Math.max(s.length,i.length);for(let l=0;l<c;l++)if(s[l]!==i[l]){a=!0;break}!a&&(s.findIndex(l=>l===e)===-1||i.findIndex(l=>l===e)===-1)&&(a=!0)}a&&(o=(t??[]).map(c=>({initialType:c.initialType,walletIdentities:(c.walletIdentities??[]).map(l=>({walletId:l.walletId,account:l.account,initialType:l.initialType,accountsMap:Object.keys(l.accountsMap??{}).reduce((u,h)=>{let b=l.accountsMap[h]??{};return u[h]=Object.keys(b).reduce((y,v)=>(y[v]={address:b[v]?.address,addressType:b[v]?.addressType},y),{}),u},{})}))})),OY(e,{wallets:(n??[]).map(c=>({initialType:c.initialType,walletId:c.walletId,addressType:c.addressType,segwitAddressType:c.segwitAddressType})),keyringIdentities:o}))}d();f();if((process.env.ASSETS_BUILD_TYPE==="dev"||process.env.ASSETS_BUILD_TYPE==="daily"||process.env.ASSETS_BUILD_TYPE==="prepub")&&localStorage.getItem("speedUp")){let e=window.setInterval;window.setInterval=function(t,n,...a){let s=n>=1e3?n/100:n;return e(t,s,...a)}}d();f();var JI=_(ql());Cn();var XI=async()=>{try{let{authMap:r}=await xe.get("authMap"),{data:e}=await xe.get("data"),t=(0,JI.default)(e,"TransactionController.transactions");return{authMap:r,evmTransactions:t}}catch{return{}}};d();f();Ge();un();d();f();var Nd=window.history,DY=Nd.pushState,LY=Nd.replaceState,Bw=new Event("locationChange");Nd.pushState=(...r)=>{let e=DY.apply(Nd,r);return window.dispatchEvent(Bw),e};Nd.replaceState=(...r)=>{let e=LY.apply(Nd,r);return window.dispatchEvent(Bw),e};window.addEventListener("popstate",()=>{window.dispatchEvent(Bw)});function Ww(r=""){return r.replace(/^#/,"")}function ZI(r){window.addEventListener("locationChange",()=>{r(Ww(window.location.hash))})}d();f();var BY=[/^(\/wallet-add\/import-with-seed-phrase-and-private-key)/,/^(\/batch-import-private-key\/edit)/,/^(\/wallet\/mnemonic\/backup)/,/^(\/wallet\/mnemonic-privateKey)/,/^(\/wallet\/account\/privateKey)/,/^(\/reset-password)/];function Sm(r,e=BY){for(let n=0;n<e.length;n++){let a=e[n];if(typeof a=="string"&&r.endsWith(a)||typeof a!="string"&&a.test(r))return!0}return!1}function WY(){let r=hs();return r===b_?1:r===y_?2:r===x_?3:0}var eE=WY(),Kw="lastPageDetentionTimeParams",tE=ko(),gi,As,qw="";async function KY(){let r=window.localStorage.getItem(Kw);if(window.localStorage.removeItem(Kw),r)try{await Gx(JSON.parse(r))}catch{console.log("Failed to report last page detention time")}let e=window.location.hash;e&&e!==Vn&&(gi=new Date,As=Ww(e))}function QI(){if(!gi||!As||!Sm(As))return;let r=new Date,e={s:tE,u:As,r:qw,d:r.getTime()-gi.getTime(),p:eE,e:gi.toLocaleString(),l:r.toLocaleString()};window.localStorage.setItem(Kw,JSON.stringify(e))}function qY(r){if(r===Vn)return;let e=new Date;As&&gi&&Sm(As)&&Gx({s:tE,u:As,r:qw,d:e.getTime()-gi.getTime(),p:eE,e:gi.toLocaleString(),l:e.toLocaleString()}),gi=e,qw=As||"",As=r}ZI(qY),KY(),window.addEventListener("beforeunload",QI),window.onblur=QI;X4.config({top:16});Up.config({returnString:!0,isConvertToZero:!0,exponentialAt:[-40,40]});xl.setConfig({Dialog:{maskClosable:!0,getContainer:()=>document.querySelector(".main-container-wrapper")},Drawer:{getContainer:()=>document.querySelector(".main-container-wrapper")},[xl.componentNames.Select]:{bottomSafeSpace:0}});if(process.env.ASSETS_BUILD_TYPE===os.DEV||process.env.ASSETS_BUILD_TYPE===os.DAILY){let r=window.localStorage.getItem("languageKeyMode");zc(r==="keyMode")}aE.default.setLevel(process.env.ASSETS_BUILD_TYPE==="dev"||process.env.ASSETS_BUILD_TYPE==="daily"?"debug":"warn");function UY(r){window.getCleanAppState=function(){let e=(0,nE.clone)(r.getState());return e.version=globalThis.platform.getVersion(),e.browser=window.navigator.userAgent,e}}var FY=async()=>Promise.allSettled([B5(),r5()]);async function HY({metamaskState:r},e,t){await Zp.setUrlFromLocalAsync(),await Jp.setUrlFromLocalAsync(),await FY();let n={},a={},s={};if(r.currentLocale){let u=await Promise.allSettled([Ba(r.currentLocale),Ba(r.currentLocale,Uw.LOCALE_TYPE.okd),Ba(r.currentLocale,Uw.LOCALE_TYPE.dex)]);n=u[0].value,a=u[1].value,s=u[2].value}let o={...{activeTab:t.activeTab,metamask:r,appState:{},localeMessages:{current:n,okdCurrent:a,dexCurrent:s}}},c=Lw(o);return e.on("update",u=>{!u||(setTimeout(()=>{YI(u)},300),c.dispatch(o9(u)))}),e.on("partialUpdate",u=>{!u||c.dispatch(c9(u))}),c.dispatch(VI()),(0,sE.createRoot)(t.container).render(rE.default.createElement(DI,{store:c})),r.currentLocale&&I_(r.currentLocale),c}function Fw(r,e){let{backgroundConnection:t,controller:n}=r;E_(t),Qp(t.refreshHttpDNS),t.getStateByDomain((a,s)=>{if(a){e(a);return}let{currentLocale:i}=s;Tl(i),HY({metamaskState:s},n,r).then(o=>{UY(o),e(null,o)}).catch(()=>{})})}window.logStateString=async function(r){let e=window.getCleanAppState();try{let t=await globalThis.platform.getPlatformInfo();e.platform=t;try{e.permissionsLog=await dm(),e.log=await Q4()}catch{e.permissionsLog=[],e.log=[]}let n=await XI();Object.keys(n).forEach(s=>{e[s]=n[s]});let a=JSON.stringify(e,null,2);r(null,a)}catch(t){r(t)}};un();d();f();var hx=_(Ne()),qV=_(f$()),UV=_(xP()),FV=_(Jx()),HV=_(yn());d();f();var wP=_(Qr());R_(B_,wP.register);Ge();ae();d();f();Be();d();f();var vP=_(s0()),Lm=_(Qr());ae();ne();async function je(r,e){try{let n=me({localType:r})?.coinType;return await(0,Lm.calcTxHash)(n,{data:e})}catch{throw new Error(n5(r,e))}}async function vX(r,e,t=""){let n=!1;try{n=(await(0,Lm.validAddress)(e,{address:r,cosmosPrefix:t})).isValid}catch{return n}return n}async function SP(r,e=pe){let n=me({localType:e})?.coinType;return{isValid:await vX(r,n)}}function SX(r,e){for(let t of Reflect.ownKeys(e))if(t!=="constructor"&&t!=="prototype"&&t!=="name"){let n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n)}}function Bm(r,e){let t=r.prototype;for(let n of e)SX(t,n.prototype);return r}async function cu(r=""){try{return await new vP.TonWallet().validateMnemonicOfTon({mnemonicArray:r.split(" "),password:""})}catch(e){return console.log("error:",e),!1}}d();f();var wU=_(du()),g6=_(te());d();f();var _P=_(Pr()),fu=class extends _P.default{constructor(e){super(),this.updateStructure(e)}updateStructure(e){this.config=e,this.dirtyFields=new Set,this.removeAllListeners();for(let t in e)Object.prototype.hasOwnProperty.call(e,t)&&e[t].subscribe(()=>{this.dirtyFields.add(t),this.emit("partialStoreUpdate")})}subscribe(e){return this.on("partialStoreUpdate",e)}getFlatState(){let e={};for(let t in this.config)if(Object.prototype.hasOwnProperty.call(this.config,t)){let n=this.config[t],a=n.getState?n.getState():n.state;e={...e,...a}}return e}flushDirtyFields(){let e={};if(this.dirtyFields.size===0)return null;for(let t of this.dirtyFields){let n=this.config[t],a=n.getState?n.getState():n.state;e={...e,...a}}return this.dirtyFields.clear(),e}};Wt();Kc();d();f();Be();var BM=_(Ne());var WM=_(LM());var Bv=class extends ge{constructor(t){super();le(this,"privateSetIsAddingAccount",(t=!1)=>{this.memStore.updateState({isAddingAccount:t})});this.keyringController=t.keyringController,this.walletCreateController=t.walletCreateController,this.preferencesController=t.preferencesController,this.coinController=t.coinController,this.balanceController=t.balanceController,this.memStore=new BM.ObservableStore({isAddingAccount:!1})}async addNewAccounts(t,n=1){let a=await this.keyringController.addNewWallets(t,n);if(a?.length<=0)return[];let s=this.preferencesController.getWalletIdentityByWalletId(t)?.serverWalletType??yr.UNKNOWN,i=a.map(o=>o.walletId);try{await this.walletCreateController.createWalletsToServer(i,s)}catch(o){console.error(o)}return i.forEach((0,WM.default)(this.coinController.initAddedCoins)),a.map(o=>this.preferencesController.pushAnyWalletIdentity(t,{...o,serverWalletType:s}))}startAddAccount(){this.privateSetIsAddingAccount(!0)}finishAddAccount(){this.privateSetIsAddingAccount(!1)}},KM=Bv;d();f();d();f();var qM=_(Pr()),UM=_(Ne());Ge();var Wv=class extends qM.default{constructor(e){super(),e=e||{};let t={addressBookList:[],recentlyAddresses:{},...e?.initState||{}};this.store=new UM.ObservableStore(t)}addAddressBook(e){let t=this.store.getState().addressBookList;if(t.length>=200)throw Error(Q9);return e.id=Me(),e.createTime=+new Date,e.updateTime=e.createTime,this.store.updateState({addressBookList:[e,...t]}),e}updateAddressBook(e,t){let n=this.store.getState().addressBookList,a=n.findIndex(i=>i.id===e);if(a===-1)return;let[s]=n.splice(a,1);this.store.updateState({addressBookList:[{...s,updateTime:+new Date,...t},...n]})}removeAddressBook(e){let t,n=this.store.getState().addressBookList,a=n.findIndex(s=>s.id===e);return a!==-1&&(t=n.splice(a,1)[0],this.store.updateState({addressBookList:n})),t}addRecentlyAddress(e,{type:t,name:n,address:a}){let s=this.store.getState().recentlyAddresses,i=s[e]||[],o=t||p0.DIRECT,c=i.findIndex(({name:l,type:u,address:h})=>a===h?o!==p0.ENS&&u!==p0.ENS||o===u&&n===l:!1);c!==-1&&i.splice(c,1),i.unshift({name:n,type:o,address:a}),i.length=Math.min(i.length,3),this.store.updateState({recentlyAddresses:{...s,[e]:i}})}},Kv=Wv;d();f();Be();var FM=_(Ne()),HM=_(yn());d();f();var nr="updateBadge";var hu=class extends Ir{constructor(e={}){let{addUnlockListener:t,isUnlocked:n,initState:a,onInactiveTimeout:s,showUnlockRequest:i,preferencesStore:o}=e;super(),this.onInactiveTimeout=s||(()=>{}),this.store=new FM.ObservableStore({timeoutMinutes:0,browserEnvironment:{},...a}),this.timer=null,this.isUnlocked=n,this.waitingForUnlock=[],t(this.handleUnlock.bind(this)),this.showUnlockRequest=i,o.subscribe(({preferences:l})=>{this.store.getState().timeoutMinutes!==l.autoLockTimeLimit&&this.setInactiveTimeout(l.autoLockTimeLimit)});let{preferences:c}=o.getState();this.setInactiveTimeout(c.autoLockTimeLimit)}getUnlockPromise(e){return new Promise(t=>{this.isUnlocked()?t():this.waitForUnlock(t,e)})}waitForUnlock(e,t){this.waitingForUnlock.push({resolve:e}),this.emit(nr),t&&this.showUnlockRequest()}handleUnlock(){if(this.waitingForUnlock.length>0){for(;this.waitingForUnlock.length>0;)this.waitingForUnlock.shift().resolve();this.emit(nr)}}setLastActiveTime(){this.resetTimer()}setInactiveTimeout(e){this.store.updateState({timeoutMinutes:e}),this.resetTimer()}resetTimer(){let{timeoutMinutes:e}=this.store.getState();this.timer&&clearTimeout(this.timer),e&&(this.timer=setTimeout(()=>this.onInactiveTimeout(),e*60*1e3))}setBrowserEnvironment(e,t){let n=!!HM.default.action;this.store.updateState({browserEnvironment:{os:e,browser:t,isManifestV3:n}},!1)}};d();f();var jM=_(Uv()),Fv=_(Ce());d();f();var Bo=class{constructor(e={},t={}){this.context={},this.defaultConfig={},this.defaultState={},this.disabled=!1,this.name="BaseController",this.requiredControllers=[],this.internalConfig=this.defaultConfig,this.internalState=this.defaultState,this.internalListeners=[],this.initialState=t,this.initialConfig=e}initialize(){return this.internalState=this.defaultState,this.internalConfig=this.defaultConfig,this.configure(this.initialConfig),this.update(this.initialState),this}get config(){return this.internalConfig}get state(){return this.internalState}configure(e,t=!1,n=!0){if(n){this.internalConfig=t?e:Object.assign(this.internalConfig,e);for(let a in this.internalConfig)typeof this.internalConfig[a]<"u"&&(this[a]=this.internalConfig[a])}else for(let a in e)typeof this.internalConfig[a]<"u"&&(this.internalConfig[a]=e[a],this[a]=e[a])}notify(){this.disabled||this.internalListeners.forEach(e=>{e(this.internalState)})}onComposed(){this.requiredControllers.forEach(e=>{if(!this.context[e])throw new Error(`${this.name} must be composed with ${e}.`)})}subscribe(e){this.internalListeners.push(e)}unsubscribe(e){let t=this.internalListeners.findIndex(n=>e===n);return t>-1&&this.internalListeners.splice(t,1),t>-1}update(e,t=!1){this.internalState=t?{...e}:{...this.internalState,...e},this.notify()}};var yi="pendingApprovals",zm="pendingApprovalCount",zM={[yi]:{},[zm]:0},pu=class extends Bo{constructor(e,t){let{showApprovalRequest:n}=e;if(typeof n!="function")throw new Error("Must specify function showApprovalRequest.");super(e,t||zM),this._approvals=new Map,this._origins=new Map,this._showApprovalRequest=n,this.initialize()}addAndShowApprovalRequest(e){let t=this._add(e.origin,e.type,e.id,e.requestData);return this._showApprovalRequest(),t}add(e){return this._add(e.origin,e.type,e.id,e.requestData)}get(e){let t=this.state[yi][e];return t?{...t}:void 0}getApprovalCount(e={}){let t,n;if(!e.origin&&!e.type)throw new Error("Must specify origin, type, or both.");let{origin:a,type:s}=e;if(a&&s)return Number(Boolean((t=this._origins.get(a))===null||t===void 0?void 0:t.has(s)));if(a)return((n=this._origins.get(a))===null||n===void 0?void 0:n.size)||0;let i=0;for(let o of Object.values(this.state[yi]))o.type===s&&(i+=1);return i}getTotalApprovalCount(){return this.state[zm]}has(e={}){let t,{id:n,origin:a,type:s}=e;if(n){if(typeof n!="string")throw new Error("May not specify non-string id.");return this._approvals.has(n)}if(a){if(typeof a!="string")throw new Error("May not specify non-string origin.");return s&&typeof s=="string"?Boolean((t=this._origins.get(a))===null||t===void 0?void 0:t.has(s)):this._origins.has(a)}if(s){if(typeof s!="string")throw new Error("May not specify non-string type.");for(let i of Object.values(this.state[yi]))if(i.type===s)return!0;return!1}throw new Error("Must specify non-empty string id, origin, or type.")}resolve(e,t){this._deleteApprovalAndGetCallbacks(e).resolve(t)}reject(e,t){this._deleteApprovalAndGetCallbacks(e).reject(t)}clear(){let e=Fv.ethErrors.rpc.resourceUnavailable("The request was rejected; please try again.");for(let t of this._approvals.keys())this.reject(t,e);this._origins.clear(),this.update(zM,!0)}_add(e,t,n=(0,jM.default)(),a){return this._validateAddParams(n,e,t,a),new Promise((s,i)=>{this._approvals.set(n,{resolve:s,reject:i}),this._addPendingApprovalOrigin(e,t),this._addToStore(n,e,t,a)})}_validateAddParams(e,t,n,a){let s=null;if(!e||typeof e!="string"?s="Must specify non-empty string id.":this._approvals.has(e)?s=`Approval with id '${e}' already exists.`:!t||typeof t!="string"?s="Must specify non-empty string origin.":!n||typeof n!="string"?s="Must specify non-empty string type.":a&&(typeof a!="object"||Array.isArray(a))&&(s="Request data must be a plain object if specified."),s)throw Fv.ethErrors.rpc.internal(s)}_addPendingApprovalOrigin(e,t){let n=this._origins.get(e)||new Set;n.add(t),this._origins.has(e)||this._origins.set(e,n)}_addToStore(e,t,n,a){let s={id:e,origin:t,type:n,time:Date.now()};a&&(s.requestData=a);let i={...this.state[yi],[e]:s};this.update({[yi]:i,[zm]:this._origins.size},!0)}_delete(e){this._approvals.delete(e);let t=this.state[yi],{origin:n,type:a}=t[e];this._origins.get(n)?.delete(a),this._isEmptyOrigin(n)&&this._origins.delete(n);let s={...t};delete s[e],this.update({[yi]:s,[zm]:this._origins.size},!0)}_deleteApprovalAndGetCallbacks(e){let t=this._approvals.get(e);if(!t)throw new Error(`Approval with id '${e}' not found.`);return this._delete(e),t}_isEmptyOrigin(e){let t;return!(!((t=this._origins.get(e))===null||t===void 0)&&t.size)}};d();f();Be();var WN=_(rg()),_u=_(Gn()),b1=_(g9()),KN=_(du());Cn();var qN=_(te()),y1=class extends ge{constructor(e={}){super(),this.commonCreateRequestHeaders={platform:"plugin",product:"okex"},this.authMap=e.authMap||{},this.mutex=new KN.Mutex}getAuthMap(){return this.authMap}async setAuthMap(e){await xe.set({authMap:e}),this.authMap=e}async removeAuthKeyByWalletId(e){let t=await this.mutex.acquire();try{let n=this.getAuthMap(),a=(0,qN.clone)(n);delete a[e],await this.setAuthMap(a)}finally{t()}}async clearAuthMap(){let e=await this.mutex.acquire();try{await this.setAuthMap({})}finally{e()}}async getPubKeyByWalletId(e){let t=await this.mutex.acquire();try{let n=this.getAuthMap(),a=n[e];a||(a=WN.default.generate().getPrivateKey().toString("hex"),await this.setAuthMap({...n,[e]:a}));let s=(0,_u.stripHexPrefix)(a),i=p.Buffer.from(s,"hex");return b1.ECPair.fromPrivateKey(i).publicKey.toString("hex")}finally{t()}}signParams(e,t){if(!Ar(e)||typeof t!="string")throw new Error("signParams: invalid params");let a=this.getAuthMap()[t];if(!a)throw new Error("signParams: can not find auth key with walletId");let{currency:s,platform:i,product:o,timestamp:c,body:l}=e,u=`currency=${s}&key-id=${e["key-id"]}&platform=${i}&product=${o}&timestamp=${c}${l?`&body=${JSON.stringify(l)}`:""}`,h=p.Buffer.from(u),b=(0,_u.sha256)(h),y=(0,_u.stripHexPrefix)(a),v=p.Buffer.from(y,"hex");return b1.ECPair.fromPrivateKey(v).sign(b).toString("hex")}getRequestHeaders({walletId:e,needSign:t,currency:n,body:a}={}){let s={...this.commonCreateRequestHeaders,timestamp:Date.now()};if(e&&(s={...s,"key-id":e}),n&&(s={...s,currency:n}),t&&e&&n){let i=this.signParams({...s,body:a},e);s={...s,sign:i}}return s}getSignRequestHeaders({walletId:e,currency:t="usd"}){return this.getRequestHeaders({walletId:e,currency:t,needSign:!0})}},UN=y1;d();f();var JN=_(Ne()),fg=_(te()),XN=_(Pr());d();f();Hn();function x1(r){let e=r.reduce((t,n)=>{let{chainId:a,currencyAmountUSD:s}=n;return t.has(a)?t.set(a,Fn(t.get(a),s)):t.set(a,s),t},new Map);return Array.from(e).map(([t,n])=>({chainId:t,currencyAmountUSD:n}))}d();f();function FN({balanceCoins:r,coinsMap:e,flatten:t=!1}){let n=[];return r.forEach(a=>{if(a.childrenCoin){let s=a.childrenCoin.map(i=>({...i,...e.get(i.coinId)}));t?n.push(...s):n.push({...a,...e.get(a.coinId),childrenCoin:s})}else n.push({...a,childrenCoin:void 0,...e.get(a.coinId)})}),n}ae();d();f();ur();d();f();async function HN(r){return!Array.isArray(r)||r.length===0?!1:(await ft.assets).set(r)}async function GN(){return(await ft.assets).clear()}async function zN(r){return(await ft.assets).delete(r)}d();f();async function jN(r){return!Array.isArray(r)||r.length===0?!1:(await ft.balance).set(r,{clear:!0})}async function cg(){return(await ft.balance).clear()}async function VN(r){return(await ft.balance).delete(r)}Wt();d();f();Tn();var w1;async function $N(){return w1||(w1=await z4.init({project:"okex_wallet"})),w1}async function YN(r,e){return(await $N()).set(r,e)}async function dg(r){return(await $N()).get(r)}Hn();var dte="usd",fte=50;function lte(r,e,t){let{coinAmount:n,currencyAmount:a,coinAmountOrigin:s,...i}=r,o=e.get(r.coinId),c=t?.[r.coinId]?.coinToUSDRate;return{...i,coinAmount:n,coinAmountInt:s,currencyAmountUSD:c?Nn(n,c):a,baseCoinId:o.baseCoinId}}var Au=class extends XN.default{constructor({keyringController:t,preferencesController:n,authController:a,coinController:s,networkController:i,serverPushController:o,currencyController:c,isUnlocked:l,walletCreateController:u,initState:h}){super();le(this,"getBalanceIfSelectedDebounce",(0,fg.debounce)(this.getBalanceIfSelected,500,{maxWait:1e3}));this.memStore=new JN.ObservableStore({isFirstFetchMapCache:h?.isFirstFetchMapCache||{}}),this.fallbackBalance=!1,this.balancesMap={},this.autoRefreshInterval=null,this.preferencesController=n,this.authController=a,this.coinController=s,this.keyringController=t,this.networkController=i,this.currencyController=c,this.serverPushController=o,this.isUnlocked=l,this.walletCreateController=u,this.init(),this.pendingAllBalance=!1}init(){this.coinController.on("needUpdateCoinsFromServer",()=>{this.getCurrentWalletBalance()}),this.autoRefresh()}fallbackBalancesData(){this.fallbackBalance=!0,this.memStore.updateState({balancesMap:this.balancesMap})}async setWalletBalance(t){t.forEach(n=>{this.balancesMap[n.walletId]=n});try{this.fallbackBalance&&this.memStore.updateState({balancesMap:this.balancesMap}),await jN(t)}catch{this.fallbackBalancesData()}}async autoRefresh(){this.clear(),await this.isUnlocked()&&(this.autoRefreshInterval=setInterval(async()=>{this.getAllWalletsBalance()},18e4))}async getBalanceIfSelected(t){this.preferencesController.getSelectedWallet()===t&&await this.getCurrentWalletBalance()}async getWalletsCoinBalance({walletIds:t,chainId:n,coinId:a}){let s=await this.getWalletsBalance({walletIds:t,chainId:n});return s?.length?s.map(i=>{let{coins:o,balanceData:c,walletId:l}=i,u=c?.coins??[],h=[];return u.forEach(b=>{if(b.childrenCoin){let y=[];b.childrenCoin.forEach(v=>{v.coinId===+a&&y.push(v)}),y.length>0&&(Object.assign(b,{...y[0],childrenCoin:y}),b.coinAmountInt=y.reduce((v,S)=>Fn(v,S.coinAmountInt),"0"),b.coinAmount=y.reduce((v,S)=>Fn(v,S.coinAmount),"0"),b.currencyAmountUSD=y.reduce((v,S)=>Fn(v,S.currencyAmountUSD),"0"),h.push(b))}else b.coinId===+a&&h.push(b)}),{walletId:l,balanceCoins:h,coins:o.filter(b=>b.coinId===+a)}}):null}handleWalletAssetOverview({walletData:t,coinsMap:n,walletIdentityMap:a}){let s=t.walletId,i=this.walletCreateController.getCreatedAddresses(s),o=a[s]?.initialType===$.SIMPLE_KEYRING,c=this.coinController.getAddedCoins(s),l=this.coinController.getReducedCoins(s);return F9({isReady:!0,defaultBaseCoinsCoinIds:o?i.map(u=>u.coinId):[],addedCoins:c,reducedCoins:l,balanceCoins:FN({balanceCoins:t.coins,coinsMap:n,flatten:!1}),defi:t.defi,nft:t.nft,hiddenSmallAssets:!0,networks:st()})}async handleCurrentWalletBalance({coinsMap:t,walletData:n}){this.updateCurrentWalletAddressType(n.coins,n.walletId);let a=await this.coinController.getCustomCoins();this.preferencesController.getSelectedWallet()===n.walletId&&(this.coinController.setAllCoins(Array.from(t.values()),a),this.setWalletBalance([n]))}async getWalletsBalance({walletIds:t,chainId:n}){let a=this.preferencesController.getWalletIdentityMap(),s=[],i=!n;return await Promise.all((0,fg.chunk)(t,fte).map(async o=>{let{assets:c,coinsMap:l}=await this.fetchAssetAll(o,n),u=[];c.forEach(h=>{let{walletId:b}=h;if(i){let y=this.handleWalletAssetOverview({walletData:h,coinsMap:l,walletIdentityMap:a});y&&u.push({walletId:b,...y});let v=this.preferencesController.getSelectedWallet();b===v&&this.handleCurrentWalletBalance({coinsMap:l,walletData:h})}s.push({walletId:b,coins:Array.from(l.values()),balanceData:h})}),i&&HN(u)})),s}async getCurrentWalletBalance(){let t=this.preferencesController.getSelectedWallet();if(!t||!this.walletCreateController.getIsWalletCreated(t))return;let{isFirstFetchMapCache:a}=this.memStore.getState(),s=!a[t];s&&this.memStore.updateState({isFirstFetchMapCache:{...a,[t]:!0}});try{await this.getWalletsBalance({walletIds:[t]})}catch(i){if(aw[i?.message])throw new Error(i?.message)}s&&setTimeout(()=>{this.getCurrentWalletBalance()},2e3)}async getAllWalletsBalance(){if(!await this.isUnlocked()){this.clear();return}if(this.pendingAllBalance)return;let t=this.walletCreateController.getCreatedWalletIds(),n=this.preferencesController.getSelectedWallet();if(t.length>1){let a=t.indexOf(n);t.splice(a,1),t.unshift(n)}this.pendingAllBalance=!0;try{this.getWalletsBalance({walletIds:t}),this.pendingAllBalance=!1}catch(a){if(this.pendingAllBalance=!1,aw[a?.message])throw new Error(a?.message)}}async updateCurrentWalletAddressType(t,n){let{needSetDefault:a}=this.keyringController.getWallet(n)??{},i=this.preferencesController.getWalletIdentities().find(c=>c.walletId===n),o=[];t.reduce((c,l)=>l.childrenCoin?c.concat(...l.childrenCoin):c.concat(l),[]).forEach(c=>{a&&n8.includes(c.coinId)&&o.push(c)}),o.length?this.keyringController.emit("updateWalletAddress",{walletId:n,addressType:o.reduce((c,{coinId:l,userAddress:u})=>{let h=me({coinId:+l})?.localType;return Object.entries(i.accountsMap[h]).forEach(([b,y])=>{y.address===u&&(c[h]=b)}),c},{})}):a&&this.keyringController.emit("updateWalletAddress",{walletId:n,addressType:{}})}async fetchAssetAll(t,n){let a=this.preferencesController.getSelectedWallet(),s=this.authController.getRequestHeaders({walletId:a,needSign:!0,isTest:!1,currency:this.currencyController.store.getState().selectedCurrency?.isoCode||dte}),i=ce.newGetAllAssetsUrl,{userUniqueId:o}=this.preferencesController.store.getState();try{let{data:c={}}=await Pe(i,{userUniqueId:o,accountIds:t,combinationCoins:!0,chainIndexes:n?[n]:void 0},{headers:s,needSign:!0}),l=c.coins??[],u=c.assets??[],h=new Map(l.map(v=>[v.coinId,ms(v)])),b=await dg(O0.coinTickers);return{assets:u.map(v=>{let{defis:S,nfts:R,tokens:P,accountId:N}=v,M=P?.map(F=>{let{coinAmountOrigin:K,coinBalanceDetails:H,currencyAmount:j,subBalanceType:X,imageUrl:z,...T}=F,m=H.map(O=>lte(O,h,b)),x=m[0],w=X===1,I=X===2;return{...x,...T,image:z,currencyAmountUSD:m.reduce((O,E)=>Fn(O,E.currencyAmountUSD),"0"),coinAmountInt:K,aggregation:w,isAddressAggregation:I,childrenCoin:w||I?m:void 0}})??null,L=S?.map(F=>({currencyAmountUSD:F.balance,chainId:F.chainId}))??null,B=R?.reduce((F,K)=>F.concat(K.networkValuations||[]),[]).map(F=>({chainId:F.chainId,currencyAmountUSD:F.valuation}))??null;return{defi:L?x1(L):null,nft:B?x1(B):null,coins:M,walletId:N,v:2}}),coinsMap:h}}catch(c){return em(c)}}clear(){this.autoRefreshInterval&&clearInterval(this.autoRefreshInterval),this.autoRefreshInterval=null}removeAsset(t){zN(t),VN(t)}clearAsset(){GN(),cg()}};d();f();Be();Wt();ur();d();f();var v1={actions:[{host:"access-protocol.dial.to",state:"trusted"},{host:"action-blink-example.zeusnetwork.xyz",state:"trusted"},{host:"action.3.land",state:"trusted"},{host:"action.solscan.io",state:"trusted"},{host:"actions-basics.pages.dev",state:"trusted"},{host:"actions.audius.co",state:"trusted"},{host:"actions.buddy.link",state:"trusted"},{host:"actions.degenmarkets.com",state:"trusted"},{host:"actions.dialect.to",state:"trusted"},{host:"actions.everstake.one",state:"trusted"},{host:"actions.keyst.one",state:"trusted"},{host:"actions.magicblock.app",state:"trusted"},{host:"actions.radius.art",state:"trusted"},{host:"actions.solanabeach.io",state:"trusted"},{host:"actions.sonar.watch",state:"trusted"},{host:"actions.swissborg.com",state:"trusted"},{host:"aeropool.io",state:"trusted"},{host:"alldomains.id",state:"trusted"},{host:"allstarsven.com",state:"trusted"},{host:"api-main-mainnet.dreader.io",state:"trusted"},{host:"api.airbillspay.com",state:"trusted"},{host:"api.askanon.fun",state:"trusted"},{host:"api.clickcrate.xyz",state:"trusted"},{host:"api.crystalball.fun",state:"trusted"},{host:"api.dev.hel.io",state:"trusted"},{host:"api.divvy.bet",state:"trusted"},{host:"api.genopets.me",state:"trusted"},{host:"api.hel.io",state:"trusted"},{host:"api.mallow.art",state:"trusted"},{host:"api.mimirlab.xyz",state:"trusted"},{host:"api.predify.lol",state:"trusted"},{host:"api.purebet.io",state:"trusted"},{host:"api.raise.flipeet.io",state:"trusted"},{host:"api.secwarex.io",state:"trusted"},{host:"api.seer.coinhall.org",state:"trusted"},{host:"api.sellix.io",state:"trusted"},{host:"api.spherepay.co",state:"trusted"},{host:"api.stabble.org",state:"trusted"},{host:"api.thesendcoin.com",state:"trusted"},{host:"api.thisimpact.me",state:"trusted"},{host:"api.torque.so",state:"trusted"},{host:"api2.bybit.com",state:"trusted"},{host:"api3.monkeydex.exchange",state:"trusted"},{host:"app.circuit.trade",state:"trusted"},{host:"app.drift.trade",state:"trusted"},{host:"app.getriver.io",state:"trusted"},{host:"app.jibbers.io",state:"trusted"},{host:"app.jogojogo.game",state:"trusted"},{host:"app.prismx.fun",state:"trusted"},{host:"app.solayer.org",state:"trusted"},{host:"appapi.lunadefi.ai",state:"trusted"},{host:"arkenstone.gold",state:"trusted"},{host:"askorb.xyz",state:"trusted"},{host:"backend.gh0stlabs.io",state:"trusted"},{host:"beta.artsn.fi",state:"trusted"},{host:"bit-tips.com",state:"trusted"},{host:"blink-api.spicygun.com",state:"trusted"},{host:"blink-dzhisl.fun",state:"trusted"},{host:"blink-flip.onrender.com",state:"trusted"},{host:"blink.bladerite.io",state:"trusted"},{host:"blink.chakratree.net",state:"trusted"},{host:"blink.dev.hel.io",state:"trusted"},{host:"blink.foresightnews.pro",state:"trusted"},{host:"blink.futureprotocol.io",state:"trusted"},{host:"blink.hel.io",state:"trusted"},{host:"blink.lulo.fi",state:"trusted"},{host:"blink.ore.supply",state:"trusted"},{host:"blink.solanasim.com",state:"trusted"},{host:"blink.streamflow.finance",state:"trusted"},{host:"blink.sunrisestake.com",state:"trusted"},{host:"blink.thevault.finance",state:"trusted"},{host:"blink.validator",state:"trusted"},{host:"blink.validator.com",state:"trusted"},{host:"blink.validators.app",state:"trusted"},{host:"blink.winkit.app",state:"trusted"},{host:"blink2earn.com",state:"trusted"},{host:"blinkbash.daoplays.org",state:"trusted"},{host:"blinkbro.com",state:"trusted"},{host:"blinkeditor.com",state:"trusted"},{host:"blinkgenerator.com",state:"trusted"},{host:"blinkgram.xyz",state:"trusted"},{host:"blinkify.me",state:"trusted"},{host:"blinkpig.com",state:"trusted"},{host:"blinks-inspector.vercel.app",state:"trusted"},{host:"blinks-poc-dialect.vercel.app",state:"malicious"},{host:"blinks.afel.xyz",state:"trusted"},{host:"blinks.alphabatem.io",state:"trusted"},{host:"blinks.artrade.app",state:"trusted"},{host:"blinks.bandit.network",state:"trusted"},{host:"blinks.best",state:"trusted"},{host:"blinks.catoff.xyz",state:"trusted"},{host:"blinks.cubik.so",state:"trusted"},{host:"blinks.dith.ai",state:"trusted"},{host:"blinks.dripin.xyz",state:"trusted"},{host:"blinks.gg",state:"trusted"},{host:"blinks.infinityg.ai",state:"trusted"},{host:"blinks.mohitparmar.fun",state:"trusted"},{host:"blinks.oxbull.tech",state:"trusted"},{host:"blinks.prooflab.cc",state:"trusted"},{host:"blinks.roastchickenonsol.com",state:"trusted"},{host:"blinks.solanahub.app",state:"trusted"},{host:"blinks.xyz",state:"trusted"},{host:"blinks.yona.network",state:"trusted"},{host:"blinksolanasim.fr",state:"trusted"},{host:"blinkstationx.com",state:"trusted"},{host:"blinktochat.fun",state:"trusted"},{host:"blnk.fun",state:"trusted"},{host:"bondingcurve.coinziee.com",state:"trusted"},{host:"bonkblinks.com",state:"trusted"},{host:"bonny.so",state:"trusted"},{host:"burn.thesendcoin.com",state:"trusted"},{host:"buythedip.trade",state:"trusted"},{host:"bybit.com",state:"trusted"},{host:"chainsona.dev",state:"trusted"},{host:"checkmate.sendarcade.fun",state:"trusted"},{host:"chess.spawnpoint.cloud",state:"trusted"},{host:"claimsolblink.devvivek.tech",state:"trusted"},{host:"cleanit.thesendcoin.com",state:"trusted"},{host:"clone.so",state:"trusted"},{host:"connexus.social",state:"trusted"},{host:"dappshunt.xyz",state:"trusted"},{host:"dca.compressed.fun",state:"trusted"},{host:"death.breadheads.io",state:"trusted"},{host:"decod3rs.com",state:"trusted"},{host:"detribe.xyz",state:"trusted"},{host:"dev-api.fostermarketplace.app",state:"trusted"},{host:"devwifhat.xyz",state:"trusted"},{host:"dewicats.xyz",state:"trusted"},{host:"dextrade.gateweb3.cc",state:"trusted"},{host:"dial.to",state:"trusted"},{host:"dialect.cudis.xyz",state:"trusted"},{host:"donate.gateomega.com",state:"trusted"},{host:"donate.huatuo.xyz",state:"trusted"},{host:"donate.stefans.me",state:"trusted"},{host:"dotblink.me",state:"trusted"},{host:"drop.site",state:"trusted"},{host:"ensofi.xyz",state:"trusted"},{host:"famousfoxes.com",state:"trusted"},{host:"fastmind.app",state:"trusted"},{host:"gittip.dev",state:"trusted"},{host:"greed.academy",state:"trusted"},{host:"hedgehog.markets",state:"trusted"},{host:"helium.dial.to",state:"trusted"},{host:"helius.dial.to",state:"trusted"},{host:"hermans.club",state:"trusted"},{host:"higher.fun",state:"trusted"},{host:"iblink.to",state:"trusted"},{host:"jupiter.dial.to",state:"trusted"},{host:"jupswap.monstre.net",state:"trusted"},{host:"kayx86.com",state:"trusted"},{host:"launchmynft.io",state:"trusted"},{host:"letscook.wtf",state:"trusted"},{host:"lifafa.fun",state:"trusted"},{host:"link.solvm.io",state:"trusted"},{host:"lovememe.fun",state:"trusted"},{host:"lunadefi.ai",state:"trusted"},{host:"magicedennss.it",state:"malicious"},{host:"mainnet.underdogprotocol.com",state:"trusted"},{host:"metablink.xyz",state:"trusted"},{host:"meteora.dial.to",state:"trusted"},{host:"millionsols.art",state:"trusted"},{host:"mint-nft-action-test.nze.workers.dev",state:"trusted"},{host:"mint-nft-action.nze.workers.dev",state:"trusted"},{host:"mint.solanaringers.art",state:"trusted"},{host:"mistgg.xyz",state:"trusted"},{host:"monkeydex.exchange",state:"trusted"},{host:"mutantlabs.xyz",state:"trusted"},{host:"nathan.woodburn.au",state:"trusted"},{host:"nick.af",state:"trusted"},{host:"nxfinance.io",state:"trusted"},{host:"okx.com",state:"trusted"},{host:"onlyblinks.com",state:"trusted"},{host:"onthefrog.xyz",state:"trusted"},{host:"p2p-blinks-psi.vercel.app",state:"trusted"},{host:"pajamas.cat",state:"trusted"},{host:"paragon.gdn",state:"trusted"},{host:"pay.rahulol.me",state:"trusted"},{host:"pay.sellix.io",state:"trusted"},{host:"phantom.dial.to",state:"trusted"},{host:"phaselabs.io",state:"trusted"},{host:"pixlink.fun",state:"trusted"},{host:"play.wenwencoin.com",state:"trusted"},{host:"play.yescoin.wtf",state:"trusted"},{host:"polyquest.haihv.dev",state:"trusted"},{host:"predict.solcasino.io",state:"trusted"},{host:"presale.solarchons.com",state:"trusted"},{host:"proofpass.xyz",state:"trusted"},{host:"qna3.ai",state:"trusted"},{host:"rain.fi",state:"trusted"},{host:"rainfi-actions.fly.dev",state:"trusted"},{host:"realms.dial.to",state:"trusted"},{host:"rexagotchiapi.r3x.tech",state:"trusted"},{host:"ridetheblink.blinkgames.dev",state:"trusted"},{host:"rosgame.xyz",state:"trusted"},{host:"run.fabs.fun",state:"trusted"},{host:"sanctum.dial.to",state:"trusted"},{host:"sandblizzard.one",state:"trusted"},{host:"sanlikh.xyz",state:"trusted"},{host:"scattering.io",state:"trusted"},{host:"sentinelactionfund.dial.to",state:"trusted"},{host:"share.raydium.io",state:"trusted"},{host:"shill.fm",state:"trusted"},{host:"sniper.xyz",state:"trusted"},{host:"sns-actions.bonfida.com",state:"trusted"},{host:"sol-api.follows.app",state:"trusted"},{host:"sol-minesweeper.server.uptimesentinel.com",state:"trusted"},{host:"sol-pixel-war.getnimbus.io",state:"trusted"},{host:"sol.slimepoker.xyz",state:"trusted"},{host:"solaction.aaraz.me",state:"trusted"},{host:"solaction.nxfi.io",state:"trusted"},{host:"solactions.fun",state:"trusted"},{host:"solana-action-express.com",state:"trusted"},{host:"solana-actions.dwong.xyz",state:"trusted"},{host:"solana-actions.vercel.app",state:"trusted"},{host:"solana.playspokemon.com",state:"trusted"},{host:"solanaboredfish.com",state:"trusted"},{host:"solanasim.com",state:"trusted"},{host:"solanasummer.click",state:"trusted"},{host:"solandy.dev",state:"trusted"},{host:"solbound.dev",state:"trusted"},{host:"solcasino.io",state:"trusted"},{host:"soldonate.me",state:"trusted"},{host:"solfate.com",state:"trusted"},{host:"solr.network",state:"trusted"},{host:"soltion.fun",state:"trusted"},{host:"soltip.me",state:"trusted"},{host:"spotthedog.xyz",state:"trusted"},{host:"spsblink.runepunk.gg",state:"trusted"},{host:"squads-actions-poc.vercel.app",state:"trusted"},{host:"stake.superfast.org",state:"trusted"},{host:"t22.io",state:"trusted"},{host:"tensor.dial.to",state:"trusted"},{host:"tensor.trade",state:"trusted"},{host:"termix.ai",state:"trusted"},{host:"thecryptowisdom.site",state:"trusted"},{host:"theportal.to",state:"trusted"},{host:"therakibul.me",state:"trusted"},{host:"tip.audius.co",state:"trusted"},{host:"tipatweet.fun",state:"trusted"},{host:"tipjars.io",state:"trusted"},{host:"tiplink.io",state:"trusted"},{host:"truffle.wtf",state:"trusted"},{host:"tug-of-war.magicblock.app",state:"trusted"},{host:"uptimesentinel.com",state:"trusted"},{host:"usesel.online",state:"trusted"},{host:"veilpay.xyz",state:"trusted"},{host:"winkit.app",state:"trusted"},{host:"worker.jup.ag",state:"trusted"},{host:"www.aeropool.io",state:"trusted"},{host:"www.alldomains.id",state:"trusted"},{host:"www.allstarsven.com",state:"trusted"},{host:"www.arkenstone.gold",state:"trusted"},{host:"www.askorb.xyz",state:"trusted"},{host:"www.bit-tips.com",state:"trusted"},{host:"www.blink-dzhisl.fun",state:"trusted"},{host:"www.blink.validator",state:"trusted"},{host:"www.blink2earn.com",state:"trusted"},{host:"www.blinkbro.com",state:"trusted"},{host:"www.blinkeditor.com",state:"trusted"},{host:"www.blinkgenerator.com",state:"trusted"},{host:"www.blinkgram.xyz",state:"trusted"},{host:"www.blinkify.me",state:"trusted"},{host:"www.blinkpig.com",state:"trusted"},{host:"www.blinks.best",state:"trusted"},{host:"www.blinks.dith.ai",state:"trusted"},{host:"www.blinks.gg",state:"trusted"},{host:"www.blinks.xyz",state:"trusted"},{host:"www.blinksolanasim.fr",state:"trusted"},{host:"www.blinkstationx.com",state:"trusted"},{host:"www.blinktochat.fun",state:"trusted"},{host:"www.blnk.fun",state:"trusted"},{host:"www.bonkblinks.com",state:"trusted"},{host:"www.bonny.so",state:"trusted"},{host:"www.buythedip.trade",state:"trusted"},{host:"www.bybit.com",state:"trusted"},{host:"www.chainsona.dev",state:"trusted"},{host:"www.clone.so",state:"trusted"},{host:"www.connexus.social",state:"trusted"},{host:"www.dappshunt.xyz",state:"trusted"},{host:"www.decod3rs.com",state:"trusted"},{host:"www.detribe.xyz",state:"trusted"},{host:"www.devwifhat.xyz",state:"trusted"},{host:"www.dewicats.xyz",state:"trusted"},{host:"www.dial.to",state:"trusted"},{host:"www.dotblink.me",state:"trusted"},{host:"www.drop.site",state:"trusted"},{host:"www.ensofi.xyz",state:"trusted"},{host:"www.famousfoxes.com",state:"trusted"},{host:"www.fastmind.app",state:"trusted"},{host:"www.gittip.dev",state:"trusted"},{host:"www.greed.academy",state:"trusted"},{host:"www.hedgehog.markets",state:"trusted"},{host:"www.hermans.club",state:"trusted"},{host:"www.higher.fun",state:"trusted"},{host:"www.iblink.to",state:"trusted"},{host:"www.kayx86.com",state:"trusted"},{host:"www.launchmynft.io",state:"trusted"},{host:"www.letscook.wtf",state:"trusted"},{host:"www.lifafa.fun",state:"trusted"},{host:"www.lovememe.fun",state:"trusted"},{host:"www.lunadefi.ai",state:"trusted"},{host:"www.magicedennss.it",state:"malicious"},{host:"www.metablink.xyz",state:"trusted"},{host:"www.millionsols.art",state:"trusted"},{host:"www.mistgg.xyz",state:"trusted"},{host:"www.monkeydex.exchange",state:"trusted"},{host:"www.mutantlabs.xyz",state:"trusted"},{host:"www.nick.af",state:"trusted"},{host:"www.nxfinance.io",state:"trusted"},{host:"www.okx.com",state:"trusted"},{host:"www.onlyblinks.com",state:"trusted"},{host:"www.onthefrog.xyz",state:"trusted"},{host:"www.pajamas.cat",state:"trusted"},{host:"www.paragon.gdn",state:"trusted"},{host:"www.phaselabs.io",state:"trusted"},{host:"www.pixlink.fun",state:"trusted"},{host:"www.proofpass.xyz",state:"trusted"},{host:"www.qna3.ai",state:"trusted"},{host:"www.rain.fi",state:"trusted"},{host:"www.rosgame.xyz",state:"trusted"},{host:"www.sandblizzard.one",state:"trusted"},{host:"www.sanlikh.xyz",state:"trusted"},{host:"www.scattering.io",state:"trusted"},{host:"www.shill.fm",state:"trusted"},{host:"www.sniper.xyz",state:"trusted"},{host:"www.solactions.fun",state:"trusted"},{host:"www.solana-action-express.com",state:"trusted"},{host:"www.solanaboredfish.com",state:"trusted"},{host:"www.solanasim.com",state:"trusted"},{host:"www.solanasummer.click",state:"trusted"},{host:"www.solandy.dev",state:"trusted"},{host:"www.solbound.dev",state:"trusted"},{host:"www.solcasino.io",state:"trusted"},{host:"www.soldonate.me",state:"trusted"},{host:"www.solfate.com",state:"trusted"},{host:"www.solr.network",state:"trusted"},{host:"www.soltion.fun",state:"trusted"},{host:"www.soltip.me",state:"trusted"},{host:"www.spotthedog.xyz",state:"trusted"},{host:"www.t22.io",state:"trusted"},{host:"www.tensor.trade",state:"trusted"},{host:"www.termix.ai",state:"trusted"},{host:"www.thecryptowisdom.site",state:"trusted"},{host:"www.theportal.to",state:"trusted"},{host:"www.therakibul.me",state:"trusted"},{host:"www.tipatweet.fun",state:"trusted"},{host:"www.tipjars.io",state:"trusted"},{host:"www.tiplink.io",state:"trusted"},{host:"www.truffle.wtf",state:"trusted"},{host:"www.uptimesentinel.com",state:"trusted"},{host:"www.usesel.online",state:"trusted"},{host:"www.veilpay.xyz",state:"trusted"},{host:"www.winkit.app",state:"trusted"},{host:"www.zeusnetwork.xyz",state:"trusted"},{host:"www.zkonnect.social",state:"trusted"},{host:"zeusnetwork.xyz",state:"trusted"},{host:"zkonnect.social",state:"trusted"},{host:"www.kelpdao.xyz",state:"trusted"},{host:"kelpdao.xyz",state:"trusted"},{host:"www.rarible.com",state:"trusted"},{host:"rarible.com",state:"trusted"},{host:"www.staderlabs.com",state:"trusted"},{host:"staderlabs.com",state:"trusted"},{host:"www.swellnetwork.io",state:"trusted"},{host:"swellnetwork.io",state:"trusted"},{host:"www.izumi.finance",state:"trusted"},{host:"izumi.finance",state:"trusted"},{host:"subapi.izumi.finance",state:"trusted"},{host:"www.gmgn.ai",state:"trusted"},{host:"gmgn.ai",state:"trusted"},{host:"www.gmgn.cc",state:"trusted"},{host:"gmgn.cc",state:"trusted"}],allowRequestHeaders:["www.okx.com","okx.com"],interstitials:[{host:"actions.dialect.to",state:"trusted"},{host:"blinks.xyz",state:"trusted"},{host:"dial.to",state:"trusted"},{host:"nick.af",state:"trusted"},{host:"www.blinks.xyz",state:"trusted"},{host:"www.dial.to",state:"trusted"},{host:"www.nick.af",state:"trusted"}],websites:[{host:"3.land",state:"trusted"},{host:"actions.buddy.link",state:"trusted"},{host:"actions.dialect.to",state:"trusted"},{host:"actions.everstake.one",state:"trusted"},{host:"actions.keyst.one",state:"trusted"},{host:"aeropool.io",state:"trusted"},{host:"alldomains.id",state:"trusted"},{host:"allstarsven.com",state:"trusted"},{host:"api.predify.lol",state:"trusted"},{host:"app.circuit.trade",state:"trusted"},{host:"app.divvy.bet",state:"trusted"},{host:"app.drift.trade",state:"trusted"},{host:"app.getriver.io",state:"trusted"},{host:"app.jogojogo.game",state:"trusted"},{host:"app.meteora.ag",state:"trusted"},{host:"app.prismx.fun",state:"trusted"},{host:"app.realms.today",state:"trusted"},{host:"app.sanctum.so",state:"trusted"},{host:"app.stabble.org",state:"trusted"},{host:"app.streamflow.finance",state:"trusted"},{host:"app.torque.so",state:"trusted"},{host:"arkenstone.gold",state:"trusted"},{host:"askanon.fun",state:"trusted"},{host:"askorb.xyz",state:"trusted"},{host:"audius.co",state:"trusted"},{host:"bandit.network",state:"trusted"},{host:"beta.artsn.fi",state:"trusted"},{host:"blink.thevault.finance",state:"trusted"},{host:"blink.validator",state:"trusted"},{host:"blink.validator.com",state:"trusted"},{host:"blink.winkit.app",state:"trusted"},{host:"blink2earn.com",state:"trusted"},{host:"blinkbro.com",state:"trusted"},{host:"blinkeditor.com",state:"trusted"},{host:"blinkify.me",state:"trusted"},{host:"blinks.bandit.network",state:"trusted"},{host:"blinks.catoff.xyz",state:"trusted"},{host:"blinks.gg",state:"trusted"},{host:"blinks.oxbull.tech",state:"trusted"},{host:"blinks.prooflab.cc",state:"trusted"},{host:"blinks.spicygun.com",state:"trusted"},{host:"blinkstationx.com",state:"trusted"},{host:"blnk.fun",state:"trusted"},{host:"bondingcurve.coinziee.com",state:"trusted"},{host:"bonkblinks.com",state:"trusted"},{host:"bonkrewards.com",state:"trusted"},{host:"bonny.so",state:"trusted"},{host:"burn.thesendcoin.com",state:"trusted"},{host:"buythedip.trade",state:"trusted"},{host:"bybit.com",state:"trusted"},{host:"chainsona.dev",state:"trusted"},{host:"checkmate.sendarcade.fun",state:"trusted"},{host:"claimsolblink.devvivek.tech",state:"trusted"},{host:"clickcrate.xyz",state:"trusted"},{host:"coinhall.org",state:"trusted"},{host:"connexus.social",state:"trusted"},{host:"crystalball.fun",state:"trusted"},{host:"cubik.so",state:"trusted"},{host:"dappshunt.xyz",state:"trusted"},{host:"dca.compressed.fun",state:"trusted"},{host:"death.breadheads.io",state:"trusted"},{host:"decod3rs.com",state:"trusted"},{host:"degenmarkets.com",state:"trusted"},{host:"detribe.xyz",state:"trusted"},{host:"dev.helius.xyz",state:"trusted"},{host:"devwifhat.xyz",state:"trusted"},{host:"dewicats.xyz",state:"trusted"},{host:"dial.to",state:"trusted"},{host:"dialect.cudis.xyz",state:"trusted"},{host:"donate.gateomega.com",state:"trusted"},{host:"donate.huatuo.xyz",state:"trusted"},{host:"dotblink.me",state:"trusted"},{host:"dreader.app",state:"trusted"},{host:"drop.site",state:"trusted"},{host:"ensofi.xyz",state:"trusted"},{host:"famousfoxes.com",state:"trusted"},{host:"fastmind.app",state:"trusted"},{host:"fostermarketplace.app",state:"trusted"},{host:"game.yona.network",state:"trusted"},{host:"gate.io",state:"trusted"},{host:"gittip.dev",state:"trusted"},{host:"greed.academy",state:"trusted"},{host:"hedgehog.markets",state:"trusted"},{host:"hel.io",state:"trusted"},{host:"heliumvote.com",state:"trusted"},{host:"hermans.club",state:"trusted"},{host:"higher.fun",state:"trusted"},{host:"hub.accessprotocol.co",state:"trusted"},{host:"iblink.to",state:"trusted"},{host:"jup.ag",state:"trusted"},{host:"keyst.one",state:"trusted"},{host:"launchmynft.io",state:"trusted"},{host:"lifafa.fun",state:"trusted"},{host:"lovememe.fun",state:"trusted"},{host:"lulo.fi",state:"trusted"},{host:"lunadefi.ai",state:"trusted"},{host:"mallow.art",state:"trusted"},{host:"mcdegen.xyz",state:"trusted"},{host:"metablink.xyz",state:"trusted"},{host:"millionsols.art",state:"trusted"},{host:"mistgg.xyz",state:"trusted"},{host:"monkeydex.exchange",state:"trusted"},{host:"mutantlabs.xyz",state:"trusted"},{host:"nathan.woodburn.au",state:"trusted"},{host:"nick.af",state:"trusted"},{host:"nxfi.io",state:"trusted"},{host:"nxfinance.io",state:"trusted"},{host:"okx.com",state:"trusted"},{host:"onlyblinks.com",state:"trusted"},{host:"onthefrog.xyz",state:"trusted"},{host:"pajamas.cat",state:"trusted"},{host:"paragon.gdn",state:"trusted"},{host:"pay.rahulol.me",state:"trusted"},{host:"pay.sellix.io",state:"trusted"},{host:"phantom.app",state:"trusted"},{host:"phaselabs.io",state:"trusted"},{host:"pixlink.fun",state:"trusted"},{host:"play.wenwencoin.com",state:"trusted"},{host:"play.yescoin.wtf",state:"trusted"},{host:"polyquest.xyz",state:"trusted"},{host:"prismx.fun",state:"trusted"},{host:"qna3.ai",state:"trusted"},{host:"r3x.tech",state:"trusted"},{host:"radius.art",state:"trusted"},{host:"rafffle.famousfoxes.com",state:"trusted"},{host:"rain.fi",state:"trusted"},{host:"rainfi-actions.fly.dev",state:"trusted"},{host:"raise.flipeet.io",state:"trusted"},{host:"raydium.io",state:"trusted"},{host:"realms.today",state:"trusted"},{host:"rexagotchiapi.r3x.tech",state:"trusted"},{host:"ridetheblink.blinkgames.dev",state:"trusted"},{host:"sandblizzard.one",state:"trusted"},{host:"sanlikh.xyz",state:"trusted"},{host:"scattering.io",state:"trusted"},{host:"sentinelactionfund.com",state:"trusted"},{host:"shill.fm",state:"trusted"},{host:"sniper.xyz",state:"trusted"},{host:"sol-pixel-war.getnimbus.io",state:"trusted"},{host:"sol.follows.app",state:"trusted"},{host:"sol.slimepoker.xyz",state:"trusted"},{host:"solactions.fun",state:"trusted"},{host:"solanaboredfish.com",state:"trusted"},{host:"solanahub.app",state:"trusted"},{host:"solanasim.com",state:"trusted"},{host:"solanasummer.click",state:"trusted"},{host:"solandy.dev",state:"trusted"},{host:"solbound.dev",state:"trusted"},{host:"soldonate.me",state:"trusted"},{host:"solfate.com",state:"trusted"},{host:"solr.network",state:"trusted"},{host:"solscan.io",state:"trusted"},{host:"soltip.me",state:"trusted"},{host:"solvm.io",state:"trusted"},{host:"sonar.watch",state:"trusted"},{host:"spherepay.co",state:"trusted"},{host:"staging.streamflow.finance",state:"trusted"},{host:"stake.superfast.org",state:"trusted"},{host:"t22.io",state:"trusted"},{host:"tensor.trade",state:"trusted"},{host:"termix.ai",state:"trusted"},{host:"thecryptowisdom.site",state:"trusted"},{host:"theportal.to",state:"trusted"},{host:"therakibul.me",state:"trusted"},{host:"tipatweet.fun",state:"trusted"},{host:"tipjars.io",state:"trusted"},{host:"tiplink.io",state:"trusted"},{host:"trade.mimirlab.xyz",state:"trusted"},{host:"trade.predify.lol",state:"trusted"},{host:"truffle.wtf",state:"trusted"},{host:"tug-of-war.magicblock.app",state:"trusted"},{host:"validators.app",state:"trusted"},{host:"veilpay.xyz",state:"trusted"},{host:"winkit.app",state:"trusted"},{host:"worker.jup.ag",state:"trusted"},{host:"www.3.land",state:"trusted"},{host:"www.aeropool.io",state:"trusted"},{host:"www.alldomains.id",state:"trusted"},{host:"www.allstarsven.com",state:"trusted"},{host:"www.arkenstone.gold",state:"trusted"},{host:"www.askanon.fun",state:"trusted"},{host:"www.askorb.xyz",state:"trusted"},{host:"www.audius.co",state:"trusted"},{host:"www.bandit.network",state:"trusted"},{host:"www.blink.validator",state:"trusted"},{host:"www.blink2earn.com",state:"trusted"},{host:"www.blinkbro.com",state:"trusted"},{host:"www.blinkeditor.com",state:"trusted"},{host:"www.blinkify.me",state:"trusted"},{host:"www.blinks.gg",state:"trusted"},{host:"www.blinkstationx.com",state:"trusted"},{host:"www.blnk.fun",state:"trusted"},{host:"www.bonkblinks.com",state:"trusted"},{host:"www.bonkrewards.com",state:"trusted"},{host:"www.bonny.so",state:"trusted"},{host:"www.buythedip.trade",state:"trusted"},{host:"www.bybit.com",state:"trusted"},{host:"www.chainsona.dev",state:"trusted"},{host:"www.clickcrate.xyz",state:"trusted"},{host:"www.coinhall.org",state:"trusted"},{host:"www.connexus.social",state:"trusted"},{host:"www.crystalball.fun",state:"trusted"},{host:"www.cubik.so",state:"trusted"},{host:"www.dappshunt.xyz",state:"trusted"},{host:"www.decod3rs.com",state:"trusted"},{host:"www.degenmarkets.com",state:"trusted"},{host:"www.detribe.xyz",state:"trusted"},{host:"www.devwifhat.xyz",state:"trusted"},{host:"www.dewicats.xyz",state:"trusted"},{host:"www.dial.to",state:"trusted"},{host:"www.dotblink.me",state:"trusted"},{host:"www.dreader.app",state:"trusted"},{host:"www.drop.site",state:"trusted"},{host:"www.ensofi.xyz",state:"trusted"},{host:"www.famousfoxes.com",state:"trusted"},{host:"www.fastmind.app",state:"trusted"},{host:"www.fostermarketplace.app",state:"trusted"},{host:"www.gate.io",state:"trusted"},{host:"www.gittip.dev",state:"trusted"},{host:"www.greed.academy",state:"trusted"},{host:"www.hedgehog.markets",state:"trusted"},{host:"www.hel.io",state:"trusted"},{host:"www.heliumvote.com",state:"trusted"},{host:"www.hermans.club",state:"trusted"},{host:"www.higher.fun",state:"trusted"},{host:"www.iblink.to",state:"trusted"},{host:"www.jup.ag",state:"trusted"},{host:"www.keyst.one",state:"trusted"},{host:"www.launchmynft.io",state:"trusted"},{host:"www.lifafa.fun",state:"trusted"},{host:"www.lovememe.fun",state:"trusted"},{host:"www.lulo.fi",state:"trusted"},{host:"www.lunadefi.ai",state:"trusted"},{host:"www.mallow.art",state:"trusted"},{host:"www.mcdegen.xyz",state:"trusted"},{host:"www.metablink.xyz",state:"trusted"},{host:"www.millionsols.art",state:"trusted"},{host:"www.mistgg.xyz",state:"trusted"},{host:"www.monkeydex.exchange",state:"trusted"},{host:"www.mutantlabs.xyz",state:"trusted"},{host:"www.nick.af",state:"trusted"},{host:"www.nxfi.io",state:"trusted"},{host:"www.nxfinance.io",state:"trusted"},{host:"www.okx.com",state:"trusted"},{host:"www.onlyblinks.com",state:"trusted"},{host:"www.onthefrog.xyz",state:"trusted"},{host:"www.pajamas.cat",state:"trusted"},{host:"www.paragon.gdn",state:"trusted"},{host:"www.phantom.app",state:"trusted"},{host:"www.phaselabs.io",state:"trusted"},{host:"www.pixlink.fun",state:"trusted"},{host:"www.polyquest.xyz",state:"trusted"},{host:"www.prismx.fun",state:"trusted"},{host:"www.qna3.ai",state:"trusted"},{host:"www.r3x.tech",state:"trusted"},{host:"www.radius.art",state:"trusted"},{host:"www.rain.fi",state:"trusted"},{host:"www.raydium.io",state:"trusted"},{host:"www.realms.today",state:"trusted"},{host:"www.sandblizzard.one",state:"trusted"},{host:"www.sanlikh.xyz",state:"trusted"},{host:"www.scattering.io",state:"trusted"},{host:"www.sentinelactionfund.com",state:"trusted"},{host:"www.shill.fm",state:"trusted"},{host:"www.sniper.xyz",state:"trusted"},{host:"www.solactions.fun",state:"trusted"},{host:"www.solanaboredfish.com",state:"trusted"},{host:"www.solanahub.app",state:"trusted"},{host:"www.solanasim.com",state:"trusted"},{host:"www.solanasummer.click",state:"trusted"},{host:"www.solandy.dev",state:"trusted"},{host:"www.solbound.dev",state:"trusted"},{host:"www.soldonate.me",state:"trusted"},{host:"www.solfate.com",state:"trusted"},{host:"www.solr.network",state:"trusted"},{host:"www.solscan.io",state:"trusted"},{host:"www.soltip.me",state:"trusted"},{host:"www.solvm.io",state:"trusted"},{host:"www.sonar.watch",state:"trusted"},{host:"www.spherepay.co",state:"trusted"},{host:"www.t22.io",state:"trusted"},{host:"www.tensor.trade",state:"trusted"},{host:"www.termix.ai",state:"trusted"},{host:"www.thecryptowisdom.site",state:"trusted"},{host:"www.theportal.to",state:"trusted"},{host:"www.therakibul.me",state:"trusted"},{host:"www.tipatweet.fun",state:"trusted"},{host:"www.tipjars.io",state:"trusted"},{host:"www.tiplink.io",state:"trusted"},{host:"www.truffle.wtf",state:"trusted"},{host:"www.validators.app",state:"trusted"},{host:"www.veilpay.xyz",state:"trusted"},{host:"www.winkit.app",state:"trusted"},{host:"www.zeusnetwork.xyz",state:"trusted"},{host:"www.zkonnect.social",state:"trusted"},{host:"zeusnetwork.xyz",state:"trusted"},{host:"zkonnect.social",state:"trusted"},{host:"www.kelpdao.xyz",state:"trusted"},{host:"kelpdao.xyz",state:"trusted"},{host:"www.rarible.com",state:"trusted"},{host:"rarible.com",state:"trusted"},{host:"www.staderlabs.com",state:"trusted"},{host:"staderlabs.com",state:"trusted"},{host:"www.swellnetwork.io",state:"trusted"},{host:"swellnetwork.io",state:"trusted"},{host:"www.izumi.finance",state:"trusted"},{host:"izumi.finance",state:"trusted"},{host:"subapi.izumi.finance",state:"trusted"},{host:"www.gmgn.ai",state:"trusted"},{host:"gmgn.ai",state:"trusted"},{host:"www.gmgn.cc",state:"trusted"},{host:"gmgn.cc",state:"trusted"}]};var ZN="blinkConfig",Cu=class extends ge{constructor(){super(),setInterval(()=>{this.fetchBlinkWhiteList()},1e3*60*10),this.fetchBlinkWhiteList()}async fetchBlinkWhiteList(){try{let e=await zr(ce.getBlinkWhiteListConfig),t=await fetch(e.data);if(!t.ok)throw new Error(`Response status: ${t.status}`);let n=await t.json();return YN(ZN,n),n}catch(e){return console.error(`get blink whitelist error ${e}`),v1}}async getBlinkWhiteList(){try{let e=await dg(ZN);return e||this.fetchBlinkWhiteList()}catch{return v1}}};d();f();Be();ae();var eR=_(Ne());d();f();ur();Wt();var ute={getChain(r){return zr(ce.getChainUrl,r)}},QN=ute;var Tu=class extends ge{constructor(e){super(),this.chainUpdateCallback=e.chainUpdateCallback,this.memStore=new eR.ObservableStore({chainList:null})}fallbackLegacyChainList(e=!0){let t=this.memStore.getState();e?this.memStore.updateState({chainList:st()}):t.chainList!==null&&this.memStore.updateState({chainList:null})}async getChainFromServer(){try{let{data:e}=await QN.getChain(),{chainList:t}=e,{safeChainList:n}=w9(t),a=st(),s=x9(n,a,["explorerUrl","rpcUrl","hotNetworkRank","isHotNetwork","rank","aggregation","supportShowDetail","systemToken","ticker","isDefault","ticker","blockExplorerUrl"]);if(s!=="NO_UPDATE"){n.forEach(o=>{o.localType=o.chain,o.providerType=o.chain}),Vp(n),this.chainUpdateCallback(s==="CORE_UPDATE");let i=await W5(n);this.fallbackLegacyChainList(!i)}}catch(e){console.log("Update: false: ",e)}}};d();f();var S1=["definer.org","yfx.com","nerve.network","okex.org","okex.com","okx.com","ouyi.top","ouyi.cc","jswap.finance","follow.one","spiralx.space","wepiggy.com"];var pte=60*60*1e3,Iu=class{constructor({interval:e=pte,apiHostname:t}={}){this.whiteList=S1,this.apiHostname=t,this.poll(e)}async poll(e){this.interval&&clearInterval(this.interval),e&&(this.updateWhiteListData(),this.interval=setInterval(()=>{this.updateWhiteListData()},e))}async updateWhiteListData(){let e=!0;try{let t=await fetch(`https://${this.apiHostname}/v1/deposit/plugin/get/whitelist`,{cache:"no-cache",contentType:"application/json"});switch(t.status){case 200:{let n=await t.json();return this.whiteList=n?.data?.length?n.data:S1,this.whiteList}case 304:case 403:return null;default:throw new Error(`Fetch white list failed with status '${t.status}'`)}}catch{e=!1}return e}test(e=""){if(!e)return!1;let t=!1,n=new URL(e).host;for(let a=0;a<this.whiteList.length;a++){let s=this.whiteList[a],i=new RegExp(`(.${s})$`);if(s===n||i.test(n)){t=!0;break}}return t}};d();f();Be();var A1=_(Ne()),hg=_(te());d();f();var mte=(r,...e)=>{e.forEach(t=>{Object.assign(r,t(r))})},Vd=mte;ae();d();f();Wt();ur();var tR={getSupportCustomChains(){return zr(ce.getSupportCustomChains)},postAddCoinBatch(r,e){return Pe(ce.postAddCoinBatch,r,e)},getCustomCoin(r,e){return Pe(ce.getCustomCoin,r,e)},getWaxCustomCoin(r,e){return Pe(ce.getWaxCustomCoin,r,e)},getXRC20ProtocolList(r,e){return zr(ce.getXRC20ProtocolList,r,e)},postAddCoin(r,e){return Pe(ce.postAddCoin,r,e)},getPlatformCoinsCDNUrl(){return Uc(ce.getPlatformCoinsCDNUrl)},getCustomCoins(r){return Uc(ce.getCustomCoins,r)}},gte=async()=>{let{data:{url:r}}=await tR.getPlatformCoinsCDNUrl();return await Uc(r)},ja={...tR,getPlatformCoins:gte};d();f();var nR=_(O$());ae();d();f();An();var _1=3;function bte(r=300){return new Promise(e=>setTimeout(e,r))}async function rR(r){if(!r||r.length===0)return;let e=0,t,n=await ft.common_coins;try{await n.set(r,{clear:!0})}catch(a){if(t=a,await n.count().catch(()=>0)>0)throw t;for(;e<_1;)try{await n.set(r,{clear:!0});break}catch(i){t=i,await bte(300),e++}Ae.captureEvent({message:"STORE_WARN_indexeddb_set_retry",contexts:{report:{info:JSON.stringify({retryTimes:e,isRetrySuccess:e<_1})}},exception:{values:[{type:"STORE_WARN_indexeddb_set_retry",value:Md(t)}]},level:"info"})}if(e>=_1)throw t}var yte=r=>({async getSupportCustomChains(){let{data:e}=await ja.getSupportCustomChains();return r.supportCustomChains=e,e},async getCustomCoins(){let t={userUniqueId:r.preferencesController.getUserUniqueId()};try{let{data:n}=await ja.getCustomCoins(t);return(Array.isArray(n)?n:[]).map(s=>ms(s))}catch{return[]}},async setAllCoins(e,t){let n=(0,nR.default)(e,t,"coinId"),a=this.computedCoins(n);r.privateUpdateAddedServerCoins(a);try{await rR(a)}catch{r.fallbackAllCoinsMap()}return a},computedCoins(e){let t=[],n={};return e.forEach(a=>{if(a.coinId===f_){let s={...a,name:a.chainName};t.push(s),n[s.coinId]=s}else t.push(a),n[a.coinId]=a}),r.allCoins=t,r.memStore.updateState({allCoinsMap:r.isAllCoinsFallbacked?n:void 0}),t},async addAndGetServerCustomCoin(e,t,n){let s={headers:r.authController.getRequestHeaders({walletId:e,needSign:!0,currency:"usd"})},{blockChain:i,contractAddress:o,symbol:c,decimals:l}=t,h={userUniqueId:r.preferencesController.getUserUniqueId(),blockChain:i,contractAddress:o,symbol:c,precision:l,accountId:e,protocolId:n},{data:b}=await ja.postAddCoin(h,s);return r.emit("needUpdateCoinsFromServer"),ms(b)}}),aR=yte;d();f();var iR=_(te());ae();d();f();ae();var lg=(r,e,t)=>r.find(n=>n.baseCoinId===e&&Dl(n.address,t,{baseCoinId:e})),sR=(r,e)=>r.find(t=>t.coinId===e),ug=(r,e,t)=>{let{coinId:n}=r,a=me({coinId:n})?.localType;return{blockChain:t.blockChain||"",contractAddress:t.contractAddress||e,symbol:t.symbol||"",decimals:t.precision||0,name:t.name||"",logo:t.logo||"",localType:a,accountValid:!!t.contractAddress,msg:t.msg}};var xte=r=>({getBaseCoins(){let t=st().map(n=>ms(n));return(0,iR.sortBy)(t,n=>n.rank)},getAddedCoins(e){let{addedCoins:t}=r.store.getState();return t[e]||[]},getReducedCoins(e){let{reducedCoins:t}=r.store.getState();return t[e]||[]},async getServerCoinWithTypeAndAddress(e,t){let n=me({localType:e}),a=n?.coinId;if(t){let o=lg(r.allCoins,a,t);if(o)return{coin:o,isFromServer:!1};let c=n?.netWorkId;return{coin:await jx({chainId:c,address:t}),isFromServer:!0}}let s=sR(r.allCoins,a);return s?{coin:s,isFromServer:!1}:{coin:await jx({coinId:a}),isFromServer:!0}},async getWalletBaseCoins(e){let t=this.getBaseCoins(),{walletIdentityMap:n}=this.preferencesController.getAllWalletIdentityMap(),a=Object.keys(n?.[e]?.walletIdentity?.account||{}),s=new Set(a);return t.filter(i=>s.has(i.localType))},async getCustomChains(e){let t=await r.privateGetWalletSupportServerChains(e);return(await this.getBaseCoins()).reduce((s,i)=>{let o=t.find(c=>c.coinId===i.coinId);return o&&s.push(o),s},[])},async getCustomChainWithLocalType(e,t){let n=await this.getCustomChains(t),a=me({localType:e})||{};return n.find(s=>s.coinId===a.coinId)}}),oR=xte;d();f();var wte=r=>({privateAddCoin(e,t){let{addedCoins:n,reducedCoins:a}=r.memStore.getState();Array.isArray(n[e])||(n[e]=[]);let s=d0(t);n[e].find(c=>c.coinId===t.coinId)||n[e].push(s);let{isLocal:o}=s;Array.isArray(a[e])&&!o&&(a[e]=a[e].filter(({coinId:c})=>c!==s.coinId)),r.memStore.updateState({addedCoins:n,reducedCoins:a})},addCoins(e,t){Array.isArray(t)&&t.length&&(t.forEach(n=>{this.privateAddCoin(e,n)}),r.updateStateImmediately())},initAddedCoins(e){let{addedCoins:t}=r.memStore.getState();r.memStore.updateState({addedCoins:{...t,[e]:[]}})},async addCustomCoin(e,t){let{localType:n,protocolId:a,contractAddress:s}=t,{coin:i,isFromServer:o}=await r.getServerCoinWithTypeAndAddress(n,s),c;i&&(!o||i?.platformType===0)?c=i:c=await r.addAndGetServerCustomCoin(e,t,a),this.addCoins(e,[c])}}),cR=wte;d();f();var vte=r=>({privateRemoveCoin(e,t){let{addedCoins:n,reducedCoins:a}=r.store.getState(),s=d0(t),{isLocal:i}=s;i?n[e]=n[e].filter(({localType:o,address:c})=>!(s.localType===o&&s.address===c)):(Array.isArray(a[e])||(a[e]=[]),a[e].find(c=>c.coinId===s.coinId)||a[e].push(s),n[e]=n[e].filter(({coinId:c})=>s.coinId!==c)),r.memStore.updateState({addedCoins:n,reducedCoins:a})},clearCoins(){r.memStore.updateState({addedCoins:{},reducedCoins:{}})},removeWalletCoins(e){let{addedCoins:t}=r.store.getState();delete t[e],r.memStore.updateState({addedCoins:t})},removeCoins(e,t){Array.isArray(t)&&t.length&&(t.forEach(n=>{this.privateRemoveCoin(e,n)}),r.updateStateImmediately())}}),dR=vte;d();f();ne();var Ste=r=>({queryLocalCoin(e,t){let{coinId:n}=e;return lg(r.allCoins,n,t)},async queryServerCustomCoin({walletId:e,chain:t,contractAddress:n,account:a,protocolId:s}){let i=this.queryLocalCoin(t,n),{shortName:o,coinId:c}=t;if(i)return ug(t,n,{blockChain:o,contractAddress:n,symbol:i.symbol,precision:i.decimals});let l=r.authController.getRequestHeaders({walletId:e,needSign:!0,currency:"usd"});try{if(c===c_){let{data:h={}}=await ja.getWaxCustomCoin({coinId:c,symbol:n,account:a,accountId:e},{headers:l});return ug(t,n,h)}}catch{return{}}let{data:u={}}=await ja.getCustomCoin({coinId:c,contractAddress:n,protocolId:s},{headers:l});return ug(t,n,u)},async queryXRC20CoinProtocolList(){let{data:e={}}=await ja.getXRC20ProtocolList({chainId:0});return e},async queryCustomCoin(e){return this.queryServerCustomCoin(e)}}),fR=Ste;var C1=class extends ge{constructor(e){super(),Vd(this,aR,oR,cR,dR,fR);let t={addedCoins:{},reducedCoins:{},isPatched:!0,...e.initState};this.store=new A1.ObservableStore(t);let n=(0,hg.clone)(t);delete n.isPatched,this.memStore=new A1.ObservableStore({...n}),this.memStore.subscribe(a=>{let{addedCoins:s={},reducedCoins:i={}}=a;this.store.updateState({addedCoins:s,reducedCoins:i})}),this.preferencesController=e.preferencesController,this.keyringController=e.keyringController,this.walletCreateController=e.walletCreateController,this.authController=e.authController,this.networkController=e.networkController,this.updateStateImmediately=e.updateStateImmediately,this.isAllCoinsFallbacked=!1,this.chainController=e.chainController,this.allCoins=[],this.supportCustomChains=[],this.getSupportCustomChains()}fallbackAllCoinsMap(){this.isAllCoinsFallbacked=!0;let e=this.allCoins.reduce((t,n)=>(t[n.coinId]=n,t),{});this.memStore.updateState({allCoinsMap:e})}async getSyncBaseCoins(){this.supportCustomChains.length===0&&await this.getSupportCustomChains();let{supportCustomChains:e}=this;return st().reduce((n,a)=>{let s=e.find(i=>a.coinId===i.coinId);return s&&n.push({...a,blockChain:s.shortName}),n},[])}async batchToServer(e,t=!1){let n=[];if(!e.length)return n;let{addedCoins:a}=this.store.getState(),s={},i=Object.values(a).reduce((o,c)=>(c.forEach(l=>{let{isLocal:u,localType:h,address:b,symbol:y,decimals:v,platformType:S}=l,R=`${h}${c0}${b}`,P=e.find(N=>N.localType===h);(u||t&&S===1)&&P&&b&&!s[R]&&(s[R]=l,o.push({blockChain:P.blockChain,contractAddress:b,symbol:y,precision:v}))}),o),[]);if(i.length){let o=this.keyringController.getWallets(),l={headers:this.authController.getRequestHeaders({walletId:o[0].walletId,needSign:!0,currency:"usd"})},u=this.preferencesController.getUserUniqueId(),h=(0,hg.chunk)(i,20);for(let b=0,{length:y}=h;b<y;b++){let{data:v}=await ja.postAddCoinBatch({coinList:h[b],userUniqueId:u},l);n=n.concat(v)}}return t&&this.store.updateState({isPatched:!0}),n}async addCoinBatchToServerForPatch(){if(this.store.getState().isPatched)return;let e=await this.getSyncBaseCoins();if(e.length){let t=await this.batchToServer(e,!0);this.privateUpdateAddedCoins(t),t?.length>0&&this.emit("needUpdateCoinsFromServer")}}async privateGetWalletSupportServerChains(e){this.supportCustomChains.length===0&&await this.getSupportCustomChains();let t=this.walletCreateController.getWalletCreatedAddress(e);return this.supportCustomChains.filter(a=>t.some(i=>a.coinId===i.coinId))}privateUpdateAddedServerCoins(e){if(!e.length)return!1;let{addedCoins:t}=this.store.getState(),n=new Map;Object.values(t).forEach(s=>{s.forEach(({isLocal:i,coinId:o})=>{!i&&!n.get(o)&&n.set(o,!0)})});let a=e.filter(({coinId:s})=>n.get(s));return this.privateUpdateAddedCoins(a,!1)}privateUpdateAddedCoins(e,t=!0){if(!e.length)return!1;let{addedCoins:n}=this.store.getState(),a=e.reduce((i,o)=>{let l=`${me({coinId:o.baseCoinId})?.localType||me({coinId:o.coinId})?.localType}${c0}${o.address?.toLowerCase()}`;return i.set(l,o),i},new Map),s=Object.entries(n).reduce((i,[o,c])=>{let l=c.map(u=>{let h=`${u.localType}${c0}${u.address?.toLowerCase()}`,b=a.get(h);if(b){let y=t?ms(b):b;return{...u,...y}}return u});return i[o]=l,i},{});return this.memStore.updateState({addedCoins:s}),!0}},lR=C1;d();f();Be();var mR=_(Ne());d();f();var _te=r=>({async getCustomCoinInfo({contractAddress:e,chainInfo:t,account:n,isFacet:a,protocolId:s}){let o={walletId:r.preferencesController.getSelectedWallet(),contractAddress:e,chain:t,account:n,isFacet:a,protocolId:s};return await r.coinController.queryCustomCoin(o)}}),uR=_te;d();f();var Ate=r=>({async addCustomCoin(e){let t=r.preferencesController.getSelectedWallet();await r.coinController.addCustomCoin(t,e)},addCrypto(e){if(Array.isArray(e))e.forEach(t=>{r.addCrypto(t)});else{let t=r.preferencesController.getSelectedWallet();r.coinController.addCoins(t,e.aggregation?e.childrenCoin:[e])}},removeServerCoins(e){if(Array.isArray(e))e.forEach(t=>{r.removeServerCoins(t)});else{let t=r.preferencesController.getSelectedWallet();r.coinController.removeCoins(t,e.aggregation?e.childrenCoin:[e])}}}),hR=Ate;d();f();var pR={supportNetworkList:[]};var T1=class extends ge{constructor(e){super(),Vd(this,uR,hR);let t=pR;this.memStore=new mR.ObservableStore(t),this.preferencesController=e.preferencesController,this.currencyController=e.currencyController,this.balanceController=e.balanceController,this.coinController=e.coinController,this.chainController=e.chainController}},gR=T1;d();f();var $d=_(yn());var Eu=class{constructor({preferencesController:e}){le(this,"config",[{id:"contextMenuSearchOklink",title:"",type:"normal",contexts:["selection"],localMessageKey:"wallet_extension_placeholder_go_to_oklink",isCreate:!1}]);le(this,"currentLocale","");e.store.subscribe(t=>{this.currentLocale!==t.currentLocale&&(this.currentLocale=t.currentLocale,this.config.forEach(n=>{n.title=e.translate(n.localMessageKey)}),this.toggleMenu())}),$d.default?.contextMenus?.onClicked.addListener((t,n)=>{let a=t.menuItemId;this[a]&&this[a](t,n)})}toggleMenu(){this.config.forEach(e=>{if(!e.title)return;let t={title:e.title,type:e.type,contexts:e.contexts,id:e.id};if(e.isCreate)$d.default?.contextMenus?.remove(e.id),$d.default?.contextMenus?.create(t);else try{$d.default?.contextMenus?.create(t),e.isCreate=!0}catch(n){console.error(n)}})}contextMenuSearchOklink(e,t){let n=new URL(`https://www.oklink.com/multi-search#key=${e.selectionText}`);$d.default?.tabs.create({url:n.href,index:t.index+1})}};d();f();Be();var I1=_(Ne());d();f();ur();Wt();var Cte={getCurrencies(r){return zr(ce.getCurrenciesUrl,r)},getMarket(r,e){return Pe(ce.postMarketUrl,r,e)}},bR=Cte;var Tte={zh:"zh_CN",zh_CN:"zh_CN","zh-CN":"zh_CN",en:"en_US",en_US:"en_US","en-US":"en_US"},E1=class extends ge{constructor(e){super();let t={currencies:[],selectedCurrency:{},...e.initState};this.store=new I1.ObservableStore(t),this.updateStateImmediately=e.updateStateImmediately,this.memStore=new I1.ObservableStore({...t}),this.preferencesController=e.preferencesController,this.store.subscribe(this.memStore.updateState.bind(this.memStore))}async getCurrencies(){let{currentLocale:e}=this.preferencesController.store.getState(),{selectedCurrency:t}=this.store.getState(),n={locale:Tte[e]||"en_US"},{data:a}=await bR.getCurrencies(n),s=en(t)?this.privateGetDefaultCurrency(a):a.find(i=>i.currencyId===t.currencyId);this.store.updateState({currencies:a,selectedCurrency:s})}setSelectedCurrency(e){let{currencies:t}=this.store.getState(),n=t.find(a=>a.currencyId===e);if(!n)throw new Error("cant find currency with currencyId");this.store.updateState({selectedCurrency:n})}privateGetDefaultCurrency(e){return e.find(n=>n.isDefault)||{}}},yR=E1;d();f();An();var Ite=["RECEIVE_REQUEST","OPEN_POPUP","RENDER_TEMPLATE","CAN_CONFIRM","CLICK_CONFIRM","SIGN","START_PUBLISH","FINISH_PUBLISH","END_REQUEST"],Ete=["RECEIVE_REQUEST","CLICK_CONFIRM"],Pte=1e3,P1=class{constructor(){this.collectionMap={}}checkAndReport(e){let t=this.collectionMap[e]||{},{collectionTimes:n=[]}=t,a=n.find(c=>c.stage==="END_REQUEST"),s=a&&a.timestamp>0,i=n.every(c=>c.timestamp>0);if(!s||!i)return;let o=!1;for(let c=1;c<n.length;c++){let l=n[c-1],u=n[c],h=u.timestamp-l.timestamp;u.timeSpent=h,!Ete.includes(u.stage)&&h>Pte&&(o=!0)}o&&Ae.captureEvent({tags:{address:t.address},message:"BIZ_INFO_tradeProcess",contexts:{report:{info:JSON.stringify(t)}},exception:{values:[{type:"BIZ_INFO_tradeProcess",value:t.address}]},level:"info"})}updateReportTimestamp(e,t,n={}){try{let a=this.collectionMap[e];if(a){let{collectionTimes:s}=a,i=s.find(o=>o.stage===t);i&&(i.timestamp=Date.now())}else{this.collectionMap[e]={localType:n.localType||"",method:n.method||"",address:n.address||"",collectionTimes:Ite.reduce((i,o)=>(i.push({stage:o,timestamp:0,timeSpent:0}),i),[])};let s=this.collectionMap[e].collectionTimes.find(i=>i.stage===t);s&&(s.timestamp=Date.now())}return this.checkAndReport(e),this.collectionMap[e]}catch(a){console.log(a)}return null}},wR=P1;d();f();var Xk=_(Ne()),Zk=_(Ce()),Qk=_(te()),eO=_(Pr());Ge();ae();ne();d();f();var xk=_(Pr()),ku=_(te()),wk=_(Ne());var G1=_(Fr());Ge();d();f();d();f();var Mte=(r,e)=>`${r}:${e}`,Uo=r=>Mte(r,u8.FINISHED);d();f();var Nte=r=>{let e=r.params?.message||"",t=typeof e=="string"?e:new TextDecoder().decode(e);return{...r.params,message:t}};var M1=(r,e=Te.SIGN_TRANSACTION)=>{if(r instanceof R0)return{serializedMessage:$n(r,Io.TRANSACTION),instanceType:Io.TRANSACTION,needToReplaceRecentBlockhash:!r.recentBlockhash};if(r instanceof wd){let t=r.message;return{serializedMessage:$n(r,Io.VERSIONED_TRANSACTION),instanceType:Io.VERSIONED_TRANSACTION,needToReplaceRecentBlockhash:!t.recentBlockhash}}throw new Error(`the params of ${e} should be instance of Transaction or VersionedTransaction of @solana/web3.js`)},Rte=r=>{let e=r.params?.message;return{...r.params,message:[M1(e,Te.SIGN_TRANSACTION)]}},kte=r=>{let e=r.params?.message;if(!li(e))throw new Error(`the params of ${Te.SIGN_ALL_TRANSACTIONS} should be array`);let t=e.map(a=>M1(a,Te.SIGN_ALL_TRANSACTIONS));return{...r.params,message:t}},Ote=r=>{let e=r.params?.message;return{...r.params,message:[M1(e,Te.SIGN_AND_SEND_TRANSACTION)]}},vR=r=>r.method===Te.SIGN_MESSAGE||r.method===Te.RPC_SIGN_MESSAGE?Nte(r):r.method===Te.SIGN_TRANSACTION||r.method===Te.RPC_SIGN_TRANSACTION?Rte(r):r.method===Te.SIGN_ALL_TRANSACTIONS||r.method===Te.RPC_SIGN_ALL_TRANSACTIONS?kte(r):r.method===Te.SIGN_AND_SEND_TRANSACTION||r.method===Te.RPC_SIGN_AND_SEND_TRANSACTION?Ote(r):r.params;d();f();var SR=_(xd());function Dte(r){let{params:e}=r;if(!e.message)throw new Error("the 'message' should not be empty!");e.message&&!e.nonce&&(e.nonce=rn());let t=`APTOS
`;return e.address&&(t+=`address: ${e.address}
`),e.application&&(t+=`application: ${e.application}
`),e.chainId&&(t+=`chainId: ${e.chainId}
`),t+=`message: ${e.message}
`,t+=`nonce: ${e.nonce}`,t}function Lte(r,e="dapp",t=ii.RAW){let{params:n}=r,{transaction:a}=n,s=t===ii.HEX_STRING?p.Buffer.from(SR.default.decode(a)).toString("hex"):JSON.stringify(a);return{type:e,base:{sequenceNumber:"",chainId:0,maxGasAmount:"",gasUnitPrice:"",expirationTimestampSecs:""},data:{abi:"[]",data:s,type:t}}}function N1(r,e,t){return r.method===Kt.SIGN_MESSAGE?Dte(r):r.method===Kt.SIGN_TRANSACTION||r.method===Kt.SIGN_AND_SUBMIT_TRANSACTION?Lte(r,e,t):r.params}d();f();var Or=_(sm()),ef=_(U$()),dk=_(ck()),mn=_(te()),Ig=_(Gn()),fk=_(y9()),H1=_(Zs());var lk=r=>{let{coinType:e}=gd(r)||{};return[H1.Currency.INJ,H1.Currency.EVMOS].includes(e)},Ru={MESSAGE:"message",TRANSACTION:"transaction"};function dre(r){let e=r.indexOf("1");return r.slice(0,e)}function fre(r,e){if(!(()=>r&&r.msgs&&Array.isArray(r.msgs)&&r.msgs.length===1?r.msgs[0].type==="sign/MsgSignData":!1)())return!1;if(r.chain_id!=="")throw new Error("Chain id should be empty string for ADR-36 signing");if(r.memo!=="")throw new Error("Memo should be empty string for ADR-36 signing");if(r.account_number!=="0")throw new Error('Account number should be "0" for ADR-36 signing');if(r.sequence!=="0")throw new Error('Sequence should be "0" for ADR-36 signing');if(r.fee.gas!=="0")throw new Error('Gas should be "0" for ADR-36 signing');if(r.fee.amount.length!==0)throw new Error("Fee amount should be empty array for ADR-36 signing");let n=r.msgs[0];if(n.type!=="sign/MsgSignData")throw new Error(`Invalid type of ADR-36 sign msg: ${n.type}`);if(!n.value)throw new Error("Empty value in the msg");let a=n.value.signer;if(!a)throw new Error("Empty signer in the ADR-36 msg");if(!/^[\x21-\x7e]{1,83}1[02-9ac-hj-np-z]{38,58}$/.test(a)||!a.includes(e))throw new Error("Signer format error");let i=n.value.data;if(!i)throw new Error("Empty data in the ADR-36 msg");let o=(0,Or.fromBase64)(i);if((0,Or.toBase64)(o)!==i)throw new Error("Data is not encoded by base64");if(o.length===0)throw new Error("Empty data in the ADR-36 msg");return!0}function Tg(r){if(typeof r!="object"||r===null)return r;if(Array.isArray(r))return r.map(Tg);let e=Object.keys(r).sort(),t={};return e.forEach(n=>{t[n]=Tg(r[n])}),t}function lre(r){return JSON.stringify(Tg(r))}function ure(r){return r?r.replace(/</g,"\\u003c").replace(/>/g,"\\u003e").replace(/&/g,"\\u0026"):""}function uk(r,e,t){let n=e;return t||(typeof n=="string"?n=(0,Or.toBase64)(p.Buffer.from(n)):Td(n)instanceof Uint8Array&&(n=(0,Or.toBase64)(Td(n)))),{chain_id:"",account_number:"0",sequence:"0",fee:{gas:"0",amount:[]},msgs:[{type:"sign/MsgSignData",value:{signer:r,data:n}}],memo:""}}function hre(r,e){return new Uint8Array(e?(0,Ig.keccak256)(r):(0,Ig.sha256)(r))}function pre(r,e,t){if(r.length!==32)throw new Error(`Invalid length of digest to verify: ${r.length}`);if(t.length!==64)throw new Error(`Invalid length of signature: ${t.length}`);let n=new dk.ec("secp256k1"),a=t.slice(0,32),s=t.slice(32),i=n.keyFromPublic((0,Or.toHex)(e),"hex");return n.verify(r,{r:(0,Or.toHex)(a),s:(0,Or.toHex)(s)},i)}function hk(r,e){let{signer:t,data:n,signature:a}=r,s=uk(t,n),i=p.Buffer.from(lre(s));return pre(hre(i,e),(0,Or.fromBase64)(a.pub_key.value),(0,Or.fromBase64)(a.signature))}async function mre(r,e){let{preferNoSetFee:t,serverFee:n}=e,a=r;return!t&&n&&((0,mn.set)(a,"fee.gas",n.gas),(0,mn.set)(a,"fee.amount",n.amount)),a}async function gre(r,e){let{preferNoSetFee:t,serverFee:n}=e,a=r;if(!t&&n){let s=ef.AuthInfo.decode(r.authInfoBytes);(0,mn.set)(s,"fee.gasLimit",fk.default.fromString(n.gas)),(0,mn.set)(s,"fee.amount",n.amount),(0,mn.set)(a,"authInfoBytes",ef.AuthInfo.encode(s).finish())}return a}async function pk(r){let{params:e,address:t,extraParams:n}=r,{transaction:a}=e,{signer:s,signDoc:i,signOptions:o}=a,{serverFee:c,preferNoSetFee:l}=n;if((0,mn.isNil)(i)||(0,mn.isEmpty)(i))throw new Error("signDoc is required");let u=dre(t),h=fre(i,u);if(h&&i.msgs[0].value.signer!==s)throw new Error("Unmatched signer in sign doc");if(o.isADR36WithString!=null&&!h)throw new Error('Sign doc is not for ADR-36. But, "isADR36WithString" option is defined');if(o.ethSignType&&!h)throw new Error("Eth sign type can be requested with only ADR-36 amino sign doc");let b=await mre(i,{preferNoSetFee:l,serverFee:c});return b.memo=ure(i.memo),{...a,signDoc:Tg(b)}}async function mk(r){let{params:e,extraParams:t}=r,{transaction:n}=e,{signDoc:a}=n,{serverFee:s,preferNoSetFee:i}=t;if((0,mn.isNil)(a)||(0,mn.isEmpty)(a))throw new Error("signDoc is required");if(!a.bodyBytes)throw new Error("bodyBytes is required");if(!a.authInfoBytes)throw new Error("authInfoBytes is required");if(!a.chainId)throw new Error("chainId is required");if(!a.accountNumber)throw new Error("accountNumber is required");typeof a.accountNumber=="object"&&(a.accountNumber=a.accountNumber.toString());let o=await gre(a,{preferNoSetFee:i,serverFee:s}),c=o.bodyBytes instanceof Uint8Array?(0,Or.toHex)(o.bodyBytes):o.bodyBytes,l=o.authInfoBytes instanceof Uint8Array?(0,Or.toHex)(o.authInfoBytes):o.authInfoBytes,u={accountNumber:(0,mn.toString)(o.accountNumber),chainId:o.chainId,body:c,authInfo:l};return{...n,signDoc:u}}function gk(r){let{params:e}=r,{transaction:t}=e,{chainId:n,signer:a,data:s,resultType:i}=t,o=typeof s=="string",c=uk(a,s,i==="amino");return{chainId:n,signer:a,signDoc:c,signOptions:{isADR36WithString:o,preferNoSetFee:!0}}}function bk(r){let{params:e}=r,{transaction:t}=e,{data:n,type:a}=t,s;if(a===Ru.MESSAGE)s={type:1,message:n};else if(a===Ru.TRANSACTION){let i=typeof n=="string"?n:p.Buffer.from(n).toString(),o=JSON.parse(i);if(o.maxFeePerGas||o.maxPriorityFeePerGas)throw new Error("1559 not supported for now");s={...o,nonce:$e(o.nonce),value:$e(o.value),gasPrice:$e(o.gasPrice),gasLimit:$e(o.gasLimit||o.gas)}}else throw new Error("other message type not implement for now");return s}function yk(r){let{params:e}=r,{transaction:t}=e,{tx:n}=t,a=n;if((0,mn.isNil)(n))throw new Error("tx format invalid");if(n.chain_id)n.bodyBytes instanceof Uint8Array||(n.bodyBytes=(0,Or.fromHex)(n.bodyBytes)),n.authInfoBytes instanceof Uint8Array||(n.authInfoBytes=(0,Or.fromHex)(n.authInfoBytes)),a=ef.TxRaw.encode(ef.TxRaw.fromJSON(n)).finish();else if(!(n instanceof Uint8Array))throw new Error("tx format invalid");return(0,Or.toBase64)(a)}var z1=class extends xk.default{constructor(e={}){super(),this.preferencesController=e.preferencesController,this.store=new wk.ObservableStore({requests:{},...e.initState})}generateRequestMeta(e){return{id:rn(),time:new Date().getTime(),status:qe.UNAPPROVED,...e}}updateRequestMeta(e={}){let t=e.id;this.store.updateState({requests:{...this.store.getState().requests,[t]:e}})}getRequest(e){let{requests:t}=this.store.getState();return t[e]}deleteRequest(e){let{requests:t}=this.store.getState();delete t[e],this.store.updateState({requests:t})}setRequestStatus(e,t){let n=this.getRequest(e);if(!n)return;let a={...n,status:t};try{if(this.updateRequestMeta(a),[qe.SUBMITTED,qe.REJECTED,qe.FAILED].includes(t)){let s=Uo(a.id);this.emit(s,a),R9(a)}}catch(s){G1.default.error(s)}}setRequestStatusSubmitted(e){this.setRequestStatus(e,qe.SUBMITTED)}setRequestStatusRejected(e){this.setRequestStatus(e,qe.REJECTED),this.deleteRequest(e)}setRequestStatusFailed(e,t){let a={...this.getRequest(e),err:{message:t.toString()}};this.updateRequestMeta(a),this.setRequestStatus(e,qe.FAILED)}getUnapprovedRequests(){let{requests:e}=this.store.getState(),t=(0,ku.pickBy)(e,n=>n.status===qe.UNAPPROVED);return(0,ku.sortBy)(t,n=>n.time)}clearUnapproved(){let{requests:e}=this.store.getState(),t=(0,ku.pickBy)(e,n=>n.status!==qe.UNAPPROVED);try{let n=this.preferencesController.getWalletIdentityMap(),a=Object.values(e).reduce((s,i)=>{if(i.status===qe.UNAPPROVED){let o=i?.localType,c={networkType:o,from:n?.[i?.walletId]?.account?.[o]};return this.setRequestStatusRejected(i.id),[...s,c]}return s},[]);a.length&&ri({txInfos:a})}catch(n){G1.default.error(n)}this.store.updateState({requests:t})}},vk=z1;d();f();d();f();var Sk=_(Pr());var j1=class extends Sk.default{constructor({preferencesController:e,dappStateManager:t}={}){super(),this.preferencesController=e,this.dappStateManager=t}getWalletId(){return this.preferencesController.getSelectedWallet()}serializeRequestParams(e){return e.params}approveRequest(){throw new Error("Not implemented.")}getError(e){switch(e.status){case qe.REJECTED:return new Error("Request Signature: User denied request signature.");case qe.FAILED:return new Error(e.err?.message);default:return new Error(`Dapp Request Signature: Unknown problem: ${e.id}`)}}},Re=j1;d();f();var Ti=_(xd());ae();var V1=class extends Re{constructor({preferencesController:e,dappStateManager:t,keyringController:n,authController:a,publishTransactionToServer:s}={}){super({preferencesController:e}),this.dappStateManager=t,this.keyringController=n,this.authController=a,this.publishTransactionToServer=s}serializeRequestParams(e){return vR(e)}async approveRequestOfSignMessage(e){let{walletId:t,localType:n,params:a,id:s}=e,i=await this.keyringController.getAccountByWalletIdAndLocalType(t,n),o=a?.message||"",c=Ti.default.encode(new TextEncoder().encode(o)),l=await this.keyringController.signCommonMessage(i,c,Pn),u={...e,result:{signature:l,publicKey:i}};return this.dappStateManager.updateRequestMeta(u),this.dappStateManager.setRequestStatusSubmitted(s),this.dappStateManager.getRequest(s)}async privateHandleSignTransaction(e,t,n){let{instanceType:a,serializedMessage:s,needToReplaceRecentBlockhash:i}=t,o="",c,l="";if(a===Io.TRANSACTION){if(c=R0.from(Ti.default.decode(s)),i){let h=await zx({coinId:n,address:e},{fromAddr:e});c.recentBlockhash=h}let u=Ti.default.encode(c.serializeMessage());o=await this.keyringController.signCommonMessage(e,u,Pn),c.addSignature(new Ll(e),Ti.default.decode(o)),l=$n(c,a)}else{c=wd.deserialize(Ti.default.decode(s));let u=c.message;if(i){let b=await zx({coinId:n,address:e},{fromAddr:e});u.recentBlockhash=b}let h=Ti.default.encode(u.serialize());o=await this.keyringController.signCommonMessage(e,h,Pn),c.addSignature(new Ll(e),Ti.default.decode(o)),l=$n(c,a)}return{signature:o,tx:c,serializedTransaction:l,type:a}}async approveRequestOfSignTransaction(e){let{walletId:t,localType:n,params:a,id:s,extraParams:i}=e,o=await this.keyringController.getAccountByWalletIdAndLocalType(t,n),c=a?.message||[],h=(i?.replacedTransactions||c)[0],{serializedTransaction:b}=await this.privateHandleSignTransaction(o,h,i?.coinId),y={...e,result:{serializedTransaction:b}};return this.dappStateManager.updateRequestMeta(y),this.dappStateManager.setRequestStatusSubmitted(s),this.dappStateManager.getRequest(s)}async approveRequestOfSignAllTransactions(e){let{walletId:t,localType:n,params:a,id:s,extraParams:i}=e,o=await this.keyringController.getAccountByWalletIdAndLocalType(t,n),c=a?.message,u=i?.replacedTransactions||c,b=(await Promise.all(u.map(v=>this.privateHandleSignTransaction(o,v,i?.coinId)))).map(({serializedTransaction:v,type:S})=>({serializedTransaction:v,type:S})),y={...e,result:{signedTransactionResults:b}};return this.dappStateManager.updateRequestMeta(y),this.dappStateManager.setRequestStatusSubmitted(s),this.dappStateManager.getRequest(s)}async approveRequestOfSignAndSendTransaction(e){let{walletId:t,localType:n,params:a,id:s,extraParams:i}=e,o=await this.keyringController.getAccountByWalletIdAndLocalType(t,n),c=a?.message,h=(i?.replacedTransactions||c)[0],{serializedTransaction:b,signature:y}=await this.privateHandleSignTransaction(o,h,i?.coinId),v=await je(Pn,b),S={txSource:a?.okxArgs?.txSource??fe.DAPP,txType:a?.okxArgs?.txType,signedTx:b,fromAdr:o,serviceCharge:i.serviceCharge||5e3,toAdr:"",coinAmount:0,coinId:i?.coinId,txHash:v};await this.publishTransactionToServer({publishParams:S,walletId:t});let R={...e,result:{signature:y,publicKey:o}};return this.dappStateManager.updateRequestMeta(R),this.dappStateManager.setRequestStatusSubmitted(s),this.dappStateManager.getRequest(s)}async approveRequest(e){return e.method===Te.SIGN_MESSAGE||e.method===Te.RPC_SIGN_MESSAGE?this.approveRequestOfSignMessage(e):e.method===Te.SIGN_TRANSACTION||e.method===Te.RPC_SIGN_TRANSACTION?this.approveRequestOfSignTransaction(e):e.method===Te.SIGN_ALL_TRANSACTIONS||e.method===Te.RPC_SIGN_ALL_TRANSACTIONS?this.approveRequestOfSignAllTransactions(e):e.method===Te.SIGN_AND_SEND_TRANSACTION||e.method===Te.RPC_SIGN_AND_SEND_TRANSACTION?this.approveRequestOfSignAndSendTransaction(e):{}}},_k=V1;d();f();var Ou=_(te());ae();function Ak(r){let{transaction:e,extParams:t}=r.params;return lT(e,t?.dataType)}var $1=class extends Re{constructor({preferencesController:e,dappStateManager:t,keyringController:n,authController:a}={}){super({preferencesController:e}),this.dappStateManager=t,this.keyringController=n,this.authController=a}async approveRequestOfSignMessage(e){let{walletId:t,id:n}=e,{localType:a}=await Ad(Rn)||{},s=await this.keyringController.getAccountByWalletIdAndLocalType(t,a),i=N1(e),o=await this.keyringController.signCommonMessage(s,i,us),c={...e,localType:a,result:{signature:o,prefix:"APTOS",fullMessage:i,...e.params}};return this.dappStateManager.updateRequestMeta(c),this.dappStateManager.setRequestStatusSubmitted(n),this.dappStateManager.getRequest(n)}async getTransactionResult(e,t="dapp",n){let{walletId:a,params:s}=e,{coinId:i,chainId:o,localType:c}=await Ad(Rn)||{},l=await this.keyringController.getAccountByWalletIdAndLocalType(a,c),u=N1(e,t,s.extParams?.dataType),h={coinId:i,address:l},{contractAddress:b,moduleName:y}=Ak(e),v={fromAddr:l,toAddr:b},{info:S}=await Sd(h,v);if(s?.options?.gas_unit_price&&s?.options?.max_gas_amount){let{expiration_timestamp_secs:M,gas_unit_price:L,max_gas_amount:B,sequence_number:F}=s?.options||{};u.base={expirationTimestampSecs:M||S?.expirationTimestampSecs,gasUnitPrice:L,maxGasAmount:B,sequenceNumber:F||S?.sequenceNumber,sender:l,chainId:S?.chainId}}else n&&(S.maxGasAmount=n),u.base={...S,sender:l};if(s.extParams?.dataType!==ii.HEX_STRING){let M=await B0({address:b,name:y,chainIndex:o});if(M.error_code)throw new Error(M.message);u.data.abi=JSON.stringify(M)}let R=e.extraParams||{},P={...e,localType:c,extraParams:{...R,signInfo:S}};return this.dappStateManager.updateRequestMeta(P),await this.keyringController.signTransaction(u,l,us)}async approveRequestOfSignTransaction(e){let{id:t}=e,n=await this.getTransactionResult(e),a={...e,result:n};return this.dappStateManager.updateRequestMeta(a),this.dappStateManager.setRequestStatusSubmitted(t),this.dappStateManager.getRequest(t)}async approveRequestOfSignAndSubmitTransaction(e){let{walletId:t,params:n,id:a,extraParams:s}=e,{coinId:i,localType:o}=await Ad(Rn)||{},{signInfo:c}=s||{},l=await this.getTransactionResult(e,"dapp",s.maxGasAmount),u=await this.keyringController.getAccountByWalletIdAndLocalType(t,o),{contractAddress:h}=Ak(e),b=await je(o,l),y=await this.authController.getSignRequestHeaders({walletId:t}),v=this.preferencesController.getServerWalletTypeByWalletId(t),S={headers:y},R={nonce:c?.sequenceNumber},P={signedTx:l,txSource:fe.DAPP,fromAdr:u,serviceCharge:s.serviceCharge||5e3,toAdr:h,coinAmount:0,coinId:i,extJson:JSON.stringify(R),txHash:b,accountId:t,walletType:v};await tr(P,S);let N={};for(let B in c)if(Object.hasOwnProperty.call(c,B)){let F=(0,Ou.snakeCase)(B),K=(0,Ou.toString)(c[B]);N[F]=(0,Ou.toString)(K)}let M=await this.keyringController.getPublicKey(u,us),L={...e,localType:o,result:{...N,payload:n.transaction,sender:u,hash:b,signature:{type:"ed25519_signature",signature:l,public_key:M}}};return this.dappStateManager.updateRequestMeta(L),this.dappStateManager.setRequestStatusSubmitted(a),this.dappStateManager.getRequest(a)}async approveRequest(e){return e.method===Kt.SIGN_MESSAGE?this.approveRequestOfSignMessage(e):e.method===Kt.SIGN_TRANSACTION?this.approveRequestOfSignTransaction(e):e.method===Kt.SIGN_AND_SUBMIT_TRANSACTION?this.approveRequestOfSignAndSubmitTransaction(e):{}}},Ck=$1;d();f();var Y1=_(te()),Tk=_(F0());ae();d();f();var Du=_(kx()),Eg=_(p$()),Pg=r=>{let e=(0,Du.fromHex)(r.raw_data_hex),t=Eg.protocol.Transaction.raw.decode(Uint8Array.from(e)),n=r.signature.map(i=>Uint8Array.from((0,Du.fromHex)(i))),a=Eg.protocol.Transaction.create({rawData:t,signature:n}),s=Eg.protocol.Transaction.encode(a).finish();return(0,Du.toHex)(s)};async function X1(r,e){let t={result:!1,transaction:r?.params?.signedTx};try{let{walletId:n,localType:a,params:s}=r,{signedTx:i,isOffline:o,extParams:c={}}=s,l=await e.keyringController.getAccountByWalletIdAndLocalType(n,a),u=await e.authController.getSignRequestHeaders({walletId:n}),h=e.preferencesController.getServerWalletTypeByWalletId(n),b={headers:u},y=Pg(i),v=Tk.default.address.fromHex((0,Y1.get)(i,"raw_data.contract[0].parameter.value.contract_address",l)),S=(0,Y1.get)(i,"raw_data.contract[0].parameter.value.data",""),{info:{fee:R}}=await L0({coinId:xo,address:l},{fromAddr:l,scenario:fd.SCENARIO_INTERACTION,inputData:S,toAddr:v,dataLength:S.length}),{orderId:P,crossChain:N,chainId:M,tokenAddress:L,amount:B,toChainId:F,toTokenAddress:K}=c,H={signedTx:y,txSource:fe.DAPP,fromAdr:l,toAdr:v,coinAmount:0,coinId:xo,serviceCharge:R,txHash:await je(Un,y),accountId:n,walletType:h};return P&&(H={...H,txSource:fe.DEX,orderId:P,crossChain:N,chainId:M,tokenAddress:L,amount:B,toChainId:F,toTokenAddress:K}),o?H:(P?await rr(H,b):await tr(H,b),t.result=!0,t.transaction=i,t)}catch{t.result=!1}return t}var J1=class extends Re{constructor({preferencesController:e,dappStateManager:t,keyringController:n,authController:a}={}){super({preferencesController:e}),this.dappStateManager=t,this.keyringController=n,this.authController=a}async approveRequestOfSignMessage(e){let{walletId:t,localType:n,id:a,params:s}=e,i=await this.keyringController.getAccountByWalletIdAndLocalType(t,n),{message:o}=s;x5(o)||(o=`0x${p.Buffer.from(o,"utf8").toString("hex")}`);let c={type:"hex",message:o},l=await this.keyringController.signCommonMessage(i,c,Un),u={...e,result:l};return this.dappStateManager.updateRequestMeta(u),this.dappStateManager.setRequestStatusSubmitted(a),this.dappStateManager.getRequest(a)}async approveRequestOfSignMessageV2(e){let{walletId:t,localType:n,id:a,params:s}=e,i=await this.keyringController.getAccountByWalletIdAndLocalType(t,n),{message:o}=s,c={type:"v2",message:o},l=await this.keyringController.signCommonMessage(i,c,Un),u={...e,result:l};return this.dappStateManager.updateRequestMeta(u),this.dappStateManager.setRequestStatusSubmitted(a),this.dappStateManager.getRequest(a)}async approveRequestOfSignTransaction(e){let{walletId:t,localType:n,id:a,params:s}=e,{transaction:i,isOffline:o,extParams:c}=s,l=await this.keyringController.getAccountByWalletIdAndLocalType(t,n),u={type:"legacy",message:JSON.stringify(i)},h=await this.keyringController.signCommonMessage(l,u,Un),b=JSON.parse(h);b.extParams=c;let y={...e,result:b};if(o){let v=await X1({...e,params:{...e.params,signedTx:b}},this);y.offlineParams=v}return this.dappStateManager.updateRequestMeta(y),this.dappStateManager.setRequestStatusSubmitted(a),this.dappStateManager.getRequest(a)}async approveRequest(e){return e.method===$r.SIGN_MESSAGE||e.method===$r.RPC_SIGN_MESSAGE?this.approveRequestOfSignMessage(e):e.method===$r.SIGN_TRANSACTION||e.method===$r.RPC_SIGN_TRANSACTION?this.approveRequestOfSignTransaction(e):e.method===$r.SIGN_MESSAGE_V2?this.approveRequestOfSignMessageV2(e):{}}},Ik=J1;d();f();var Mg=_(Ce());d();f();var na=_(Ce());Ge();ae();var Ek={from:r=>gr(r),to:(r,e)=>e?gr(r).toLowerCase():gr(r),nonce:r=>gr(r),value:r=>gr(r),data:r=>gr(r),gas:r=>gr(r),gasPrice:r=>gr(r),type:r=>gr(r),maxFeePerGas:r=>gr(r),maxPriorityFeePerGas:r=>gr(r)};function Lu(r,e=!0){let t={},n={gas:r.gasLimit,...r};for(let a in Ek)n[a]&&(t[a]=Ek[a](r[a],e));return t}function bre(r,e){if(typeof r.from!="string")throw na.ethErrors.rpc.invalidParams(`Invalid "from" address "${r.from}": not a string.`);let t=bd(r.from,e);if(!No(t,{allowNonPrefixed:!1}))throw na.ethErrors.rpc.invalidParams('Invalid "from" address.')}function yre(r,e){let t=bd(r.to,e);if(r.to==="0x"||r.to===null)if(r.data)delete r.to;else throw na.ethErrors.rpc.invalidParams('Invalid "to" address.');else if(r.to!==void 0&&!No(t,{allowNonPrefixed:!1}))throw na.ethErrors.rpc.invalidParams('Invalid "to" address.');return r}function jo(r,e=J){if(!r||typeof r!="object"||Array.isArray(r))throw na.ethErrors.rpc.invalidParams("Invalid transaction params: must be an object.");if(!r.to&&!r.data)throw na.ethErrors.rpc.invalidParams('Invalid transaction params: must specify "data" for contract deployments, or "to" (and optionally "data") for all other types of transactions.');Object.entries(r).forEach(([t,n])=>{switch(t){case"from":bre(r,e);break;case"to":yre(r,e);break;case"value":if(typeof n!="string")throw na.ethErrors.rpc.invalidParams(`Invalid transaction params: ${t} is not a string. got: (${n})`);if(n.toString().includes("-"))throw na.ethErrors.rpc.invalidParams(`Invalid transaction value "${n}": not a positive number.`);if(n.toString().includes("."))throw na.ethErrors.rpc.invalidParams(`Invalid transaction value of "${n}": number must be in wei.`);break;case"chainId":if(typeof n!="number"&&typeof n!="string")throw na.ethErrors.rpc.invalidParams(`Invalid transaction params: ${t} is not a Number or hex string. got: (${n})`);break;default:if(typeof n!="string")throw na.ethErrors.rpc.invalidParams(`Invalid transaction params: ${t} is not a string. got: (${n})`)}})}function Z1(r,e=!0,t=J){let n=Lu(r,e);return jo(n,t),n}function Pk(){return[Oe.REJECTED,Oe.CONFIRMED,Oe.FAILED,Oe.DROPPED]}d();f();function Ns(r){let{name:e}=r;e=e===void 0?"Error":String(e);let t=r.message;return t=t===void 0?"":String(t),e===""?r.stack=r.message:t===""?r.stack=r.name:r.stack=`${r.name}: ${r.message}`,r}var Q1=class extends Re{constructor({preferencesController:e,dappStateManager:t,keyringController:n,authController:a}={}){super({preferencesController:e}),this.dappStateManager=t,this.keyringController=n,this.authController=a}async approveRequestOfSignTransaction(e){let{extraParams:t={},id:n}=e;if(t.isTxFinished){let{hash:a}=t,s={...e,result:a};this.dappStateManager.updateRequestMeta(s),this.dappStateManager.setRequestStatusSubmitted(n)}}async approveRequest(e){return e.method===g0.SIGN_TRANSACTION?this.approveRequestOfSignTransaction(e):{}}getError(e){switch(e.status){case qe.REJECTED:return Ns(Mg.ethErrors.provider.userRejectedRequest("Tx Signature: User denied transaction signature."));case qe.FAILED:return Ns(Mg.ethErrors.rpc.internal(e.err.message));default:return Ns(Mg.ethErrors.rpc.internal(`OKX Tx Signature: Unknown problem: ${JSON.stringify(e.txParams)}`))}}serializeRequestParams(e){let t=Lu(e);return jo(t),e.params}},Mk=Q1;d();f();var Rk=_(T$()),tf=_(sm()),kk=_(y9()),Ok=_(ql());ae();ne();var{ETHEREUM:xre}=n_,Nk=r=>(0,tf.toBase64)((0,Rk.publicKeyConvert)((0,tf.fromHex)(r),!0));async function Dk(r,e){let{walletId:t,localType:n,params:a,extraParams:s={}}=r,i=await e.keyringController.getAccountByWalletIdAndLocalType(t,n);r.params.transaction=am(a.transaction);let o=yk(r),c=await je(n,o),l=await e.authController.getSignRequestHeaders({walletId:t}),u=e.preferencesController.getServerWalletTypeByWalletId(t),h={headers:l},b={signedTx:o,txSource:fe.DAPP,fromAdr:i,serviceCharge:s.serviceCharge||3e3,toAdr:"",coinAmount:0,coinId:me({localType:n})?.coinId,txHash:c,accountId:t,walletType:u};try{await tr(b,h)}catch(y){throw new Error("server error",y,b)}return c}async function Lk(r){let{params:e}=r,{chainId:t}=e.transaction;return e.transaction=am(e.transaction),hk(e.transaction,lk(t))}var Bu=class extends Re{constructor({preferencesController:e,dappStateManager:t,keyringController:n,authController:a}={}){super({preferencesController:e}),this.dappStateManager=t,this.keyringController=n,this.authController=a}async preProcessRequestMeta(e){let{walletId:t,localType:n,params:a}=e,s=await this.keyringController.getAccountByWalletIdAndLocalType(t,n);return e.coinId=me({localType:n})?.coinId,e.address=s,e.params.transaction=am(a.transaction),e}async approveRequestOfSignAmino(e){await this.preProcessRequestMeta(e);let{localType:t,id:n,params:a,address:s}=e,{transaction:i}=a,{chainId:o,signer:c,signOptions:l,resultType:u}=i,h=await this.keyringController.getPublicKey(s,t),b=await pk(e),y=await this.keyringController.signCommonMessage(s,{type:"amino",data:JSON.stringify(b.signDoc)},t);if(l&&l.ethSignType){if(b.signDoc.msgs.length!==1)throw new Error("Invalid number of messages for Ethereum sign request");return this.approveRequestOfSignEthereum({...e,params:{chainId:o,signer:c,data:b.signDoc.msgs[0].value.data,type:l.ethSignType}})}let v={signed:b.signDoc,signature:{pub_key:{type:"tendermint/PubKeySecp256k1",value:Nk(h)},signature:y}};u==="arbitrary"&&(v=v.signature);let S={...e,result:v};return this.dappStateManager.updateRequestMeta(S),this.dappStateManager.setRequestStatusSubmitted(n),this.dappStateManager.getRequest(n)}async approveRequestOfSignDirect(e){await this.preProcessRequestMeta(e);let{localType:t,id:n,address:a}=e,s=await this.keyringController.getPublicKey(a,t),i=await mk(e),o=await this.keyringController.signCommonMessage(a,{type:"signDoc",data:JSON.stringify(i.signDoc)},t),c={...e,result:{signed:{bodyBytes:i.signDoc.body,authInfoBytes:i.signDoc.authInfo,chainId:i.signDoc.chainId,accountNumber:kk.default.fromString(i.signDoc.accountNumber)},signature:{pub_key:{type:"tendermint/PubKeySecp256k1",value:Nk(s)},signature:o}}};return this.dappStateManager.updateRequestMeta(c),this.dappStateManager.setRequestStatusSubmitted(n),this.dappStateManager.getRequest(n)}async approveRequestOfSignArbitrary(e){let t=gk(e),n=(0,Ok.default)(e,"params.transaction.resultType","arbitrary");return await this.approveRequestOfSignAmino({...e,params:{transaction:{...t,resultType:n}}})}async approveRequestOfSignEthereum(e){await this.preProcessRequestMeta(e);let{walletId:t,localType:n,id:a,params:s,address:i}=e,{type:o}=s;if(!await this.keyringController.getAccountByWalletIdAndLocalType(t,xre))throw new Error("Options signOptions.ethSignType not supported");let l=bk(e),u;switch(o){case Ru.MESSAGE:{u=await this.keyringController.signCommonMessage(i,{data:l},n);break}case Ru.TRANSACTION:{u=await this.keyringController.signTransaction(l,i);break}default:throw new Error(`Unknown sign type: ${o}`)}let h={...e,result:{signature:(0,tf.fromBase64)(u)}};return this.dappStateManager.updateRequestMeta(h),this.dappStateManager.setRequestStatusSubmitted(a),this.dappStateManager.getRequest(a)}async approveRequest(e){return e.method===ze.SIGN_AMINO||e.method===ze.RPC_SIGN_AMINO?this.approveRequestOfSignAmino(e):e.method===ze.SIGN_DIRECT||e.method===ze.RPC_SIGN_DIRECT?this.approveRequestOfSignDirect(e):e.method===ze.SIGN_ARBITRARY||e.method===ze.RPC_SIGN_ARBITRARY?this.approveRequestOfSignArbitrary(e):e.method===ze.SIGN_ETHEREUM||e.method===ze.RPC_SIGN_ETHEREUM?this.approveRequestOfSignEthereum(e):{}}};d();f();ur();Wt();ae();var wre=2e3;function vre(r){if("certificate"in r)return r.certificate;if("EffectsCert"in r)return r.EffectsCert.certificate}function Sre(r){return"effects"in r?"effects"in r.effects?r.effects.effects:r.effects:"EffectsCert"in r?r.EffectsCert.effects.effects:void 0}var _re=r=>{let{transaction:e}=r;return e?.data?e?.data:e?.transaction?.data?e?.transaction?.data:null},Are="moveCall",Cre="WaitForLocalExecution",eS=class extends Re{constructor({authController:e,dappStateManager:t,keyringController:n,preferencesController:a}){super({preferencesController:a}),this.authController=e,this.dappStateManager=t,this.keyringController=n}async singAndPublishContractTransaction({coinId:e,address:t,txBytes:n,walletId:a,serviceCharge:s}){let i=await this.keyringController.signCommonMessage(t,n,zp),{signature:o,hash:c}=JSON.parse(i),l=this.preferencesController.getServerWalletTypeByWalletId(a),u={txHash:c,inputData:Are,signedTx:{signature:o,tx_bytes:n,request_type:Cre},toAdr:"",coinAmount:0,fromAdr:t,coinId:e||Px,serviceCharge:s||5e3,txSource:fe.DAPP,accountId:a,walletType:l},h=await this.authController.getSignRequestHeaders({walletId:a});return await tr(u,{headers:h}),c}async getSignContractTransactionParams({coinId:e,address:t,...n}){let a={coinId:e,signer:t,executionMode:"Commit",...n},{data:s}=await Pe(ce.getSuiMoveCallSignInfoUrl,a,{headers:{istest:!0}});return s?.txBytes}getSuiTransaction({coinId:e,txHash:t}){let n=null,a=async()=>{let{data:s}=await Pe(ce.getSuiTransactionInfo,{coinId:e,txHash:t},{headers:{istest:!0}});return s};return new Promise(s=>{n=setInterval(async()=>{let i=await a();i&&(clearInterval(n),s(typeof i=="string"?JSON.parse(i):i))},wre)})}async approveRequest(e){let t={},n=Px,{method:a,walletId:s,localType:i,params:o}=e,c=_re(o),l=await this.keyringController.getAccountByWalletIdAndLocalType(s,i);[b0.EXECUTE_MOVE_CALL,b0.SIGN_AND_EXECUTETRANSACTION].includes(a)&&(t=await this.getSignContractTransactionParams({coinId:n,address:l,...c})),a===b0.EXECUTE_SERIALIZED_MOVE_CALL&&(t=typeof c=="string"?c:p.Buffer.from(c).toString("base64"));let u=await this.singAndPublishContractTransaction({coinId:n,address:l,walletId:s,txBytes:t}),h=await this.getSuiTransaction({coinId:n,txHash:u}),b={...e,result:{timestamp_ms:null,parsed_data:null,certificate:vre(h),effects:Sre(h),publicKey:l}},{id:y}=e;return this.dappStateManager.updateRequestMeta(b),this.dappStateManager.setRequestStatusSubmitted(y),this.dappStateManager.getRequest(y)}},Bk=eS;d();f();var Ng=_(Ce()),aa=_(Qr());ae();async function Wk(r,e){let{walletId:t,params:{transaction:{from:n,txs:a=[]}}}=r,i={headers:await e.authController.getSignRequestHeaders({walletId:t})},o={},c=await Promise.all(a.map(async u=>{u.signedTx=im(u.signedTx);let h=await(0,aa.calcTxHash)(aa.Currency.BTC,{data:u.signedTx});return o[u.itemId]=h,{[u.itemId]:h}})),l=a.map(({itemId:u,signedTx:h,type:b,dependItemId:y=[],extJson:v={}})=>{let{coinAmount:S=0,toAdr:R,...P}=v,N={signedTx:h,txSource:fe.DAPP,fromAdr:R||n,serviceCharge:0,toAdr:n,coinAmount:S,coinId:Ix,itemId:u,txHash:o[u],dependTx:y.map(M=>o[M]),extJson:JSON.stringify(P)};return b!==void 0&&(N.txType=b),N});return await $9({txList:l},i),c}var tS=class extends Re{constructor({preferencesController:e,dappStateManager:t,authController:n,keyringController:a}={}){super({preferencesController:e}),this.dappStateManager=t,this.authController=n,this.keyringController=a}async approveRequest(e){switch(e.method){case oe.TRANSFER_NFT:case oe.SEND_INSCRIPTION:return this.transferNft(e);case oe.INSCRIBE:case oe.INSCRIBE_TRANSFER:return this.inscribe(e);case oe.SIGNPSBT:case oe.SIGNPSBTS:return this.signPsbt(e);case oe.SPLITUTXO:return this.splitUtxo(e);case oe.SEND:case oe.SEND_BTC:return this.send(e);case oe.SIGN_MESSAGE:return this.signMessage(e);case oe.MINT:return this.mint(e);case oe.WATCHASSET:return this.watchAsset(e);default:return{}}}async send(e){let{id:t,walletId:n,params:a={},extraParams:s={},method:i}=e,o=await this.authController.getSignRequestHeaders({walletId:n}),c=this.preferencesController.getServerWalletTypeByWalletId(n),l={headers:o},{signedTx:u,serviceCharge:h,coinAmount:b,satPerByte:y,coinId:v,...S}=s,R=await(0,aa.calcTxHash)(aa.Currency.BTC,{data:u}),P=JSON.stringify({sequence:1,feeRate:y}),N={txHash:R,signedTx:u,txSource:fe.DAPP,fromAdr:a.transaction.from,serviceCharge:h,toAdr:a.transaction.to,coinAmount:b,coinId:v,accountId:n,walletType:c,btcSpeedUpInfo:P,...S};try{N.txSource===fe.DEX?await rr(N,l):await tr(N,l)}catch(L){throw L?.msg?L.msg:L}let M=i===oe.SEND_BTC?R:{txhash:R};return this.dappStateManager.updateRequestMeta({...e,result:M}),this.dappStateManager.setRequestStatusSubmitted(t),this.dappStateManager.getRequest(t)}async transferNft(e){let{id:t,walletId:n,method:a,params:s={},extraParams:i={}}=e,o=await this.authController.getSignRequestHeaders({walletId:n}),c=this.preferencesController.getServerWalletTypeByWalletId(n),l={headers:o},{txHash:u,signedTx:h,serviceCharge:b,gasFrom:y,txType:v,nftIds:S}=i,R={txHash:u,signedTx:h,txSource:fe.DAPP,txType:s.transfer.type||v||Er.SEND_NFT,fromAdr:s.transfer.from,serviceCharge:b,toAdr:s.transfer.to,coinAmount:0,coinId:Ix,extJson:JSON.stringify({from:s.transfer.from,to:s.transfer.to,gasFrom:y,utxoType:2,nftIds:S}),accountId:n,walletType:c};await tr(R,l);let P;return a===oe.SEND_INSCRIPTION?P=u:P={txhash:u,gasFrom:y},this.dappStateManager.updateRequestMeta({...e,result:P}),this.dappStateManager.setRequestStatusSubmitted(t),this.dappStateManager.getRequest(t)}async inscribe(e){let{id:t,extraParams:{revealTxs:n}}=e;return this.dappStateManager.updateRequestMeta({...e,result:await(0,aa.calcTxHash)(aa.Currency.BTC,{data:n[0]})}),this.dappStateManager.setRequestStatusSubmitted(t),this.dappStateManager.getRequest(t)}async mint(e){let{id:t,extraParams:{commitTx:n,revealTxs:a,...s}}=e;return this.dappStateManager.updateRequestMeta({...e,result:{...s,commitTx:await(0,aa.calcTxHash)(aa.Currency.BTC,{data:n}),revealTxs:await Promise.all((a||[]).map(i=>(0,aa.calcTxHash)(aa.Currency.BTC,{data:i})))}}),this.dappStateManager.setRequestStatusSubmitted(t),this.dappStateManager.getRequest(t)}async signPsbt(e){let{id:t,extraParams:n={}}=e,{signedTx:a}=n;return this.dappStateManager.updateRequestMeta({...e,result:a}),this.dappStateManager.setRequestStatusSubmitted(t),this.dappStateManager.getRequest(t)}async splitUtxo(e){let{id:t,extraParams:n={}}=e,{utxos:a}=n;return this.dappStateManager.updateRequestMeta({...e,result:{utxos:a}}),this.dappStateManager.setRequestStatusSubmitted(t),this.dappStateManager.getRequest(t)}async watchAsset(e){let{id:t,params:{name:n}}=e;return this.dappStateManager.updateRequestMeta({...e,result:{name:n}}),this.dappStateManager.setRequestStatusSubmitted(t),this.dappStateManager.getRequest(t)}async signMessage(e){let{id:t,params:n,localType:a}=e,{from:s,message:i,type:o}=n;return this.dappStateManager.updateRequestMeta({...e,result:await this.keyringController.signMessage({from:s,data:i},{type:o},a)}),this.dappStateManager.setRequestStatusSubmitted(t),this.dappStateManager.getRequest(t)}getError(e){switch(e.status){case qe.REJECTED:return Ng.ethErrors.provider.userRejectedRequest("Tx Signature: User denied transaction signature.");case qe.FAILED:return Ng.ethErrors.rpc.internal(e.err.message);default:return Ng.ethErrors.rpc.internal(`OKX Tx Signature: Unknown problem: ${JSON.stringify(e.txParams)}`)}}},Kk=tS;d();f();ae();ne();var qk=_(sm());function Tre(r){return new Promise(e=>{let{hash:t,options:n}=r,a=async()=>{try{return(await X9({method:"sui_getTransactionBlock",params:[t,n]})).result}catch{return null}};(()=>{let i=10,o=async()=>{let c=await a();if(c)e(c);else{if(i===0){e(null);return}i--,setTimeout(o,1e3)}};o()})()})}var rS=class extends Re{constructor({preferencesController:e,dappStateManager:t,keyringController:n,authController:a}={}){super({preferencesController:e}),this.dappStateManager=t,this.keyringController=n,this.authController=a}approveRequest(e){return e.method===Wa.SIGN_MESSAGE||e.method===Wa.SIGN_PERSONAL_MESSAGE?this.approveRequestOfSignMessage(e):e.method===Wa.SIGN_TRANSACTION_BLOCK?this.approveRequestOfSignTransaction(e):e.method===Wa.SIGN_AND_EXECUTE_TRANSACTION_BLOCK?this.approveRequestOfSignAndSubmitTransaction(e):{}}async approveRequestOfSignMessage(e){let{walletId:t,localType:n,id:a,params:s}=e,i=await this.keyringController.getAccountByWalletIdAndLocalType(t,n),o=await this.keyringController.signCommonMessage(i,Td(s.message),ds),c={...e,result:{signature:o,messageBytes:(0,qk.toBase64)(Td(s.message))}};return this.dappStateManager.updateRequestMeta(c),this.dappStateManager.setRequestStatusSubmitted(a),this.dappStateManager.getRequest(a)}async signTx(e){let{extraParams:t,walletId:n,localType:a}=e,s=await this.keyringController.getAccountByWalletIdAndLocalType(n,a),{txBytes:i}=t||{},o={type:"raw",data:i};return this.keyringController.signTransaction(o,s,ds)}async approveRequestOfSignTransaction(e){let{id:t}=e,n=await this.signTx(e),a={...e,result:n};return this.dappStateManager.updateRequestMeta(a),this.dappStateManager.setRequestStatusSubmitted(t),this.dappStateManager.getRequest(t)}async approveRequestOfSignAndSubmitTransaction(e){let{localType:t,walletId:n,id:a,params:s,extraParams:i}=e,o=await this.keyringController.getAccountByWalletIdAndLocalType(n,t),c=this.preferencesController.getServerWalletTypeByWalletId(n),{requestType:l,options:u}=s,{txBytes:h,fee:b}=i||{},y=await this.signTx(e),{signature:v,hash:S}=y||{},R={txSource:fe.DAPP,signedTx:{request_type:l,options:u,tx_bytes:h,signatures:[v]},fromAdr:o,serviceCharge:b||"0",coinAmount:0,coinId:me({localType:t})?.coinId,txHash:S,inputData:"moveCall",accountId:n,walletType:c},N={headers:await this.authController.getSignRequestHeaders({walletId:n})};try{await tr(R,N)}catch(B){return this.dappStateManager.setRequestStatusFailed(a,B),this.dappStateManager.getRequest(a)}let M=await Tre({hash:S,options:u}),L={...e,result:{...M||{},digest:S,confirmedLocalExecution:!!M}};return this.dappStateManager.updateRequestMeta(L),this.dappStateManager.setRequestStatusSubmitted(a),this.dappStateManager.getRequest(a)}},Uk=rS;d();f();ne();var nS=class extends Re{constructor({preferencesController:e,dappStateManager:t,keyringController:n,authController:a,publishTransactionToServer:s}={}){super({preferencesController:e}),this.dappStateManager=t,this.keyringController=n,this.authController=a,this.publishTransactionToServer=s}async fetchSignInfo({fromAddress:e}){return await H0({coinId:_l,fromAddress:e})}async signContractCall({transaction:e={},fromAddress:t,localType:n,nonce:a,fee:s}){let i={type:si.CONTRACT_CALL,data:{txData:{anchorMode:e.anchorMode,contractAddress:e.contractAddress,contractName:e.contractName,functionArgs:e.functionArgs,functionName:e.functionName,postConditionMode:e.postConditionMode,postConditions:e.postConditions},fee:s,nonce:a}};return await this.keyringController.signTransaction(i,t,n)}async signSTXTransfer({transaction:e,fromAddress:t,localType:n,nonce:a,fee:s}){let i={type:si.TRANSFER,data:{anchorMode:e.anchorMode,to:e.recipient,amount:e.amount,memo:e.memo,nonce:a,fee:s}};return await this.keyringController.signTransaction(i,t,n)}async signTransaction({transaction:e={},fromAddress:t,localType:n,nonce:a,fee:s}){return e.txType===bs.CONTRACT_CALL?this.signContractCall({transaction:e,fromAddress:t,localType:n,nonce:a,fee:s}):e.txType===bs.STX_TRANSFER?this.signSTXTransfer({transaction:e,fromAddress:t,localType:n,nonce:a,fee:s}):{}}async publishTransaction({transaction:e={},txHash:t,txSerializedHexString:n,nonce:a,walletId:s,fee:i,memo:o,fromAddress:c,okxArgs:l}){let u={nonce:a},h=JSON.stringify(u),b={signedTx:n,coinId:_l,fromAdr:c,serviceCharge:i,txHash:t,memo:o,extJson:h,txSource:l?.txSource??fe.DAPP,txType:l?.txType};e.txType===bs.CONTRACT_CALL?(b.coinAmount="0",b.toAdr=e.contractAddress):e.txType===bs.STX_TRANSFER&&(b.coinAmount=e.amount,b.toAdr=e.recipient);try{return await this.publishTransactionToServer({publishParams:b,walletId:s})}catch(y){throw new Error(y?.msg||y?.error_message)}}async approveRequestOfSignTransaction(e={}){let{params:t={},extraParams:n={},walletId:a,localType:s,id:i}=e,{fee:o}=n,c=await this.keyringController.getAccountByWalletIdAndLocalType(a,s),{transaction:l={},okxArgs:u={}}=t,h=await this.fetchSignInfo({requestMeta:e,transaction:l,fromAddress:c}),{info:b={}}=h,{nonce:y}=b,v=await this.signTransaction({transaction:l,fromAddress:c,localType:s,nonce:y,fee:o}),{txId:S,txSerializedHexString:R}=v;await this.publishTransaction({transaction:l,txHash:S,txSerializedHexString:R,nonce:y,walletId:a,fee:o,fromAddress:c,okxArgs:u});let P={...e,result:{signature:R,txHash:S}};return this.dappStateManager.updateRequestMeta(P),this.dappStateManager.setRequestStatusSubmitted(i),this.dappStateManager.getRequest(i)}async approveRequestOfSignMessage(e={}){let{params:t={},walletId:n,localType:a,id:s}=e,i=await this.keyringController.getAccountByWalletIdAndLocalType(n,a),o={type:si.SIGN_MESSAGE,message:t?.message},c=await this.keyringController.signCommonMessage(i,o,a),l={...e,result:c};return this.dappStateManager.updateRequestMeta(l),this.dappStateManager.setRequestStatusSubmitted(s),this.dappStateManager.getRequest(s)}approveRequest(e={}){return e.method===ga.SIGN_TRANSACTION?this.approveRequestOfSignTransaction(e):e.method===ga.SIGN_MESSAGE?this.approveRequestOfSignMessage(e):{}}},Fk=nS;d();f();ne();var aS=class extends Re{constructor({preferencesController:e,dappStateManager:t,keyringController:n,authController:a}={}){super({preferencesController:e}),this.dappStateManager=t,this.keyringController=n,this.authController=a}approveRequest(e){return e.method===ys.EXECUTE?this.execute(e):e.method===ys.SIGN_MESSAGE?this.signMessage(e):{}}async execute(e){let{params:t,extraParams:n,walletId:a,localType:s,id:i}=e,{signInfo:o,fee:c}=n||{},l=o?.info?.nonce,u=await this.keyringController.getAccountByWalletIdAndLocalType(a,s),h={type:"multi_contract_call",nonce:l,maxFee:c||"0",chainId:pi.StarknetChainId.SN_MAIN,multiContractCallData:{from:u,calls:t.transactions}},b;try{b=await this.keyringController.signTransaction(h,u,xn)}catch(B){return this.dappStateManager.setRequestStatusFailed(i,B),this.dappStateManager.getRequest(i)}let{txId:y,signature:v}=b,S={serviceChargeCoinId:ls,nonce:l},R=JSON.stringify(S),P={txSource:fe.DAPP,signedTx:v,coinAmount:0,coinId:ls,fromAdr:u,toAdr:t.transactions[0]?.contractAddress,serviceCharge:c,txType:Er.CONTRACTCALL,txHash:y,extJson:R},M={headers:await this.authController.getSignRequestHeaders({walletId:a})};try{await tr(P,M)}catch(B){return this.dappStateManager.setRequestStatusFailed(i,B),this.dappStateManager.getRequest(i)}let L={...e,result:{transaction_hash:y}};return this.dappStateManager.updateRequestMeta(L),this.dappStateManager.setRequestStatusSubmitted(i),this.dappStateManager.getRequest(i)}async signMessage(e){let{params:t,walletId:n,localType:a,id:s}=e,i=await this.keyringController.getAccountByWalletIdAndLocalType(n,a);try{let{signature:o}=await this.keyringController.signCommonMessage(i,{message:t.data},xn),c={...e,result:[o.r?.toString(),o.s?.toString()]};return this.dappStateManager.updateRequestMeta(c),this.dappStateManager.setRequestStatusSubmitted(s),this.dappStateManager.getRequest(s)}catch(o){return this.dappStateManager.setRequestStatusFailed(s,o),this.dappStateManager.getRequest(s)}}},Hk=aS;d();f();var sS=class extends Re{constructor({preferencesController:e,dappStateManager:t,keyringController:n,authController:a,publishTransactionToServer:s}={}){super({preferencesController:e}),this.dappStateManager=t,this.keyringController=n,this.authController=a,this.publishTransactionToServer=s}async approveRequestOfSignData(e={}){let{params:t={},walletId:n,localType:a,id:s}=e,i=await this.keyringController.getAccountByWalletIdAndLocalType(n,a),o={address:i,message:t?.payload},c=await this.keyringController.signCommonMessage(i,o,a),l={...e,result:c};return this.dappStateManager.updateRequestMeta(l),this.dappStateManager.setRequestStatusSubmitted(s),this.dappStateManager.getRequest(s)}async approveRequestOfSignTx(e={}){let{params:t={},walletId:n,localType:a,id:s}=e,i=await this.keyringController.getAccountByWalletIdAndLocalType(n,a),o={type:m0.RAW_TX,tx:t?.tx},c=await this.keyringController.signTransaction(o,i,a),l={...e,result:c};return this.dappStateManager.updateRequestMeta(l),this.dappStateManager.setRequestStatusSubmitted(s),this.dappStateManager.getRequest(s)}approveRequest(e={}){return e.method===br.SIGN_DATA?this.approveRequestOfSignData(e):e.method===br.SIGN_TX?this.approveRequestOfSignTx(e):{}}},Gk=sS;d();f();var Wu=_(D_());var iS=class extends Re{constructor({preferencesController:e,dappStateManager:t,keyringController:n}={}){super({preferencesController:e}),this.dappStateManager=t,this.keyringController=n}approveRequest(e){return e.method===hn.SIGN_EVENT?this.signEvent(e):e.method===hn.ENCRYPT_TEXT_04||e.method===hn.DECRYPT_TEXT_04?this.signNIP04(e):{}}async sign(e,t){let{walletId:n,localType:a,id:s}=e,i=await this.keyringController.getAccountByWalletIdAndLocalType(n,a),o=await this.keyringController.signTransaction(t,i,a),c={...e,result:o};return this.dappStateManager.updateRequestMeta(c),this.dappStateManager.setRequestStatusSubmitted(s),this.dappStateManager.getRequest(s)}async signEvent(e){return this.sign(e,e.params.event||{})}async signNIP04(e){let{method:t,params:n={}}=e,{pubKey:a,text:s}=n.message||{},i=t===hn.ENCRYPT_TEXT_04?Wu.nipOpType.NIP04_Encrypt:Wu.nipOpType.NIP04_Decrypt;return this.sign(e,new Wu.CryptTextParams(i,a,s))}},zk=iS;d();f();var oS=class extends Re{constructor({preferencesController:e,dappStateManager:t,keyringController:n,authController:a,publishTransactionToServer:s}={}){super({preferencesController:e}),this.dappStateManager=t,this.keyringController=n,this.authController=a,this.publishTransactionToServer=s}async signMessage(e){let{params:t={},walletId:n,localType:a,id:s}=e,i=await this.keyringController.getAccountByWalletIdAndLocalType(n,a),o={message:t?.message},c=await this.keyringController.signCommonMessage(i,o,a),l={...e,result:c};return this.dappStateManager.updateRequestMeta(l),this.dappStateManager.setRequestStatusSubmitted(s),this.dappStateManager.getRequest(s)}approveRequest(e){return e.method===ld.SIGN_MESSAGE?this.signMessage(e):{}}},jk=oS;d();f();var Ku=_(L_());ne();var Vk=({method:r,txHash:e})=>({method:r,txHash:e,code:0}),cS=class extends Re{constructor({preferencesController:e,dappStateManager:t,keyringController:n,authController:a}={}){super({preferencesController:e}),this.dappStateManager=t,this.keyringController=n,this.authController=a}async approveRequest(e){return e.method===Ze.SEND_MONEY?this.handleSendMoney(e):e.method===Ze.SIGN_AND_SEND_TRANSACTION?this.handleSignAndSendTransaction(e):e.method===Ze.REQUEST_SIGN_TRANSACTIONS?this.handleRequestSignTransactions(e):e.method===Ze.SIGN_TRANSACTION?this.handleSignTransaction(e):e.method===Ze.SIGN_MESSAGE?this.handleSignMessage(e):null}async handleSendMoney(e){try{let{extraParams:t,localType:n,walletId:a,params:s}=e,i=await this.keyringController.getAccountByWalletIdAndLocalType(a,n),o={...s,...t,from:i,type:Ku.NearTypes.TransferNear},c=await this.keyringController.signTransaction(o,i,n),l=await je(n,c),u={txHash:l,signedTx:c,toAdr:s.receiverId,coinAmount:s.amount,fromAdr:i,coinId:Dc,serviceCharge:t.networkFee,txSource:fe.DAPP,accountId:a};await this.publishTransaction(u),this.dappStateManager.updateRequestMeta({...e,result:Vk({method:Ze.SEND_MONEY,txHash:l})});let{id:h}=e;return this.dappStateManager.setRequestStatusSubmitted(h),this.dappStateManager.getRequest(h)}catch{let{id:n}=e;return this.dappStateManager.updateRequestMeta(e),this.dappStateManager.setRequestStatusFailed(n,new Error("Transaction failed")),this.dappStateManager.getRequest(n)}}async handleSignAndSendTransaction(e){try{let{extraParams:{txData:t,networkFee:n},localType:a,walletId:s}=e,i=await this.keyringController.getAccountByWalletIdAndLocalType(s,a),o={...t,from:i,type:Ku.NearTypes.DAppTx},c=await this.keyringController.signTransaction(o,i,a),l=await je(a,c),u={txHash:l,signedTx:c,toAdr:t.receiverId,coinAmount:0,fromAdr:i,coinId:Dc,serviceCharge:n,txSource:fe.DAPP,accountId:s};await this.publishTransaction(u),this.dappStateManager.updateRequestMeta({...e,result:Vk({method:Ze.SIGN_AND_SEND_TRANSACTION,txHash:l})});let{id:h}=e;return this.dappStateManager.setRequestStatusSubmitted(h),this.dappStateManager.getRequest(h)}catch{let{id:n}=e;return this.dappStateManager.updateRequestMeta(e),this.dappStateManager.setRequestStatusFailed(n,new Error("Transaction failed")),this.dappStateManager.getRequest(n)}}async handleSignTransaction(e){try{let{extraParams:{txData:t},localType:n,walletId:a}=e,s=await this.keyringController.getAccountByWalletIdAndLocalType(a,n),i={...t,from:s,type:Ku.NearTypes.DAppTx},o=await this.keyringController.signTransaction(i,s,n);this.dappStateManager.updateRequestMeta({...e,result:o});let{id:c}=e;return this.dappStateManager.setRequestStatusSubmitted(c),this.dappStateManager.getRequest(c)}catch{let{id:n}=e;return this.dappStateManager.updateRequestMeta(e),this.dappStateManager.setRequestStatusFailed(n,new Error("Transaction failed")),this.dappStateManager.getRequest(n)}}async handleRequestSignTransactions(e){try{let{extraParams:{txData:t},localType:n,walletId:a}=e,s=await this.keyringController.getAccountByWalletIdAndLocalType(a,n),i={...t,from:s,type:Ku.NearTypes.DAppTxs},o=await this.keyringController.signTransaction(i,s,n),c=[];for(let u=0;u<o.length;u++){let h=o[u],b=await je(n,h);c.push({signedTx:h,txHash:b})}this.dappStateManager.updateRequestMeta({...e,result:{txs:c,code:0,method:Ze.REQUEST_SIGN_TRANSACTIONS}});let{id:l}=e;return this.dappStateManager.setRequestStatusSubmitted(l),this.dappStateManager.getRequest(l)}catch{let{id:n}=e;return this.dappStateManager.updateRequestMeta(e),this.dappStateManager.setRequestStatusFailed(n,new Error("Transaction failed")),this.dappStateManager.getRequest(n)}}async publishTransaction(e){let{accountId:t}=e,n=await this.authController.getSignRequestHeaders({walletId:t}),a=this.preferencesController.getServerWalletTypeByWalletId(t);await tr({...e,walletType:a},{headers:n})}async handleSignMessage(e){let{walletId:t,localType:n,id:a,params:s}=e,i=await this.keyringController.getAccountByWalletIdAndLocalType(t,n),o=s.message;o&&(o.nonce=L5(o.nonce));let c=await this.keyringController.signCommonMessage(i,s.message,ln),l=await this.keyringController.getPublicKey(i,ln),u={...e,result:{accountId:i,publicKey:l,signature:c,state:s.message.state||""}};return this.dappStateManager.updateRequestMeta(u),this.dappStateManager.setRequestStatusSubmitted(a),this.dappStateManager.getRequest(a)}},$k=cS;d();f();ne();var dS=class extends Re{constructor({preferencesController:e,dappStateManager:t,keyringController:n,authController:a}={}){super({preferencesController:e}),this.dappStateManager=t,this.keyringController=n,this.authController=a}async signTransaction(e){let{params:t={},walletId:n,localType:a,id:s}=e,i=await this.keyringController.getAccountByWalletIdAndLocalType(n,a),{transaction:o={}}=t,{chainId:c,serializedTx:l}=o,u={type:2,abis:[{abi:[],accountName:i}],chainId:c,requiredKeys:[],serializedTransaction:l},h;try{h=await this.keyringController.signTransaction(u,i,fs)}catch(y){return this.dappStateManager.setRequestStatusFailed(s,y),this.dappStateManager.getRequest(s)}let b={...e,result:h};return this.dappStateManager.updateRequestMeta(b),this.dappStateManager.setRequestStatusSubmitted(s),this.dappStateManager.getRequest(s)}approveRequest(e){return e.method===oi.SIGN_TRANSACTION?this.signTransaction(e):{}}},Yk=dS;d();f();var fS=class extends Re{constructor({preferencesController:e,dappStateManager:t,keyringController:n,authController:a,publishTransactionToServer:s}={}){super({preferencesController:e}),this.dappStateManager=t,this.keyringController=n,this.authController=a,this.publishTransactionToServer=s}approveRequest(e){return e.method===ci.SEND_TRANSACTION?this.approveRequestOfSignAndSubmitTransaction(e):{}}async approveRequestOfSignAndSubmitTransaction(e){let{walletId:t,id:n,extraParams:a={}}=e,{txSource:s,accountId:i,walletType:o,coinId:c,coinAmount:l,fromAdr:u,toAdr:h,serviceCharge:b,extJson:y,memo:v="",transactionParams:S}=a,{body:R,txHash:P}=await this.keyringController.signMultiTransaction(u,t,S),N={txSource:s,accountId:i,walletType:o,coinId:c,coinAmount:l,fromAdr:u,toAdr:h,serviceCharge:b,extJson:y,memo:v,txHash:P,signedTx:R,txType:Er.CONTRACTCALL};try{await this.publishTransactionToServer({publishParams:N,walletId:t})}catch(L){return L.code===10009?L:(this.dappStateManager.setRequestStatusFailed(n,JSON.stringify(L.msg)),this.dappStateManager.getRequest(n))}let M={...e,result:{result:R,id:n}};return this.dappStateManager.updateRequestMeta(M),this.dappStateManager.setRequestStatusSubmitted(n),this.dappStateManager.getRequest(n)}},Jk=fS;var Dr={BaseHandler:Re,SuiHandler:Bk,SolanaHandler:_k,AptosHandler:Ck,TronHandler:Ik,EvmRpcHandler:Mk,CosmosHubHandler:Bu,BTCHandler:Kk,SuiMainnetHandler:Uk,StacksHandler:Fk,StarknetHandler:Hk,CardanoHandler:Gk,NostrAssetsHandler:zk,KaspaHandler:jk,NearHandler:$k,WaxHandler:Yk,TonHandler:Jk};var lS=class extends eO.default{constructor(e={}){super(),this.preferencesController=e.preferencesController,this.publishTransactionToServer=e.publishTransactionToServer,this.dappStateManager=new vk({initState:e.initState,preferencesController:e.preferencesController});let t={preferencesController:e.preferencesController,keyringController:e.keyringController,authController:e.authController,dappStateManager:this.dappStateManager,publishTransactionToServer:e.publishTransactionToServer};this.baseHandler=new Dr.BaseHandler({preferencesController:e.preferencesController,dappStateManager:this.dappStateManager}),this.solanaHandler=new Dr.SolanaHandler({...t}),this.stacksHandler=new Dr.StacksHandler({...t}),this.cardanoHandler=new Dr.CardanoHandler({...t}),this.kaspaHandler=new Dr.KaspaHandler({...t}),this.nearHandler=new Dr.NearHandler({...t}),this.aptosHandler=new Dr.AptosHandler({preferencesController:e.preferencesController,keyringController:e.keyringController,authController:e.authController,dappStateManager:this.dappStateManager}),this.tronHandler=new Dr.TronHandler({preferencesController:e.preferencesController,keyringController:e.keyringController,authController:e.authController,dappStateManager:this.dappStateManager}),this.evmRpcHandler=new Dr.EvmRpcHandler({preferencesController:e.preferencesController,keyringController:e.keyringController,authController:e.authController,dappStateManager:this.dappStateManager}),this.cosmosHubHandler=new Dr.CosmosHubHandler({preferencesController:e.preferencesController,keyringController:e.keyringController,authController:e.authController,dappStateManager:this.dappStateManager}),this.suiHandler=new Dr.SuiHandler({preferencesController:e.preferencesController,keyringController:e.keyringController,authController:e.authController,dappStateManager:this.dappStateManager}),this.SuiMainnetHandler=new Dr.SuiMainnetHandler({preferencesController:e.preferencesController,keyringController:e.keyringController,authController:e.authController,dappStateManager:this.dappStateManager}),this.btcHandler=new Dr.BTCHandler({preferencesController:e.preferencesController,authController:e.authController,dappStateManager:this.dappStateManager,keyringController:e.keyringController}),this.starknetHandler=new Dr.StarknetHandler({preferencesController:e.preferencesController,authController:e.authController,dappStateManager:this.dappStateManager,keyringController:e.keyringController}),this.nostrAssetsHandler=new Dr.NostrAssetsHandler({preferencesController:e.preferencesController,dappStateManager:this.dappStateManager,keyringController:e.keyringController}),this.waxHandler=new Dr.WaxHandler({preferencesController:e.preferencesController,dappStateManager:this.dappStateManager,keyringController:e.keyringController}),this.tonHandler=new Dr.TonHandler({preferencesController:e.preferencesController,dappStateManager:this.dappStateManager,keyringController:e.keyringController,publishTransactionToServer:e.publishTransactionToServer}),this.isomerismHandlerMap={[Pn]:this.solanaHandler,[Un]:this.tronHandler,[bo]:this.evmRpcHandler,[zp]:this.suiHandler,[ke]:this.btcHandler,[po]:this.btcHandler,[mo]:this.btcHandler,[En]:this.btcHandler,[ds]:this.SuiMainnetHandler,[go]:this.stacksHandler,[xn]:this.starknetHandler,[Gr]:this.cardanoHandler,[qn]:this.nostrAssetsHandler,[Qs]:this.kaspaHandler,[ln]:this.nearHandler,[fs]:this.waxHandler,[er]:this.tonHandler},this.memStore=new Xk.ObservableStore({}),this.store=this.dappStateManager.store,this.updateStateMemStore(),this.dappStateManager.store.subscribe(()=>this.updateStateMemStore()),this.dappStateManager.store.subscribe(()=>this.emit(nr))}updateStateMemStore(){let e=this.dappStateManager.getUnapprovedRequests();this.memStore.updateState({unapprovedRequests:e})}getHandler(e){let t=Po(),n=z5();return t.includes(e)?this.cosmosHubHandler:this.isomerismHandlerMap[e]?this.isomerismHandlerMap[e]:e===bo?this.evmRpcHandler:n.includes(e)?this.aptosHandler:this.baseHandler}getWalletId(e){return this.getHandler(e.localType).getWalletId(e)}serializeRequestParams(e){return this.getHandler(e.localType).serializeRequestParams(e)}getRequestMetaOpts(e,{origin:t,connectionId:n}){let a={...e};if(!a.walletId){let i=this.getWalletId(e);a.walletId=i}let s=this.serializeRequestParams(e);return{...a,origin:t,connectionId:n,params:s}}async addUnapprovedRequest(e,{origin:t,connectionId:n}){let a=this.getRequestMetaOpts(e,{origin:t,connectionId:n}),s=this.dappStateManager.generateRequestMeta(a);return this.dappStateManager.updateRequestMeta(s),this.emit("newUnapprovedRequest"),s}async newUnapprovedRequest(e,{origin:t,connectionId:n}){let a=await this.addUnapprovedRequest(e,{origin:t,connectionId:n}),s=this.getHandler(e.localType);return new Promise((i,o)=>{let c=Uo(a.id);this.dappStateManager.once(c,l=>{let u=s.getError(l);switch(l.status){case qe.SUBMITTED:if(l?.params?.isOffline){let{offlineParams:h,extraParams:b}=l;i({...h,...b,...l.result});return}i(l.result);return;case qe.REJECTED:o(Zk.ethErrors.provider.userRejectedRequest({message:"Request Signature: User denied request signature."}));return;case qe.FAILED:default:o(u)}})})}async approveRequest(e,t){try{if((0,Qk.isObject)(t)){let i=this.dappStateManager.getRequest(e),o={...i,extraParams:{...i.extraParams,...t}};this.dappStateManager.updateRequestMeta(o)}let n=this.dappStateManager.getRequest(e);return await this.getHandler(n.localType).approveRequest(n)}catch(n){return this.dappStateManager.setRequestStatusFailed(e,n),n}}async getAptosSimulateTransactionTx(e){let t=this.dappStateManager.getRequest(e);return await this.getHandler(t.localType).getTransactionResult(t,"simulate")}async cancelRequest(e){let t=this.dappStateManager.getRequest(e),n=this.preferencesController.getWalletIdentityMap(),a=t?.localType,s=n?.[t?.walletId]?.account?.[a];ri({txInfos:[{networkType:a,from:s}]}),this.dappStateManager.setRequestStatusRejected(e)}clearUnapproved(){this.dappStateManager.clearUnapproved()}finishRequest({id:e,type:t,result:n,error:a}){try{if(t===qe.REJECTED)this.cancelRequest(e);else if(a)this.dappStateManager.setRequestStatusFailed(e,a);else{let i={...this.dappStateManager.getRequest(e),result:n};return this.dappStateManager.updateRequestMeta(i),this.dappStateManager.setRequestStatusSubmitted(e),this.dappStateManager.getRequest(e)}return n}catch(s){return this.dappStateManager.setRequestStatusFailed(e,s),s}}},tO=lS;d();f();var DO=_(Ne()),LO=_(uw()),BO=_(Pr());ae();ne();d();f();ae();ne();d();f();Hn();ae();async function uS(r,e,t){let[n,a]=r.function.split("::"),{address:s,inputData:i}=e,o={type:t,base:{sequenceNumber:"",chainId:0,maxGasAmount:"",gasUnitPrice:"",expirationTimestampSecs:""},data:{abi:"[]",data:JSON.stringify(r)}},c={coinId:Yp,address:s},l={fromAddr:s,toAddr:n,scenario:fd.SCENARIO_SEND_COIN},{info:u}=await Sd(c,l);if(i){let b=await J9(i);u.maxGasAmount=b}o.base=u;let h=await B0({address:n,name:a});if(h.error_code)throw new Error("[Aptos] fetchAptosABI error");return o.data.abi=JSON.stringify(h),o}function rO(r){return Nn(r?.base?.maxGasAmount,r?.base?.gasUnitPrice)}async function nO(r,e){let{address:t,keyring:n}=e,a=await uS(r,e,"simulate"),s=await n.signTransaction(t,a),i=await uS(r,{...e,inputData:s},"dapp"),o=await n.signTransaction(t,i);return{txToSign:i,signedTx:o}}async function Ire(r,e){let{txToSign:t,signedTx:n}=await nO(r,e),a=await je(Oc,n),[s]=r.function.split("::"),{fetchConfig:i,extParams:o={},address:c}=e,l=rO(t),{txSource:u=fe.DEX,serviceCharge:h=l,orderId:b,crossChain:y,chainId:v,tokenAddress:S,amount:R,toChainId:P,toTokenAddress:N}=o,M=JSON.stringify({nonce:t?.base?.sequenceNumber}),L={signedTx:n,txSource:u,fromAdr:c,serviceCharge:h,toAdr:s,coinAmount:0,coinId:Yp,extJson:M,txHash:a,txType:Er.SWAP};return b&&(L={...L,orderId:b,crossChain:y,chainId:v,tokenAddress:S,amount:R,toChainId:P,toTokenAddress:N}),await rr(L,i),a}var aO={signTransaction:nO,signAndSendTransaction:Ire};d();f();ne();d();f();var sO=({fromAddr:r,toAddr:e,satBytes:t,utxoList:n=[],coinAmount:a,...s})=>({address:r,feePerB:t,inputs:n.map(({txHash:o,vout:c,coinAmount:l,rawTransaction:u})=>({vOut:c,txId:o,amount:l,rawTransaction:u})),outputs:[{address:e,amount:a}],...s});async function Ere(r,e){let t=e.result,n=await je(pe,t),{coinAmount:a,from:s,to:i,walletType:o,serviceCharge:c}=r,{fetchConfig:l,walletId:u,extParams:h={}}=e,{txSource:b=fe.DEX}=h,y={accountId:u,signedTx:t,txSource:b,fromAdr:s,serviceCharge:c,toAdr:i,coinAmount:a,coinId:Hp,txHash:n,walletType:o,...h};return await rr(y,l),n}async function Pre(r){let{to:e,memo:t,satBytes:n,from:a,memoPos:s,dustSize:i,coinAmount:o,utxoList:c}=r;return sO({memo:t,memoPos:s,toAddr:e,satBytes:n,fromAddr:a,dustSize:i,coinAmount:o,utxoList:c})}var iO={signAndSendTransaction:Ere,generateFormatedTxParams:Pre};d();f();var fO=_(Gn()),lO=_(C$()),Rg=_(A$());ne();d();f();Hn();var oO=_(te()),Sa=r=>(0,oO.isNil)(r)||m_(r,0);d();f();var cO=_(S$());Ge();function Vo(r){return r?vo(r):"0x0"}function qu(r,e){let{chainId:t}=e,n={};return r?.supportEip1559&&(n.maxFeePerGas=Vo(r.maxFeePerGas),n.maxPriorityFeePerGas=Vo(r.maxPriorityFeePerGas),n.type="0x2"),n.from=r.from,n.to=r.to,n.gasPrice=Vo(r.gasPrice),n.gasLimit=Vo(r.gasLimit),n.data=r.data||"",n.chainId=Vo(t),n.value=Vo(r.value||0),n.nonce=Vo(r.nonce),n.decimalNonce=(0,cO.default)(r.nonce),n}function dO(r){let{value:e,from:t,to:n,gasLimit:a,gasPrice:s,maxFeePerGas:i,maxPriorityFeePerGas:o,nonce:c}=r;return JSON.stringify({value:$e(e),from:t,to:n,gas:$e(a),gasPrice:$e(i||s),priorityFee:$e(o||0),nonce:$e(c)})}async function uO(r,e){let{address:t,keyring:n}=e,a=await qu(r,e);return await n.signTransaction(t,a)}async function Mre(r,e,t){let n=await qu(r,e),a={chainId:e.chainId,networkId:e.networkId,name:e.networkType},s={common:Rg.default.custom(a,{hardfork:Rg.Hardfork.London})},i=lO.TransactionFactory.fromTxData(n,s),o=await t.signTransaction(r.from,i);return(0,fO.bufferToHex)(o.serialize())}async function Nre(r,e){let{keyringController:t,baseChain:n,walletId:a}=e,s=await t.getKeyringByWalletId(a,n),i;e.result?i=e.result.rawTxResult:Ol(s.type)||xs(s.type)?i=await Mre(r,e,s):i=await uO(r,e);let o=await je(_r,i),c=await qu(r,e),{from:l,to:u,value:h,data:b,decimalNonce:y}=c,{coinId:v,fetchConfig:S,extParams:R={}}=e,{txSource:P=fe.DEX,orderId:N,crossChain:M,chainId:L,tokenAddress:B,amount:F,toChainId:K,toTokenAddress:H,isMev:j,mevInfo:X}=R,z=Sa(h)?0:Number($e(h)),T=r?.networkFee,m=dO(c),x={signedTx:i,coinId:v,coinAmount:z,fromAdr:l,toAdr:u||l,serviceCharge:T,txHash:o,extJson:m,txSource:P,inputData:b||"",mev:j?X?.name:""};return N&&(x={...x,orderId:N,crossChain:M,chainId:L,tokenAddress:B,amount:F,toChainId:K,toTokenAddress:H}),await rr(x,S),{hash:o,nonce:y}}async function Rre(r,e){return await qu(r,e)}var hO={signTransaction:uO,signAndSendTransaction:Nre,generateFormatedTxParams:Rre};d();f();ae();ne();d();f();var Uu=_(xd());function pO(r){return wd.deserialize(Uu.default.decode(r))}function mO(r){let e=r.message;return Uu.default.encode(e.serialize())}function gO(r,e){return[new Ll(r),Uu.default.decode(e)]}function bO(r){return Uu.default.encode(r.serialize())}async function yO(r,e){let{address:t,keyring:n}=e,a=mO(r);return await n.signMessage(t,a)}async function kre(r,e){let{address:t,fetchConfig:n,extParams:a={}}=e,{serviceCharge:s=1e5,txSource:i=fe.DEX,orderId:o,crossChain:c,chainId:l,tokenAddress:u,amount:h,toChainId:b,toTokenAddress:y}=a,v=pO(r?.transaction),S=await yO(v,e),[R,P]=gO(t,S);v.addSignature(R,P);let N=bO(v),M=await je(kc,N),L={txSource:i,signedTx:N,fromAdr:t,serviceCharge:s,toAdr:"",coinAmount:0,coinId:Ex,txHash:M,txType:Er.SWAP};return o&&(L={...L,orderId:o,crossChain:c,chainId:l,tokenAddress:u,amount:h,toChainId:b,toTokenAddress:y}),await rr(L,n),{signature:S,publicKey:t}}var xO={signTransaction:yO,signAndSendTransaction:kre};d();f();ne();Hn();d();f();var wO=_(Qr());var vO=_(Zs()),Ore=async(r={})=>{let{contractAddress:e,contractName:t,functionName:n,functionArgs:a}=r,s={data:{type:si.CONTRACT_CALL,data:{contract:e,contractName:t,functionName:n,functionArgs:a}}};return await(0,wO.getRawTransaction)(vO.Currency.Stx,s)};async function SO({transaction:r,fromAddress:e,value:t}){let n=await Ore(r);return(await v5({fromAddress:e,value:t,inputData:n}))?.gasLimit||"0"}async function Dre(r,e){let{fetchConfig:t,extParams:n={},address:a,keyring:s}=e,{fee:i=0,amount:o=0}=n,c=Nn(o,10**6),l=await SO({transaction:r,fromAddress:a,value:c}),u=i||l||"8000",h=await H0({fromAddress:a}),{info:b={}}=h,{nonce:y}=b,v={type:si.CONTRACT_CALL,data:{txData:{anchorMode:r.anchorMode,contractAddress:r.contractAddress,contractName:r.contractName,functionArgs:r.functionArgs,functionName:r.functionName,postConditionMode:r.postConditionMode,postConditions:r.postConditions||[]},fee:u,nonce:y}},S=await s.signTransaction(a,v),{txId:R,txSerializedHexString:P}=S,{txSource:N=fe.DEX,serviceCharge:M=u,orderId:L,crossChain:B,chainId:F,tokenAddress:K,toChainId:H,toTokenAddress:j}=n,X=JSON.stringify({nonce:y}),z={signedTx:P,txSource:N,fromAdr:a,serviceCharge:M,coinId:_l,extJson:X,txHash:R,coinAmount:c,toAdr:r.contractAddress,txType:Er.SWAP};return L&&(z={...z,orderId:L,crossChain:B,chainId:F,tokenAddress:K,amount:o,toChainId:H,toTokenAddress:j}),await rr(z,t),{txHash:R,signature:P}}var _O={signAndSendTransaction:Dre};d();f();ne();d();f();var kg=_(ql());ne();var Lre=async r=>await Sd({coinId:ls,address:r},{fromAddr:r,toAddr:""}),Bre=async(r,e)=>{let{data:t}=await V9({coinId:ls,address:r,inputData:e});return t?.gasLimit||0},Wre=async({fromAddress:r,calls:e,nonce:t,feeInt:n,keyring:a})=>{let s={type:"multi_contract_call",nonce:t,maxFee:n,chainId:pi.StarknetChainId.SN_MAIN,multiContractCallData:{from:r,calls:e}};return(await a.signTransaction(r,s))?.signature},AO=async({fromAddress:r,calls:e,keyring:t})=>{let n=await Lre(r),a=(0,kg.default)(n,"info.nonce",0),s=await Wre({fromAddress:r,calls:e,nonce:a,feeInt:0,keyring:t});return{feeInt:await Bre(r,s),nonce:a}},CO=r=>{let e=(0,kg.default)(r,"[0].contractAddress",""),t=(0,kg.default)(r,"contractAddress","");return e||t};async function Kre(r,e){let{fetchConfig:t,extParams:n={},address:a,keyring:s}=e,i=CO(r),{feeInt:o,nonce:c}=await AO({calls:r,fromAddress:a,keyring:s}),l={type:l8.MULTI_CONTRACT_CALL,nonce:c,maxFee:o,chainId:pi.StarknetChainId.SN_MAIN,multiContractCallData:{from:a,calls:r}},u=await s.signTransaction(a,l),{txId:h,signature:b}=u,{txSource:y=fe.DEX,serviceCharge:v=o,orderId:S,crossChain:R,chainId:P,tokenAddress:N,toChainId:M,toTokenAddress:L,amount:B}=n,F=JSON.stringify({serviceChargeCoinId:ls,nonce:c}),K={signedTx:b,txSource:y,fromAdr:a,serviceCharge:v,coinId:ls,extJson:F,txHash:h,coinAmount:0,toAdr:i,txType:Er.SWAP};return S&&(K={...K,orderId:S,crossChain:R,chainId:P,tokenAddress:N,amount:B,toChainId:M,toTokenAddress:L}),await rr(K,t),{transaction_hash:h}}var TO={signAndSendTransaction:Kre};d();f();ne();d();f();var hS={MOVECALL:"moveCall",REQUESTTYPE:"WaitForLocalExecution"};async function IO(r,e){let{keyring:t,address:n}=e,a={type:"raw",data:r.transactionBlock};return await t.signTransaction(n,a)}async function qre(r,e){let{address:t,fetchConfig:n,extParams:a={}}=e,{txSource:s=fe.DEX,serviceCharge:i=3e6,orderId:o,crossChain:c,chainId:l,tokenAddress:u,amount:h,toChainId:b,toTokenAddress:y}=a,v=await IO(r,e),{signature:S,hash:R}=v||{},P={txHash:R,inputData:hS.MOVECALL,signedTx:{signatures:[S],tx_bytes:r.transactionBlock,request_type:hS.REQUESTTYPE},toAdr:"",coinAmount:0,fromAdr:t,coinId:o_,serviceCharge:i,txSource:s,txType:Er.SWAP};return o&&(P={...P,orderId:o,crossChain:c,chainId:l,tokenAddress:u,amount:h,toChainId:b,toTokenAddress:y}),await rr(P,n),R}var EO={signTransaction:IO,signAndSendTransaction:qre};d();f();async function Ure(r,e){let{walletId:t,extParams:n,keyringController:a,fetchConfig:s}=e,{txSource:i,accountId:o,walletType:c,coinId:l,coinAmount:u,fromAdr:h,toAdr:b,serviceCharge:y,extJson:v,memo:S="",transactionParams:R}=n,{body:P,txHash:N}=await a.signMultiTransaction(h,t,R),M={txSource:i,accountId:o,walletType:c,coinId:l,coinAmount:u,fromAdr:h,toAdr:b,serviceCharge:y,extJson:v,memo:S,txHash:N,signedTx:P,txType:Er.SWAP};return await rr(M,s),{txHash:N}}var PO={signAndSendTransaction:Ure};d();f();ae();ne();d();f();var pS=_(te()),MO=_(F0());function NO(r,e){return MO.default.address.fromHex((0,pS.get)(r,"raw_data.contract[0].parameter.value.contract_address",e))}function RO(r){return(0,pS.get)(r,"raw_data.contract[0].parameter.value.data","")}async function Fre(r,e){let t={result:!0,transaction:null},n={raw_data:r.raw_data,raw_data_hex:r.raw_data_hex,visible:r.visible,txID:r.txID},{keyring:a,address:s,fetchConfig:i,extParams:o={}}=e,{txSource:c=fe.DEX,orderId:l,crossChain:u,chainId:h,tokenAddress:b,amount:y,toChainId:v,toTokenAddress:S}=o,R={type:"protobuf",message:JSON.stringify(n)},P=await a.signMessage(s,R),N=NO(n,s),M=RO(n),L={coinId:xo,address:s},B={fromAddr:s,scenario:fd.SCENARIO_INTERACTION,inputData:M,toAddr:N,dataLength:M.length},{info:{fee:F=0}}=await L0(L,B),K=await je(Fp,P),H={signedTx:P,txSource:c,fromAdr:s,toAdr:N,coinAmount:0,coinId:xo,serviceCharge:F,txHash:K};return l&&(H={...H,orderId:l,crossChain:u,chainId:h,tokenAddress:b,amount:y,toChainId:v,toTokenAddress:S}),await rr(H,i),t.transaction=n,t}var kO={signAndSendTransaction:Fre};var OO={[_r]:hO,[kc]:xO,[Oc]:aO,[Fp]:kO,[ds]:EO,[go]:_O,[xn]:TO,[pe]:iO,[er]:PO},Hre=10,Fu=class extends BO.default{constructor(e={}){super(e),this.preferencesController=e.preferencesController,this.keyringController=e.keyringController,this.authController=e.authController,this.chainController=e.chainController,this.store=new DO.ObservableStore({requests:[]})}recordDexRequest(e){let{requests:t}=this.store.getState(),n=(0,LO.default)(t);n.length>Hre&&n.shift(),n.push(e),this.store.updateState({requests:n})}async getKeyring(e,t){return await this.keyringController.getKeyringByWalletId(e,t)}async generateCommonParams(e,t,n){let a=me({netWorkId:String(e)}),s=a?.localType,i=this.preferencesController.getSelectedWallet(),{accountMap:o}=await this.keyringController.getAccountInfoByWalletId(i),c=await this.authController.getSignRequestHeaders({walletId:i}),l=o[s],u=a?.coinId,h=a?.coinType,y=st().find(R=>R.coinId===u)?.baseChain,v={headers:c},S=await this.getKeyring(i,y);return{result:t.result,networkId:Al(s)?.networkId,networkType:s,address:l,coinId:u,walletId:i,keyring:S,chainId:e,baseChain:y,coinType:h,fetchConfig:v,extParams:t.extParams||n||{},repeatTxType:t.repeatTxType,oldTxHash:t.oldTxHash,keyringController:this.keyringController}}async generateFormatedTxParams(e,t){let n=await this.generateCommonParams(e,t);return await OO[n.baseChain].generateFormatedTxParams(t,n)}async dexSignAndSubmitTransaction(e,t,n){this.recordDexRequest(t);let a=await this.generateCommonParams(e,t,n);return await OO[a.baseChain].signAndSendTransaction(t,a,n)}async dexSignTypedDataV4(e,t){let{keyring:n,address:a}=await this.generateCommonParams(e,t);return await n.signTypedDataV4(a,t)}};d();f();Be();var WO=_(te());An();Cn();W4();ur();Wt();Kc();var Hu=class extends ge{constructor(t){super();le(this,"throttleSetFastDomain",(0,WO.throttle)(this.setFastDomain,5e3,{trailing:!1}));let{store:n}=t;n.subscribe(({domains:a})=>{a.countryCode&&K4.setCountryCode(a.countryCode),this.throttleSetFastDomain(a)})}replaceMoreString(t){return t.replace(/\/*$/u,"")}createGetTestSpeedPromises(t,n,a,s){return new Promise((i,o)=>{Cl(`${t}${n}`,{},{headers:{wallet_plugin:"OKWallet","Cache-Control":"no-cache",disabledSentry:"1"}}).then(()=>{a&&a(),i(`${t}`)}).catch(c=>{s&&s(o),setTimeout(()=>{o(c)},1e3*60)})})}createSocket(t,n,a){let s=new WebSocket(`${t[n]}${T_}`);s.onopen=async()=>{s.close(),await xe.set({[a]:t[n]}),l_.setUrl(t[n]),this.emit("wssDomainChanged")},s.onerror=i=>{s.close(),n+=1,t[n]?this.createSocket(t,n,a):Ae.captureEvent({message:`NET_ERROR_httpdns_allWssDomain from ${i.currentTarget.url}`,contexts:{report:{info:JSON.stringify({url:i.currentTarget.url})}},exception:{values:[{type:"NET_ERROR_httpdns_allWssDomain",value:`NET_ERROR_httpdns_allWssDomain from ${i.currentTarget.url}`}]},level:"info"})}}async setFastDomain(t){let{apiDomain:n,userChooseNetwork:a}=await xe.get(["apiDomain","userChooseNetwork"]),s=!0;if(n&&a)try{await this.createGetTestSpeedPromises(this.replaceMoreString(n),this.replaceMoreString(Xs.app.tryPaths.apiDomain.url),()=>{s=!1},async i=>{await chrome.storage.local.remove("userChooseNetwork"),i("user network error")})}catch{}Object.keys(Xs.app.tryPaths).forEach(i=>{if(i==="apiDomain"&&!s)return;let o=Xs.app.tryPaths[i];(i==="staticDomain"||i==="apiDomain")&&Promise.race(t[`${i}s`].map(c=>this.createGetTestSpeedPromises(this.replaceMoreString(c),this.replaceMoreString(o.url))).filter(c=>c)).then(c=>{switch(xe.set({[i]:c}),i){case"apiDomain":Jp.setUrl(c),globalThis.setupSentry();break;case"staticDomain":Zp.setUrl(c);break;default:break}}).catch(()=>{let c=i==="staticDomain"?"NET_ERROR_httpdns_allStaticDomain":"NET_ERROR_httpdns_allAPIDomain";Ae.captureEvent({message:c,contexts:{report:{info:JSON.stringify({domains:t})}},exception:{values:[{type:c,value:c}]},level:"info"})}),i==="wssDomain"&&this.createSocket(t[`${i}s`],0,i)})}};d();f();Be();var UO=_(Ne());Wt();var FO=_(te());e$();W4();Cn();var{domains:Gre,ips:zre}=Xs.httpdns,{defaultAppDomains:Gu}=Xs.app,KO={domain:"domain",ip:"ip",static:"static"},mS={api:"api",static:"static"},qO=2*1e3,jre=10*60*1e3,Vre=10*60*1e3,zu=class extends ge{constructor(){super();le(this,"autoRefresh",(0,FO.throttle)(this._autoRefresh,2e3));this.store=new UO.ObservableStore({}),this.interval=null,this.ready=new Promise(t=>{this.readyResolve=t}),this._init()}async _init(){this.on("refresh",this.autoRefresh),Gu=await this._getDefaultAppDomains(),this.autoRefresh(),this.readyResolve()}async _initHttpdnsConfigs(){this.httpdnsConfigs=[],Gre.forEach(t=>{this.httpdnsConfigs.push({url:t,type:KO.domain,fetchType:mS.api,disabled:!1,disabledTime:null})}),zre.forEach(t=>{this.httpdnsConfigs.push({url:t,type:KO.ip,fetchType:mS.api,disabled:!1,disabledTime:null})}),this.store.updateState(await this._getInitState())}async _getDefaultAppDomains(){let{defaultAppDomains:t}=await xe.get("defaultAppDomains");return t||Gu}_setDefaultAppDomains(t){xe.set({defaultAppDomains:t})}async _getInitState(){return{domains:Gu}}async _autoRefresh(){this.clear(),this._fetchHttpdns(),this.interval=setInterval(()=>{this._fetchHttpdns()},jre)}async clear(){this.interval&&clearInterval(this.interval),this.interval=null,this._initHttpdnsConfigs()}async _fetchHttpdns(){let t=null;for(let n=0,{length:a}=this.httpdnsConfigs;n<a;n++)if(t=await this._fetchConfig(this.httpdnsConfigs[n]),t){if(n!==0){let s=this.httpdnsConfigs[0];this.httpdnsConfigs[0]=this.httpdnsConfigs[n],this.httpdnsConfigs[n]=s}break}t?(this._setDefaultAppDomains(t),this.store.updateState({domains:t},!1)):(this._setDefaultAppDomains(Gu),this.store.updateState({domains:Gu},!1),this.httpdnsConfigs.forEach(n=>{n.disabled=!1,n.disabledTime=null}))}async _fetchConfig(t){let n=null;t.disabled&&Date.now()-t.disabledTime>Vre&&(t.disabled=!1,t.disabledTime=null);try{t.fetchType===mS.api&&(n=await this._fetchApi(t.url)),n||(t.disabled=!0,t.disabledTime=Date.now())}catch{t.disabled=!0,t.disabledTime=Date.now()}return n}_decryptContent(t){let n=null;try{let a=e_(Xs.httpdns.aesDecryptSecret,t);n=JSON.parse(a)}catch{console.log("\u89E3\u5BC6\u5931\u8D25:",t)}return n}async _fetchApi(t){let n=null,{data:{data:a,code:s}}=await Cl(t,{},{timeout:qO,headers:{wallet_plugin:"OKWallet",disabledSentry:"1"}});return`${s}`=="0"&&(n=this._decryptContent(a)),n}async _fetchStatic(t){let n=null,{data:a}=await Cl(t,{},{timeout:qO,headers:{wallet_plugin:"OKWallet",disabledSentry:"1"}});return n=this._decryptContent(a),n}};d();f();var HO=_(yn());Cn();var ju=class{constructor(){le(this,"instanceID","");le(this,"getDeviceId",async()=>{let{devid:e}=await xe.get("devid");return e});le(this,"setDeviceIdToInstanceID",async()=>{let e=await this.getDeviceId();xe.set({instanceID:e}),this.instanceID=e});le(this,"setInstanceID",async()=>{let{instanceID:e}=await xe.get("instanceID");if(e)this.instanceID=e;else{let t=!1;HO.default?.instanceID?.getID(async n=>{if(!t){if(t=!0,!n){this.setDeviceIdToInstanceID();return}xe.set({instanceID:n}),this.instanceID=n}}),setTimeout(async()=>{t||(t=!0,this.setDeviceIdToInstanceID())},1e3)}});le(this,"getInstanceID",()=>this.instanceID);this.setInstanceID()}};d();f();Be();var RS=_(Ne()),ZD=_(du()),kS=_(X0()),OS=_(xd()),Ja=_(Ox()),Vg=_(te());ae();ne();Hn();d();f();var $re=r=>async(...e)=>{try{let t=await r(...e);return{status:"fulfilled",value:t}}catch(t){return{status:"rejected",reason:t}}},GO=async(r=1,e)=>{if(r<1)return[];let t=$re(e),n=async(s=0,i=[])=>{if(s>=r)return i;let o=await t(s);return i.push(o),await n(s+1,i)};return await n(0)};d();f();Be();var wD=_(X0()),vD=_(te());Ge();ae();ne();d();f();var gS=_(X0()),Vu=_(te()),bS=gS.default.wordlists.english,zO=bS.length,{validateMnemonic:Yre}=gS.default,Jre=()=>{let r=(0,Vu.random)(0,zO-1);return bS[r]},Xre=(r,e=3)=>{if(typeof r!="string"||!bS.includes(r))throw new Error("invalid mnemonic word");if(e<=1||e>=zO)throw new Error("the length is too short or long");let t=(0,Vu.random)(0,e-1),n=[];for(let a=0;a<e;a++)if(t===a)n.push(r);else{let s=!1,i="";for(;!s;)i=Jre(),i!==r&&!n.includes(i)&&(s=!0);n.push(i)}return n},Zre=r=>typeof r=="string"&&typeof r.normalize=="function"?r.normalize("NFKD"):"",yS=async r=>{if(!await cu(r)&&!Yre(r))throw new Error("invalid mnemonic");let e=Zre(r).split(" "),t=e.map((i,o)=>o),s=(0,Vu.shuffle)(t).slice(0,3).reduce((i,o)=>{let c=e[o],l=Xre(c);return i.push({index:o+1,word:c,confuseWords:l}),i},[]);return s.sort((i,o)=>i.index-o.index),s};d();f();ae();d();f();var jO=_(Zs());ne();var Og=r=>Po().includes(r)?[0,jO.Currency.ATOM,0]:a_[r],$u=r=>Po().includes(r)?ei.Secp256k1:s_[r];ne();d();f();d();f();d();f();var rf=_(Qr());d();f();var Dg=_(Qr());var $O=_(uw());var VO=async(r,e,t="",n="")=>{let a={privateKey:e};e8.includes(t)&&(a.addressType=t===de.SEGWIT_NESTED_49?de.SEGWIT_NESTED:t),n&&(a.hrp=n);let{address:s,publicKey:i,compressedPublicKey:o=""}=await(0,Dg.getNewAddress)(r,a);return{privateKey:e,publicKey:i,compressedPublicKey:o,address:s,addressType:t}},Qre=async(r,e,t="",n={},a="",s="")=>{if(!Vr.includes(s))return VO(r,e,"",a);let i=Co[s],o={};return await Promise.all(i.map(l=>VO(r,n[l]||e,l,a).then(u=>{o[l]=u}))),{...o[t]||o[Ml[s]],addressMap:o}},YO=(r,e,t,n,a="",s="")=>Promise.all(e.map(i=>Qre(r,i,t,n,a,s))),JO=async({share:r,pShare:e,currency:t,addressType:n,mpcId:a,cosmosPrefix:s,baseChain:i,deriveIndex:o=0})=>{let c=Og(i),l=(0,$O.default)(c);l[l.length-1]=o;let{address:u,childPublicKey:h,multiAddress:b}=await(0,Dg.getMPCAddress)(l,r,t,s);if(!Vr.includes(i))return{address:u,publicKey:h,share:r,pShare:e,addressType:"",mpcId:a,deriveIndex:o};let y=Co[i],v={},S={[de.LEGACY]:"Legacy",[de.SEGWIT_NESTED_49]:"segwit_nested",[de.SEGWIT_NATIVE]:"segwit_native"};return y.forEach(P=>{let N=S[P];N&&(v[P]={address:b.find(M=>M.addressType===N)?.address||"",publicKey:h,compressedPublicKey:h,share:r,pShare:e,addressType:P,mpcId:a,deriveIndex:o})}),{...v[n]||v[Ml[i]],addressMap:v}};d();f();var XO=_(X0()),ene=(r,{hdPath:e,segWitHdPath:t={}}={})=>class extends r{async deserialize(n={}){this.mnemonic=n.mnemonic||XO.default.generateMnemonic(),this.type=n.type,n.numberOfAccounts&&await this.addAccounts(n.numberOfAccounts,n.addressTypes,n.wallets)}async addAccounts(n=1,a,s=[]){let i=this.wallets.length,o=[];for(let u=i,h=0;u<n+i;u++)o.push(this.addAccount(u,e,a[h],s[h],t)),h++;return(await Promise.all(o)).map(({address:u})=>u)}async addAccount(n,a,s,i,o){let c=i?.[this.baseChain];if(c)return this.createByWallet(c);let l=await this.derivedPrivateKey(n,a),u=Object.keys(o),h={};for(let y=0;y<u.length;y++){let v=u[y],S=await this.derivedPrivateKey(n,o[v]);h[v]=S}return(await this.create([l],s?.[this.baseChain],h))?.[0]||{}}async derivedPrivateKey(n,a){return this.getDerivedPrivateKey({mnemonic:this.mnemonic,deriveIndex:n,hdPath:a&&a.bind(this)})}},wr=ene;d();f();var Cr=_(Zs());function Yu(r,e){switch(r){case Cr.Currency.SOL:return`m/44'/501'/${e}'/0'`;case Cr.Currency.APTOS:return`m/44'/637'/${e}'/0'/0'`;case Cr.Currency.ATOM:return`m/44'/118'/0'/0/${e}`;case Cr.Currency.EVMOS:case Cr.Currency.ZKSPACE:case Cr.Currency.INJ:return`m/44'/60'/0'/0/${e}`;case Cr.Currency.CRO:return`m/44'/394'/0'/0/${e}`;case Cr.Currency.Kava:return`m/44'/459'/0'/0/${e}`;case Cr.Currency.SCRT:return`m/44'/529'/0'/0/${e}`;case Cr.Currency.Terra:return`m/44'/330'/0'/0/${e}`;case Cr.Currency.SUI:return`m/44'/784'/${e}'/0'/0'`;case Cr.Currency.ZKSYNC:return`m/44'/60'/0'/0/${e}`;case Cr.Currency.Starknet:return`m/44'/9004'/0'/0/${e}`;case Cr.Currency.ADA:return`m/1852'/1815'/${e}'/0/0`;case Cr.Currency.NostrAssets:return`m/44'/1237'/${e}'/0/0`;case Cr.Currency.Kaspa:return`m/44'/111111'/0'/0/${e}`;case Cr.Currency.Near:return`m/44'/397'/${e}'`;case Cr.Currency.TON:return`m/44'/607'/${e}'`;default:return`m/44'/${r}'/0'/0/${e}`}}var on=class{constructor(e,t,n=""){this.currency=e,this.wallets=[],this.cosmosPrefix=n,this.baseChain=t}async create(e=[],t,n){return e.length?(await YO(this.currency,e,t,n,this.cosmosPrefix,this.baseChain)).map(({privateKey:s,address:i,publicKey:o,compressedPublicKey:c,addressType:l,addressMap:u})=>{let h={privateKey:s,publicKey:o,compressedPublicKey:c,address:i,addressType:l,addressMap:u};return this.wallets.push(h),h}):[]}async createByWallet(e){return this.wallets.push(e),e}async getDerivedPrivateKey({mnemonic:e,deriveIndex:t=0,hdPath:n=a=>Yu(this.currency,a)}){let a=await n(t);return(0,rf.getDerivedPrivateKey)(this.currency,{mnemonic:e,hdPath:a})}getAccounts(){return this.wallets.map(({address:e,addressMap:t={}})=>{let n=Object.entries(t).reduce((a,[s,{privateKey:i,...o}])=>(a[s]=o,a),{});return{address:e,addressMap:n}})}setAccount(e,t){let n=this.getWalletForAccount(e);return!n.addressMap||!n.addressMap[t]?n:Object.assign(n,n.addressMap[t])}setAddressByPublicKey(e,t){if(typeof t!="string"||typeof e!="string")return!1;let n=this.getWalletForPublicKey(e);return n.address!==t?(Object.assign(n,{address:t}),!0):!1}exportAccount(e){let{privateKey:t}=this.getWalletForAccount(e);return Promise.resolve(t)}getPublicKey(e){let{publicKey:t}=this.getWalletForAccount(e);return Promise.resolve(t)}getWalletForAccount(e){let t=this.wallets.find(n=>{let a=Object.values(n.addressMap||{}).map(s=>s.address);return n.address.toLocaleLowerCase()===e.toLocaleLowerCase()||a.includes(e)});if(!t)throw new Error("Simple Keyring - Unable to find matching address.");return t}getWalletForPublicKey(e){let t=this.wallets.find(n=>n.publicKey===e);if(!t)throw new Error("Simple Keyring - Unable to find matching address.");return t}getWalletForPrivateKey(e){let t=this.getWalletForAccount(e);if(t.address.toLocaleLowerCase()===e.toLocaleLowerCase())return t.privateKey;if(t=Object.values(t.addressMap).find(n=>n.address.toLocaleLowerCase()===e.toLocaleLowerCase()),!t)throw new Error("Simple Keyring - Unable to find matching address.");return t.privateKey}async signTransaction(e,t){try{let{privateKey:n}=this.getWalletForAccount(e);return await(0,rf.signTransaction)(this.currency,{privateKey:n,data:t})}catch{throw new Error(gs)}}async signMessage(e,t){let{privateKey:n}=this.getWalletForAccount(e);return(0,rf.signMessage)(this.currency,{privateKey:n,data:t})}},ZO=wr(on),QO=wr(on,{segWitHdPath:{[de.SEGWIT_NESTED]:r=>`m/84'/2'/0'/0/${r}`,[de.SEGWIT_NESTED_49]:r=>`m/49'/2'/0'/0/${r}`,[de.SEGWIT_NATIVE]:r=>`m/84'/2'/0'/0/${r}`}});var Ju=class extends on{async create(e=[],t,n){(await super.create(e,t,n)).forEach(s=>{let{addressMap:i,...o}=s;o.addressMap={[de.LONG]:{...o}},o.addressType=de.LONG,Object.assign(s,o)})}updateAddressMap(e,t){try{return this.wallets=this.wallets.map(n=>{if(n.publicKey===e){let a={...n,addressMap:{...n.addressMap,[de.SHORT]:{...n.addressMap[de.LONG],addressType:de.SHORT,address:t}}};return n.addressMap[de.SHORT]||(a.address=t,a.addressType=de.SHORT),a}return n}),!0}catch{return!1}}},eD=wr(Ju);ae();ne();d();f();var nf=_(O_()),gn=_(Qr());var _a=class extends on{async signTransaction(e,t,{utxos:n=[]}={}){n=[{address:e,inputs:t.inputs},...n||[]];let{omni:a}=t,{inputs:s}=this.mergeUtxo(n);return(0,gn.signTransaction)(a?gn.Currency.OMNI_USDT:this.currency,{data:{...t,inputs:s}})}async signInscribe(e,{commitTxPrevOutputList:t,commitFeeRate:n,revealFeeRate:a,inscriptionDataList:s,revealOutValue:i=546,changeAddress:o=e,toAddr:c}){let{inputs:l}=this.mergeUtxo([{address:e,inputs:t}]),u={commitTxPrevOutputList:l,commitFeeRate:n,revealFeeRate:a||n,inscriptionDataList:this.inscription(s,c||e),revealOutValue:i,changeAddress:o,type:1};return(0,gn.signTransaction)(gn.Currency.BTC,{data:u})}async signPsbt(e,t,n,a){let s=super.getWalletForPrivateKey(e),i={};return a?i={psbtHexs:t,type:4,options:n}:i={psbt:t,type:3,...n},(0,gn.signTransaction)(this.currency,{privateKey:s,data:i})}async signMessage(e,t,n){let a=u0[n.type],s=super.getWalletForAccount(e);switch(a){case nf.BITCOIN_MESSAGE_ECDSA:return(0,gn.signMessage)(this.currency,{privateKey:s.privateKey,data:{message:t,type:nf.BITCOIN_MESSAGE_ECDSA}});case nf.BITCOIN_MESSAGE_BIP0322_SIMPLE:return(0,gn.signMessage)(this.currency,{privateKey:s.privateKey,data:{type:nf.BITCOIN_MESSAGE_BIP0322_SIMPLE,address:e,message:t}});default:return""}}async splitUtxo(e,t){let n=t.splitAmount||2,a=[{address:e,inputs:t.inputs}],{inputs:s}=this.mergeUtxo(a),i=await(0,gn.signTransaction)(gn.Currency.BTC,{data:{inputs:s,outputs:Array.from({length:n}).map(()=>({address:e,amount:t.amount})),address:e,feePerB:t.feePerB}}),o=await(0,gn.calcTxHash)(gn.Currency.BTC,{data:i}),c=Array.from({length:n}).map((l,u)=>({txId:o,vOut:u,amount:t.amount}));return{signed:i,utxos:c}}mergeUtxo(e){let t=[];return e.forEach(n=>{let a=super.getWalletForPrivateKey(n.address);n.inputs.forEach(s=>{t.push({...s,address:n.address,privateKey:a})})}),{inputs:t}}inscription(e,t,n="text/plain;charset=utf-8"){let a=[];return e.forEach(s=>{let i={...s};i.contentType||(i.contentType=n),i.revealAddr||(i.revealAddr=t),a.push(i)}),a}getCompressedPublicKey(e){let{compressedPublicKey:t=""}=super.getWalletForAccount(e);return Promise.resolve(t)}},tD=wr(_a,{segWitHdPath:{[de.SEGWIT_NESTED]:r=>`m/84'/0'/0'/0/${r}`,[de.SEGWIT_NESTED_49]:r=>`m/49'/0'/0'/0/${r}`,[de.SEGWIT_NATIVE]:r=>`m/84'/0'/0'/0/${r}`,[de.SEGWIT_TAPROOT]:r=>`m/86'/0'/0'/0/${r}`}}),rD=wr(_a,{segWitHdPath:{[de.SEGWIT_NESTED]:r=>`m/84'/1'/0'/0/${r}`,[de.SEGWIT_NESTED_49]:r=>`m/49'/1'/0'/0/${r}`,[de.SEGWIT_NATIVE]:r=>`m/84'/1'/0'/0/${r}`,[de.SEGWIT_TAPROOT]:r=>`m/86'/1'/0'/0/${r}`}}),nD=wr(_a,{segWitHdPath:{[de.SEGWIT_NESTED]:r=>`m/84'/1'/0'/0/${r}`,[de.SEGWIT_NESTED_49]:r=>`m/49'/1'/0'/0/${r}`,[de.SEGWIT_NATIVE]:r=>`m/84'/1'/0'/0/${r}`,[de.SEGWIT_TAPROOT]:r=>`m/86'/1'/0'/0/${r}`}}),aD=wr(_a,{segWitHdPath:{[de.SEGWIT_NESTED]:r=>`m/84'/0'/0'/0/${r}`,[de.SEGWIT_NESTED_49]:r=>`m/49'/0'/0'/0/${r}`,[de.SEGWIT_NATIVE]:r=>`m/84'/0'/0'/0/${r}`,[de.SEGWIT_TAPROOT]:r=>`m/86'/0'/0'/0/${r}`}});d();f();var xS=_(Qr());var Xu=class extends on{async signTransferTransaction(e,t={}){if(typeof t!="object"||!Array.isArray(t?.inputs))throw new Error("sign cardano transfer transaction error, params is invalid");let n=t.inputs.map(a=>({...a,privateKey:e}));return(0,xS.signTransaction)(this.currency,{data:{...t,inputs:n}})}async signTransaction(e,t={}){let n=super.getWalletForPrivateKey(e);return t?.type===m0.TRANSFER?this.signTransferTransaction(n,t):(0,xS.signTransaction)(this.currency,{privateKey:n,data:t})}},sD=wr(Xu);d();f();var bn=_(Qr()),wS=_(h$());var iD={ETH_SIGN:0,PERSONAL_SIGN:1},Rs=class extends on{async signTransaction(e,t){let n={...t,type:typeof t.type=="string"?Number($e(t.type)):t.type},{privateKey:a}=super.getWalletForAccount(e),s={privateKey:a,data:n},i=await(0,bn.signTransaction)(bn.Currency.ETH,s);return Promise.resolve(i===void 0?t:i)}async signMessage(e,t){let{privateKey:n}=super.getWalletForAccount(e),a={privateKey:n,data:{type:iD.ETH_SIGN,message:t}},s=await(0,bn.signMessage)(bn.Currency.ETH,a);return Promise.resolve(s)}async signPersonalMessage(e,t){let{privateKey:n}=super.getWalletForAccount(e),a={privateKey:n,data:{type:iD.PERSONAL_SIGN,message:t}},s=await(0,bn.signMessage)(bn.Currency.ETH,a);return Promise.resolve(s)}async decryptMessage(e,t){let{privateKey:n}=super.getWalletForAccount(e),s=await new wS.EthWallet().decrypt(t,n);return Promise.resolve(s)}signTypedData(e,t,n={version:"V1"}){switch(n.version){case"V1":return this.signTypedDataV1(e,t);case"V3":return this.signTypedDataV3(e,t);case"V4":return this.signTypedDataV4(e,t);default:return this.signTypedDataV1(e,t)}}async signTypedDataV1(e,t){let n=JSON.stringify(t),{privateKey:a}=super.getWalletForAccount(e),s={privateKey:a,data:{type:2,message:n}},i=await(0,bn.signMessage)(bn.Currency.ETH,s);return Promise.resolve(i)}async signTypedDataV3(e,t){let n=JSON.stringify(t),{privateKey:a}=super.getWalletForAccount(e),s={privateKey:a,data:{type:3,message:n}},i=await(0,bn.signMessage)(bn.Currency.ETH,s);return Promise.resolve(i)}async signTypedDataV4(e,t){let n=JSON.stringify(t),{privateKey:a}=super.getWalletForAccount(e),s={privateKey:a,data:{type:4,message:n}},i=await(0,bn.signMessage)(bn.Currency.ETH,s);return Promise.resolve(i)}async getEncryptionPublicKey(e){let{privateKey:t}=super.getWalletForAccount(e),a=await new wS.EthWallet().getEncryptionPublicKey(t);return Promise.resolve(a)}},oD=wr(Rs);d();f();ae();var Zu=class extends Rs{async create(e=[]){let t=await super.create(e);return t.forEach(n=>{n.address=yd(n.address,Bc)}),t}async createByWallet(e){let t={...e};return t.address?(t.address=yd(t.address,Bc),super.createByWallet(t)):this.create([t.privateKey])}},cD=wr(Zu);d();f();ae();var Qu=class extends Rs{async create(e=[]){let t=await super.create(e);return t.forEach(n=>{n.address=yd(n.address,Lc)}),t}async createByWallet(e){let t={...e};return t.address?(t.address=yd(t.address,Lc),super.createByWallet(t)):this.create([t.privateKey])}},dD=wr(Qu);d();f();var eh=_(s0());var th=class extends on{async getTransactionBodyForSimulate(e,t){try{let n=new eh.TonWallet,s={privateKey:super.getWalletForPrivateKey(e),data:t};return await n.getTransactionBodyForSimulate(s)}catch{throw new Error(gs)}}async simulateMultiTransaction(e,t){try{let n=new eh.TonWallet,s={privateKey:super.getWalletForPrivateKey(e),data:t};return await n.simulateMultiTransaction(s)}catch{throw new Error(gs)}}async signTonProof(e,t){try{let n=new eh.TonWallet,a=super.getWalletForPrivateKey(e);return await n.signTonProof({privateKey:a,walletAddress:e,...t})}catch{throw new Error(gs)}}async signMultiTransaction(e,t){try{let n=new eh.TonWallet,s={privateKey:super.getWalletForPrivateKey(e),data:t},{transaction:i}=await n.signMultiTransaction(s);return{txHash:await n.calcTxHash({data:i}),body:i}}catch{throw new Error(gs)}}},fD=wr(th,{hdPath(r){return this.type===$.TON_HD_KEYRING?"":Yu(this.currency,r)}});var vS={[_r]:Rs,[ke]:_a,[po]:_a,[mo]:_a,[En]:_a,[Lc]:Qu,[Bc]:Zu,[Gr]:Xu,[ln]:Ju,[er]:th,default:on},SS={[_r]:oD,[ke]:tD,[po]:rD,[mo]:nD,[En]:aD,[Lc]:dD,[Bc]:cD,[Gp]:QO,[Gr]:sD,[ln]:eD,[er]:fD,default:ZO};d();f();var Ta=_(Qr()),Lg=_(Zs()),Ii=_(O_()),mD=_(Aw());d();f();var sa=_(Qr()),AS=_(ql()),lD=_(uw());Cn();ne();var tne={[ei.Secp256k1]:sa.mpcSignEcdsa,[ei.Ed25519]:sa.mpcSignEd25519};function uD(r,e){let t=Og(r),n=(0,lD.default)(t);return n[n.length-1]=e,n}function rne(r){return JSON.stringify({ecdsaShare2:y8(r)})}function nne(r){let e=!1;try{let t=(0,AS.default)(r,"data.message");(0,AS.default)(JSON.parse(t),"message.action","").includes("OKX-ZKDEX")&&(e=!0)}catch{e=!1}return e}var _S=!1;async function hD({currency:r,txParams:e,mpcId:t,share:n,pShare:a,signFn:s,baseChain:i,deriveIndex:o,signHashList:c,turnOffMutex:l}){if(!l&&_S)throw new Error("[MPC] mpcSignService is running");_S=!0;let u=$u(i),h=uD(i,o);try{let b=(0,sa.mpcShakeHands)(t),{mpcToken:y}=await xe.get("mpcToken"),v={funcType:Vx.ShakeHands,encKey:b,mpcId:t,signType:u};if(!(await q0(v,{headers:{Authorization:y}}))?.data?.pass)throw new Error("[MPC] handshake error");let N={currency:r,mpcId:t,share:n,pShare:a,step:ui.Step0,path:h,serverData:""};e&&(N.txParams=e),c&&(N.signHashList=c);let M=await s(N),L={funcType:Vx.TssSign,encKey:b,mpcId:t,signType:u,data:M,step:ui.Step1},B=await U0(L,{headers:{Authorization:y}});if(!B?.data?.pass)throw new Error("[MPC] auth step1 error");N.step=ui.Step1,N.serverData=B?.data?.data;let K=await s(N);L.step=ui.Step2,L.data=K;let H=await U0(L,{headers:{Authorization:y}});if(!H?.data?.pass)throw new Error("[MPC] auth step2 error");N.step=ui.Step2,N.serverData=H?.data?.data;let X=await s(N);L.step=ui.Step3,L.data=X;let z=await U0(L,{headers:{Authorization:y}});if(!z?.data?.pass)throw new Error("[MPC] auth step3 error");return N.step=ui.Step3,N.serverData=z?.data?.data,await s(N)}catch(b){throw new Error(b)}finally{setTimeout(()=>{_S=!1},2e3)}}async function $a({currency:r,txParams:e,mpcId:t,share:n,pShare:a,baseChain:s,deriveIndex:i,signHashList:o,turnOffMutex:c}){let l=$u(s),u=tne[l];return await hD({currency:r,txParams:e,mpcId:t,share:n,pShare:a,signFn:u,baseChain:s,deriveIndex:i,signHashList:o,turnOffMutex:c})}async function ane({currency:r,txParams:e,share:t,baseChain:n,deriveIndex:a}){let s=uD(n,a),i=rne(t);return e.privateKey=await(0,sa.getCoinHexKeyStringFromShareString)(i,s),await(0,sa.signMessage)(r,e)}async function Aa({currency:r,txParams:e,mpcId:t,share:n,pShare:a,baseChain:s,deriveIndex:i,signHashList:o,turnOffMutex:c}){return nne(e)?await ane({currency:r,txParams:e,share:n,baseChain:s,deriveIndex:i}):await hD({currency:r,txParams:e,mpcId:t,share:n,pShare:a,signFn:sa.mpcSignMsg,baseChain:s,deriveIndex:i,signHashList:o,turnOffMutex:c})}d();f();var Ca=class{constructor(e={}){this.currency=e.currency,this.cosmosPrefix=e.cosmosPrefix,this.baseChain=e.baseChain,this.wallets=[],this.create(e),this.mpcSignTransaction=$a.bind(this),this.mpcSignMessage=Aa.bind(this)}async create(e){let t=await JO(e);return this.wallets.push(t),this.wallets}getMpcSignParams(e){let t=this.getWalletForAccount(e),{share:n,pShare:a,mpcId:s,deriveIndex:i}=t;return{share:n,pShare:a,mpcId:s,deriveIndex:i}}getAccounts(){return this.wallets.map(({address:e,addressMap:t={}})=>{let n=Object.entries(t).reduce((a,[s,{pShare:i,share:o,...c}])=>(a[s]=c,a),{});return{address:e,addressMap:n}})}setAccount(e,t){let n=this.getWalletForAccount(e);return!n.addressMap||!n.addressMap[t]?n:Object.assign(n,n.addressMap[t])}getPublicKey(e){let{publicKey:t}=this.getWalletForAccount(e);return Promise.resolve(t)}getWalletForAccount(e){let t=this.wallets.find(n=>{let a=Object.values(n.addressMap||{}).map(s=>s.address);return n.address.toLocaleLowerCase()===e.toLocaleLowerCase()||a.includes(e)});if(!t)throw new Error("Mpc Keyring - Unable to find matching address.");return t}async signTransaction(e,t){let n=this.getMpcSignParams(e),a={data:t},s=await $a({currency:this.currency,txParams:a,baseChain:this.baseChain,...n});return Promise.resolve(s)}async signMessage(e,t){let n=this.getMpcSignParams(e),a={data:t},s=await Aa({currency:this.currency,baseChain:this.baseChain,txParams:a,...n});return Promise.resolve(s)}};var pD=new Ii.BtcWallet,sne=10,rh=class extends Ca{async signTransaction(e,t,{utxos:n=[],fake:a=!1}={}){let s=this.getMpcSignParams(e),{childPublicKey:i}=await(0,Ta.getMPCAddress)([0,this.currency,s.deriveIndex],s.share,this.currency);n=[{address:e,inputs:t.inputs},...n||[]];let{omni:o}=t,{inputs:c}=this.mergeUtxo(n,{publicKey:i}),l={data:{...t,inputs:c}};if(a)return await this.signTransactionUsePk(e,t,{utxos:n});let{raw:u,hash:h}=await pD.getMPCRawTransaction(l),b={currency:o?Lg.Currency.OMNI_USDT:this.currency,baseChain:this.baseChain,signHashList:h,...s},y=await this.signHashByRate(b);return await pD.getMPCTransaction({raw:u,sigs:y,publicKey:i})}async signHashByRate(e){e.turnOffMutex=!0;let t=(0,mD.default)(e.signHashList,sne),n=[];for await(let a of t){e.signHashList=a;let s=await $a(e),i=JSON.parse(s).signatures;n.push(...i)}return n}async signTransactionUsePk(e,t,{utxos:n=[]}={}){n=[{address:e,inputs:t.inputs},...n||[]];let{omni:a}=t,s=await(0,Ta.getRandomPrivateKey)(Lg.Currency.BTC),{inputs:i}=this.mergeUtxo(n,{privateKey:s});return(0,Ta.signTransaction)(a?Lg.Currency.OMNI_USDT:this.currency,{data:{...t,inputs:i}})}async signMessage(e,t,n){let a=this.getMpcSignParams(e),s=u0[n.type],i={};return s===Ii.BITCOIN_MESSAGE_ECDSA?i={data:{message:t,type:Ii.BITCOIN_MESSAGE_ECDSA}}:s===Ii.BITCOIN_MESSAGE_BIP0322_SIMPLE&&(i={data:{type:Ii.BITCOIN_MESSAGE_BIP0322_SIMPLE,address:e,message:t}}),await Aa({currency:this.currency,baseChain:this.baseChain,txParams:i,...a})}getCompressedPublicKey(e){let{compressedPublicKey:t=""}=super.getWalletForAccount(e);return Promise.resolve(t)}mergeUtxo(e,t){let n=[];return e.forEach(a=>{a.inputs.forEach(s=>{n.push({...s,address:a.address,...t})})}),{inputs:n}}async splitUtxo(e,t){let n=t.splitAmount||2,a=await this.signTransaction(e,{inputs:t.inputs,outputs:Array.from({length:n}).map(()=>({address:e,amount:t.amount})),address:e,feePerB:t.feePerB}),s=await(0,Ta.calcTxHash)(this.currency,{data:a}),i=Array.from({length:n}).map((o,c)=>({txId:s,vOut:c,amount:t.amount}));return{signed:a,utxos:i}}async signInscribe(){return{inputs:[],outputs:[]}}async signPsbt(e,t){let n=this.getMpcSignParams(e),{childPublicKey:a}=await(0,Ta.getMPCAddress)([0,this.currency,0],n.share,this.currency),s={privateKey:"",data:{psbt:t,publicKey:a,type:25}},i=await(0,Ta.signTransaction)(this.currency,s),{psbtStr:o,signHashList:c}=i,l={currency:this.currency,baseChain:this.baseChain,signHashList:c,...n},u=await $a(l),h=JSON.parse(u).signatures;return s.data.psbt=o,s.data.signatureList=h,s.data.type=26,await(0,Ta.signTransaction)(this.currency,s)}};d();f();var Ei=_(Qr()),gD=_(Zs());var nh=class extends Ca{async sign({address:e,signParams:t,signFunc:n,mpcSignFunc:a}){let s=this.getMpcSignParams(e),{childPublicKey:i}=await(0,Ei.getMPCAddress)([0,gD.Currency.ATOM,s.deriveIndex],s.share,this.currency,this.cosmosPrefix),o={data:{...t,publicKey:i}};if(t.fake){delete t.fake;let l=await(0,Ei.getRandomPrivateKey)(this.currency),u=await n(this.currency,{privateKey:l,data:t});return Promise.resolve(u)}let c=await a({currency:this.currency,txParams:o,baseChain:this.baseChain,...s});return Promise.resolve(c)}async signTransaction(e,t){return await this.sign({address:e,signParams:t,signFunc:Ei.signTransaction,mpcSignFunc:$a})}async signMessage(e,t){return await this.sign({address:e,signParams:t,signFunc:Ei.signMessage,mpcSignFunc:Aa})}};d();f();d();f();var af={ETH_SIGN:0,PERSONAL_SIGN:1,SIGN_TYPED_DATA_V1:2,SIGN_TYPED_DATA_V3:3,SIGN_TYPED_DATA_V4:4},bD={V1:af.SIGN_TYPED_DATA_V1,V3:af.SIGN_TYPED_DATA_V3,V4:af.SIGN_TYPED_DATA_V4};var ah=class extends Ca{async signTransaction(e,t){let n=this.getMpcSignParams(e);typeof t.type=="string"&&(t.type=Number($e(t.type)));let a={data:t},s=await $a({currency:this.currency,txParams:a,baseChain:this.baseChain,...n});return Promise.resolve(s===void 0?t:s)}async signMessage(e,t){let n=this.getMpcSignParams(e),a={data:{type:af.ETH_SIGN,message:t}},s=await Aa({currency:this.currency,baseChain:this.baseChain,txParams:a,...n});return Promise.resolve(s)}async signPersonalMessage(e,t){let n=this.getMpcSignParams(e),a={data:{type:af.PERSONAL_SIGN,message:t}},s=await Aa({currency:this.currency,baseChain:this.baseChain,txParams:a,...n});return Promise.resolve(s)}async signTypedData(e,t,n={version:"V1"}){let a=this.getMpcSignParams(e),s=bD[n.version]||2,i=JSON.stringify(t),o={data:{type:s,message:i}},c=await Aa({currency:this.currency,baseChain:this.baseChain,txParams:o,...a});return Promise.resolve(c)}async getEncryptionPublicKey(){return""}async decryptMessage(){return""}};var ine=(r=J)=>{let e=vS[r];return e||vS.default},one=(r=J)=>{let e=SS[r];return e||SS.default},yD=async({baseChain:r,privateKey:e,addressType:t,wallet:n,cosmosPrefix:a})=>{if(!r||!e)throw new Error("Can not instantiate SimpleKeyring when chain or private key is empty");let s=ine(r),i=n?.[r]?.wallets?.[0],o=i?[]:[e],c=new s(me({localType:r})?.coinType,r,a);return await c.create(o,t),i&&await c.createByWallet(i),c},CS=({baseChain:r,share2:e,addressType:t,mpcId:n,chainList:a,deriveIndex:s})=>{if(!r||!e)throw new Error("Can not instantiate MpcKeyring when baseChain or share2 is empty");let{ecdsaP2:i,ecdsaShare2:o,ed25519Share2:c}=JSON.parse(e),l=$u(r),u=l===ei.Secp256k1?o:c,h=l===ei.Secp256k1?i:"",b=me({localType:r})?.coinType,v=f8(a).map(L=>L.baseChain),S=dd(a,r),R=v.reduce((L,B)=>(L[B]=nh,L),{}),P={[J]:ah,[pe]:rh,...R,default:Ca},N=P[r]||P.default;return new N({share:u,pShare:h,currency:b,addressType:t,mpcId:n,cosmosPrefix:S,baseChain:r,deriveIndex:s})},xD=async(r,e,t,n="")=>{if(typeof r!="string"||!Ar(e))throw new Error("Can not instantiate HDKeyring when chain or opts is invalid");let a=one(r),s=new a(t,r,n);return await s?.deserialize(e),s},Pi=(r,e=[])=>{if(!Ar(r)||!Array.isArray(e))throw new Error("filterObjectValuesByKeys: illegal params");return e.reduce((t,n)=>(r[n]&&(t[n]=r[n]),t),{})},Mi=()=>{throw new Error("method params need to be legal")},sf=(r=Vr,e=Ml)=>r.reduce((t,n)=>(Vr.includes(n)&&(t[n]=e[n]||de.SEGWIT_TAPROOT),t),{}),ks=r=>sf(r),Ya=r=>sf(r,t8);var SD=$.HD_KEYRING,Bg=class extends ge{constructor(e=[]){super(),this.type=SD,this.walletMap={},this.keyringMap={},this.backupData=[],this.mnemonic="",this.chainList=e}get baseChains(){return Array.from(new Set(st().map(e=>e.baseChain)))}async serialize(){let e=await this.getWallets(),t=e.length;return e.forEach((n,a)=>this._setWallet(n,a)),{mnemonic:this.mnemonic,numberOfAccounts:t,backupData:this.backupData,wallets:e}}async deserialize(e={}){let t=await this._initHdWallet(e);this.walletMap={},this._initMnemonic(t),await this._initKeyringMap(this.baseChains,t),this._initWalletMap(t),this._initBackupData(t)}async getWallets(){let e=Object.entries(this.walletMap).map(([t,{deriveIndex:n,wallet:a,createTime:s,addressType:i,segwitAddressType:o,needSetDefault:c}])=>({walletId:t,deriveIndex:n,wallet:a,createTime:s,addressType:i,segwitAddressType:o,needSetDefault:c}));return e.sort((t,n)=>t.deriveIndex-n.deriveIndex),e}async addWallets({n:e=1}){let t=Object.keys(this.walletMap).length,n=ks(this.baseChains),a=Ya(this.baseChains),s=[];for(let o=0;o<e;o++)s.push(n);await Promise.all(Object.values(this.keyringMap).map(o=>o.addAccounts(e,s)));let i=[];for(let o=0;o<e;o++){let c=Me(),l=Date.now(),u=t+o;this.walletMap[c]={mnemonic:this.mnemonic,wallet:this.keyringMap,deriveIndex:u,createTime:l,addressType:n,segwitAddressType:a,needSetDefault:!0},i.push({walletId:c,createTime:l,deriveIndex:u,wallet:{},addressType:n,segwitAddressType:a,needSetDefault:!0})}return Promise.resolve(i)}async removeWallet(e){let t=await this.getWallets();if(e!==t[t.length-1]?.walletId)throw new Error("MultipleHDKeyring must remove wallet in tail");delete this.walletMap[e]}async updateWalletAddress(e,t=[]){let n=this.walletMap[e];if(!n)throw new Error(`can not get wallet by walletId - ${e}`);let{wallet:a}=n;t.forEach(({baseChain:s,type:i,address:o})=>{let c=a[s];if(c){let l=c.setAccount(o,i);n.addressType={...n.addressType,[s]:l.addressType},n.needSetDefault=!1}})}async setAddressByPublicKey({walletId:e,publicKey:t,address:n,baseChain:a}){let s=this.walletMap[e];if(!s)throw new Error(`can not get wallet by walletId - ${e}`);let{wallet:i}=s,o=i[a];return o?await o.setAddressByPublicKey(t,n):!1}async updateWalletSegwitAddressType(e,t={}){let n=this.walletMap[e];if(!n)throw new Error(`can not get wallet by walletId - ${e}`);n.segwitAddressType=t}async getAccountMap(e){let t=await this._getBaseChainAccountMapByWalletId(e);return this.privateGetChainMapFromBaseChainMap(t)}async getAccountInfo(e){let{accountMap:t,accountsMap:n,publicKeyMap:a}=await this.getBaseChainAccountInfoByWalletId(e);return{accountMap:this.privateGetChainMapFromBaseChainMap(t),accountsMap:n,publicKeyMap:this.privateGetChainMapFromBaseChainMap(a)}}async getWalletAccountMap(){let e=await this._getBaseChainAccountsMap();return Object.entries(this.walletMap).reduce((t,[n,{deriveIndex:a}])=>{let s=this._getBaseChainAccountMap(e,a),i=this.privateGetChainMapFromBaseChainMap(s);return t[n]=i,t},{})}async getPrivateKeyMap(e){let t=await this._getBaseChainAccountMapByWalletId(e),n=await this._getBaseChainPrivateKeyMap(t),a=[pe,En],i=(await Promise.all(a.map(async o=>await this._getBTCPrivateKeyMap(t,o)))).reduce((o,c)=>({...o,...c}),{});return this.privateGetChainMapFromBaseChainMap(n,i)}async getWalletPrivateKeyMap(){let e=await this._getBaseChainAccountsMap(),t=await Promise.all(Object.entries(this.walletMap).map(([,n])=>{let{deriveIndex:a}=n,s=this._getBaseChainAccountMap(e,a);return this._getBaseChainPrivateKeyMap(s)}));return Object.entries(this.walletMap).reduce((n,[a],s)=>(n[a]=this.privateGetChainMapFromBaseChainMap(t[s]),n),{})}getKeyringByWalletIdAndChain(e,t){let{walletMap:n}=this,a=n?.[e]?.wallet?.[t];if(a)return a;throw new Error("Can not find keyring by walletId and chain")}async backup(){return this.backupData=[],!0}async _initHdWallet(e){if(en(e)||!e.mnemonic){let n=wD.default.generateMnemonic(),a=await yS(n),s=[{walletId:Me(),deriveIndex:0,wallet:{},createTime:Date.now(),addressType:ks(this.baseChains),segwitAddressType:Ya(this.baseChains),needSetDefault:!1}];return{mnemonic:n,numberOfAccounts:1,backupData:a,wallets:s,...e}}let t={numberOfAccounts:1,backupData:[],wallets:[],...e};return t.wallets.forEach(n=>{n.addressType||(n.addressType=ks(this.baseChains),n.segwitAddressType=Ya(),n.needSetDefault=!1)}),t}_initMnemonic(e){let{mnemonic:t}=e;this.mnemonic=t}async _initKeyringMap(e,t){let{mnemonic:n,numberOfAccounts:a,wallets:s}=t,i=s.reduce((c,{addressType:l,wallet:u})=>(c.addressTypes.push(l),c.wallets.push(u),c),{addressTypes:[],wallets:[]}),o=await Promise.allSettled(e?.map(async c=>{let l={type:this.type,mnemonic:n,numberOfAccounts:a,wallets:i.wallets,addressTypes:i.addressTypes},u=dd(this.chainList,c),h=d8(this.chainList,c),b=await xD(c,l,h,u);return{baseChain:c,hdKeyring:b}}));this.keyringMap=o?.reduce((c,l)=>{if(l?.status==="fulfilled"){let{baseChain:u,hdKeyring:h}=l?.value||{};u&&h&&(c[u]=h)}return c},{})}_initWalletMap(e){let{mnemonic:t,numberOfAccounts:n,wallets:a}=e;for(let s=0;s<n;s++){let i=a.find(({deriveIndex:v})=>v===s),{walletId:o,createTime:c,addressType:l=ks(this.baseChains),segwitAddressType:u=Ya(this.baseChains),needSetDefault:h=!0}=i||{},b=o||Me(),y=(0,vD.isNil)(c)?Date.now():c;this.walletMap[b]={mnemonic:t,wallet:this.keyringMap,deriveIndex:s,createTime:y,addressType:l,segwitAddressType:u,needSetDefault:h}}}_initBackupData(e){this.backupData=e.backupData}async generateNewBackupData(){let e=await yS(this.mnemonic,this.type);return this.backupData=e,e}async privateGetBaseChainWalletsMap(){let e=Object.entries(this.keyringMap),t=await Promise.all(e.map(([,a])=>a.wallets));return e.reduce((a,[s],i)=>(a[s]=t[i],a),{})}async _getBaseChainAccountsMap(){let e=Object.entries(this.keyringMap),t=await Promise.all(e.map(([,a])=>a.getAccounts()));return e.reduce((a,[s],i)=>(a[s]=t[i],a),{})}async _getBaseChainAccountMapByWalletId(e){let{accountMap:t}=await this.getBaseChainAccountInfoByWalletId(e);return t}privateGetPropMap(e,t,n){return this.baseChains.reduce((a,s)=>{let o=(e[s]||[])[t];return a[s]=o?.[n]||"",a},{})}async getBaseChainAccountInfoByWalletId(e){let t=this.walletMap[e];if(!t)throw new Error(`can not get wallet by walletId - ${e}`);let n=await this._getBaseChainAccountsMap(),a=await this.privateGetBaseChainWalletsMap(),{deriveIndex:s}=t,{accountMap:i,accountsMap:o}=this.getBaseChainAccountMap(n,s),c=this.privateGetPropMap(a,s,"publicKey");return{accountMap:i,accountsMap:o,publicKeyMap:c}}_getBaseChainAccountMap(e,t){let{accountMap:n}=this.getBaseChainAccountMap(e,t);return n}getBaseChainAccountMap(e,t){return this.baseChains.reduce((n,a)=>{let i=(e[a]||[])[t];return n.accountMap[a]=i?.address,Vr.includes(a)&&(n.accountsMap[a]=i?.addressMap),n},{accountMap:{},accountsMap:{}})}privateGetChainMapFromBaseChainMap(e,t={}){return st().reduce((n,{chain:a,baseChain:s})=>(this.baseChains.includes(s)&&(n[a]=e[s]),n),{...t})}async _getBaseChainPrivateKeyMap(e){let t=Object.entries(this.keyringMap),n=await Promise.all(t.map(([s,i])=>{let o=e[s];return i.exportAccount(o)}));return t.reduce((s,[i],o)=>(s[i]=n[o],s),{})}async _getBTCPrivateKeyMap(e,t){let n={...this.baseChainPrivateKeyMap};if(!this.keyringMap[t])return{};let a=this.keyringMap[t],s=e[t],i=a.wallets.find(o=>o.address===s);if(i){let o=i.addressMap;Object.keys(o).forEach(c=>{let l=`${t}_${c}`,u=o[c].privateKey;n[l]=u})}return n}_setWallet(e,t){let n=this.baseChains.reduce((a,s)=>{let i=this.keyringMap[s]?.wallets[t];return i&&(a[s]=i),a},{});e.wallet=n}};Bg.type=SD;var Wg=Bg;d();f();Ge();ae();d();f();ae();Be();var TS=class extends ge{constructor(){super(),this.walletMap={}}serialize(){return{newWalletMap:this.getWallets().reduce((n,a)=>{let{walletId:s}=a;return n[s]=a,n},{})}}deserialize(e){let{newWalletMap:t={}}=e;this.walletMap={},Object.entries(t).forEach(([n,a])=>{this.walletMap[n]={...a}})}addWallets(){throw new Error("you have to override this method")}removeWallet(e){delete this.walletMap[e]}updateWalletAddress(e,t){let n=this.walletMap[e];n&&t.forEach(a=>{let{baseChain:s,type:i}=a,{accountsMap:o}=n,c=o?.[s]?.[i]?.path;c&&(n.hdPathMap[s]=c);let l=o?.[s]?.[i]?.address;l&&(n.addressMap[s]=l),n.addressType??(n.addressType={}),n.addressType[s]=i})}async getPublicKey(e){let{walletMap:t}=this,n=Object.values(t);for(let a=0;a<n.length;a++){let s=n[a],{addressMap:i,accountsMap:o,segwitAddressType:c,addressType:l=c}=s;for(let u in i)if(Object.hasOwnProperty.call(i,u)){let h=i[u];if(e===h||h.toLowerCase()===e.toLowerCase())return o?.[u]?.[l?.[u]]?.publicKey||""}}return""}getWallets(){let e=Object.values(this.walletMap);return e.sort((t,n)=>t.createTime-n.createTime),e}getWalletAccountMap(){return Object.values(this.walletMap).reduce((e,{walletId:t,addressMap:n})=>{let a=this.getChainMapFromBaseChainMap(n);return e[t]=a,e},{})}getAccountMap(e){let t=this.walletMap[e];if(!t)throw new Error(`can not get wallet by walletId - ${e}`);let{addressMap:n}=t,a={...n},s=a[J];return s&&(a[J]=s?.toLocaleLowerCase()),this.getChainMapFromBaseChainMap(a)}getAccountInfo(e){let t=this.getAccountMap(e),{accountsMap:n={}}=this.walletMap[e]||{};return{accountMap:t,accountsMap:n}}getChainMapFromBaseChainMap(e){return st().reduce((t,{chain:n,baseChain:a})=>(typeof e[a]=="string"&&(t[n]=e[a]),t),{})}getKeyringByWalletIdAndChain(){return this}},Ni=TS;var Kg=class extends Ni{constructor(e={}){super(e),this.type=$.KEYSTONE_KEYRING}async addWallets({accountData:e}){let{mainnet:t,index:n,bitcoin:a,addressType:s,hardwareWalletModel:i,hardwareWalletType:o,otherInfo:c={}}=e,{keystoneInfo:l}=c,{deviceId:u,device:h,masterFingerprint:b}=l||{},y=Date.now(),v=Me(),S={[ke]:a,[J]:t},R={[J]:t[s[J]].path,[ke]:a[s[ke]].path},P={[J]:t[s[J]].address,[ke]:a[s[ke]].address},N={index:n,device:h,walletId:v,deviceId:u,createTime:y,hdPathMap:R,addressMap:P,accountsMap:S,hardwareWalletModel:i,hardwareWalletType:o,masterFingerprint:b,addressType:s,segwitAddressType:{[ke]:de.SEGWIT_NESTED_49}};return this.walletMap[v]=N,[N]}};Kg.type=$.KEYSTONE_KEYRING;var _D=Kg;d();f();Ge();ae();ne();var qg=class extends Ni{constructor(e={}){super(e),this.type=$.LEDGER_BRIDGE_KEYRING}async addHareWareWalletChainWithWalletId(e,t,n){let{address:a,path:s}=e,i={};return t===pe&&Kx.forEach(o=>{i[o]=e[o]}),this.walletMap[n]&&(this.walletMap[n].hdPathMap[t]=s,this.walletMap[n].addressMap[t]=a,t===pe&&(this.walletMap[n].accountsMap[t]=i)),this.walletMap[n]}async addWallets({accountData:e,baseChain:t=J}){var l;let n=Me(),a=Date.now(),s={[t]:e.path},i={[t]:e.address},o={};t===pe&&(o[l=pe]??(o[l]={}),Kx.forEach(u=>{o[pe][u]=e[u]}));let c={walletId:n,createTime:a,hdPathMap:s,addressMap:i,accountsMap:o,hardwareWalletModel:e.hardwareWalletModel,hardwareWalletType:e.hardwareWalletType,addressType:{[pe]:de.SEGWIT_NESTED_49},segwitAddressType:{[pe]:de.SEGWIT_NESTED_49}};return this.walletMap[n]=c,[c]}};qg.type=$.LEDGER_BRIDGE_KEYRING;var AD=qg;d();f();Be();var CD=_(te());Ge();var TD=$.MPC_KEYRING,Ug=class extends ge{constructor(e=[]){super(),this.type=TD,this.baseChains=[],this.walletMap={},this.chainList=e}serialize(){return{wallets:this.getWallets()}}getWallets(){let{walletMap:e}=this,t=Object.entries(e).map(([n,a])=>({walletId:n,...a}));return t.sort((n,a)=>n.deriveIndex-a.deriveIndex),t}deserialize(e={}){let{wallets:t=[]}=e;this.baseChains=h0(this.chainList),this.walletMap={},t.forEach(({share2:n,mpcId:a,userInfo:s,walletId:i,createTime:o,addressType:c={},segwitAddressType:l={},needSetDefault:u=!1,deriveIndex:h=0})=>{let{ecdsaP2:b,ecdsaShare2:y,ed25519Share2:v}=JSON.parse(n),S=this.baseChains.reduce((N,M)=>{let L=CS({baseChain:M,share2:n,addressType:c[M],mpcId:a,chainList:this.chainList,deriveIndex:h});return N[M]=L,N},{}),R=i||Me(),P=(0,CD.isNil)(o)?Date.now():o;this.walletMap[R]={wallet:S,deriveIndex:h,createTime:P,addressType:c,segwitAddressType:l,needSetDefault:u,share2:n,mpcId:a,ecdsaP2:b,ecdsaShare2:y,ed25519Share2:v,userInfo:s}})}getMpcId(e){let t=this.walletMap[e];if(!t)throw new Error(`can not get wallet by walletId - ${e}`);let{mpcId:n}=t;return Promise.resolve(n)}async addWallets({n:e=1}){let t=Object.keys(this.walletMap).length,n=sf(Vr,f0),a=Ya(Vr),s=!en(n),{share2:i,mpcId:o,userInfo:c,walletName:l,ecdsaP2:u,ecdsaShare2:h,ed25519Share2:b}=Object.values(this.walletMap)[0],y=[];for(let v=0;v<e;v++){let S=Me(),R=Date.now(),P=t+v,N=this.baseChains.reduce((M,L)=>{let B=CS({baseChain:L,share2:i,addressType:n[L],mpcId:o,chainList:this.chainList,deriveIndex:P});return M[L]=B,M},{});this.walletMap[S]={wallet:N,deriveIndex:P,createTime:R,addressType:n,segwitAddressType:a,needSetDefault:s,share2:i,mpcId:o,ecdsaP2:u,ecdsaShare2:h,ed25519Share2:b,userInfo:c,walletName:l},y.push({walletId:S,createTime:R,deriveIndex:P,wallet:{},addressType:n,segwitAddressType:a,needSetDefault:s,userInfo:c,mpcId:o,index:P})}return Promise.resolve(y)}async getAccountMapWithBaseChains(e,t){let{accountMap:n}=await this.getAccountInfoWithBaseChains(e,t);return n}async getAccountInfoWithBaseChains(e,t){if(!Ar(e))return Mi();let n=Array.isArray(t)?Pi(e,t):e,a=Object.entries(n),s=await Promise.all(a.map(([,c])=>c.getAccounts())),[i,o]=a.reduce((c,[l],u)=>{let h=s[u][0];return c[0][l]=h?.address,Vr.includes(l)&&(c[1][l]=h?.addressMap),c},[{},{}]);return{accountMap:i,accountsMap:o}}async getWalletBaseChainAccountMapWithWalletIds(e,t){if(!Ar(e))return Mi();let n=Array.isArray(t)?Pi(e,t):e,a=Object.entries(n),s=await Promise.all(a.map(([,{wallet:o}])=>this.getAccountMapWithBaseChains(o)));return a.reduce((o,[c],l)=>(o[c]=s[l],o),{})}async getAccountMap(e){let t=this.walletMap[e];if(!t)throw new Error(`can not get wallet by walletId - ${e}`);let{wallet:n}=t,a=await this.getAccountMapWithBaseChains(n);return this.getChainMapFromBaseChainMap(a)}async getAccountInfo(e){let t=this.walletMap[e],{wallet:n}=t,{accountMap:a,accountsMap:s}=await this.getAccountInfoWithBaseChains(n);return{accountMap:this.getChainMapFromBaseChainMap(a),accountsMap:s}}async getWalletAccountMap(){let e=await this.getWalletBaseChainAccountMapWithWalletIds(this.walletMap);return Object.entries(e).reduce((n,[a,s])=>(n[a]=this.getChainMapFromBaseChainMap(s),n),{})}getKeyringByWalletIdAndChain(e,t){let n=this.chainList.find(o=>o.chain===t),{baseChain:a}=n||{},{walletMap:s}=this,i=s?.[e]?.wallet?.[a];if(i)return i;throw new Error("Can not find keyring by walletId and chain")}async removeWallet(e){delete this.walletMap[e]}async updateWalletAddress(e,t=[]){let n=this.walletMap[e];if(!n)throw new Error(`can not get wallet by walletId - ${e}`);let{wallet:a}=n;t.forEach(({baseChain:s,type:i,address:o})=>{let c=a[s];if(c){let l=c.setAccount(o,i);n.addressType={...n.addressType,[s]:l.addressType},n.needSetDefault=!1}})}getChainMapFromBaseChainMap(e){return this.chainList.reduce((t,{chain:n,baseChain:a})=>(e[a]&&(t[n]=e[a]),t),{})}};Ug.type=TD;var ID=Ug;d();f();Ge();ne();var Fg=class extends Ni{constructor(e={}){super(e),this.type=$.ONEKEY_KEYRING}async addWallets({accountData:e}){let{index:t,mainnet:n,bitcoin:a,addressType:s,hardwareWalletModel:i,hardwareWalletType:o,otherInfo:c={}}=e,{onekeyInfo:l}=c,u=Date.now(),h=Me(),b={[_r]:n.path,[pe]:a[s[pe]].path},y={[_r]:n.address,[pe]:a[s[pe]].address},v={[pe]:a},S={index:t,walletId:h,createTime:u,hdPathMap:b,addressMap:y,accountsMap:v,onekeyInfo:l,hardwareWalletModel:i,hardwareWalletType:o,segwitAddressType:{[pe]:de.SEGWIT_NESTED_49}};return this.walletMap[h]=S,[S]}updateOnekeyDeviceId(e){this.getWallets().forEach(n=>{let{onekeyInfo:a}=n;rm(e,a)&&(a.deviceId=e.deviceId)})}};Fg.type=$.ONEKEY_KEYRING;var ED=Fg;d();f();Be();var PD=_(te());ae();Ge();var MD=$.SIMPLE_KEYRING,Hg=class extends ge{constructor(e=[]){super(),this.type=MD,this.baseChains=[],this.walletMap={},this.privateKeys=[],this.chainList=e}serialize(){let{walletMap:e}=this,t=Object.entries(e).map(([n,{privateKey:a,createTime:s,addressType:i,segwitAddressType:o,needSetDefault:c,wallet:l,addressMap:u}])=>({walletId:n,privateKey:a,createTime:s,addressType:i,segwitAddressType:o,needSetDefault:c,wallet:l,addressMap:u}));return t.forEach(n=>this.privateSetWallet(n)),Promise.resolve({wallets:t,baseChains:this.baseChains})}async deserialize(e={}){let{wallets:t=[],baseChains:n=[]}=e;this.baseChains=n,this.walletMap={},await Promise.allSettled(t.map(async({privateKey:a,walletId:s,createTime:i,addressType:o={},segwitAddressType:c={},needSetDefault:l=!1,wallet:u})=>{let b=(await Promise.allSettled(n.map(async S=>{Vr.includes(S)&&!o[S]&&(o[S]=de.LEGACY);let R=dd(this.chainList,S),P=await yD({baseChain:S,privateKey:a,addressType:o[S],wallet:u,cosmosPrefix:R});return{baseChain:S,keyring:P}})))?.reduce((S,R)=>{if(R?.status==="fulfilled"){let{baseChain:P,keyring:N}=R?.value||{};P&&N&&(S[P]=N)}return S},{}),y=s||Me(),v=(0,PD.isNil)(i)?Date.now():i;this.walletMap[y]={privateKey:a,wallet:b,createTime:v,addressType:o,segwitAddressType:c,needSetDefault:l},this.privateKeys.push(a)}))}getWallets(){let{walletMap:e}=this,t=Object.entries(e).map(([n,{createTime:a,addressType:s,segwitAddressType:i,needSetDefault:o}])=>({walletId:n,createTime:a,addressType:s,segwitAddressType:i,needSetDefault:o}));return t.sort((n,a)=>n.createTime-a.createTime),Promise.resolve(t)}addWallets(){return Promise.reject(new Error("Not supported addWallets method on Multiple Simple Keyring"))}async getAccountMapWithBaseChains(e,t){let{accountMap:n}=await this.getAccountInfoWithBaseChains(e,t);return n}async getAccountInfoWithBaseChains(e,t){if(!Ar(e))return Mi();let n=Array.isArray(t)?Pi(e,t):e,a=Object.entries(n),s=await Promise.all(a.map(([,u])=>u.getAccounts())),i=await Promise.all(a.map(([,u])=>u.wallets)),[o,c,l]=a.reduce((u,[h],b)=>{let y=s[b][0];return u[0][h]=y?.address,Vr.includes(h)&&(u[1][h]=y?.addressMap),u[2][h]=i?.[b]?.[0]?.publicKey,u},[{},{},{}]);return{accountMap:o,accountsMap:c,publicKeyMap:l}}async getWalletBaseChainAccountMapWithWalletIds(e,t){if(!Ar(e))return Mi();let n=Array.isArray(t)?Pi(e,t):e,a=Object.entries(n),s=await Promise.all(a.map(([,{wallet:o}])=>this.getAccountMapWithBaseChains(o)));return a.reduce((o,[c],l)=>(o[c]=s[l],o),{})}async getAccountMap(e){let t=this.walletMap[e];if(!t)throw new Error(`can not get wallet by walletId - ${e}`);let{wallet:n}=t,a=await this.getAccountMapWithBaseChains(n);return this.privateGetChainMapFromBaseChainMap(a)}async getAccountInfo(e){let t=this.walletMap[e],{wallet:n}=t,{accountMap:a,accountsMap:s,publicKeyMap:i}=await this.getAccountInfoWithBaseChains(n);return{accountMap:this.privateGetChainMapFromBaseChainMap(a),accountsMap:s,publicKeyMap:i}}async getWalletAccountMap(){let e=await this.getWalletBaseChainAccountMapWithWalletIds(this.walletMap);return Object.entries(e).reduce((n,[a,s])=>(n[a]=this.privateGetChainMapFromBaseChainMap(s),n),{})}async getPrivateKeyMapWithBaseChains(e,t,n){if(!Ar(e)||!Ar(t))return Mi();let a=Array.isArray(n)?Pi(e,n):e,s=Object.entries(a),i=await Promise.all(s.map(([c,l])=>{let u=t[c];return l.exportAccount(u)}));return s.reduce((c,[l],u)=>(c[l]=i[u],c),{})}async getWalletBaseChainPrivateKeyMapWithWalletIds(e,t,n){if(!Ar(e)||!Ar(t))return Mi();let a=Array.isArray(n)?Pi(e,n):e,s=Object.entries(a),i=await Promise.all(s.map(([c,{wallet:l}])=>{let u=t[c];return this.getPrivateKeyMapWithBaseChains(l,u)}));return s.reduce((c,[l],u)=>(c[l]=i[u],c),{})}async getPrivateKeyMap(e){let t=this.walletMap[e];if(!t)throw new Error(`can not get wallet by walletId - ${e}`);let{wallet:n}=t,a=await this.getAccountMapWithBaseChains(n),s=await this.getPrivateKeyMapWithBaseChains(n,a);return this.privateGetChainMapFromBaseChainMap(s)}async getWalletPrivateKeyMap(){let{walletMap:e}=this,t=await this.getWalletAccountMap(),n=await this.getWalletBaseChainPrivateKeyMapWithWalletIds(e,t);return Object.entries(n).reduce((s,[i,o])=>(s[i]=this.privateGetChainMapFromBaseChainMap(o),s),{})}getKeyringByWalletIdAndChain(e,t){let n=me({chain:t}),{baseChain:a}=n||{},{walletMap:s}=this,i=s?.[e]?.wallet?.[a];if(i)return i;throw new Error("Can not find keyring by walletId and chain")}async removeWallet(e){delete this.walletMap[e]}async updateWalletAddress(e,t=[]){let n=this.walletMap[e];if(!n)throw new Error(`can not get wallet by walletId - ${e}`);let{wallet:a}=n;t.forEach(({baseChain:s,type:i,address:o})=>{let c=a[s];if(c){let l=c.setAccount(o,i);n.addressType={...n.addressType,[s]:l.addressType},n.needSetDefault=!1}})}async setAddressByPublicKey({walletId:e,publicKey:t,address:n,baseChain:a}){let s=this.walletMap[e];if(!s)throw new Error(`can not get wallet by walletId - ${e}`);let{wallet:i}=s,o=i[a];return o?await o.setAddressByPublicKey(t,n):!1}privateGetChainMapFromBaseChainMap(e){return st().reduce((t,{chain:n,baseChain:a})=>(typeof e[a]=="string"&&(t[n]=e[a]),t),{})}privateSetWallet(e){let t=this.baseChains.reduce((n,a)=>{let s=e?.wallet?.[a];return s&&(n[a]=s),n},{});e.wallet=t}};Hg.type=MD;var ND=Hg;d();f();ne();var Gg=class extends Wg{constructor(...e){super(...e),this.type=$.TON_HD_KEYRING}get baseChains(){return[er]}};Gg.type=$.TON_HD_KEYRING;var RD=Gg;d();f();ae();Ge();var zg=class extends Ni{constructor(e={}){super(e),this.type=$.TREZOR_KEYRING}async addWallets({accountData:e}){let t=Me(),n=Date.now(),{index:a,mainnet:s}=e,i={[J]:s.path},o={[J]:s.address},c={index:a,walletId:t,createTime:n,hdPathMap:i,addressMap:o,accountsMap:{},hardwareWalletModel:e.hardwareWalletModel,hardwareWalletType:e.hardwareWalletType};return this.walletMap[t]=c,[c]}};zg.type=$.TREZOR_KEYRING;var kD=zg;d();f();d();f();d();f();var of=_(te()),OD=_(yn()),DD=_(Gn());An();Cn();var LD=0,BD=1,cne=BD,dne=()=>"",fne=async()=>{try{return(await globalThis.platform.getPlatformInfo()).os}catch{return}},lne=async()=>{try{return await OD.default.runtime.id}catch{return}},une=async()=>{try{return await globalThis.platform.getCpuInfoName()}catch{return}},hne={[LD]:[dne],[BD]:[fne,lne,une]},sh={version:LD,successfulList:[!0]},$o={version:cne,successfulList:[]},ih=async r=>{let{version:e,successfulList:t}=r,n=hne[e],a=await Promise.all(n.map(u=>u())),s="",i=[],{data:o}=await xe.get("data"),c=(0,of.get)(o,"PreferencesController.selectedWallet","");a.forEach((u,h)=>{if((0,of.isUndefined)(t[h]))(0,of.isUndefined)(u)?i[h]=!1:(i[h]=!0,s+=u);else if(t[h])if(!(0,of.isUndefined)(u))s+=u,i[h]=t[h];else throw Ae.captureEvent({tags:{walletId:c},message:"BIZ_ERROR_randomPassword",contexts:{report:{info:JSON.stringify({version:e,index:h})}},exception:{values:[{type:"BIZ_ERROR_randomPassword",value:c}]},level:"error"}),new Error("-get info error-");else i[h]=t[h]});let l=(0,DD.sha256)(p.Buffer.from(s)).toString("hex");return{randomPassword:s===""?s:l,randomPasswordParams:{version:e,successfulList:i}}};var KD="jwk",jg="AES-GCM",IS="utf-8",qD={algorithm:"PBKDF2",params:{iterations:1e4,hash:"SHA-256",randomPasswordParams:sh}},UD={algorithm:"PBKDF2",params:{iterations:9e5,hash:"SHA-256",randomPasswordParams:$o}};function pne(r=32){let e=new Uint8Array(r);return globalThis.crypto.getRandomValues(e),btoa(String.fromCharCode.apply(null,e))}async function cf(r,e,t=!1,n=qD){let a=p.Buffer.from(r,IS),s=p.Buffer.from(e,"base64"),i=await globalThis.crypto.subtle.importKey("raw",a,{name:"PBKDF2"},!1,["deriveBits","deriveKey"]);return{key:await globalThis.crypto.subtle.deriveKey({name:"PBKDF2",salt:s,iterations:n.params.iterations,hash:n.params.hash},i,{name:jg,length:256},t,["encrypt","decrypt"]),derivationOptions:n}}function FD(r){return r.key}async function HD(r){return JSON.stringify({key:await globalThis.crypto.subtle.exportKey(KD,r.key),derivationOptions:r.derivationOptions})}async function ES(r,e){let t=JSON.stringify(e),n=p.Buffer.from(t,IS),a=globalThis.crypto.getRandomValues(new Uint8Array(16)),s=FD(r),i=await globalThis.crypto.subtle.encrypt({name:jg,iv:a},s,n),o=new Uint8Array(i),c=p.Buffer.from(a).toString("base64"),u={data:p.Buffer.from(o).toString("base64"),iv:c};return u.keyMetadata=r.derivationOptions,u}async function mne(r,e,t){let n=await ES(e,r);return n.salt=t,JSON.stringify(n)}async function GD(r,e,t){let n=t?.salt??pne(),a=t?.keyDerivationOptions??UD,s=t?.enableRandom??!0,i="",o={...a};if(s){let h=await ih($o);o.params.randomPasswordParams=h.randomPasswordParams,i=h.randomPassword}else o.params.randomPasswordParams=sh;let c=await cf(r+i,n,!0,o),l=await HD(c);return{vault:await mne(e,c,n),exportedKeyString:l}}async function gne(r,e){let t=p.Buffer.from(e.data,"base64"),n=p.Buffer.from(e.iv,"base64"),a=FD(r),s;try{let i=await crypto.subtle.decrypt({name:jg,iv:n},a,t),o=new Uint8Array(i),c=p.Buffer.from(o).toString(IS);s=JSON.parse(c)}catch{throw new Error("Incorrect password")}return s}async function PS(r,e,t){let n=JSON.parse(e),{salt:a,keyMetadata:s}=n,i;if(t?.encryptionKey)i=t?.encryptionKey;else{let c=t?.enableRandom??!0,l="";c&&(l=(await ih(s.params.randomPasswordParams)).randomPassword),i=await cf(r+l,a,!1,s)}return await gne(i,n)}async function WD(r,e,t){let n=await ih($o),a={...t};return a.params.randomPasswordParams=n.randomPasswordParams,await cf(r+n.randomPassword,e,!0,a)}async function zD(r,e,t){let n=JSON.parse(e),{salt:a,keyMetadata:s}=n,i,o,c=t?.keyDerivationOptions??UD;if(s){let h=s.params.randomPasswordParams||sh,b=await ih(h),y=await cf(r+b.randomPassword,a,!0,s),v=t?.enableRandom??!0;if(i=y,v)h?.version!==$o.version?o=await WD(r,a,c):o=y;else{let S={...c};S.params.randomPasswordParams=sh,o=await cf(r,a,!0,S)}}else i=await cf(r,a,!0,qD),o=await WD(r,a,c);let l=await HD(o),u=await PS(r,e,{encryptionKey:i});return{exportedKeyString:l,vault:u,salt:a}}async function jD(r){let e=JSON.parse(r);return{key:await globalThis.crypto.subtle.importKey(KD,e.key,jg,!0,["encrypt","decrypt"]),derivationOptions:e.derivationOptions}}var bne=r=>async(e,t,n)=>GD(e,t,{salt:n?.salt,keyDerivationOptions:{algorithm:"PBKDF2",params:r},enableRandom:n?.enableRandom}),yne=r=>async(e,t,n)=>zD(e,t,{keyDerivationOptions:{algorithm:"PBKDF2",params:r},enableRandom:n?.enableRandom}),VD=r=>({encryptWithKey:ES,encryptWithDetail:bne(r),decrypt:PS,decryptWithDetail:yne(r),importKey:jD});d();f();d();f();var YD=_(Gn());ae();Ge();var MS=_(te());ne();d();f();var $D=r=>`m/44'/60'/0'/0/${r}`;var xne=r=>{if(!Array.isArray(r))return r;let e=r.map(n=>({privateKey:n,walletId:"",createTime:0}));return{baseChains:[J],wallets:e}},wne=r=>{if(Array.isArray(r.wallets))return r;let{numberOfAccounts:e,mnemonic:t}=r,n=[];for(let a=0;a<e;a++)n.push({createTime:0,deriveIndex:a});return{mnemonic:t,numberOfAccounts:e,backupData:[],wallets:n}},vne=r=>{if(r.wallets||r.newWalletMap)return r;let{paths:e={},accounts:t=[]}=r,n=t.reduce((a,s)=>{let i=e[s],o=Me();return a[i]={walletId:o,createTime:0},a},{});return{baseChains:[J],wallets:n,optsMap:{[J]:r}}},Sne=r=>{if(r.newWalletMap)return r;let{wallets:e,optsMap:t}=r,{accounts:n,paths:a}=t[J],s=n.reduce((i,o)=>{let c=a[o],{walletId:l,createTime:u}=e[`${c}`],h=$D(c);return i[l]={walletId:l,createTime:u,addressMap:{[J]:o},hdPathMap:{[J]:h},accountsMap:{},hardwareWalletModel:$.TREZOR_KEYRING,hardwareWalletType:$.TREZOR_KEYRING},i},{});return{...r,newWalletMap:s}},_ne=r=>{if(r.wallets||r.newWalletMap)return r;let{accounts:e=[],accountDetails:t={}}=r,n=e.reduce((a,s)=>{let i=t[(0,YD.toChecksumAddress)(s)],{hdPath:o}=i,c=Me();return a[o]={walletId:c,createTime:0},a},{});return{baseChains:[J],wallets:n,optsMap:{[J]:r}}},Ane=r=>{if(r.newWalletMap)return r;let{wallets:e,optsMap:t}=r,{accounts:n,accountDetails:a}=t[J],s=n.reduce((i,o)=>{let{hdPath:c}=a[o],{walletId:l,createTime:u}=e[c];return i[l]={walletId:l,createTime:u,addressMap:{[J]:o},hdPathMap:{[J]:c},accountsMap:{},hardwareWalletModel:$.LEDGER_BRIDGE_KEYRING,hardwareWalletType:$.LEDGER_BRIDGE_KEYRING},i},{});return{...r,newWalletMap:s}},Cne=r=>{let e=r.newWalletMap||{},t=(n,a)=>a.find(s=>s?.addressType===h9[n])?.address||"";return Object.values(e).forEach(n=>{let s=n?.accountsMap?.[pe]||{};Object.entries(s).forEach(([c,l])=>{(0,MS.isArray)(l?.address)&&(l.address=t(c,l.address))});let i=n?.addressMap,o=n?.segwitAddressType[pe]||de.SEGWIT_NESTED_49;(0,MS.isArray)(i[pe])&&(i[pe]=t(o,i[pe]))}),r},JD=r=>{let{type:e,data:t}=r;if(e===$.SIMPLE_KEYRING)return xne(t);if(e===$.HD_KEYRING)return wne(t);if(e===$.TREZOR_KEYRING){let n=vne(t);return Sne(n)}if(e===$.LEDGER_BRIDGE_KEYRING){let n=_ne(t);return Ane(n)}return pd(e)?Cne(t):t};d();f();var Tne=()=>{let r=new Uint32Array(1);return globalThis.crypto.getRandomValues(r),r[0]/4294967295},NS=(r,e)=>r+Math.floor(Tne()*(e-r+1));var XD=[ND,Wg,kD,ED,AD,_D,ID,RD],DS=class extends ge{constructor(e){super();let t=e.initState||{},n={excludeChainCache:[],enableRandom:!0,...t};this.keyringTypes=e.keyringTypes?XD.concat(e.keyringTypes):XD,this.store=new RS.ObservableStore(n),this.memStore=new RS.ObservableStore({isUnlocked:!1,keyringTypes:this.keyringTypes.map(a=>a.type),keyrings:[],wallets:[],enableRandom:t?.enableRandom??!0}),this.chainController=e.chainController,this.setMpcAction=e.setMpcAction,this.patchVaultWithPreferencesControllerWallets=e.patchVaultWithPreferencesControllerWallets,this.setEncryptor(),this.keyrings=[],this.encryptionKey="",this.encryptionSalt="",this.mutex=new ZD.Mutex}fullUpdate(){return this.emit("update",this.memStore.getState()),this.memStore.getState()}getRandomPBKDF2Params(){let e=NS(5e5,9e5),t="";return e0(e,6e5)?t="SHA-512":t0(e,7e5)?t="SHA-256":t=NS(0,1)===0?"SHA-256":"SHA-512",{hash:t,iterations:e,randomPasswordParams:$o}}setEncryptor(){let e,t=this.store.getState()?.vault;if(!t)e=this.getRandomPBKDF2Params();else{let n=JSON.parse(t).keyMetadata;n?.params?e=n.params:e=this.getRandomPBKDF2Params()}this.encryptor=VD(e)}resetVault(){this.store.updateState({vault:""})}async getPassword(){return this.passwordEncrypted?(await this.encryptor.decrypt("password",this.passwordEncrypted,{enableRandom:!1})).password:null}async setEncryptPassword(e){if(e){let t=await this.encryptor.encryptWithDetail("password",{password:e},{enableRandom:!1});this.passwordEncrypted=t.vault}else this.passwordEncrypted=e}async setLocked(e=!1){let t=await this.mutex.acquire();try{return await this.setEncryptPassword(null),this.memStore.updateState({isUnlocked:!1}),this.keyrings=[],this.encryptionKey="",this.encryptionSalt="",await this.privateUpdateMemStoreKeyrings(),this.emit("lock",e),this.fullUpdate()}finally{t()}}submitPassword(e){return this.unlockKeyrings(e)}async verifyPassword(e){let t=this.store.getState().vault;if(!t)throw new Error("Cannot unlock without a previous vault.");await this.encryptor.decrypt(e,t)}async addNewKeyring(e,t){this.checkForDuplicate(e,t);let n=st(),a=this.getKeyringClassForType(e),s=new a(n);return await s.deserialize(t),this.keyrings.push(s),this.passwordEncrypted&&(await this.persistAllKeyrings(),await this.privateUpdateMemStoreKeyrings(),await this.fullUpdate()),s}async removeEmptyMultipleKeyrings(){let e=[];await Promise.all(this.keyrings.map(async t=>{(await t.getWallets()).length>0&&e.push(t)})),this.keyrings=e}checkPrivateKeyIsImported(e){let t=this.keyrings.filter(s=>s.type===$.SIMPLE_KEYRING),n=e.wallets[0].privateKey.toLowerCase();if(t.some(s=>s.privateKeys.some(o=>o.toLowerCase()===n)&&(0,Vg.isEqual)(e.baseChains,s.baseChains)))throw new Error(Q5);return!1}checkMnemonicIsImported(e){let t=this.keyrings.filter(s=>s.type===$.HD_KEYRING||s.type===$.TON_HD_KEYRING),{mnemonic:n}=e;if(t.some(s=>s.mnemonic===n))throw new Error(tT);return!1}checkForDuplicate(e,t){return e===$.SIMPLE_KEYRING?this.checkPrivateKeyIsImported(t):e===$.HD_KEYRING||e===$.TON_HD_KEYRING?this.checkMnemonicIsImported(t):!1}checkForWalletQuantity(){let{wallets:e}=this.memStore.getState();if(e.length>=500)throw new Error(Z9)}addNewAccount(e){return this.patchAddAccounts(e).then(t=>{t.forEach(n=>{this.emit("newAccount",n)})}).then(this.persistAllKeyrings.bind(this)).then(this.privateUpdateMemStoreKeyrings.bind(this)).then(this.fullUpdate.bind(this))}async getPublicKey(e,t,n){let a="";try{let s;return n?s=await this.getKeyringByWalletId(n,t):s=await this.getKeyringForAccount(e,t),a=await s?.getPublicKey(e)||"",a}catch{return a}}async getCompressedPublicKey(e,t=ke){let n="";try{return n=(await this.getKeyringForAccount(e,t))?.getCompressedPublicKey(e)||"",n}catch{return n}}async bulkGetPublicKey(e){return Promise.all(e.map(({address:t,chain:n})=>this.getPublicKey(t,n).then(a=>({address:t,chain:n,publicKey:a}))))}async signTransaction(e,t,n=J,a,s){let i=n===J?(0,Ja.normalize)(t):t,o=a?this.getKeyringByWalletId(a,n):this.getKeyringForAccount(i,n);try{return await o.then(l=>l.signTransaction(i,e,s))}catch{throw new Error(gs)}}signInscribe(e,t,n){return this.getKeyringByWalletId(n,ke).then(s=>s.signInscribe(t,e))}signPsbt(e,t,n,a={},s={}){let i=a.localType||ke,o=a?.isPsbts||!1;return this.getKeyringByWalletId(n,i).then(l=>l.signPsbt(t,e,s,o)).catch(l=>{throw new Error(l)})}splitUtxo(e,t,n){return this.getKeyringByWalletId(n,ke).then(s=>s.splitUtxo(t,e))}getTransactionBodyForSimulate(e,t,n){return this.getKeyringByWalletId(n,er).then(s=>s.getTransactionBodyForSimulate(t,e))}signTonProof(e,t,n){return this.getKeyringByWalletId(n,er).then(s=>{let i={timestamp:Math.round(Date.now()/1e3),...e.proof||{}},o={walletAddress:t,tonProofItem:"ton-proof-item-v2/",messageAction:"ton-connect",messageSalt:"ffff",...e,proof:i};return s.signTonProof(t,o)})}simulateMultiTransaction(e,t,n){return this.getKeyringByWalletId(t,er).then(s=>s.simulateMultiTransaction(e,n))}signMultiTransaction(e,t,n){return this.getKeyringByWalletId(t,er).then(s=>s.signMultiTransaction(e,n))}async getSignKeyring(e,t){let n=t===J?(0,Ja.normalize)(e):e;return await this.getKeyringForAccount(n,t)}async signCommonMessage(e,t,n){return(await this.getKeyringForAccount(e,n)).signMessage(e,t)}signMessage(e,t={},n=J,a){let s=n===J?(0,Ja.normalize)(e.from):e.from;return(a?this.getKeyringByWalletId(a,n):this.getKeyringForAccount(s,n)).then(o=>o.signMessage(s,e.data,t))}signPersonalMessage(e,t={},n=J,a){let s=n===J?(0,Ja.normalize)(e.from):e.from;return(a?this.getKeyringByWalletId(a,n):this.getKeyringForAccount(s,n)).then(o=>o.signPersonalMessage(s,e.data,t))}signMessageSilent(e,t,n){switch(t){case J:return this.signPersonalMessage(e,{},t,n);case ke:return this.signMessage(e,{type:s8},t,n);case us:return this.signCommonMessage(e.from,`APTOS
message: ${e.data}
nonce: ${e.nonce}`,t);case Pn:return this.signCommonMessage(e.from,OS.default.encode(new TextEncoder().encode(e.data)),t).then(a=>{let s=OS.default.decode(a);return Array.prototype.map.call(s,o=>`00${o.toString(16)}`.slice(-2)).join("")});case jp:return this.signCommonMessage(e.from,Uint8Array.from(e.data.split("").map(a=>a.charCodeAt(0))),t);default:return this.signMessage(e,{},t,n)}}getEncryptionPublicKey(e,t={}){let n=(0,Ja.normalize)(e);return this.getKeyringForAccount(n).then(a=>a.getEncryptionPublicKey(n,t))}decryptMessage(e,t={}){let n=(0,Ja.normalize)(e.from);return this.getKeyringForAccount(n).then(a=>a.decryptMessage(n,e.data,t))}signTypedMessage(e,t={version:"V1"},n=J,a){let s=n===J?(0,Ja.normalize)(e.from):e.from;return(a?this.getKeyringByWalletId(a,n):this.getKeyringForAccount(s,n)).then(o=>o.signTypedData(s,e.data,t))}async persistAllKeyrings(e={}){let t=this.encryptionKey,n=this.encryptionSalt;if(typeof this.passwordEncrypted!="string")return Promise.reject(new Error("KeyringController - password is not a string"));let a=await Promise.all(this.keyrings.map(o=>Promise.all([o.type,o.serialize()]).then(c=>({type:c[0],data:c[1]})))),s,i;if(t){let o=await this.encryptor.importKey(t),c=await this.encryptor.encryptWithKey(o,a);c.salt=n,s=JSON.stringify(c)}else if(this.passwordEncrypted){let o=e?.enableRandom??this.store.getState().enableRandom,{vault:c,exportedKeyString:l}=await this.encryptor.encryptWithDetail(await this.getPassword(),a,{enableRandom:o});s=c,i=l}if(!s)throw new Error("KeyringController - Cannot persist vault without vault information");return this.store.updateState({vault:s}),await this.privateUpdateMemStoreKeyrings(),i&&(this.encryptionKey=i,this.encryptionSalt=JSON.parse(s).salt),!0}async unlockKeyrings(e){let t=await this.mutex.acquire(),n=this.store.getState().vault;try{if(e||(e=await this.getPassword()),!n)throw new Error("Cannot unlock without a previous vault.");if(typeof e!="string"&&!e)throw new Error("Password required to unlock keyrings");let a,s=this.store.getState().enableRandom,i=await this.encryptor.decryptWithDetail(e,n,{enableRandom:s});a=i.vault,await this.setEncryptPassword(e),this.encryptionKey=i.exportedKeyString,this.encryptionSalt=i.salt,a=await this.patchVaultWithPreferencesControllerWallets(a),this.clearCache(a);let o=await Promise.all(a.map(this.privateRestoreKeyring.bind(this)));return this.keyrings=o,await this.privateUpdateMemStoreKeyrings(),await this.persistAllKeyrings(),this.keyrings}finally{t()}}clearCache(e=[]){let t=this.store.getState().excludeChainCache||[];!t.length||(e.forEach(({type:n,data:a})=>{(n===$.HD_KEYRING||n===$.SIMPLE_KEYRING)&&Array.isArray(a.wallets)&&a.wallets.forEach(i=>{i.needSetDefault=!0,t.forEach(o=>{i.addressType=n===$.HD_KEYRING?ks():ks(t),i?.wallet?.[o]&&delete i.wallet[o]})})}),this.store.updateState({excludeChainCache:[]}))}async restoreKeyring(e){let t=await this.privateRestoreKeyring(e);return this.keyrings.push(t),await this.privateUpdateMemStoreKeyrings(),t}async privateRestoreKeyring(e){let{type:t}=e,n=st(),a=this.getKeyringClassForType(t),s=JD(e),i=new a(n);return await i.deserialize(s),i}getKeyringClassForType(e){return this.keyringTypes.find(t=>t.type===e)}getKeyringsByType(e){return this.keyrings.filter(t=>t.type===e)}getKeyringForAccount(e,t=J){let n=t===J?(0,Ja.normalize)(e):e;return Promise.all(this.keyrings.map(a=>Promise.all([a,this.patchGetAccounts(a,t)]))).then(a=>{for(let s=0;s<a.length;s++){let[i,o]=a[s];for(let c=0;c<o.length;c++){let{account:l,walletId:u}=o[c];if((t===J?(0,Ja.normalize)(l):l)===n)return this.getKeyringByWalletIdAndChain(i,u,t)}}throw new Error("No keyring found for the requested account.")})}async getKeyringByWalletId(e,t=J){let n=await this.getMultipleKeyringByWalletId(e);return this.getKeyringByWalletIdAndChain(n,e,t)}async getKeyringTypeByWalletId(e){return(await this.getMultipleKeyringByWalletId(e))?.type}clearKeyrings(){this.keyrings=[],this.memStore.updateState({keyrings:[],wallets:[]}),this.encryptionKey="",this.encryptionSalt=""}async privateUpdateMemStoreKeyrings(){await this.privateUpdateMemStoreWallets()}setUnlocked(){this.memStore.updateState({isUnlocked:!0}),this.emit("unlock")}async createWalletAndRestore(e){let t=await this.mutex.acquire();try{return this.checkForWalletQuantity(),this.clearKeyrings(),await this.setEncryptPassword(e),await this.persistAllKeyrings(),this.createWallet(!1)}finally{t()}}async createWallet(e=!0){let t=e?await this.mutex.acquire():null;try{this.checkForWalletQuantity();let n=await this.addNewKeyring($.HD_KEYRING,{numberOfAccounts:1});if((await n.getWallets()).length===0)throw new Error("create wallet failed");return await this.persistAllKeyrings(),this.setUnlocked(),this.fullUpdate(),this.privateGetNewWallet(n)}finally{t?.()}}async setPassword(e){return typeof e!="string"?Promise.reject(new Error("Password must be text.")):(await this.setEncryptPassword(e),this.setUnlocked(),null)}async modifyPassword(e){let t=await this.mutex.acquire();try{return typeof e!="string"?Promise.reject(new Error("Password must be text.")):(await this.setEncryptPassword(e),this.encryptionKey="",this.encryptionSalt="",this.persistAllKeyrings())}finally{t()}}async switchEnableRandom(e){let t=await this.mutex.acquire();try{let n=this.store.getState().enableRandom;if(e===n)return e;let a=e??!n;return this.encryptionKey="",this.encryptionSalt="",await this.persistAllKeyrings({enableRandom:a}),this.store.updateState({enableRandom:a}),this.memStore.updateState({enableRandom:a}),a}finally{t()}}async importWalletWithPrivateKeyAndRestore(e,t,n){let a=await this.mutex.acquire();try{return this.checkForWalletQuantity(),typeof e!="string"?Promise.reject(new Error("Password must be text.")):Array.isArray(t)?typeof n!="string"?Promise.reject(new Error("privateKey must be text.")):(this.clearKeyrings(),await this.setEncryptPassword(e),await this.persistAllKeyrings(),this.importWalletWithPrivateKey(t,n,!1)):Promise.reject(new Error("chains must be array."))}finally{a()}}async importWalletWithPrivateKey(e,t,n=!0){let a=n?await this.mutex.acquire():null;try{this.checkForWalletQuantity();let s=ks(e),i=Ya(e),o=!en(s),c=await this.addNewKeyring($.SIMPLE_KEYRING,{baseChains:e,wallets:[{privateKey:t,addressType:s,segwitAddressType:i,needSetDefault:o}]});if((await c.getWallets()).length===0)throw new Error("import wallet with privateKey failed");return await this.persistAllKeyrings(),this.setUnlocked(),this.fullUpdate(),this.privateGetNewWallet(c)}finally{a?.()}}async importWalletWithMpcAndRestore(e,t){let n=await this.mutex.acquire();try{return this.checkForWalletQuantity(),typeof e!="string"?Promise.reject(new Error("Password must be text.")):(this.clearKeyrings(),await this.setEncryptPassword(e),await this.persistAllKeyrings(),this.importMpcWallet(t,!1))}finally{n()}}async importMpcWallet(e,t=!0){let n=t?await this.mutex.acquire():null;try{this.checkForWalletQuantity();let a=st(),s=h0(a),i=sf(s,f0),o=Ya(s),c=!en(i),l=await this.addNewKeyring($.MPC_KEYRING,{wallets:[{...e,addressType:i,segwitAddressType:o,needSetDefault:c}]});if((await l.getWallets()).length===0)throw new Error("import mpc wallet failed");return this.setMpcAction("",""),await this.persistAllKeyrings(),this.setUnlocked(),this.fullUpdate(),this.privateGetNewWallet(l)}finally{n?.()}}checkMpcIdIsImported(e){if(this.keyrings.filter(a=>a.type===$.MPC_KEYRING).some(a=>Object.values(a.walletMap).some(s=>s.mpcId===e)))throw new Error(eT);return!1}async getMpcIdByWalletId(e){let t=await this.getMultipleKeyringByWalletId(e);return t.type!==$.MPC_KEYRING?"":await t.getMpcId(e)}async importWalletWithMnemonicAndRestore(e,t,n={}){let a=await this.mutex.acquire();try{return this.checkForWalletQuantity(),typeof e!="string"?Promise.reject(new Error("Password must be text.")):!kS.default.validateMnemonic(t)&&!await cu(t)?Promise.reject(new Error("Seed phrase is invalid.")):(this.clearKeyrings(),await this.setEncryptPassword(e),await this.persistAllKeyrings(),this.importWalletWithMnemonic(t,!1,n))}finally{a()}}async importWalletWithMnemonic(e,t=!0,n={}){let a=t?await this.mutex.acquire():null;try{if(this.checkForWalletQuantity(),!kS.default.validateMnemonic(e)&&!await cu(e))return Promise.reject(new Error("Seed phrase is invalid."));let s=await this.addNewKeyring(n.isTonMnemonic?$.TON_HD_KEYRING:$.HD_KEYRING,{mnemonic:e,numberOfAccounts:1});if((await s.getWallets()).length===0)throw new Error("import wallet with mnemonic failed");return await this.persistAllKeyrings(),this.setUnlocked(),this.fullUpdate(),this.privateGetNewWallet(s)}finally{a?.()}}async addHareWareWalletChainWithWalletId(e,t,n){let a=await this.mutex.acquire();try{await(await this.getMultipleKeyringByWalletId(n)).addHareWareWalletChainWithWalletId(e,t,n),await this.persistAllKeyrings(),await this.privateUpdateMemStoreKeyrings(),await this.fullUpdate()}finally{a()}}async addWalletWithMultipleKeyring({multipleKeyring:e,accountData:t,baseChain:n,lockProgress:a=!0}){let s=a?await this.mutex.acquire():null;try{this.checkForWalletQuantity();let i=await e.addWallets({n:1,accountData:t,baseChain:n});await this.persistAllKeyrings(),await this.privateUpdateMemStoreKeyrings(),await this.fullUpdate();let{index:o,walletId:c,createTime:l,hardwareWalletType:u,hardwareWalletModel:h,hdPathMap:b,masterFingerprint:y,onekeyInfo:v,userInfo:S,mpcId:R}=i[0],{accountMap:P,accountsMap:N}=await e.getAccountInfo(c),M={walletId:c,initialType:e.type,backupData:e.backupData||[],createTime:l,account:P,accountsMap:N};return md(e.type)&&(M.hdPathMap=b,M.hardwareWalletType=u,M.hardwareWalletModel=h),pd(e.type)&&(M.index=o,M.masterFingerprint=y),Eo(e.type)&&(M.index=o,M.onekeyInfo=v),e.type===$.MPC_KEYRING&&(M.userInfo=S,M.mpcId=R,M.index=o),xs(e.type)&&(M.index=o),M}finally{s?.()}}async addNewWallets(e,t=1){let n=await this.mutex.acquire(),a=async()=>await this.addNewWallet(e,!1);try{return(await GO(t,a)).filter(({status:i})=>i==="fulfilled").map(({value:i})=>i)}finally{n()}}async addNewWallet(e,t=!0){let n=await this.getMultipleKeyringByWalletId(e);return this.addWalletWithMultipleKeyring({multipleKeyring:n,lockProgress:t})}async removeWallet(e){let t=await this.mutex.acquire();try{await(await this.getMultipleKeyringByWalletId(e)).removeWallet(e),await this.persistAllKeyrings(),await this.removeEmptyMultipleKeyrings(),await this.privateUpdateMemStoreKeyrings()}finally{t()}}async removeWallets(e){let t=await this.mutex.acquire();try{let n=await Promise.all(this.keyrings.map(s=>Promise.all([s,s.getWallets()]))),a=n.filter(s=>!s[1].find(c=>c.walletId===e));if(a.length===n.length)throw new Error("No multiple keyring found for the requested walletId.");this.keyrings=a.map(s=>s[0]),await this.persistAllKeyrings(),await this.removeEmptyMultipleKeyrings(),await this.privateUpdateMemStoreKeyrings()}finally{t()}}async updateWalletAddress(e,t){let n=await this.mutex.acquire();try{await(await this.getMultipleKeyringByWalletId(e)).updateWalletAddress(e,t),await this.persistAllKeyrings(),await this.privateUpdateMemStoreKeyrings(),await this.fullUpdate()}finally{n()}}async updateWalletSegwitAddressType(e,t){let n=await this.mutex.acquire();try{await(await this.getMultipleKeyringByWalletId(e)).updateWalletSegwitAddressType(e,t),await this.persistAllKeyrings(),await this.privateUpdateMemStoreKeyrings(),await this.fullUpdate()}finally{n()}}async updateAddressMap({walletId:e,publicKey:t,address:n,baseChain:a}){let s=await this.getKeyringByWalletId(e,a);return n?s.updateAddressMap(t,n):!1}async setAddressByPublicKey({walletId:e,publicKey:t,address:n,baseChain:a}){let s=await this.mutex.acquire();try{let o=await(await this.getMultipleKeyringByWalletId(e)).setAddressByPublicKey({walletId:e,publicKey:t,address:n,baseChain:a});return o&&(await this.persistAllKeyrings(),await this.privateUpdateMemStoreKeyrings(),await this.fullUpdate()),o}finally{s()}}getMultipleKeyringByWalletId(e){return Promise.all(this.keyrings.map(t=>Promise.all([t,t.getWallets()]))).then(t=>{let n=t.filter(a=>a[1].find(i=>i.walletId===e));if(n&&n.length>0)return n[0][0];throw new Error("No multiple keyring found for the requested walletId.")})}getKeyringByWalletIdAndChain(e,t,n){return e.getKeyringByWalletIdAndChain(t,n)}getWallets(){let{wallets:e}=this.memStore.getState();return e}getWallet(e){return e?this.getWallets().find(n=>n.walletId===e):{}}getWalletIds(){let{wallets:e}=this.memStore.getState();return e.map(t=>t.walletId)}async getAccountMapByWalletId(e){return await(await this.getMultipleKeyringByWalletId(e)).getAccountMap(e)}async getAccountByWalletIdAndLocalType(e,t){return(await this.getAccountMapByWalletId(e))[t]||""}async getAccountInfoByWalletId(e){let t=await this.getMultipleKeyringByWalletId(e),{accountMap:n,accountsMap:a,publicKeyMap:s}=await t.getAccountInfo(e);return{accountMap:n,accountsMap:a,publicKeyMap:s}}async getPrivateKeyMapByWalletId(e){let t=await this.getMultipleKeyringByWalletId(e);return md(t.type)||t.type===$.MPC_KEYRING?{}:t.getPrivateKeyMap(e)}async getMnemonicByWalletId(e){let t=await this.getMultipleKeyringByWalletId(e);return[$.HD_KEYRING,$.TON_HD_KEYRING].includes(t.type)?t.mnemonic:""}async getBackupData(e){let t=await this.getMultipleKeyringByWalletId(e);return[$.HD_KEYRING,$.TON_HD_KEYRING].includes(t.type)?(await t.generateNewBackupData(),t.backupData):[]}async backupMnemonic(e){let t=await this.mutex.acquire();try{let n=await this.getMultipleKeyringByWalletId(e);return[$.HD_KEYRING,$.TON_HD_KEYRING].includes(n.type)?(n.backup(),await this.persistAllKeyrings(),await this.privateUpdateMemStoreKeyrings(),!0):!1}finally{t()}}async privateUpdateMemStoreWallets(){let e=await Promise.all(this.keyrings.map(async a=>(await a.getWallets()).map(({walletId:i,createTime:o,accountsMap:c={},addressType:l={},addressMap:u={},hdPathMap:h={},segwitAddressType:b={},needSetDefault:y=!1,masterFingerprint:v="",onekeyInfo:S,userInfo:R={},mpcId:P="",deriveIndex:N=0})=>{let M={walletId:i,hdPathMap:h,addressMap:u,initialType:a.type,backupData:a.backupData||[],createTime:o,addressType:l,segwitAddressType:b,needSetDefault:y,accountsMap:c,masterFingerprint:v};return Eo(a.type)&&(M.onekeyInfo=S),a.type===$.MPC_KEYRING&&(M.userInfo=R,M.mpcId=P,M.deriveIndex=N),M}))),n=(0,Vg.flattenDeep)(e).sort((a,s)=>a.createTime-s.createTime);this.memStore.updateState({wallets:n})}async privateGetNewWallet(e){let t=await e.getWallets(),{walletId:n,createTime:a,userInfo:s={},mpcId:i=""}=t[0],{accountMap:o,accountsMap:c}=await e.getAccountInfo(n);return{walletId:n,initialType:e.type,backupData:e.backupData||[],createTime:a,account:o,accountsMap:c,userInfo:s,mpcId:i}}async patchGetAccounts(e,t=J){let{type:n}=e;return n===$.SIMPLE_KEYRING?this.patchGetAccountsFromMultipleSimpleKeyring(e,t):n===$.HD_KEYRING||n===$.TON_HD_KEYRING||md(n)?this.patchGetAccountsFromMultipleHDKeyring(e,t):n===$.MPC_KEYRING?this.patchGetAccountsFromMpcKeyring(e,t):[]}async patchGetAccountsFromMultipleSimpleKeyring(e,t=J){let n=await e.getWalletAccountMap(),a=await e.getWallets();if(a.length===0)return[];let s=a[0],{walletId:i}=s,c=n[i][t];return[{walletId:i,account:c}]}async patchGetAccountsFromMultipleHDKeyring(e,t=J){let n=await e.getWalletAccountMap();return(await e.getWallets()).map(({walletId:i})=>{let o=n[i];return{walletId:i,account:o[t]}})}async patchGetAccountsFromMpcKeyring(e,t=J){let n=await e.getWalletAccountMap(),a=await e.getWallets();return a.length===0?[]:a.map(({walletId:i})=>{let o=n[i];return{walletId:i,account:o[t]}})}async patchAddAccounts(e,t=J){let n=await e.addWallets({n:1}),a=await e.getWalletAccountMap();return n.map(({walletId:s})=>a[s][t])}async patchGetWalletIdByAddress(e,t=J,n){let{wallets:a}=this.memStore.getState(),s=n||a,c=((await Promise.all(s.map(({walletId:l})=>Promise.all([l,this.getAccountMapByWalletId(l)])))).find(l=>e===l[1][t])||[])[0];if(!c)throw new Error(`cant get walletId by address: ${e}`);return c}async updateOnekeyDeviceId(e){let t=await this.mutex.acquire();try{let n=this.getKeyringsByType($.ONEKEY_KEYRING)[0];n&&(n.updateOnekeyDeviceId(e),await this.persistAllKeyrings(),await this.privateUpdateMemStoreKeyrings(),await this.fullUpdate())}finally{t()}}async mpcSignTransaction(e,t,n){let a=await this.getKeyringByWalletId(e,t);return a?a.mpcSignTransaction(n):""}async mpcSignMessage(e,t,n){let a=await this.getKeyringByWalletId(e,t);return a?a.mpcSignMessage(n):""}},QD=DS;d();f();var eL=_(Ne());Be();var tL=_(Qr());Cn();var oh=class extends ge{constructor(e){super();let n=(e?.preferencesController?.getMpcIdentities()||[]).some(s=>s?.walletIdentities?.length>1),a={mpcAction:K0.NO_ACTION,verifyWalletId:"",mpcToken:"",isNeedSyncMpcIndex:n,...e.initState};this.showUserConfirmation=e.showUserConfirmation,this.store=new eL.ObservableStore(a)}setIsNeedSyncMpcIndex(e){this.store.updateState({isNeedSyncMpcIndex:e})}getIsNeedSyncToken(){return this.store.getState().mpcAction!==K0.NO_ACTION}setMpcAction(e,t=""){this.store.updateState({mpcAction:e||K0.NO_ACTION,verifyWalletId:t})}async syncToken({token:e}){this.setToken(e),await this.showUserConfirmation(M0)}getToken(){return this.store.getState().mpcToken}setToken(e){xe.set({mpcToken:e}),this.store.updateState({mpcToken:e})}async accountCheck(e){let t=(0,tL.mpcShakeHands)(e),n=this.getToken();return(await q0({funcType:0,encKey:t,mpcId:e,signType:"1"},{headers:{Authorization:n}}))?.data?.pass}};d();f();d();f();P_();Be();var cK=_(LS()),dK=_(On()),Ib=_(cL()),Tb=_(D$());Tn();ae();Hn();d();f();var cb=_(On()),NB=_(KL()),RB=_(tB()),kB=_(nB()),OB=_(oB()),DB=_(dB()),LB=_(bB()),BB=_(MB()),WB=process.env.ASSETS_BUILD_TYPE==="dev"||process.env.ASSETS_BUILD_TYPE==="daily",fse=WB?{pollingInterval:1e3}:{},lse=()=>WB?[hse()]:[];function db({rpcUrl:r,chainId:e}){let t=(0,NB.default)({rpcUrl:r}),n=(0,LB.default)(t),a=new BB.PollingBlockTracker({...fse,provider:n});return{networkMiddleware:(0,cb.mergeMiddleware)([...lse(),use(e),(0,RB.default)({blockTracker:a}),(0,kB.default)({blockTracker:a}),(0,OB.default)(),(0,DB.default)({blockTracker:a}),t]),blockTracker:a}}function use(r){return(e,t,n,a)=>e.method==="eth_chainId"?(t.result=r,a()):n()}function hse(){return(0,cb.createAsyncMiddleware)(async(r,e,t)=>(r.method==="eth_estimateGas"&&await new Promise(n=>setTimeout(n,2e3)),t()))}d();f();var Cb=_(On()),iK=_(nK());d();f();var aK=_(On());ae();d();f();function sK({getNetworkType:r}){return(0,aK.createAsyncMiddleware)(async(e,t,n)=>{let{method:a,params:s}=e;if(a!=="eth_getTransactionCount"){n();return}let[i,o]=s;if(o!=="pending"){n();return}let c=Mn(r()),{data:l=[]}=await D0({checkTypes:[ud.OVERWRITTEN],coinId:c.coinId,from:i}),u=l.find(h=>h.checkType===ud.OVERWRITTEN);t.result=u?.newNonce})}function v2({version:r,getAccounts:e,processTransaction:t,processEthSignMessage:n,processTypedMessage:a,processTypedMessageV3:s,processTypedMessageV4:i,processPersonalMessage:o,processDecryptMessage:c,processEncryptionPublicKey:l,getNetworkType:u}){return(0,Cb.mergeMiddleware)([(0,Cb.createScaffoldMiddleware)({eth_syncing:!1,web3_clientVersion:`MetaMask/v${r}`}),(0,iK.default)({getAccounts:e,processTransaction:t,processEthSignMessage:n,processTypedMessage:a,processTypedMessageV3:s,processTypedMessageV4:i,processPersonalMessage:o,processDecryptMessage:c,processEncryptionPublicKey:l}),sK({getNetworkType:u})])}var oK=()=>{let r=$p({chain:J});return{chainId:r.realChainIdHex,nickname:r.chainName,rpcPrefs:{},rpcUrl:r.rpcUrl,ticker:r.ticker,type:r.providerType,uniqueId:""}},ac={NETWORK_DID_CHANGE:"networkDidChange",NETWORK_WILL_CHANGE:"networkWillChange"},Sf=class extends Ir{constructor(t,n,a,s,i){super();le(this,"onRemoteConfigChange",F4(()=>{let t=this.getProviderConfig();this.setProviderConfig(t,!1)},150));this.rpcController=n,this.walletConfigController=a,this.unlockListener=s;let o=oK(),c=Tx(t,yo());this.provider=c||{...o},this.network=Il(this.provider.chainId,16),this.networkControllerProviderUpdate=i,this._provider=null,this._blockTracker=null,this._providerProxy=null,this._blockTrackerProxy=null,this._web3Instances={},this.processProviderForce()}initializeProvider(t){this._baseProviderParams=t;let{type:n,rpcUrl:a,chainId:s}=this.getProviderConfig();this._configureProvider({type:n,rpcUrl:a,chainId:s})}getProviderAndBlockTracker(){let t=this._providerProxy,n=this._blockTrackerProxy;return{provider:t,blockTracker:n}}getNetworkState(){return this.network}setNetworkState(t){t!==this.getNetworkState()&&(this.network=t)}getCurrentChainId(){let{type:t,chainId:n}=this.getProviderConfig();return this.getRpcMode()?n:Al(t)?.realChainIdHex||n}async setProviderType(t,n="",a="ETH",s="",i,o={},c=!1,l=""){let{realChainIdHex:u}=Al(t)||{},h=u||i;jr.ok(Ed(h),`Invalid chain ID "${h}": invalid hex string.`),jr.ok(Id(parseInt(h,16)),`Invalid chain ID "${h}": numerical value greater than max safe value.`);let b=this.getProviderConfig();(h!==b.chainId||c)&&await this.setProviderConfig({type:t,rpcUrl:n,chainId:h,ticker:a,nickname:s,rpcPrefs:o,uniqueId:l})}async setProviderConfig(t,n=!0){let a=yo(),s=Tx(t,a);this._switchNetwork(s,n),this.provider=s,await $0({...s,providerType:wn}),this.networkControllerProviderUpdate()}getRpcMode(){let{walletConfig:t}=this.walletConfigController.store.getState(),{isRpcMode:n}=t;return n}getProviderConfig(){return this.provider}updateIsomerCurrentNetwork(t,n){this.notifyAllConnections({method:U.event.ISOMER_NETWORK_CHANGED,params:{providerType:t,currentNetwork:n}})}_switchNetwork(t,n=!0){n&&this.emit(ac.NETWORK_WILL_CHANGE),this._configureProvider(t),n&&this.emit(ac.NETWORK_DID_CHANGE,t.type)}_configureProvider({rpcUrl:t,chainId:n}){this._configureStandardProvider(t,n),this.setNetworkState(Il(n,16))}_configureStandardProvider(t,n){let a=db({rpcUrl:t,chainId:n});this._setNetworkClient(a)}_createProviderAndTracker({networkMiddleware:t,blockTracker:n}){let a=v2(this._baseProviderParams),s=new dK.JsonRpcEngine;return s.push(a),s.push(t),{provider:(0,cK.default)(s),blockTracker:n}}_setNetworkClient({networkMiddleware:t,blockTracker:n}){let{provider:a}=this._createProviderAndTracker({networkMiddleware:t,blockTracker:n});this._setProviderAndBlockTracker({provider:a,blockTracker:n})}_setProviderAndBlockTracker({provider:t,blockTracker:n}){this._providerProxy?this._providerProxy.setTarget(t):this._providerProxy=(0,Ib.createSwappableProxy)(t),this._blockTrackerProxy?(this._blockTrackerProxy.removeAllListeners(),this._blockTrackerProxy.setTarget(n)):this._blockTrackerProxy=(0,Ib.createEventEmitterProxy)(n,{eventFilter:"skipInternal"}),this._provider=t,this._blockTracker=n}getWeb3Provider(){let{chainId:t}=this.getProviderConfig(),n=Wc(t);if(!n||!n.rpcUrl)throw new Error(`can't find provider for chainId is ${t}`);let a=db({rpcUrl:n.rpcUrl,chainId:t}),{provider:s,blockTracker:i}=this._createProviderAndTracker(a),o=this._web3Instances[t];return o?o.setProvider(new Tb.default.providers.HttpProvider(n.rpcUrl)):o=new Tb.default(new Tb.default.providers.HttpProvider(n.rpcUrl)),this._web3Instances[t]=o,{web3:o,web3Provider:s,blockTracker:i}}processProviderForce(){(async()=>(await ft.rpc_networks).liveQuery().subscribe(async(n,a)=>{if(!a){let s=this.getProviderConfig();if(s.type===Cx){let i=n.find(o=>o.uniqueId===s.uniqueId);if(i){let{rpcUrl:o,chainId:c,symbol:l,name:u,uniqueId:h}=i;await this.setProviderType(Cx,o,l,u,c,{},!0,h)}else{let{rpcUrl:o,chainId:c,ticker:l,nickname:u,uniqueId:h}=oK();await this.setProviderType(J,o,l,u,c,{},!0,h)}}}}))()}};d();f();var mK=_(Pr());ne();ur();d();f();async function Bi(r){try{return await(await Promise.resolve(ft.extension_config)).set(r),!0}catch{return!1}}async function _f(r){try{return await(await Promise.resolve(ft.extension_config)).get(r)}catch{return[]}}Wt();d();f();var fK="wallet_requestPermissions",Eb="wallet_",Af="permissionsHistory",S2="permissionsLog",gh="domainMetadata";var _2={limitResponseLength:"limitResponseLength",filterResponse:"filterResponse"},Kr={accountsChanged:"wallet_accountsChanged",identitiesChanged:"identitiesChanged",walletChanged:"walletChanged",unlockStateChanged:"wallet_unlockStateChanged",chainChanged:"wallet_chainChanged",supplyGas:"supplyGas",rpcModeChanged:"rpcModeChanged",clearCookie:"clearCookie"},lK=["wallet_registerOnboarding","wallet_watchAsset"],A2={restricted:"restricted",internal:"internal"},C2=100,uK=["eth_blockNumber","eth_call","eth_chainId","eth_coinbase","eth_decrypt","eth_estimateGas","eth_gasPrice","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getEncryptionPublicKey","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleByBlockHashAndIndex","eth_getUncleByBlockNumberAndIndex","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_getWork","eth_hashrate","eth_mining","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_protocolVersion","eth_sendRawTransaction","eth_sendTransaction","eth_sign","eth_signTypedData","eth_signTypedData_v1","eth_signTypedData_v3","eth_signTypedData_v4","eth_submitHashrate","eth_submitWork","eth_syncing","eth_uninstallFilter","wallet_getProviderState","metamask_watchAsset","net_listening","net_peerCount","net_version","personal_ecRecover","personal_sign","wallet_watchAsset","web3_clientVersion","web3_sha3","eth_feeHistory"];d();f();var hK=_(Pr()),pK=_(Ne());var T2={walletConfigChanged:"WALLETCONFIGCHANGED"},bh=class extends hK.default{constructor({initState:e}){super(),this.store=new pK.ObservableStore(this.getInitState(e))}getInitState(e){return{walletConfig:{currentNetworkUniqueId:e?.walletConfig?.currentNetworkUniqueId||"",hasVersionNoteShown:!1,isRpcMode:e?.walletConfig?.isRpcMode||!1,isLedgerImported:e?.walletConfig?.isLedgerImported||!1,scanedKeyStoneMap:e?.walletConfig?.scanedKeyStoneMap||{},hasShowDisconnectUpgrade:e?.walletConfig?.hasShowDisconnectUpgrade||!1,connectedOnekey:e?.walletConfig?.connectedOnekey||{},hasDangerKeystoneScaned:e?.walletConfig?.hasDangerKeystoneScaned||!1,isApprovalRiskRemindLater:e?.walletConfig?.isApprovalRiskRemindLater||!1}}}setWalletConfig(e,t,n=!0){let a=this.getWalletConfig();if(!n&&a[e]===t)return a;let s={...a,[e]:t};return this.store.updateState({walletConfig:s}),this.emit(T2.walletConfigChanged,e,t),Promise.resolve(s)}getWalletConfig(){return this.store.getState().walletConfig}setApprovalRiskRemindLater(){this.setWalletConfig("isApprovalRiskRemindLater",!0),setTimeout(()=>{this.setWalletConfig("isApprovalRiskRemindLater",!1)},1e3*60*60*48)}setScanedKeyStone(e){let{masterFingerprint:t}=e,{scanedKeyStoneMap:n}=this.getWalletConfig(),a={...n,[t]:e};this.setWalletConfig("scanedKeyStoneMap",a)}setConnectedOnekey(e){let{connectId:t,firstEvmAddress:n}=e,{connectedOnekey:a}=this.getWalletConfig(),s=tm(t,n),i={...a,[s]:e};this.setWalletConfig("connectedOnekey",i)}};var aie=30*60*1e3;var yh=class extends mK.default{constructor({walletConfigController:e,notifyAllConnections:t,resetToAllNetwork:n}){super(),this.walletConfigController=e,this.resetToAllNetwork=n,e.on(T2.walletConfigChanged,(a,s)=>{a==="isRpcMode"&&t({method:Kr.rpcModeChanged,params:{isRpcMode:s}})}),this.getRemoteTestNets().then(async()=>{await this.tryInitWithNetList()}).catch(a=>{console.log(a)}),setInterval(()=>{this.getRemoteTestNets().then(async()=>{await this.tryInitWithNetList()}).catch(a=>{console.log(a)})},aie)}async tryInitWithNetList(){let e=await qa();if(!e?.length)return;let t=await _f("rpc_info"),n=e.find(a=>nw(a,t));n?await Bi({...n,key:"rpc_info"}):await Bi({...e[0],key:"rpc_info"})}async getRemoteTestNets(){try{let{code:e,data:t}=await zr(ce.getTestNets);if(e===0){let n=await qa({isCustom:!0})||[],a=await qa(),s=[];t.forEach(async(l,u)=>{let{chainId:h}=l;h.startsWith("0x")||(l.chainId=`0x${ws(h)}`,l.chainIdDecimal=h),l.order=u,l.id?l.uniqueId=`${La}-${l.id}`:l.uniqueId=`${La}-${h}`;let b=a?.find(y=>nw(y,l));l.defaultGasForRpc=b?.defaultGasForRpc||{},l.type===Z0.EVM&&s.push(l)}),await Q0(s.concat(n));let{walletConfig:i}=this.walletConfigController.store.getState(),{isRpcMode:o,currentNetworkUniqueId:c}=i;o&&c&&!s.find(l=>l.uniqueId===c)&&this.resetToAllNetwork()}}catch(e){console.log(e)}}};d();f();var gK=_(Ne());var xh=class{constructor(e={}){le(this,"registerOnboarding",async(e,t)=>{if(this.completedOnboarding)return;let n={...this.store.getState().onboardingTabs};(!n[e]||n[e]!==t)&&(n[e]=t,this.store.updateState({onboardingTabs:n}))});let t={onboardingTabs:{}},n={seedPhraseBackedUp:null,...e.initState,...t};this.store=new gK.ObservableStore(n),this.preferencesController=e.preferencesController,this.completedOnboarding=this.preferencesController.store.getState().completedOnboarding,this.preferencesController.store.subscribe(({completedOnboarding:a})=>{a!==this.completedOnboarding&&(this.completedOnboarding=a,a&&this.store.updateState(t))})}setSeedPhraseBackedUp(e){this.store.updateState({seedPhraseBackedUp:e})}};d();f();Be();var bK=_(Ne());Wt();ur();var Pb=_(te());d();f();Wt();ur();var sie={postWalletCreateBatch(r,e){return Pe(ce.postWalletCreateBatch,r,e)},deleteWallet(r,e){return Pe(ce.deleteWallet,r,e)},postWalletSync(r,e){return Pe(ce.postSyncAddresses,r,e)},postSegwitInfo(r,e){return Pe(ce.postSegwitInfo,r,e)},postAccountKeys(r,e){return Pe(ce.commonAccountKeys,r,e)}},Wi=sie;var E2=class extends ge{constructor(e={}){super();let t={needSyncDevIdMap:{},needSyncAccounts:!1,...e.initState};this.store=new bK.ObservableStore(t),this.authController=e.authController,this.walletCreateController=e.walletCreateController,this.keyringController=e.keyringController,this.preferencesController=e.preferencesController,this.updateServerWalletTypeFromBackEnd()}async patchSyncDevId(e){let{needSyncDevIdMap:t}=this.store.getState();if(t[e]){let a={addresses:await this.walletCreateController.getAddressesParams(e),accountId:e},i={headers:this.authController.getSignRequestHeaders({walletId:e})};await Wi.postWalletSync(a,i),delete t[e],this.store.updateState({needSyncDevIdMap:t})}}async patchSyncAccounts(){let{needSyncAccounts:e}=this.store.getState();if(e){let t=this.keyringController.getWalletIds(),n=await Promise.all(t.map(s=>this.keyringController.getAccountMapByWalletId(s))),{keyringIdentities:a}=this.preferencesController.store.getState();t.forEach((s,i)=>{let o=n[i];a.forEach(c=>{let l=c.walletIdentities.find(u=>u.walletId===s);l&&l.account&&Object.keys(l.account).forEach(u=>{l.account[u]=o[u]})})}),this.preferencesController.updateAllKeyringIdentities(a),this.store.updateState({needSyncAccounts:!1})}}addServerWalletTypeForKeyringIdentities(e=[]){let{keyringIdentities:t}=this.preferencesController.store.getState();for(let n=0;n<t.length;n++){let a=t[n],{walletIdentities:s}=a;for(let i=0;i<s.length;i++){let o=s[i],{walletId:c}=o,l=e.find(u=>u?.accountId===c)?.walletType;o.serverWalletType=l}}this.preferencesController.updateAllKeyringIdentities(t)}async updateServerWalletTypeFromBackEnd(){let t=this.preferencesController.getWalletIdentities().reduce((s,i={})=>{let{walletId:o,serverWalletType:c}=i;return(0,Pb.isNil)(c)&&s.push(o),s},[]);if(!t.length)return;let n=(0,Pb.chunk)(t,50),a;try{a=await n.reduce(async(s,i)=>{let o=await s,c={accountIds:i},{data:l=[]}=await Pe(ce.postWalletInfo,c);return Promise.resolve(o.concat(l))},Promise.resolve([]))}catch(s){console.log(s),a=[]}this.addServerWalletTypeForKeyringIdentities(a)}},yK=E2;d();f();var kK=_(Ne()),OK=_(s0()),kb=_(Ce()),DK=_(On()),L2=_(te()),LK=_(Fr());ae();ne();Hn();d();f();var Rb=_(On());d();f();d();f();var xK=(r,e)=>typeof r!="object"||r===null||typeof e!="object"||e===null?!1:Object.keys(e).every(t=>{if(!r.propertyIsEnumerable(t))return!1;let n=e[t],a=r[t];return!(typeof n=="object"&&n!==null?!xK(a,n):a!==n)}),wK=xK;d();f();var Cf=_(Ce());function Mb(r){return Cf.ethErrors.provider.unauthorized({message:r?.message||"Unauthorized to perform action. Try requesting permission first using the `requestPermissions` method.",data:r?.data||void 0})}var Nb=Cf.ethErrors.rpc.invalidRequest,Ws=Cf.ethErrors.rpc.internal;function wh(r){let e=r.methodName?`The method '${r.methodName}' does not exist / is not available.`:null;return Cf.ethErrors.rpc.methodNotFound({data:r.data,message:e})}function vK(r){return Cf.ethErrors.provider.userRejectedRequest({data:r})}function SK(r){let{value:e}=r;return(t,n,a,s)=>wK(t.params,e)?(a(),null):(n.error=Mb({data:t}),s(n.error))}function _K(r){let{value:e}=r;return(t,n,a)=>{a(s=>{Array.isArray(n.result)&&(n.result=e.filter(i=>n.result.includes(i))),s()})}}function AK(r){let{value:e}=r;return(t,n,a)=>{a(s=>{Array.isArray(n.result)&&(n.result=n.result.slice(0,e)),s()})}}function CK(r){let{value:e}=r;return(t,n,a)=>{t.params=[...e],a()}}var P2=class{constructor({method:e,caveats:t,invoker:n}){this["@context"]=["https://github.com/MetaMask/rpc-cap"],this.parentCapability=e,this.id=ko(),this.date=Date.now(),this.invoker=n,t&&(this.caveats=t)}toJSON(){return{"@context":this["@context"],invoker:this.invoker,parentCapability:this.parentCapability,id:this.id,date:this.date,caveats:this.caveats}}toString(){return JSON.stringify(this.toJSON())}},vh=class extends Bo{constructor(e,t){if(super(e,t||{}),this.caveats={requireParams:SK,filterResponse:_K,limitResponseLength:AK,forceParams:CK},this.safeMethods=e.safeMethods||[],this.restrictedMethods=e.restrictedMethods||{},this.methodPrefix=e.methodPrefix||"",this.engine=e.engine||void 0,!e.requestUserApproval)throw new Error("User approval prompt required.");this.requestUserApproval=e.requestUserApproval,this.defaultState={permissionsRequests:[],permissionsDescriptions:Object.keys(this.restrictedMethods).reduce((n,a)=>(n[a]=this.restrictedMethods[a].description,n),{})},this.internalMethods={},this.internalMethods[`${this.methodPrefix}getPermissions`]=this.getPermissionsMiddleware.bind(this),this.internalMethods[`${this.methodPrefix}requestPermissions`]=this.requestPermissionsMiddleware.bind(this),this.initialize()}serialize(){return this.state}createBoundMiddleware(e){return this.providerMiddlewareFunction.bind(this,{origin:e})}createPermissionedEngine(e){let t=new Rb.JsonRpcEngine;return t.push(this.createBoundMiddleware(e)),t}providerMiddlewareFunction(e,t,n,a,s){let i=t.method;if(this.safeMethods.includes(i))return a();if(this.internalMethods[i])return this.internalMethods[i](e,t,n,a,s);if(!this.getMethodKeyFor(i))return n.error=wh({methodName:i,data:t}),s(n.error);let o;try{o=this.getPermission(e.origin,i)}catch(c){return n.error=Ws({data:c}),s(n.error)}if(!o)return n.error=Mb({data:t}),s(n.error);this.executeMethod(e,t,n,a,s)}getMethodKeyFor(e){let t=Object.keys(this.restrictedMethods);if(t.includes(e))return e;let n=t.reduce((i,o)=>{let c=o.match(/(.+)\*$/);return c?Object.assign(Object.assign({},i),{[c[1]]:!0}):i},{}),a=e.split("_"),s="";for(;a.length>0&&!t.includes(s)&&!n[s];)s+=a.shift()+"_";return t.includes(s)?s:n[s]?s+"*":""}executeMethod(e,t,n,a,s){let i=this.getMethodKeyFor(t.method),o=this.getPermission(e.origin,t.method);if(i&&typeof this.restrictedMethods[i].method=="function"){let c=this.createVirtualEngineFor(e);if(o?.caveats&&o.caveats.length>0){let l=new Rb.JsonRpcEngine;return o.caveats.forEach(h=>{let y=this.caveats[h.type],v=y(h);l.push(v)}),l.push((h,b,y,v)=>this.restrictedMethods[i].method(h,b,y,v,c)),l.asMiddleware()(t,n,a,s)}else return this.restrictedMethods[i].method(t,n,a,s,c)}return n.error=wh({methodName:t.method,data:t}),s(n.error)}createVirtualEngineFor(e){let t=new Rb.JsonRpcEngine;return t.push(this.providerMiddlewareFunction.bind(this,e)),this.engine&&t.push(this.engine.asMiddleware()),t.domain=e.origin,t}getPermissionsForDomain(e){let{domains:t={}}=this.state;if(t[e]){let{permissions:n}=t[e];return n}return[]}getPermission(e,t){let n=this.getPermissionsForDomain(e).filter(a=>a.parentCapability===t);if(n.length>0)return n.shift()}getPermissionsRequests(){return this.state.permissionsRequests||[]}removePermissionsRequest(e){let t=this.getPermissionsRequests().filter(n=>n.metadata.id!==e);this.setPermissionsRequests(t)}setPermissionsRequests(e){this.update({permissionsRequests:e})}grantNewPermissions(e,t,n,a,s){if(!e||typeof e!="string")return a.error=Nb(`Invalid domain: '${e}'.`),s(a.error);for(let c in t)if(!this.getMethodKeyFor(c))return a.error=wh({methodName:c}),s(a.error);let i={};for(let c in t){let l=new P2({method:c,invoker:e,caveats:t[c].caveats});if(l.caveats&&!this.validateCaveats(l.caveats))return a.error=Ws({message:"Invalid caveats.",data:l}),s(a.error);i[c]=l}this.addPermissionsFor(e,i);let o=this.getPermissionsForDomain(e)||[];o.resultParams=n,a.result=o,s()}getDomains(){let{domains:e}=this.state;return e||{}}setDomains(e){this.update({domains:e})}getOrCreateDomainSettings(e){let t=this.getDomainSettings(e);return t===void 0?{permissions:[]}:t}getDomainSettings(e){return this.getDomains()[e]}setDomain(e,t){let n=this.getDomains();t.permissions.length>0?n[e]=t:delete n[e],this.setDomains(n)}addPermissionsFor(e,t){let n=this.getOrCreateDomainSettings(e),a=Object.keys(t);n.permissions=n.permissions.filter(s=>!a.includes(s.parentCapability));for(let s in t)n.permissions.push(t[s]);this.setDomain(e,n)}validateCaveats(e){let t={};for(let n of e){if(!this.validateCaveat(n)||n.name&&t[n.name])return!1;n.name&&(t[n.name]=!0)}return!0}validateCaveat(e){return!(!e||typeof e!="object"||Array.isArray(e)||!e.type||typeof e.type!="string"||e.name===""||e.name&&typeof e.name!="string")}getCaveats(e,t){let n=this.getPermission(e,t);return n?.caveats}getCaveat(e,t,n){let a=this.getPermission(e,t);return a?a.caveats&&a.caveats.find(s=>s.name===n):void 0}addCaveatFor(e,t,n){if(!this.validateCaveat(n))throw Ws({message:"Invalid caveat param. Must be a valid caveat object.",data:n});let a=this._getPermissionForCaveat(e,t),s=a.caveats?[...a.caveats,n]:[n];this._validateAndUpdateCaveats(e,t,s,a)}updateCaveatFor(e,t,n,a){if(!n||typeof n!="string")throw Ws({message:"Invalid caveat param. Must specify a string name.",data:n});let s=this._getPermissionForCaveat(e,t),i=s.caveats&&s.caveats.find(c=>c.name===n),o=[];if(s.caveats&&s.caveats.forEach(c=>{c.name!==n&&o.push(c)}),!i||!s.caveats)throw Ws({message:"No such caveat exists for the relevant permission.",data:n});if(typeof i.value!=typeof a)throw Ws({message:"New caveat value is of different type than original.",data:{caveat:i,newValue:a}});i.value=a,o.push(i),this._validateAndUpdateCaveats(e,t,o,s)}_getPermissionForCaveat(e,t){let n=this.getPermission(e,t);if(!n)throw Ws({message:"No such permission exists for the given domain.",data:{domain:e,method:t}});return n}_validateAndUpdateCaveats(e,t,n,a){if(!this.validateCaveats(n))throw Ws({message:"The new caveats are jointly invalid.",data:n});let s={};a.caveats=n,s[t]=a,this.addPermissionsFor(e,s)}removePermissionsFor(e,t){let n=this.getDomainSettings(e);!n||(n.permissions=n.permissions.filter(a=>{for(let s of t)if(s.parentCapability===a.parentCapability)return!1;return!0}),this.setDomain(e,n))}clearDomains(){this.setDomains({})}validatePermissionsRequest(e){if(!e||!Array.isArray(e.params)||typeof e.params[0]!="object"||Array.isArray(e.params[0]))throw Nb({data:e});let t=e.params[0];for(let n in t){if(t[n].parentCapability!==void 0&&n!==t[n].parentCapability)throw Nb({data:e});if(!this.getMethodKeyFor(n))throw wh({methodName:n,data:e})}}getPermissionsMiddleware(e,t,n,a,s){let i=this.getPermissionsForDomain(e.origin);n.result=i,s()}requestPermissionsMiddleware(e,t,n,a,s){try{this.validatePermissionsRequest(t)}catch(u){return n.error=u,s(n.error)}let i=typeof t.id=="number"||t.id?t.id.toString():ko(),o=t.params[0],c=this.getPermissionsRequests(),l={metadata:{origin:e.origin,id:i},permissions:o};c.push(l),this.setPermissionsRequests(c),this.requestUserApproval(l).then(({permissions:u,resultParams:h})=>{if(Object.keys(u).length===0)return n.error=vK(t),s(n.error);this.grantNewPermissions(e.origin,u,h,n,s)}).catch(u=>(n.error=u,s(u))).finally(()=>{this.removePermissionsRequest(l.metadata.id)})}};d();f();var M2=_(U4());var TK=_(_$());function iie(r,e){return r.reduce((t,n)=>({...t,[n]:e}),{})}var Sh=class{constructor({restrictedMethods:e,store:t}){this.restrictedMethods=e,this.store=t,this.logs=[],this.updateIndexedDBPermissionsLog=(0,TK.default)(cm,1e3*60)}async getActivityLog(){return this.logs.length>0?this.logs:dm()}updateActivityLog(e){this.logs=e,this.updateIndexedDBPermissionsLog(e)}getHistory(){return this.store.getState()[Af]||{}}updateHistory(e){this.store.updateState({[Af]:e})}updateAccountsHistory(e,t){if(t.length===0)return;let n=iie(t,Date.now());this.commitNewHistory(e,{eth_accounts:{accounts:n,lastApproved:Date.now()}})}getLastApprovedAccount(e){let t=this.getHistory(),{accounts:n={},lastApproved:a}=t[e]?.eth_accounts||{},s=null;return Object.keys(n).forEach(i=>{n[i]===a&&(s=i)}),s}createMiddleware(){return async(e,t,n)=>{let a,{method:s}=e,i=s.startsWith(Eb);if(!lK.includes(s)&&(i||this.restrictedMethods.includes(s)))a=await this.logRequest(e,i);else if(s==="eth_requestAccounts")a=await this.logRequest(e,i);else{n();return}n(async o=>{let c=Date.now();await this.logResponse(a,t,c),o()})}}async logRequest(e,t){let n={id:e.id,method:e.method,methodType:t?A2.internal:A2.restricted,origin:e.origin,request:(0,M2.default)(e,null,2),requestTime:Date.now(),response:null,responseTime:null,success:null};return await this.commitNewActivity(n),n}async logResponse(e,t,n){if(!e||!t)return;e.response=(0,M2.default)(t,null,2),e.responseTime=n,e.success=!t.error;let a=await this.getActivityLog(),s=a.findIndex(i=>i.id===e.id);s!==-1&&(a[s]=e,this.updateIndexedDBPermissionsLog(a))}async commitNewActivity(e){let t=await this.getActivityLog();if(t.length+1>C2){let n=t.length+1-C2;t.splice(0,n)}this.updateActivityLog([...t,e])}commitNewHistory(e,t){let n=this.getHistory(),a={...n[e],...t},s=n[e]&&n[e].eth_accounts,i=t.eth_accounts;if(s&&i){let o=i.lastApproved||s.lastApproved;a.eth_accounts={lastApproved:o,accounts:{...s.accounts,...i.accounts}}}n[e]=a,this.updateHistory(n)}getRequestedMethods(e){return!e.params||!e.params[0]||typeof e.params[0]!="object"||Array.isArray(e.params[0])?null:Object.keys(e.params[0])}};d();f();var Ch=_(Ce()),NK=_(On());ae();d();f();ne();var sc={},Ki={},_h={},Ah={};async function N2({isRpcMode:r,setWalletConfig:e,getProviderConfig:t,req:n}){let{autoSwitchRecover:a=!1}=n;if(a){sc[n.origin]&&(Ki[n.origin]-=1,Ki[n.origin]===0&&(sc[n.origin].isRpcMode?e("isRpcMode",!1):e("isRpcMode",!0),delete sc[n.origin])),_h[n.origin]&&(Ah[n.origin]-=1,Ah[n.origin]===0&&(Bi({..._h[n.origin],extensionKey:"rpc_info"}),delete _h[n.origin]));return}let{type:s,rpcUrl:i,uniqueId:o}=t();r&&s!==La&&(e("isRpcMode",!1),sc[n.origin]={isRpcMode:!1},Ki[n.origin]=(Ki[n.origin]||0)+1),!r&&s!==La&&sc[n.origin]&&(Ki[n.origin]+=1),!r&&s===La&&(e("isRpcMode",!0),sc[n.origin]={isRpcMode:!0},Ki[n.origin]=(Ki[n.origin]||0)+1),r&&s===La&&sc[n.origin]&&(Ki[n.origin]+=1);let c=await _f("rpc_info"),l=await F5(o);s===La&&c.rpcUrl!==i&&(await Bi({...l,extensionKey:"rpc_info"}),await U5(l),_h[n.origin]=c,Ah[n.origin]=(Ah[n.origin]||0)+1),s===La&&c.rpcUrl===i&&_h[n.origin]&&(Ah[n.origin]+=1)}d();f();Kc();n0();var IK=_(yn()),oie=[{name:"title",key:"wallet_extension_connect_notif_reselect_connect"},{name:"buttonName",key:"wallet_extension_connect_textbtn_reselect"},{name:"otherTitle",key:"wallet_extension_connect_notif_disconnect_select"}],EK=async r=>{let e={},t=await Ba(r);oie.forEach(a=>{e[a.name]=Fc(r,t,a.key,a.params)||""});let n=IK.default.runtime.getURL("/static/fonts/HarmonyOS_Sans_Web/HarmonyOS_Sans_Regular.woff2");return e.fontSrc=n,e.staticHost=wo(),e};d();f();n0();var R2=_(yn()),cie=[{name:"mainTitle",key:"dapp_toast_title_site_warning"},{name:"subTitle",key:"dapp_toast_subtitle_asset_safety"},{name:"contentOne",key:"dapp_toast_text_block_sites"},{name:"contentTwo",key:"dapp_toast_text_risks_mention"},{name:"contentThree",key:"dapp_toast_text_contact_support"},{name:"buttonName",key:"dapp_toast_btn_continue_visiting"}],die=[{name:"mainTitle",key:"dapp_toast_title_site_warning"},{name:"subTitle",key:"dapp_toast_subtitle_asset_safety"},{name:"contentOne",key:"dapp_toast_text_secure_detects"},{name:"contentTwo",key:"dapp_toast_text_low_protection"},{name:"contentThree",key:"dapp_toast_text_contact_support"},{name:"buttonName",key:"dapp_toast_btn_continue_visiting"}],PK=async(r,e,t)=>{let n="",a=[],s={};switch(r){case"EXTREMELY_HIGH":n=qx.ERROR,a=cie;break;case"HIGH":e===l0.HIGH&&(n=qx.WARNING,a=die);break;case"MEDIUM":case"SAFE":break;default:break}if(n){let i=await Ba(t);a.forEach(l=>{s[l.name]=Fc(t,i,l.key,l.params)});let o=R2.default.runtime.getURL("/static/images/icon-512.png"),c=R2.default.runtime.getURL("/static/fonts/HarmonyOS_Sans_Web/HarmonyOS_Sans_Regular.woff2");s.iconSrc=o,s.fontSrc=c}return s.tipType=n,s};d();f();Cn();var k2="web-deviceId";async function O2(r){if(!r||typeof r!="string")return;(await xe.get(k2))[k2]!==r&&xe.set({[k2]:r})}d();f();Wt();ur();var MK=async r=>{let{data:e}=await Uc(ce.domainSecurityLevelUrl,{domain:r});return e||null};function D2({addDomainMetadata:r,getAccounts:e,getUnlockPromise:t,isUnlocked:n,hasPermission:a,hasPermissionRequest:s,notifyAccountsChanged:i,requestAccountsPermission:o,checkDomain:c,findIdentities:l,disconnect:u,currentLocale:h,walletProtectionLevel:b,offlineTransaction:y,walletConfigController:v,getVersion:S,walletAggregateController:R,getProviderConfig:P,mpcController:N,blinkController:M,updateAccountsHistory:L,getInstanceID:B,handleConnectResult:F}){let K=z=>({address:z.addresses,name:z.name,keyringName:z.keyringName,keyringIdentityType:z.keyringIdentityType}),H=async(z=[],T)=>(await l(z,T)).map(x=>({address:x.address,name:x.name,keyringName:x.keyringName,keyringIdentityType:x.keyringIdentityType})),j=async(z=[])=>(await l(z,J)).map(m=>m.address),X=async(z=[])=>(await l(z)).map(K);return(0,NK.createAsyncMiddleware)(async(z,T,m)=>{let x;switch(z.method){case"eth_accounts":{if(n()){let w=await e({});T.result=await j(w)}else T.result=[];return}case"wallet_disconnect":{n()&&await u(),T.result=[];return}case"wallet_identities":{if(n()){let w=await e({});T.result=await H(w,J)}else T.result=[];return}case"wallet_wallets":{if(n()){let w=await e({providerType:z.params?.providerType}),I=await X(w);T.result=await Promise.all(I.map((k,O)=>F(w[O],k,z)))}else T.result=[];return}case"eth_requestAccounts":{a("eth_accounts")&&await t();let w=await e({providerType:wn,method:Cd.ethRequestAccounts});if(w.length>0){T.result=await j(w);return}try{await o()}catch(I){T.error=I;return}w=await e({}),w.length>0?(T.result=await j(w),L(w)):T.error=Ch.ethErrors.rpc.internal("Accounts unexpectedly unavailable. Please report this bug.");return}case"wallet_requestIdentities":{a("eth_accounts")&&await t();let w=await e({});if(w.length>0){T.result=await H(w,J);return}try{await o()}catch(I){T.error=I;return}w=await e({}),w.length>0?(T.result=await H(w,J),L(w)):T.error=Ch.ethErrors.rpc.internal("Accounts unexpectedly unavailable. Please report this bug.");return}case"wallet_requestWallets":{a("eth_accounts")&&await t();let w=async(O,E)=>{let A=await X(O);T.result=await Promise.all(A.map((g,C)=>F(O[C],g,z,E)))},I=await e({providerType:z.params?.providerType,exts:z.params?.exts});if(I.length>0){await w(I);return}let k;try{k=await o()}catch(O){T.error=O;return}I=await e({}),I.length>0?(await w(I,k),L(I)):T.error=Ch.ethErrors.rpc.internal("Accounts unexpectedly unavailable. Please report this bug.");return}case"wallet_sendDomainMetadata":{if(z.params?.host&&z.params?.host!==z.origin){T.result=!0;return}if(typeof z.params?.name=="string"){let{devId:w,...I}=z.params;r(z.origin,I),O2(w)}T.result=!0;return}case"wallet_checkDomain":{T.result=c(z.origin);return}case"wallet_aggregate":try{if(s("eth_accounts")){T.error=Ch.ethErrors.rpc.resourceUnavailable("Already processing eth_requestAccounts. Please wait.");return}let w=await R.gotoAggregate();T.result=w;return}catch(w){T.error=w;return}case"wallet_injectProvider":try{R.setInjectProvider(z.params),T.result={};return}catch(w){T.error=w;return}case"wallet_requestPermissions":{"eth_accounts"in z.params?.[0]&&(x=async()=>{if(Array.isArray(T.result))for(let w of T.result)w.parentCapability==="eth_accounts"&&e({}).then(i).catch(()=>{})});break}case"wallet_requestIsUnlock":{T.result=n();return}case"wallet_requestDomainCheck":try{let w=z?.params?.url,{level:I}=await MK(w),k=await PK(I,b,h);T.result={...k,origin:z.origin};return}catch(w){T.error=w;return}case"wallet_disconnectAlert":try{let w=await EK(h);T.result=w;return}catch(w){T.error=w;return}case"wallet_offlineSign":try{let w=await y(z.params,z);T.result=w;return}catch(w){T.error=w;return}case"wallet_isCustomMode":try{let{walletConfig:w={}}=v.store.getState(),{isRpcMode:I}=w;T.result=I;return}catch(w){T.error=w;return}case"wallet_autoSwitchMode":try{let{walletConfig:w={}}=v.store.getState(),{isRpcMode:I}=w,k=v.setWalletConfig.bind(v);await N2({isRpcMode:I,getProviderConfig:P,setWalletConfig:k,req:z}),T.result=!0;return}catch(w){T.error=w;return}case"wallet_requestVersion":try{let w=S();T.result=w;return}catch(w){T.error=w;return}case"wallet_syncToken":try{let w=z.params;await N.syncToken(w),T.result=!0;return}catch(w){T.error=w;return}case"wallet_getIsNeedSyncToken":try{let w=z.params,I=await N.getIsNeedSyncToken(w);T.result=I;return}catch(w){T.error=w;return}case"extension_openNewTab":try{let w=z.params,{url:I}=w;if(!I)return;globalThis.platform.openTab({url:I}),T.result=!0;return}catch(w){T.error=w;return}case"wallet_getBlinkConfig":try{let w=await M.getBlinkWhiteList();T.result=w;return}catch(w){T.error=w;return}case"wallet_getInstanceID":try{let w=B();T.result=w;return}catch{T.result="";return}default:break}await m(),x&&x()})}var RK=()=>{},Ob=class{constructor({approvals:e,getRestrictedMethods:t,getUnlockPromise:n,isUnlocked:a,notifyDomain:s,notifyAllDomains:i,preferences:o,domainChecker:c,preferencesController:l,walletAggregateController:u,networkController:h,offlineTransaction:b,walletConfigController:y,getVersion:v,getProviderConfig:S,mpcController:R,rpcController:P,blinkController:N,instanceIDController:M,keyringController:L}={},B={},F={}){this.store=new kK.ObservableStore({[S2]:F[S2]||[],[Af]:F[Af]||{}}),this._getUnlockPromise=n,this._notifyDomain=s,this._notifyAllDomains=i,this._isUnlocked=a,this._restrictedMethods=t({getIdentities:()=>{let{walletIdentityMap:K}=l.getAllWalletIdentityMap();return K}}),this.permissionsLog=new Sh({restrictedMethods:Object.keys(this._restrictedMethods),store:this.store}),this.approvals=e,this._initializePermissions(B),this._lastSelectedWallet=o.getState().selectedWallet,this._accounts=[],this.preferences=o,this.domainChecker=c,this.preferencesController=l,this.networkController=h,this.walletAggregateController=u,this.accountProviderType={},this.accountProviderMethod={},this.accountProviderExts={},this.offlineTransaction=b,this.walletConfigController=y,this.getVersion=v,this.getProviderConfig=S,this.mpcController=R,this.rpcController=P,this.blinkController=N,this.instanceIDController=M,this.keyringController=L,this._initializeMetadataStore(F),o.subscribe(async({selectedWallet:K})=>{K&&K!==this._lastSelectedWallet&&(this._lastSelectedWallet=K,await this._handleAccountSelected(K))})}createMiddleware({origin:e,extensionId:t}){if(typeof e!="string"||!e.length)throw new Error("Must provide non-empty string origin.");let n=this.store.getState()[gh],{currentLocale:a,preferences:s}=this.preferences.getState(),i=s.walletProtectionLevel;t&&n[e]?.extensionId!==t&&this.addDomainMetadata(e,{extensionId:t});let o=new DK.JsonRpcEngine;return o.push(this.permissionsLog.createMiddleware()),o.push(D2({addDomainMetadata:this.addDomainMetadata.bind(this),getAccounts:({providerType:c=wn,method:l=Cd.requestWallets,exts:u={}})=>this.getAccounts({origin:e,providerType:c,method:l,exts:u}),getUnlockPromise:()=>this._getUnlockPromise(!0),handleConnectResult:async(c,l,u,h)=>{if(u?.params?.providerType===ps){let b=u.params?.exts?.message?.items||[],{address:y}=l,S=y.find(({name:N})=>N===er).address,{domain:R}=h?.resultParams||{},P=new OK.TonWallet;return l.tonItems=await Promise.all(b.map(async({name:N,payload:M})=>{if(N===hi.TON_ADDR){let L=await this.keyringController.getPublicKey(S,er,c),B={workChain:m8,publicKey:L,walletVersion:p8},F=await P.getWalletInformation(B),K=await P.convertAddress({address:S});return{name:hi.TON_ADDR,address:K.raw,network:h5.MAINNET,publicKey:L,walletStateInit:F.walletStateInit}}if(N===hi.TON_PROOF){let L=Math.round(Date.now()/1e3),B=new URL(R).host,F=p.Buffer.from(B);return{name:hi.TON_PROOF,proof:{timestamp:L,domain:{lengthBytes:F.byteLength,value:F.toString("utf8")},signature:await this.keyringController.signTonProof({proof:{timestamp:L,domain:B,payload:M}},S,c),payload:M}}}return null})),l}return l},isUnlocked:this._isUnlocked,hasPermission:this.hasPermission.bind(this,e),hasPermissionRequest:this.hasPermissionRequest.bind(this,e),notifyAccountsChanged:this.notifyAccountsChanged.bind(this,e),requestAccountsPermission:this._requestPermissions.bind(this,{origin:e},{eth_accounts:{}}),checkDomain:this.checkDomain.bind(this),findIdentities:this._findIdentities.bind(this),disconnect:this.disconnect.bind(this,e),currentLocale:a,walletProtectionLevel:i,offlineTransaction:this.offlineTransaction,walletConfigController:this.walletConfigController,rpcController:this.rpcController,getVersion:this.getVersion,walletAggregateController:this.walletAggregateController,getProviderConfig:this.getProviderConfig.bind(this),mpcController:this.mpcController,blinkController:this.blinkController,updateAccountsHistory:this.permissionsLog.updateAccountsHistory.bind(this.permissionsLog,e),getInstanceID:this.instanceIDController.getInstanceID})),o.push(this.permissions.providerMiddlewareFunction.bind(this.permissions,{origin:e})),o.asMiddleware()}getAccounts({origin:e,providerType:t,method:n,exts:a}){let s=this;return t&&(this.accountProviderType[e]=t),this.accountProviderMethod[e]=n,this.accountProviderExts[e]=a,new Promise(i=>{let o={method:"eth_accounts"},c={};function l(){if(a&&a?.alwaysNeedProof&&i([]),c.error||!Array.isArray(c.result))i([]);else{let u=s.preferences.getState().selectedWallet,h=s._getPermittedAccounts(e)||[];if(s._accounts.includes(u)||h.includes(u))i([u]);else{let b=s.permissionsLog.getLastApprovedAccount(e);i(h.includes(b)?[b]:c.result)}s._accounts=[]}}this.permissions.providerMiddlewareFunction({origin:e},o,c,RK,l)})}disconnect(e){this.removePermissionsFor({[e]:["eth_accounts"]})}async getEthAccounts(e,t=!0){let n=t?await this._getPermittedAccounts(e):await this.getAccounts({origin:e});return(await this._findIdentities(n,J)).map(s=>s.address)}async getPermittedWallets(e,t=!0){return t?this._getPermittedAccounts(e):this.getAccounts({origin:e})}async getCurrentPermittedAccount(e,t=J){let n=await this.getAccounts({origin:e}),[a]=await this._findIdentities(n,t);return a}async getAllPermittedAccounts(e,t){let n=this._getPermittedAccounts(e);return this._findIdentities(n,t)}hasPermission(e,t){return Boolean(this.permissions.getPermission(e,t))}hasPermissionRequest(e,t){return(this.permissions.getPermissionsRequests()||[]).some(({metadata:a,permissions:s})=>a?.origin===e&&s[t])}getPermissionRequestIdsByDomain(e,t="eth_accounts"){let n=this.permissions.getPermissionsRequests()||[],a={};return n.forEach(({metadata:s,permissions:i})=>{s?.origin&&!a[s?.origin]&&(a[s?.origin]=[]),s?.id&&i[t]&&a[s?.origin].push(s?.id)}),a[e]||[]}async _findIdentities(e=[],t){if(!e.length)return[];let n=this.preferencesController.patchGetIdentities(e,t),a=await qa();return n&&n[0]&&n[0].account?.mainnet&&a.forEach(s=>{let i=Il(s.chainId);n[0].addresses.push({chainId:i,coinType:60,name:s.name,address:n[0].account.mainnet})}),n}_requestPermissions(e,t,n){return new Promise((a,s)=>{let i={id:n,method:"wallet_requestPermissions",params:[t]},o={};function c(l){let u=l||o.error;u?s(u):a(o.result)}this.permissions.providerMiddlewareFunction(e,i,o,RK,c)})}async approvePermissionsRequest(e,t,n){this._accounts=t||[];let{id:a,origin:s}=e.metadata,i=this.getPermissionRequestIdsByDomain(s);n&&this.networkController.setProviderType(n);try{e.permissions=await this.finalizePermissionsRequest(e.permissions,t),i.forEach(o=>{this.approvals.resolve(o,{permissions:e.permissions,resultParams:e.resultParams})}),vd({o:s,w:t})}catch(o){this.approvals.reject(a,kb.ethErrors.rpc.invalidRequest({message:o.message,data:o}))}}async rejectPermissionsRequest(e,t){if(t){this.rejectConnectRequest(t);return}if(!this.approvals.has({id:e})){LK.default.debug(`Permissions request with id '${e}' not found.`);return}this.approvals.reject(e,kb.ethErrors.provider.userRejectedRequest())}async rejectConnectRequest(e){this.getPermissionRequestIdsByDomain(e).forEach(n=>{this.approvals.reject(n,kb.ethErrors.provider.userRejectedRequest())})}async addPermittedAccount(e,t){if(!this.permissions.getDomains()[e])throw new Error("Unrecognized domain");this.validatePermittedAccounts([t]);let a=this._getPermittedAccounts(e);if(a.length===0)throw new Error("Origin does not have 'eth_accounts' permission");if(a.includes(t))throw new Error("Account is already permitted for origin");let s=[...a,t];this.permissions.updateCaveatFor(e,"eth_accounts",fi.exposedAccounts,s),vd({o:e,w:s}),await this.notifyAccountsChanged(e,[t])}async removePermittedAccount(e,t){if(!this.permissions.getDomains()[e])throw new Error("Unrecognized domain");this.validatePermittedAccounts([t]);let a=this._getPermittedAccounts(e);if(a.length===0)throw new Error("Origin does not have 'eth_accounts' permission");if(!a.includes(t))throw new Error("Account is not permitted for origin");let s=a.filter(i=>i!==t);s.length===0?this.removePermissionsFor({[e]:["eth_accounts"]}):(this.permissions.updateCaveatFor(e,"eth_accounts",fi.exposedAccounts,s),vd({o:e,w:s}),s=await this.getAccounts({origin:e}),await this.notifyAccountsChanged(e,s))}async removePermittedAllAccount(e){if(!this.permissions.getDomains()[e])throw new Error("Unrecognized domain");if(this._getPermittedAccounts(e).length===0)throw new Error("Origin does not have 'eth_accounts' permission");this.removePermissionsFor({[e]:["eth_accounts"]})}async removeAllAccountPermissions(e){this.validatePermittedAccounts([e]);let t=this.permissions.getDomains(),n=Object.keys(t).filter(a=>this._getPermittedAccounts(a).includes(e));await Promise.all(n.map(a=>this.removePermittedAccount(a,e)))}async finalizePermissionsRequest(e,t){let n=(0,L2.cloneDeep)(e),a=(0,L2.cloneDeep)(t),{eth_accounts:s}=n;return s&&(this.validatePermittedAccounts(a),s.caveats||(s.caveats=[]),s.caveats=s.caveats.filter(i=>i.name!==fi.exposedAccounts&&i.name!==fi.primaryAccountOnly),s.caveats.push({type:_2.limitResponseLength,value:1,name:fi.primaryAccountOnly}),s.caveats.push({type:_2.filterResponse,value:a,name:fi.exposedAccounts})),n}validatePermittedAccounts(e){if(!Array.isArray(e)||e.length===0)throw new Error("Must provide non-empty array of account(s).")}async notifyAccountsChanged(e,t){if(typeof e!="string"||!e)throw new Error(`Invalid origin: '${e}'`);if(!Array.isArray(t))throw new Error("Invalid accounts",t);if(this._isUnlocked()){let n=await this._findIdentities(t,J);this._notifyDomain({origin:e},{method:Kr.accountsChanged,params:n.map(i=>i.address)});let a=n.map(i=>({address:i.address,name:i.name,keyringName:i.keyringName}));this._notifyDomain({origin:e},{method:Kr.identitiesChanged,params:a});let s=await this._findIdentities(t);this._notifyDomain({origin:e},{method:Kr.walletChanged,params:s?.map(i=>({address:i.addresses,name:i.name,keyringName:i.keyringName,keyringIdentityType:i.keyringIdentityType}))}),this.permissionsLog.updateAccountsHistory(e,t)}}removePermissionsFor(e){Object.entries(e).forEach(([t,n])=>{this.permissions.removePermissionsFor(t,n.map(a=>(a==="eth_accounts"&&this.notifyAccountsChanged(t,[]),{parentCapability:a}))),vd({o:t,w:[]})})}clearPermissions(){let e=this.permissions.getDomains();this.permissions.clearDomains(),Object.entries(e).forEach(([t])=>{vd({o:t,w:[]})}),this._notifyAllDomains({method:Kr.accountsChanged,params:[]}),this._notifyAllDomains({method:Kr.identitiesChanged,params:[]}),this._notifyAllDomains({method:Kr.walletChanged,params:[]})}addDomainMetadata(e,t){let n=this.store.getState()[gh],a={...n};if(this._pendingSiteMetadata.size>=100){let o=this.permissions.getDomains(),c=this._pendingSiteMetadata.values().next().value;this._pendingSiteMetadata.delete(c),o[c]||delete a[c]}let s=new URL(e).host,i=t.isOkx||s==="www.okx.com"||s==="www.okex.com";a[e]={...n[e],...t,isOkx:i,lastUpdated:Date.now()},!a[e].extensionId&&!a[e].host&&(a[e].host=new URL(e).host),this._pendingSiteMetadata.add(e),this._setDomainMetadata(a)}checkDomain(e){let{domainMetadata:t}=this.store.getState(),{isOkx:n}=t[e]||{},a=n||this.domainChecker.test(e),{preferences:s}=this.preferences.getState();return{isWhitelist:a,defaultWallet:s?.defaultWallet}}_initializeMetadataStore(e){let t=e[gh]||{},n=this._trimDomainMetadata(t);this._pendingSiteMetadata=new Set,this._setDomainMetadata(n)}_trimDomainMetadata(e){let t={...e},n=Object.keys(e),a=this.permissions.getDomains();return n.forEach(s=>{a[s]||delete t[s]}),t}_setDomainMetadata(e){this.store.updateState({[gh]:e},!1)}_getPermittedAccounts(e){return this.permissions.getPermission(e,"eth_accounts")?.caveats?.find(n=>n.name===fi.exposedAccounts)?.value||[]}async _handleAccountSelected(e){if(typeof e!="string")throw new Error("Selected account should be a non-empty string.");let t=this.permissions.getDomains()||{},n=Object.entries(t).filter(([,{permissions:a}])=>a.find(o=>o.parentCapability==="eth_accounts")?.caveats.find(o=>o.name==="exposedAccounts")?.value?.includes(e)).map(([a])=>a);await Promise.all(n.map(a=>this._handleConnectedAccountSelected(a,e)))}async _handleConnectedAccountSelected(e,t){await this.notifyAccountsChanged(e,[t])}_initializePermissions(e){let t={...e,permissionsRequests:[]};this.permissions=new vh({safeMethods:uK,methodPrefix:Eb,restrictedMethods:this._restrictedMethods,requestUserApproval:async n=>{let{metadata:{id:a,origin:s}}=n,i=this.accountProviderType[s];this.accountProviderType[s]=null;let o=this.accountProviderMethod[s],c=this.accountProviderExts[s];return this.accountProviderMethod[s]=null,this.accountProviderExts[s]=null,this.approvals.addAndShowApprovalRequest({id:a,origin:s,type:fK,requestData:{providerType:i,method:o,exts:c}})}},t)}};d();f();function B2({getIdentities:r}){return{eth_accounts:{method:async(e,t,n,a)=>{try{let s=r();t.result=Object.keys(s),a()}catch(s){t.error=s,a(s)}}}}}d();f();Be();var jK=_(Ne()),Ks=_(Ce()),Bb=_(Ox()),VK=_(Fr());Ge();ae();Wt();n0();d();f();ae();var lie=r=>({patchGetIdentities(e=[],t){let{keyringIdentityMap:n,walletIdentityMap:a}=r.getAllWalletIdentityMap(),s=[],i=t||J;return e.forEach(o=>{let{keyringId:c,walletIdentity:l}=a[o],{keyringName:u,keyringIdentityType:h}=n[c],{walletName:b,lastSelected:y,account:v}=l;if(!l||t&&!v[t])return;let S=v[i]||"";s.push({walletId:o,keyringName:u,keyringIdentityType:a8[h],name:b,address:S,lastSelected:y,account:v,addresses:v?Object.keys(v).map(R=>{let P=v[R],N=me({localType:R});return{coinId:N?.coinId,chainId:String(N?.netWorkId),address:P,coinType:N?.coinType,name:R}}):[]})}),s}}),BK=lie;d();f();var qK=_(te());Ge();var qi=_(h_());ne();d();f();var Db=_(te());var K2=(r,e)=>`${r} ${(0,Db.padStart)(e,2,"0")}`,WK=(r,e)=>`${r} ${(0,Db.padStart)(e,2,"0")}`,KK=(r,e)=>`${r} ${(0,Db.padStart)(e,2,"0")}`,Lb=({names:r,generateFn:e,defaultName:t,index:n})=>{let a=n,s=e(t,a);for(;r.includes(s);)a+=1,s=e(t,a);return s},W2={[ue.PRIVATE_KEY]:"var(--okx-wallet-keyring-color-pk)",[ue.MPC]:"var(--okx-wallet-keyring-color-pk)",others:["var(--okx-wallet-keyring-color-primary)","var(--okx-wallet-keyring-color-secondary)","var(--okx-wallet-keyring-color-tertiary)","var(--okx-wallet-keyring-color-quaternary)","var(--okx-wallet-keyring-color-quinary)","var(--okx-wallet-keyring-color-senary)","var(--okx-wallet-keyring-color-septenary)","var(--okx-wallet-keyring-color-octonary)"]},Tf=(r,e)=>{if(r===ue.PRIVATE_KEY)return W2[ue.PRIVATE_KEY];if(r===ue.MPC)return W2[ue.MPC];let t=W2.others;return t[e%t.length]};var uie=r=>({getMnemonicAndHardWareKeyringCount(e){return e.filter(t=>[ue.MNEMONIC,ue.HARDWARE,ue.TON_MNEMONIC].includes(t.keyringIdentityType)).length},privateSyncIdentityToKeyringIdentities(e){let{keyringIdentities:t,identities:n}=r.store.getState(),{wallet:a,address:s,keyringIdentityType:i,defaultKeyringName:o,insertIndex:c,walletName:l}=e,u=t.find(y=>y.keyringIdentityType===i),h=s?.toLowerCase(),b=n?.[h]||{name:l,lastSelected:Date.now()};if(u)u.walletIdentities.push(To({...a,walletName:b.name,lastSelected:b.lastSelected}));else{let y=Me(),v=o,S=To({...a,walletName:b.name,lastSelected:b.lastSelected}),P={keyringColor:Tf(i,this.getMnemonicAndHardWareKeyringCount(t)),keyringId:y,keyringName:v,keyringIdentityType:i,walletIdentities:[S]};t.splice(c,0,P)}r.store.updateState({keyringIdentities:t})},insertKeyringIdentity({wallet:e,keyringName:t,keyringIdentityType:n,hardwareWalletType:a,hardwareWalletModel:s,masterFingerprint:i,onekeyInfo:o,keyringColor:c,compareFn:l,insertDiff:u,userInfo:h,mpcId:b}){let{keyringIdentities:y}=r.store.getState(),v=Me(),S=(0,qK.findLastIndex)(y,l),R=n===ue.PRIVATE_KEY&&!e.account[pe]&&!e.account[En]?this.generatePrivateAccountName(e,[]):this.generateWalletName(n,e,[]),P=To({...e,walletName:R,lastSelected:0}),{initialType:N}=e,M={keyringId:v,keyringName:t,keyringIdentityType:n,initialType:N,keyringColor:c,walletIdentities:[P]};return u9(n)&&(M.hardwareWalletType=a,M.hardwareWalletModel=s,pd(a)&&(M.masterFingerprint=i),Eo(a)&&(M.onekeyInfo=o)),q9(n)&&(M.userInfo=h,M.mpcId=b),S===-1?y.push(M):y.splice(S+u,0,M),r.store.updateState({keyringIdentities:y}),Ux(P,M)},generatePrivateAccountName(e,t=[]){let{account:n={}}=e,a=Object.values(n)[0]||"";return Gc(a)||this.generateNormalWalletName(t)},pushWalletIdentity(e,t){let{keyringIdentities:n}=r.store.getState(),a=n.find(t);if(!a)throw new Error("can not get keyringIdentity");let s=a.keyringIdentityType===ue.PRIVATE_KEY&&!e.account[pe]&&!e.account[En]?this.generatePrivateAccountName(e,a.walletIdentities):this.generateWalletName(a.keyringIdentityType,e,a.walletIdentities),i=To({...e,walletName:s,lastSelected:0});return a.walletIdentities.push(i),r.store.updateState({keyringIdentities:n}),Ux(i,a)},generateMnemonicKeyringName(){let{keyringIdentities:e}=r.store.getState(),t=e.filter(s=>[ue.TON_MNEMONIC,ue.MNEMONIC].includes(s.keyringIdentityType)).map(s=>s.keyringName),n=r.translate("wallet_manage_wallet_top_default_wallet_name")||qi.default.walletDefaultName,a={names:t,generateFn:KK,defaultName:n,index:t.length+1};return Lb(a)},generateHardWareWalletKeyringName(e){let{keyringIdentities:t}=r.store.getState(),n=t.filter(a=>a.hardwareWalletModel===e).map(a=>a.keyringName);return Lb({names:n,generateFn:WK,defaultName:e,index:n.length+1})},generateNormalWalletName(e){let t=e.map(s=>s.walletName),n=r.translate("wallet_manage_wallet_top_account_default_name")||qi.default.accountDefaultName,a={names:t,generateFn:K2,defaultName:n,index:t.length+1};return Lb(a)},generateWalletName(e,t,n){switch(e){case(ue.PRIVATE_KEY&&!t.account[pe]&&!t.account[En]):return this.generatePrivateAccountName(t,n);default:return this.generateNormalWalletName(n)}},insertMnemonicKeyringIdentity(e){let t=e.initialType===$.HD_KEYRING?ue.MNEMONIC:ue.TON_MNEMONIC,n=this.generateMnemonicKeyringName(),a=c=>[ue.MNEMONIC,ue.TON_MNEMONIC].includes(c.keyringIdentityType),{keyringIdentities:s}=r.store.getState(),i=Tf(t,this.getMnemonicAndHardWareKeyringCount(s)),o={wallet:e,compareFn:a,keyringName:n,keyringIdentityType:t,keyringColor:i,insertDiff:1};return this.insertKeyringIdentity(o)},pushAnyWalletIdentity(e,t){let n=a=>{let{walletIdentities:s}=a;return s.some(i=>i.walletId===e)};return this.pushWalletIdentity(t,n)},insertPrivateKeyKeyringIdentity(e){let{keyringIdentities:t}=r.store.getState(),n=l=>l.keyringIdentityType===ue.PRIVATE_KEY,a=t.some(n),s=ue.PRIVATE_KEY;if(a)return this.pushWalletIdentity(e,n);let i=r.translate("wallet_manage_wallet_top_private_key_default_name")||qi.default.privateKeyDefaultName,c={wallet:e,compareFn:l=>l.keyringIdentityType===ue.PRIVATE_KEY,keyringName:i,keyringIdentityType:s,keyringColor:Tf(s),insertDiff:0};return this.insertKeyringIdentity(c)},insertMpcKeyKeyringIdentity(e){let t=ue.MPC,n=e?.userInfo?.walletName||r.translate("extension_wallet_name_colored_keyless_wallet")||qi.default.mpcDefaultName,a=c=>c.keyringIdentityType===ue.MPC,{userInfo:s,mpcId:i}=e,o={wallet:e,compareFn:a,keyringName:n,keyringIdentityType:t,keyringColor:Tf(t),insertDiff:0,userInfo:s,mpcId:i};return this.insertKeyringIdentity(o)},insertHardwareKeyringIdentity(e,t){let{keyringIdentities:n}=r.store.getState(),a=v=>{let S=v.keyringIdentityType===ue.HARDWARE,{walletIdentities:R=[]}=v||{},P=R.some(N=>N.walletId===t);return S&&P};if(n.some(a))return this.pushWalletIdentity(e,a);let{hardwareWalletType:i,hardwareWalletModel:o,onekeyInfo:c,masterFingerprint:l}=e,u=this.generateHardWareWalletKeyringName(o),h=()=>!1,b=ue.HARDWARE,y={wallet:e,compareFn:h,keyringName:u,keyringIdentityType:b,hardwareWalletType:i,hardwareWalletModel:o,masterFingerprint:l,keyringColor:Tf(b,this.getMnemonicAndHardWareKeyringCount(n)),onekeyInfo:c,insertDiff:0};return this.insertKeyringIdentity(y)},syncMnemonicIdentityToKeyringIdentities(e,t,n,a){this.privateSyncIdentityToKeyringIdentities({wallet:e,address:t,keyringIdentityType:a,defaultKeyringName:this.generateMnemonicKeyringName(),insertIndex:0,walletName:n})},syncSimpleIdentityToKeyringIdentities(e,t,n){this.privateSyncIdentityToKeyringIdentities({wallet:e,address:t,keyringIdentityType:ue.PRIVATE_KEY,defaultKeyringName:r.translate("wallet_manage_wallet_top_private_key_default_name")||qi.default.privateKeyDefaultName,insertIndex:1,walletName:n})},syncHardwareIdentityToKeyringIdentities(e,t,n){this.privateSyncIdentityToKeyringIdentities({wallet:e,address:t,keyringIdentityType:ue.HARDWARE,defaultKeyringName:r.translate("wallet_manage_wallet_top_hardware_wallet_defalult_name")||qi.default.hardWalletDefaultName,insertIndex:2,walletName:n})},syncIdentityToKeyringIdentities(e,t,n=0){if(e.initialType===$.MPC_KEYRING)return;let a=K2(r.translate("wallet_manage_wallet_top_account_default_name")||qi.default.accountDefaultName,n+1);if(e.initialType===$.HD_KEYRING||e.initialType===$.TON_HD_KEYRING){let s=e.initialType===$.HD_KEYRING?ue.MNEMONIC:ue.TON_MNEMONIC;this.syncMnemonicIdentityToKeyringIdentities(e,t,a,s)}else e.initialType===$.SIMPLE_KEYRING?this.syncSimpleIdentityToKeyringIdentities(e,t,Gc(t)||a):this.syncHardwareIdentityToKeyringIdentities(e,t,a)}}),UK=uie;d();f();var hie=r=>({_checkKeyringIdentities(e=!0){let{keyringIdentities:t}=r.store.getState();if(e&&t.length===0)r.resetOnboarding(),r.store.updateState({selectedWallet:""});else{let n=r.getSelectedWallet();if(!r.getWalletIdentities().some(i=>i.walletId===n)&&t.length){let i=t[0]?.walletIdentities[0]?.walletId;r.setSelectedWallet(i)}}},removeEmptyKeyringIdentities(){let{keyringIdentities:e}=r.store.getState(),t=e.filter(n=>Boolean(n.walletIdentities.length));r.store.updateState({keyringIdentities:t})},clearKeyringIdentities(){r.store.updateState({keyringIdentities:[]})},deleteWalletIdentity(e){let{keyringIdentities:t}=r.store.getState();if(!r._getKeyringIdentityWithWalletId(e))throw new Error("can not delete walletIdentity with walletId");t.forEach(a=>{let{walletIdentities:s}=a;a.walletIdentities=s.filter(i=>i.walletId!==e)}),r.store.updateState({keyringIdentities:t}),this.removeEmptyKeyringIdentities(),this._checkKeyringIdentities()},deleteKeyringIdentity(e){let{keyringIdentities:t}=r.store.getState(),n=r._getKeyringIdentityWithWalletId(e);if(!n)throw new Error("can not delete keyringIdentity with walletId");let a=t.filter(s=>s.keyringId!==n.keyringId);r.store.updateState({keyringIdentities:a}),this._checkKeyringIdentities()}}),FK=hie;d();f();var pie=r=>({_getAllIds(e){return e.reduce((t,n)=>{let a=n.walletIdentities.map(s=>s.walletId);return[...t,n.keyringId,...a]},[])},_getKeyringIdentityWithWalletId(e){let{keyringIdentities:t}=r.store.getState();return t.find(a=>{let{walletIdentities:s}=a;return s.some(i=>i.walletId===e)})},getMnemonicWalletIdentities(e){let t=this._getKeyringIdentityWithWalletId(e);if(!t)throw new Error("can not get mnemonic walletIdentities with walletId");return t.walletIdentities},getWalletIdentities(){let{keyringIdentities:e}=r.store.getState();return o8(e)},getWalletIdentityMap(){let{keyringIdentities:e}=r.store.getState();return c8(e)},getWalletIdentityByWalletId(e){return r.getWalletIdentityMap()[e]},getServerWalletTypeByWalletId(e){return r.getWalletIdentityByWalletId(e)?.serverWalletType},getMpcIdentities(){let{keyringIdentities:e}=this.store.getState();return e.filter(t=>t.keyringIdentityType===ue.MPC)}}),HK=pie;d();f();var GK=_(te());var mie=r=>({updateKeyringIdentityName(e,t){let{keyringIdentities:n}=r.store.getState();n.forEach(a=>{a.keyringId===e&&(a.keyringName=t)}),r.store.updateState({keyringIdentities:n})},updateKeyringIdentityNameWithLocale(){let{keyringIdentities:e}=r.store.getState();e.forEach(t=>{t.keyringIdentityType===ue.PRIVATE_KEY&&(t.keyringName=r.translate("wallet_manage_wallet_top_private_key_default_name"))}),r.store.updateState({keyringIdentities:e})},updateWalletIdentityName(e,t){let{keyringIdentities:n}=r.store.getState();n.forEach(a=>{let{walletIdentities:s}=a;s.forEach(i=>{i.walletId===e&&(i.walletName=t)})}),r.store.updateState({keyringIdentities:n})},setSelectedWallet(e){let{selectedWallet:t,keyringIdentities:n}=r.store.getState();if(e===t)return;if(e===""?r.store.updateState({selectedWallet:""}):n.forEach(s=>{s.walletIdentities.forEach(i=>{i.walletId===e&&r.store.updateState({selectedWallet:e})})}),r.store.getState().selectedWallet!==e)throw new Error("can not set selectedWallet with walletId");r.walletConfigController.setWalletConfig("currentNetworkUniqueId","");let{isRpcMode:a}=r.walletConfigController.getWalletConfig();a&&r.clearDappData(),r.walletConfigController.setWalletConfig("isRpcMode",!1),r.emit("selectedWalletChange",e)},updateAllKeyringIdentities(e){let t=r.store.getState().keyringIdentities,n=r._getAllIds(t),a=r._getAllIds(e),s=n.sort(),i=a.sort();if(!(0,GK.isEqual)(s,i))throw new Error("can not update all keyringIdentities");r.store.updateState({keyringIdentities:e})},updateWalletIdentityAccount(e,t){let n=r.getWalletIdentityByWalletId(e);!n||!t||Object.entries(t).forEach(([a,s])=>{let i=n?.accountsMap[a][s].address;i&&(n.account[a]=i)})},updateWalletIdentityAddress(e,t,n){let a=r.getWalletIdentityByWalletId(e);!a||typeof t!="string"||typeof n!="string"||(a.account[t]=n)},updateOnekeyDeviceId(e){let{keyringIdentities:t}=r.store.getState(),n=t.map(a=>{if(Eo(a.initialType)){let{onekeyInfo:s}=a;if(rm(e,s)){let{walletIdentities:i}=a;return a.walletIdentities=i.map(o=>({...o,onekeyInfo:{...o.onekeyInfo,deviceId:e.deviceId}})),{...a,onekeyInfo:{...a.onekeyInfo,deviceId:e.deviceId}}}return a}return a});r.store.updateState({keyringIdentities:n})},updateMpcWalletIdentityStatus(e){let{keyringIdentities:t}=r.store.getState();t.forEach(n=>{n.keyringIdentityType===ue.MPC&&(n.status=e[n.keyringId])}),r.store.updateState({keyringIdentities:t})}}),zK=mie;var Th=class extends ge{constructor(e={}){super(),Vd(this,UK,HK,zK,FK,BK);let t={frequentRpcListDetail:[],accountTokens:{},accountHiddenTokens:{},assetImages:{},tokens:[],hiddenTokens:[],suggestedTokens:{},firstTimeFlowType:null,currentLocale:e.initLangCode,identities:{},lostIdentities:{},forgottenPassword:!1,completedOnboarding:!1,userUniqueId:Me(),walletIdentities:{},selectedWallet:"",keyringIdentities:[],...e.initState,preferences:{autoLockTimeLimit:D8.LEVEL_THREE,showFiatInTestnets:!0,useNativeCurrencyAsPrimaryCurrency:!0,defaultWallet:"HIJACK",completeGuide:!1,closeDefaultWalletPopup:!1,hideWithdraw:!0,hiddenAssets:!1,walletProtectionLevel:l0.LOW,sidepanelMode:!1,hiddenSmallAssets:!1,...e.initState?.preferences}};t.preferences.sidepanelAvailable=this.checkSidepanelAbility(),this.network=e.network,this.keyring=e.keyring,this.clearDappData=e.clearDappData,this.store=new jK.ObservableStore(t),this.store.setMaxListeners(12),this.openPopup=e.openPopup,this.localeMessages={},this.keyringIdentityMap={},this.walletIdentityMap={},this.walletConfigController=e.walletConfigController,Tl(t.currentLocale||e.initLangCode),_o(t.currentLocale||e.initLangCode,globalThis),_o(t.currentLocale||e.initLangCode,globalThis),this.updateLocaleMessages(),this._subscribeToNetworkDidChange(),this.updateWalletIdentityMap(t.keyringIdentities),this.store.subscribe(n=>this.updateWalletIdentityMap(n?.keyringIdentities)),setInterval(()=>{this.getMpcStatus()},30*1e3)}async getMpcStatus(){let{keyringIdentities:e}=this.store.getState(),t=e.filter(n=>n.keyringIdentityType===ue.MPC);if(t.length>0){let n=t.map(a=>a.keyringId);Promise.all(t.map(async a=>{let s=a?.walletIdentities?.[0]||{};return a.mpcId?a.mpcId:await this.keyring.getMpcIdByWalletId(s.walletId)})).then(async a=>{let{data:s}=await a5(a.map(o=>({mpcId:o}))),i={};n.forEach((o,c)=>{let{mpcStatus:l,accountStatus:u}=(s||[]).find(h=>h.mpcId===a[c])||{mpcStatus:Fl.INIT,accountStatus:Ul.NORMAL};i[o]={mpcStatus:l,accountStatus:u}}),this.updateMpcWalletIdentityStatus(i)}).catch(()=>{let a={};n.forEach(s=>{a[s]={mpcStatus:Fl.INIT,accountStatus:Ul.NORMAL}}),this.updateMpcWalletIdentityStatus(a)})}}updateWalletIdentityMap(e=[]){if(!e.length){this.keyringIdentityMap={},this.walletIdentityMap={};return}let t={},n={};e.forEach(({walletIdentities:a,...s})=>{let i=s.keyringId;t[i]=s,a.forEach(o=>{let c=o.walletId;n[c]={keyringId:i,walletIdentity:o}})}),this.keyringIdentityMap=t,this.walletIdentityMap=n}getAllWalletIdentityMap(){let e=this.keyringIdentityMap,t=this.walletIdentityMap;return{keyringIdentityMap:e,walletIdentityMap:t}}setPasswordForgotten(e){this.store.updateState({forgottenPassword:e})}setFirstTimeFlowType(e){this.store.updateState({firstTimeFlowType:e})}getSuggestedTokens(){return this.store.getState().suggestedTokens}getAssetImages(){return this.store.getState().assetImages}getUserUniqueId(){let{userUniqueId:e}=this.store.getState();return e||(e=Me(),this.store.updateState({userUniqueId:e})),e}clearUserUniqueId(){this.store.updateState({userUniqueId:""})}async requestWatchAsset(e){let{type:t,options:n}=e.params,a=this.getSelectedWallet(),s=this.getWalletIdentityByWalletId(a);switch(t){case"ERC20":if(s?.account?.[J])return this._handleWatchAssetERC20(n);throw Ks.ethErrors.rpc.invalidParams("Can't WatchAsset for current wallet");default:throw Ks.ethErrors.rpc.invalidParams(`Asset of type "${t}" not supported.`)}}async updateLocaleMessages(e){if(!e){let{currentLocale:t}=this.store.getState();e=t}this.localeMessages=await Ba(e)}translate(e,t){let{currentLocale:n}=this.store.getState();try{return Fc(n,this.localeMessages,e,t)}catch(a){VK.default.error(a)}return null}async setCurrentLocale(e){let t=cA.includes(e)?"rtl":"ltr";return await this.updateLocaleMessages(e),this.store.updateState({currentLocale:e,textDirection:t}),Tl(e),_o(e,globalThis),_o(e,globalThis),this.updateKeyringIdentityNameWithLocale(),t}setAddresses(e){let t=this.store.getState().identities,n=this.store.getState().accountTokens,a=this.store.getState().accountHiddenTokens,s=e.reduce((c,l,u)=>{let h=t[l]||{};return c[l]={name:`Account ${u+1}`,address:l,...h},c},{}),i=e.reduce((c,l)=>{let u=n[l]||{};return c[l]=u,c},{}),o=e.reduce((c,l)=>{let u=a[l]||{};return c[l]=u,c},{});this.store.updateState({identities:s,accountTokens:i,accountHiddenTokens:o})}removeAddress(e){let{identities:t,accountTokens:n,accountHiddenTokens:a}=this.store.getState();if(!t[e])throw new Error(`${e} can't be deleted cause it was not found`);if(delete t[e],delete n[e],delete a[e],this.store.updateState({identities:t,accountTokens:n,accountHiddenTokens:a}),e===this.getSelectedAddress()){let s=Object.keys(t)[0];this.setSelectedAddress(s)}return e}addAddresses(e){let{identities:t,accountTokens:n,accountHiddenTokens:a}=this.store.getState();e.forEach(s=>{if(t[s])return;let i=Object.keys(t).length;n[s]={},a[s]={},t[s]={name:`Account ${i+1}`,address:s}}),this.store.updateState({identities:t,accountTokens:n,accountHiddenTokens:a})}syncAddresses(e){if(!Array.isArray(e)||e.length===0)throw new Error("Expected non-empty array of addresses.");let{identities:t,lostIdentities:n}=this.store.getState(),a={};Object.keys(t).forEach(i=>{e.includes(i)||(a[i]=t[i],delete t[i])}),Object.keys(a).length>0&&Object.keys(a).forEach(i=>{n[i]=a[i]}),this.store.updateState({identities:t,lostIdentities:n}),this.addAddresses(e);let s=this.getSelectedAddress();return e.includes(s)||(s=e[0],this.setSelectedAddress(s)),s}handleErc20Token(e,t){let n=this.getSuggestedTokens()||{},{[e]:a,...s}=n,i=Uo(e),o=t?qe.SUBMITTED:qe.REJECTED;this.emit(i,o),this.store.updateState({suggestedTokens:{...s}}),this.emit(nr)}setSelectedAddress(e){let t=(0,Bb.normalize)(e);this._updateTokens(t);let{identities:n,tokens:a}=this.store.getState(),s=n[t];if(!s)throw new Error(`Identity for '${t} not found`);return s.lastSelected=Date.now(),this.store.updateState({identities:n,selectedAddress:t}),Promise.resolve(a)}getSelectedAddress(){let e=this.getSelectedWallet();return this.getWalletIdentityMap()[e].account[J]}getOldSelectedAddress(){return this.store.getState().selectedAddress}getSelectedWallet(){return this.store.getState().selectedWallet}isPrivateWalletByWalletId(e){return this.getWalletIdentityMap()[e]?.initialType===$.SIMPLE_KEYRING}async addToken(e,t,n,a,s){let i=(0,Bb.normalize)(e),o={address:i,symbol:t,decimals:Number(n)};s&&(o.name=s);let{tokens:c,hiddenTokens:l}=this.store.getState(),u=this.getAssetImages(),h=l.filter(v=>v!==e.toLowerCase()),b=c.find(v=>v.address===i),y=c.indexOf(b);return b?c[y]=o:c.push(o),u[i]=a,this._updateAccountTokens(c,u,h),Promise.resolve(c)}removeToken(e){let{tokens:t,hiddenTokens:n}=this.store.getState(),a=this.getAssetImages(),s=t.filter(o=>o.address!==e),i=[...n,e.toLowerCase()];return delete a[e],this._updateAccountTokens(s,a,i),Promise.resolve(s)}getTokens(){return this.store.getState().tokens}setPreference(e,t,n=!0){let a=this.getPreferences();if(!n&&a[e]===t)return a;let s={...a,[e]:t};return this.store.updateState({preferences:s}),Promise.resolve(s)}getPreferences(){return this.store.getState().preferences}completeOnboarding(){return this.store.updateState({completedOnboarding:!0}),Promise.resolve(!0)}resetOnboarding(){return this.store.updateState({completedOnboarding:!1}),Promise.resolve(!0)}_subscribeToNetworkDidChange(){this.network.on(ac.NETWORK_DID_CHANGE,()=>{let{tokens:e,hiddenTokens:t}=this._getTokenRelatedStates();this._updateAccountTokens(e,this.getAssetImages(),t)})}_updateAccountTokens(e,t,n){let{accountTokens:a,chainId:s,selectedAddress:i,accountHiddenTokens:o}=this._getTokenRelatedStates();a[i][s]=e,o[i][s]=n,this.store.updateState({accountTokens:a,tokens:e,assetImages:t,accountHiddenTokens:o,hiddenTokens:n})}_updateTokens(e){let{tokens:t,hiddenTokens:n}=this._getTokenRelatedStates(e);this.store.updateState({tokens:t,hiddenTokens:n})}_getTokenRelatedStates(e){let{accountTokens:t,accountHiddenTokens:n}=this.store.getState();e||(e=this.store.getState().selectedAddress);let a=this.network.getCurrentChainId();e in t||(t[e]={}),e in n||(n[e]={}),a in t[e]||(t[e][a]=[]),a in n[e]||(n[e][a]=[]);let s=t[e][a],i=n[e][a];return{tokens:s,accountTokens:t,hiddenTokens:i,accountHiddenTokens:n,chainId:a,selectedAddress:e}}async _handleWatchAssetERC20(e){this._validateERC20AssetParams(e);let t=(0,Bb.normalize)(e.address),{symbol:n,decimals:a,image:s}=e;return this._addSuggestedERC20Asset(t,n,a,s),await this.openPopup(),new Promise((i,o)=>{let c=Uo(t);this.once(c,l=>{switch(l){case qe.SUBMITTED:i(!0);break;default:o(Ks.ethErrors.provider.userRejectedRequest({message:"Request Signature: User denied request signature."}));return}})})}_validateERC20AssetParams({address:e,symbol:t,decimals:n}){if(!e||!t||typeof n>"u")throw Ks.ethErrors.rpc.invalidParams("Must specify address, symbol, and decimals.");if(typeof t!="string")throw Ks.ethErrors.rpc.invalidParams("Invalid symbol: not a string.");if(!(t.length>0))throw Ks.ethErrors.rpc.invalidParams(`Invalid symbol "${t}": shorter than a character.`);let a=parseInt(n,10);if(isNaN(a)||a>36||a<0)throw Ks.ethErrors.rpc.invalidParams(`Invalid decimals "${n}": must be 0 <= 36.`);if(!No(e,{allowNonPrefixed:!1}))throw Ks.ethErrors.rpc.invalidParams(`Invalid address "${e}".`)}_addSuggestedERC20Asset(e,t,n,a){let s={address:e,symbol:t,decimals:n,image:a,time:new Date().getTime()},i=this.getSuggestedTokens();i[e]=s,this.store.updateState({suggestedTokens:i}),this.emit(nr)}get suggestedTokensCount(){return Object.keys(this.getSuggestedTokens()).length}checkSidepanelAbility(){return!(!chrome.sidePanel||!chrome.sidePanel.setOptions||!chrome.sidePanel.getOptions||!chrome.sidePanel.setPanelBehavior)}};d();f();Be();var $K=_(Gn()),q2=_(te());ae();var U2=class extends ge{constructor(e={}){super(),this.keyringController=e.keyringController,this.authController=e.authController,this.preferencesController=e.preferencesController,this.publishTransactionToServer=e.publishTransactionToServer,this.handleSignParamsMap={},this.handleSignedMap={[J]:this.getEthereumSignedParams.bind(this)}}async publishTransferTransaction({publishParams:e}){return await this.publishTransactionToServer({publishParams:{...e,txSource:fe.NORMAL}})}async getEthereumSignedParams(e){typeof e!="string"&&(e=(0,$K.bufferToHex)(e.serialize()));let t=await je(J,e);return{signedTx:e,txHash:t}}async getEthereumSignedTx({signParams:e,from:t,baseChain:n}){let a=this.handleSignParamsMap[n],s=(0,q2.isFunction)(a)?await a(e):e,i;return s.result?i=s.result.rawTxResult:i=await this.keyringController.signTransaction(s,t,n,e?.walletId),i}async getEthereumPublishParams({signedTx:e,baseChain:t,publishParams:n}){let a=this.handleSignedMap[t],s=(0,q2.isFunction)(a)?await a(e):{signedTx:e};return{...n,...s}}async signAndGetEthereumPublishParams({signParams:e,from:t,baseChain:n,publishParams:a}){let s=await this.getEthereumSignedTx({signParams:e,from:t,baseChain:n});return await this.getEthereumPublishParams({signedTx:s,baseChain:n,publishParams:a})}async signAndPublishTransferTransaction({signParams:e,from:t,baseChain:n,publishParams:a}){let s=await this.signAndGetEthereumPublishParams({signParams:e,from:t,baseChain:n,publishParams:a});return await this.publishTransferTransaction({publishParams:s})}},YK=U2;d();f();Be();var rq=_(Ne()),If=_(tq()),z2=class extends ge{constructor(e){super();let t={rpcEvmChainTokens:[],rpcEvmChainTokenPrice:{},rpcEvmChainTokenBalance:{},...e.initState};this.store=new rq.ObservableStore(t)}addChainToken(e){let t=this.store.getState().rpcEvmChainTokens;if(!t.find(({chainId:a,account:s,address:i,rpcUrl:o})=>{let c=e.chainId===a&&e.account===s&&e.address===i;return e.address||(c=c&&o===e.rpcUrl),c})){let a=(0,If.default)(t,{$push:[e]});return this.store.updateState({rpcEvmChainTokens:a}),!0}return!1}updateChainToken(e){let{rpcUrl:t,chainId:n,account:a,address:s,...i}=e,o=this.store.getState().rpcEvmChainTokens,c=o.findIndex(u=>{let h=u.chainId===n&&u.address===s;return s||(h=h&&u.rpcUrl===t),a?h&&u.account===a:h}),l=(0,If.default)(o,{[c]:{$merge:i}});this.store.updateState({rpcEvmChainTokens:l})}updateChainTokenPrice(e){let{chainId:t,address:n,price:a}=e,s=this.store.getState().rpcEvmChainTokenPrice;s[t]||Object.assign(s,{[t]:{}});let i=n?{[n]:a}:{price:a},o=(0,If.default)(s,{[t]:{$merge:i}});this.store.updateState({rpcEvmChainTokenPrice:o})}updateChainTokenBalance(e){let{chainId:t,address:n,account:a,balance:s}=e,i=this.store.getState().rpcEvmChainTokenBalance;i[a]||Object.assign(i,{[a]:{[t]:{}}}),i[a][t]||Object.assign(i[a],{[t]:{}});let o=(0,If.default)(i[a][t]||{},{$merge:n?{[n]:s}:{balance:s}}),c=(0,If.default)(i,{[a]:{[t]:{$merge:o}}});this.store.updateState({rpcEvmChainTokenBalance:c})}},nq=z2;d();f();Be();var aq=_(Ne()),Kb=_(te());An();Ge();var sq=r=>{if(!r)return;let{id:e,type:t,status:n,createTime:a,txPool:s,isCanceling:i,isSpeeding:o,extraParams:c}=r,{approvedAmount:l,coinSymbol:u,tokenAddress:h,approvedAddress:b,value:y,toAddress:v}=c||{};return{id:e,type:t,status:n,createTime:a,isCanceling:i,isSpeeding:o,txPool:s?.map(sq),extraParams:(0,Kb.omitBy)({approvedAmount:l,coinSymbol:u,tokenAddress:h,approvedAddress:b,value:y,toAddress:v},Kb.isNil)}};function j2(r,e){if(!e?.txParams)try{Ae.captureEvent({message:"API_ERROR_evm_rpc_empty_params",contexts:{report:{info:JSON.stringify({type:r,transaction:sq(e)})}},exception:{values:[{type:"API_ERROR_evm_rpc_empty_params"}]},level:"info"})}catch{}}var V2={ADD:"add",UPDATE:"update",CONFIRM:"confirm"},$2=class extends ge{constructor(e){super();let t={rpcEvmTransactions:{},...e.initState};this.store=new aq.ObservableStore(t)}addTransaction(e){let t=this.store.getState().rpcEvmTransactions;return t[e.id]=e,j2(V2.ADD,e),this.store.updateState({rpcEvmTransactions:t}),e}updateTransaction(e){let t=this.store.getState().rpcEvmTransactions,{txId:n,tx:a}=e;if(a&&(t[n]||a.txParams)){let s={...t[n]||{},...a,extraParams:{...t[n]?.extraParams||{},...a.extraParams||{}}};t[n]=s,j2(V2.UPDATE,s)}return this.store.updateState({rpcEvmTransactions:t}),t[n]}confirmTransaction(e){let t=this.store.getState().rpcEvmTransactions,{txId:n,replaceTxId:a,tx:s,checkPoolEmpty:i}=e,o=t[n],c;if(o){if(a&&n!==a){let l=o.txPool.find(({id:u})=>u===a);l&&(c=l)}else(!i||o?.txPool?.length===0)&&(c=o);if(c&&c.status===nm.PENDING){let l={...c,...s||{},extraParams:{...c.extraParams||{},...s.extraParams||{}},id:n,txPool:[],isCanceling:!1,isSpeeding:!1};t[n]=l,j2(V2.CONFIRM,l),this.store.updateState({rpcEvmTransactions:t})}}return t[n]}findTransaction(e){return this.store.getState().rpcEvmTransactions[e]}async publishTransaction({txId:e,rawTx:t}){let{rpcUrl:n}=await _f("rpc_info"),a=await c5(n);return new Promise(s=>{a.eth.currentProvider.send({method:"eth_sendRawTransaction",params:[t],jsonrpc:"2.0",id:Me()},async(i,o)=>{if(o?.error||i){let c=o?.error?.message||i?.message,l=await this.confirmTransaction({txId:e,tx:{status:nm.DROPPED,finishTime:+new Date,errorMessage:c},checkPoolEmpty:!0});s({error:o?.error||i,tx:l})}else{let c=await this.updateTransaction({txId:e,tx:{sendTime:+new Date}});s({data:o,tx:c})}})})}clearPendingTransaction(){let e=this.store.getState().rpcEvmTransactions,t={};Object.keys(e).forEach(n=>{e[n].status!==nm.PENDING&&(t[n]=e[n])}),this.store.updateState({rpcEvmTransactions:t})}},iq=$2;d();f();var oq=_(Ne()),qb=_(te()),cq=_(Pr());ur();var Cie=Object.values(E9).map(r=>({channel:r})),Eh=class extends cq.default{constructor({preferencesController:e,keyringController:t,coinController:n,balanceController:a,unlockListener:s,lockListener:i,domainController:o}){super(),this.store=new oq.ObservableStore({}),this.preferencesController=e,this.domainController=o,this.keyringController=t,this.coinController=n,this.balanceController=a,this.unlockListener=s,this.lockListener=i,this.walletAddress=[],this.isUnlock=!1,this.isError=!1,this.unlockListener(async()=>{this.isUnlock=!0,await this.sendData()}),this.lockListener(()=>{this.isUnlock=!1,this.socketInstance.disconnect(),this.socketInstance=null,this.isLogin=!1}),this.on("wallet-coin",()=>{this.balanceController.getCurrentWalletBalance()}),this.on("wallet-asset",()=>{this.balanceController.getCurrentWalletBalance()}),this.on("wallet-nft",()=>{this.balanceController.getCurrentWalletBalance()}),this.domainController.on("wssDomainChanged",()=>{this.isError&&this.isUnlock&&(this.isError=!1,this._init())})}async _init(){await this._getCurrentWalletAddress(),this.socketInstance=new A9({connectUrl:ce.serverPushUrl}),this.socketInstance.onSocketConnected(()=>{this.loginAndSubscribe()}),this.socketInstance.setPushDataResolver(e=>this._dataResolver(e)),this.socketInstance.onPushDiscontinue(()=>{this.socketInstance.sendChannel("ping")}),this.socketInstance.connect(),this.socketInstance.onSocketError(()=>{this.isError=!0,this.socketInstance.disconnect()})}async _getCurrentWalletAddress(){let e=this.preferencesController.getSelectedWallet();if(!e)return null;let{accountMap:t,accountsMap:n}=await this.keyringController.getAccountInfoByWalletId(e),a=Object.values(t);return Object.values(n).forEach(s=>{Object.values(s).forEach(i=>{a.push(i.address)})}),this.walletAddress=(0,qb.uniq)(a),a}async sendData(){await this._getCurrentWalletAddress(),this.socketInstance?this.loginAndSubscribe():await this._init()}loginAndSubscribe(){!this.walletAddress.length||(this.once("login",()=>{this._sendMessage("subscribe",Cie)}),this._sendMessage("login",this.walletAddress.map(e=>({token:e}))))}_dataResolver(e){if(!e)return;let{event:t,arg:n={},data:a,code:s}=e;t==="login"&&s==="0"&&(this.emit("login"),this.isLogin=!0);let{channel:i}=n;i&&a&&(this.walletAddress.includes(a.address||(0,qb.get)(a,"data.address"))||i==="wallet-coin")&&this.emit(i,a)}_sendMessage(e,t){if(!this.socketInstance.isConnected())return;let n={op:e,args:t};this.socketInstance.sendChannel(JSON.stringify(n))}};d();f();var dq=_(Ne());Be();var Ph=class extends ge{constructor(t){super();let n={silence:{},...t.initState};this.store=new dq.ObservableStore(n)}addSilencePermission(t,n){let a=this.getSilenceByOrigin(t),s=a.findIndex(i=>i.chain===n.chain&&i.method===n.method);s>-1?a[s]=n:a.push(n),this.store.updateState({silence:{...this.getSilence(),[t]:a}})}removeSilencePermission(t,n){let a=this.getSilence();if(!n){delete a[t],this.store.updateState({silence:a});return}let i=this.getSilenceByOrigin(t).filter(o=>!Object.entries(n).every(([c,l])=>o[c]===l));this.store.updateState({silence:{...a,[t]:i}})}hasSilencePermission(t,n){return!!this.getSilenceByOrigin(t).find(s=>Object.entries(n).every(([i,o])=>s[i]===o)&&s.expireTime>Date.now())}getSilence(){return this.store.getState().silence}getSilenceByOrigin(t){return this.store.getState().silence[t]||[]}};d();f();var Tq=_(Ne()),Dh=_(Ce()),Lh=_(Gn()),i6=_(q_()),Iq=_(i$()),Yb=_(te()),cc=_(Fr()),Eq=_(Pr());d();f();var fq="transactionErrorNoContract";Ge();ae();ne();ur();Wt();Hn();d();f();ae();var Y2=r=>{let{networkType:e,txParams:t}=r,n=Mn(e),{to:a}=t||{};return{toAdr:a?.toLowerCase(),txSource:fe.NORMAL,coinId:n.coinId,coinAmount:0}},lq=r=>{let{txParams:e,coinId:t,decimalAmount:n}=r,{to:a}=e||{};return{toAdr:a?.toLowerCase(),txSource:fe.NORMAL,coinId:t,coinAmount:n}},uq=r=>{let{txParams:e,coinId:t,decimalAmount:n}=r,{data:a}=e||{};return{toAdr:Rl(a)?.args?.[0]?.toLowerCase()||"",txSource:fe.NORMAL,coinId:t,coinAmount:n}},hq=r=>{let{txParams:e,networkType:t}=r,{to:n,value:a}=e||{},s=Mn(t);return{toAdr:n?.toLowerCase(),txSource:fe.NORMAL,coinId:s.coinId,coinAmount:Number($e(a))}},pq=r=>{let{txParams:e,networkType:t}=r,{from:n}=e||{},a=Mn(t);return{toAdr:n?.toLowerCase(),txSource:fe.DAPP,coinId:a.coinId,coinAmount:0}},mq=(r,e)=>{let{networkType:t,txParams:n}=r,a=Mn(t),{to:s,value:i}=n||{},o=Sa(i)?0:Number($e(i));return{toAdr:s?.toLowerCase(),txSource:fe.NFT,coinId:a.coinId,coinAmount:o}},gq=async(r,e)=>{let{txParams:t,networkType:n}=r,{data:a,to:s}=t||{},i=Rl(a),o=i?.args?.[0]?.toLowerCase()||"",c=Mn(n),l=i?.args?._value,u=Number(l?.toString()),{coin:h}=await e(n,s);return{toAdr:o,txSource:fe.NORMAL,coinId:h?.coinId||c.coinId,coinAmount:u}},J2=r=>{let{networkType:e,txParams:t,extParams:n={}}=r,a=Mn(e),{to:s,value:i}=t||{},o=Sa(i)?0:Number($e(i)),{orderId:c,crossChain:l,chainId:u,tokenAddress:h,amount:b,toChainId:y,toTokenAddress:v="",txSource:S=fe.DAPP}=n,R={toAdr:s?.toLowerCase(),txSource:S,coinId:a.coinId,coinAmount:o};return c&&(R={...R,orderId:c,crossChain:l,chainId:u,tokenAddress:h,amount:b,toChainId:y,toTokenAddress:v}),R};d();f();var bq=_(q_()),yq=_(Fr()),xq=_(te());Ge();Hn();var Mh=class{constructor(e){this.query=new bq.default(e)}async analyzeGasUsage(e){let t=await this.query.getBlockByNumber("latest",!1),n=ti(t.gasLimit),a=S_(n,19,20),s=vo(a),i;try{s=await this.estimateTxGas(e)}catch(o){yq.default.warn(o),i={reason:o.message,errorKey:o.errorKey,debug:{blockNumber:t.number,blockGasLimit:t.gasLimit}}}return{blockGasLimit:t.gasLimit,estimatedGasHex:s,simulationFails:i}}async estimateTxGas(e){let t=(0,xq.cloneDeep)(e.txParams);return delete t.gasPrice,this.query.estimateGas(t)}addGasBuffer(e,t,n=1.5){let a=ti(e),s=ti(t),i=Nn(s,.9),o=Nn(a,n);return t0(a,i)?vo(a):e0(o,i)?vo(o):vo(i)}};d();f();var Aq=_(Ne()),Kn=_(te()),a6=_(Fr()),Cq=_(Pr());Ge();d();f();d();f();var X2={};yx(X2,{JsonPatchError:()=>fr,_areEquals:()=>kh,applyOperation:()=>oc,applyPatch:()=>Vb,applyReducer:()=>Mie,deepClone:()=>Eie,getValueByPointer:()=>zb,validate:()=>vq,validator:()=>jb});d();f();d();f();var Tie=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Iie=Object.prototype.hasOwnProperty;function Fb(r,e){return Iie.call(r,e)}function Hb(r){if(Array.isArray(r)){for(var e=new Array(r.length),t=0;t<e.length;t++)e[t]=""+t;return e}if(Object.keys)return Object.keys(r);var n=[];for(var a in r)Fb(r,a)&&n.push(a);return n}function Zr(r){switch(typeof r){case"object":return JSON.parse(JSON.stringify(r));case"undefined":return null;default:return r}}function Gb(r){for(var e=0,t=r.length,n;e<t;){if(n=r.charCodeAt(e),n>=48&&n<=57){e++;continue}return!1}return!0}function ts(r){return r.indexOf("/")===-1&&r.indexOf("~")===-1?r:r.replace(/~/g,"~0").replace(/\//g,"~1")}function Nh(r){return r.replace(/~1/g,"/").replace(/~0/g,"~")}function Ub(r){if(r===void 0)return!0;if(r){if(Array.isArray(r)){for(var e=0,t=r.length;e<t;e++)if(Ub(r[e]))return!0}else if(typeof r=="object"){for(var n=Hb(r),a=n.length,s=0;s<a;s++)if(Ub(r[n[s]]))return!0}}return!1}function wq(r,e){var t=[r];for(var n in e){var a=typeof e[n]=="object"?JSON.stringify(e[n],null,2):e[n];typeof a<"u"&&t.push(n+": "+a)}return t.join(`
`)}var Rh=function(r){Tie(e,r);function e(t,n,a,s,i){var o=this.constructor,c=r.call(this,wq(t,{name:n,index:a,operation:s,tree:i}))||this;return c.name=n,c.index=a,c.operation=s,c.tree=i,Object.setPrototypeOf(c,o.prototype),c.message=wq(t,{name:n,index:a,operation:s,tree:i}),c}return e}(Error);var fr=Rh,Eie=Zr,Ef={add:function(r,e,t){return r[e]=this.value,{newDocument:t}},remove:function(r,e,t){var n=r[e];return delete r[e],{newDocument:t,removed:n}},replace:function(r,e,t){var n=r[e];return r[e]=this.value,{newDocument:t,removed:n}},move:function(r,e,t){var n=zb(t,this.path);n&&(n=Zr(n));var a=oc(t,{op:"remove",path:this.from}).removed;return oc(t,{op:"add",path:this.path,value:a}),{newDocument:t,removed:n}},copy:function(r,e,t){var n=zb(t,this.from);return oc(t,{op:"add",path:this.path,value:Zr(n)}),{newDocument:t}},test:function(r,e,t){return{newDocument:t,test:kh(r[e],this.value)}},_get:function(r,e,t){return this.value=r[e],{newDocument:t}}},Pie={add:function(r,e,t){return Gb(e)?r.splice(e,0,this.value):r[e]=this.value,{newDocument:t,index:e}},remove:function(r,e,t){var n=r.splice(e,1);return{newDocument:t,removed:n[0]}},replace:function(r,e,t){var n=r[e];return r[e]=this.value,{newDocument:t,removed:n}},move:Ef.move,copy:Ef.copy,test:Ef.test,_get:Ef._get};function zb(r,e){if(e=="")return r;var t={op:"_get",path:e};return oc(r,t),t.value}function oc(r,e,t,n,a,s){if(t===void 0&&(t=!1),n===void 0&&(n=!0),a===void 0&&(a=!0),s===void 0&&(s=0),t&&(typeof t=="function"?t(e,0,r,e.path):jb(e,0)),e.path===""){var i={newDocument:r};if(e.op==="add")return i.newDocument=e.value,i;if(e.op==="replace")return i.newDocument=e.value,i.removed=r,i;if(e.op==="move"||e.op==="copy")return i.newDocument=zb(r,e.from),e.op==="move"&&(i.removed=r),i;if(e.op==="test"){if(i.test=kh(r,e.value),i.test===!1)throw new fr("Test operation failed","TEST_OPERATION_FAILED",s,e,r);return i.newDocument=r,i}else{if(e.op==="remove")return i.removed=r,i.newDocument=null,i;if(e.op==="_get")return e.value=r,i;if(t)throw new fr("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,e,r);return i}}else{n||(r=Zr(r));var o=e.path||"",c=o.split("/"),l=r,u=1,h=c.length,b=void 0,y=void 0,v=void 0;for(typeof t=="function"?v=t:v=jb;;){if(y=c[u],y&&y.indexOf("~")!=-1&&(y=Nh(y)),a&&(y=="__proto__"||y=="prototype"&&u>0&&c[u-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(t&&b===void 0&&(l[y]===void 0?b=c.slice(0,u).join("/"):u==h-1&&(b=e.path),b!==void 0&&v(e,0,r,b)),u++,Array.isArray(l)){if(y==="-")y=l.length;else{if(t&&!Gb(y))throw new fr("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,e,r);Gb(y)&&(y=~~y)}if(u>=h){if(t&&e.op==="add"&&y>l.length)throw new fr("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,e,r);var i=Pie[e.op].call(e,l,y,r);if(i.test===!1)throw new fr("Test operation failed","TEST_OPERATION_FAILED",s,e,r);return i}}else if(u>=h){var i=Ef[e.op].call(e,l,y,r);if(i.test===!1)throw new fr("Test operation failed","TEST_OPERATION_FAILED",s,e,r);return i}if(l=l[y],t&&u<h&&(!l||typeof l!="object"))throw new fr("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",s,e,r)}}}function Vb(r,e,t,n,a){if(n===void 0&&(n=!0),a===void 0&&(a=!0),t&&!Array.isArray(e))throw new fr("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");n||(r=Zr(r));for(var s=new Array(e.length),i=0,o=e.length;i<o;i++)s[i]=oc(r,e[i],t,!0,a,i),r=s[i].newDocument;return s.newDocument=r,s}function Mie(r,e,t){var n=oc(r,e);if(n.test===!1)throw new fr("Test operation failed","TEST_OPERATION_FAILED",t,e,r);return n.newDocument}function jb(r,e,t,n){if(typeof r!="object"||r===null||Array.isArray(r))throw new fr("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,r,t);if(Ef[r.op]){if(typeof r.path!="string")throw new fr("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,r,t);if(r.path.indexOf("/")!==0&&r.path.length>0)throw new fr('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,r,t);if((r.op==="move"||r.op==="copy")&&typeof r.from!="string")throw new fr("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,r,t);if((r.op==="add"||r.op==="replace"||r.op==="test")&&r.value===void 0)throw new fr("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,r,t);if((r.op==="add"||r.op==="replace"||r.op==="test")&&Ub(r.value))throw new fr("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,r,t);if(t){if(r.op=="add"){var a=r.path.split("/").length,s=n.split("/").length;if(a!==s+1&&a!==s)throw new fr("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,r,t)}else if(r.op==="replace"||r.op==="remove"||r.op==="_get"){if(r.path!==n)throw new fr("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,r,t)}else if(r.op==="move"||r.op==="copy"){var i={op:"_get",path:r.from,value:void 0},o=vq([i],t);if(o&&o.name==="OPERATION_PATH_UNRESOLVABLE")throw new fr("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,r,t)}}}else throw new fr("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,r,t)}function vq(r,e,t){try{if(!Array.isArray(r))throw new fr("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)Vb(Zr(e),Zr(r),t||!0);else{t=t||jb;for(var n=0;n<r.length;n++)t(r[n],n,e,void 0)}}catch(a){if(a instanceof fr)return a;throw a}}function kh(r,e){if(r===e)return!0;if(r&&e&&typeof r=="object"&&typeof e=="object"){var t=Array.isArray(r),n=Array.isArray(e),a,s,i;if(t&&n){if(s=r.length,s!=e.length)return!1;for(a=s;a--!==0;)if(!kh(r[a],e[a]))return!1;return!0}if(t!=n)return!1;var o=Object.keys(r);if(s=o.length,s!==Object.keys(e).length)return!1;for(a=s;a--!==0;)if(!e.hasOwnProperty(o[a]))return!1;for(a=s;a--!==0;)if(i=o[a],!kh(r[i],e[i]))return!1;return!0}return r!==r&&e!==e}var t6={};yx(t6,{compare:()=>Wie,generate:()=>Z2,observe:()=>Bie,unobserve:()=>Lie});d();f();var Q2=new WeakMap,Nie=function(){function r(e){this.observers=new Map,this.obj=e}return r}(),Rie=function(){function r(e,t){this.callback=e,this.observer=t}return r}();function kie(r){return Q2.get(r)}function Oie(r,e){return r.observers.get(e)}function Die(r,e){r.observers.delete(e.callback)}function Lie(r,e){e.unobserve()}function Bie(r,e){var t=[],n,a=kie(r);if(!a)a=new Nie(r),Q2.set(r,a);else{var s=Oie(a,e);n=s&&s.observer}if(n)return n;if(n={},a.value=Zr(r),e){n.callback=e,n.next=null;var i=function(){Z2(n)},o=function(){clearTimeout(n.next),n.next=setTimeout(i)};typeof window<"u"&&(window.addEventListener("mouseup",o),window.addEventListener("keyup",o),window.addEventListener("mousedown",o),window.addEventListener("keydown",o),window.addEventListener("change",o))}return n.patches=t,n.object=r,n.unobserve=function(){Z2(n),clearTimeout(n.next),Die(a,n),typeof window<"u"&&(window.removeEventListener("mouseup",o),window.removeEventListener("keyup",o),window.removeEventListener("mousedown",o),window.removeEventListener("keydown",o),window.removeEventListener("change",o))},a.observers.set(e,new Rie(e,n)),n}function Z2(r,e){e===void 0&&(e=!1);var t=Q2.get(r.object);e6(t.value,r.object,r.patches,"",e),r.patches.length&&Vb(t.value,r.patches);var n=r.patches;return n.length>0&&(r.patches=[],r.callback&&r.callback(n)),n}function e6(r,e,t,n,a){if(e!==r){typeof e.toJSON=="function"&&(e=e.toJSON());for(var s=Hb(e),i=Hb(r),o=!1,c=!1,l=i.length-1;l>=0;l--){var u=i[l],h=r[u];if(Fb(e,u)&&!(e[u]===void 0&&h!==void 0&&Array.isArray(e)===!1)){var b=e[u];typeof h=="object"&&h!=null&&typeof b=="object"&&b!=null&&Array.isArray(h)===Array.isArray(b)?e6(h,b,t,n+"/"+ts(u),a):h!==b&&(o=!0,a&&t.push({op:"test",path:n+"/"+ts(u),value:Zr(h)}),t.push({op:"replace",path:n+"/"+ts(u),value:Zr(b)}))}else Array.isArray(r)===Array.isArray(e)?(a&&t.push({op:"test",path:n+"/"+ts(u),value:Zr(h)}),t.push({op:"remove",path:n+"/"+ts(u)}),c=!0):(a&&t.push({op:"test",path:n,value:r}),t.push({op:"replace",path:n,value:e}),o=!0)}if(!(!c&&s.length==i.length))for(var l=0;l<s.length;l++){var u=s[l];!Fb(r,u)&&e[u]!==void 0&&t.push({op:"add",path:n+"/"+ts(u),value:Zr(e[u])})}}}function Wie(r,e,t){t===void 0&&(t=!1);var n=[];return e6(r,e,n,"",t),n}var r6=Object.assign({},X2,t6,{JsonPatchError:Rh,deepClone:Zr,escapePathComponent:ts,unescapePathComponent:Nh});var n6=_(te());function Sq(r,e,t){let n=r6.compare(r,e);return n[0]&&(t&&(n[0].note=t),n[0].timestamp=Date.now()),n}function _q(r){return(0,n6.cloneDeep)(r).reduce((t,n)=>r6.applyPatch(t,n).newDocument)}function $b(r){let e={...r};return delete e.history,(0,n6.cloneDeep)(e)}var Oh=class extends Cq.default{constructor({initState:e,txHistoryLimit:t,getNetwork:n,getCurrentChainId:a,getVersion:s}){super(),this.store=new Aq.ObservableStore({transactions:{},...e}),this.txHistoryLimit=t,this.getNetwork=n,this.getCurrentChainId=a,this.getVersion=s}generateTxMeta(e){let t=this.getNetwork(),n=this.getCurrentChainId();if(t==="loading")throw new Error("OKX Wallet is having trouble connecting to the network");return{id:rn(),time:new Date().getTime(),status:Oe.UNAPPROVED,metamaskNetworkId:t,chainId:n,loadingDefaults:!0,networkType:"",walletVersion:this.getVersion(),...e}}getUnapprovedTxList(){let e=this.getCurrentChainId(),t=this.getNetwork();return(0,Kn.pickBy)(this.store.getState().transactions,n=>n.status===Oe.UNAPPROVED&&x0(n,e,t))}getApprovedTransactions(e){let t={status:Oe.APPROVED};return e&&(t.from=e),this.getTransactions({searchCriteria:t})}getPendingTransactions(e){let t={status:Oe.SUBMITTED};return e&&(t.from=e),this.getTransactions({searchCriteria:t})}getConfirmedTransactions(e){let t={status:Oe.CONFIRMED};return e&&(t.from=e),this.getTransactions({searchCriteria:t})}resetTransaction(e){let n=this.getTransaction(e)?.history?.[0];if(!n){this.setTxStatusUnapproved(e);return}n.history=[];let a=$b(n);n.history.push(a),this.store.updateState({transactions:{...this.store.getState().transactions,[e]:n}})}addTransaction(e){e.txParams&&(e.txParams=Z1(e.txParams,!1,e.networkType)),this.once(`${e.id}:signed`,()=>{this.removeAllListeners(`${e.id}:rejected`)}),this.once(`${e.id}:rejected`,()=>{this.removeAllListeners(`${e.id}:signed`)}),e.history=[];let t=$b(e);e.history.push(t);let n=this.getTransactions({filterToCurrentNetwork:!1}),{txHistoryLimit:a}=this,s=new Set,i=n.reverse().filter(o=>{let{nonce:c}=o.txParams,{chainId:l,metamaskNetworkId:u,status:h}=o,b=`${c}-${l??u}`;return s.has(b)?!1:s.size<a-1||Pk().includes(h)===!1?(s.add(b),!1):!0}).map(o=>o.id);return this._deleteTransactions(i),this._addTransactionsToState([e]),e}getTransaction(e){let{transactions:t}=this.store.getState();return t[e]}updateTransaction(e,t){e.txParams&&(e.txParams=Z1(e.txParams,!1,e.networkType));let n=$b(e),a=_q(e.history),s=Sq(a,n,t);s.length&&e.history.push(s);let i=e.id;this.store.updateState({transactions:{...this.store.getState().transactions,[i]:e}})}getTransactions({searchCriteria:e={},initialList:t,filterToCurrentNetwork:n=!0,limit:a}={}){let s=this.getCurrentChainId(),i=this.getNetwork(),o=(0,Kn.mapValues)(e,u=>typeof u=="function"?u:h=>h===u),c=t?(0,Kn.keyBy)(t,"id"):this.store.getState().transactions,l=(0,Kn.sortBy)((0,Kn.pickBy)(c,u=>{if(n&&x0(u,s,i)===!1)return!1;for(let[h,b]of Object.entries(o))if(h in u.txParams){if(b(u.txParams[h])===!1)return!1}else if(b(u[h])===!1)return!1;return!0}),"time");if(a!==void 0){let u=new Set,h=[];for(let b=l.length-1;b>-1;b--){let y=l[b],{nonce:v}=y.txParams;if(!u.has(v))if(u.size<a)u.add(v);else continue;h.unshift(y)}return h}return l}getAllTransactions(){let{transactions:e}=this.store.getState();return(0,Kn.keyBy)(e,"hash")}setTxStatusRejected(e){this._setTransactionStatus(e,"rejected"),this._deleteTransaction(e)}setTxStatusUnapproved(e){this._setTransactionStatus(e,Oe.UNAPPROVED)}setTxStatusApproved(e){this._setTransactionStatus(e,Oe.APPROVED)}setTxStatusSigned(e){this._setTransactionStatus(e,Oe.SIGNED)}setTxStatusSubmitted(e){let t=this.getTransaction(e);t.submittedTime=new Date().getTime(),this.updateTransaction(t,"txStateManager - add submitted time stamp"),this._setTransactionStatus(e,Oe.SUBMITTED)}setTxStatusConfirmed(e){this._setTransactionStatus(e,Oe.CONFIRMED)}setTxStatusDropped(e){this._setTransactionStatus(e,Oe.DROPPED)}setTxStatusFailed(e,t){let n=t||new Error("Internal OKX Wallet failure"),a=this.getTransaction(e);a.err={message:n.toString(),rpc:n.value,stack:n.stack},this.updateTransaction(a,"transactions:tx-state-manager#fail - add error"),this._setTransactionStatus(e,Oe.FAILED)}wipeTransactions(e){let{transactions:t}=this.store.getState(),n=this.getNetwork(),a=this.getCurrentChainId();this.store.updateState({transactions:(0,Kn.omitBy)(t,s=>s.txParams.from===e&&x0(s,a,n))})}clearUnapprovedTxs(){let{transactions:e}=this.store.getState();try{let t=Object.values(e).reduce((n,a)=>{if(a.status===Oe.UNAPPROVED){let s={networkType:a?.networkType,from:a?.txParams?.from,to:a?.txParams?.to,data:a?.txParams?.data};return this.setTxStatusRejected(a.id),[...n,s]}return n},[]);t.length&&ri({txInfos:t})}catch(t){a6.default.error(t)}this.store.updateState({transactions:(0,Kn.omitBy)(this.store.getState().transactions,t=>t.status===Oe.UNAPPROVED)})}_setTransactionStatus(e,t){let n=this.getTransaction(e);if(!!n){n.status=t;try{this.updateTransaction(n,`txStateManager: setting status to ${t}`),this.emit(`${n.id}:${t}`,e),this.emit("tx:status-update",e,t),[Oe.SUBMITTED,Oe.REJECTED,Oe.FAILED].includes(t)&&this.emit(`${n.id}:finished`,n),this.emit(nr)}catch(a){a6.default.error(a)}}}_addTransactionsToState(e){this.store.updateState({transactions:e.reduce((t,n)=>(t[n.id]=n,t),this.store.getState().transactions)})}_deleteTransaction(e){let{transactions:t}=this.store.getState();delete t[e],this.store.updateState({transactions:t})}_deleteTransactions(e){let{transactions:t}=this.store.getState();e.forEach(n=>{delete t[n]}),this.store.updateState({transactions:t})}};var s6="0x5208",Kie="0x186a0",qie=100,Bh=class extends Eq.default{constructor(e){super(),this.network=e.network||"",this._getCurrentChainId=e.getCurrentChainId,this._getWeb3Provider=e.getWeb3Provider,this.preferencesController=e.preferencesController,this.authController=e.authController,this.provider=e.provider,this.getPermittedAccounts=e.getPermittedAccounts,this.blockTracker=e.blockTracker,this.getSignKeyring=e.getSignKeyring,this.getKeyringByWalletId=e.getKeyringByWalletId,this.dappReportController=e.dappReportController,this.inProcessOfSigning=new Set,this.coinController=e.coinController,this._getParticipateInMetrics=e.getParticipateInMetrics,this.memStore=new Tq.ObservableStore({}),this.query=new i6.default(this.provider),this.txGasUtil=new Mh(this.provider),this._mapMethods(),this.txStateManager=new Oh({initState:e.initState,txHistoryLimit:e.txHistoryLimit,getNetwork:this.getNetwork.bind(this),getCurrentChainId:e.getCurrentChainId,getVersion:e.getVersion}),this._onBootCleanUp(),this.store=this.txStateManager.store,this.txStateManager.store.subscribe(()=>this.emit(nr)),this._setupListeners(),this._updateMemstore(),this.txStateManager.store.subscribe(()=>this._updateMemstore(!0)),this._updatePendingTxsAfterFirstBlock()}networkControllerProviderUpdate(){this._onBootCleanUp(),this._updateMemstore()}getCurrentWalletRequestHeaders(){let e=this.preferencesController.store.getState().selectedWallet;return this.authController.getRequestHeaders({walletId:e,needSign:!0,currency:"usd"})}getChainId(){let e=this.network,t=this._getCurrentChainId(),n=parseInt(t,16);return e==="loading"||Number.isNaN(n)?0:n}addTransaction(e){this.txStateManager.addTransaction(e),this.emit(`${e.id}:unapproved`,e)}wipeTransactions(e){this.txStateManager.wipeTransactions(e)}async newUnapprovedTransaction(e,{origin:t,connectionId:n,method:a}){cc.default.debug(`MetaMaskController newUnapprovedTransaction ${JSON.stringify(e)}`);let s=await this.addUnapprovedTransaction(e,{origin:t,connectionId:n,method:a}),{isOffline:i}=e;return new Promise((o,c)=>{this.txStateManager.once(`${s.id}:finished`,l=>{let{hash:u,oldTxHash:h,rawTx:b,extParams:y,serviceCharge:v,gasLimitInfo:S}=l;switch(this.dappReportController.updateReportTimestamp(s.id,"END_REQUEST"),l.status){case Oe.SUBMITTED:return o(i?{hash:u,oldTxHash:h,rawTx:b,serviceCharge:v,extParams:y,gasLimitInfo:S,...l.txParams}:l.hash);case Oe.REJECTED:return c(Ns(Dh.ethErrors.provider.userRejectedRequest("Tx Signature: User denied transaction signature.")));case Oe.FAILED:return c(Ns(Dh.ethErrors.rpc.internal(l.err.message)));default:return c(Ns(Dh.ethErrors.rpc.internal(`OKX Tx Signature: Unknown problem: ${JSON.stringify(l.txParams)}`)))}})})}async addUnapprovedTransaction(e,{origin:t,connectionId:n="",method:a},s=!0){let{networkType:i="",coinKey:o="",walletAddress:c="",coinId:l,coinAmount:u,decimalAmount:h,repeatTxType:b=0,oldTxHash:y="",extParams:v,isOffline:S=!1}=e,R=Lu(e);jo(R,i);let P=this.txStateManager.generateTxMeta({txParams:R,networkType:i,coinKey:o,walletAddress:c,coinId:l,coinAmount:u,decimalAmount:h,repeatTxType:b,oldTxHash:y,extParams:v,isOffline:S});if(this.dappReportController.updateReportTimestamp(P.id,"RECEIVE_REQUEST",{localType:i,method:a,address:R?.from}),t!=="metamask"&&!(await this.getPermittedAccounts(t)).includes(R.from))throw Dh.ethErrors.provider.unauthorized({data:{origin:t}});P.origin=t,P.connectionId=n;let{type:N}=await this._determineTransactionType(e);return P.type=N,P.txParams.value=P.txParams.value?gr(P.txParams.value):"0x0",this.addTransaction(P),s&&this.emit("newUnapprovedTx",P),P.loadingDefaults=!1,this.txStateManager.updateTransaction(P,"Added new unapproved transaction."),P}async addTxGasDefaults(e,t){let n=await this._getDefaultGasPrice(e),{gasLimit:a,simulationFails:s}=await this._getDefaultGasLimit(e,t);return e=this.txStateManager.getTransaction(e.id),s&&(e.simulationFails=s),n&&!e.txParams.gasPrice&&(e.txParams.gasPrice=n),a&&!e.txParams.gas&&(e.txParams.gas=a),e}async _getDefaultGasPrice(e){if(e.txParams.gasPrice)return;let t=await this.query.gasPrice();return gr(t.toString(16))}async _getDefaultGasLimit(e,t){if(e.txParams.gas)return{};if(e.txParams.to&&e.type===vs.SENT_ETHER){if(e.txParams.data){let o=new Error("TxGasUtil - Trying to call a function on a non-contract address");throw o.errorKey=fq,o.getCodeResponse=t,o}return{gasLimit:s6}}let{blockGasLimit:n,estimatedGasHex:a,simulationFails:s}=await this.txGasUtil.analyzeGasUsage(e);return{gasLimit:this.txGasUtil.addGasBuffer(gr(a),n),simulationFails:s}}async updateTransaction(e){this.txStateManager.updateTransaction(e,"confTx: user updated transaction")}async updateAndApproveTransaction(e){return this.txStateManager.updateTransaction(e,"confTx: user approved transaction"),await this.approveTransaction(e.id),e}async approveTransaction(e){if(!this.inProcessOfSigning.has(e)){this.inProcessOfSigning.add(e);try{this.txStateManager.setTxStatusApproved(e);let t=this.txStateManager.getTransaction(e);await this.checkAndUpdateParams(t),this.txStateManager.updateTransaction(t,"transactions#approveTransaction");let n=await this.signTransaction(e);await this.publishTransaction(e,n)}catch(t){if(l9(t.code))try{this.txStateManager.resetTransaction(e)}catch(n){cc.default.error(n)}else try{this.txStateManager.setTxStatusFailed(e,new Error(t.msg))}catch(n){cc.default.error(n)}try{let n=JSON.stringify(t);throw new Error(n)}catch{throw t}}finally{this.inProcessOfSigning.delete(e)}}}async createLedgerTxMeta(e){let{id:t}=e;try{if(t){let{networkType:n,txParams:a}=e;a.networkType=n,await this.checkAndUpdateParams(e);let s=this.getChainId();return a.chainId=s,a}return e}catch{return{}}}async checkAndUpdateParams(e){let{networkType:t,txParams:n}=e,{from:a,maxFeePerGas:s,maxPriorityFeePerGas:i,type:o,gasPrice:c,gas:l,nonce:u,data:h,to:b,value:y}=n,v=Mn(t);if(o===Nl.FEE_MARKET){if(Sa(s)||Sa(i)){let{info:{gasPrice:{suggestBaseFee:S,proposePriorityFee:R}}}=await this.getGasSignInfo(v.coinId,a);n.maxFeePerGas=ws(`${Fn(S,R)}`),n.maxPriorityFeePerGas=ws(`${i}`)}}else if(Sa(c)){let{info:{gasPrice:{normal:S}}}=await this.getGasSignInfo(v.coinId,a);n.gasPrice=ws(`${S}`)}if((0,Yb.isNil)(u)){let S=Y2(e);e.coinId?S=this._getUIPostCoinInfo(e):S=await this._getDappPostCoinInfo(e);let R={checkTypes:[ud.OVERWRITTEN],coinId:S.coinId,from:a,to:b,amount:S.coinAmount,gasPrice:$e(n.gasPrice)},M=((await D0(R)).data||[]).find(B=>B?.checkType===ud.OVERWRITTEN)||{},{newNonce:L}=M;n.nonce=ws(`${L}`)}if(Sa(l)){n.data||(n.gas=ws(`${s6}`));let S=Sa(y)?0:Number($e(y)),R=await this.getServerEstimateGasLimit({from:a,data:h,to:b,coinId:v.coinId,value:S});n.gas=ws(`${R}`)}}async signTransaction(e){let t=this.txStateManager.getTransaction(e),n=this.getChainId(),a=me({netWorkId:String(n)})?.baseChain,s={...t.txParams,chainId:n},i=s.from,c=(()=>{let y=bd(s.from,a),v=bd(s.to,a);return{...s,from:y,to:v,gasLimit:s.gas}})(),l;t.walletId?l=await this.getKeyringByWalletId(t.walletId,a):l=await this.getSignKeyring(i,a);let u="",h={};return this.dappReportController.updateReportTimestamp(t.id,"SIGN"),t.result?(h=t.result,u=t.result?.rawTxResult):u=await l.signTransaction(i,c),(0,Yb.isEmpty)(h)||(t.r=(0,Lh.bufferToHex)(h.r),t.s=(0,Lh.bufferToHex)(h.s),t.v=(0,Lh.bufferToHex)(h.v)),this.txStateManager.updateTransaction(t,"transactions#signTransaction: add r, s, v values"),this.txStateManager.setTxStatusSigned(t.id),(0,Lh.bufferToHex)(u)}async publishTransaction(e,t){let n=this.txStateManager.getTransaction(e);n.rawTx=t,this.txStateManager.updateTransaction(n,"transactions#publishTransaction");let a;if(n.isOffline){a=await je(_r,t);let{txParams:s}=n,{gas:i,type:o,gasPrice:c,maxFeePerGas:l}=s,u=o===Nl.FEE_MARKET?l:c,h=this._calTotalGas(u,i);n.serviceCharge=h,this.txStateManager.updateTransaction(n,"transactions#confirmTransaction - add serviceCharge")}else try{a=await this._sendRawTransaction(n,t)}catch(s){if(s.msg?.toLowerCase().includes("known transaction"))a=await je(_r,t);else throw s}this.setTxHash(e,a),this.txStateManager.setTxStatusSubmitted(e)}_getUIPostCoinInfo(e){let{txParams:t}=e,{data:n}=t||{};if(n){let a=b8(n);return a?mq(e,a):uq(e)}return lq(e)}_getDappPostCoinInfo(e){let{txParams:t,extParams:n,isBaseCoinTransfer:a}=e,{to:s,data:i}=t;return n?.txSource?J2(e):a?hq(e):s?Rl(i)?.name===vs.TOKEN_METHOD_TRANSFER?gq(e,this.coinController.getServerCoinWithTypeAndAddress.bind(this)):J2(e):pq(e)}async _sendRawTransaction(e,t){let{coinId:n,networkType:a,txParams:s,repeatTxType:i,oldTxHash:o,extParams:c,mev:l,activityId:u,gasType:h}=e||{},{from:b,to:y,gas:v,type:S,gasPrice:R,maxFeePerGas:P}=s,N=Mn(a),M=Y2(e);try{n?M=this._getUIPostCoinInfo(e):M=await this._getDappPostCoinInfo(e)}catch(H){cc.default.error(H)}if(a&&!N)return this._getQueryByNetworkType(a).sendRawTransaction(t);let L=S===Nl.FEE_MARKET?P:R,B=this._calTotalGas(L,v),F=await je(_r,t),{data:K}=await this.postTx({txMeta:e,walletId:e.walletId,signedTx:t,mev:l,activityId:u,fromAdr:b,toAdr:y||b,serviceCharge:B,txHash:F,txParams:s,repeatTxType:i,oldTxHash:o,extParams:c,gasType:h,...M});return e.serverTxId=M.orderId?K?.txId:K,this.txStateManager.updateTransaction(e,"setServerTxId"),F}_calTotalGas(e="0",t="0"){return e=ti(e),t=ti(t),Nn(e,t)}_getQueryByNetworkType(e){let{web3Provider:t}=this._getWeb3Provider(e);return new i6.default(t)}async confirmTransaction(e,t){let n=this.txStateManager.getTransaction(e);if(!!n)try{let a=typeof t.gasUsed=="string"?t.gasUsed:t.gasUsed.toString(16);n.txReceipt={...t,gasUsed:a},this.txStateManager.setTxStatusConfirmed(e),this._markNonceDuplicatesDropped(e),this.txStateManager.updateTransaction(n,"transactions#confirmTransaction - add txReceipt")}catch(a){cc.default.error(a)}}async cancelTransaction(e){let t=this.txStateManager.getTransaction(e),n=[{networkType:t?.networkType,from:t?.txParams?.from,to:t?.txParams?.to}];ri({txInfos:n}),this.txStateManager.setTxStatusRejected(e)}setTxHash(e,t){let n=this.txStateManager.getTransaction(e);n.hash=t,this.txStateManager.updateTransaction(n,"transactions#setTxHash")}_mapMethods(){this.getState=()=>this.memStore.getState(),this.getNetwork=()=>this.network,this.getSelectedAddress=()=>this.preferencesController.getSelectedAddress(),this.getUnapprovedTxCount=()=>Object.keys(this.txStateManager.getUnapprovedTxList()).length,this.getPendingTxCount=e=>this.txStateManager.getPendingTransactions(e).length,this.getTransactions=e=>this.txStateManager.getTransactions(e)}async _updatePendingTxsAfterFirstBlock(){await this.blockTracker.getLatestBlock()}_onBootCleanUp(){this.txStateManager.getTransactions({searchCriteria:{status:Oe.UNAPPROVED,loadingDefaults:!0}}).forEach(e=>{this.addTxGasDefaults(e).then(t=>{t.loadingDefaults=!1,this.txStateManager.updateTransaction(t,"transactions: gas estimation for tx on boot")}).catch(t=>{let n=this.txStateManager.getTransaction(e.id);n.loadingDefaults=!1,this.txStateManager.updateTransaction(n,"failed to estimate gas during boot cleanup."),this.txStateManager.setTxStatusFailed(n.id,t)})}),this.txStateManager.getTransactions({searchCriteria:{status:Oe.APPROVED}}).forEach(e=>{let t=new Error('Transaction found as "approved" during boot - possibly stuck during signing');this.txStateManager.setTxStatusFailed(e.id,t)})}_setupListeners(){this.txStateManager.on("tx:status-update",this.emit.bind(this,"tx:status-update"))}async _determineTransactionType(e){let{data:t,to:n}=e,a;try{a=t&&new g8(Iq.default).parseTransaction({data:t}).name}catch(o){cc.default.debug("Failed to parse transaction data.",o,t)}let s=[vs.TOKEN_METHOD_APPROVE,vs.TOKEN_METHOD_TRANSFER,vs.TOKEN_METHOD_TRANSFER_FROM].find(o=>o===a&&a.toLowerCase()),i;return t&&s?i=s:t&&!n&&(i=vs.DEPLOY_CONTRACT),i||(i=a?vs.CONTRACT_INTERACTION:vs.SENT_ETHER),{type:i}}_markNonceDuplicatesDropped(e){let t=this.txStateManager.getTransaction(e),{nonce:n,from:a}=t.txParams,s=this.txStateManager.getTransactions({searchCriteria:{nonce:n,from:a}});!s.length||s.forEach(i=>{i.id!==e&&(i.replacedBy=t.hash,this.txStateManager.updateTransaction(t,"transactions/pending-tx-tracker#event: tx:confirmed reference to confirmed txHash with same nonce"),this.txStateManager.setTxStatusDropped(i.id))})}_updateMemstore(e=!1){let t=this.txStateManager.getUnapprovedTxList(),n=this.txStateManager.getTransactions({limit:qie});this.memStore.updateState({unapprovedTxs:t,currentNetworkTxList:n},e)}async getServerEstimateGasLimit({from:e,data:t,to:n,coinId:a,value:s}){let i=ce.postGasLimit,c={headers:this.getCurrentWalletRequestHeaders()},l={address:e,inputData:t,coinId:a,value:s};return n&&(l.tokenAddress=n),(await Pe(i,l,c))?.data?.gasLimit}async getGasLimitAndNonceFromRpc({address:e,tokenAddress:t="",networkType:n,txParam:a}){let s=this._getQueryByNetworkType(n),i=a?s.estimateGas(a):ti(t?Kie:s6),o=await s.gasPrice(),c=(await s.getTransactionCount(e,"latest")).toNumber();return{coinId:"",address:e,info:{gasLimit:i,nonce:c,gasPrice:{normal:o,min:o,max:o,maxCost:"0",minCost:"0",normalCost:"0"}}}}async getGasSignInfo(e,t){let n=ce.getGasSignInfo.replace("{coinId}",e).replace("{address}",t),s={headers:this.getCurrentWalletRequestHeaders()},{data:i={}}=await zr(n,{},s);return i}async getGasLimitAndNonce({coinId:e="",address:t,tokenAddress:n,networkType:a,txParam:s}){return a&&!Mn(a)?this.getGasLimitAndNonceFromRpc({address:t,tokenAddress:n,networkType:a,txParam:s}):this.getGasSignInfo(e,t)}async postTx({signedTx:e,coinId:t,coinAmount:n,fromAdr:a,toAdr:s,serviceCharge:i,txHash:o,txParams:c,txSource:l,repeatTxType:u,oldTxHash:h,orderId:b,crossChain:y,chainId:v,tokenAddress:S,amount:R,toChainId:P,mev:N,activityId:M,toTokenAddress:L,gasType:B,extParams:F={},txMeta:K,walletId:H}){let X={headers:this.getCurrentWalletRequestHeaders()},z=c.type===Nl.FEE_MARKET,T={...c,value:$e(c.value),from:a,to:s,gas:$e(c.gas),gasPrice:$e(z?c.maxFeePerGas:c.gasPrice),priorityFee:$e(z?c.maxPriorityFeePerGas:0),nonce:$e(c.nonce),repeatTxType:u,oldTxHash:h,gasType:B},m=b?ce.postDexTx:ce.postTx,x={};b&&(x={orderId:b,crossChain:y,chainId:v,tokenAddress:S,amount:R,toChainId:P,toTokenAddress:L});let w={};F?.txType&&(w={txType:F?.txType});let I=H||this.preferencesController.getSelectedWallet(),k=this.preferencesController.getServerWalletTypeByWalletId(I),O=()=>({signedTx:e,coinId:t,coinAmount:n,fromAdr:a,toAdr:s,serviceCharge:i,txHash:o,extJson:JSON.stringify(T),txSource:l,inputData:c.data?c.data:"",accountId:I,walletType:k,mev:N,activityId:M,...w,...x});this.dappReportController.updateReportTimestamp(K.id,"START_PUBLISH");let E=await Pe(m,O(),X);return this.dappReportController.updateReportTimestamp(K.id,"FINISH_PUBLISH"),E}};d();f();var Mq=_(Pr()),Nq=_(Ne());ae();Wt();ur();var Uie=1e3*60*60,Pq=/^(?:https?:\/\/)?(.*?)\/?$/,o6=class extends Mq.default{constructor(e){super(),e=e||{};let t={dappBlackList:{},...e?.initState||{}};this.store=new Nq.ObservableStore(t),this.initialize()}initialize(){let e=()=>{Pe(ce.checkDAppUrl).then(({data:t})=>{this.store.updateState({dappBlackList:t})}).catch(()=>{})};e(),setInterval(e,Uie)}checkWalletStandardDapp(e,t){if(!e)return!0;let n=me({localType:t})?.coinId,a=this.store.getState().dappBlackList,s=Object.keys(a).find(i=>{let o=Pq.exec(e),c=Pq.exec(i);return o?.[1]===c?.[1]});return!s||a[s]?.indexOf(n)!==-1}},Rq=o6;d();f();var kq=_(Ne());Be();var Wh=class extends ge{constructor(e){super();let t={injectProvider:[],...e.initState};this.showUserConfirmation=e.showUserConfirmation,this.closeCurrentWindow=e.closeCurrentWindow,this.store=new kq.ObservableStore(t)}gotoAggregate(){return this.reject&&this.rejectAggregate(),new Promise((e,t)=>{this.resolve=e,this.reject=t,globalThis.METAMASK_NOTIFIER.showShunt(P0)})}useProvider(e){this.resolve(e)}rejectAggregate(){this.reject({code:4001,message:"User rejected the request."})}getInjectProvider(){return this.store.getState().injectProvider}setInjectProvider(e){N9({w:e.map(({name:t})=>t)}),this.store.updateState({injectProvider:e},!1)}};d();f();Be();var Lq=_(Ne()),Kh=_(te());ae();ne();d();f();var Oq=_(te()),Jb=(r={})=>{let{walletId:e="",addresses:t=[],notSupport:n=[]}=r;return t.filter(s=>!Boolean(n?.find(o=>o?.accountId===e&&o?.coinId===s?.coinId)))},Dq=(r={})=>{let{wallets:e=[],notSupport:t=[]}=r;return e.map(i=>{let{accountId:o,addresses:c}=i||{},l=(0,Oq.cloneDeep)(c),u=Jb({walletId:o,addresses:l,notSupport:t});return{walletId:o,successfulAddresses:u}}).filter(i=>{let{successfulAddresses:o}=i||{};return Boolean(o?.length)}).reduce((i,o)=>{let{walletId:c,successfulAddresses:l}=o||{};return{successfulWalletIds:[...i.successfulWalletIds,c],successfulNeedToServerAddressesMap:{...i.successfulNeedToServerAddressesMap,[c]:l}}},{successfulWalletIds:[],successfulNeedToServerAddressesMap:{}})};var c6=class extends ge{constructor(e={}){super();let t={createdMap:{},walletTypeMap:{},needSyncMap:{},...e.initState};this.store=new Lq.ObservableStore(t),this.preferencesController=e.preferencesController,this.keyringController=e.keyringController,this.authController=e.authController,this.controller=e.controller}setWalletCreated(e,t){let{createdMap:n}=this.store.getState();this.store.updateState({createdMap:{...n,[e]:t}})}getCreatedWalletIds(){let{createdMap:e}=this.store.getState();return Object.keys(e??{})}getCreatedAddresses(e){let{createdMap:t}=this.store.getState();return t[e]}setWalletTypeCreated(e,t){let{walletTypeMap:n}=this.store.getState();this.store.updateState({walletTypeMap:{...n,[e]:t}})}setWalletIsNeedSync(e,t){let{needSyncMap:n}=this.store.getState();this.store.updateState({needSyncMap:{...n,[e]:t}})}clearAboutWalletCreate(){this.store.updateState({createdMap:{},walletTypeMap:{},needSyncMap:{}})}getWalletTypeCreated(e){let{walletTypeMap:t}=this.store.getState();return t[e]||yr.UNKNOWN}setWalletsCreated(e,t){let n=e.reduce((s,i)=>(s[i]=t[i],s),{}),{createdMap:a}=this.store.getState();this.store.updateState({createdMap:{...a,...n}})}getIsWalletCreated(e){let{createdMap:t}=this.store.getState();return Boolean(t[e])}getIsWalletSupportEVM(e){let{createdMap:t}=this.store.getState();if(!Boolean(t[e]))throw new Error(`the wallet ${e} was not create to server`);return t[e].some(({coinId:s})=>s===i_)}getWalletCreatedAddress(e){let{createdMap:t}=this.store.getState();return t[e]||[]}removeWalletsCreated(e){let{createdMap:t,walletTypeMap:n,needSyncMap:a}=this.store.getState();e.forEach(s=>{delete t[s],delete n[s],delete a[s]}),this.store.updateState({createdMap:t,walletTypeMap:n,needSyncMap:a})}async getAddressesParams(e){let{accountMap:t,accountsMap:n}=await this.keyringController.getAccountInfoByWalletId(e),{needSetDefault:a,segwitAddressType:s={},initialType:i}=this.keyringController.getWallet(e),o=i===$.SIMPLE_KEYRING;return st().reduce((u,{coinId:h,chain:b,baseChain:y})=>{let v=t[b]||t[y]||"";return!Vr.includes(y)||!t[y]?(u.push({coinId:h,address:v}),u):(Co[y].forEach(S=>{let R=n[y][S]?.address,P=s[y]===de.SEGWIT_NESTED?de.SEGWIT_NESTED_49:de.SEGWIT_NESTED;if(!o||P!==S){let N=Wx[y][S];u.push({coinId:h,address:R,addressType:N,isDefault:a||v!==R?0:1})}}),u)},[]).filter(({coinId:u,address:h})=>{let b=me({coinId:+u})?.localType;return Mx.includes(b)&&typeof t[b]=="string"?!0:Boolean(h)})}async postWalletCreateBatch(e){let t=this.authController.getRequestHeaders();return Wi.postWalletCreateBatch(e,{headers:t,needSign:!0})}async createWalletToServer({walletId:e,walletType:t=yr.UNKNOWN,noticeBackend:n=!0}){if(this.setWalletTypeCreated(e,t),!n)return;if(!this.getIsWalletCreated(e)){let s=await this.keyringController.getMpcIdByWalletId(e),i=await this.getAddressesParams(e),o=await this.authController.getPubKeyByWalletId(e),c=[{accountId:e,addresses:i,walletType:t,name:"",pubKey:o,userUniqueId:this.preferencesController.getUserUniqueId()}];s&&(c[0].mpcId=s);try{let{data:l={}}=await this.postWalletCreateBatch(c),{notSupport:u=[]}=l,h=Jb({walletId:e,addresses:i,notSupport:u});this.setWalletCreated(e,h)}catch(l){em(l)}}}async syncUnsyncedWallets(){let e=this.preferencesController.getWalletIdentityMap()??{},t=new Map,n=Object.entries(e);for(let a=0;a<n.length;a++){let[s,i]=n[a];if(i){let{serverWalletType:o}=i,c=o??yr.UNKNOWN;t.has(c)||t.set(c,[]),t.get(c).push(s)}}for(let[a,s]of t.entries())await this.createWalletsToServer(s,a)}async createWalletsToServer(e,t=yr.IMPORT){let n={};e.forEach(s=>{this.getIsWalletCreated(s)||(n[s]=!0)});let a=0;for(;!en(n)&&a<5;){a+=1;let s=Object.keys(n),i=await Promise.all(s.map(y=>this.getAddressesParams(y))),o=await Promise.all(e.map(y=>this.keyringController.getMpcIdByWalletId(y))),c=[];for(let y=0;y<s.length;y++){let v=s[y],S=await this.authController.getPubKeyByWalletId(v);c.push({accountId:v,addresses:i[y],walletType:t,name:"",pubKey:S,userUniqueId:this.preferencesController.getUserUniqueId(),mpcId:o[y]})}let{data:l={}}=await this.postWalletCreateBatch(c),{notSupport:u=[]}=l,{successfulWalletIds:h,successfulNeedToServerAddressesMap:b}=Dq({wallets:c,notSupport:u});this.setWalletsCreated(h,b),h.forEach(y=>{delete n[y]})}if(!en(n))throw new Error(W0)}async removeWalletsToServer(e=[]){let t=e.filter(n=>this.getIsWalletCreated(n));return t.length&&await(0,Kh.chunk)(t,50).reduce((a,s)=>a.then(()=>{let i={accountIds:s},c={headers:this.authController.getRequestHeaders({walletId:e[0],needSign:!0,currency:"usd",body:i}),needSign:!0};return Wi.deleteWallet(i,c)}).then(()=>{this.removeWalletsCreated(s)}),Promise.resolve()),t}async checkIsWalletNeedSync(e){let{createdMap:t}=this.store.getState(),n=t[e],a=await this.getAddressesParams(e),s=Array.isArray(n)&&n.length>0;!(0,Kh.isEqual)(n,a)&&s&&this.setWalletIsNeedSync(e,!0)}async syncAddresses(e){try{if(this.syncAddresses[e])return!1;this.syncAddresses[e]=!0;let{createdMap:t}=this.store.getState(),n=t[e],a=await this.getAddressesParams(e),s=Array.isArray(n);if((0,Kh.isEqual)(n,a)||!s)return delete this.syncAddresses[e],!1;let i={addresses:a,accountId:e},c={headers:this.authController.getSignRequestHeaders({walletId:e})},{data:l={}}=await Wi.postWalletSync(i,c),{notSupport:u=[]}=l,h=Jb({walletId:e,addresses:a,notSupport:u});this.setWalletCreated(e,h);let{accountMap:b,accountsMap:y}=await this.keyringController.getAccountInfoByWalletId(e),{keyringIdentities:v}=this.preferencesController.store.getState();v.forEach(S=>{let R=S.walletIdentities.find(P=>P.walletId===e);R&&(R.account=b,R.accountsMap=y)}),this.preferencesController.updateAllKeyringIdentities(v)}finally{delete this.syncAddresses[e]}return!0}async syncWalletToServer(e){try{await this.syncAddresses(e)}catch(t){console.log(t)}finally{this.setWalletIsNeedSync(e,!1)}}async updateAllKeyringIdentities(){let{keyringIdentities:e}=this.preferencesController.store.getState(),t=[],n=[];for(let a=0;a<e.length;a++){let s=e[a],{walletIdentities:i=[]}=s,o=[];for(let c=0;c<i.length;c++){let l=i[c],{walletId:u}=l;try{let{accountMap:h,accountsMap:b}=await this.keyringController.getAccountInfoByWalletId(u);o.push(l),l.account=h,l.accountsMap=b}catch(h){console.info(h),n.push(u)}}o.length!==i.length&&(s.walletIdentities=o),s.walletIdentities.length&&t.push(s)}return this.preferencesController.store.updateState({keyringIdentities:t}),{errorWalletIds:n,originKeyringIdentitiesCount:e.length,keyringIdentitiesCount:t.length}}async setSegwitAddressType(e){let{addressType:t,initialType:n}=this.keyringController.getWallet(e),a=n===$.SIMPLE_KEYRING,s=n===$.MPC_KEYRING;if(a||s||en(t))return;let{accountsMap:i}=await this.keyringController.getAccountInfoByWalletId(e),o=Object.keys(t).map(b=>cd.includes(b)?!1:{accountId:e,address:i[b][de.SEGWIT_NESTED].address,addressType:Wx[b][de.SEGWIT_NESTED],coinId:me({localType:b})?.coinId}).filter(Boolean),l={headers:this.authController.getSignRequestHeaders({walletId:e})},u=await Wi.postSegwitInfo(o,l);if(!Array.isArray(u.data))return;let h=Object.keys(t).reduce((b,y)=>{let v=u.data.find(({coinId:R})=>me({localType:y})?.coinId===R),S=r8[v?.addressType];return S&&(b[y]=S),b},{});this.keyringController.updateWalletSegwitAddressType(e,h)}async getAccountKeysParams(e){let{accountMap:t,publicKeyMap:n}=await this.keyringController.getAccountInfoByWalletId(e),a=Mx.reduce((s,i)=>{let o=t?.[i]||"",c=n?.[i]||"";return c&&(s=[...s,{publicKey:c,coinId:me({localType:i})?.coinId,baseChain:i,address:o}]),s},[]);return cd.forEach(s=>{let i=n?.[s]||"";i&&a.push({publicKey:i,coinId:me({localType:s})?.coinId,baseChain:s,address:t?.[s]||""})}),a||[]}async fetchAccountKeys(e=[]){let t=e.map(({publicKey:i,coinId:o,currency:c})=>({pubkeys:[i],coinId:o,currency:c})),a={headers:{currency:this.controller.currencyController.store.getState().selectedCurrency?.isoCode}},{data:s=[]}=await Wi.postAccountKeys({keyInfos:t},a);return s}async getSyncResultsAndSetAddress(e,t=[],n=[]){let a=await Promise.all(t.map((c={})=>{let{publicKey:l,baseChain:u,coinId:h}=c,y=(n.find(({pubKey:R})=>R===l)?.info||[])?.find((R={})=>R?.coinId===h)?.account||"",v=null,S={walletId:e,publicKey:l,address:y,baseChain:u};return cd.includes(u)?v=this.keyringController.updateAddressMap(S):v=this.keyringController.setAddressByPublicKey(S),v.then(R=>({...c,address:y,isSetSuccessful:R}))})),{createdMap:s}=this.store.getState(),i=s[e]||[];return a?.filter(({coinId:c,address:l,baseChain:u})=>cd.includes(u)?!!l:(i.find(y=>y.coinId===c)||{})?.address!==l)||[]}async syncAccountKeysAndUpdate(e,t){t.length&&(t.forEach(({baseChain:a,address:s})=>{cd.includes(a)||this.preferencesController.updateWalletIdentityAddress(e,a,s)}),await this.syncAddresses(e)&&(await this.controller.balanceController.getCurrentWalletBalance(),this.controller.serverPushController?.sendData()))}async getAccountKeys(){try{let e=this.preferencesController.getSelectedWallet(),t=await this.getAccountKeysParams(e);if(!t.length)return;let n=await this.fetchAccountKeys(t),a=await this.getSyncResultsAndSetAddress(e,t,n);await this.syncAccountKeysAndUpdate(e,a)}catch(e){console.log(e)}}},Bq=c6;d();f();var Wq=_(Ne()),Pf=class extends Wq.ObservableStore{constructor(e,t){super(e),this.updateStructure(t)}updateStructure(e){this.config=e,this.removeAllListeners();for(let t in e)Object.prototype.hasOwnProperty.call(e,t)&&e[t].subscribe(n=>{this.updateState({[t]:n},t!=="ApprovalController"&&t!=="PermissionsController")})}getFlatState(){let e={};for(let t in this.config)if(Object.prototype.hasOwnProperty.call(this.config,t)){let n=this.config[t],a=n.getState?n.getState():n.state;e={...e,...a}}return e}};d();f();Be();var Kq=_(Ne()),Xb=_(Gn()),qq=_(Ce()),d6=_(Fr());un();Ge();var Fie=/^[0-9A-Fa-f]+$/gu,qh=class extends Ir{constructor(){super(),this.memStore=new Kq.ObservableStore({unapprovedDecryptMsgs:{},unapprovedDecryptMsgCount:0}),this.messages=[]}get unapprovedDecryptMsgCount(){return Object.keys(this.getUnapprovedMsgs()).length}getUnapprovedMsgs(){return this.messages.filter(e=>e.status==="unapproved").reduce((e,t)=>(e[t.id]=t,e),{})}addUnapprovedMessageAsync(e,t){return new Promise((n,a)=>{if(!e.from){a(new Error("OKX Wallet Decryption: from field is required."));return}let s=this.addUnapprovedMessage(e,t);this.once(`${s}:finished`,i=>{switch(i.status){case"decrypted":n(i.rawData);return;case"rejected":a(qq.ethErrors.provider.userRejectedRequest("OKX Wallet Decryption: User denied message decryption."));return;case"errored":a(new Error("This message cannot be decrypted"));return;default:a(new Error(`OKX Wallet Decryption: Unknown problem: ${JSON.stringify(e)}`))}})})}addUnapprovedMessage(e,t){d6.default.debug(`DecryptMessageManager addUnapprovedMessage: ${JSON.stringify(e)}`),t&&(e.origin=t.origin),e.data=this.normalizeMsgData(e.data);let n=new Date().getTime(),a=rn(),s={id:a,msgParams:e,time:n,status:"unapproved",type:Xe.ETH_DECRYPT,origin:t?.origin||""};return this.addMsg(s),this.emit("update"),a}addMsg(e){this.messages.push(e),this._saveMsgList()}getMsg(e){return this.messages.find(t=>t.id===e)}approveMessage(e){return this.setMsgStatusApproved(e.metamaskId),this.prepMsgForDecryption(e)}setMsgStatusApproved(e){this._setMsgStatus(e,"approved")}setMsgStatusDecrypted(e,t){let n=this.getMsg(e);n.rawData=t,this._updateMsg(n),this._setMsgStatus(e,"decrypted")}prepMsgForDecryption(e){return delete e.metamaskId,Promise.resolve(e)}rejectMsg(e){this._setMsgStatus(e,"rejected")}errorMessage(e,t){let n=this.getMsg(e);n.error=t,this._updateMsg(n),this._setMsgStatus(e,"errored")}clearUnapproved(){this.messages.filter(t=>t.status==="unapproved").forEach(t=>{this.rejectMsg(t.id)}),this.messages=this.messages.filter(t=>t.status!=="unapproved"),this._saveMsgList()}_setMsgStatus(e,t){let n=this.getMsg(e);if(!n)throw new Error(`DecryptMessageManager - Message not found for id: "${e}".`);n.status=t,this._updateMsg(n),this.emit(`${e}:${t}`,n),(t==="rejected"||t==="decrypted"||t==="errored")&&this.emit(`${e}:finished`,n)}_updateMsg(e){let t=this.messages.findIndex(n=>n.id===e.id);t!==-1&&(this.messages[t]=e),this._saveMsgList()}_saveMsgList(){let e=this.getUnapprovedMsgs(),t=Object.keys(e).length;this.memStore.updateState({unapprovedDecryptMsgs:e,unapprovedDecryptMsgCount:t}),this.emit(nr)}normalizeMsgData(e){try{let t=(0,Xb.stripHexPrefix)(e);if(t.match(Fie))return gr(t)}catch{d6.default.debug("Message was not hex encoded, interpreting as utf8.")}return(0,Xb.bufferToHex)(p.Buffer.from(e,"utf8"))}};d();f();Be();var Uq=_(Ne()),Fq=_(Ce()),Hq=_(Fr());un();var Uh=class extends Ir{constructor(){super(),this.memStore=new Uq.ObservableStore({unapprovedEncryptionPublicKeyMsgs:{},unapprovedEncryptionPublicKeyMsgCount:0}),this.messages=[]}get unapprovedEncryptionPublicKeyMsgCount(){return Object.keys(this.getUnapprovedMsgs()).length}getUnapprovedMsgs(){return this.messages.filter(e=>e.status==="unapproved").reduce((e,t)=>(e[t.id]=t,e),{})}addUnapprovedMessageAsync(e,t){return new Promise((n,a)=>{if(!e){a(new Error("OKX Wallet Message: address field is required."));return}let s=this.addUnapprovedMessage(e,t);this.once(`${s}:finished`,i=>{switch(i.status){case"received":n(i.rawData);return;case"rejected":a(Fq.ethErrors.provider.userRejectedRequest("OKX EncryptionPublicKey: User denied message EncryptionPublicKey."));return;default:a(new Error(`OKX Wallet EncryptionPublicKey: Unknown problem: ${e}`))}})})}addUnapprovedMessage(e,t){Hq.default.debug("EncryptionPublicKeyManager addUnapprovedMessage: address");let n=new Date().getTime(),a=rn(),s={id:a,msgParams:e,time:n,status:"unapproved",type:Xe.ETH_GET_ENCRYPTION_PUBLIC_KEY,origin:t?.origin||""};return t&&(s.origin=t.origin),this.addMsg(s),this.emit("update"),a}addMsg(e){this.messages.push(e),this._saveMsgList()}getMsg(e){return this.messages.find(t=>t.id===e)}approveMessage(e){return this.setMsgStatusApproved(e.metamaskId),this.prepMsgForEncryptionPublicKey(e)}setMsgStatusApproved(e){this._setMsgStatus(e,"approved")}setMsgStatusReceived(e,t){let n=this.getMsg(e);n.rawData=t,this._updateMsg(n),this._setMsgStatus(e,"received")}prepMsgForEncryptionPublicKey(e){return delete e.metamaskId,Promise.resolve(e)}rejectMsg(e){this._setMsgStatus(e,"rejected")}errorMessage(e,t){let n=this.getMsg(e);n.error=t,this._updateMsg(n),this._setMsgStatus(e,"errored")}clearUnapproved(){this.messages.filter(t=>t.status==="unapproved").forEach(t=>{this.rejectMsg(t.id)}),this.messages=this.messages.filter(t=>t.status!=="unapproved"),this._saveMsgList()}_setMsgStatus(e,t){let n=this.getMsg(e);if(!n)throw new Error(`EncryptionPublicKeyManager - Message not found for id: "${e}".`);n.status=t,this._updateMsg(n),this.emit(`${e}:${t}`,n),(t==="rejected"||t==="received")&&this.emit(`${e}:finished`,n)}_updateMsg(e){let t=this.messages.findIndex(n=>n.id===e.id);t!==-1&&(this.messages[t]=e),this._saveMsgList()}_saveMsgList(){let e=this.getUnapprovedMsgs(),t=Object.keys(e).length;this.memStore.updateState({unapprovedEncryptionPublicKeyMsgs:e,unapprovedEncryptionPublicKeyMsgCount:t}),this.emit(nr)}};d();f();Be();var Gq=_(Ne()),zq=_(Gn()),jq=_(Ce());un();var Fh=class extends Ir{constructor(){super(),this.memStore=new Gq.ObservableStore({unapprovedMsgs:{},unapprovedMsgCount:0}),this.messages=[]}get unapprovedMsgCount(){return Object.keys(this.getUnapprovedMsgs()).length}getUnapprovedMsgs(){return this.messages.filter(e=>e.status==="unapproved").reduce((e,t)=>(e[t.id]=t,e),{})}addUnapprovedMessageAsync(e,t){return new Promise((n,a)=>{let s=this.addUnapprovedMessage(e,t);this.once(`${s}:finished`,i=>{switch(i.status){case"signed":return n(i.rawSig);case"rejected":return a(jq.ethErrors.provider.userRejectedRequest("Message Signature: User denied message signature."));default:return a(new Error(`Message Signature: Unknown problem: ${JSON.stringify(e)}`))}})})}addUnapprovedMessage(e,t){t&&(e.origin=t.origin),e.data=Hie(e.data);let n=new Date().getTime(),a=rn(),s={id:a,msgParams:e,time:n,status:"unapproved",type:Xe.ETH_SIGN,origin:t?.origin||""};return this.addMsg(s),this.emit("update"),a}addMsg(e){this.messages.push(e),this._saveMsgList()}getMsg(e){return this.messages.find(t=>t.id===e)}approveMessage(e){return this.setMsgStatusApproved(e.metamaskId),this.prepMsgForSigning(e)}setMsgStatusApproved(e){this._setMsgStatus(e,"approved")}setMsgStatusSigned(e,t){let n=this.getMsg(e);n.rawSig=t,this._updateMsg(n),this._setMsgStatus(e,"signed")}prepMsgForSigning(e){return delete e.metamaskId,Promise.resolve(e)}rejectMsg(e){this._setMsgStatus(e,"rejected")}clearUnapproved(){this.messages.filter(t=>t.status==="unapproved").forEach(t=>{this.rejectMsg(t.id)}),this.messages=this.messages.filter(t=>t.status!=="unapproved"),this._saveMsgList()}_setMsgStatus(e,t){let n=this.getMsg(e);if(!n)throw new Error(`MessageManager - Message not found for id: "${e}".`);n.status=t,this._updateMsg(n),this.emit(`${e}:${t}`,n),(t==="rejected"||t==="signed")&&this.emit(`${e}:finished`,n)}_updateMsg(e){let t=this.messages.findIndex(n=>n.id===e.id);t!==-1&&(this.messages[t]=e),this._saveMsgList()}_saveMsgList(){let e=this.getUnapprovedMsgs(),t=Object.keys(e).length;this.memStore.updateState({unapprovedMsgs:e,unapprovedMsgCount:t}),this.emit(nr)}};function Hie(r){return r.slice(0,2)==="0x"?r:(0,zq.bufferToHex)(p.Buffer.from(r,"utf8"))}d();f();Be();var Vq=_(Ne()),Zb=_(Gn()),$q=_(Ce()),f6=_(Fr());un();Ge();var Gie=/^[0-9A-Fa-f]+$/gu,Hh=class extends Ir{constructor(){super(),this.memStore=new Vq.ObservableStore({unapprovedPersonalMsgs:{},unapprovedPersonalMsgCount:0}),this.messages=[]}get unapprovedPersonalMsgCount(){return Object.keys(this.getUnapprovedMsgs()).length}getUnapprovedMsgs(){return this.messages.filter(e=>e.status==="unapproved").reduce((e,t)=>(e[t.id]=t,e),{})}addUnapprovedMessageAsync(e,t){return new Promise((n,a)=>{if(!e.from){a(new Error("Message Signature: from field is required."));return}let s=this.addUnapprovedMessage(e,t);this.once(`${s}:finished`,i=>{switch(i.status){case"signed":n(i.rawSig);return;case"rejected":a($q.ethErrors.provider.userRejectedRequest("Message Signature: User denied message signature."));return;default:a(new Error(`Message Signature: Unknown problem: ${JSON.stringify(e)}`))}})})}addUnapprovedMessage(e,t){f6.default.debug(`PersonalMessageManager addUnapprovedMessage: ${JSON.stringify(e)}`),t&&(e.origin=t.origin),e.data=this.normalizeMsgData(e.data);let n=new Date().getTime(),a=rn(),s={id:a,msgParams:e,time:n,status:"unapproved",type:Xe.PERSONAL_SIGN,origin:t?.origin||""};return this.addMsg(s),this.emit("update"),a}addMsg(e){this.messages.push(e),this._saveMsgList()}getMsg(e){return this.messages.find(t=>t.id===e)}approveMessage(e){return this.setMsgStatusApproved(e.metamaskId),this.prepMsgForSigning(e)}setMsgStatusApproved(e){this._setMsgStatus(e,"approved")}setMsgStatusSigned(e,t){let n=this.getMsg(e);n.rawSig=t,this._updateMsg(n),this._setMsgStatus(e,"signed")}prepMsgForSigning(e){return delete e.metamaskId,Promise.resolve(e)}rejectMsg(e){this._setMsgStatus(e,"rejected")}clearUnapproved(){this.messages.filter(t=>t.status==="unapproved").forEach(t=>{this.rejectMsg(t.id)}),this.messages=this.messages.filter(t=>t.status!=="unapproved"),this._saveMsgList()}_setMsgStatus(e,t){let n=this.getMsg(e);if(!n)throw new Error(`PersonalMessageManager - Message not found for id: "${e}".`);n.status=t,this._updateMsg(n),this.emit(`${e}:${t}`,n),(t==="rejected"||t==="signed")&&this.emit(`${e}:finished`,n)}_updateMsg(e){let t=this.messages.findIndex(n=>n.id===e.id);t!==-1&&(this.messages[t]=e),this._saveMsgList()}_saveMsgList(){let e=this.getUnapprovedMsgs(),t=Object.keys(e).length;this.memStore.updateState({unapprovedPersonalMsgs:e,unapprovedPersonalMsgCount:t}),this.emit(nr)}normalizeMsgData(e){try{let t=(0,Zb.stripHexPrefix)(e);if(t.match(Gie))return gr(t)}catch{f6.default.debug("Message was not hex encoded, interpreting as utf8.")}return(0,Zb.bufferToHex)(p.Buffer.from(e,"utf8"))}};d();f();Be();P_();var pU=_(Ne()),mU=_(Ce()),gU=_(Ox()),bU=_(I$()),yU=_(Fr()),xU=_(hU());un();var zh=class extends Ir{constructor({getCurrentChainId:e}){super(),this._getCurrentChainId=e,this.memStore=new pU.ObservableStore({unapprovedTypedMessages:{},unapprovedTypedMessagesCount:0}),this.messages=[]}get unapprovedTypedMessagesCount(){return Object.keys(this.getUnapprovedMsgs()).length}getUnapprovedMsgs(){return this.messages.filter(e=>e.status==="unapproved").reduce((e,t)=>(e[t.id]=t,e),{})}addUnapprovedMessageAsync(e,t,n){return new Promise((a,s)=>{let i=this.addUnapprovedMessage(e,t,n);this.once(`${i}:finished`,o=>{switch(o.status){case"signed":return a(o.rawSig);case"rejected":return s(mU.ethErrors.provider.userRejectedRequest("Message Signature: User denied message signature."));case"errored":return s(new Error(`Message Signature: ${o.error}`));default:return s(new Error(`Message Signature: Unknown problem: ${JSON.stringify(e)}`))}})})}addUnapprovedMessage(e,t,n){e.version=n,t&&(e.origin=t.origin),this.validateParams(e),yU.default.debug(`TypedMessageManager addUnapprovedMessage: ${JSON.stringify(e)}`);let a=new Date().getTime(),s=rn(),i={id:s,msgParams:e,time:a,status:"unapproved",type:Xe.ETH_SIGN_TYPED_DATA,origin:t?.origin||""};return this.addMsg(i),this.emit("update"),s}validateParams(e){switch(jr.ok(e&&typeof e=="object","Params must be an object."),jr.ok(typeof e.data<"u",'Params must include a "data" field.'),jr.ok(typeof e.from<"u",'Params must include a "from" field.'),jr.ok(typeof e.from=="string"&&No(e.from,{allowNonPrefixed:!1}),'"from" field must be a valid, lowercase, hexadecimal Ethereum address string.'),e.version){case"V1":jr.ok(Array.isArray(e.data),'"params.data" must be an array.'),jr.doesNotThrow(()=>{(0,bU.typedSignatureHash)(e.data)},"Signing data must be valid EIP-712 typed data.");break;case"V3":case"V4":{jr.strictEqual(typeof e.data,"string",'"params.data" must be a string.');let t;jr.doesNotThrow(()=>{t=JSON.parse(e.data)},'"data" must be a valid JSON string.');let n=xU.default.validate(t,gU.TYPED_MESSAGE_SCHEMA);jr.ok(t.primaryType in t.types,`Primary type of "${t.primaryType}" has no type definition.`),jr.strictEqual(n.errors.length,0,"Signing data must conform to EIP-712 schema. See https://git.io/fNtcx.");let{chainId:a}=t.domain;if(a){let s=parseInt(this._getCurrentChainId(),16);jr.ok(!Number.isNaN(s),`Cannot sign messages for chainId "${a}", because MetaMask is switching networks.`),jr.equal(a,s,`Provided chainId "${a}" must match the active chainId "${s}"`)}break}default:jr.fail(`Unknown typed data version "${e.version}"`)}}addMsg(e){this.messages.push(e),this._saveMsgList()}getMsg(e){return this.messages.find(t=>t.id===e)}approveMessage(e){return this.setMsgStatusApproved(e.metamaskId),this.prepMsgForSigning(e)}setMsgStatusApproved(e){this._setMsgStatus(e,"approved")}setMsgStatusSigned(e,t){let n=this.getMsg(e);n.rawSig=t,this._updateMsg(n),this._setMsgStatus(e,"signed")}prepMsgForSigning(e){return delete e.metamaskId,delete e.version,Promise.resolve(e)}rejectMsg(e){this._setMsgStatus(e,"rejected")}errorMessage(e,t){let n=this.getMsg(e);n.error=t,this._updateMsg(n),this._setMsgStatus(e,"errored")}clearUnapproved(){this.messages.filter(t=>t.status==="unapproved").forEach(t=>{this.rejectMsg(t.id)}),this.messages=this.messages.filter(t=>t.status!=="unapproved"),this._saveMsgList()}_setMsgStatus(e,t){let n=this.getMsg(e);if(!n)throw new Error(`TypedMessageManager - Message not found for id: "${e}".`);n.status=t,this._updateMsg(n),this.emit(`${e}:${t}`,n),(t==="rejected"||t==="signed"||t==="errored")&&this.emit(`${e}:finished`,n)}_updateMsg(e){let t=this.messages.findIndex(n=>n.id===e.id);t!==-1&&(this.messages[t]=e),this._saveMsgList()}_saveMsgList(){let e=this.getUnapprovedMsgs(),t=Object.keys(e).length;this.memStore.updateState({unapprovedTypedMessages:e,unapprovedTypedMessagesCount:t}),this.emit(nr)}};var jh=class{initializeData(e){this.defaultMaxListeners=20,this.opts=e,this.extension=this.opts.extension,this.platform=this.opts.platform;let t=this.opts.initState||{};this.initState=t,this.initIDBData=this.opts.initIDBData,this.activeControllerConnections=0,this.getRequestAccountTabIds=this.opts.getRequestAccountTabIds,this.connections={},this.createVaultMutex=new wU.Mutex}runTasksPreSetup(){}initializeControllers(){let{initState:e}=this;this.dappReportController=new wR,this.chainController=new Tu({initState:e.ChainController,chainUpdateCallback:this.chainUpdateCallback.bind(this)}),this.walletConfigController=new bh({initState:e.walletConfigController}),this.recordFirstTimeInfo(e),this.httpDnsController=new zu,Qp(this.httpDnsController.autoRefresh.bind(this.httpDnsController)),this.domainController=new Hu(this.httpDnsController),this.approvalController=new pu({showApprovalRequest:this.opts.showUserConfirmation}),this.authController=new UN({authMap:this.opts.authMap}),this.rpcController=new yh({networkController:this.networkController,walletConfigController:this.walletConfigController,notifyAllConnections:this.notifyAllConnections.bind(this),resetToAllNetwork:this.resetToAllNetwork.bind(this)}),this.networkController=new Sf(this.initIDBData.provider,this.rpcController,this.walletConfigController,this.on.bind(this,"unlock"),this.networkControllerProviderUpdate.bind(this)),this.keyringController=new QD({initState:e.KeyringController,chainController:this.chainController,setMpcAction:this.setMpcAction.bind(this),patchVaultWithPreferencesControllerWallets:this.patchVaultWithPreferencesControllerWallets.bind(this)}),this.keyringController.on("unlock",()=>this.emit("unlock")),this.keyringController.on("lock",(t=!1)=>this.onLock(t)),this.keyringController.on("updateWalletAddress",({walletId:t,addressType:n})=>{this.updateWalletAddress(t,n,{needUpdateBalance:!1,needUpdateSegwitAddressType:!0,needSync:!0,needEmitChangeAddress:!1})}),this.networkController.on(ac.NETWORK_WILL_CHANGE,this.clearDappData.bind(this)),this.preferencesController=new Th({initState:e.PreferencesController,initLangCode:this.opts.initLangCode,openPopup:this.opts.showUserConfirmation,network:this.networkController,keyring:this.keyringController,walletConfigController:this.walletConfigController,clearDappData:this.clearDappData.bind(this)}),this.ContextMenuController=new Eu({preferencesController:this.preferencesController}),this.mpcController=new oh({initState:e.MpcController,preferencesController:this.preferencesController,showUserConfirmation:this.opts.showUserConfirmation}),this.blinkController=new Cu,this.appStateController=new hu({addUnlockListener:this.on.bind(this,"unlock"),isUnlocked:this.isUnlocked.bind(this),initState:e.AppStateController,onInactiveTimeout:this.onInactiveTimeout.bind(this),showUnlockRequest:this.opts.showUserConfirmation,preferencesStore:this.preferencesController.store}),this.checkDomainController=new Iu({apiHostname:Xp(this.opts.initRemoteConfig)}),this.initializeProvider(),this.provider=this.networkController.getProviderAndBlockTracker().provider,this.blockTracker=this.networkController.getProviderAndBlockTracker().blockTracker,this.onboardingController=new xh({initState:e.OnboardingController,preferencesController:this.preferencesController}),this.walletCreateController=new Bq({initState:e.WalletCreateController,preferencesController:this.preferencesController,keyringController:this.keyringController,authController:this.authController,controller:this}),this.coinController=new lR({initState:e.CoinController,preferencesController:this.preferencesController,keyringController:this.keyringController,walletCreateController:this.walletCreateController,authController:this.authController,networkController:this.networkController,chainController:this.chainController,updateStateImmediately:this.privateSendPartialUpdate.bind(this)}),this.currencyController=new yR({initState:e.CurrencyController,preferencesController:this.preferencesController,coinController:this.coinController,updateStateImmediately:this.privateSendPartialUpdate.bind(this)}),this.balanceController=new Au({initState:e.balanceController,keyringController:this.keyringController,serverPushController:this.serverPushController,isUnlocked:this.isUnlocked.bind(this),preferencesController:this.preferencesController,authController:this.authController,coinController:this.coinController,networkController:this.networkController,currencyController:this.currencyController,walletCreateController:this.walletCreateController}),this.serverPushController=new Eh({preferencesController:this.preferencesController,keyringController:this.keyringController,coinController:this.coinController,balanceController:this.balanceController,unlockListener:this.on.bind(this,"unlock"),lockListener:this.on.bind(this,"lock"),domainController:this.domainController}),this.walletAggregateController=new Wh({initState:e.walletAggregateController,showUserConfirmation:this.opts.showUserConfirmation,closeCurrentWindow:this.platform.closeCurrentWindow.bind(this)}),this.instanceIDController=new ju,this.permissionsController=new Ob({approvals:this.approvalController,getRestrictedMethods:B2,getUnlockPromise:this.appStateController.getUnlockPromise.bind(this.appStateController),isUnlocked:this.isUnlocked.bind(this),notifyDomain:this.notifyConnections.bind(this),notifyAllDomains:this.notifyAllConnections.bind(this),preferences:this.preferencesController.store,domainChecker:this.checkDomainController,preferencesController:this.preferencesController,walletAggregateController:this.walletAggregateController,networkController:this.networkController,offlineTransaction:this.offlineTransaction.bind(this),walletConfigController:this.walletConfigController,getVersion:this.platform.getVersion.bind(this),getProviderConfig:this.networkController.getProviderConfig.bind(this.networkController),mpcController:this.mpcController,rpcController:this.rpcController,blinkController:this.blinkController,instanceIDController:this.instanceIDController,keyringController:this.keyringController},e.PermissionsController,e.PermissionsMetadata),this.txController=new Bh({initState:e.TransactionController||e.TransactionManager,getPermittedAccounts:this.permissionsController.getEthAccounts.bind(this.permissionsController),network:this.networkController.network,getCurrentChainId:this.networkController.getCurrentChainId.bind(this.networkController),getWeb3Provider:this.networkController.getWeb3Provider.bind(this.networkController),preferencesController:this.preferencesController,txHistoryLimit:40,getSignKeyring:this.keyringController.getSignKeyring.bind(this.keyringController),getKeyringByWalletId:this.keyringController.getKeyringByWalletId.bind(this.keyringController),provider:this.provider,blockTracker:this.blockTracker,coinController:this.coinController,authController:this.authController,dappReportController:this.dappReportController,getVersion:this.platform.getVersion.bind(this)}),this.txController.on("newUnapprovedTx",t=>(t?.id&&this.dappReportController.updateReportTimestamp(t.id,"OPEN_POPUP"),this.opts.showUserConfirmation(this.getDappEntry()))),this.messageManager=new Fh,this.personalMessageManager=new Hh,this.decryptMessageManager=new qh,this.encryptionPublicKeyManager=new Uh,this.typedMessageManager=new zh({getCurrentChainId:this.networkController.getCurrentChainId.bind(this.networkController)}),this.patchController01=new yK({initState:e.PatchController01,authController:this.authController,walletCreateController:this.walletCreateController,keyringController:this.keyringController,preferencesController:this.preferencesController}),this.coinBusiness=new gR({coinController:this.coinController,balanceController:this.balanceController,preferencesController:this.preferencesController,currencyController:this.currencyController,chainController:this.chainController}),this.addressController=new Kv({initState:e.addressController}),this.dappRequestController=new tO({initState:e.DappRequestController,preferencesController:this.preferencesController,keyringController:this.keyringController,authController:this.authController,publishTransactionToServer:this.publishTransactionToServer.bind(this)}),this.rpcEvmTokenController=new nq({initState:e.RpcEvmTokenController}),this.rpcEvmTransactionController=new iq({initState:e.RpcEvmTransactionController,rpcController:this.rpcController}),this.dexController=new Fu({keyringController:this.keyringController,preferencesController:this.preferencesController,authController:this.authController,chainController:this.chainController}),this.publishController=new YK({keyringController:this.keyringController,authController:this.authController,preferencesController:this.preferencesController,publishTransactionToServer:this.publishTransactionToServer.bind(this)}),this.dappRequestController.on("newUnapprovedRequest",()=>this.opts.showUserConfirmation(this.getDappEntry())),this.walletStandardController=new Rq({initState:e.walletStandardController}),this.accountController=new KM({keyringController:this.keyringController,walletCreateController:this.walletCreateController,preferencesController:this.preferencesController,coinController:this.coinController,balanceController:this.balanceController}),this.silenceController=new Ph({initState:e.SilenceController}),this.on("update",()=>this.onStateUpdate())}initializeStores(){let{initState:e}=this;this.sendUpdate=(0,g6.debounce)(this.privateSendUpdate.bind(this),200),this.sendPartialUpdate=(0,g6.debounce)(this.privateSendPartialUpdate.bind(this),200),this.store=new Pf(e),this.store.updateStructure({AppStateController:this.appStateController.store,TransactionController:this.txController.store,KeyringController:this.keyringController.store,PreferencesController:this.preferencesController.store,OnboardingController:this.onboardingController.store,PermissionsController:this.permissionsController.permissions,PermissionsMetadata:this.permissionsController.store,WalletCreateController:this.walletCreateController.store,CoinController:this.coinController.store,balanceController:this.balanceController.memStore,ServerPushController:this.serverPushController.store,CurrencyController:this.currencyController.store,PatchController01:this.patchController01.store,addressController:this.addressController.store,walletConfigController:this.walletConfigController.store,DappRequestController:this.dappRequestController.store,RpcEvmTokenController:this.rpcEvmTokenController.store,RpcEvmTransactionController:this.rpcEvmTransactionController.store,DexController:this.dexController.store,WalletAggregateController:this.walletAggregateController.store,walletStandardController:this.walletStandardController.store,MpcController:this.mpcController.store,SilenceController:this.silenceController.store}),this.memStore=new Pf(null,{AppStateController:this.appStateController.store,TxController:this.txController.memStore,MessageManager:this.messageManager.memStore,PersonalMessageManager:this.personalMessageManager.memStore,DecryptMessageManager:this.decryptMessageManager.memStore,EncryptionPublicKeyManager:this.encryptionPublicKeyManager.memStore,TypesMessageManager:this.typedMessageManager.memStore,KeyringController:this.keyringController.memStore,PreferencesController:this.preferencesController.store,OnboardingController:this.onboardingController.store,ServerPushController:this.serverPushController.store,PermissionsController:this.permissionsController.permissions,PermissionsMetadata:this.permissionsController.store,ApprovalController:this.approvalController,CoinBusiness:this.coinBusiness.memStore,addressController:this.addressController.store,walletConfigController:this.walletConfigController.store,DappRequestController:this.dappRequestController.memStore,RpcEvmTokenController:this.rpcEvmTokenController.store,RpcEvmTransactionController:this.rpcEvmTransactionController.store,walletCreateController:this.walletCreateController.store,WalletAggregateController:this.walletAggregateController.store,AccountController:this.accountController.memStore,MpcController:this.mpcController.store,SilenceController:this.silenceController.store}),this.partialMemStore=new fu({CurrencyController:this.currencyController.memStore,CoinController:this.coinController.memStore,ChainController:this.chainController.memStore,BalanceController:this.balanceController.memStore}),this.memStore.subscribe(()=>{this.sendUpdate()}),this.partialMemStore.subscribe(()=>{this.sendPartialUpdate()}),this.approvalController.subscribe(()=>{this.activeControllerConnections>0&&this.sendUpdate()})}runTasksPostSetup(){this.extension.runtime.getPlatformInfo().then(({os:t})=>{let n=this.extension.runtime.getBrowserInfo===void 0?"chrome":"firefox";this.appStateController.setBrowserEnvironment(t,n)}).catch(t=>{console.error(t)}),this.currencyController.getCurrencies(),this.chainController.getChainFromServer()}privateSendUpdate(){this.emit("update")}privateSendPartialUpdate(){let e=this.partialMemStore.flushDirtyFields();e&&this.emit("partialUpdate",e)}setMpcAction(...e){this.mpcController.setMpcAction(...e)}onInactiveTimeout(){return this.setLocked(!0)}getDappEntry(){return this.networkController.getRpcMode()?T0:I0}};d();f();var sj=_(te());d();f();var vU=_(K_()),toe=r=>{if(r)throw r};function q(r,e){return(...t)=>{let n=t[t.length-1],a=typeof n=="function",s;a?(s=n,t.pop()):s=toe;let i;try{i=Promise.resolve(r.apply(e,t))}catch(o){i=Promise.reject(o)}(0,vU.default)(i)(s)}}d();f();An();var b6=_(Fr());Ge();var Vh=class{async submitPassword(e){let t=await this.createVaultMutex.acquire();if(this.isUnlocked()){t();return}try{await this.keyringController.submitPassword(e)}catch(n){throw t(),b6.default.error("Error while unlocking extension.",n),new Error(e5)}try{let n=[];try{n=this.keyringController.getWallets(),n?.length||Ae.captureException(`${tn}-emptyWallets`)}catch(s){throw Ae.captureException(`${tn}-getWallets`),new Error(s)}try{await this.syncPreferencesData(n)}catch(s){throw new Error(s)}try{let{errorWalletIds:s,keyringIdentitiesCount:i,originKeyringIdentitiesCount:o}=await this.walletCreateController.updateAllKeyringIdentities();(s.length>0||o===0)&&A_(`${tn}-getAccountInfoByWalletId`,{errorWalletIds:s,keyringIdentitiesCount:i,originKeyringIdentitiesCount:o}),this.walletCreateController.syncUnsyncedWallets()}catch(s){throw Ae.captureException(`${tn}-updateAllKeyringIdentities`),new Error(s)}try{await Promise.all([this.syncSelectedWallet()])}catch(s){throw Ae.captureException(`${tn}-syncSelectedWallet`),new Error(s)}let a="";try{a=this.preferencesController.getSelectedWallet()}catch(s){throw Ae.captureException(`${tn}-getSelectedWallet`),new Error(s)}try{await this.patchController01.patchSyncDevId(a)}catch(s){throw Ae.captureException(`${tn}-patchSyncDevId`),new Error(s)}try{this.preferencesController._checkKeyringIdentities(!1);let s=this.preferencesController.getSelectedWallet();await this.walletCreateController.checkIsWalletNeedSync(s)}catch(s){Ae.captureException(`${tn}-checkIsWalletNeedSync`),console.log(s)}try{await this.patchOnSubmitPassword()}catch(s){throw Ae.captureException(`${tn}-patchOnSubmitPassword`),new Error(s)}try{this.keyringController.setUnlocked()}catch(s){throw Ae.captureException(`${tn}-setUnlocked`),new Error(s)}try{this.keyringController.fullUpdate()}catch(s){throw Ae.captureException(`${tn}-fullUpdate`),new Error(s)}}catch(n){throw b6.default.error("Error while unlocking extension.",n),new Error(t5)}finally{t()}return this.keyringController.fullUpdate()}async verifyPassword(e){await this.keyringController.verifyPassword(e)}};d();f();var Vz=_(H6()),$z=_(_F()),Yz=_(CF()),b4=_(On()),Jz=_(IF()),Xz=_(Fr()),Zz=_(Uv()),Qz=_(Jx());d();f();var wH=_(c3()),f3=_(yn());var d3=new Map,ip=class extends wH.Duplex{constructor(t,n){super({objectMode:!0});le(this,"onMessage",({data:t,target:n})=>{if(n===this.name)if(p.Buffer.isBuffer(t)){let a=p.Buffer.from(t);this.push(a)}else this.push(t)});le(this,"onDisconnect",()=>{let{lastError:t}=f3.default.runtime;t&&typeof this.opts.port=="string"?(d3.delete(this.opts.port),this.init()):this.destroy()});this.opts={port:n},this.name=t,this.init()}init(){if(this.removePortListener(),typeof this.opts.port=="string"){let t=d3.get(this.opts.port);t||(t=f3.default.runtime.connect({name:this.opts.port}),d3.set(this.opts.port,t)),this.port=t}else this.port=this.opts.port;this.port.onMessage.addListener(this.onMessage),this.port.onDisconnect.addListener(this.onDisconnect)}removePortListener(){this.port&&(this.port.onMessage.removeListener(this.onMessage),this.port.onDisconnect.removeListener(this.onDisconnect))}_read(){}_write(t,n,a){try{if(p.Buffer.isBuffer(t)){let s=t.toJSON();s._isBuffer=!0,this.port.postMessage({data:s,target:this.name})}else this.port.postMessage({data:t,target:this.name})}catch{return a(new Error("PortDuplexStream - disconnected"))}return a()}};d();f();d();f();d();f();d();f();var vH=_(Pr()),l3=_(Ce());var Le=class extends vH.default{constructor(e,{jsonRpcStreamName:t,logger:n=console,maxEventListeners:a=100,providerType:s}={}){super(),this.isOKExWallet=!0,this.isOkxWallet=!0,this.autoRefreshOnNetworkChange=!1,this.providerType=s,this.setMaxListeners(a),this.log=n;let{rpcEngine:i,jsonRpcConnection:o}=S5(e,t,this.handleStreamDisconnect.bind(this));this.rpcEngine=i,this.jsonRpcConnection=o,o.events.on(U.event.NOTIFICATION,c=>{let{method:l}=c;l==="wallet_streamFail"&&(this.emit(U.event.STREAM_FAILED),e.destroy(new Error(U.errors.permanentlyDisconnected())))})}rpcRequest(e,t){return Array.isArray(e)||e.jsonrpc||(e.jsonrpc="2.0"),t?this.rpcEngine.handle(e,t):new Promise((n,a)=>{this.rpcEngine.handle(e,_5(n,a))})}handleStreamDisconnect(e){this.handleDisconnect(new l3.EthereumRpcError(1011,e?.message||U.errors.permanentlyDisconnected()))}handleDisconnect(e){e?this.log.error(e):this.log.debug(new l3.EthereumRpcError(1013,U.errors.disconnected())),this.emit(U.event.DISCONNECT)}};var Ny,Ff=class extends Le{constructor(e,{jsonRpcStreamName:t,logger:n,provider:a}={}){super(e,{jsonRpcStreamName:t,logger:n}),this.selectedAccount=null,a.on(U.event.WALLET_CHANGED,async([s])=>{s?(await this.handleConnect(s),this.emit(U.event.ACCOUNT_CHANGED,this.selectedAccount)):this.emit(U.event.DISCONNECT)}),a.on(U.event.CONNECT_WALLET,([s])=>{this.handleConnect(s)}),Ny=a,a.aptos=this;try{window.aptos=this,window.petra=this}catch{console.log("")}}async isConnected(){return Boolean(this.selectedAccount)}async account(){return Ye(this.selectedAccount),this.selectedAccount}async network(){return(await this.request({method:Kt.NETWORK}))?.dappChainName}onNetworkChange(e){typeof e=="function"&&Ny.on(`${U.event.ISOMER_NETWORK_CHANGED}_${Rn}`,t=>{let n=t.currentNetwork;e({networkName:n?.dappChainName})})}onAccountChange(e){typeof e=="function"&&this.on(U.event.ACCOUNT_CHANGED,e)}onDisconnect(e){typeof e=="function"&&this.on(U.event.DISCONNECT,e)}async connect(){let[e]=await Ny.requestWallets(!0,{providerType:Rn});return this.handleConnect(e)}async disconnect(){return Ye(this.selectedAccount),await Ny.disconnect(),this.handleDisconnect()}request(e){Qe(e);let{method:t,params:n}=e;return t==="connect"?this.connect():t==="disconnect"?this.disconnect():super.rpcRequest({method:t,params:n})}async signAndSubmitTransaction(e){return this.request({method:Kt.SIGN_AND_SUBMIT_TRANSACTION,params:{transaction:e,extParams:e?.extParams}})}async signTransaction(e,t){e=T5(e);let n=await this.request({method:Kt.SIGN_TRANSACTION,params:{transaction:e,extParams:e?.extParams,options:t}});return p.Buffer.from(n,"hex")}async signMessage({address:e,application:t,chainId:n,message:a,nonce:s}){return this.request({method:Kt.SIGN_MESSAGE,params:{address:e,application:t,chainId:n,message:a,nonce:s}})}async handleConnect(e){let t=C5(e);if(this.selectedAccount=t,t){let n=await this.request({method:Kt.GET_PUBLIC_KEY,params:{address:t.address}});return t.publicKey=n,this.emit(U.event.CONNECT,t),t}return this.handleDisconnect(),null}handleDisconnect(e){this.selectedAccount=null,super.handleDisconnect(e)}};d();f();ne();d();f();var _H=_(Ce());ne();d();f();var ky=_(Ce());ne();d();f();var Hf=_(Ce()),Ry=_(te());ne();var Yfe=({okxProvider:r,providerType:e=zn,localType:t=pe})=>class extends Le{constructor(a,{jsonRpcStreamName:s,logger:i,provider:o}={}){super(a,{jsonRpcStreamName:s,logger:i}),this.selectedAccount=null,o.on(U.event.WALLET_CHANGED,async([c])=>{await this.handleConnect(c),this.emit(U.event.ACCOUNT_CHANGED,this.selectedAccount)}),o.on(U.event.CONNECT_WALLET,([c])=>{this.handleConnect(c)}),r=o}async setSelectedAccount(a){let s=R5(a,{localType:t});if(s){let i=await this.request({method:oe.GET_PUBLIC_KEY,params:{address:s.address,localType:t}}),o=await this.request({method:oe.GET_COMPRESSED_PUBLIC_KEY,params:{address:s.address,localType:t}});s.publicKey=i,s.compressedPublicKey=o,this.selectedAccount=s}return s}async getSelectedAccount(){if(this.selectedAccount)return this.selectedAccount;let[a]=await r.requestWallets(!1,{providerType:e});return this.setSelectedAccount(a)}async getSelectedAddress(){return(await this.getSelectedAccount())?.address}async connect(){let[a]=await r.requestWallets(!0,{providerType:e});return this.handleConnect(a)}async disconnect(){return await r.request({method:"wallet_disconnect"}),this.handleDisconnect()}request(a){Qe(a);let{method:s,params:i}=a;return s==="connect"?this.connect():s==="disconnect"?this.disconnect():super.rpcRequest({method:s,params:i})}async signMessage(a,s){let i;if(!(0,Ry.isString)(a))throw Hf.ethErrors.rpc.invalidParams(U.errors.expectStringMessage());if(typeof s=="object"){let{from:o,type:c="ecdsa"}=s;i={from:o,type:c}}else i={from:await this.getSelectedAddress(),type:s||"ecdsa"};return this.request({method:oe.SIGN_MESSAGE,params:{message:a,localType:t,...i}})}async handleConnect(a){let s=await this.setSelectedAccount(a);return s?(this.emit(U.event.CONNECT,s),s):(this.handleDisconnect(),null)}handleDisconnect(a){this.selectedAccount=null,super.handleDisconnect(a)}async signPsbt(a,s={}){let i=s.from;(0,Ry.isUndefined)(s.from)?i=await this.getSelectedAddress():s.autoFinalized=!1;let{type:o,amount:c=1,autoFinalized:l,toSignInputs:u}=s;return this.request({method:oe.SIGNPSBT,params:{transaction:{from:i,psbt:a,type:o,amount:c,psbtOpts:{autoFinalized:l,toSignInputs:u}},localType:t}})}async signPsbts(a,s){return this.request({method:oe.SIGNPSBTS,params:{transaction:{from:await this.getSelectedAddress(),psbts:a,psbtOpts:s},localType:t}})}async pushTx(a){if(!a)throw Hf.ethErrors.rpc.invalidParams({message:U.errors.invalidParams()});return this.request({method:oe.PUSH_TX,params:{transaction:{from:await this.getSelectedAddress(),rawTx:a},localType:t}})}async pushPsbt(a){if(!a)throw Hf.ethErrors.rpc.invalidParams({message:U.errors.invalidParams()});return this.request({method:oe.PUSH_PSBT,params:{transaction:{from:await this.getSelectedAddress(),psbtHex:a},localType:t}})}async getBalance(){return await this.request({method:oe.GET_BALANCE,params:{transaction:{from:await this.getSelectedAddress()},localType:t}})}async validAddress(a){let{isValid:s}=await this.request({method:oe.VALIDATE_ADDRESS,params:{address:a,localType:t}});if(!s)throw Hf.ethErrors.rpc.invalidParams({message:U.errors.invalidBitcoinAddress(a)})}async send({memo:a,memoPos:s,from:i,to:o,value:c,satBytes:l="",extraParams:u}){if(await this.validAddress(o),a&&(typeof s!="number"||typeof a!="string"))throw Hf.ethErrors.rpc.invalidParams({message:U.errors.invalidTransaction()});return this.request({method:oe.SEND,params:{transaction:{from:i,to:o,memo:a,memoPos:s,value:c,satBytes:l,extraParams:u},localType:t}})}async sendBitcoin(a,s,i){let o=await this.getSelectedAddress();return await this.validAddress(a),this.request({method:oe.SEND_BTC,params:{transaction:{from:o,toAddress:a,satoshis:s,options:i},localType:t}})}},ji=Yfe;var Jfe=({providerType:r=zn,localType:e=pe})=>{let t=ji({okxProvider:{},providerType:r,localType:e});return class extends t{async splitUtxo({from:a,amount:s=2}){return this.request({method:oe.SPLITUTXO,params:{transaction:{from:a,amount:s},localType:e}})}async inscribe({from:a,tick:s,tid:i,type:o,txSource:c}){if(!s&&!i)throw ky.ethErrors.rpc.invalidParams({message:U.errors.invalidRequestArgs(),data:{tick:s,tid:i}});return this.request({method:oe.INSCRIBE,params:{transaction:{from:a,tick:s,tid:i,type:o,txSource:c},localType:e}})}async mint({from:a,to:s,type:i,inscriptions:o,tid:c,tick:l,txSource:u,amount:h,mintType:b=h8.parallel}){if(!o||!Array.isArray(o)||o.length===0||o.some(y=>!y?.body||typeof y.body!="string"))throw ky.ethErrors.rpc.invalidParams({message:U.errors.invalidRequestArgs(),data:{inscriptions:o}});return this.request({method:oe.MINT,params:{transaction:{from:a,to:s,type:i,inscriptions:o,tid:c,tick:l,txSource:u,amount:h,mintType:b},localType:e}})}async sendPsbt(a,s){return this.request({method:oe.SEND_PSBT,params:{transaction:{from:s,txs:a},localType:e}})}async transferNft({from:a,to:s,data:i,type:o}){let{isValid:c}=await this.request({method:oe.VALIDATE_ADDRESS,params:{address:s},localType:e});if(!c||!i)throw ky.ethErrors.rpc.invalidParams({message:U.errors.invalidBitcoinAddress(s)});return this.request({method:oe.TRANSFER_NFT,params:{transfer:{from:a,to:s,data:i,type:o},localType:e}})}async watchAsset({name:a}){return this.request({method:oe.WATCHASSET,params:{name:a,localType:e}})}}},SH=Jfe;var Xfe=({providerType:r=zn,localType:e=pe,providerName:t="bitcoin"})=>{let n=SH({providerType:r,localType:e});return class extends n{constructor(s,{jsonRpcStreamName:i,logger:o,provider:c}={}){super(s,{jsonRpcStreamName:i,logger:o,provider:c}),c[t]=this,this.on(U.event.ACCOUNT_CHANGED,l=>{this.emit(U.event.ACCOUNTS_CHANGED,l?.address?[l.address]:[])})}async requestAccounts(){let s=await this.connect();return s?[s.address]:[]}async getAccounts(){let s=await this.getSelectedAddress();return s?[s]:[]}async getNetwork(){return Promise.resolve("livenet")}async switchNetwork(){throw Error("Not implemented")}async getPublicKey(){let s=await this.getSelectedAccount();return s?s.compressedPublicKey:""}async getInscriptions(s=0,i=20){return await this.request({method:oe.GET_INSCRIPTIONS,params:{transaction:{from:await this.getSelectedAddress(),cursor:s,size:i}}})}async sendInscription(s,i,o){if(await this.validAddress(s),!i)throw _H.ethErrors.rpc.invalidParams({message:U.errors.invalidParams()});return await this.request({method:oe.SEND_INSCRIPTION,params:{transfer:{from:await this.getSelectedAddress(),to:s,data:i,options:o}}})}async inscribeTransfer(s,i){return this.request({method:oe.INSCRIBE_TRANSFER,params:{transaction:{from:await this.getSelectedAddress(),tick:s,amount:i}}})}}},AH=Xfe;d();f();ne();var Zfe=()=>{let r=ji({okxProvider:{},providerType:td,localType:mo});return class extends r{constructor(t,{jsonRpcStreamName:n,logger:a,provider:s}={}){super(t,{jsonRpcStreamName:n,logger:a,provider:s}),s.bitcoinSignet=this}}},CH=Zfe;d();f();ne();var Qfe=()=>{let r=ji({okxProvider:{},providerType:ed,localType:po});return class extends r{constructor(t,{jsonRpcStreamName:n,logger:a,provider:s}={}){super(t,{jsonRpcStreamName:n,logger:a,provider:s}),s.bitcoinTestnet=this}}},TH=Qfe;d();f();ne();var ele=()=>{let r=ji({okxProvider:{},providerType:rd,localType:En});return class extends r{constructor(t,{jsonRpcStreamName:n,logger:a,provider:s}={}){super(t,{jsonRpcStreamName:n,logger:a,provider:s}),s.fractalBitcoin=this}}},IH=ele;var u3=AH({providerType:zn,localType:pe,providerName:"bitcoin"}),h3=TH(),p3=CH(),m3=IH();d();f();ne();d();f();var ha=(r,e)=>(r?.address||[]).find(a=>a.name===e)?.address;d();f();Nx();var $s="OKX Wallet",Gf=qc,Vi="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAJDSURBVHgB7Zq9jtpAEMfHlhEgQLiioXEkoAGECwoKxMcTRHmC5E3IoyRPkPAEkI7unJYmTgEFTYwA8a3NTKScLnCHN6c9r1e3P2llWQy7M/s1Gv1twCP0ej37dDq9x+Zut1t3t9vZjDEHIiSRSPg4ZpDL5fxkMvn1cDh8m0wmfugfO53OoFQq/crn8wxfY9EymQyrVCqMfHvScZx1p9ls3pFxXBy/bKlUipGPrVbLuQqAfsCliq3zl0H84zwtjQrOw4Mt1W63P5LvBm2d+Xz+YzqdgkqUy+WgWCy+Mc/nc282m4FqLBYL+3g8fjDxenq72WxANZbLJeA13zDX67UDioL5ybXwafMYu64Ltn3bdDweQ5R97fd7GyhBQMipx4POeEDHIu2LfDdBIGGz+hJ9CQ1ABjoA2egAZPM6AgiCAEQhsi/C4jHyPA/6/f5NG3Ks2+3CYDC4aTccDrn6ojG54MnEvG00GoVmWLIRNZ7wTCwDHYBsdACy0QHIhiuRETxlICWpMMhGZHmqS8qH6JLyGegAZKMDkI0uKf8X4SWlaZo+Pp1bRrwlJU8ZKLIvUjKh0WiQ3sRUbNVq9c5Ebew7KEo2m/1p4jJ4qAmDaqDQBzj5XyiAT4VCQezJigAU+IDU+z8vJFnGWeC+bKQV/5VZ71FV6L7PA3gg3tXrdQ+DgLhC+75Wq3no69P3MC0NFQpx2lL04Ql9gHK1bRDjsSBIvScBnDTk1WrlGIZBorIDEYJj+rhdgnQ67VmWRe0zlplXl81vcyEt0rSoYDUAAAAASUVORK5CYII=",EH="com.okex.wallet";var Oy={apiVersion:Gf,icon:Vi,name:$s},as={},tle=1,PH,zf=class extends Le{constructor(e,{jsonRpcStreamName:t,logger:n,provider:a}={}){super(e,{jsonRpcStreamName:t,logger:n}),this.selectedAddress=null,a.on(U.event.WALLET_CHANGED,([s])=>{this.handleConnect(s),this.emit(U.event.ACCOUNT_CHANGED,this.selectedAddress)}),a.on(U.event.CONNECT_WALLET,([s])=>{this.handleConnect(s)}),PH=a,Oy.isEnabled=this.isEnabled.bind(this),Oy.enable=this.enable.bind(this),as.getNetworkId=this.getNetworkId.bind(this),as.getUsedAddresses=this.getUsedAddresses.bind(this),as.getUnusedAddresses=this.getUnusedAddresses.bind(this),as.getChangeAddress=this.getChangeAddress.bind(this),as.getUtxos=this.getUtxos.bind(this),as.getBalance=this.getBalance.bind(this),as.signData=this.signData.bind(this),as.signTx=this.signTx.bind(this),as.submitTx=this.submitTx.bind(this),a.cardano=Oy;try{window.cardano={...window.cardano||{},okxwallet:Oy}}catch{console.log()}}request(e){Qe(e);let{method:t,params:n}=e;return super.rpcRequest({method:t,params:n})}handleDisconnect(e){this.selectedAddress=null,super.handleDisconnect(e)}async handleConnect(e){let t=ha(e,Gr);return t?(this.selectedAddress=t,this.emit(U.event.CONNECT,t),as):(this.handleDisconnect(),null)}async isEnabled(){return Boolean(this.selectedAddress)}async enable(){let[e]=await PH.requestWallets(!0,{providerType:Qc});return this.handleConnect(e)}async getNetworkId(){return Ye(this.selectedAddress),tle}async getAddress(){return await this.request({method:br.GET_ADDRESS})}async getUsedAddresses(){return Ye(this.selectedAddress),[await this.getAddress()]}async getUnusedAddresses(){return Ye(this.selectedAddress),[]}async getChangeAddress(){return Ye(this.selectedAddress),await this.getAddress()}async getUtxos(e){return Ye(this.selectedAddress),await this.request({method:br.GET_UTXOS,params:{amount:e}})}async getBalance(){return Ye(this.selectedAddress),await this.request({method:br.GET_BALANCE})}async signData(e="",t=""){return Ye(this.selectedAddress),await this.request({method:br.SIGN_DATA,params:{address:e,payload:t}})}async signTx(e){return Ye(this.selectedAddress),await this.request({method:br.SIGN_TX,params:{tx:e}})}async submitTx(e){return Ye(this.selectedAddress),await this.request({method:br.SUBMIT_TX,params:{tx:e}})}};d();f();var jf=_(sm()),y3=_(ql());d();f();var Dy=class{constructor(e,t){this.chainId=e,this.keplr=t}async getPubkey(){return this.keplr.getEnigmaPubKey(this.chainId)}async getTxEncryptionKey(e){return this.keplr.getEnigmaTxEncryptionKey(this.chainId,e)}async encrypt(e,t){return this.keplr.enigmaEncrypt(this.chainId,e,t)}async decrypt(e,t){return this.keplr.enigmaDecrypt(this.chainId,e,t)}};d();f();d();f();d();f();var pc=class{constructor(e,t){this.chainId=e,this.keplr=t}async getAccounts(){let e=await this.keplr.getKey(this.chainId);return[{address:e.bech32Address,algo:e.algo,pubkey:e.pubKey}]}async signAmino(e,t){if(this.chainId!==t.chain_id)throw new Error("Unmatched chain id with the offline signer");if((await this.keplr.getKey(t.chain_id)).bech32Address!==e)throw new Error("Unknown signer address");return this.keplr.signAmino(this.chainId,e,t)}async sign(e,t){return this.signAmino(e,t)}};var op=class extends pc{async signDirect(e,t){if(this.chainId!==t.chainId)throw new Error("Unmatched chain id with the offline signer");if((await this.keplr.getKey(t.chainId)).bech32Address!==e)throw new Error("Unknown signer address");return this.keplr.signDirect(this.chainId,e,t)}};var g3,b3=new Map,Vf=class extends Le{constructor(e,{jsonRpcStreamName:t,logger:n,provider:a}={}){super(e,{jsonRpcStreamName:t,logger:n}),this.selectedAccount=null,this.defaultOptions={},a.on(U.event.WALLET_CHANGED,async([s])=>{await this.handleConnect(s),this.emit(U.event.ACCOUNT_CHANGED,this.selectedAccount)}),a.on(U.event.CONNECT_WALLET,([s])=>{this.handleConnect(s)}),g3=a,a.keplr=this;try{window.keplr=this,window.getOfflineSigner=this.getOfflineSigner.bind(this),window.getOfflineSignerOnlyAmino=this.getOfflineSignerOnlyAmino.bind(this),window.getOfflineSignerAuto=this.getOfflineSignerAuto.bind(this),window.getEnigmaUtils=this.getEnigmaUtils.bind(this)}catch{console.log("")}}async connect({chainIds:e}){let[t]=await g3.requestWallets(!0,{providerType:$c,exts:{cosmosChainIds:e}});return this.handleConnect(t)}async disconnect(){return Ye(this.selectedAccount),await g3.disconnect(),this.handleDisconnect()}request(e){Qe(e);let{method:t,params:n}=e;return t==="connect"?this.connect():t==="disconnect"?this.disconnect():super.rpcRequest({method:t,params:n})}async enable(e){await this.connect({chainIds:e})}async experimentalSuggestChain(){}async getKey(e){let t=await this.request({method:ze.GET_CHAIN_BY_CHAIN_ID,params:{chainId:e}});await this.connect({chainIds:[e]});let n=this.selectedAccount?.account[t];if(!n)throw new Error(U.errors.invalidCosmosChainId(e));let{pubKey:a,hexAddress:s,algo:i}=await this.request({method:ze.GET_PUBLIC_KEY_AND_HEX_ADDRESS,params:{address:n,baseChain:t,chainId:e}});return{address:new Uint8Array(p.Buffer.from(s,"hex")),algo:i,bech32Address:n,isNanoLedger:!1,name:this.selectedAccount.name,pubKey:new Uint8Array(p.Buffer.from(a,"hex"))}}async sendTx(e,t){let n=await this.request({method:ze.SEND_TX,params:{transaction:{chainId:e,tx:t}}});return new Uint8Array(p.Buffer.from(n,"hex"))}async signAmino(e,t,n,a={}){if((0,y3.default)(n,"msgs[0].type","")==="sign/MsgSignData"){let i=(0,y3.default)(n,"msgs[0].value.data","");return this.request({method:ze.SIGN_ARBITRARY,params:{transaction:{chainId:e,signer:t,data:i,resultType:"amino"}}})}return this.request({method:ze.SIGN_AMINO,params:{transaction:{chainId:e,signer:t,signDoc:n,signOptions:Xx(this.defaultOptions.sign??{},a)}}})}async signDirect(e,t,n,a={}){let s=await this.request({method:ze.SIGN_DIRECT,params:{transaction:{chainId:e,signer:t,signDoc:{bodyBytes:n.bodyBytes instanceof Uint8Array?n.bodyBytes:(0,jf.fromBase64)(n.bodyBytes),authInfoBytes:n.authInfoBytes instanceof Uint8Array?n.authInfoBytes:(0,jf.fromBase64)(n.authInfoBytes),chainId:n.chainId,accountNumber:n.accountNumber?n.accountNumber.toString():null},signOptions:Xx(this.defaultOptions.sign??{},a)}}}),i=s.signed;return{signed:{bodyBytes:(0,jf.fromHex)(i.bodyBytes),authInfoBytes:(0,jf.fromHex)(i.authInfoBytes),chainId:i.chainId,accountNumber:i.accountNumber},signature:s.signature}}async signArbitrary(e,t,n){return this.request({method:ze.SIGN_ARBITRARY,params:{transaction:{chainId:e,signer:t,data:n}}})}async signICNSAdr36(e,t,n,a,s){throw new Error(U.errors.methodNotSupport(e,t,n,a,s))}async verifyArbitrary(e,t,n,a){return this.request({method:ze.VERIFY_ARBITRARY,params:{transaction:{chainId:e,signer:t,data:n,signature:a}}})}async signEthereum(e,t,n,a){return this.request({method:ze.SIGN_ETHEREUM,params:{transaction:{chainId:e,signer:t,data:n,type:a}}})}async suggestToken(e,t,n){throw new Error(U.errors.methodNotSupport(e,t,n))}async getSecret20ViewingKey(e,t){throw new Error(U.errors.methodNotSupport(e,t))}async getEnigmaPubKey(e){throw new Error(U.errors.methodNotSupport(e))}async getEnigmaTxEncryptionKey(e,t){throw new Error(U.errors.methodNotSupport(e,t))}async enigmaEncrypt(e,t,n){throw new Error(U.errors.methodNotSupport(e,t,n))}async enigmaDecrypt(e,t,n){throw new Error(U.errors.methodNotSupport(e,t,n))}async experimentalSignEIP712CosmosTx_v0(e,t,n,a,s={}){throw new Error(U.errors.methodNotSupport(e,t,n,a,s))}async getChainInfosWithoutEndpoints(){throw new Error(U.errors.methodNotSupport())}getOfflineSigner(e){return new op(e,this)}getOfflineSignerOnlyAmino(e){return new pc(e,this)}async getOfflineSignerAuto(e){return(await this.getKey(e)).isNanoLedger?new pc(e,this):new op(e,this)}getEnigmaUtils(e){if(b3.has(e))return b3.get(e);let t=new Dy(e,this);return b3.set(e,t),t}async handleConnect(e){let t=await this.request({method:ze.GET_SUPPORT_CHAINS}),n=P5(e,t);return this.selectedAccount=n,n?(this.emit(U.event.CONNECT,n),n):(this.handleDisconnect(),null)}handleDisconnect(e){this.selectedAccount=null,super.handleDisconnect(e)}};d();f();var NH=_(Ce());ne();var MH,$f=class extends Le{constructor(e,{jsonRpcStreamName:t,logger:n,provider:a}={}){super(e,{jsonRpcStreamName:t,logger:n}),this.selectedAddress=null,a.on(U.event.WALLET_CHANGED,([s])=>{this.handleConnect(s),this.emit(U.event.ACCOUNT_CHANGED,this.selectedAddress)}),a.on(U.event.CONNECT_WALLET,([s])=>{this.handleConnect(s)}),MH=a,a.kaspa=this}request(e){Qe(e);let{method:t,params:n}=e;return t==="connect"?this.connect():super.rpcRequest({method:t,params:n})}async handleConnect(e){let t=ha(e,Qs);return t?(this.selectedAddress=t,this.emit(U.event.CONNECT,t),t):(this.handleDisconnect(),null)}async connect(){let[e]=await MH.requestWallets(!0,{providerType:ad});return this.handleConnect(e)}async signMessage(e){if(typeof e!="string")throw NH.ethErrors.rpc.invalidParams({message:"'args.params' must be an object or array if provided."});return this.request({method:ld.SIGN_MESSAGE,params:{message:e}})}};d();f();d();f();ne();var kH=r=>(r?.address||[]).find(n=>n.name===ln)?.address,RH="FunctionCall",rle=r=>r.map(e=>{let t=e;if(e.type&&e.params){if(e.type!==RH)throw new Error(`Only '${RH}' actions types are supported`);t=e.params}return ArrayBuffer.isView(t.args)&&(t.isUint8ArrayArgs=!0),t}),Ly=r=>({receiverId:r.receiverId,actions:rle(r.actions)});var x3,Yf=class extends Le{constructor(e,{jsonRpcStreamName:t,logger:n,provider:a}={}){super(e,{jsonRpcStreamName:t,logger:n}),this.accountId=null,a.on(U.event.WALLET_CHANGED,async([s])=>{await this.handleConnect(s),this.emit(U.event.ACCOUNT_CHANGED,this.accountId)}),a.on(U.event.CONNECT_WALLET,([s])=>{this.handleConnect(s)}),x3=a,a.near=this;try{window.near=this}catch{}}requestSignIn(e={}){return this.connect(e)}async connect({contractId:e,methodNames:t}){let[n]=await x3.requestWallets(!0,{providerType:sd,exts:{alwaysNeedProof:!!e}}),a=await this.handleConnect(n);if(e){let s=Array.isArray(t)?t:[],i=await this.request({method:Ze.GET_TEMP_KEY_PAIR,params:{contractId:e,accountId:a,methodNames:s,origin:window.location.origin}});return this.emit(U.event.SIGNIN,this.accountId),{accountId:a,accessKey:i}}return this.emit(U.event.SIGNIN,this.accountId),{accountId:a}}async handleConnect(e){let t=kH(e);return this.accountId=t,t||(this.handleDisconnect(),null)}getAccountId(){return this.accountId}isConnected(){return!!this.getAccountId()}isSignedIn(){return this.isConnected()}signOut(){return this.disconnect()}async disconnect(){return Ye(this.accountId),await x3.disconnect(),this.emit(U.event.SIGNOUT,this.accountId),this.handleDisconnect()}handleDisconnect(e){this.accountId=null,super.handleDisconnect(e)}sendMoney({receiverId:e,amount:t}){return this.request({method:Ze.SEND_MONEY,params:{receiverId:e,amount:t}})}signAndSendTransaction(e){let t=Ly(e);return this.request({method:Ze.SIGN_AND_SEND_TRANSACTION,params:{transaction:t}})}signTransaction(e){let t=Ly(e);return this.request({method:Ze.SIGN_TRANSACTION,params:{transaction:t}})}requestSignTransactions({transactions:e}){let t=e.map(n=>Ly(n));return this.request({method:Ze.REQUEST_SIGN_TRANSACTIONS,params:{transactions:t}})}request(e){Qe(e);let{method:t,params:n}=e;return t==="connect"?this.connect():t==="disconnect"?this.disconnect():super.rpcRequest({method:t,params:n})}signMessage(e){let t=e?.nonce;return t&&(e.nonce=D5(t)),this.request({method:Ze.SIGN_MESSAGE,params:{message:e}})}};d();f();ne();var OH,Jf=class extends Le{constructor(e,{jsonRpcStreamName:t,logger:n,provider:a}={}){super(e,{jsonRpcStreamName:t,logger:n}),this.selectedAccount=null;let s=async([i])=>{await this.handleConnect(i)&&this.emit("accountChanged")};a.on(U.event.WALLET_CHANGED,s),a.on(U.event.CONNECT_WALLET,s),OH=a,a.nostr=this}async beforeCheck(){this.selectedAccount||await this.connect()}get nip04(){return{encrypt:async(e,t)=>(await this.beforeCheck(),this.request({method:hn.ENCRYPT_TEXT_04,params:{message:{pubKey:e,text:t}}})),decrypt:async(e,t)=>(await this.beforeCheck(),this.request({method:hn.DECRYPT_TEXT_04,params:{message:{pubKey:e,text:t}}}))}}request(e){return Qe(e),super.rpcRequest(e)}async handleConnect(e){let t=ha(e,qn);if(t){let n=await this.request({method:hn.GET_PUBLIC_KEY,params:{address:t}});return this.selectedAccount={address:t,publicKey:n},this.selectedAccount}return this.selectedAccount=null,this.handleDisconnect(),null}async connect(){let[e]=await OH.requestWallets(!0,{providerType:nd});return e}async getPublicKey(){if(this.selectedAccount)return this.selectedAccount.publicKey;let e=await this.connect();return(await this.handleConnect(e))?.publicKey}async signEvent(e){return await this.beforeCheck(),this.request({method:hn.SIGN_EVENT,params:{event:e}})}async on(...e){await this.beforeCheck(),super.on(...e)}async off(...e){await this.beforeCheck(),super.off(...e)}};d();f();d();f();d();f();var BH=_(te());d();f();var $i="selectWallet";Tn();d();f();var DH=_(te());var By=new Map;function cp(r,e){if(By.get(r))return[];if(e)return By.set(r,!0),[{name:"OKX",logo:"/cdn/assets/imgs/234/C34D0D355B1D0EC9.png",provider:r}];if(r.isBitKeep)return[{provider:r,name:"Bitkeep",logo:"/cdn/assets/imgs/234/34E6216C5F62A7FE.png"}];if(r.isXDEFI)return[{provider:r,name:"XDEFI",logo:"/cdn/assets/imgs/234/DB3AD2876816006F.png"}];if(r?.isTrust)return[{provider:r,name:"Trust",logo:"/cdn/assets/imgs/234/EA4C335397A2E158.png"}];if(r?.isRabby)return[{provider:r,name:"Rabby",logo:"/cdn/assets/imgs/234/DE483C1F5531660D.png"}];if(r?.isCoin98)return[{provider:r,name:"Coin98",logo:"/cdn/assets/imgs/234/665E2DBD0BBA6C32.png"}];if(r?.isMathWallet)return[{provider:r,name:"Math",logo:"/cdn/assets/imgs/234/F5582D559D0F67BD.png"}];if(r?.providers){let t=[];return r.providers.forEach(n=>{By.get(n)||(By.set(n,!0),n.isCoinbaseWallet?t.push({provider:n,name:"Coinbase",logo:"/cdn/assets/imgs/234/8B1B1C6181774536.png"}):t.push(...cp(n)))}),t}return r?.isMetaMask&&!r.isBitKeep&&!r.isRabby&&(0,DH.isUndefined)(r._isReady)&&!r.isMathWallet&&!r.isCoin98&&!r.isSafePal?[{provider:r,name:"MetaMask",logo:"/cdn/assets/imgs/234/3B90D6BC7F8D72C8.png"}]:[]}d();f();var mc="isWhitelist";var w3=qp.init({cookieInterceptLevel:0,cookieInterceptMaxAge:60*60*6}),v3=r=>JSON.parse(localStorage.getItem(r)||"{}"),S3=(r,e)=>{localStorage.setItem(r,JSON.stringify(e))};function WH(r){return!["OKX","Rabby"].some(t=>r===t)}var ale=r=>w3.get(r),KH=(r,e,t)=>w3.set(r,e,t),Wy=r=>w3.remove(r);function qH(r,e){["accountsChanged","chainChanged","connect","disconnect"].forEach(n=>{e.on(n,(...a)=>{r.emit(n,...a)})})}function Ys(r,e,t){return(0,BH.isUndefined)(r[e])||typeof r[e]=="function"||typeof t=="function"}function UH(r,e){r.request({method:"wallet_injectProvider",params:e.map(({name:t,logo:n})=>({name:t,logo:n}))})}var LH=!1;function _3(r){if(LH)return;let e=r.getProviderList(),t=ale($i),n=e.findIndex(a=>a.name===t);if(t&&n>-1&&e[n]?.provider){let a=r.getSwapProxy();r.setCacheProvider(a.target),r.getSwapProxy().setTarget(e[n].provider),LH=!0}}function FH({name:r,provider:e}){switch(r){case"XDEFI":return!e._ready?.isLocked;case"Rabby":return e._isReady;default:return!0}}var A3=(r,e)=>new Proxy(r,{get(n,a){if(v3(mc)===!0)return Reflect.get(n,a);switch(a){case"send":return async(s,i)=>{if(typeof s=="string"&&(!i||Array.isArray(i)))return e({request:a,method:s},s,i);if(s&&typeof s=="object"&&typeof i=="function")return e({request:a,method:s.method},s,i);throw new Error(U.errors.methodNotSupport())};case"sendAsync":return async(s,i)=>e({request:a,method:s.method},s,i);case"request":return async s=>e({request:a,method:s.method},s);default:return Reflect.get(n,a)}},set(n,a,s){return Ys(n,a,s)?!0:Reflect.set(n,a,s)}});var sle=ko();function HH(r){let e={uuid:sle,name:$s,icon:Vi,rdns:EH};window.dispatchEvent(new CustomEvent("eip6963:announceProvider",{detail:Object.freeze({info:e,provider:r})}))}function ile(r){window.addEventListener("eip6963:requestProvider",()=>{HH(r)})}function GH(r){let e=Object.create(r),t=r.request;e.request=s=>t.call(this,s,{calledThrough6963:!0});let n=Object.keys(e),a=new Proxy(e,{ownKeys(s){return Array.from(new Set([...Reflect.ownKeys(s),...Reflect.ownKeys(r)]))},getOwnPropertyDescriptor(s,i){return Reflect.getOwnPropertyDescriptor(s,i)||Reflect.getOwnPropertyDescriptor(r,i)},has(s,i){return Reflect.has(s,i)||Reflect.has(r,i)},getPrototypeOf(){return Reflect.getPrototypeOf(r)},set(s,i,o){return Ys(r,i,o)?!0:n.includes(i)?Reflect.set(s,i,o):Reflect.set(r,i,o)}});ile(a),HH(a)}un();d();f();d();f();d();f();var E3=_(te());d();f();d();f();var T3="okx-inject",ole="alert-disconnect",dt=`${T3}-${ole}`,gc,I3,cle=({title:r="",buttonName:e="",logo:t="",staticHost:n,isOkx:a=!1,otherTitle:s=""})=>`
    <div id='${dt}' class='${dt}-wrapper'>
      <div>
        <img class='${dt}-logo' src='https://${n}${t}' />
      </div>
      <div class='${dt}-content'>
        <p class='${dt}-main-title'>
          ${a?r:s}
        </p>
        <p class='${dt}-button' id='${dt}-reselect'>
          ${e}
        </p>
      </div>
      <img class='${dt}-close' id='${dt}-close-button' src='https://${n}/cdn/assets/imgs/2312/E4B8A33728424506.png'>
    </div>
  `,dle=()=>`
    .${dt}-wrapper {

      width: 400px;
      padding: 16px;
      bottom: 35px;
      right: 20px;
      border-radius: 12px;
      background: #fff;
      border: 1px solid #dbdbdb;
      box-shadow: 0px 20px 25px 0px rgba(0, 0, 0, 0.10);
      display: flex;
      position: fixed;
      /* cover website element */
      z-index: 100000;
      font-family: ${u5};
      pointer-events: none;
    }

    .${dt}-wrapper .${dt}-content {
      flex: 1;
      display: flex;
      align-item: center;
      margin-left: 16px;
      flex-direction: column;
    }

    .${dt}-wrapper .${dt}-content p {
      font-size: 14px;
      font-style: normal;
      font-weight: 500;
      line-height: 24px;
      margin: 0;
    }

    .${dt}-wrapper .${dt}-content .${dt}-main-title {
      color: #000;
    }

    .${dt}-wrapper .${dt}-content .${dt}-button {
      color: #000;
      cursor: pointer;
      width: fit-content;
      pointer-events: auto;
    }

    .${dt}-wrapper .${dt}-logo {
      width: 32px;
      height: 32px;
    }

    .${dt}-wrapper .${dt}-close {
      width: 16px;
      height: 16px;
      padding: 3px;
      cursor: pointer;
      pointer-events: auto;
    }
  `,zH,C3=()=>{gc?.remove(),gc=null,I3=null,clearTimeout(zH)},fle=(r,e)=>{r.innerHTML=cle(e);let t=document.createElement("style");t.textContent=dle(),r.appendChild(t),zH=setTimeout(()=>{C3()},10*1e3),r.getElementById(`${dt}-close-button`).addEventListener("click",()=>{C3()}),r.getElementById(`${dt}-reselect`).addEventListener("click",()=>{e.reselect(),C3()})},jH=async(r,e,t,n)=>{if(document.getElementById(T3))return;let a=await r.request({method:"wallet_disconnectAlert"}),{fontSrc:s}=a;document.head.insertAdjacentHTML("beforeend",`<style>
      @font-face {
        font-family: ${l5};
        src: url("${s}") format("woff2"),
        url("${s}") format("woff");
      }
    </style>`),gc||(gc=document.createElement("div"),gc.setAttribute("id",T3),document.body.appendChild(gc),I3=gc?.attachShadow({mode:"open"})),fle(I3,{...a,isOkx:e,logo:t,reselect:n})};d();f();var Ky=_(te());var lle="mainnet",ule=r=>{let t=(r?.address||[]).find(n=>n.name===lle);return t?.address?[t.address]:[]},VH=(0,Ky.debounce)((r,e)=>{r.emit(U.event.CONNECT_WALLET,e),r.handleConnect(),r.handleAccountsChanged(ule(e[0]))},200),$H=(r,e={})=>{let t=r;function n(s){t=s}return new Proxy(r,{get:(s,i)=>i==="setTarget"?n:i==="target"?t:(0,Ky.has)(e,i)?e[i]:t[i],set:(s,i,o)=>{if(i==="setTarget")return n=o,!0;try{return t[i]=o,!0}catch{return!0}},defineProperty:()=>!0})};d();f();var qy=!1;async function Uy({okxProvider:r,hijackData:e,request:t,args:n},a,s){let{method:i}=n;if(i==="eth_requestAccounts"||i==="wallet_requestPermissions"){let o=e.getProviderList().filter(FH);if(e.setProviderList(o),UH(r,o),o.length>1){if(qy)return Promise.reject({code:4001});qy=!0,e.setCacheProvider(e.getSwapProxy().target);try{let c=await r.rpcRequest({method:"wallet_aggregate"});qy=!1;let l=o[c].provider;e.getSwapProxy().setTarget(l);let u=await l[t](a,s);if(u.length>0||u.result.length>0||t==="sendAsync")WH(o[c].name)&&qH(r,l);else{let h=e.getCacheProvider();return e.getSwapProxy().setTarget(h),await Promise.reject({code:4001})}return KH($i,o[c].name,{expires:.25}),await Promise.resolve(u)}catch(c){qy=!1;let l=e.getCacheProvider();return e.getSwapProxy().setTarget(l),Promise.reject({code:4001,err:c})}}}return null}var YH=(r,e)=>new Proxy(r,{get(t,n){switch(n){case"send":return async(a,s)=>{if(typeof a=="string"&&(!s||Array.isArray(s))){let i=await Uy({okxProvider:r,hijackData:e,request:"send",args:{method:a,params:s}},a,s);return i===null?t.send(a,s):i}else if(a&&typeof a=="object"&&typeof s=="function"){let i=await Uy({okxProvider:r,hijackData:e,request:"send",args:a},a,s);return i===null?t.send(a,s):i}throw new Error(U.errors.methodNotSupport())};case"sendAsync":return(a,s)=>{Uy({okxProvider:r,hijackData:e,request:"sendAsync",args:a},a,s).then(i=>{i===null&&t.sendAsync(a,s)}).catch(()=>{})};case"request":return async a=>{let s=await Uy({okxProvider:r,hijackData:e,request:"request",args:a},a);return s===null?t.request(a):s};default:return Reflect.get(t,n)}},set(t,n,a){return Ys(t,n,a)?!0:Reflect.set(t,n,a)}});var hle=r=>{Wy($i),r.getCacheProvider()&&r.getSwapProxy().setTarget(r.getCacheProvider())},JH=(r,e,t,n,a=!1)=>async({request:s,method:i},o,c)=>{(i==="eth_requestAccounts"||i==="wallet_requestPermissions")&&(await r.request({method:"eth_accounts"})).length>0&&jH(e,a,n,()=>{r.disconnect&&r.disconnect(),hle(t)});let l;return r.isOkxWallet&&s==="request"?l=r.request(o,{calledThroughEthereum:!0}):l=r[s](o,c),l};function Fy(r,e){let t=cp(r,!0);t[0].provider=A3(r,JH(r,r,e,t[0].logo,!0)),e.setProviderList(t),window.ethereum&&e.pushProviderList(cp(window.ethereum));let n=YH(r,e);e.initSwapProxy($H(n,{isOkxWallet:void 0,isOKExWallet:void 0})),_3(e),Object.defineProperty(window,"ethereum",{configurable:!1,get(){return e.getSwapProxy()},set(a){a&&!a?.isOkxWallet&&(cp(a).forEach(s=>{let i=e.getProviderList().findIndex(c=>c.name===s.name),o=s.provider;s.provider=A3(o,JH(o,r,e,s.logo)),i>-1?s.name!=="MetaMask"&&(e.getProviderList()[i]=s):e.pushProviderList([s])}),_3(e))}})}d();f();Tn();var ple=qp.init({cookieInterceptLevel:0});function mle(r){let{document:e}=r,t=e.querySelector('head > meta[property="og:site_name"]');if(t)return t.content;let n=e.querySelector('head > meta[name="title"]');return n?n.content:e.title&&e.title.length>0?e.title:window.location.hostname}async function gle(r){let{document:e}=r,t=e.querySelectorAll('head > link[rel~="icon"]');for(let n of t)if(n&&n.href)return n.href;return null}async function ble(){let r=Boolean(window._okGlobal),e={name:mle(window),icon:await gle(window),isOkx:r};if(r){let t=ple.get("devId");t&&(e.devId=t)}return e}async function XH(r,e){try{let t=await ble();r.request({method:"wallet_sendDomainMetadata",params:t})}catch(t){e.error({message:U.errors.sendSiteMetadata(),originalError:t})}}function yle(r,e){if(document.readyState==="complete")XH(r,e);else{let t=()=>{XH(r,e),window.removeEventListener("DOMContentLoaded",t)};window.addEventListener("DOMContentLoaded",t)}}async function Hy(){return new Promise(r=>{if(document.readyState==="complete")r(Boolean(window._okGlobal));else{let e=()=>{r(Boolean(window._okGlobal)),window.removeEventListener("DOMContentLoaded",e)};window.addEventListener("DOMContentLoaded",e)}})}var ZH=yle;var QH=(r,e,t)=>{r.request({jsonrpc:"2.0",id:1e3,method:"wallet_checkDomain"}).then(async({isWhitelist:n,defaultWallet:a})=>{if(window.okxwallet.isWhitelist=n,S3(mc,n),e&&n)return;if(e&&!n&&Fy(r,t),n||a==="OTHER"){t.getSwapProxy().setTarget((0,E3.last)(t.getProviderList())?.provider);return}if(a==="OKX"){let i=new Proxy(r,{get(o,c,l){if(c==="request"){let u=o.request;return h=>u.call(l,h,{callThroughEthereum:!0})}return Reflect.get(o,c)},set(o,c,l){return Ys(o,c,l)?!1:Reflect.set(o,c,l)}});t.getSwapProxy().setTarget(i)}await Hy()&&(t.getSwapProxy().setTarget((0,E3.last)(t.getProviderList())?.provider),S3(mc,!0),window.okxwallet.isWhitelist=!0)}).catch(()=>{})};d();f();var Gy=class{constructor(){this.providerList=[],this.swapProxy={},this.hasInitSwapProxy=!1,this.cacheProvider=null}getProviderList(){return this.providerList}getSwapProxy(){return this.swapProxy}setProviderList(e){this.providerList=e}pushProviderList(e){this.providerList.push(...e)}initSwapProxy(e){if(this.hasInitSwapProxy)throw Error("swapProxy has been initialized");this.swapProxy=e,this.hasInitSwapProxy=!0}swapProxySetTarget(e){this.swapProxy.setTarget(e)}getCacheProvider(){return this.cacheProvider}setCacheProvider(e){this.cacheProvider=e}};var Zf=new Gy;window.hijackData=Zf;var eG=r=>{let e=v3(mc)===!0;e||Fy(r,Zf),QH(r,e,Zf),r.on(U.event.CLEAR_COOKIE,()=>{Wy($i),Zf.getCacheProvider()&&Zf.getSwapProxy().setTarget(Zf.getCacheProvider())})};function tG(r,e){let t=new Proxy(r,{get(n,a){return Reflect.get(n,a)},set(n,a,s){return Ys(n,a,s)?!0:Reflect.set(n,a,s)}});Object.defineProperty(window,"okxwallet",{value:t,writable:!1,configurable:!1}),window.okexchain=window.okxwallet;try{e||eG(r)}catch(n){console.log(n)}}var Yi={initialized:!1,accounts:[],isConnected:!1},fp=[Xe.ETH_SEND_TRANSACTION,Xe.WATCH_ASSET,Xe.WATCH_ASSET_LEGACY],dp=({rpcRequest:r,method:e,params:t,error:n})=>{fp.includes(e)&&r({method:"wallet_autoSwitchMode",args:{method:e,params:t},autoSwitchRecover:!0,error:n})},P3=({rpcRequest:r,method:e,params:t})=>{fp.includes(e)&&r({method:"wallet_autoSwitchMode",args:{method:e,params:t}},(n,a)=>{let s=n||a?.error;s&&dp({rpcRequest:r,method:e,params:t,error:s})})},Qf=class extends Le{constructor(t,{jsonRpcStreamName:n,logger:a,isInContentScript:s}){super(t,{jsonRpcStreamName:n,logger:a});le(this,"getInstanceID",()=>this.request({method:"wallet_getInstanceID"}));this.isMetaMask=!0,this.selectedAddress=null,this.networkVersion=null,this.chainId=null,this.isWhitelist=!1,this.isPLC=!0,this.request=this.request.bind(this),this.send=this.send.bind(this),this.sendAsync=this.sendAsync.bind(this),this.disconnect=this.disconnect.bind(this),this.initializeState(),this.on(U.event.WALLET_CHANGED,async([i])=>{i?this.handleConnect():this.emit(U.event.DISCONNECT)}),tG(this,s),s||GH(this),ZH(this,a),this.jsonRpcConnection.events.on(U.event.NOTIFICATION,i=>{let{method:o,params:c}=i;o==="wallet_accountsChanged"?this.handleAccountsChanged(c):o==="wallet_chainChanged"?this.handleChainChanged(c):o==="eth_subscription"?this.emit("message",{type:o,data:c}):o==="identitiesChanged"?this.emit("identitiesChanged",c):o===U.event.WALLET_CHANGED?this.emit(U.event.WALLET_CHANGED,c):o==="rpcModeChanged"?this.emit("rpcModeChanged",c):o==="wallet_unlockStateChanged"?this.emit(U.event.LOCKED,c?.auto):o===U.event.CLEAR_COOKIE?this.emit(U.event.CLEAR_COOKIE,c):o===U.event.ISOMER_NETWORK_CHANGED&&this.emit(`${o}_${c.providerType}`,c)})}async request(t,n){Qe(t);let{method:a,params:s}=t;try{fp.includes(a)&&await super.rpcRequest({method:"wallet_autoSwitchMode",args:t});let i=await super.rpcRequest({method:a,params:s,calledThroughEthereum:n?.calledThroughEthereum,calledThrough6963:n?.calledThrough6963});return(a==="eth_accounts"||a==="eth_requestAccounts")&&(this.handleAccountsChanged(i),this.requestWallets()),fp.includes(a)&&await super.rpcRequest({method:"wallet_autoSwitchMode",args:t,autoSwitchRecover:!0}),i}catch(i){throw fp.includes(a)&&await super.rpcRequest({method:"wallet_autoSwitchMode",args:t,autoSwitchRecover:!0,error:i}),{...i}}}send(t,n){let a=super.rpcRequest.bind(this);if(typeof t=="string"&&(!n||Array.isArray(n)))return new Promise((s,i)=>{try{P3({rpcRequest:a,method:t,params:n}),super.rpcRequest({method:t,params:n},(o,c)=>{let l=o||c?.error;dp({rpcRequest:a,method:t,params:n,error:l}),l?i(l):s(c)})}catch(o){dp({rpcRequest:a,method:t,params:n,error:o}),i(o)}});if(t&&typeof t=="object"&&typeof n=="function"){let{method:s,params:i}=t;return P3({rpcRequest:a,method:s,params:i}),super.rpcRequest(t,(o,c)=>{dp({rpcRequest:a,method:s,params:i,error:o}),n(o,c)})}throw new Error(U.errors.methodNotSupport())}sendAsync(t,n){let{method:a,params:s}=t||{},i=super.rpcRequest.bind(this);P3({rpcRequest:i,method:a,params:s}),super.rpcRequest(t,(o,c)=>{dp({rpcRequest:i,method:a,params:s,error:o}),n&&n(o,c)})}isConnected(){return Boolean(this.chainId)}requestChainId(){return this.request({method:"eth_chainId"})}requestAccounts(){return this.request({method:"eth_accounts"})}enable(){return this.request({method:"eth_requestAccounts"})}requestIdentities(t){return this.request({method:t?"wallet_requestIdentities":"wallet_identities"})}async requestWallets(t=!1,n={}){let a=await this.request({method:t?"wallet_requestWallets":"wallet_wallets",params:n});return n.isInit||VH(this,a),a}async disconnect(){await this.request({method:"wallet_disconnect"})}switchChain({chainId:t}){return this.request({method:"wallet_switchEthereumChain",params:[{chainId:t,silent:!0}]})}isUnlock(){return this.request({method:"wallet_requestIsUnlock"})}offlineSign(t){return this.request({method:"wallet_offlineSign",params:t})}isCustomMode(){return this.request({method:"wallet_isCustomMode"})}getVersion(){return this.request({method:"wallet_requestVersion"})}async initializeState(){try{let{accounts:t,chainId:n,networkVersion:a}=await this.request({method:"wallet_getProviderState"});this.handleAccountsChanged(t),this.handleConnect(n),this.handleChainChanged({chainId:n,networkVersion:a})}finally{Yi.initialized=!0}}handleConnect(t=this.chainId){Yi.isConnected||(Yi.isConnected=!0,this.emit(U.event.CONNECT,{chainId:t}))}handleDisconnect(t){this.selectedAddress=null,this.networkVersion=null,this.chainId=null,super.handleDisconnect(t)}handleChainChanged({chainId:t,networkVersion:n}={}){this.handleConnect(t),t!==this.chainId&&(this.chainId=t,Yi.initialized&&this.emit(U.event.CHAIN_CHANGED,this.chainId)),n!==this.networkVersion&&(this.networkVersion=n,Yi.initialized&&this.emit(U.event.NETWORK_CHANGED,this.networkVersion))}handleAccountsChanged(t=[]){Yi.accounts[0]!==t[0]&&(Yi.accounts=t,this.selectedAddress!==t[0]&&(this.selectedAddress=t[0]||null),Yi.initialized&&this.emit(U.event.ACCOUNTS_CHANGED,t))}syncToken(t){return this.request({method:"wallet_syncToken",params:t})}getIsNeedSyncToken(t){return this.request({method:"wallet_getIsNeedSyncToken",params:t})}async sendEvmInscriptions(t){if(!await Hy())throw new Error(U.errors.methodNotSupport());return this.request({method:y0.SEND_EVM_INSCRIPTIONS,params:t})}openNewTab(t){return this.request({method:"extension_openNewTab",params:t})}};d();f();var rG=_(Ce());var M3,el=class extends Le{constructor(e,{jsonRpcStreamName:t,logger:n,provider:a}={}){super(e,{jsonRpcStreamName:t,logger:n}),this.isPhantom=!0,this._publicKey=null,a.on(U.event.WALLET_CHANGED,([s])=>{this.handleConnect(s),this.emit(U.event.ACCOUNT_CHANGED,this.publicKey)}),a.on(U.event.CONNECT_WALLET,([s])=>{this.handleConnect(s)}),this.on(U.event.STREAM_FAILED,()=>{a.emit(U.event.STREAM_FAILED)}),M3=a,a.solana=this;try{window.solana=this}catch{console.log()}}get publicKey(){return this._publicKey}get isConnected(){return Boolean(this.publicKey)}async connect(e={onlyIfTrusted:!1}){let t=!e.onlyIfTrusted,[n]=await M3.requestWallets(t,{providerType:jc});return this.handleConnect(n,e.onlyIfTrusted)}async disconnect(){return await M3.request({method:"wallet_disconnect"}),this.handleDisconnect()}request(e){Qe(e);let{method:t,params:n}=e;return t==="connect"?this.connect():t==="disconnect"?this.disconnect():super.rpcRequest({method:t,params:n})}async signAllTransactions(e=[]){let{signedTransactionResults:t}=await this.request({method:Te.SIGN_ALL_TRANSACTIONS,params:{transactions:e.map(n=>{let a=Ro(n);return{transaction:$n(n,a),type:a}})}});return t.map(({serializedTransaction:n,type:a})=>rw(n,a))}async signAndSendTransaction(e,t={},n={}){let a=Ro(e),{publicKey:s,signature:i}=await this.request({method:Te.SIGN_AND_SEND_TRANSACTION,params:{transaction:$n(e,a),type:a,options:t,okxArgs:n}});return{publicKey:s,signature:i}}async signMessage(e,t="utf8"){let{publicKey:n,signature:a}=await this.request({method:Te.SIGN_MESSAGE,params:{message:new TextDecoder().decode(e),display:t}});return V0(z0(n),a)}async signTransaction(e){let t=Ro(e),{serializedTransaction:n}=await this.request({method:Te.SIGN_TRANSACTION,params:{transaction:$n(e,t),type:t}});return rw(n,t)}handleConnect(e,t=!1){let n=A5(e);if(this._publicKey=n.publicKey,n.publicKey)return this.emit(U.event.CONNECT,n.publicKey),n;if(t)throw rG.ethErrors.provider.userRejectedRequest(U.errors.rejected);return this.handleDisconnect(),null}handleDisconnect(e){this._publicKey=null,super.handleDisconnect(e)}};d();f();var oG=_(Ce());d();f();var zy=_(Ce());var nG="stacks",aG=r=>{let t=(r?.address||[]).find(n=>n.name===nG);return t?.address?{address:t.address,publicKey:""}:null},xle=(r,e)=>{if(!Ar(e))throw zy.ethErrors.rpc.invalidParams({message:U.errors.invalidTransaction(),data:r});let t=e.txType||"unknown";if(![bs.CONTRACT_CALL,bs.STX_TRANSFER].includes(t))throw new Error(`Not support transaction type: ${t}`);if(t===bs.CONTRACT_CALL){let a=e.functionArgs;if(!Array.isArray(a)&&a.some(i=>typeof i!="string"))throw zy.ethErrors.rpc.invalidParams({message:"Invalid functionArgs, functionArgs should be serialized",data:r})}},sG=(r,e)=>{Ye(e);let t={localType:nG,method:r.method,params:{},walletId:e?.walletId},n=r.params?.transaction;if(n){xle(r,n);let s=n?.stxAddress;return G0(r,e,s),t.params.transaction=n,t.params.okxArgs=r.params?.okxArgs,t}let a=r.params?.message;if(a)return t.params.message=a,t;throw zy.ethErrors.rpc.invalidParams({message:U.errors.invalidRequestArgs(),data:r})};var iG,tl=class extends Le{constructor(e,{jsonRpcStreamName:t,logger:n,provider:a}={}){super(e,{jsonRpcStreamName:t,logger:n}),this.selectedAccount=null,a.on(U.event.WALLET_CHANGED,async([s])=>{await this.handleConnect(s),this.emit(U.event.ACCOUNT_CHANGED,this.selectedAccount)}),a.on(U.event.CONNECT_WALLET,([s])=>{this.handleConnect(s)}),iG=a,a.stacks=this;try{window.stacks=this}catch{console.log()}}request(e){Qe(e);let{method:t,params:n}=e;return t==="connect"?this.connect():super.rpcRequest({method:t,params:n})}async handleConnect(e){let t=aG(e);if(this.selectedAccount=t,t){let n=await this.request({method:ga.GET_PUBLIC_KEY,params:{address:t.address}});return t.publicKey=n,this.emit(U.event.CONNECT,t),t}return this.handleDisconnect(),null}async connect(){let[e]=await iG.requestWallets(!0,{providerType:Zc});return this.handleConnect(e)}async signTransaction(e,t={}){return this.request({method:ga.SIGN_TRANSACTION,params:{transaction:e,okxArgs:t}})}async signMessage(e){if(typeof e?.message!="string")throw oG.ethErrors.rpc.invalidParams({message:"'args.params' must be an object or array if provided."});return this.request({method:ga.SIGN_MESSAGE,params:{message:e.message}})}};d();f();ne();d();f();var wle=["starknet_okxwallet"];function vle(r){function e(){wle.forEach(n=>{try{delete window[n]}catch{}try{Object.defineProperty(window,n,{value:r,writable:!1})}catch{}try{window[n]=r}catch{}})}function t(){e(),setTimeout(e,100)}t()}var cG=vle;d();f();var dG=_(te());var Sle="https://wallet.okex.org/fullnode/starknet/discover/rpc",_le=(0,dG.memoize)(r=>new g5({nodeUrl:r}));function fG(r){let e=_le(r||Sle);return e.chainId=pi.StarknetChainId.SN_MAIN,e.baseUrl="https://alpha-mainnet.starknet.io",e}d();f();var uG;function lG(r){return Qe(r),uG.rpcRequest(r)}var N3=class extends y5{constructor(e,t,n){let a=m5.starkCurve.utils.randomPrivateKey();super(t||b5,e,a),uG=n}execute(e,t,n){let a={method:ys.EXECUTE,params:{transactions:e,abis:t,transactionsDetail:n}};return lG(a)}signMessage(e){let t={method:ys.SIGN_MESSAGE,params:{data:e}};return lG(t)}},hG=N3;var R3,k3=class extends Le{constructor(t,{jsonRpcStreamName:n,logger:a,provider:s}={}){super(t,{jsonRpcStreamName:n,logger:a});le(this,"id","okxwallet");le(this,"name",$s);le(this,"icon",Vi);le(this,"version",Gf);le(this,"chainId","SN_MAIN");le(this,"account");le(this,"provider");le(this,"selectedAddress");le(this,"isConnected",!1);R3=s,cG(this),s.starknet=new Proxy(this,{get:(i,o)=>o==="id"?"okxwallet":o==="name"?$s:Reflect.get(i,o)}),s.on(U.event.WALLET_CHANGED,([i])=>{this.handleConnect(i)}),s.on(U.event.CONNECT_WALLET,([i])=>{this.handleConnect(i)})}async handleInjectedStarknet(t){let n=await this.rpcRequest({method:"requestRpcUrl"}),a=fG(n);this.starknetJsVersion="v5",this.provider=a,this.account=new hG(t,a,this),this.selectedAddress=t,this.isConnected=!0}async handleConnect(t){let n=ha(t,xn);n?(await this.handleInjectedStarknet(n),this.emit("accountsChanged",[n])):this.handleDisconnect()}handleDisconnect(){this.selectedAddress=void 0,this.account=void 0,this.isConnected=!1,this.emit("accountsChanged",[])}async enable(){let[t]=await R3.requestWallets(!0,{providerType:Ao}),n=ha(t,xn);return await this.handleInjectedStarknet(n),[n]}request(){throw Error("Not implemented")}async isPreauthorized(){let[t]=await R3.requestWallets(!1,{providerType:Ao});return!!ha(t,xn)}},O3=k3;d();f();var yG=_(te());d();f();Nx();var jy="okxTonWallet",Ale="OKX Wallet",pG="Unsupported protocol version",mG="Unknown error",D3=2;function gG(){return{platform:"browser",appName:jy,appVersion:qc,maxProtocolVersion:D3,features:["SendTransaction",{name:"SendTransaction",maxMessages:4}]}}var Cle="https://static.okx.com/cdn/assets/imgs/247/58E63FEA47A2B7D7.png",Tle="https://www.okx.com/web3";function bG(){return{name:Ale,app_name:jy,image:Cle,about_url:Tle,platforms:["chrome","firefox","safari"]}}var Vy,rl=class extends Le{constructor(t,{jsonRpcStreamName:n,logger:a,provider:s}={}){super(t,{jsonRpcStreamName:n,logger:a});le(this,"deviceInfo",gG());le(this,"walletInfo",bG());le(this,"protocolVersion",D3);le(this,"isWalletBrowser",!1);this.tonCallbacks=[],this.isDisconnect=!1,Vy=s,window[jy]={tonconnect:this},s.ton=this,s.on(U.event.WALLET_CHANGED,([i])=>{i?(this.isDisconnect=!1,this.emit(U.event.ACCOUNT_CHANGED)):this.handleDisconnect()}),s.on(U.event.CONNECT_WALLET,()=>{this.isDisconnect=!1,this.emit(U.event.CONNECT)})}emitConnect(t){return this.isDisconnect=!1,this.tonEmit({event:"connect",id:Date.now(),payload:{items:t,device:this.deviceInfo}})}emitConnectError(t,n){return this.tonEmit({event:"connect_error",id:Date.now(),payload:{code:t,message:n||mG}})}emitDisconnect(t){this.isDisconnect||(this.isDisconnect=!0,this.tonEmit({event:"disconnect",id:t?.id||Date.now(),payload:{}}))}async connect(t,n){let a=t==null,s=!n||!n.items||n.items.length===0;if(a||s)return this.emitConnectError(Ss.BAD_REQUEST_ERROR,U.errors.invalidParams());if(t>this.protocolVersion)return this.emitConnectError(Ss.BAD_REQUEST_ERROR,pG);let o=!!(n?.items||[]).find(({name:c})=>c===hi.TON_PROOF);try{let[c]=await Vy.requestWallets(!0,{providerType:ps,exts:{message:n,alwaysNeedProof:o}}),l=c.tonItems;return this.emitConnect(l)}catch(c){let l=c?.code===4001?Ss.USER_REJECTS_ERROR:Ss.UNKNOWN_ERROR;return this.emitConnectError(l,c?.message)}}async restoreConnection(){let[t]=await Vy.requestWallets(!1,{providerType:ps,exts:{message:{items:[{name:hi.TON_ADDR}]}}});return t?this.emitConnect(t.tonItems):this.emitConnectError(Ss.UNKNOWN_APP_ERROR)}async disconnect(t){try{return await Vy.disconnect(),this.handleDisconnect(t),{id:t?.id||Date.now(),result:{}}}catch(n){return{error:{code:Ss.UNKNOWN_ERROR,message:n?.message||"Unknown error."},id:t?.id||Date.now()}}}handleDisconnect(t){super.handleDisconnect(),this.emitDisconnect(t)}async send(t){if(t.method===ci.SEND_TRANSACTION)try{let n=t.params[0];return(0,yG.isString)(n)&&(n=JSON.parse(n)),await super.rpcRequest({method:ci.SEND_TRANSACTION,params:{transaction:n}})}catch(n){return{error:{code:n?.code===4001?Ss.USER_REJECTS_ERROR:Ss.UNKNOWN_ERROR,message:n?.message||"Unknown error."},id:t.id}}return t.method===ci.DISCONNECT?this.disconnect(t):null}listen(t){return this.tonCallbacks.push(t),()=>{this.tonCallbacks=this.tonCallbacks.filter(n=>n!==t)}}tonEmit(t){return this.tonCallbacks.forEach(n=>n(t)),t}};d();f();var L3=_(F0());var xG;function Ile(){this.fullnodeVersion="3.5.0"}L3.default.prototype.getFullnodeVersion=Ile;var fn=new L3.default({fullHost:"https://api.trongrid.io",headers:{},privateKey:""}),lp={ready:!1,get tronWeb(){return this.ready?fn:!1}},nl=class extends Le{constructor(e,{jsonRpcStreamName:t,logger:n,provider:a}={}){super(e,{jsonRpcStreamName:t,logger:n}),this.selectedAccount=null,a.on(U.event.WALLET_CHANGED,async([s])=>{await this.handleConnect(s),this.dispatchEvent({action:"accountsChanged",data:{address:this.selectedAccount||!1}})}),a.on(U.event.CONNECT_WALLET,([s])=>{this.handleConnect(s)}),xG=a,fn.defaultAddress={hex:!1,base58:!1},this.connect(!1,!0),fn.trx.sign=this.sign.bind(this),fn.trx.sendRawTransaction=this.sendRawTransaction.bind(this),fn.trx.signTransactionOffline=this.signTransactionOffline.bind(this),fn.trx.signMessageV2=this.signMessageV2.bind(this),fn.request=this.request.bind(this),lp.request=fn.request,a.tronLink=lp,a.tronWeb=fn,this.jsonRpcConnection.events.on(U.event.NOTIFICATION,s=>{let{method:i}=s;i==="supplyGas"&&a.emit("supplyGas",{...s.params})});try{window.tronLink=lp,window.tronWeb=fn}catch{console.log()}}async connect(e=!0,t=!1){try{let[n]=await xG.requestWallets(e,{providerType:Vc,isInit:t});return this.handleConnect(n)}catch(n){return{code:n.code===U.code.rejected?n.code:U.code.unauthorized}}}request(e){Qe(e);let{method:t,params:n}=e;return t==="tron_requestAccounts"?this.connect():super.rpcRequest({method:t,params:n})}async sign(e){return typeof e=="string"?this.signMessage({message:e}):this.signTransaction(e)}async signTransaction(e){return this.request({method:$r.SIGN_TRANSACTION,params:{transaction:e}})}async signTransactionOffline(e){let{unsignedTx:t,...n}=e,{extParams:a,...s}=t,{extensionTime:i=20*60}=n,o=await fn.transactionBuilder.extendExpiration(s,i);return this.request({method:$r.SIGN_TRANSACTION,params:{transaction:o,isOffline:!0,extraData:n,extParams:a}})}async signMessage({message:e}){return this.request({method:$r.SIGN_MESSAGE,params:{message:e}})}async signMessageV2(e){return this.request({method:$r.SIGN_MESSAGE_V2,params:{message:e}})}async sendRawTransaction(e){return this.request({method:$r.SEND_RAW_TRANSACTION,params:{signedTx:e}})}async handleConnect(e){let t=I5(e);return this.selectedAccount=t,t?(lp.ready=!0,fn.defaultAddress.base58=t,fn.defaultAddress.hex=fn.address.toHex(t),this.dispatchEvent({action:"connect"}),{code:U.code.success}):(lp.ready=!1,fn.defaultAddress.base58=!1,fn.defaultAddress.hex=!1,this.handleDisconnect(),{code:U.code.rejected})}handleDisconnect(e){this.selectedAccount=null,super.handleDisconnect(e),this.dispatchEvent({action:"disconnect"})}dispatchEvent(e){window.postMessage({message:e},"*")}};d();f();var CG=_(xd());d();f();d();f();d();f();d();f();var B3="wallet-standard:app-ready";d();f();var up=class extends Event{get type(){return"wallet-standard:register-wallet"}constructor(e){super("wallet-standard:register-wallet",{bubbles:!1,cancelable:!1,composed:!1}),this.detail=e}};function wG(r){let e=({register:t})=>{t(r)};try{window.dispatchEvent(new up(e))}catch(t){console.error(`wallet-standard:register-wallet event could not be dispatched
`,t)}try{window.addEventListener(B3,({detail:t})=>{e(t)})}catch(t){console.error(`wallet-standard:app-ready event listener could not be added
`,t)}}d();f();d();f();var hp="suiMainnet";var Ele="sui:mainnet";var $y=[Ele];d();f();var al="solana",Mle="solana:mainnet",Nle="solana:devnet",Rle="solana:testnet",kle="solana:localnet";var Yy=[Mle,Nle,Rle,kle];d();f();var pp="aptos",Ole="aptos:mainnet";var Jy=[Ole];d();f();var ht={SUI_SIGN_AND_EXECUTE_TRANSACTION_BLOCK:"sui:signAndExecuteTransactionBlock",SUI_SIGN_AND_EXECUTE_TRANSACTION_BLOCK_VERSION:"1.0.0",SUI_SIGN_TRANSACTION_BLOCK:"sui:signTransactionBlock",SUI_SIGN_TRANSACTION_BLOCK_VERSION:"1.0.0",SUI_SIGN_MESSAGE:"sui:signMessage",SUI_SIGN_MESSAGE_VERSION:"1.0.0",SUI_SIGN_PERSONAL_MESSAGE:"sui:signPersonalMessage",SUI_SIGN_PERSONAL_MESSAGE_VERSION:"1.0.0"},vG=[ht.SUI_SIGN_AND_EXECUTE_TRANSACTION_BLOCK,ht.SUI_SIGN_TRANSACTION_BLOCK,ht.SUI_SIGN_MESSAGE];d();f();var vr={SIGN_AND_SEND_TRANSACTION:"solana:signAndSendTransaction",SIGN_TRANSACTION:"solana:signTransaction",SIGN_MESSAGE:"solana:signMessage",SIGN_AND_SEND_TRANSACTION_VERSION:"1.0.0",SIGN_TRANSACTION_VERSION:"1.0.0",SIGN_MESSAGE_VERSION:"1.0.0"},SG=[vr.SIGN_AND_SEND_TRANSACTION,vr.SIGN_TRANSACTION,vr.SIGN_MESSAGE];d();f();var we={SIGN_MESSAGE:"aptos:signMessage",SIGN_MESSAGE_VERSION:"1.0.0",SIGN_TRANSACTION:"aptos:signTransaction",SIGN_TRANSACTION_VERSION:"1.0.0",SIGN_AND_SUBMIT_TRANSACTION:"aptos:signAndSubmitTransaction",SIGN_AND_SUBMIT_TRANSACTION_VERSION:"1.1.0",NETWORK:"aptos:network",NETWORK_VERSION:"1.0.0",ACCOUNT:"aptos:account",ACCOUNT_VERSION:"1.0.0",CONNECT:"aptos:connect",CONNECT_VERSION:"1.0.0",DISCONNECT:"aptos:disconnect",DISCONNECT_VERSION:"1.0.0",ON_ACCOUNT_CHANGE:"aptos:onAccountChange",ON_ACCOUNT_CHANGE_VERSION:"1.0.0",ON_NETWORK_CHANGE:"aptos:onNetworkChange",ON_NETWORK_CHANGE_VERSION:"1.0.0"},_G=[we.SIGN_TRANSACTION,we.SIGN_AND_SUBMIT_TRANSACTION,we.SIGN_MESSAGE,we.NETWORK,we.ACCOUNT,we.CONNECT,we.DISCONNECT,we.ON_ACCOUNT_CHANGE,we.ON_NETWORK_CHANGE];d();f();var Xy=class{constructor(e){this.address=e.address,this.publicKey=e.publicKey.slice(),this.chains=e.chains.slice(),this.features=e.features.slice()}};function Ble(r){if(r.length%2!==0)throw new Error("hex string length must be a multiple of 2");let e=new Uint8Array(r.length/2);for(let t=0;t<e.length;t++){let n=2*t,a=r.slice(n,n+2);if(!a.match(/[0-9a-f]{2}/i))throw new Error("hex string contains invalid characters");e[t]=parseInt(a,16)}return e}var Wle=(r,e)=>r===al?Ble(e):e,Kle={[hp]:$y,[al]:Yy,[pp]:Jy},qle={[hp]:vG,[al]:SG,[pp]:_G},W3=class extends Xy{constructor({address:e,publicKey:t,chain:n}){super({address:e,publicKey:Wle(n,t),chains:Kle[n],features:qle[n]})}};async function K3(r,e,t){let n=e?.address||[],a=[];return n.forEach(({address:i,name:o})=>{o===r&&a.push({address:i,chain:o})}),(await t({method:"bulkGetPublicKey",params:{accounts:a}})).map(i=>new W3(i))}d();f();var Ule={CONNECT:"standard:connect",CONNECT_VERSION:"1.0.0",DISCONNECT:"standard:disconnect",DISCONNECT_VERSION:"1.0.0",EVENTS:"standard:events",EVENTS_VERSION:"1.0.0"},bc=Ule;var ss=class extends Le{constructor(e,{providerType:t,chainName:n,jsonRpcStreamName:a,logger:s,provider:i,isInContentScript:o}={}){super(e,{jsonRpcStreamName:a,logger:s}),this.connectedAccounts=[],this.okxProvider=i,this.providerType=t,this.chainName=n,i.on(U.event.WALLET_CHANGED,async([c])=>{c?(await this.handleConnect(c),this.emit(U.event.ACCOUNT_CHANGED,this.connectedAccounts[0])):this.emit(U.event.DISCONNECT)}),i.on(U.event.CONNECT_WALLET,([c])=>{this.handleConnect(c)}),o||this.request({jsonrpc:"2.0",id:1e4,method:"checkWalletStandardDapp",params:{chainName:n}}).then(c=>{c&&wG(this)}).catch(()=>{})}get name(){return $s}get version(){return Gf}get icon(){return Vi}get accounts(){return this.connectedAccounts}get features(){return{[bc.CONNECT]:{version:bc.CONNECT_VERSION,connect:this.connect.bind(this)},[bc.DISCONNECT]:{version:bc.DISCONNECT_VERSION,disconnect:this.disconnect.bind(this)},[bc.EVENTS]:{version:bc.EVENTS_VERSION,on:this.on.bind(this)}}}async connect(e){let{silent:t}=e||{},[n]=await this.okxProvider.requestWallets(!t,{providerType:this.providerType});return this.handleConnect(n)}async disconnect(){return await this.okxProvider.request({method:"wallet_disconnect"}),this.handleDisconnect()}async hasPermissions(){return Boolean(this.connectedAccounts.length)}async requestPermissions(){return this.connect()}async handleConnect(e){let t=await K3(this.chainName,e,this.request.bind(this));return this.connectedAccounts=t,this.emit("change",{accounts:t}),{accounts:t}}handleDisconnect(e){this.connectedAccounts=[],super.handleDisconnect(e)}request(e){Qe(e);let{method:t,params:n}=e;return super.rpcRequest({method:t,params:n})}on(e,t){return super.on(e,t),()=>{super.off(e,t)}}};d();f();var sl=class extends oT{constructor({address:t,publicKey:n,ansName:a}){super();this.address=ow.from(t),this.publicKey=n,this.ansName=a}serialize(t){if(this.address.serialize(t),this.publicKey instanceof Hl)t.serializeU32AsUleb128(_s.Ed25519);else if(this.publicKey instanceof cw)t.serializeU32AsUleb128(_s.MultiEd25519);else if(this.publicKey instanceof fw)t.serializeU32AsUleb128(_s.SingleKey);else if(this.publicKey instanceof lw)t.serializeU32AsUleb128(_s.MultiKey);else throw new Error("Unsupported public key");this.publicKey.serialize(t),t.serializeStr(this.ansName??"")}static deserialize(t){let n=ow.deserialize(t),a=t.deserializeUleb128AsU32(),s;switch(a){case _s.Ed25519:s=Hl.deserialize(t);break;case _s.MultiEd25519:s=cw.deserialize(t);break;case _s.SingleKey:s=fw.deserialize(t);break;case _s.MultiKey:s=lw.deserialize(t);break;default:throw new Error(`Unknown variant index for WrappedPublicKey: ${a}`)}let i=t.deserializeStr()||void 0;return new sl({address:n,publicKey:s,ansName:i})}};var Fle=r=>typeof r?.toString=="function"?r?.toString():r;function AG(r){return{transaction:CG.default.encode(r.payload.bcsToBytes()),options:{expiration_timestamp_secs:r.expiration_timestamp_secs?.toString(),gas_unit_price:r.gas_unit_price?.toString(),max_gas_amount:r.max_gas_amount?.toString(),sequence_number:r.sequence_number?.toString()},extParams:{dataType:ii.HEX_STRING}}}var q3=class extends ss{constructor(e,{jsonRpcStreamName:t,logger:n,provider:a,isInContentScript:s}={}){super(e,{jsonRpcStreamName:t,logger:n,provider:a,isInContentScript:s,providerType:Xc,chainName:pp})}get url(){return"https://okx.com/web3/"}get provider(){return typeof window<"u"?window.okxwallet?.aptos:void 0}get chains(){return[...Jy]}get features(){return{...ss.prototype.features,[we.SIGN_AND_SUBMIT_TRANSACTION]:{version:we.SIGN_AND_SUBMIT_TRANSACTION_VERSION,signAndSubmitTransaction:this.signAndSubmitTransaction.bind(this)},[we.SIGN_TRANSACTION]:{version:we.SIGN_TRANSACTION_VERSION,signTransaction:this.signTransaction.bind(this)},[we.SIGN_MESSAGE]:{version:we.SIGN_MESSAGE_VERSION,signMessage:this.signMessage.bind(this)},[we.NETWORK]:{version:we.NETWORK_VERSION,network:this.network.bind(this)},[we.ACCOUNT]:{version:we.ACCOUNT_VERSION,account:this.account.bind(this)},[we.CONNECT]:{version:we.CONNECT_VERSION,connect:this.connect.bind(this)},[we.DISCONNECT]:{version:we.DISCONNECT_VERSION,disconnect:this.disconnect.bind(this)},[we.ON_ACCOUNT_CHANGE]:{version:we.ON_ACCOUNT_CHANGE_VERSION,onAccountChange:this.onAccountChange.bind(this)},[we.ON_NETWORK_CHANGE]:{version:we.ON_NETWORK_CHANGE_VERSION,onNetworkChange:this.onNetworkChange.bind(this)}}}async signAndSubmitTransaction(e){let{gasUnitPrice:t,maxGasAmount:n,payload:a}=e||{};try{let s;if(e.rawTransaction)s=AG(e.rawTransaction);else{if(!a.function)return{status:"Rejected"};s={transaction:{type:"entry_function_payload",function:a.function,type_arguments:(a.type_arguments||a.typeArguments||[]).map(Fle),arguments:a.arguments||a.functionArguments||[]},extParams:{dataType:ii.RAW}},t&&n&&(s.options={gas_unit_price:t,max_gas_amount:n})}let i=await this.request({method:we.SIGN_AND_SUBMIT_TRANSACTION,params:s});return{status:"Approved",args:{hash:i.hash}}}catch{return{status:"Rejected"}}}async signTransaction(e){try{let t=await this.request({method:we.SIGN_TRANSACTION,params:AG(e.rawTransaction)}),n=new dw(p.Buffer.from(t,"hex")),a=fT.deserialize(n),s=new dw(a.authenticator.bcsToBytes());return{status:"Approved",args:dT.deserialize(s)}}catch{return{status:"Rejected"}}}async signMessage({address:e,application:t,chainId:n,message:a,nonce:s}){try{let i=await this.request({method:we.SIGN_MESSAGE,params:{address:e,application:t,chainId:n,message:a,nonce:s}}),{signature:o}=i;return{status:"Approved",args:{...i,signature:new cT(o)}}}catch{return{status:"Rejected"}}}async disconnect(){return await this.okxProvider.disconnect(),Promise.resolve()}translateConnectedToAccountInfo(e){return new sl({address:e.address,publicKey:new Hl(e.publicKey)})}async connect(e){try{let n=(await super.connect(e)).accounts[0],a=this.translateConnectedToAccountInfo(n);return{status:"Approved",args:a}}catch{return{status:"Rejected"}}}async account(){return this.translateConnectedToAccountInfo(this.connectedAccounts[0])}async network(){let e=await this.request({method:we.NETWORK});return{name:e?.dappChainName||"Mainnet",chainId:e?.realChainId,url:e?.rpcUrl}}onNetworkChange(e){return typeof e!="function"||this.okxProvider.on(`${U.event.ISOMER_NETWORK_CHANGED}_${Rn}`,t=>{let n=t.currentNetwork;e({name:n?.dappChainName||"Mainnet",chainId:n?.realChainId,url:n?.rpcUrl})}),Promise.resolve()}onAccountChange(e){return typeof e!="function"||this.on(U.event.ACCOUNT_CHANGED,t=>{let n=this.translateConnectedToAccountInfo(t);e(n)}),Promise.resolve()}},U3=q3;d();f();var Zy=_(xd());var F3=class extends ss{constructor(e,{jsonRpcStreamName:t,logger:n,provider:a,isInContentScript:s}={}){super(e,{jsonRpcStreamName:t,logger:n,provider:a,isInContentScript:s,providerType:Yc,chainName:al})}get supportedTransactionVersions(){return["legacy",0]}get chains(){return[...Yy]}get features(){return{...super.features,[vr.SIGN_AND_SEND_TRANSACTION]:{version:vr.SIGN_AND_SEND_TRANSACTION_VERSION,signAndSendTransaction:this.signAndSendTransaction.bind(this),supportedTransactionVersions:["legacy",0]},[vr.SIGN_TRANSACTION]:{version:vr.SIGN_TRANSACTION_VERSION,signTransaction:this.signTransaction.bind(this),supportedTransactionVersions:["legacy",0]},[vr.SIGN_MESSAGE]:{version:vr.SIGN_MESSAGE_VERSION,signMessage:this.signMessage.bind(this)}}}async signAndSendTransaction({transaction:e},t={},n={}){let a=Zy.default.encode(e),s=Zx(e),i=Ro(s),{signature:o}=await this.request({method:vr.SIGN_AND_SEND_TRANSACTION,params:{transaction:a,type:i,options:t,okxArgs:n}});return[{signature:Zy.default.decode(o)}]}async signTransaction(...e){e=e.map(({transaction:n})=>Zx(n));let{signedTransactionResults:t}=await this.request({method:vr.SIGN_TRANSACTION,params:{transactions:e.map(n=>{let a=Ro(n);return{transaction:$n(n,a),type:a}})}});return t.map(({serializedTransaction:n})=>({signedTransaction:Zy.default.decode(n)}))}async signMessage({message:e},t="utf8"){let{publicKey:n,signature:a}=await this.request({method:vr.SIGN_MESSAGE,params:{message:new TextDecoder().decode(e),display:t}});return[{signature:V0(z0(n),a).signature,signedMessage:e}]}},H3=F3;d();f();var G3=class extends ss{constructor(e,{jsonRpcStreamName:t,logger:n,provider:a,isInContentScript:s}={}){super(e,{jsonRpcStreamName:t,logger:n,provider:a,isInContentScript:s,providerType:Jc,chainName:hp}),a.sui=this}get chains(){return[...$y]}get features(){return{...super.features,[ht.SUI_SIGN_AND_EXECUTE_TRANSACTION_BLOCK]:{version:ht.SUI_SIGN_AND_EXECUTE_TRANSACTION_BLOCK_VERSION,signAndExecuteTransactionBlock:this.signAndExecuteTransactionBlock.bind(this)},[ht.SUI_SIGN_TRANSACTION_BLOCK]:{version:ht.SUI_SIGN_TRANSACTION_BLOCK_VERSION,signTransactionBlock:this.signTransactionBlock.bind(this)},[ht.SUI_SIGN_MESSAGE]:{version:ht.SUI_SIGN_MESSAGE_VERSION,signMessage:this.signMessage.bind(this)},[ht.SUI_SIGN_PERSONAL_MESSAGE]:{version:ht.SUI_SIGN_PERSONAL_MESSAGE_VERSION,signPersonalMessage:this.signPersonalMessage.bind(this)}}}async signAndExecuteTransactionBlock(e){return this.request({method:ht.SUI_SIGN_AND_EXECUTE_TRANSACTION_BLOCK,params:{...e,transaction:e.transactionBlock.serialize()}})}async signTransactionBlock(e){return this.request({method:ht.SUI_SIGN_TRANSACTION_BLOCK,params:{...e,transaction:e.transactionBlock.serialize()}})}async signMessage(e){return this.request({method:ht.SUI_SIGN_MESSAGE,params:{...e,message:Array.from(e.message)}})}async signPersonalMessage(e){let t=await this.request({method:ht.SUI_SIGN_PERSONAL_MESSAGE,params:{...e,message:Array.from(e.message)}});return{bytes:t.messageBytes,signature:t.signature}}},z3=G3;d();f();d();f();ne();var il="1064487b3cd1a897ce03ae5b6a865651747e2e152090f99c1d19d44e01aea5a4",j3={[il]:{providerType:id,localType:fs}};Nx();d();f();function TG(r){let e=new Uint8Array(r.length/2);for(let t=0;t<r.length;t+=2)e[t/2]=parseInt(r.substr(t,2),16);return e}function IG(r){return j3[r]||j3[il]}var EG,V3=class extends Le{constructor(t,{jsonRpcStreamName:n,logger:a,provider:s}={}){super(t,{jsonRpcStreamName:n,logger:a});le(this,"isExtension",!0);le(this,"requiredVersion","");le(this,"login",this.getIdentity);le(this,"checkLogin",this.getIdentityFromPermissions);le(this,"logout",this.forgetIdentity);this.network=null,this.identity=null,EG=s,s.on(U.event.WALLET_CHANGED,([i])=>{i?this.emit(U.event.ACCOUNT_CHANGED):this.emit(U.event.DISCONNECT)}),s.on(U.event.CONNECT_WALLET,()=>{this.emit(U.event.CONNECT)}),s.wax=this;try{if(window.ScatterJS)window.ScatterJS.scatter=this;else{let i;Object.defineProperty(window,"ScatterJS",{get:()=>i,set:o=>{o&&(o.scatter=this),i=o}})}window.scatter=this,document.dispatchEvent(new CustomEvent("scatterLoaded"))}catch{}Object.defineProperty(this,"eosHook",{get:()=>this.hookProvider,set:()=>!0})}request(t){return Qe(t),super.rpcRequest(t)}getVersion(){return Promise.resolve(qc)}isConnected(){return!!this.identity}account(){return this.identity?this.identity.accounts?.[0]:null}requireVersion(t){this.requiredVersion=t}connect(t,n){return n?.network&&(this.network=n.network),Promise.resolve(!0)}async getIdentity(t){let n=t?.accounts?.[0]?.chainId||this.network?.chainId||il,{providerType:a,localType:s}=IG(n),[i]=await EG.requestWallets(!0,{providerType:a}),o=ha(i,s),c=await this.request({method:oi.GET_PUBLIC_KEY,params:{address:o}}),l={hash:"",kyc:!1,name:o,publicKey:c,accounts:[{name:o,authority:"active",blockchain:"eos",chainId:n,isHardware:!1,publicKey:c}]};return this.identity=l,l}useIdentity(t){this.identity=t}getIdentityFromPermissions(){return this.identity?Promise.resolve(this.identity):this.getIdentity()}forgetIdentity(){return this.identity=null,Promise.resolve(!0)}suggestNetwork(){return Promise.resolve(!0)}requestSignTx(t,n){return this.request({method:oi.SIGN_TRANSACTION,params:{transaction:{from:this.identity?.name,chainId:n||il,serializedTx:t}}})}async signProvider(t){let n=t.buf.toString("hex",32,t.buf.length-32);return(await this.requestSignTx(n,this.network?.chainId)).signatures}eos(t,n,a,s){if(a&&a.rpc){let c=this.hookProvider();return new n(Object.assign(a,{signatureProvider:c}))}a=a||{},this.network=Object.assign(this.network,t),t.protocol||(t.protocol=s||"http");let i=`${t.protocol}://${t.host}:${t.port}`,o=t.chainId;return n(Object.assign(a,{httpEndpoint:i,chainId:o,signProvider:this.signProvider}))}hookProvider(){return{requiredFields:{},getAvailableKeys(){if(this.identity){let t=[this.identity.publicKey];return this.identity.accounts.length>1&&t.push(this.identity.accounts[1].publicKey),Promise.resolve(t)}return Promise.resolve([])},sign:async t=>{let{serializedTransaction:n}=t;n instanceof Uint8Array&&(n=n.reduce((s,i)=>s+i.toString(16).padStart(2,"0"),""));let a=await this.requestSignTx(n,t.chainId);return{serializedTransaction:TG(n),signatures:a.signatures}}}}},$3=V3;var PG={contentScript:i0,inpage:uA,provider:wn,Implementor:Qf},MG=[{contentScript:hA,inpage:pA,provider:jc,Implementor:el},{contentScript:mA,inpage:gA,provider:Rn,Implementor:Ff},{contentScript:bA,inpage:yA,provider:Vc,Implementor:nl},{contentScript:xA,inpage:wA,provider:$c,Implementor:Vf},{contentScript:IA,inpage:EA,provider:zn,Implementor:u3},{contentScript:vA,inpage:SA,provider:Yc,Implementor:H3},{contentScript:_A,inpage:AA,provider:Jc,Implementor:z3},{contentScript:CA,inpage:TA,provider:Xc,Implementor:U3},{contentScript:PA,inpage:MA,provider:Zc,Implementor:tl},{contentScript:NA,inpage:RA,provider:Ao,Implementor:O3},{contentScript:kA,inpage:OA,provider:Qc,Implementor:zf},{contentScript:DA,inpage:LA,provider:ed,Implementor:h3},{contentScript:BA,inpage:WA,provider:td,Implementor:p3},{contentScript:KA,inpage:qA,provider:rd,Implementor:m3},{contentScript:UA,inpage:FA,provider:nd,Implementor:Jf},{contentScript:HA,inpage:GA,provider:ad,Implementor:$f},{contentScript:zA,inpage:jA,provider:sd,Implementor:Yf},{contentScript:VA,inpage:$A,provider:id,Implementor:$3},{contentScript:YA,inpage:JA,provider:ps,Implementor:rl}];d();f();var OG=_(Ce()),DG=_(On());un();d();f();d();f();var Sr=_(yn());un();Ge();var Js=class{reload(){Sr.default.runtime.reload()}openTab(e){return new Promise((t,n)=>{Sr.default.tabs.create(e).then(a=>{let s=ma();return s?n(s):t(a)}).catch(a=>{n(a)})})}openWindow(e){return new Promise((t,n)=>{Sr.default.windows.create(e).then(a=>{let s=ma();return s?n(s):(this.lastOkPopupId=a.id,t(a))}).catch(a=>{n(a)})})}closeWindow(e){return new Promise((t,n)=>{Sr.default.windows.remove(e).then(()=>{let a=ma();return a?n(a):t()}).catch(a=>{n(a)})})}focusLastOkPopup(){this.lastOkPopupId&&this.getAllWindows().then(e=>{e.some(t=>t.id===this.lastOkPopupId)?this.focusWindow(this.lastOkPopupId):this.lastOkPopupId=""}).catch(()=>{})}async focusCurrentWindow(){let t=(await this.currentTab())?.windowId;await this.focusWindow(t)}focusWindow(e){return new Promise((t,n)=>{Sr.default.windows.update(e,{focused:!0}).then(()=>{let a=ma();return a?n(a):t()}).catch(a=>{n(a)})})}updateWindowPosition(e,t,n){return new Promise((a,s)=>{Sr.default.windows.update(e,{left:t,top:n}).then(()=>{let i=ma();return i?s(i):a()}).catch(i=>{s(i)})})}getLastFocusedWindow(e){return new Promise((t,n)=>{Sr.default.windows.getLastFocused(e).then(a=>{let s=ma();return s?n(s):t(a)}).catch(a=>{n(a)})})}closeCurrentWindow(){return Sr.default?.windows?.getCurrent?Sr.default.windows.getCurrent().then(e=>Sr.default.windows.remove(e.id)):Promise.resolve()}getVersion(){return Sr.default.runtime.getManifest().version}openExtensionInBrowser(e=null,t=null){let n=Sr.default.runtime.getURL("home.html");t&&(n+=`?${t}`),e&&(n+=`#${e}`),this.openTab({url:n}),hs()!==Rx&&window.close()}async openExtensionInPopup(e=null,t=null){let n=Sr.default.runtime.getURL("home.html");t&&(n+=`?${t}`),e&&(n+=`#${e}`);let{screenX:a,screenY:s,outerWidth:i}=window,o=Math.max(s,0),c=Math.max(a+(i-360),0);if(!a){let u=await this.getLastFocusedWindow();o=u.top,c=u.left+(u.width-360)}let l=await C_();this.openWindow({url:n,type:"popup",width:l?.width||360,height:700,top:o,left:c}),hs()!==Rx&&window.close()}getPlatformInfo(){return new Promise((e,t)=>{try{Sr.default.runtime.getPlatformInfo().then(n=>{e(n)}).catch(n=>{t(n)})}catch(n){t(n)}})}getAllWindows(){return new Promise((e,t)=>{Sr.default.windows.getAll().then(n=>{let a=ma();return a?t(a):e(n)}).catch(n=>{t(n)})})}getActiveTabs(){return new Promise((e,t)=>{Sr.default.tabs.query({active:!0}).then(n=>{let a=ma();return a?t(a):e(n)}).catch(n=>{t(n)})})}currentTab(){return new Promise((e,t)=>{Sr.default.tabs.getCurrent().then(n=>{let a=ma();a?t(a):e(n)}).catch(n=>{t(n)})})}closeTab(e){return new Promise((t,n)=>{Sr.default.tabs.remove(e).then(()=>{let a=ma();a?n(a):t()}).catch(a=>{n(a)})})}getCpuInfoName(){return new Promise((e,t)=>{try{Sr.default.system.cpu.getInfo(n=>{e(n.modelName)})}catch(n){t(n)}})}setPanelBehavior(e){return new Promise((t,n)=>{try{chrome.sidePanel.setPanelBehavior({openPanelOnActionClick:e}),t()}catch(a){n(a)}})}setSidepanelPath(e){return new Promise((t,n)=>{e?chrome.sidePanel.setOptions({path:e},()=>{t()}):n()})}openSidepanelWithWindowId(e){return new Promise((t,n)=>{e?chrome.sidePanel.open({windowId:e},()=>{t()}):n()})}async openSidepanel(e){let n=(await this.getLastFocusedWindow())?.id;e&&await this.setSidepanelPath(`sidepanel.html#${e}`),await this.openSidepanelWithWindowId(n),e&&await this.setSidepanelPath("sidepanel.html")}};var NG=new Js,RG=null,kG=async r=>{let[e,t]=await Promise.allSettled([NG.getActiveTabs(),NG.getLastFocusedWindow()]),n=e.value,a=t.value;a?.type!=="popup"&&(RG=a);let s=RG||a,i=n?.find(o=>o?.id===r);return i?a?.focused?i?.windowId===s?.id:!0:!1};var Hle=["wallet_requestPermissions",...Object.values(Cd)],Gle=[Xe.SWITCH_ETHEREUM_CHAIN],zle={[Xe.SWITCH_ETHEREUM_CHAIN]:null};function Qy(){return(0,DG.createAsyncMiddleware)(async(r,e,t)=>{let n=!0;if(r.tabId)try{n=await kG(r.tabId)}catch{n=!0}if(!n){if(Gle.includes(r.method)){e.result=zle[r.method];return}else if(Hle.includes(r.method)){e.error=OG.ethErrors.provider.userRejectedRequest({message:"Request Signature: User denied request signature."});return}}t()})}d();f();var LG=_(Fr());function ex(){return function(e,t,n){n(a=>{t.error&&LG.default.error(`Error in RPC response:
`,t),!e.isMetamaskInternal&&a()})}}d();f();var mp=_(Ce()),jle=(r,e)=>t=>{if(!e._writableState.ended){if(!r[t.method]){e.write({jsonrpc:"2.0",error:(0,mp.serializeError)(mp.ethErrors.rpc.methodNotFound({message:`${t.method} not found`}),{shouldIncludeStack:!0}),id:t.id});return}r[t.method](...t.params,(n,a)=>{e._writableState.ended||(n?e.write({jsonrpc:"2.0",error:(0,mp.serializeError)(n,{shouldIncludeStack:!0}),id:t.id}):e.write({jsonrpc:"2.0",result:a,id:t.id}))})}},BG=jle;d();f();var WG=_(Fr()),KG=_(yn());function tx({location:r,registerOnboarding:e}){return async function(n,a,s,i){try{if(n.method!=="wallet_registerOnboarding"){s();return}n.tabId&&n.tabId!==KG.default.tabs.TAB_ID_NONE?await e(r,n.tabId):WG.default.debug(`'wallet_registerOnboarding' message from ${r} ignored due to missing tabId`),a.result=!0,i()}catch(o){i(o)}}}d();f();function rx({origin:r,providerType:e=wn,connectionId:t=""}){return function(a,s,i){a.origin=r,a.providerType=e,a.connectionId=t,i()}}d();f();function nx(r){return function(t,n,a){t.tabId=r.tabId,a()}}d();f();d();f();var qG=_(On()),UG=_(Ce());function Ee(r={},e=!1){return(0,qG.createAsyncMiddleware)(async(t,n,a)=>{let s=r[t.method];if(s===void 0){if(!e){a();return}throw UG.ethErrors.rpc.methodNotFound({message:`The method '${t.method}' does not exist / is not available.`,data:t})}if(typeof s=="function"){n.result=await s(t);return}n.result=s})}d();f();var FG=_(te());ne();var ax=_(Ce());var HG=async(r,e)=>{let t=await e.permissionsController.getCurrentPermittedAccount(r.origin,_r);if(!t)throw ax.ethErrors.provider.unauthorized({message:"The requested method and/or account has not been authorized by the user."});let n=r?.params;if(!Array.isArray(n))throw ax.ethErrors.rpc.invalidRequest({message:"Expected a single array argument.",data:n});let a=n.map(i=>{let{txParams:o,id:c}=i||{};if(!o||(0,FG.isNil)(c))throw ax.ethErrors.rpc.invalidParams({message:"Invalid transaction params: txParams or id is undefined",data:n});let l={...o,chainId:e.networkController.getCurrentChainId()};return jo(l),{txParams:l,id:c}}),s={localType:_r,method:r.method,params:a,walletId:t?.walletId};return e.dappRequestController.newUnapprovedRequest(s,r)};function Y3(r){return Ee({[y0.SEND_EVM_INSCRIPTIONS]:e=>HG(e,r)},!1)}d();f();d();f();d();f();d();f();var pa=_(Ce()),GG=_(te()),J3=_(F$());un();ae();async function Vle(r,e,t,n,{setProviderType:a,requestUserApproval:s}){if(!r.params?.[0]||typeof r.params[0]!="object")return n(pa.ethErrors.rpc.invalidParams({message:`Expected single, object parameter. Received:
${JSON.stringify(r.params)}`}));let{origin:i}=r,{chainId:o,chainName:c=null,blockExplorerUrls:l=null,nativeCurrency:u=null,rpcUrls:h}=r.params[0],b=Object.keys((0,GG.omit)(r.params[0],["chainId","chainName","blockExplorerUrls","iconUrls","rpcUrls","nativeCurrency"]));if(b.length>0)return n(pa.ethErrors.rpc.invalidParams({message:`Received unexpected keys on object parameter. Unsupported keys:
${b}`}));let y=Array.isArray(h)?h.find(L=>J3.default.isHttpsUri(L)):null,v=l!==null&&Array.isArray(l)?l.find(L=>J3.default.isHttpsUri(L)):null;if(!y)return n(pa.ethErrors.rpc.invalidParams({message:`Expected an array with at least one valid string HTTPS url 'rpcUrls', Received:
${h}`}));if(l!==null&&!v)return n(pa.ethErrors.rpc.invalidParams({message:`Expected null or array with at least one valid string HTTPS URL 'blockExplorerUrl'. Received: ${l}`}));let S=typeof o=="string"&&o.toLowerCase();if(!Ed(S))return n(pa.ethErrors.rpc.invalidParams({message:`Expected 0x-prefixed, unpadded, non-zero hexadecimal string 'chainId'. Received:
${o}`}));if(!Id(parseInt(S,16)))return n(pa.ethErrors.rpc.invalidParams({message:`Invalid chain ID "${S}": numerical value greater than max safe value. Received:
${o}`}));let R=Wc(S),P=await qa({chainId:S});if(R)return R.force=!0,await a(R),e.result=null,n();if(P){let L=P.find(B=>B.rpcUrl===y);if(L)return L.force=!0,await a(N0(L)),e.result=null,n()}if(typeof c!="string"||!c)return n(pa.ethErrors.rpc.invalidParams({message:`Expected non-empty string 'chainName'. Received:
${c}`}));let N=c.length>100?c.substring(0,100):c;if(u!==null){if(typeof u!="object"||Array.isArray(u))return n(pa.ethErrors.rpc.invalidParams({message:`Expected null or object 'nativeCurrency'. Received:
${u}`}));if(u.decimals!==18)return n(pa.ethErrors.rpc.invalidParams({message:`Expected the number 18 for 'nativeCurrency.decimals' when 'nativeCurrency' is provided. Received: ${u.decimals}`}));if(!u.symbol||typeof u.symbol!="string")return n(pa.ethErrors.rpc.invalidParams({message:`Expected a string 'nativeCurrency.symbol'. Received: ${u.symbol}`}))}let M=u?.symbol||"ETH";if(typeof M!="string"||M.length<2||M.length>6)return n(pa.ethErrors.rpc.invalidParams({message:`Expected 2-6 character string 'nativeCurrency.symbol'. Received:
${M}`}));try{await s({origin:i,type:Xe.ADD_ETHEREUM_CHAIN,requestData:{chainId:S,blockExplorerUrl:v,chainName:N,rpcUrl:y,ticker:M}}),e.result=null}catch(L){return n(L)}return n()}var $le={methodNames:[Xe.ADD_ETHEREUM_CHAIN],implementation:Vle},zG=$le;d();f();var ol=_(Ce()),jG=_(te());un();ae();async function Yle(r,e,t,n,{getCurrentChainId:a,setProviderType:s}){if(!r.params?.[0]||typeof r.params[0]!="object")return n(ol.ethErrors.rpc.invalidParams({message:`Expected single, object parameter. Received:
${JSON.stringify(r.params)}`}));let{chainId:i}=r.params[0],o=Object.keys((0,jG.omit)(r.params[0],["chainId","silent"]));if(o.length>0)return n(ol.ethErrors.rpc.invalidParams({message:`Received unexpected keys on object parameter. Unsupported keys:
${o}`}));let c=typeof i=="string"&&i.toLowerCase();if(!Ed(c))return n(ol.ethErrors.rpc.invalidParams({message:`Expected 0x-prefixed, unpadded, non-zero hexadecimal string 'chainId'. Received:
${i}`}));if(!Id(parseInt(c,16)))return n(ol.ethErrors.rpc.invalidParams({message:`Invalid chain ID "${c}": numerical value greater than max safe value. Received:
${i}`}));if(a()===c)return e.result=null,n();let u=Wc(c),h=await qa({chainId:c});return u?(u.force=!0,await s(u),e.result=null,n()):h?.length?(h[0].force=!0,await s(N0(h[0])),e.result=null,n()):n(ol.ethErrors.provider.custom({code:4902,message:`Unrecognized chain ID "${i}". Try adding the chain using ${Xe.ADD_ETHEREUM_CHAIN} first.`}))}var Jle={methodNames:[Xe.SWITCH_ETHEREUM_CHAIN],implementation:Yle},VG=Jle;d();f();un();async function Xle(r,e,t,n,{getProviderState:a}){return e.result={...await a(r.origin)},n()}var Zle={methodNames:[Xe.GET_PROVIDER_STATE],implementation:Xle},$G=Zle;d();f();un();async function Qle(r,e,t,n,{handleWatchAssetRequest:a}){try{return e.result=await a(r),n()}catch(s){return n(s)}}var eue={methodNames:[Xe.WATCH_ASSET,Xe.WATCH_ASSET_LEGACY],implementation:Qle},YG=eue;var tue=[zG,VG,$G,YG],JG=tue;var XG=JG.reduce((r,e)=>{for(let t of e.methodNames)r.set(t,e.implementation);return r},new Map);function sx(r){return function(t,n,a,s){return XG.has(t.method)?XG.get(t.method)(t,n,a,s,r):a()}}d();f();var ZG=_(q$()),QG=_(Jx()),rue=()=>{};function X3(r){let e=new ZG.default;return(0,QG.default)(r,e,r,t=>{t&&rue(t)}),e}d();f();d();f();ae();d();f();function Ke({permissionsController:r,dappRequestController:e,networkController:t,coinController:n,coinBusiness:a,keyringController:s,walletConfigController:i,preferencesController:o},c,l,u){return async h=>{let b=u?await u(h):await r.getCurrentPermittedAccount(h.origin,c),y=t.getRpcMode(),v=t.getProviderConfig();y&&(i.setWalletConfig("isRpcMode",!1),i.setWalletConfig("currentNetworkUniqueId",""));let S=await l(h,b,{isRpcMode:y,rpcInfo:v,baseChain:c,coinBusiness:a,coinController:n,keyringController:s,preferencesController:o});return e.newUnapprovedRequest(S,h)}}function Z3(r){let e=Ke(r,us,J0);return Ee({[Kt.GET_PUBLIC_KEY]:async({params:{address:t}})=>r.keyringController.getPublicKey(t,us),[Kt.SIGN_AND_SUBMIT_TRANSACTION]:e,[Kt.SIGN_TRANSACTION]:e,[Kt.SIGN_MESSAGE]:e,[Kt.NETWORK]:async()=>{let{chainId:t}=await Y0();return me({chainId:t})}},!0)}d();f();ae();d();f();var ez=_(g9()),gp=_(Ce());Tn();var tz=_(Qr());ae();ne();ur();Wt();var nue=async(r,e,t)=>e.permissionsController.getCurrentPermittedAccount(r.origin,t),aue=(r,e)=>{let t=e?.walletId;return r.authController.getRequestHeaders({walletId:t,needSign:!0,currency:"usd"})},Q3=async(r,e)=>{let t=r.localType,n=await nue(r,e,t);return{headers:aue(e,n),permittedAccount:n,address:n?.address,walletId:n?.walletId}},rz=r=>{let{localType:e}=r,t=me({localType:e}),n=t?.coinId,a=t?.coinType;return{localType:e,baseCoinId:n,currency:a}},nz=r=>{let{params:e}=r,{transaction:t}=e||{},{toAddress:n,satoshis:a,options:s}=t||{},i;return s?.feeRate&&(i=s?.feeRate),{...r,params:{...e,transaction:{...t,to:n,value:a,satBytes:i}}}},az=r=>{let{params:e}=r,{transaction:t}=e||{},{value:n}=t||{};return{...r,params:{...e,transaction:{...t,value:Up.mul(n,10**8)},localType:e?.localType||pe}}},sz=async(r,e)=>{let{baseCoinId:t}=rz(r),{headers:n,address:a}=await Q3(r,e);return(await Pe(ce.getAddrBalance,{coinId:t,address:a},{headers:n,needSign:!0}))?.data},iz=async(r,e)=>{let{headers:t,address:n}=await Q3(r,e),{localType:a,params:{transaction:{cursor:s,size:i}}}=r;return(await Pe(ce.getBtcNftList,{address:n,cursor:s,size:i,chainIndex:d_(a)},{headers:t}))?.data},oz=async(r,e,t)=>{let{baseCoinId:n,currency:a}=rz(r),s=await(0,tz.calcTxHash)(a,{data:t}),{headers:i,address:o}=await Q3(r,e);return await Y9({txHash:s,signedTx:t,coinId:n,fromAdr:o,txSource:fe.DAPP},{headers:i}),s},cz=async(r,e)=>{let{rawTx:t}=r.params.transaction;return await oz(r,e,t)};function sue(r){let e="";try{/^[0-9a-fA-F]+$/.test(r)?e=r:e=ez.Psbt.fromBase64(r).toHex()}catch{throw new Error("invalid psbt")}return e}var dz=async(r,e)=>{let{psbtHex:t}=r.params.transaction,n=sue(t),a=im(n);return await oz(r,e,a)},fz=async(r,e,{coinController:t,coinBusiness:n,preferencesController:a})=>{let{name:s,protocolId:i=i8.BRC_20}=r.params;if(s?.length!==4)throw gp.ethErrors.rpc.invalidParams({message:U.errors.invalidBitcoinTokenName(s)});let o=a.getSelectedWallet(),c=a.getWalletIdentityMap();if(!c[o]?.account?.[pe])throw gp.ethErrors.rpc.invalidParams(U.errors.cantWatchAsset());let u={};try{let y=(t.getBaseCoins()||[]).find(v=>v.coinId===Hp);u=await n.getCustomCoinInfo({contractAddress:s,chainInfo:y})}catch{throw gp.ethErrors.rpc.invalidParams({message:U.errors.invalidBitcoinTokenName(s)})}if(U9({coin:{...u,protocolId:i},walletId:o,walletIdentityMap:c}))return{localType:pe,method:r.method,params:{name:s,targetCoin:u}};throw gp.ethErrors.rpc.invalidParams(U.errors.cantWatchAsset())};function bp(r,e,t){return async n=>{let a=await r.permissionsController.getCurrentPermittedAccount(n.origin,n?.params?.localType||e),s=await tw(n,a,r);return s.origin=n.origin,t(s,r)}}function e4(r){let e=n=>{let a=n?.params?.localType;return Ke(r,a,tw)(n)},t=n=>{let a=n?.params?.localType;return Ke(r,a,fz)(n)};return Ee({[oe.GET_PUBLIC_KEY]:({params:{address:n,localType:a}})=>r.keyringController.getPublicKey(n,a),[oe.GET_COMPRESSED_PUBLIC_KEY]:({params:{address:n,localType:a}})=>r.keyringController.getCompressedPublicKey(n,a),[oe.VALIDATE_ADDRESS]:({params:{address:n,localType:a}})=>SP(n,a),[oe.PSBT_HEX_TO_BASE64]:({params:{psbtHex:n}})=>uT(n),[oe.SIGN_MESSAGE]:e,[oe.TRANSFER_NFT]:e,[oe.SPLITUTXO]:e,[oe.INSCRIBE]:e,[oe.INSCRIBE_TRANSFER]:e,[oe.SIGNPSBT]:e,[oe.SIGNPSBTS]:e,[oe.SEND]:n=>e(az(n)),[oe.SEND_BTC]:n=>e(nz(n)),[oe.SEND_PSBT]:bp(r,ke,Wk),[oe.MINT]:e,[oe.WATCHASSET]:t,[oe.GET_BALANCE]:bp(r,ke,sz),[oe.GET_INSCRIPTIONS]:bp(r,ke,iz),[oe.SEND_INSCRIPTION]:e,[oe.PUSH_TX]:bp(r,ke,cz),[oe.PUSH_PSBT]:bp(r,ke,dz)},!0)}d();f();ne();d();f();var yc=_(Ce()),lr=_(m$()),uz=_(c$()),hz=_(kx());ne();Wt();ur();Hn();var ix="lovelace",pz={InvalidRequest:"Inputs do not conform to this spec or are otherwise invalid.",InternalError:"An error occurred during execution of this API call.",Refused:"The request was refused due to lack of access - e.g. wallet disconnects.",AccountChange:"The account has changed. The dApp should call `wallet.enable()` to reestablish connection to the new account. The wallet should not ask for confirmation as the user was the one who initiated the account change in the first place."},lz={ProofGeneration:"Wallet could not sign the data (e.g. does not have the secret key associated with the address).",AddressNotPK:"Address was not a P2PK address or Reward address and thus had no SK associated with it.",UserDeclined:"User declined to sign the data.",InvalidFormat:"If a wallet enforces data format requirements, this error signifies that the data did not conform to valid formats."},mz=async r=>(await lr.Loader.load(),p.Buffer.from(lr.Loader.Cardano.Address.from_bech32(r).to_bytes(),"hex").toString("hex")),gz=async r=>{await lr.Loader.load();let e=lr.Loader.Cardano.MultiAsset.new(),t=r.find(s=>s.unit===ix);[...new Set(r.filter(s=>s.unit!==ix).map(s=>s.unit.slice(0,56)))].forEach(s=>{let i=r.filter(c=>c.unit.slice(0,56)===s),o=lr.Loader.Cardano.Assets.new();i.forEach(c=>{o.insert(lr.Loader.Cardano.AssetName.new(p.Buffer.from(c.unit.slice(56),"hex")),lr.Loader.Cardano.BigNum.from_str(c.quantity))}),e.insert(lr.Loader.Cardano.ScriptHash.from_bytes(p.Buffer.from(s,"hex")),o)});let a=lr.Loader.Cardano.Value.new(lr.Loader.Cardano.BigNum.from_str(t?t.quantity:"0"));return(r.length>1||!t)&&a.set_multiasset(e),a},iue=async(r,e)=>{await lr.Loader.load();let t=await gz(r.amount);return lr.Loader.Cardano.TransactionUnspentOutput.new(lr.Loader.Cardano.TransactionInput.new(lr.Loader.Cardano.TransactionHash.from_bytes(p.Buffer.from(r.txHash,"hex")),lr.Loader.Cardano.BigNum.from_str(r.index.toString())),lr.Loader.Cardano.TransactionOutput.new(lr.Loader.Cardano.Address.from_bytes(p.Buffer.from(e,"hex")),t))},bz=async(r={},e)=>{let t=await e.permissionsController.getCurrentPermittedAccount(r.origin,Gr),n=t?.walletId,a=e.authController.getRequestHeaders({walletId:n,needSign:!0,currency:"usd"}),{data:s}=await Pe(ce.getSpecialUtxoList,{coinId:Ax,address:t?.address,fee:"0",amount:"0"},{headers:a});return s},oue=(r=[])=>r.map(t=>{let n=[{quantity:t.amount,unit:ix}];return Array.isArray(t?.multiAsset)&&t.multiAsset.forEach(a=>{let{policyId:s,assets:i}=a;i.forEach(o=>{let c=`${s}${o.assetName}`,l=o.amount;n.push({quantity:l,unit:c})})}),{txHash:t.txId,index:t.index,amount:n}}),cue=(r=[])=>{let e={quantity:"0",unit:ix},t=[e];return Array.isArray(r)&&r.forEach(n=>{e.quantity=Fn(e.quantity,n.amount),Array.isArray(n?.multiAsset)&&n.multiAsset.forEach(a=>{let{policyId:s,assets:i}=a;i.forEach(o=>{let c=`${s}${o.assetName}`,l=t.find(u=>c===u.unit);l?l.quantity=Fn(l.quantity,o.amount):t.push({quantity:o.amount,unit:c})})})}),t},t4=async(r={},e)=>{let t=await e.permissionsController.getCurrentPermittedAccount(r.origin,Gr);return mz(t?.address)},due=async(r=[],e,t)=>{if(e){await lr.Loader.load();let n;try{n=lr.Loader.Cardano.Value.from_bytes(p.Buffer.from(e,"hex"))}catch{throw yc.ethErrors.rpc.invalidParams({message:pz.InvalidRequest,req:t})}return r.filter(a=>!a.output().amount().compare(n)||a.output().amount().compare(n)!==-1)}return r},yz=async(r={},e)=>{let t=await t4(r,e),n=await bz(r,e),a=oue(n),s=await Promise.all(a.map(l=>iue(l,t))),i=r?.params?.amount;return(await due(s,i,r)).length<=0?null:s?s.map(l=>p.Buffer.from(l.to_bytes(),"hex").toString("hex")):null},xz=async(r={},e)=>{let t=await bz(r,e);if(!t?.length)return"00";let n=cue(t),a=await gz(n);return p.Buffer.from(a.to_bytes(),"hex").toString("hex")},fue=async(r,e)=>{await lr.Loader.load();try{let t=lr.Loader.Cardano.Transaction.from_bytes(p.Buffer.from(r,"hex")),n=t.body().network_id()?t.body().network_id().kind():null;if(!n&&n!=0&&(n=t.body().outputs().get(0).address().network_id()),n!==1)throw yc.ethErrors.rpc.invalidParams({message:"Wrong network",data:e})}catch{throw yc.ethErrors.rpc.invalidParams({message:pz.InvalidRequest,data:e})}},wz=async(r,e)=>{Ye(e);let t={localType:Gr,method:r.method,params:{},walletId:e?.walletId};if(r.method===br.SIGN_DATA){if(p.Buffer.from(r?.params?.payload,"hex").length<=0)throw yc.ethErrors.rpc.invalidParams({message:lz.InvalidFormat,data:r});if(await mz(e?.address)!==r?.params?.address)throw yc.ethErrors.rpc.invalidParams({message:lz.InvalidFormat,data:r});return t.params.payload=r?.params?.payload,t}if(r.method===br.SIGN_TX)return await fue(r?.params?.tx,r),t.params.tx=r?.params?.tx,t;throw yc.ethErrors.rpc.invalidParams({message:U.errors.invalidRequestArgs(),data:r})},vz=async(r,e)=>{let t=(0,uz.toBase64)((0,hz.fromHex)(r?.params?.tx)),n=await je(Gr,t),a=await e.permissionsController.getCurrentPermittedAccount(r.origin,Gr),s=a?.walletId,i=e.preferencesController.getServerWalletTypeByWalletId(s),o={coinId:Ax,txHash:n,signedTx:t,accountId:s,toAdr:"-",serviceCharge:"0",fromAdr:a?.address,coinAmount:"0",walletType:i},l={headers:e.authController.getSignRequestHeaders({walletId:s})};return await tr(o,l),n};function r4(r){let e=Ke(r,Gr,wz);return Ee({[br.GET_ADDRESS]:t=>t4(t,r),[br.GET_UTXOS]:t=>yz(t,r),[br.GET_BALANCE]:t=>xz(t,r),[br.SIGN_DATA]:e,[br.SIGN_TX]:e,[br.SUBMIT_TX]:t=>vz(t,r)},!0)}d();f();var Sz=_(o$()),_z=_(d$()),a4=_(Zs()),Az=_(kx());function Cz(r){let{coinType:e}=gd(r)??{};return[a4.Currency.INJ,a4.Currency.EVMOS].includes(e)}function lue(r,e){return Cz(e)?(0,Az.toHex)((0,_z.publicKeyConvert)(p.Buffer.from(r,"hex"),!0)):r}function uue(r){return Cz(r)?"ethsecp256k1":"secp256k1"}function n4(r,e){return async t=>{let{method:n,params:{transaction:a}}=t;ew(a.chainId,Hx()),M5(n,a);let{baseChain:s}=gd(a.chainId)??{},i=await r.permissionsController.getCurrentPermittedAccount(t.origin,s);r.networkController.getRpcMode()&&(r.walletConfigController.setWalletConfig("isRpcMode",!1),r.walletConfigController.setWalletConfig("currentNetworkUniqueId",""));let c=N5(t,i,s);return e?e(c,t):r.dappRequestController.newUnapprovedRequest(c,t)}}function s4(r){let e=n4(r),t=n4(r,a=>Dk(a,r)),n=n4(r,Lk);return Ee({[ze.GET_PUBLIC_KEY_AND_HEX_ADDRESS]:async({params:{address:a,baseChain:s,chainId:i}})=>{let o=await r.keyringController.getPublicKey(a,s);o=lue(o,i);let c=(0,Sz.fromBech32)(a)[1].toString("hex"),l=uue(i);return{pubKey:o,hexAddress:c,algo:l}},[ze.GET_CHAIN_BY_CHAIN_ID]:async({params:{chainId:a}})=>{ew(a,Hx());let{baseChain:s}=gd(a)??{};return s},[ze.GET_SUPPORT_CHAINS]:()=>Po().map(s=>s),[ze.SEND_TX]:t,[ze.SIGN_AMINO]:e,[ze.SIGN_DIRECT]:e,[ze.SIGN_ARBITRARY]:e,[ze.SIGN_ETHEREUM]:e,[ze.VERIFY_ARBITRARY]:n},!0)}d();f();ne();d();f();var Tz=_(Ce());ne();var Iz=(r,e)=>{Ye(e);let t={localType:Qs,method:r.method,params:{},walletId:e?.walletId},n=r.params?.message;if(n)return t.params.message=n,t;throw Tz.ethErrors.rpc.invalidParams({message:U.errors.invalidRequestArgs(),data:r})};function i4(r){let e=Ke(r,Qs,Iz);return Ee({[ld.SIGN_MESSAGE]:e},!0)}d();f();ne();d();f();var o4=_(Zs()),Nz=_(L_()),Rz=_(Ce()),kz=_(te()),ox=_(Qr());ne();ur();d();f();async function Ez(r){await(await ft.near_accesskey).set(r)}async function Pz(r){return(await ft.near_accesskey).query(r)}Wt();Hn();var hue=.25,pue=4,Oz=async(r,e)=>{let{contractId:t,methodNames:n,accountId:a,origin:s}=e,i=n.sort(),o=a+t+s+i.join("");try{let P=(await Pz({id:o}))[0];if(P){let{accessKey:N}=P,{data:M}=await Pe(ce.checkNearPublickey,{address:a,userPublicKeys:[N.publicKey]});if(M.find(B=>B.publicKey===N.publicKey).checkResult)return N}}catch(P){console.log(P)}let{txController:c,authController:l,keyringController:u,preferencesController:h}=r,b=h.getSelectedWallet(),y=await(0,ox.getRandomPrivateKey)(o4.Currency.Near),{publicKey:v}=await(0,ox.getNewAddress)(o4.Currency.Near,{privateKey:y}),R={secretKey:y.split(":")[1],publicKey:v};try{let P=await c.getGasSignInfo(Dc,a),{nonce:N,blockHash:M}=P.info,L=await u.signTransaction({type:pue,from:a,blockHash:M,nonce:N,receiverId:a,publicKey:v,accessKey:(0,Nz.functionCallAccessKey)(t,n,Nn(hue,10**24))},a,ln);return await tr({signedTx:L,coinAmount:0,coinId:Dc,fromAdr:a,toAdr:a,serviceCharge:0},{headers:l.getSignRequestHeaders({walletId:b})}),await Ez({accessKey:R,contractId:t,methodNames:n,accountId:a,origin:s,id:o}),R}catch{return{}}},mue=r=>r.map(e=>{let{isUint8ArrayArgs:t,args:n,...a}=e;if(t)try{let s=new Uint8Array((0,kz.values)(n)),i=p.Buffer.from(s).toString("utf8");a.args=JSON.parse(i)}catch{a.args=n}else a.args=n;return a}),Mz=r=>({receiverId:r.receiverId,actions:mue(r.actions)}),Dz=(r,e)=>{Ye(e);let t={localType:ln,method:r.method,params:r.params,walletId:e?.walletId};if([Ze.SIGN_TRANSACTION,Ze.SIGN_AND_SEND_TRANSACTION].includes(r.method)){let n=r.params.transaction;t.params.transaction=Mz(n)}if(r.method===Ze.REQUEST_SIGN_TRANSACTIONS){let n=r.params.transactions;t.params.transactions=n.map(a=>Mz(a))}if(r.method===Ze.SIGN_MESSAGE){let n=r.params.message||{};if(!(n.nonce&&n.message&&n.recipient))throw Rz.ethErrors.rpc.invalidParams({message:U.errors.invalidParams(),data:r})}return t};function c4(r){let e=Ke(r,ln,Dz);return Ee({[Ze.GET_TEMP_KEY_PAIR]:async({params:t})=>Oz(r,t),[Ze.SEND_MONEY]:e,[Ze.SIGN_AND_SEND_TRANSACTION]:e,[Ze.REQUEST_SIGN_TRANSACTIONS]:e,[Ze.SIGN_TRANSACTION]:e,[Ze.SIGN_MESSAGE]:e},!0)}d();f();ne();var cx=_(D_());var Lz=(r,e)=>{let{origin:t,method:n}=e;return r.silenceController.hasSilencePermission(t,{method:n,chain:qn})},Bz=async(r,e)=>{let{origin:t}=e,n=await r.permissionsController.getCurrentPermittedAccount(t,qn),{walletId:a}=n;return await r.keyringController.getAccountByWalletIdAndLocalType(a,qn)},gue=async(r,e)=>{let{params:t}=e,n=await Bz(r,e),a=t.event;return await r.keyringController.signTransaction(a,n,qn)},bue=async(r,e)=>{let{params:t={}}=e,{pubKey:n,text:a}=t.message||{},s=await Bz(r,e),i=new cx.CryptTextParams(cx.nipOpType.NIP04_Encrypt,n,a);return await r.keyringController.signTransaction(i,s,qn)};function d4(r){let e=Ke(r,qn,O5);return Ee({[hn.GET_PUBLIC_KEY]:({params:{address:t}})=>r.keyringController.getPublicKey(t,qn),[hn.SIGN_EVENT]:async t=>Lz(r,t)?gue(r,t):e(t),[hn.ENCRYPT_TEXT_04]:async t=>Lz(r,t)?bue(r,t):e(t),[hn.DECRYPT_TEXT_04]:e},!0)}d();f();ae();function f4(r){let e=Ke(r,Pn,j0);return Ee({[Te.SIGN_AND_SEND_TRANSACTION]:e,[Te.SIGN_TRANSACTION]:e,[Te.SIGN_ALL_TRANSACTIONS]:e,[Te.SIGN_MESSAGE]:e},!0)}d();f();ne();function l4(r){let e=Ke(r,go,sG);return Ee({[ga.GET_PUBLIC_KEY]:({params:{address:t}})=>r.keyringController.getPublicKey(t,go),[ga.SIGN_TRANSACTION]:e,[ga.SIGN_MESSAGE]:e},!0)}d();f();d();f();var Wz=_(On());ae();d();f();function cl(r){return e=>({...e,method:r[e.method]||e.method})}d();f();function xc(r){return Ee({bulkGetPublicKey:async({params:{accounts:e}})=>await r.keyringController.bulkGetPublicKey(e),checkWalletStandardDapp:async({origin:e,params:{chainName:t}})=>r.walletStandardController.checkWalletStandardDapp(e,t)})}var yue={[vr.SIGN_MESSAGE]:Te.SIGN_MESSAGE,[vr.SIGN_TRANSACTION]:Te.SIGN_ALL_TRANSACTIONS,[vr.SIGN_AND_SEND_TRANSACTION]:Te.SIGN_AND_SEND_TRANSACTION};function dx(r){let e=_d(cl(yue),Ke(r,Pn,j0));return(0,Wz.mergeMiddleware)([xc(r),Ee({[vr.SIGN_MESSAGE]:e,[vr.SIGN_TRANSACTION]:e,[vr.SIGN_AND_SEND_TRANSACTION]:e},!0)])}d();f();ne();var Kz=_(On());var xue={[ht.SUI_SIGN_AND_EXECUTE_TRANSACTION_BLOCK]:Wa.SIGN_AND_EXECUTE_TRANSACTION_BLOCK,[ht.SUI_SIGN_TRANSACTION_BLOCK]:Wa.SIGN_TRANSACTION_BLOCK,[ht.SUI_SIGN_MESSAGE]:Wa.SIGN_MESSAGE,[ht.SUI_SIGN_PERSONAL_MESSAGE]:Wa.SIGN_PERSONAL_MESSAGE};function fx(r){let e=_d(cl(xue),Ke(r,ds,E5));return(0,Kz.mergeMiddleware)([xc(r),Ee({[ht.SUI_SIGN_AND_EXECUTE_TRANSACTION_BLOCK]:e,[ht.SUI_SIGN_TRANSACTION_BLOCK]:e,[ht.SUI_SIGN_MESSAGE]:e,[ht.SUI_SIGN_PERSONAL_MESSAGE]:e},!0)])}d();f();var qz=_(On());ae();ne();var wue={[we.SIGN_AND_SUBMIT_TRANSACTION]:Kt.SIGN_AND_SUBMIT_TRANSACTION,[we.SIGN_TRANSACTION]:Kt.SIGN_TRANSACTION,[we.SIGN_MESSAGE]:Kt.SIGN_MESSAGE};function lx(r){let e=_d(cl(wue),Ke(r,Oc,J0));return(0,qz.mergeMiddleware)([xc(r),Ee({[we.SIGN_AND_SUBMIT_TRANSACTION]:e,[we.SIGN_TRANSACTION]:e,[we.SIGN_MESSAGE]:e,[we.NETWORK]:async()=>{let{chainId:t}=await Y0();return me({chainId:t})}},!0)])}d();f();ne();ae();function u4(r){let e=Ke(r,xn,k5);return Ee({requestRpcUrl:()=>me({localType:xn})?.rpcUrl,[ys.EXECUTE]:e,[ys.SIGN_MESSAGE]:e},!0)}d();f();ne();d();f();var Uz=_(s0()),Fz=_(Ce());ne();var Hz=(r,e,{baseChain:t})=>{Ye(e);let n={localType:t,method:r.method,params:{},walletId:e?.walletId},{transaction:a}=r.params;if(a)return n.params.transaction=a,n;throw Fz.ethErrors.rpc.invalidParams({message:U.errors.invalidRequestArgs(),data:r})},Gz=async(r,e)=>{let{permissionsController:t}=r,n=e.params.transaction?.from;if(n){let a=new Uz.TonWallet,s=await t.getAllPermittedAccounts(e.origin,er);return(await Promise.all((s||[]).map(async c=>{let l=await a.convertAddress({address:n}),{account:u}=c,h=u?.[er],b=h?await a.convertAddress({address:h}):null;return l?.raw===b?.raw?c:null}))).filter(Boolean)[0]}return t.getCurrentPermittedAccount(e.origin,er)};function h4(r){let e=Ke(r,er,Hz,t=>Gz(r,t));return Ee({[ci.SEND_TRANSACTION]:e},!0)}d();f();ae();function vue(r,e){return async t=>{let n=await r.permissionsController.getCurrentPermittedAccount(t.origin,e),a=Qx(t,n);return X1(a,r)}}function p4(r){let e=Ke(r,Un,Qx);return Ee({[$r.SEND_RAW_TRANSACTION]:vue(r,Un),[$r.SIGN_TRANSACTION]:e,[$r.SIGN_MESSAGE]:e,[$r.SIGN_MESSAGE_V2]:e},!0)}d();f();ne();d();f();var zz=_(Ce());var jz=(r,e,{baseChain:t})=>{Ye(e);let n={localType:t,method:r.method,params:{},walletId:e?.walletId},{transaction:a}=r.params;if(a)return G0(r,e,a.from),n.params={...r.params,transaction:a},n;throw zz.ethErrors.rpc.invalidParams({message:U.errors.invalidRequestArgs(),data:r})};function m4(r){let e=Ke(r,fs,jz);return Ee({[oi.GET_PUBLIC_KEY]:({params:{address:t}})=>r.keyringController.getPublicKey(t,fs),[oi.SIGN_TRANSACTION]:e},!0)}function g4(r,e){switch(r){case jc:return f4(e);case Rn:return Z3(e);case Vc:return p4(e);case $c:return s4(e);case Yc:return dx(e);case Jc:return fx(e);case Xc:return lx(e);case zn:case ed:case td:case rd:return e4(e);case Zc:return l4(e);case Ao:return u4(e);case Qc:return r4(e);case nd:return d4(e);case ad:return i4(e);case sd:return c4(e);case id:return m4(e);case ps:return h4(e);default:return null}}var yp=class{initializeProvider(){let e=this.platform.getVersion(),t={static:{eth_syncing:!1,web3_clientVersion:`MetaMask/v${e}`},version:e,getNetworkType:()=>this.networkController.getProviderConfig().type,getAccounts:async({origin:a})=>{if(a==="metamask"){let s=this.preferencesController.getSelectedAddress();return s?[s]:[]}else if(this.isUnlocked())return this.permissionsController.getEthAccounts(a);return[]},processTransaction:this.newUnapprovedTransaction.bind(this),processEthSignMessage:this.newUnsignedMessage.bind(this),processTypedMessage:this.newUnsignedTypedMessage.bind(this),processTypedMessageV3:this.newUnsignedTypedMessage.bind(this),processTypedMessageV4:this.newUnsignedTypedMessage.bind(this),processPersonalMessage:this.newUnsignedPersonalMessage.bind(this),processDecryptMessage:this.newRequestDecryptMessage.bind(this),processEncryptionPublicKey:this.newRequestEncryptionPublicKey.bind(this),getPendingTransactionByHash:a=>this.txController.getTransactions({searchCriteria:{hash:a,status:Oe.SUBMITTED}})[0]};return this.networkController.initializeProvider(t)}setupUntrustedCommunication(e,t){[PG,...MG].forEach(({contentScript:n,provider:a})=>{let s=new ip(a,e),i=n===i0,o=X3(s),c=a,l=o.createStream(c),u=o.createStream(`${c}_contentScript`),h=i?this.setupProviderEngine:this.setupChainProviderEngine;[l,u].forEach(b=>{this.setupProviderConnection(b,t,c,h.bind(this))})})}setupTrustedCommunication(e,t){let n=X3(e);this.setupControllerConnection(n.createStream("controller")),this.setupProviderConnection(n.createStream("provider"),t,"provider",this.setupProviderEngine.bind(this),!0)}setupControllerConnection(e){let t=this.getApi();this.activeControllerConnections+=1,this.emit("controllerConnectionChanged",this.activeControllerConnections),e.on("data",BG(t,e));let n=(s=this.getState())=>{e._writableState.ended||e.write({jsonrpc:"2.0",method:"sendUpdate",params:[s]})},a=s=>{e._writableState.ended||e.write({jsonrpc:"2.0",method:"sendPartialUpdate",params:[s]})};this.on("update",n),this.on("partialUpdate",a),e.on("end",()=>{this.activeControllerConnections-=1,this.emit("controllerConnectionChanged",this.activeControllerConnections),this.removeListener("update",n),this.removeListener("partialUpdate",a)})}setupProviderConnection(e,t,n,a,s){let i=s?"metamask":new URL(t.url).origin,o;t.id!==this.extension.runtime.id&&(o=t.id);let c;t.tab&&t.tab.id&&(c=t.tab.id);let l=this.createConnectionId(i),u=a({origin:i,location:t.url,extensionId:o,tabId:c,providerType:n,connectionId:l,isInternal:s}),h=(0,Jz.default)({engine:u});this.addConnection({origin:i,connectionId:l},{engine:u}),(0,Qz.default)(e,h,e,b=>{u._middleware.forEach(y=>{y.destroy&&typeof y.destroy=="function"&&y.destroy()}),l&&this.removeConnection(i,l),b&&Xz.default.error(b)})}setupProviderEngine({origin:e,location:t,extensionId:n,tabId:a,connectionId:s,isInternal:i=!1,providerType:o}){let c=new b4.JsonRpcEngine,{provider:l,blockTracker:u}=this,h=(0,Vz.default)({provider:l,blockTracker:u}),b=(0,$z.default)({provider:l,blockTracker:u});return b.events.on("notification",y=>c.emit("notification",y)),c.push(rx({origin:e,providerType:o,connectionId:s})),c.push(Dx({origin:e})),a&&c.push(nx({tabId:a})),c.push(ex({origin:e})),c.push(tx({location:t,registerOnboarding:this.onboardingController.registerOnboarding})),c.push(Qy()),c.push(sx({origin:e,getProviderState:this.getProviderState.bind(this),handleWatchAssetRequest:this.preferencesController.requestWatchAsset.bind(this.preferencesController),getCurrentChainId:this.networkController.getCurrentChainId.bind(this.networkController),requestUserApproval:this.approvalController.addAndShowApprovalRequest.bind(this.approvalController),getRpcMode:this.networkController.getRpcMode.bind(this.networkController),setProviderType:({type:y,rpcUrl:v,ticker:S,chainName:R,chainId:P,rpcPrefs:N,force:M,uniqueId:L})=>{this.networkController.setProviderType(y,v,S,R,P,N,M,L)},setWalletConfig:this.walletConfigController.setWalletConfig.bind(this.walletConfigController)})),c.push(h),c.push(b.middleware),i||(c.push(Y3(this)),c.push(this.permissionsController.createMiddleware({origin:e,extensionId:n}))),c.push((0,Yz.default)(l)),c}setupChainProviderEngine({origin:e,location:t,tabId:n,providerType:a,connectionId:s}){let i=new b4.JsonRpcEngine;i.push(rx({origin:e,providerType:a,connectionId:s})),i.push(Dx({origin:e})),n&&i.push(nx({tabId:n})),i.push(ex({origin:e})),i.push(tx({location:t,registerOnboarding:this.onboardingController.registerOnboarding})),i.push(Qy());let o=g4(a,this);return o&&i.push(o),i}createConnectionId(e){return e==="metamask"?"":(this.connections[e]||(this.connections[e]={}),(0,Zz.default)())}addConnection({origin:e,connectionId:t},{engine:n}){e!=="metamask"&&(this.connections[e][t]={engine:n})}removeConnection(e,t){let n=this.connections[e];!n||(delete n[t],Object.keys(n).length===0&&delete this.connections[e])}notifyConnections({origin:e,connectionId:t},n){let a=this.connections[e];a&&Object.keys(a).forEach(s=>{let i=a[s];i.engine&&(!t||t===s)&&i.engine.emit("notification",n)})}notifyAllConnections(e){let t=typeof e=="function"?n=>e(n):()=>e;Object.values(this.connections).forEach(n=>{Object.values(n).forEach(a=>{a.engine&&a.engine.emit("notification",t(n))})})}onStateUpdate(){let{isUnlocked:e}=this.keyringController.memStore.getState();this.isClientOpenAndUnlocked=e&&this._isClientOpen,this.notifyAllConnections({method:Kr.chainChanged,params:this.getProviderNetworkState()})}onLock(e=!1){this.notifyAllConnections({method:Kr.unlockStateChanged,params:{auto:e}}),this.emit("lock",e)}getProviderNetworkState(){let e=this.networkController.network;return{chainId:this.networkController.getCurrentChainId(),networkVersion:e}}async getProviderState(e){let t=this.isUnlocked();return{isUnlocked:t,...this.getProviderNetworkState(),accounts:t?await this.permissionsController.getEthAccounts(e,!1):[]}}};d();f();ae();var xp=class{async getKeyringForDevice(e){let t=m9[e];if(!t)throw new Error("OKX Wallet:getKeyringForDevice - Unknown device");let n=await this.keyringController.getKeyringsByType(t)[0];return n||(n=await this.keyringController.addNewKeyring(t,{baseChains:[J]})),n.network=this.networkController.getProviderConfig().type,n}notifyUpdateWalletsAssets(){try{this.balanceController.getCurrentWalletBalance(),this.serverPushController.sendData()}catch(e){console.log(e)}}async addChainForHardwareWallet(e,t,n){let a=await this.keyringController.addHareWareWalletChainWithWalletId(e,t,n);return await this.syncAddressesAndSetSelectedWallet(n,!0),a}async addHardwareWalletAccount(e,t,n,a){let s=await this.getKeyringForDevice(e),{hdPathMap:i,...o}=await this.keyringController.addWalletWithMultipleKeyring({multipleKeyring:s,accountData:t,baseChain:n}),c=yr.HARD_WALLET,l={...o,serverWalletType:c};return this.preferencesController.insertHardwareKeyringIdentity(l,a),this.setNewWalletIdentity(o.walletId),await this.privateCreateWallet(o.walletId,c),{hdPathMap:i,...o}}async importHardwareWalletAccount(e,t,n){this.onboardingController.completedOnboarding||this.clearCacheAboutKeyring();let a=await this.getKeyringForDevice(e),{hdPathMap:s,...i}=await this.keyringController.addWalletWithMultipleKeyring({multipleKeyring:a,accountData:t,baseChain:n}),{walletId:o}=i,c=yr.HARD_WALLET,l={...i,serverWalletType:c},u=this.preferencesController.insertHardwareKeyringIdentity(l);return this.setNewWalletIdentity(o),await this.privateCreateWallet(o,c),{hdPathMap:s,...u}}updateOnekeyDeviceId(e){let{connectId:t,deviceId:n,firstEvmAddress:a}=e,s=tm(t,a),{connectedOnekey:i}=this.walletConfigController.getWalletConfig(),o=i[s];this.walletConfigController.setConnectedOnekey({...o,deviceId:n}),this.preferencesController.updateOnekeyDeviceId(e),this.keyringController.updateOnekeyDeviceId(e)}};d();f();var ej=_(Qr());ae();var wp=class{async addNewWallet(e){let t=await this.keyringController.addNewWallet(e),a=this.preferencesController.getWalletIdentityByWalletId(e).serverWalletType,s={...t,serverWalletType:a},i=this.preferencesController.pushAnyWalletIdentity(e,s);return this.setNewWalletIdentity(t.walletId),await this.privateCreateWallet(t.walletId,a),await this.balanceController.getCurrentWalletBalance(),await this.serverPushController.sendData(),i}async addNewWallets(e,t=1){if(t>1)throw new Error("Exceeding the maximum limit on the server");this.accountController.startAddAccount();try{return await this.accountController.addNewAccounts(e,t)}finally{this.accountController.finishAddAccount()}}async removeWallet(e){await this.keyringController.removeWallet(e),this.walletCreateController.removeWalletsToServer([e]).catch(()=>{console.log("removeWalletsToServer error")}),this.preferencesController.deleteWalletIdentity(e),this.coinController.removeWalletCoins(e),await this.removeAllAccountPermissions([e]),await this.authController.removeAuthKeyByWalletId(e),this.balanceController.removeAsset(e)}async removeWallets(e){await this.keyringController.removeWallets(e);let n=this.preferencesController.getMnemonicWalletIdentities(e).map(a=>a.walletId);this.walletCreateController.removeWalletsToServer(n).catch(()=>{console.log("removeWalletsToServer error")}),this.preferencesController.deleteKeyringIdentity(e),n.forEach(a=>{this.coinController.removeWalletCoins(a)}),await this.removeAllAccountPermissions(n);for(let a=0;a<n.length;a++){let s=n[a];await this.authController.removeAuthKeyByWalletId(s),this.balanceController.removeAsset(s)}}async privateCreateWallet(e,t=yr.UNKNOWN,n=!0){try{await this.walletCreateController.createWalletToServer({walletId:e,walletType:t,noticeBackend:n})}catch{throw new Error(W0)}finally{this.coinController.initAddedCoins(e)}}async updateWalletAddress(e,t,{needUpdateBalance:n=!t[ke],needUpdateSegwitAddressType:a=!1,needSync:s=!t[ke],needEmitChangeAddress:i=!0}={}){let o=this.preferencesController.getWalletIdentityByWalletId(e);if(!o||!t)return;let c=Object.entries(t).map(([l,u])=>({baseChain:l,type:u,address:o.account[l]}));await this.keyringController.updateWalletAddress(e,c),this.preferencesController.updateWalletIdentityAccount(e,t),s&&await this.syncAddressesAndSetSelectedWallet(e,!0,!1),i&&this.permissionsController._handleAccountSelected(e),n&&(this.serverPushController.sendData(),this.balanceController.getBalanceIfSelectedDebounce(e)),a&&await this.walletCreateController.setSegwitAddressType(e)}async getBackupPrivateKeys(e){let[t,n]=await Promise.all([this.keyringController.getPrivateKeyMapByWalletId(e),this.coinController.getWalletBaseCoins(e)]),a=this.preferencesController.getWalletIdentityMap(),s=a[e]?.account||{},i=[],o=this.isPrivateWalletByWalletId(e);return n.forEach(({localType:c,coinId:l,chainName:u,image:h,isHotNetwork:b,hotNetworkRank:y})=>{if(U_({coinId:l})){let v=a[e]?.accountsMap[c],S=this.keyringController.getWallet(e).segwitAddressType[c],R=Co[c].reduce((N,M)=>((M===de.SEGWIT_NESTED_49||M===de.SEGWIT_NESTED)&&M!==S||(o?N[M]=t[c]:t[`${c}_${M}`]&&(N[M]=t[`${c}_${M}`])),N),{});Object.keys(R).forEach(N=>{let M=R[N],L=N;i.push({walletId:e,privateKey:M,address:v[N].address,shortenedAddress:Gc(s[c]),coinId:l,chainName:u,image:h,btcAddressType:L,isHotNetwork:b,hotNetworkRank:y})})}else{let v=t[c];i.push({walletId:e,privateKey:v,address:s[c],shortenedAddress:Gc(s[c]),coinId:l,chainName:u,image:h,isHotNetwork:b,hotNetworkRank:y})}}),i}async setLocked(e=!1){let t=await this.keyringController.setLocked(e);return this.notifyAllConnections({method:Kr.accountsChanged,params:[]}),this.notifyAllConnections({method:Kr.identitiesChanged,params:[]}),this.notifyAllConnections({method:Kr.walletChanged,params:[]}),t}isUnlocked(){return this.keyringController.memStore.getState().isUnlocked}async createWalletAndRestore(e){let t=await this.createVaultMutex.acquire();try{this.clearCacheAboutKeyring();let n=await this.keyringController.createWalletAndRestore(e),{walletId:a}=n,s=yr.NEW;await this.privateCreateWallet(a,s,!1);let i={...n,serverWalletType:s},o=this.preferencesController.insertMnemonicKeyringIdentity(i);return this.setNewWalletIdentity(a),o}finally{t()}}async importWalletWithMnemonicAndRestore(e,t,n={}){let a=await this.createVaultMutex.acquire();try{this.clearCacheAboutKeyring();let s=await this.keyringController.importWalletWithMnemonicAndRestore(e,t,n),{walletId:i}=s,o=yr.IMPORT;await this.privateCreateWallet(i,o,!1);let c={...s,serverWalletType:o},l=this.preferencesController.insertMnemonicKeyringIdentity(c);return this.setNewWalletIdentity(i),l}finally{a()}}async importWalletWithPrivateKeyAndRestore(e,t,n,a=!1){let s=await this.createVaultMutex.acquire();try{this.clearCacheAboutKeyring();let i=await this.keyringController.importWalletWithPrivateKeyAndRestore(e,t,n),{walletId:o}=i,c=yr.PRIVATE_KEY;await this.privateCreateWallet(o,c,a);let l={...i,serverWalletType:c},u=this.preferencesController.insertPrivateKeyKeyringIdentity(l);return this.setNewWalletIdentity(o),u}finally{s()}}async importWalletWithMpcAndRestore(e,{cipherText:t,privateKey:n},a){let s=await this.createVaultMutex.acquire();try{this.clearCacheAboutKeyring();let i=await(0,ej.RSADecodeQRCodeInfo)(t,n),o=await this.keyringController.importWalletWithMpcAndRestore(e,{share2:i,...a}),{walletId:c}=o,l=yr.MPC_WALLET;await this.privateCreateWallet(c,l,!1);let u={...o,serverWalletType:l},h=this.preferencesController.insertMpcKeyKeyringIdentity(u);return this.setNewWalletIdentity(c),h}finally{s()}}async createWallet(){let e=await this.keyringController.createWallet(),{walletId:t}=e,n=yr.NEW;await this.privateCreateWallet(t,n,!1);let a={...e,serverWalletType:n},s=this.preferencesController.insertMnemonicKeyringIdentity(a);return this.setNewWalletIdentity(t),s}async importWalletWithMnemonic(e,t=!0,n={}){let a=await this.keyringController.importWalletWithMnemonic(e,t,n),{walletId:s}=a,i=yr.IMPORT;await this.privateCreateWallet(s,i,!1);let o={...a,serverWalletType:i},c=this.preferencesController.insertMnemonicKeyringIdentity(o);return this.setNewWalletIdentity(s),c}async importWalletWithPrivateKey(e,t,n=!1){let a=await this.keyringController.importWalletWithPrivateKey(e,t),{walletId:s}=a,i=yr.PRIVATE_KEY,o={...a,serverWalletType:i},c=this.preferencesController.insertPrivateKeyKeyringIdentity(o);return this.setNewWalletIdentity(s),await this.privateCreateWallet(s,i,n),c}async importMpcWallet(e){let t=await this.keyringController.importMpcWallet(e),{walletId:n}=t,a=yr.MPC_WALLET;await this.privateCreateWallet(n,a,!1);let s={...t,serverWalletType:a},i=this.preferencesController.insertMpcKeyKeyringIdentity(s);return this.setNewWalletIdentity(n),i}async backupMnemonic(e){await this.keyringController.backupMnemonic(e);let{keyringIdentities:t}=this.preferencesController.store.getState();return t.forEach(n=>{n.walletIdentities.find(s=>s.walletId===e)&&n.walletIdentities.forEach(s=>{s.backupData=[]})}),this.preferencesController.updateAllKeyringIdentities(t),!0}async getPublicKeyByWalletId(e,t){let{publicKeyMap:n}=await this.keyringController.getAccountInfoByWalletId(e);return n[t]||""}};d();f();var y4=_(Gn()),is=_(Fr()),vp=class{signMessage(e,t,n){is.default.info("signMessage");let a=e.metamaskId;return this.messageManager.approveMessage(e).then(s=>s.result?s.result:this.keyringController.signMessage(s,{},t,n)).then(s=>(this.messageManager.setMsgStatusSigned(a,s),this.getState())).catch(()=>{this.messageManager.rejectMsg(a)})}cancelMessage(e,t){let{messageManager:n}=this;n.rejectMsg(e),!(!t||typeof t!="function")&&t(null,this.getState())}signPersonalMessage(e,t,n){is.default.info("signPersonalMessage");let a=e.metamaskId;return this.personalMessageManager.approveMessage(e).then(s=>s.result?s.result:this.keyringController.signPersonalMessage(s,{},t,n)).then(s=>(this.personalMessageManager.setMsgStatusSigned(a,s),this.getState())).catch(()=>{this.cancelPersonalMessage(a)})}cancelPersonalMessage(e,t){this.personalMessageManager.rejectMsg(e),!(!t||typeof t!="function")&&t(null,this.getState())}async signTypedMessage(e,t,n){is.default.info("eth_signTypedData");let a=e.metamaskId,{version:s}=e;try{let i=await this.typedMessageManager.approveMessage(e);if(s!=="V1"&&typeof i.data=="string"&&(i.data=JSON.parse(i.data)),e.uiSignErrorMessage)throw new Error(e.uiSignErrorMessage);let o;return e.rawSig?o=e.rawSig:o=await this.keyringController.signTypedMessage(i,{version:s},t,n),this.typedMessageManager.setMsgStatusSigned(a,o),this.getState()}catch(i){throw is.default.info("eth_signTypedData failed.",i),this.typedMessageManager.errorMessage(a,i),i}}cancelTypedMessage(e,t){this.typedMessageManager.rejectMsg(e),!(!t||typeof t!="function")&&t(null,this.getState())}async decryptMessage(e){is.default.info("decryptMessage");let t=e.metamaskId;try{let n=await this.decryptMessageManager.approveMessage(e),a=(0,y4.stripHexPrefix)(n.data),s=p.Buffer.from(a,"hex");n.data=JSON.parse(s.toString("utf8"));let i=await this.keyringController.decryptMessage(n);this.decryptMessageManager.setMsgStatusDecrypted(t,i)}catch(n){is.default.info("eth_decrypt failed.",n),this.decryptMessageManager.errorMessage(t,n)}return this.getState()}async decryptMessageInline(e){is.default.info("decryptMessageInline");let t=e.metamaskId,n=this.decryptMessageManager.getMsg(t);try{let a=(0,y4.stripHexPrefix)(e.data),s=p.Buffer.from(a,"hex");e.data=JSON.parse(s.toString("utf8")),n.rawData=await this.keyringController.decryptMessage(e)}catch(a){n.error=a.message}return this.decryptMessageManager._updateMsg(n),this.getState()}cancelDecryptMessage(e,t){this.decryptMessageManager.rejectMsg(e),!(!t||typeof t!="function")&&t(null,this.getState())}async encryptionPublicKey(e){is.default.info("encryptionPublicKey");let t=e.metamaskId;try{let n=await this.encryptionPublicKeyManager.approveMessage(e),a=await this.keyringController.getEncryptionPublicKey(n.data);this.encryptionPublicKeyManager.setMsgStatusReceived(t,a)}catch(n){is.default.info("MetaMaskController - eth_getEncryptionPublicKey failed.",n),this.encryptionPublicKeyManager.errorMessage(t,n)}return this.getState()}cancelEncryptionPublicKey(e,t){this.encryptionPublicKeyManager.rejectMsg(e),!(!t||typeof t!="function")&&t(null,this.getState())}};d();f();var tj=_(Ce());ae();ur();Wt();var Sp=class{rejectPendingApproval(e,t){let n=tj.ethErrors.provider.userRejectedRequest();this.approvalController.reject(e,n),!(!t||typeof t!="function")&&t(null)}clearCookie(e){this.notifyConnections({origin:e},{method:Kr.clearCookie,params:{}})}async chainUpdateCallback(e){try{let t=st(),{walletConfig:n}=this.walletConfigController.store.getState(),{isRpcMode:a,currentNetworkUniqueId:s}=n;if(!a&&s&&!t.find(i=>String(i.chainId)===s)&&this.resetToAllNetwork(),this.networkController.onRemoteConfigChange(),e){await this.keyringController.unlockKeyrings();let i=this.preferencesController.getSelectedWallet();await this.walletCreateController.syncAddresses(i),await this.balanceController.getAllWalletsBalance()}}catch{}}recordFirstTimeInfo(e){if(!("firstTimeInfo"in e)){let t=this.platform.getVersion();e.firstTimeInfo={version:t,date:Date.now()}}}set isClientOpen(e){this._isClientOpen=e}async fetchApprovalRisk(e){if(this.walletConfigController.getWalletConfig()?.isApprovalRiskRemindLater)return{};let{data:t}=await Pe(ce.approvalRisk,e);return t}resetToAllNetwork(){this.walletConfigController.setWalletConfig("currentNetworkUniqueId",""),this.walletConfigController.setWalletConfig("isRpcMode",!1),this.clearDappData()}};d();f();var rj=_(te());ae();var _p=class{async patchOnSubmitPassword(){await Promise.all([this.patchController01.patchSyncAccounts()])}patchVaultWithPreferencesControllerWallets(e){let t=this.preferencesController.getWalletIdentityMap(),n=(0,rj.cloneDeep)(e),a=o=>{let c=n.find(l=>Ol(l.type));if(c&&!c?.data?.newWalletMap){let l=c.data,u=l.wallets,h=l?.optsMap?.mainnet;if(h&&u){let b=o?.account?.mainnet,y=Object.entries(u).find(([,S])=>S.walletId===o.walletId);!h?.accounts?.some(S=>Dl(S,b,{localType:J}))&&y?.length&&(h.accounts.push(b),h.accountDetails[b]={hdPath:y[0]})}}},s=o=>{let c=n.find(l=>xs(l.type));if(c&&!c?.data?.newWalletMap){let l=c.data,u=l.wallets,h=l?.optsMap?.mainnet;if(h&&u){let b=o?.account?.mainnet,y=Object.entries(u).find(([,S])=>S.walletId===o.walletId);!h?.accounts?.some(S=>Dl(S,b,{localType:J}))&&y?.length&&(h.accounts.push(b),h.paths[b]=y[0])}}},i=Object.values(t);for(let o=0;o<i.length;o++){let c=i[o];Ol(c.initialType)&&a(c),xs(c.initialType)&&s(c)}return n}};d();f();var Ap=class{async removeAllAccountPermissions(e){try{await Promise.all(e.map(t=>this.permissionsController.removeAllAccountPermissions(t)))}catch(t){console.log(t)}}};d();f();An();var x4=_(te());ae();var Cp=class{setFirstTimeFlowType(e,t){try{this.preferencesController.setFirstTimeFlowType(e),t(null)}catch(n){t(n);return}}async setCurrentLocale(e,t){try{let n=await this.preferencesController.setCurrentLocale(e);await this.currencyController.getCurrencies(),t(null,n)}catch(n){t(n);return}}markPasswordForgotten(e){this.preferencesController.setPasswordForgotten(!0),this.sendUpdate(),e()}unMarkPasswordForgotten(e){this.preferencesController.setPasswordForgotten(!1),this.sendUpdate(),e()}async setNewWalletIdentity(e){typeof e=="string"?this.preferencesController.setSelectedWallet(e):this.selectFirstWalletIdentity()}selectFirstWalletIdentity(){let{keyringIdentities:e}=this.preferencesController.store.getState(),t=e[0]?.walletIdentities[0]?.walletId;this.preferencesController.setSelectedWallet(t)}isPrivateWalletByWalletId(e){return this.preferencesController.isPrivateWalletByWalletId(e)}async syncPreferencesData(e){let t=[],n=[],a=[],s={},i=[];try{s=this.preferencesController.getWalletIdentityMap(),await Promise.all(e.map(async(o,c)=>{let{walletId:l}=o;if(!s[l]){let{accountMap:u={},accountsMap:h}=await this.keyringController.getAccountInfoByWalletId(l),b=Object.keys(u)[0];t.push(u),n.push(h);let y=u[J]||u[b];if(a.push(y),!s[l]){let v={...o,account:u,accountsMap:h};i.push(v),this.preferencesController.syncIdentityToKeyringIdentities(v,y||"",c)}}}))}catch(o){let c={isNilWallets:(0,x4.isNil)(e),isNilWalletIdentityMap:(0,x4.isNil)(s),accountMapList:t,accountsMapList:n,addressList:a};throw Ae.captureEvent({message:`${tn}-syncPreferencesData`,contexts:{report:{info:JSON.stringify(c)}},exception:{values:[{type:`${tn}-syncPreferencesData`,value:`${tn}-syncPreferencesData`}]},level:"info"}),new Error(o)}}async syncSelectedWallet(){if(!this.preferencesController.getSelectedWallet()){let t=this.preferencesController.getOldSelectedAddress(),n=await this.keyringController.patchGetWalletIdByAddress(t);return this.preferencesController.setSelectedWallet(n),!0}return!1}setSelectedCurrencyAndUpdateBalance(e){this.currencyController.setSelectedCurrency(e)}};d();f();var Tp=class{async syncAddressesAndSetSelectedWallet(e,t=!1,n=!0){await this.patchController01.patchSyncDevId(e),await this.walletCreateController.syncAddresses(e,t),n&&(this.preferencesController.setSelectedWallet(e),this.serverPushController.sendData())}async publishTransactionToServer({publishParams:e={},config:t={},walletId:n=""}){let a=this.preferencesController.getSelectedWallet(),s=n||a,i=this.authController.getSignRequestHeaders({walletId:s}),o=this.preferencesController.getServerWalletTypeByWalletId(s),c={...e,accountId:s,walletType:o},l={...t,headers:i};return await tr(c,l)}};d();f();var nj=_(Gn()),aj=_(F0());ae();ne();var Ip=class{async newUnapprovedTransaction(e,t){e.networkType=this.networkController.getProviderConfig().type;let{walletConfig:n={}}=this.walletConfigController.store.getState(),{isRpcMode:a}=n;if(a){let s={...e,method:g0.SIGN_TRANSACTION,localType:bo};return await this.newUnapprovedDappRequest(s,t)}return await this.txController.newUnapprovedTransaction(e,t)}async newUnapprovedDappRequest(e,t){return this.dappRequestController.newUnapprovedRequest(e,t)}async signRpcEvmTransaction(e,t,n,a){n&&(e=b9(e));let s=await this.keyringController.signTransaction(e,t,J,a);return n?(0,nj.bufferToHex)(s.serialize()):s}async silentOfflineSignTron(e){let{unsignedTx:t,from:n,...a}=e,{extensionTime:s=20*60}=a,o=await new aj.default({fullHost:"https://api.trongrid.io",headers:{},privateKey:""}).transactionBuilder.extendExpiration(JSON.parse(t),s),c={type:"legacy",message:JSON.stringify(o)},l=await this.keyringController.signCommonMessage(n,c,Un),{txID:u}=JSON.parse(l);return{signedTx:Pg(JSON.parse(l)),txID:u}}async offlineTransaction(e,t){e.networkType=this.networkController.getProviderConfig().type;let{walletConfig:n={}}=this.walletConfigController.store.getState(),{isRpcMode:a}=n,{domainMetadata:s}=this.permissionsController.store.getState();return s[t.origin].isOkx?a?Promise.reject(new Error("custom mode not allow send offline sign")):await this.txController.newUnapprovedTransaction({...e,isOffline:!0},t):Promise.reject(new Error("offline sign only support okx website"))}networkControllerProviderUpdate(){this.txController.networkControllerProviderUpdate()}};d();f();var Ep=class{clearCacheAboutKeyring(){this.preferencesController.setAddresses([]),this.preferencesController.setSelectedWallet(""),this.preferencesController.clearKeyringIdentities(),this.coinController.clearCoins(),this.permissionsController.clearPermissions(),this.keyringController.clearKeyrings(),this.txController.txStateManager.clearUnapprovedTxs(),this.walletCreateController.clearAboutWalletCreate()}async resetOnboarding(){let e=this.preferencesController.getWalletIdentityMap(),t=Object.keys(e);await this.preferencesController.resetOnboarding(),this.walletCreateController.removeWalletsToServer(t).catch(()=>{console.log("removeWalletsToServer error")}),this.clearCacheAboutKeyring(),this.keyringController.resetVault(),this.keyringController.setEncryptor(),await this.authController.clearAuthMap(),this.balanceController.clearAsset()}clearDappData(){this.txController.txStateManager.clearUnapprovedTxs(),this.encryptionPublicKeyManager.clearUnapproved(),this.personalMessageManager.clearUnapproved(),this.typedMessageManager.clearUnapproved(),this.decryptMessageManager.clearUnapproved(),this.messageManager.clearUnapproved(),this.dappRequestController.clearUnapproved()}};var w4=class{getCompositedState(){let e=this.getState(),t=this.partialMemStore.getFlatState(),n=this.networkController.getProviderConfig();return{...e,...t,provider:n}}getState(){let{accountHiddenTokens:e,accountTokens:t,assetImages:n,mpcToken:a,...s}=this.memStore.getFlatState();return s}getLightState(){return(0,sj.omit)(this.getState(),["permissionsLog","permissionsHistory","chainList"])}getApi(){let{approvalController:e,keyringController:t,networkController:n,onboardingController:a,permissionsController:s,preferencesController:i,txController:o,checkDomainController:c,coinController:l,coinBusiness:u,currencyController:h,httpDnsController:b,balanceController:y,authController:v,addressController:S,walletConfigController:R,dappRequestController:P,walletCreateController:N,rpcEvmTokenController:M,rpcEvmTransactionController:L,chainController:B,dexController:F,mpcController:K,dappReportController:H}=this;return{getAllWalletsBalance:q(y.getAllWalletsBalance,y),getWalletsCoinBalance:q(y.getWalletsCoinBalance,y),getCurrentWalletBalance:q(y.getCurrentWalletBalance,y),getWalletsBalance:q(y.getWalletsBalance,y),addCoinBatchToServerForPatch:q(l.addCoinBatchToServerForPatch,l),fallbackBalancesData:q(y.fallbackBalancesData,y),getRequestHeaders:q(v.getRequestHeaders,v),getSignRequestHeaders:q(v.getSignRequestHeaders,v),getState:j=>j(null,this.getState()),getLightState:q(this.getLightState,this),getStateByDomain:j=>j(null,this.getCompositedState()),setFirstTimeFlowType:this.setFirstTimeFlowType.bind(this),setCurrentLocale:this.setCurrentLocale.bind(this),markPasswordForgotten:this.markPasswordForgotten.bind(this),unMarkPasswordForgotten:this.unMarkPasswordForgotten.bind(this),getRequestAccountTabIds:j=>j(null,this.getRequestAccountTabIds()),refreshHttpDNS:j=>j(null,b.autoRefresh()),addNewWallet:q(this.addNewWallet,this),addNewWallets:q(this.addNewWallets,this),removeWallet:q(this.removeWallet,this),removeWallets:q(this.removeWallets,this),updateWalletAddress:q(this.updateWalletAddress,this),getBackupPrivateKeys:q(this.getBackupPrivateKeys,this),isPrivateWalletByWalletId:q(this.isPrivateWalletByWalletId,this),setPassword:q(t.setPassword,t),importHardwareWalletAccount:q(this.importHardwareWalletAccount,this),updateOnekeyDeviceId:q(this.updateOnekeyDeviceId,this),addHardwareWalletAccount:q(this.addHardwareWalletAccount,this),addChainForHardwareWallet:q(this.addChainForHardwareWallet,this),notifyUpdateWalletsAssets:q(this.notifyUpdateWalletsAssets,this),mpcSignTransaction:q(t.mpcSignTransaction,t),mpcSignMessage:q(t.mpcSignMessage,t),submitPassword:q(this.submitPassword,this),verifyPassword:q(this.verifyPassword,this),modifyPassword:q(t.modifyPassword,t),switchEnableRandom:q(t.switchEnableRandom,t),setProviderType:q(n.setProviderType,n),updateIsomerCurrentNetwork:q(n.updateIsomerCurrentNetwork,this),setWalletConfig:q(R.setWalletConfig,R),setScanedKeyStone:q(R.setScanedKeyStone,R),setConnectedOnekey:q(R.setConnectedOnekey,R),createWalletToServer:q(N.createWalletToServer,N),syncWalletToServer:q(N.syncWalletToServer,N),getWalletTypeCreated:q(N.getWalletTypeCreated,N),getIsWalletCreated:q(N.getIsWalletCreated,N),getCreatedWalletIds:q(N.getCreatedWalletIds,N),getAccountKeys:q(N.getAccountKeys,N),setSelectedAddress:q(i.setSelectedAddress,i),addToken:q(i.addToken,i),removeToken:q(i.removeToken,i),handleErc20Token:q(i.handleErc20Token,i),setPreference:q(i.setPreference,i),completeOnboarding:q(i.completeOnboarding,i),resetOnboarding:q(this.resetOnboarding,this),setSelectedWallet:q(this.syncAddressesAndSetSelectedWallet,this),updateKeyringIdentityName:q(i.updateKeyringIdentityName,i),updateWalletIdentityName:q(i.updateWalletIdentityName,i),updateAllKeyringIdentities:q(i.updateAllKeyringIdentities,i),getSelectedWallet:q(i.getSelectedWallet,i),getServerWalletTypeByWalletId:q(i.getServerWalletTypeByWalletId,i),getUserUniqueId:q(i.getUserUniqueId,i),setLastActiveTime:q(this.appStateController.setLastActiveTime,this.appStateController),setLocked:q(this.setLocked,this),createWalletAndRestore:q(this.createWalletAndRestore,this),importWalletWithMnemonicAndRestore:q(this.importWalletWithMnemonicAndRestore,this),importWalletWithPrivateKeyAndRestore:q(this.importWalletWithPrivateKeyAndRestore,this),importWalletWithMpcAndRestore:q(this.importWalletWithMpcAndRestore,this),createWallet:q(this.createWallet,this),importWalletWithMnemonic:q(this.importWalletWithMnemonic,this),importWalletWithPrivateKey:q(this.importWalletWithPrivateKey,this),importMpcWallet:q(this.importMpcWallet,this),checkPrivateKeyIsImported:q(t.checkPrivateKeyIsImported,t),getBackupData:q(t.getBackupData,t),backupMnemonic:q(this.backupMnemonic,this),getMnemonicByWalletId:q(t.getMnemonicByWalletId,t),getWallet:q(t.getWallet,t),getWalletIdByAddress:q(t.patchGetWalletIdByAddress,t),getPublicKey:q(t.getPublicKey,t),getPublicKeyByWalletId:q(this.getPublicKeyByWalletId,this),cancelTransaction:q(o.cancelTransaction,o),updateTransaction:q(o.updateTransaction,o),updateAndApproveTransaction:q(o.updateAndApproveTransaction,o),createLedgerTxMeta:q(o.createLedgerTxMeta,o),isNonceTaken:q(o.isNonceTaken,o),getServerEstimateGasLimit:q(o.getServerEstimateGasLimit,o),getGasSignInfo:q(o.getGasSignInfo,o),getGasLimitAndNonce:q(o.getGasLimitAndNonce,o),newUnapprovedTransaction:q(this.newUnapprovedTransaction,this),signMessageSilent:q(t.signMessageSilent,t),signMessage:q(this.signMessage,this),cancelMessage:this.cancelMessage.bind(this),signPersonalMessage:q(this.signPersonalMessage,this),cancelPersonalMessage:this.cancelPersonalMessage.bind(this),signRpcEvmTransaction:q(this.signRpcEvmTransaction,this),signTypedMessage:q(this.signTypedMessage,this),cancelTypedMessage:this.cancelTypedMessage.bind(this),decryptMessage:q(this.decryptMessage,this),decryptMessageInline:q(this.decryptMessageInline,this),cancelDecryptMessage:this.cancelDecryptMessage.bind(this),encryptionPublicKey:q(this.encryptionPublicKey,this),cancelEncryptionPublicKey:this.cancelEncryptionPublicKey.bind(this),signTransaction:q(t.signTransaction,t),signCommonMessage:q(t.signCommonMessage,t),signPsbt:q(t.signPsbt,t),splitUtxo:q(t.splitUtxo,t),getTransactionBodyForSimulate:q(t.getTransactionBodyForSimulate,t),simulateMultiTransaction:q(t.simulateMultiTransaction,t),signMultiTransaction:q(t.signMultiTransaction,t),setSeedPhraseBackedUp:q(a.setSeedPhraseBackedUp,a),approvePermissionsRequest:q(s.approvePermissionsRequest,s),clearPermissions:s.clearPermissions.bind(s),rejectPermissionsRequest:q(s.rejectPermissionsRequest,s),removePermissionsFor:s.removePermissionsFor.bind(s),addPermittedAccount:q(s.addPermittedAccount,s),removePermittedAccount:q(s.removePermittedAccount,s),removePermittedAllAccount:q(s.removePermittedAllAccount,s),getPermittedWallets:q(s.getPermittedWallets,s),resolvePendingApproval:q(e.resolve,e),rejectPendingApproval:this.rejectPendingApproval.bind(this),checkDomain:c.test.bind(c),getCustomChains:q(l.getCustomChains,l),getSupportChainByCoinSymbol:q(l.getSupportChainByCoinSymbol,l),queryCustomCoin:q(l.queryCustomCoin,l),addCustomCoin:q(l.addCustomCoin,l),addCoin:q(l.addCoin,l),removeCoin:q(l.removeCoin,l),getCustomChainWithLocalType:q(l.getCustomChainWithLocalType,l),fallbackAllCoinsMap:q(l.fallbackAllCoinsMap,l),addCrypto:q(u.addCrypto,u),removeServerCoins:q(u.removeServerCoins,u),getCoinInfoByKeyword:q(u.getCoinInfoByKeyword,u),getCustomCoinInfo:q(u.getCustomCoinInfo,u),addCustomCoins:q(u.addCustomCoin,u),setSelectedCurrencyAndUpdateBalance:q(this.setSelectedCurrencyAndUpdateBalance,this),getCurrencies:q(h.getCurrencies,h),addAddressBook:q(S.addAddressBook,S),updateAddressBook:q(S.updateAddressBook,S),removeAddressBook:q(S.removeAddressBook,S),addRecentlyAddress:q(S.addRecentlyAddress,S),approveDappRequest:q(P.approveRequest,P),getAptosSimulateTransactionTx:q(P.getAptosSimulateTransactionTx,P),cancelDappRequest:q(P.cancelRequest,P),finishRequest:q(P.finishRequest,P),dexSignAndSubmitTransaction:q(F.dexSignAndSubmitTransaction,F),dexSignTypedDataV4:q(F.dexSignTypedDataV4,F),generateFormatedTxParams:q(F.generateFormatedTxParams,F),addChainToken:q(M.addChainToken,M),updateChainToken:q(M.updateChainToken,M),updateChainTokenPrice:q(M.updateChainTokenPrice,M),updateChainTokenBalance:q(M.updateChainTokenBalance,M),rpcEvmAddTransaction:q(L.addTransaction,L),rpcEvmUpdateTransaction:q(L.updateTransaction,L),rpcEvmConfirmTransaction:q(L.confirmTransaction,L),rpcEvmFindTransaction:q(L.findTransaction,L),rpcEvmPublishTransaction:q(L.publishTransaction,L),rpcEvmClearPendingTransaction:q(L.clearPendingTransaction,L),getChainFromServer:q(B.getChainFromServer,B),fallbackLegacyChainList:q(B.fallbackLegacyChainList,B),useProvider:q(this.walletAggregateController.useProvider,this.walletAggregateController),rejectAggregate:q(this.walletAggregateController.rejectAggregate,this.walletAggregateController),clearDappData:q(this.clearDappData,this),silentOfflineSignTron:q(this.silentOfflineSignTron,this),signAndPublishTransferTransaction:q(this.publishController.signAndPublishTransferTransaction,this.publishController),signAndGetEthereumPublishParams:q(this.publishController.signAndGetEthereumPublishParams,this.publishController),openExtensionInPopupWithCache:q(this.platform.openExtensionInPopup,this.platform),focusLastOkPopupWithCache:q(this.platform.focusLastOkPopup,this.platform),setMpcAction:q(K.setMpcAction,K),getMpcToken:q(K.getToken,K),accountCheck:q(K.accountCheck,K),setIsNeedSyncMpcIndex:q(K.setIsNeedSyncMpcIndex,K),checkMpcIdIsImported:q(t.checkMpcIdIsImported,t),getMpcIdByWalletId:q(t.getMpcIdByWalletId,t),clearCookie:q(this.clearCookie,this),setApprovalRiskRemindLater:q(this.walletConfigController.setApprovalRiskRemindLater,this.walletConfigController),fetchApprovalRisk:q(this.fetchApprovalRisk,this),updateReportTimestamp:q(H.updateReportTimestamp,H),addSilencePermission:q(this.silenceController.addSilencePermission,this.silenceController),removeSilencePermission:q(this.silenceController.removeSilencePermission,this.silenceController)}}},ij=Bm(w4,[Vh,yp,xp,wp,vp,Ip,Sp,_p,Ap,Cp,Tp,Ep]);d();f();var Pp=class{newUnsignedMessage(e,t){let n=this.messageManager.addUnapprovedMessageAsync(e,t);return this.sendUpdate(),this.opts.showUserConfirmation(this.getDappEntry()),n}async newUnsignedPersonalMessage(e,t){let n=this.personalMessageManager.addUnapprovedMessageAsync(e,t);return this.sendUpdate(),this.opts.showUserConfirmation(this.getDappEntry()),n}async newRequestDecryptMessage(e,t){let n=this.decryptMessageManager.addUnapprovedMessageAsync(e,t);return this.sendUpdate(),this.opts.showUserConfirmation(this.getDappEntry()),n}async newRequestEncryptionPublicKey(e,t){let n=e,a=await this.keyringController.getKeyringForAccount(n);if(md(a.type))return new Promise((i,o)=>{o(new Error(`${a.type} does not support eth_getEncryptionPublicKey.`))});let s=this.encryptionPublicKeyManager.addUnapprovedMessageAsync(e,t);return this.sendUpdate(),this.opts.showUserConfirmation(this.getDappEntry()),s}newUnsignedTypedMessage(e,t,n){let a=this.typedMessageManager.addUnapprovedMessageAsync(e,t,n);return this.sendUpdate(),this.opts.showUserConfirmation(this.getDappEntry()),a}};var v4=class extends Ir{constructor(e){super(),this.initializeData(e),this.runTasksPreSetup(),this.initializeControllers(),this.initializeStores(),this.runTasksPostSetup()}},oj=Bm(v4,[jh,ij,Pp]);d();f();var cj=_(c3()),dj=_(K_()),S4=class extends cj.Writable{constructor(e,t){let n={objectMode:!0,...t};super(n),this._asyncWriteFn=e}_write(e,t,n){(0,dj.default)(this._asyncWriteFn(e,t))(n)}};function _4(r,e){return new S4(r,e)}d();f();var A4=_(yn());var _ue=async()=>A4.default.i18n?await A4.default.i18n.getAcceptLanguages():[],Mp={};aT.forEach(r=>{r&&r.code&&(Mp[r.code.toLowerCase().replace("_","-")]=r.code)});async function C4(){let r;try{r=await _ue()}catch{r=[]}r||(r=[]);let e=/^zh(-(Hans|CN|SG))?$/iu,t=r.map(n=>{let a=n.toLowerCase().replace("_","-");return e.test(a)&&(a="zh-cn"),a}).find(n=>Mp[n]!==void 0||Mp[n.split("-")[0]]!==void 0);return t!==void 0&&Mp[t]===void 0&&(t=t.split("-")[0]),Mp[t]||"en"}d();f();ae();async function T4(){return yo()}Cn();d();f();Be();var Np=class extends Ir{constructor(e={}){super();let t=e.migrations||[];this.migrations=t.sort((a,s)=>a.version-s.version);let n=this.migrations.slice(-1)[0];this.defaultVersion=e.defaultVersion||n&&n.version||0}async migrateData(e=this.generateInitialState()){function t(a){return a.version>e.meta.version}let n=this.migrations.filter(t);for(let a of n)try{let s=await a.migrate(e);if(!s.data)throw new Error("Migrator - migration returned empty data");if(s.version!==void 0&&s.meta.version!==a.version)throw new Error("Migrator - Migration did not update version number correctly");e=s}catch(s){let i=s.message;return s.message=`OKX Migration Error #${a.version}: ${i}`,this.emit("error",s),e}return e}generateInitialState(e={}){return{meta:{version:this.defaultVersion},data:e}}};d();f();var Aue=720,I4=360,Rp=class{constructor(){this.platform=new Js}async showPopup(e=""){let t=await this.getPopup(this.popupId);if(t)try{typeof e=="string"&&e!==""?(await this.platform.closeWindow(this.popupId),this.popupId=await this.createPopup(e)):await this.focusWindow(t)}catch{this.popupId=await this.createPopup(e)}else this.popupId=await this.createPopup(e)}async showShunt(e=""){let t=await this.getPopup(this.shuntId);if(t)try{await this.focusWindow(t)}catch{this.shuntId=await this.createPopup(e)}else this.shuntId=await this.createPopup(e)}async focusWindow(e){let{left:t,top:n}=await this.getPosition();await this.platform.updateWindowPosition(e.id,t,n),await this.platform.focusWindow(e.id)}async createPopup(e=""){let{left:t,top:n}=await this.getPosition();e&&(e=`#${e}`);let a=await this.platform.openWindow({url:`notification.html${e}`,type:"popup",width:I4,height:Aue,left:t,top:n});return a.left!==t&&a.state!=="fullscreen"&&await this.platform.updateWindowPosition(a.id,t,n),a.id}async getPosition(){let e=0,t=0;try{let n=await this.platform.getLastFocusedWindow();t=n.top,e=n.left+(n.width-I4)}catch{let{screenX:a,screenY:s,outerWidth:i}=window;t=Math.max(s,0),e=Math.max(a+(i-I4),0)}return{left:e,top:t}}async getPopup(e){let t=await this.platform.getAllWindows();return this.getPopupIn(t,e)}getPopupIn(e,t){return e?e.find(n=>n&&n.type==="popup"&&n.id===t):null}};d();f();d();f();var lj=_(te());ae();ne();var fj=60;function Cue(r){return r.CurrencyController&&(r.CurrencyController.conversionDate&&delete r.CurrencyController.conversionDate,r.CurrencyController.conversionRate&&delete r.CurrencyController.conversionRate,r.CurrencyController.currentCurrency&&delete r.CurrencyController.currentCurrency,r.CurrencyController.nativeCurrency&&delete r.CurrencyController.nativeCurrency,r.CurrencyController.usdConversionRate&&delete r.CurrencyController.usdConversionRate),r}function Tue(r){let e=a=>yo().some(({realChainIdHex:s})=>s===a.chainId),t=$p({realChainIdHex:r_}),n={chainId:t.chainId,nickname:"",rpcPrefs:{},rpcUrl:t.rpcUrl,ticker:t.ticker,type:t.providerType};return r.NetworkController&&(r.NetworkController.provider&&(e(r.NetworkController.provider)||(r.NetworkController.provider=n,r.NetworkController.network=t_)),r.NetworkController.previousProviderStore&&(e(r.NetworkController.previousProviderStore)||(r.NetworkController.previousProviderStore=n))),r}function Iue(r){return r.TransactionController&&r.TransactionController.transactions&&Object.keys(r.TransactionController.transactions).forEach(e=>{r.TransactionController.transactions[e].status===Oe.UNAPPROVED&&delete r.TransactionController.transactions[e]}),r}function Eue(r){return typeof r=="object"&&typeof r.CoinController!="object"&&(r.CoinController={}),typeof r=="object"&&typeof r.CoinController=="object"&&(r.CoinController.isSynced=!1),r}function Pue(r){let e=Cue(r),t=Tue(e),n=Iue(t);return Eue(n)}var uj={version:fj,async migrate(r){let e=(0,lj.cloneDeep)(r);e.meta.version=fj;let t=e.data,n=Pue(t);return e.data=n,e}};d();f();var mj=_(te()),gj=_(yn());d();f();var hj=_(h_()),ux=_(p_()),Ji={zh:ux.default,zh_CN:ux.default,"zh-CN":ux.default,en:hj.default};var pj=61;function Mue(r){let e=n=>n.indexOf("null")===0,t=(n,a)=>{let s=Ji[a];return n===ue.MNEMONIC?s.walletDefaultName:n===ue.PRIVATE_KEY?s.privateKeyDefaultName:n===ue.HARDWARE?s.hardWalletDefaultName:s.walletDefaultName};if(r.PreferencesController&&r.PreferencesController.keyringIdentities){let n=r.PreferencesController.currentLocale||"en",{keyringIdentities:a}=r.PreferencesController,s=Ji[n];a.forEach(i=>{i.keyringIdentityType===ue.MNEMONIC&&e(i.keyringName)?i.keyringName=i.keyringName.replace("null",t(i.keyringIdentityType,n)):i.keyringName||(i.keyringName=t(i.keyringIdentityType,n)),i.walletIdentities.forEach(o=>{e(o.walletName)&&(o.walletName=o.walletName.replace("null",s.accountDefaultName))})})}return r}function Nue(r){return Mue(r)}var bj={version:pj,async migrate(r){let e=(0,mj.cloneDeep)(r);e.meta.version=pj;let t=e.data,n=Nue(t);e.data=n;let{local:a}=gj.default.storage;return a.set({en:{},zh_CN:{}}),e}};d();f();var xj=_(te()),yj=62,wj={version:yj,async migrate(r){let e=(0,xj.cloneDeep)(r);return e.meta.version=yj,e.en={},e.zh_CN={},e}};d();f();var Sj=_(te());ae();var vj=63;function Rue(r){if(r.PreferencesController&&r.WalletCreateController&&r.PreferencesController.keyringIdentities&&r.WalletCreateController.createdMap){let e=r.PreferencesController.keyringIdentities,t=r.WalletCreateController.createdMap;Object.entries(t).forEach(([n,a])=>{let s=a.reduce((i,o)=>{let c=me({coinId:o.coinId});return c?.chain&&(i[c.chain]=o.address),i},{});e.forEach(i=>{let o=i.walletIdentities.find(c=>c.walletId===n);o&&(o.account=s)})})}return r}function kue(r){return Rue(r)}var _j={version:vj,async migrate(r){let e=(0,Sj.cloneDeep)(r);e.meta.version=vj;let t=e.data,n=kue(t);return e.data=n,e}};d();f();var Cj=_(te());var Aj=64;function Oue(r){let e=!r?.PatchController01?.needSyncDevIdMap||en(r?.PatchController01?.needSyncDevIdMap),t=Ar(r?.WalletCreateController?.createdMap)&&!en(r?.WalletCreateController?.createdMap);return e&&t&&(r.PatchController01={},r.PatchController01.needSyncDevIdMap={},Object.keys(r.WalletCreateController.createdMap).forEach(n=>{r.PatchController01.needSyncDevIdMap[n]=!0})),r}function Due(r){return Oue(r)}var Tj={version:Aj,async migrate(r){let e=(0,Cj.cloneDeep)(r);e.meta.version=Aj;let t=e.data,n=Due(t);return e.data=n,e}};d();f();var Ej=_(te()),Ij=65;function Lue(r){if(r.WalletCreateController){let e=r.WalletCreateController?.createdMap||{};r.WalletCreateController={createdMap:e}}return r}function Bue(r){return r.PatchController01||(r.PatchController01={}),r.PatchController01&&(r.PatchController01.needSyncAccounts=!0),r}function Wue(r){let e=Lue(r);return Bue(e)}var Pj={version:Ij,async migrate(r){let e=(0,Ej.cloneDeep)(r);e.meta.version=Ij;let t=e.data,n=Wue(t);return e.data=n,e}};d();f();var Nj=_(te());var Mj=66,Kue=(r,e)=>{let t;return e===ue.PRIVATE_KEY&&(t=r.privateKeyDefaultName),t};function que(r){let e=r?.PreferencesController?.keyringIdentities;if(e&&Array.isArray(e)){let t=r.PreferencesController.currentLocale||"en";e.forEach(n=>{let a=Ji[t];if(a){let s=Kue(a,n.keyringIdentityType);s&&!n.keyringName&&(n.keyringName=s)}})}}function Uue(r){r?.PermissionsController?.domains&&(r.PermissionsController.domains={}),r?.PermissionsController?.permissionsDescriptions&&(r.PermissionsController.permissionsDescriptions={}),r?.PermissionsController?.permissionsRequests&&(r.PermissionsController.permissionsRequests=[]),que(r)}var Rj={version:Mj,async migrate(r){let e=(0,Nj.cloneDeep)(r);e.meta.version=Mj;let t=e.data;return Uue(t),e}};d();f();var Oj=_(te());ae();var kj=67,Dj={version:kj,async migrate(r){let e=(0,Oj.cloneDeep)(r);e.meta.version=kj;let t=e.data;return t?.KeyringController&&(t.KeyringController.excludeChainCache=[ke,Gp]),e}};d();f();var Bj=_(te()),Lj=68;function Fue(r){let e=r;return e?.addressController&&(e.addressController.recentlyAddresses={}),e}var Wj={version:Lj,async migrate(r){let e=(0,Bj.cloneDeep)(r);e.meta.version=Lj;let t=e.data,n=Fue(t);return e.data=n,e}};d();f();var wc=_(te()),Kj=69;function Hue(r){let e=r;return e?.coinBusiness&&(e?.coinBusiness?.defaultShowCoinList&&(0,wc.remove)(e.coinBusiness.defaultShowCoinList,t=>!t.coinId),e?.coinBusiness?.balanceCoinList&&(0,wc.remove)(e.coinBusiness.balanceCoinList,t=>!t.coinId),e?.coinBusiness?.balanceCoin&&(0,wc.remove)(e.coinBusiness.balanceCoin,t=>!t.coinId)),e?.coinController&&e?.coinController?.addedCoins&&(0,wc.remove)(e.coinController.addedCoins,t=>!t.coinId),e}var qj={version:Kj,async migrate(r){let e=(0,wc.cloneDeep)(r);e.meta.version=Kj;let t=e.data,n=Hue(t);return e.data=n,e}};d();f();var Fj=_(te());Ge();var Uj=70;function Gue(r){let e=r;return e?.addressController&&e?.addressController?.addressBookList&&(e.addressController.addressBookList=(e.addressController.addressBookList||[]).map(t=>({id:Me(),...t||{}}))),e}var Hj={version:Uj,async migrate(r){let e=(0,Fj.cloneDeep)(r);e.meta.version=Uj;let t=e.data,n=Gue(t);return e.data=n,e}};d();f();var zj=_(te()),Gj=71;function zue(r){let e=r;return e?.rpcController?.customNets?.length&&(e.rpcController.customNets=e.rpcController.customNets.map(t=>({...t,type:Z0.EVM}))),e}var jj={version:Gj,async migrate(r){let e=(0,zj.cloneDeep)(r);e.meta.version=Gj;let t=e.data,n=zue(t);return e.data=n,e}};d();f();var $j=_(te()),Vj=72;function jue(r){let e=r;return e?.NetworkController&&!e?.NetworkController?.provider?.chainId&&(e.NetworkController.provider=null),e}var Yj={version:Vj,async migrate(r){let e=(0,$j.cloneDeep)(r);e.meta.version=Vj;let t=e.data,n=jue(t);return e.data=n,e}};d();f();var Xj=_(te());ae();var Jj=73,Zj={version:Jj,async migrate(r){let e=(0,Xj.cloneDeep)(r);e.meta.version=Jj;let t=e.data;return t?.KeyringController&&(t.KeyringController.excludeChainCache=[ke]),e}};d();f();var kp=_(te());Ge();var Qj=74,Vue=r=>li(r)?r.find(({keyringIdentityType:e})=>e===ue.HARDWARE):null,eV=(r,e)=>li(r)?r.filter(({initialType:t})=>t===e).map((t,n)=>{let{walletName:a}=t,[s]=a.split(" "),i=`${s} ${(0,kp.padStart)(n+1,2,"0")}`;return{...t,walletName:i}}):[],$ue=r=>(e,t)=>{if(e.length){let n=(0,kp.cloneDeep)(r);return n.keyringName=`${t} 01`,n.hardwareWalletType=t,n.hardwareWalletModel=t,n.keyringId=Me(),n.walletIdentities=e,n}return null};function Yue(r){if(r.PreferencesController&&r.PreferencesController.keyringIdentities){let e=r.PreferencesController.keyringIdentities,t=Vue(e);if(t){let{walletIdentities:n,...a}=t,s=eV(n,$.LEDGER_BRIDGE_KEYRING),i=eV(n,$.TREZOR_KEYRING);if(s.length&&i.length){let o=e.filter(({keyringIdentityType:h})=>h!==ue.HARDWARE),c=$ue(a,o),l=c(s,$.LEDGER_BRIDGE_KEYRING);l&&o.push(l);let u=c(i,$.TREZOR_KEYRING);u&&o.push(u),r.PreferencesController.keyringIdentities=o}else s.length?(t.hardwareWalletType=$.LEDGER_BRIDGE_KEYRING,t.hardwareWalletModel=$.LEDGER_BRIDGE_KEYRING,t.keyringName=`${$.LEDGER_BRIDGE_KEYRING} 01`):i.length&&(t.hardwareWalletType=$.TREZOR_KEYRING,t.hardwareWalletModel=$.TREZOR_KEYRING,t.keyringName=`${$.TREZOR_KEYRING} 01`)}}return r}var tV={version:Qj,async migrate(r){let e=(0,kp.cloneDeep)(r);e.meta.version=Qj;let t=e.data,n=Yue(t);return e.data=n,e}};d();f();var nV=_(te());ae();var rV=75,aV={version:rV,async migrate(r){let e=(0,nV.cloneDeep)(r);e.meta.version=rV;let t=e.data;return t?.KeyringController&&(t.KeyringController.excludeChainCache=[ke]),e}};d();f();var iV=_(te()),sV=76;var oV={version:sV,async migrate(r){let e=(0,iV.cloneDeep)(r);e.meta.version=sV;let t=e.data,n=t;return e.data=n,e}};d();f();var dV=_(te());var cV=77;function Jue(r){let e=r?.rpcController?.defaultNets,t=r?.rpcController?.customNets,n=r?.rpcController?.rpcInfo;return Array.isArray(e)&&e.length&&e.forEach(a=>{a.uniqueId=a.uniqueId||om(a.rpcUrl)}),Array.isArray(t)&&t.length&&t.forEach(a=>{a.uniqueId=a.uniqueId||om(a.rpcUrl)}),n&&n.rpcUrl&&(n.uniqueId=n.uniqueId||om(n.rpcUrl)),r}var fV={version:cV,async migrate(r){let e=(0,dV.cloneDeep)(r);e.meta.version=cV;let t=e.data,n=Jue(t);return e.data=n,e}};d();f();var E4=_(te()),lV=78;async function Xue(r){let e=r?.PermissionsMetadata?.permissionsLog??[];return await cm(e),r?.PermissionsMetadata?.permissionsLog&&delete r.PermissionsMetadata.permissionsLog,r?.CoinController?.allServerCoins&&delete r.CoinController.allServerCoins,r?.CoinBusiness&&delete r.CoinBusiness,r}function Zue(r){if(r?.PreferencesController){let{keyringIdentities:e}=r.PreferencesController;(0,E4.isArray)(e)&&(r.PreferencesController.keyringIdentities=e.map(t=>{let n=t?.walletIdentities;return(0,E4.isArray)(n)&&(t.walletIdentities=n.map(a=>{let{accountType:s={},...i}=a;return To({...i,accountsMap:s})})),t}))}return r}var uV={version:lV,async migrate(r){r.meta.version=lV;let e=r.data,t=Zue(e),n=await Xue(t);return r.data=n,r}};d();f();ne();var hV=79;function P4(r){return r?.DappRequestController&&typeof r?.DappRequestController?.requests=="object"&&Object.values(r?.DappRequestController?.requests).forEach(e=>{e?.localType===_r&&(e.localType=bo)}),r}var pV={version:hV,async migrate(r){r.meta.version=hV;let e=r.data,t=P4(e);return r.data=t,r}};d();f();function Que(r){let e=["serverDefaultCoins","aggregationCoinMapForUI","allDefaultCoins","baseCoins"];if(r?.CoinController){for(let t of e)r.CoinController[t]&&delete r.CoinController[t];r.CoinController.shouldPatchCustomCoin=!1}return r?.ChainController&&delete r.ChainController.privateDefaultCoinIds,r}var mV={version:80,async migrate(r){r.meta.version=80;let e=r.data,t=Que(e);return r.data=t,r}};d();f();ne();var gV=81;function ehe(r){if(r?.DappRequestController&&typeof r?.DappRequestController?.requests=="object"){let e=Object.entries(r?.DappRequestController?.requests).reduce((t,[n,a])=>(a?.localType===kc&&a?.status===qe.UNAPPROVED||(t[n]=a),t),{});r.DappRequestController.requests=e}return r}function the(r){return typeof r=="object"&&typeof r.CoinController!="object"&&(r.CoinController={}),typeof r=="object"&&typeof r.CoinController=="object"&&(r.CoinController.isPatched=r.CoinController.shouldPatchCustomCoin===!1),r}var bV={version:gV,async migrate(r){r.meta.version=gV;let e=r.data,t=P4(e),n=ehe(t),a=the(n);return r.data=a,r}};d();f();ae();var yV=82,xV={version:yV,async migrate(r){r.meta.version=yV;let e=r.data;return e?.KeyringController&&(e.KeyringController.excludeChainCache=[jp]),r}};d();f();var wV={version:83,migrate(r){r.meta.version=83;let t=r.data?.WalletCreateController?.createdMap;return t&&typeof t=="object"&&Object.keys(t).includes("undefined")&&delete t.undefined,r}};d();f();var dl=_(te());Ge();var vV=84,rhe=r=>li(r)?r.find(({keyringIdentityType:e})=>e===ue.MPC):null,nhe=(r,e)=>li(r)?r.map((t,n)=>{let s=`${e?.accountDefaultName} ${(0,dl.padStart)(n+1,2,"0")}`;return{...t,walletName:s}}):[],ahe=(r,e)=>(t,n)=>{if(t?.length){let a=(0,dl.cloneDeep)(r),{mpcId:s,status:i,userInfo:o}=t[0];return a.keyringId=Me(),a.mpcId=s,a.status=i||{mpcStatus:Fl.INIT,accountStatus:Ul.NORMAL},a.userInfo=o,a.keyringName=o?.walletName||`${e.mpcDefaultName} ${(0,dl.padStart)(n+1,2,"0")}`,a.walletIdentities=t,a}return null};function she(r){try{if(r?.PreferencesController&&r.PreferencesController?.keyringIdentities){let e=r.PreferencesController?.keyringIdentities,t=r.PreferencesController.currentLocale||"en",n=rhe(e);if(n){let{walletIdentities:a,...s}=n,i={};if(a.forEach(o=>{let{mpcId:c}=o;i[c]||(i[c]=[]),i[c].push(o)}),Object.keys(i).length){let o=e.filter(({keyringIdentityType:u})=>u!==ue.MPC),c=Ji[t]||Ji.en,l=ahe(s,c);Object.values(i).forEach((u,h)=>{let b=l(nhe(u,c),h);b&&o.push(b)}),r.PreferencesController.keyringIdentities=o}}}return r}catch{return r}}var SV={version:vV,async migrate(r){let e=(0,dl.cloneDeep)(r);e.meta.version=vV;let t=e.data,n=she(t);return e.data=n,e}};d();f();var _V={version:85,migrate(r){r.meta.version=85;let e=r.data;return e?.ChainController&&delete e.ChainController,r}};d();f();var CV=_(te()),AV=86,M4=(r,e)=>{r&&Object.keys(r).forEach(t=>{e.includes(t)||delete r[t]})},ihe=r=>{try{if(r?.PreferencesController&&r.PreferencesController?.keyringIdentities){let e=[],t=r.PreferencesController?.keyringIdentities;if(t?.length&&(t.forEach(n=>{n?.walletIdentities&&(n?.walletIdentities||[]).forEach(a=>{a?.walletId&&e.push(a.walletId)})}),r?.WalletCreateController)){let{createdMap:n,needSyncMap:a,walletTypeMap:s}=r.WalletCreateController;n&&M4(n,e),a&&M4(a,e),s&&M4(s,e)}}return r}catch{return r}},TV={version:AV,migrate(r){let e=(0,CV.cloneDeep)(r);e.meta.version=AV;let t=e.data,n=ihe(t),a=n?.RpcEvmTransactionController?.rpcEvmTransactions;if(a)for(let s in a)typeof a[s]?.txParams>"u"&&delete a[s];return e.data=n,e}};d();f();ne();var IV=87,EV={version:IV,async migrate(r){r.meta.version=IV;let e=r.data;return e?.KeyringController&&(e.KeyringController.excludeChainCache=[Gr]),r}};d();f();Cn();var PV=88,MV={version:PV,async migrate(r){r.meta.version=PV;let e=r.data;return e?.AuthController?.authMap&&(await xe.set({authMap:e.AuthController.authMap}),delete e.AuthController),r}};d();f();var NV={version:89,async migrate(r){r.meta.version=89;let e=r.data;return e?.PreferencesController?.currentLocale==="th"&&(e.PreferencesController.currentLocale="en"),r}};d();f();var RV=90,kV={version:RV,async migrate(r){r.meta.version=RV;try{await cg()}catch{console.log("clearFailed")}return r}};d();f();var OV={version:91,async migrate(r){r.meta.version=91;let e=r.data;try{e?.BlinkController&&delete e.BlinkController}catch{console.log("clearFailed")}return r}};d();f();var DV=92,LV={version:DV,async migrate(r){r.meta.version=DV;let e=r.data;try{if(e?.NetworkController){let t=e.NetworkController.provider;await $0({providerType:wn,...t}),delete e.NetworkController}}catch{console.log("fail")}return r}};d();f();var BV=93,WV={version:BV,async migrate(r){r.meta.version=BV;let e=r.data;try{if(e?.MenuController&&delete e.MenuController,e?.rpcController){let t=e.rpcController?.rpcInfo||{},n=(e.rpcController?.customNets||[]).map(s=>({...s,isCustom:!0})),a=(e.rpcController?.defaultNets||[]).map((s,i)=>({...s,order:i}));await Q0([...a,...n]),await Bi({...t,extensionKey:"rpc_info"}),delete e.rpcController}}catch{console.log("fail")}return r}};var ohe=[uj,bj,wj,_j,Tj,Pj,Rj,Dj,Wj,qj,Hj,jj,Yj,Zj,tV,aV,oV,fV,uV,pV,mV,bV,xV,wV,SV,_V,TV,EV,MV,NV,kV,OV,LV,WV],KV=ohe;var GV=new Js,che=new Rp;globalThis.METAMASK_NOTIFIER=che;globalThis.platform=GV;var dhe={},Oa;qV.default.config({EXPONENTIAL_AT:[-40,40]});async function fhe(){return!0}async function lhe(){return!0}async function uhe(){let r=new Np({migrations:KV});if(Oa=await xe.get(["data","meta"])||r.generateInitialState(),Oa&&!Oa.data&&(Oa=r.generateInitialState()),Oa=await r.migrateData(Oa),!Oa)throw new Error("OKX Wallet - migrator returned undefined");return xe.isSupported?xe.set(Oa):setTimeout(()=>{throw new Error("OKX Wallet - Localstore not supported")}),Oa.data}async function hhe(){let[r,e]=await Promise.all([K5(),Ad(wn)]);return r?.length&&Vp(r),{provider:e}}async function phe(){let{devid:r}=await xe.get("devid"),e=r;return e||(e=__(),xe.set({devid:e})),e}function mhe(r,e,t,n={}){let a=new oj({showUserConfirmation:fhe,openPopup:lhe,initState:r,initLangCode:e,initRemoteConfig:t,platform:GV,extension:HV.default,getRequestAccountTabIds:()=>dhe,...n});function s(c){return Oa.data=c,Oa}let i=!1;async function o(c){if(!c)throw new Error("OKX Wallet - updated state is missing");if(!c.data)throw new Error("OKX Wallet - updated state does not have data");if(xe.isSupported)try{await xe.set(c),i&&(i=!1)}catch{i||(i=!0)}}return(0,FV.default)((0,hx.storeAsStream)(a.store),(0,UV.default)(1e3),(0,hx.storeTransformStream)(s),_4(o),()=>{}),a}async function zV(){let r=await uhe(),e=await hhe(),t=await C4();await phe();let n=await T4(),{authMap:a={}}=await xe.get("authMap");return mhe(r,t,n,{authMap:a,initIDBData:e})}Ge();d();f();var ghe=["popup.html","notification.html","home.html"];navigator.userAgent.includes("Android")&&ghe.forEach(r=>{location.href.includes(r)&&(location.href=location.href.replace(r,"fullscreen.html"))});function bhe(r){return new Proxy(r,{get:(e,t)=>e[t]?e[t]:(...n)=>{let a=n[n.length-1];typeof a!="function"&&(a=()=>{});let s=n.slice(0,-1);if(!r[t]){a((0,Op.serializeError)(Op.ethErrors.rpc.methodNotFound({message:`${t} not found`}),{shouldIncludeStack:!0}));return}r[t](...s,(i,o)=>{a(i?(0,Op.serializeError)(i,{shouldIncludeStack:!0}):o)})}})}function yhe(r,e,t,n){let a=t.getApi(),s=bhe(a);Fw({activeTab:r,container:e,backgroundConnection:s,controller:t},n)}async function xhe(){return{}}async function whe(r,e){let t=await xhe(r);r0()===v_&&(t.origin="https://www.okx.com");let n=document.getElementById("app");yhe(t,n,e,a=>{if(a)throw a})}async function vhe(){let r=hs(),e=await zV();whe(r,e)}vhe().catch(jV.default.error);

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "prepub";

//# sourceMappingURL=ui.js.map
