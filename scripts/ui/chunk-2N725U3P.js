import{a as J}from"./chunk-SCZBCO2U.js";import{a as X}from"./chunk-5DVBM2WJ.js";import{a as B}from"./chunk-QVA4WXOQ.js";import{b as j}from"./chunk-NHGZUGLZ.js";import{a as P,b as w}from"./chunk-VTOQBCNE.js";import{c as V,d as z,e as Z}from"./chunk-7PVSIZ6H.js";import{b as G}from"./chunk-DY2YURLY.js";import{a as d}from"./chunk-6FOZGMAL.js";import{Mb as q,r as U,y as ce}from"./chunk-HPXM6RSK.js";import{a as Y}from"./chunk-RIMU4JTV.js";import{Cb as C,Kb as b,ib as R,kb as g,lb as E,m as ae,mb as H,nb as F,ob as M,pb as W,qb as $}from"./chunk-X7YMANPZ.js";import{I as oe,n as O}from"./chunk-RPZQDAIQ.js";import{a as A}from"./chunk-6DDC4Y2S.js";import{f as y,m as f,o as p}from"./chunk-EQYVU4XP.js";f();p();var re=y(A());b();f();p();b();var K=async(e={})=>e?.baseFeePerGas!==void 0,N=e=>parseInt(e,16);function ue({baseFeePerGas:e,number:r}){return{number:r,baseFeePerGas:e,gasUsedRatio:null,priorityFeesByPercentile:null}}function me({baseFeePerGas:e,number:r,blockIndex:i,gasUsedRatios:t,priorityFeePercentileGroups:n,percentiles:s}){let o=t[i],a=n[i],u=s.reduce((c,m,l)=>{let T=a[l];return{...c,[m]:N(T)}},{});return{number:r,baseFeePerGas:e,gasUsedRatio:o,priorityFeesByPercentile:u}}async function Q({web3:e,numberOfBlocks:r,endBlockNumber:i,percentiles:t,includeNextBlock:n}){let s=await e.eth.getFeeHistory(r,i,t),o=N(s.oldestBlock);if(s.baseFeePerGas!==void 0&&s.baseFeePerGas.length>0&&s.gasUsedRatio.length>0&&(s.reward===void 0||s.reward.length>0)){let a=n?s.baseFeePerGas:s.baseFeePerGas.slice(0,r),u=s.gasUsedRatio,c=s.reward??[],m=u.length;return a.map((l,T)=>{let v=N(l),D=g(o,T);return T>=m?ue({baseFeePerGas:v,number:D}):me({baseFeePerGas:v,number:D,blockIndex:T,gasUsedRatios:u,priorityFeePercentileGroups:c,percentiles:t})})}return[]}var S=1024;function le(e,r){F(e,r)&&(r=e);let i=[];for(let t=E(e,r);F(t,e);t=g(t,S)){let n=E(e,t),s=n<S?n:S,o=g(t,s);i.push({numberOfBlocks:s,endBlockNumber:o})}return i}var ee=async({web3:e,numberOfBlocks:r,endBlock:i="latest",percentiles:t=[],includeNextBlock:n=!1})=>{let s=t.length>0?Array.from(new Set(t)).sort((c,m)=>c-m):[],a=le(i,r);return(await Promise.all(a.map(({numberOfBlocks:c,endBlockNumber:m},l)=>l===a.length-1?Q({web3:e,numberOfBlocks:c,endBlockNumber:m,percentiles:s,includeNextBlock:n}):Q({web3:e,numberOfBlocks:c,endBlockNumber:m,percentiles:s,includeNextBlock:!1})))).reduce((c,m)=>[...c,...m],[])};var fe=e=>e?G(e):{},pe=["0x144","0x2105"],de=e=>(0,re.useCallback)(async()=>e?(await fe(e)).eth.getBlock("latest"):{},[e]),Ae=e=>d(async({to:r,from:i,value:t,data:n=""},s)=>{let o=!s,a="";return n?Z(n)?a=U(n):a=z(n):o||(a=X(r,t||0)),await(await G(e)).eth.estimateGas({from:i,to:o?r:s,value:o?t:null,data:a||null})},[e]),L=["low","medium","high"],te={low:{percentile:10,base:1.1,priority:.94,minSuggestedMaxPriorityFeePerGas:1e9,estimatedWaitTimes:{minWaitTimeEstimate:15e3,maxWaitTimeEstimate:3e4}},medium:{percentile:20,base:1.2,priority:.97,minSuggestedMaxPriorityFeePerGas:15e8,estimatedWaitTimes:{minWaitTimeEstimate:15e3,maxWaitTimeEstimate:45e3}},high:{percentile:30,base:1.25,priority:.98,minSuggestedMaxPriorityFeePerGas:2e9,estimatedWaitTimes:{minWaitTimeEstimate:15e3,maxWaitTimeEstimate:6e4}}};function Pe(e){let r=e.slice().sort((n,s)=>F(E(n,s),0)?-1:1),i=r.length,t=Math.floor((i-1)/2);return r[t]}var he=(e,r,i)=>{let t=i[e],n=r[r.length-1].baseFeePerGas,s=R(n,t.base),o=r.map(l=>"priorityFeesByPercentile"in l?l?.priorityFeesByPercentile?.[t.percentile]:null).filter(Boolean),a=Pe(o),u=R(a,t.priority),c=H([u,t.minSuggestedMaxPriorityFeePerGas]),m=g(s,c);return{baseFeePerGas:C(s,0),maxFeePerGas:C(m,0),maxPriorityFeePerGas:C(c,0)}},xe=(e,r)=>L.reduce((i,t)=>{let n=he(t,e,r),{maxFeePerGas:s}=n;return[...i,{level:t,isSupportEip1559:!0,gasPrice:s,...n}]},[]),ge=(e,r)=>d(async i=>{let t=await G(e),n=await ee({web3:t,endBlock:i.number,numberOfBlocks:21,percentiles:[10,20,30]});return xe(n,r)},[e]),Te={low:{coefficient:1.1,level:"low"},medium:{coefficient:1.35,level:"medium"},high:{coefficient:1.7,level:"high"}},Ee=(e,r)=>d(async()=>{let t=await(await G(e)).eth.getGasPrice();return L.reduce((n,s)=>{let{level:o,coefficient:a}=r[s];return[...n,{level:o,gasPrice:R(t,a)}]},[])},[e]);function Fe(e){let{rpcNetworks:r}=J(),i=r.find(t=>t?.rpcUrl===e);return L.reduce((t,n)=>{let s=i?.gasNormal?.[n]||Te[n]?.coefficient,o=i?.gas1559?.[n]||te?.[n];return{evmNormalGasPrice:{...t.evmNormalGasPrice,[n]:{level:n,coefficient:s}},evm1559GasPrice:{...t.evm1559GasPrice,[n]:{...te[n],base:o?.base,priority:o?.priority}}}},{})}var Oe=e=>{let r=Fe(e),i=de(e),t=Ee(e,r?.evmNormalGasPrice),n=ge(e,r?.evm1559GasPrice);return d(async s=>{if(e){let o=await i(),a=!pe.includes(s)&&await K(o),u,c=a?n:t;try{u=await c(o)}catch{u=await t(o)}return u}return[]},[e])};f();p();var $e={singleTx:"singleTx",batchTransfer:"batchTransfer"};f();p();var x=y(A()),_=y(ce());var h=y(ae());oe();b();function Ge(){return(0,_.useSelector)(q,_.shallowEqual)}function I(e){let r=Ge(),i=j(),{extensionConfig:t}=B("rpc_info");return(0,x.useMemo)(()=>Object.values(r).filter(n=>{if(!n.txParams)return!1;let{from:s,chainId:o}=n.txParams;return i===s&&o===t.chainId&&e(n)}),[r,i,t.chainId])}function nt(){return I(e=>e.status===P.FAILED||e.status===P.SUCCEED)}function ne(e){let[r,i]=e,t=+r,n=+O.add(1,"d",new Date(i));return s=>$(s,t)&&M(s,n)}function se(e={}){let{dates:r}=e,i=I(t=>t.status===P.FAILED||t.status===P.SUCCEED||t.status===P.DROPPED);return(0,x.useMemo)(()=>{let t=i;if(r){let n=ne(r);t=t.filter(({finishTime:s})=>n(s))}return t.sort((n,s)=>s.finishTime-n.finishTime).map(n=>({...n,isShowPending:!1}))},[i,r])}function ie(e={}){let r=I(t=>t.status===P.PENDING),{dates:i}=e;return(0,x.useMemo)(()=>{let t=(0,h.sortBy)(r,[n=>V(n.txParams.nonce)]).map((n,s)=>({...n,isShowPending:s===0}));if(i){let n=ne(i);t=t.filter(({sendTime:s})=>n(s))}return t},[r,i])}function we(){let e=ie(),r=se();return(0,x.useMemo)(()=>[...e,...r],[e,r])}function st(e){let r=we();return(0,x.useMemo)(()=>e?r.find(({id:i})=>e===i):null,[e,r])}function it({tokenAddress:e}){let r=ie(),i=se();return(0,x.useMemo)(()=>[...r,...i].filter(({type:t,txParams:n,extraParams:s})=>{if(t===w.TRANS_OUT)return!e&&!s?.tokenAddress||(0,h.toLower)(e)===(0,h.toLower)(s?.tokenAddress);if(t===w.AUTHORIZATION||t===w.CANCEL_AUTHORIZATION)return(0,h.toLower)(e)===(0,h.toLower)(s?.tokenAddress);if(t===w.CONTRACT_CALL){let{value:o}=n||{};return!e&&W(Y(o),0)}return!1}),[r,i,e])}var ye=(e,r,i)=>{let{protocol:t,host:n,pathname:s,search:o,hash:a}=new URL(e),u=s.endsWith("/")?`${s}${r}/${i}`:`${s}/${r}/${i}`;return new URL(`${t}//${n}${u}${o}${a}`).toString()};function ot(){let{extensionConfig:e}=B("rpc_info");return d(r=>e?.explorerUrl?ye(e?.explorerUrl,"tx",r):null)}export{nt as a,se as b,ie as c,we as d,st as e,it as f,ye as g,ot as h,Ae as i,Oe as j,$e as k};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "prepub";

//# sourceMappingURL=chunk-2N725U3P.js.map
