import{a as Bc}from"./chunk-FXOB5EDP.js";import{a as _c}from"./chunk-33GQ3EEQ.js";import{a as lr}from"./chunk-A77VZBWT.js";import{d as Ee}from"./chunk-IYL2DA3V.js";import{a as ua}from"./chunk-HFBVRVPB.js";import{b as Fc,c as z,d as Cc,g as $0,m as O,n as V,o as j}from"./chunk-EQYVU4XP.js";var gn=z(Q=>{"use strict";O();j();Object.defineProperty(Q,"__esModule",{value:!0});Q.estimateFee=Q.validSignedTransaction=Q.getRawTransaction=Q.hardwareDerivePubKey=Q.calcTxHash=Q.getHardWareMessageHash=Q.getHardWareSignedTransaction=Q.getHardWareRawTransaction=Q.getMPCSignedMessage=Q.getMPCRawMessage=Q.getMPCTransaction=Q.getMPCRawTransaction=Q.getAddressByPublicKey=Q.getDerivedPath=Q.signTransaction=Q.ecRecover=Q.verifyMessage=Q.signMessage=Q.validPrivateKey=Q.validAddress=Q.getNewAddress=Q.getDerivedPrivateKey=Q.getRandomPrivateKey=Q.getMnemonic=Q.unRegister=Q.register=void 0;var Be=lr(),dr=Ee(),De=new Map;function Dc(e,t){De.set(e,t)}Q.register=Dc;function Ic(e,t){De.delete(e)}Q.unRegister=Ic;async function Rc(e){try{let t=dr.bip39.generateMnemonic(e);return Promise.resolve(t)}catch{return Promise.reject(Be.GenMnemonicError)}}Q.getMnemonic=Rc;async function Nc(e){let t=De.get(e);return t!=null?await t.getRandomPrivateKey():Promise.reject(Be.NotImplementedError)}Q.getRandomPrivateKey=Nc;async function Hc(e,t){let r=De.get(e);return r!=null?await r.getDerivedPrivateKey(t):Promise.reject(Be.NotImplementedError)}Q.getDerivedPrivateKey=Hc;async function Tc(e,t){let r=De.get(e);return r!=null?await r.getNewAddress(t):Promise.reject(Be.NotImplementedError)}Q.getNewAddress=Tc;async function Oc(e,t){let r=De.get(e);return r!=null?await r.validAddress(t):Promise.reject(Be.NotImplementedError)}Q.validAddress=Oc;async function jc(e,t){let r=De.get(e);return r!=null?await r.validPrivateKey(t):Promise.reject(Be.NotImplementedError)}Q.validPrivateKey=jc;async function qc(e,t){let r=De.get(e);return r!=null?await r.signMessage(t):Promise.reject(Be.NotImplementedError)}Q.signMessage=qc;async function Kc(e,t){let r=De.get(e);return r!=null?await r.verifyMessage(t):Promise.reject(Be.NotImplementedError)}Q.verifyMessage=Kc;async function kc(e,t){let r=De.get(e);if(r!=null){let n=t.signature,s=t.data;return await r.ecRecover(s,n)}return Promise.reject(Be.NotImplementedError)}Q.ecRecover=kc;async function Mc(e,t){let r=De.get(e);return r!=null?await r.signTransaction(t):Promise.reject(Be.NotImplementedError)}Q.signTransaction=Mc;async function Vc(e,t){let r=De.get(e);return r!=null?await r.getDerivedPath(t):Promise.reject(Be.NotImplementedError)}Q.getDerivedPath=Vc;async function Lc(e,t){let r=De.get(e);return r!=null?await r.getAddressByPublicKey(t):Promise.reject(Be.NotImplementedError)}Q.getAddressByPublicKey=Lc;async function Uc(e,t){let r=De.get(e);return r!=null?await r.getMPCRawTransaction(t):Promise.reject(Be.NotImplementedError)}Q.getMPCRawTransaction=Uc;async function zc(e,t){let r=De.get(e);return r!=null?await r.getMPCTransaction(t):Promise.reject(Be.NotImplementedError)}Q.getMPCTransaction=zc;async function Wc(e,t){let r=De.get(e);return r!=null?await r.getMPCRawMessage(t):Promise.reject(Be.NotImplementedError)}Q.getMPCRawMessage=Wc;async function Gc(e,t){let r=De.get(e);return r!=null?await r.getMPCSignedMessage(t):Promise.reject(Be.NotImplementedError)}Q.getMPCSignedMessage=Gc;async function Xc(e,t){let r=De.get(e);return r!=null?await r.getHardWareRawTransaction(t):Promise.reject(Be.NotImplementedError)}Q.getHardWareRawTransaction=Xc;async function Jc(e,t){let r=De.get(e);return r!=null?await r.getHardWareSignedTransaction(t):Promise.reject(Be.NotImplementedError)}Q.getHardWareSignedTransaction=Jc;async function Yc(e,t){let r=De.get(e);return r!=null?await r.getHardWareMessageHash(t):Promise.reject(Be.NotImplementedError)}Q.getHardWareMessageHash=Yc;async function $c(e,t){let r=De.get(e);return r!=null?await r.calcTxHash(t):Promise.reject(Be.NotImplementedError)}Q.calcTxHash=$c;async function Zc(e,t){try{if(e.slice(0,4)!=="xpub"){let a=dr.base.fromBase58Check(e).slice(4);a=V.Buffer.concat([dr.base.fromHex("0488b21e"),a]),e=dr.base.toBase58Check(a)}let n=dr.bip32.fromBase58(e).derivePath(t);return Promise.resolve(dr.base.toHex(n.publicKey))}catch{return Promise.reject(Be.HardwareDerivePubKeyError)}}Q.hardwareDerivePubKey=Zc;async function Qc(e,t){let r=De.get(e);return r!=null?await r.getRawTransaction(t):Promise.reject(Be.NotImplementedError)}Q.getRawTransaction=Qc;async function eh(e,t){let r=De.get(e);return r!=null?await r.validSignedTransaction(t):Promise.reject(Be.NotImplementedError)}Q.validSignedTransaction=eh;async function th(e,t){let r=De.get(e);return r!=null?await r.estimateFee(t):Promise.reject(Be.NotImplementedError)}Q.estimateFee=th});var le=z((yn,fa)=>{O();j();(function(e,t){typeof yn=="object"?fa.exports=yn=t():typeof define=="function"&&define.amd?define([],t):e.CryptoJS=t()})(yn,function(){var e=e||function(t,r){var n=Object.create||function(){function f(){}return function(v){var y;return f.prototype=v,y=new f,f.prototype=null,y}}(),s={},a=s.lib={},o=a.Base=function(){return{extend:function(f){var v=n(this);return f&&v.mixIn(f),(!v.hasOwnProperty("init")||this.init===v.init)&&(v.init=function(){v.$super.init.apply(this,arguments)}),v.init.prototype=v,v.$super=this,v},create:function(){var f=this.extend();return f.init.apply(f,arguments),f},init:function(){},mixIn:function(f){for(var v in f)f.hasOwnProperty(v)&&(this[v]=f[v]);f.hasOwnProperty("toString")&&(this.toString=f.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),i=a.WordArray=o.extend({init:function(f,v){f=this.words=f||[],v!=r?this.sigBytes=v:this.sigBytes=f.length*4},toString:function(f){return(f||l).stringify(this)},concat:function(f){var v=this.words,y=f.words,m=this.sigBytes,b=f.sigBytes;if(this.clamp(),m%4)for(var E=0;E<b;E++){var P=y[E>>>2]>>>24-E%4*8&255;v[m+E>>>2]|=P<<24-(m+E)%4*8}else for(var E=0;E<b;E+=4)v[m+E>>>2]=y[E>>>2];return this.sigBytes+=b,this},clamp:function(){var f=this.words,v=this.sigBytes;f[v>>>2]&=4294967295<<32-v%4*8,f.length=t.ceil(v/4)},clone:function(){var f=o.clone.call(this);return f.words=this.words.slice(0),f},random:function(f){for(var v=[],y=function(F){var F=F,D=987654321,S=4294967295;return function(){D=36969*(D&65535)+(D>>16)&S,F=18e3*(F&65535)+(F>>16)&S;var w=(D<<16)+F&S;return w/=4294967296,w+=.5,w*(t.random()>.5?1:-1)}},m=0,b;m<f;m+=4){var E=y((b||t.random())*4294967296);b=E()*987654071,v.push(E()*4294967296|0)}return new i.init(v,f)}}),h=s.enc={},l=h.Hex={stringify:function(f){for(var v=f.words,y=f.sigBytes,m=[],b=0;b<y;b++){var E=v[b>>>2]>>>24-b%4*8&255;m.push((E>>>4).toString(16)),m.push((E&15).toString(16))}return m.join("")},parse:function(f){for(var v=f.length,y=[],m=0;m<v;m+=2)y[m>>>3]|=parseInt(f.substr(m,2),16)<<24-m%8*4;return new i.init(y,v/2)}},d=h.Latin1={stringify:function(f){for(var v=f.words,y=f.sigBytes,m=[],b=0;b<y;b++){var E=v[b>>>2]>>>24-b%4*8&255;m.push(String.fromCharCode(E))}return m.join("")},parse:function(f){for(var v=f.length,y=[],m=0;m<v;m++)y[m>>>2]|=(f.charCodeAt(m)&255)<<24-m%4*8;return new i.init(y,v)}},p=h.Utf8={stringify:function(f){try{return decodeURIComponent(escape(d.stringify(f)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(f){return d.parse(unescape(encodeURIComponent(f)))}},u=a.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new i.init,this._nDataBytes=0},_append:function(f){typeof f=="string"&&(f=p.parse(f)),this._data.concat(f),this._nDataBytes+=f.sigBytes},_process:function(f){var v=this._data,y=v.words,m=v.sigBytes,b=this.blockSize,E=b*4,P=m/E;f?P=t.ceil(P):P=t.max((P|0)-this._minBufferSize,0);var F=P*b,D=t.min(F*4,m);if(F){for(var S=0;S<F;S+=b)this._doProcessBlock(y,S);var w=y.splice(0,F);v.sigBytes-=D}return new i.init(w,D)},clone:function(){var f=o.clone.call(this);return f._data=this._data.clone(),f},_minBufferSize:0}),c=a.Hasher=u.extend({cfg:o.extend(),init:function(f){this.cfg=this.cfg.extend(f),this.reset()},reset:function(){u.reset.call(this),this._doReset()},update:function(f){return this._append(f),this._process(),this},finalize:function(f){f&&this._append(f);var v=this._doFinalize();return v},blockSize:512/32,_createHelper:function(f){return function(v,y){return new f.init(y).finalize(v)}},_createHmacHelper:function(f){return function(v,y){return new x.HMAC.init(f,y).finalize(v)}}}),x=s.algo={};return s}(Math);return e})});var Wr=z((mn,ca)=>{O();j();(function(e,t){typeof mn=="object"?ca.exports=mn=t(le()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(mn,function(e){return function(t){var r=e,n=r.lib,s=n.Base,a=n.WordArray,o=r.x64={},i=o.Word=s.extend({init:function(l,d){this.high=l,this.low=d}}),h=o.WordArray=s.extend({init:function(l,d){l=this.words=l||[],d!=t?this.sigBytes=d:this.sigBytes=l.length*8},toX32:function(){for(var l=this.words,d=l.length,p=[],u=0;u<d;u++){var c=l[u];p.push(c.high),p.push(c.low)}return a.create(p,this.sigBytes)},clone:function(){for(var l=s.clone.call(this),d=l.words=this.words.slice(0),p=d.length,u=0;u<p;u++)d[u]=d[u].clone();return l}})}(),e})});var la=z((Sn,ha)=>{O();j();(function(e,t){typeof Sn=="object"?ha.exports=Sn=t(le()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(Sn,function(e){return function(){if(typeof ArrayBuffer=="function"){var t=e,r=t.lib,n=r.WordArray,s=n.init,a=n.init=function(o){if(o instanceof ArrayBuffer&&(o=new Uint8Array(o)),(o instanceof Int8Array||typeof Uint8ClampedArray<"u"&&o instanceof Uint8ClampedArray||o instanceof Int16Array||o instanceof Uint16Array||o instanceof Int32Array||o instanceof Uint32Array||o instanceof Float32Array||o instanceof Float64Array)&&(o=new Uint8Array(o.buffer,o.byteOffset,o.byteLength)),o instanceof Uint8Array){for(var i=o.byteLength,h=[],l=0;l<i;l++)h[l>>>2]|=o[l]<<24-l%4*8;s.call(this,h,i)}else s.apply(this,arguments)};a.prototype=n}}(),e.lib.WordArray})});var va=z((bn,da)=>{O();j();(function(e,t){typeof bn=="object"?da.exports=bn=t(le()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(bn,function(e){return function(){var t=e,r=t.lib,n=r.WordArray,s=t.enc,a=s.Utf16=s.Utf16BE={stringify:function(i){for(var h=i.words,l=i.sigBytes,d=[],p=0;p<l;p+=2){var u=h[p>>>2]>>>16-p%4*8&65535;d.push(String.fromCharCode(u))}return d.join("")},parse:function(i){for(var h=i.length,l=[],d=0;d<h;d++)l[d>>>1]|=i.charCodeAt(d)<<16-d%2*16;return n.create(l,h*2)}};s.Utf16LE={stringify:function(i){for(var h=i.words,l=i.sigBytes,d=[],p=0;p<l;p+=2){var u=o(h[p>>>2]>>>16-p%4*8&65535);d.push(String.fromCharCode(u))}return d.join("")},parse:function(i){for(var h=i.length,l=[],d=0;d<h;d++)l[d>>>1]|=o(i.charCodeAt(d)<<16-d%2*16);return n.create(l,h*2)}};function o(i){return i<<8&4278255360|i>>>8&16711935}}(),e.enc.Utf16})});var Qt=z((wn,pa)=>{O();j();(function(e,t){typeof wn=="object"?pa.exports=wn=t(le()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(wn,function(e){return function(){var t=e,r=t.lib,n=r.WordArray,s=t.enc,a=s.Base64={stringify:function(i){var h=i.words,l=i.sigBytes,d=this._map;i.clamp();for(var p=[],u=0;u<l;u+=3)for(var c=h[u>>>2]>>>24-u%4*8&255,x=h[u+1>>>2]>>>24-(u+1)%4*8&255,f=h[u+2>>>2]>>>24-(u+2)%4*8&255,v=c<<16|x<<8|f,y=0;y<4&&u+y*.75<l;y++)p.push(d.charAt(v>>>6*(3-y)&63));var m=d.charAt(64);if(m)for(;p.length%4;)p.push(m);return p.join("")},parse:function(i){var h=i.length,l=this._map,d=this._reverseMap;if(!d){d=this._reverseMap=[];for(var p=0;p<l.length;p++)d[l.charCodeAt(p)]=p}var u=l.charAt(64);if(u){var c=i.indexOf(u);c!==-1&&(h=c)}return o(i,h,d)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function o(i,h,l){for(var d=[],p=0,u=0;u<h;u++)if(u%4){var c=l[i.charCodeAt(u-1)]<<u%4*2,x=l[i.charCodeAt(u)]>>>6-u%4*2;d[p>>>2]|=(c|x)<<24-p%4*8,p++}return n.create(d,p)}}(),e.enc.Base64})});var er=z((En,xa)=>{O();j();(function(e,t){typeof En=="object"?xa.exports=En=t(le()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(En,function(e){return function(t){var r=e,n=r.lib,s=n.WordArray,a=n.Hasher,o=r.algo,i=[];(function(){for(var c=0;c<64;c++)i[c]=t.abs(t.sin(c+1))*4294967296|0})();var h=o.MD5=a.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(c,x){for(var f=0;f<16;f++){var v=x+f,y=c[v];c[v]=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360}var m=this._hash.words,b=c[x+0],E=c[x+1],P=c[x+2],F=c[x+3],D=c[x+4],S=c[x+5],w=c[x+6],C=c[x+7],A=c[x+8],B=c[x+9],R=c[x+10],_=c[x+11],I=c[x+12],N=c[x+13],K=c[x+14],L=c[x+15],H=m[0],T=m[1],k=m[2],q=m[3];H=l(H,T,k,q,b,7,i[0]),q=l(q,H,T,k,E,12,i[1]),k=l(k,q,H,T,P,17,i[2]),T=l(T,k,q,H,F,22,i[3]),H=l(H,T,k,q,D,7,i[4]),q=l(q,H,T,k,S,12,i[5]),k=l(k,q,H,T,w,17,i[6]),T=l(T,k,q,H,C,22,i[7]),H=l(H,T,k,q,A,7,i[8]),q=l(q,H,T,k,B,12,i[9]),k=l(k,q,H,T,R,17,i[10]),T=l(T,k,q,H,_,22,i[11]),H=l(H,T,k,q,I,7,i[12]),q=l(q,H,T,k,N,12,i[13]),k=l(k,q,H,T,K,17,i[14]),T=l(T,k,q,H,L,22,i[15]),H=d(H,T,k,q,E,5,i[16]),q=d(q,H,T,k,w,9,i[17]),k=d(k,q,H,T,_,14,i[18]),T=d(T,k,q,H,b,20,i[19]),H=d(H,T,k,q,S,5,i[20]),q=d(q,H,T,k,R,9,i[21]),k=d(k,q,H,T,L,14,i[22]),T=d(T,k,q,H,D,20,i[23]),H=d(H,T,k,q,B,5,i[24]),q=d(q,H,T,k,K,9,i[25]),k=d(k,q,H,T,F,14,i[26]),T=d(T,k,q,H,A,20,i[27]),H=d(H,T,k,q,N,5,i[28]),q=d(q,H,T,k,P,9,i[29]),k=d(k,q,H,T,C,14,i[30]),T=d(T,k,q,H,I,20,i[31]),H=p(H,T,k,q,S,4,i[32]),q=p(q,H,T,k,A,11,i[33]),k=p(k,q,H,T,_,16,i[34]),T=p(T,k,q,H,K,23,i[35]),H=p(H,T,k,q,E,4,i[36]),q=p(q,H,T,k,D,11,i[37]),k=p(k,q,H,T,C,16,i[38]),T=p(T,k,q,H,R,23,i[39]),H=p(H,T,k,q,N,4,i[40]),q=p(q,H,T,k,b,11,i[41]),k=p(k,q,H,T,F,16,i[42]),T=p(T,k,q,H,w,23,i[43]),H=p(H,T,k,q,B,4,i[44]),q=p(q,H,T,k,I,11,i[45]),k=p(k,q,H,T,L,16,i[46]),T=p(T,k,q,H,P,23,i[47]),H=u(H,T,k,q,b,6,i[48]),q=u(q,H,T,k,C,10,i[49]),k=u(k,q,H,T,K,15,i[50]),T=u(T,k,q,H,S,21,i[51]),H=u(H,T,k,q,I,6,i[52]),q=u(q,H,T,k,F,10,i[53]),k=u(k,q,H,T,R,15,i[54]),T=u(T,k,q,H,E,21,i[55]),H=u(H,T,k,q,A,6,i[56]),q=u(q,H,T,k,L,10,i[57]),k=u(k,q,H,T,w,15,i[58]),T=u(T,k,q,H,N,21,i[59]),H=u(H,T,k,q,D,6,i[60]),q=u(q,H,T,k,_,10,i[61]),k=u(k,q,H,T,P,15,i[62]),T=u(T,k,q,H,B,21,i[63]),m[0]=m[0]+H|0,m[1]=m[1]+T|0,m[2]=m[2]+k|0,m[3]=m[3]+q|0},_doFinalize:function(){var c=this._data,x=c.words,f=this._nDataBytes*8,v=c.sigBytes*8;x[v>>>5]|=128<<24-v%32;var y=t.floor(f/4294967296),m=f;x[(v+64>>>9<<4)+15]=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,x[(v+64>>>9<<4)+14]=(m<<8|m>>>24)&16711935|(m<<24|m>>>8)&4278255360,c.sigBytes=(x.length+1)*4,this._process();for(var b=this._hash,E=b.words,P=0;P<4;P++){var F=E[P];E[P]=(F<<8|F>>>24)&16711935|(F<<24|F>>>8)&4278255360}return b},clone:function(){var c=a.clone.call(this);return c._hash=this._hash.clone(),c}});function l(c,x,f,v,y,m,b){var E=c+(x&f|~x&v)+y+b;return(E<<m|E>>>32-m)+x}function d(c,x,f,v,y,m,b){var E=c+(x&v|f&~v)+y+b;return(E<<m|E>>>32-m)+x}function p(c,x,f,v,y,m,b){var E=c+(x^f^v)+y+b;return(E<<m|E>>>32-m)+x}function u(c,x,f,v,y,m,b){var E=c+(f^(x|~v))+y+b;return(E<<m|E>>>32-m)+x}r.MD5=a._createHelper(h),r.HmacMD5=a._createHmacHelper(h)}(Math),e.MD5})});var An=z((Pn,ga)=>{O();j();(function(e,t){typeof Pn=="object"?ga.exports=Pn=t(le()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(Pn,function(e){return function(){var t=e,r=t.lib,n=r.WordArray,s=r.Hasher,a=t.algo,o=[],i=a.SHA1=s.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(h,l){for(var d=this._hash.words,p=d[0],u=d[1],c=d[2],x=d[3],f=d[4],v=0;v<80;v++){if(v<16)o[v]=h[l+v]|0;else{var y=o[v-3]^o[v-8]^o[v-14]^o[v-16];o[v]=y<<1|y>>>31}var m=(p<<5|p>>>27)+f+o[v];v<20?m+=(u&c|~u&x)+1518500249:v<40?m+=(u^c^x)+1859775393:v<60?m+=(u&c|u&x|c&x)-1894007588:m+=(u^c^x)-899497514,f=x,x=c,c=u<<30|u>>>2,u=p,p=m}d[0]=d[0]+p|0,d[1]=d[1]+u|0,d[2]=d[2]+c|0,d[3]=d[3]+x|0,d[4]=d[4]+f|0},_doFinalize:function(){var h=this._data,l=h.words,d=this._nDataBytes*8,p=h.sigBytes*8;return l[p>>>5]|=128<<24-p%32,l[(p+64>>>9<<4)+14]=Math.floor(d/4294967296),l[(p+64>>>9<<4)+15]=d,h.sigBytes=l.length*4,this._process(),this._hash},clone:function(){var h=s.clone.call(this);return h._hash=this._hash.clone(),h}});t.SHA1=s._createHelper(i),t.HmacSHA1=s._createHmacHelper(i)}(),e.SHA1})});var Z0=z((Fn,ya)=>{O();j();(function(e,t){typeof Fn=="object"?ya.exports=Fn=t(le()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(Fn,function(e){return function(t){var r=e,n=r.lib,s=n.WordArray,a=n.Hasher,o=r.algo,i=[],h=[];(function(){function p(f){for(var v=t.sqrt(f),y=2;y<=v;y++)if(!(f%y))return!1;return!0}function u(f){return(f-(f|0))*4294967296|0}for(var c=2,x=0;x<64;)p(c)&&(x<8&&(i[x]=u(t.pow(c,1/2))),h[x]=u(t.pow(c,1/3)),x++),c++})();var l=[],d=o.SHA256=a.extend({_doReset:function(){this._hash=new s.init(i.slice(0))},_doProcessBlock:function(p,u){for(var c=this._hash.words,x=c[0],f=c[1],v=c[2],y=c[3],m=c[4],b=c[5],E=c[6],P=c[7],F=0;F<64;F++){if(F<16)l[F]=p[u+F]|0;else{var D=l[F-15],S=(D<<25|D>>>7)^(D<<14|D>>>18)^D>>>3,w=l[F-2],C=(w<<15|w>>>17)^(w<<13|w>>>19)^w>>>10;l[F]=S+l[F-7]+C+l[F-16]}var A=m&b^~m&E,B=x&f^x&v^f&v,R=(x<<30|x>>>2)^(x<<19|x>>>13)^(x<<10|x>>>22),_=(m<<26|m>>>6)^(m<<21|m>>>11)^(m<<7|m>>>25),I=P+_+A+h[F]+l[F],N=R+B;P=E,E=b,b=m,m=y+I|0,y=v,v=f,f=x,x=I+N|0}c[0]=c[0]+x|0,c[1]=c[1]+f|0,c[2]=c[2]+v|0,c[3]=c[3]+y|0,c[4]=c[4]+m|0,c[5]=c[5]+b|0,c[6]=c[6]+E|0,c[7]=c[7]+P|0},_doFinalize:function(){var p=this._data,u=p.words,c=this._nDataBytes*8,x=p.sigBytes*8;return u[x>>>5]|=128<<24-x%32,u[(x+64>>>9<<4)+14]=t.floor(c/4294967296),u[(x+64>>>9<<4)+15]=c,p.sigBytes=u.length*4,this._process(),this._hash},clone:function(){var p=a.clone.call(this);return p._hash=this._hash.clone(),p}});r.SHA256=a._createHelper(d),r.HmacSHA256=a._createHmacHelper(d)}(Math),e.SHA256})});var Sa=z((Cn,ma)=>{O();j();(function(e,t,r){typeof Cn=="object"?ma.exports=Cn=t(le(),Z0()):typeof define=="function"&&define.amd?define(["./core","./sha256"],t):t(e.CryptoJS)})(Cn,function(e){return function(){var t=e,r=t.lib,n=r.WordArray,s=t.algo,a=s.SHA256,o=s.SHA224=a.extend({_doReset:function(){this._hash=new n.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var i=a._doFinalize.call(this);return i.sigBytes-=4,i}});t.SHA224=a._createHelper(o),t.HmacSHA224=a._createHmacHelper(o)}(),e.SHA224})});var Q0=z((_n,ba)=>{O();j();(function(e,t,r){typeof _n=="object"?ba.exports=_n=t(le(),Wr()):typeof define=="function"&&define.amd?define(["./core","./x64-core"],t):t(e.CryptoJS)})(_n,function(e){return function(){var t=e,r=t.lib,n=r.Hasher,s=t.x64,a=s.Word,o=s.WordArray,i=t.algo;function h(){return a.create.apply(a,arguments)}var l=[h(1116352408,3609767458),h(1899447441,602891725),h(3049323471,3964484399),h(3921009573,2173295548),h(961987163,4081628472),h(1508970993,3053834265),h(2453635748,2937671579),h(2870763221,3664609560),h(3624381080,2734883394),h(310598401,1164996542),h(607225278,1323610764),h(1426881987,3590304994),h(1925078388,4068182383),h(2162078206,991336113),h(2614888103,633803317),h(3248222580,3479774868),h(3835390401,2666613458),h(4022224774,944711139),h(264347078,2341262773),h(604807628,2007800933),h(770255983,1495990901),h(1249150122,1856431235),h(1555081692,3175218132),h(1996064986,2198950837),h(2554220882,3999719339),h(2821834349,766784016),h(2952996808,2566594879),h(3210313671,3203337956),h(3336571891,1034457026),h(3584528711,2466948901),h(113926993,3758326383),h(338241895,168717936),h(666307205,1188179964),h(773529912,1546045734),h(1294757372,1522805485),h(1396182291,2643833823),h(1695183700,2343527390),h(1986661051,1014477480),h(2177026350,1206759142),h(2456956037,344077627),h(2730485921,1290863460),h(2820302411,3158454273),h(3259730800,3505952657),h(3345764771,106217008),h(3516065817,3606008344),h(3600352804,1432725776),h(4094571909,1467031594),h(275423344,851169720),h(430227734,3100823752),h(506948616,1363258195),h(659060556,3750685593),h(883997877,3785050280),h(958139571,3318307427),h(1322822218,3812723403),h(1537002063,2003034995),h(1747873779,3602036899),h(1955562222,1575990012),h(2024104815,1125592928),h(2227730452,2716904306),h(2361852424,442776044),h(2428436474,593698344),h(2756734187,3733110249),h(3204031479,2999351573),h(3329325298,3815920427),h(3391569614,3928383900),h(3515267271,566280711),h(3940187606,3454069534),h(4118630271,4000239992),h(116418474,1914138554),h(174292421,2731055270),h(289380356,3203993006),h(460393269,320620315),h(685471733,587496836),h(852142971,1086792851),h(1017036298,365543100),h(1126000580,2618297676),h(1288033470,3409855158),h(1501505948,4234509866),h(1607167915,987167468),h(1816402316,1246189591)],d=[];(function(){for(var u=0;u<80;u++)d[u]=h()})();var p=i.SHA512=n.extend({_doReset:function(){this._hash=new o.init([new a.init(1779033703,4089235720),new a.init(3144134277,2227873595),new a.init(1013904242,4271175723),new a.init(2773480762,1595750129),new a.init(1359893119,2917565137),new a.init(2600822924,725511199),new a.init(528734635,4215389547),new a.init(1541459225,327033209)])},_doProcessBlock:function(u,c){for(var x=this._hash.words,f=x[0],v=x[1],y=x[2],m=x[3],b=x[4],E=x[5],P=x[6],F=x[7],D=f.high,S=f.low,w=v.high,C=v.low,A=y.high,B=y.low,R=m.high,_=m.low,I=b.high,N=b.low,K=E.high,L=E.low,H=P.high,T=P.low,k=F.high,q=F.low,$=D,Y=S,se=w,G=C,me=A,ye=B,He=R,ie=_,ne=I,re=N,xe=K,be=L,oe=H,Pe=T,ot=k,qe=q,Fe=0;Fe<80;Fe++){var Ke=d[Fe];if(Fe<16)var Re=Ke.high=u[c+Fe*2]|0,Ce=Ke.low=u[c+Fe*2+1]|0;else{var Lt=d[Fe-15],ae=Lt.high,Te=Lt.low,fe=(ae>>>1|Te<<31)^(ae>>>8|Te<<24)^ae>>>7,it=(Te>>>1|ae<<31)^(Te>>>8|ae<<24)^(Te>>>7|ae<<25),Or=d[Fe-2],ut=Or.high,bt=Or.low,K0=(ut>>>19|bt<<13)^(ut<<3|bt>>>29)^ut>>>6,jr=(bt>>>19|ut<<13)^(bt<<3|ut>>>29)^(bt>>>6|ut<<26),qr=d[Fe-7],k0=qr.high,M0=qr.low,Kr=d[Fe-16],V0=Kr.high,kr=Kr.low,Ce=it+M0,Re=fe+k0+(Ce>>>0<it>>>0?1:0),Ce=Ce+jr,Re=Re+K0+(Ce>>>0<jr>>>0?1:0),Ce=Ce+kr,Re=Re+V0+(Ce>>>0<kr>>>0?1:0);Ke.high=Re,Ke.low=Ce}var L0=ne&xe^~ne&oe,Mr=re&be^~re&Pe,U0=$&se^$&me^se&me,z0=Y&G^Y&ye^G&ye,W0=($>>>28|Y<<4)^($<<30|Y>>>2)^($<<25|Y>>>7),Vr=(Y>>>28|$<<4)^(Y<<30|$>>>2)^(Y<<25|$>>>7),G0=(ne>>>14|re<<18)^(ne>>>18|re<<14)^(ne<<23|re>>>9),X0=(re>>>14|ne<<18)^(re>>>18|ne<<14)^(re<<23|ne>>>9),Lr=l[Fe],J0=Lr.high,Ur=Lr.low,we=qe+X0,Je=ot+G0+(we>>>0<qe>>>0?1:0),we=we+Mr,Je=Je+L0+(we>>>0<Mr>>>0?1:0),we=we+Ur,Je=Je+J0+(we>>>0<Ur>>>0?1:0),we=we+Ce,Je=Je+Re+(we>>>0<Ce>>>0?1:0),zr=Vr+z0,Y0=W0+U0+(zr>>>0<Vr>>>0?1:0);ot=oe,qe=Pe,oe=xe,Pe=be,xe=ne,be=re,re=ie+we|0,ne=He+Je+(re>>>0<ie>>>0?1:0)|0,He=me,ie=ye,me=se,ye=G,se=$,G=Y,Y=we+zr|0,$=Je+Y0+(Y>>>0<we>>>0?1:0)|0}S=f.low=S+Y,f.high=D+$+(S>>>0<Y>>>0?1:0),C=v.low=C+G,v.high=w+se+(C>>>0<G>>>0?1:0),B=y.low=B+ye,y.high=A+me+(B>>>0<ye>>>0?1:0),_=m.low=_+ie,m.high=R+He+(_>>>0<ie>>>0?1:0),N=b.low=N+re,b.high=I+ne+(N>>>0<re>>>0?1:0),L=E.low=L+be,E.high=K+xe+(L>>>0<be>>>0?1:0),T=P.low=T+Pe,P.high=H+oe+(T>>>0<Pe>>>0?1:0),q=F.low=q+qe,F.high=k+ot+(q>>>0<qe>>>0?1:0)},_doFinalize:function(){var u=this._data,c=u.words,x=this._nDataBytes*8,f=u.sigBytes*8;c[f>>>5]|=128<<24-f%32,c[(f+128>>>10<<5)+30]=Math.floor(x/4294967296),c[(f+128>>>10<<5)+31]=x,u.sigBytes=c.length*4,this._process();var v=this._hash.toX32();return v},clone:function(){var u=n.clone.call(this);return u._hash=this._hash.clone(),u},blockSize:1024/32});t.SHA512=n._createHelper(p),t.HmacSHA512=n._createHmacHelper(p)}(),e.SHA512})});var Ea=z((Bn,wa)=>{O();j();(function(e,t,r){typeof Bn=="object"?wa.exports=Bn=t(le(),Wr(),Q0()):typeof define=="function"&&define.amd?define(["./core","./x64-core","./sha512"],t):t(e.CryptoJS)})(Bn,function(e){return function(){var t=e,r=t.x64,n=r.Word,s=r.WordArray,a=t.algo,o=a.SHA512,i=a.SHA384=o.extend({_doReset:function(){this._hash=new s.init([new n.init(3418070365,3238371032),new n.init(1654270250,914150663),new n.init(2438529370,812702999),new n.init(355462360,4144912697),new n.init(1731405415,4290775857),new n.init(2394180231,1750603025),new n.init(3675008525,1694076839),new n.init(1203062813,3204075428)])},_doFinalize:function(){var h=o._doFinalize.call(this);return h.sigBytes-=16,h}});t.SHA384=o._createHelper(i),t.HmacSHA384=o._createHmacHelper(i)}(),e.SHA384})});var Aa=z((Dn,Pa)=>{O();j();(function(e,t,r){typeof Dn=="object"?Pa.exports=Dn=t(le(),Wr()):typeof define=="function"&&define.amd?define(["./core","./x64-core"],t):t(e.CryptoJS)})(Dn,function(e){return function(t){var r=e,n=r.lib,s=n.WordArray,a=n.Hasher,o=r.x64,i=o.Word,h=r.algo,l=[],d=[],p=[];(function(){for(var x=1,f=0,v=0;v<24;v++){l[x+5*f]=(v+1)*(v+2)/2%64;var y=f%5,m=(2*x+3*f)%5;x=y,f=m}for(var x=0;x<5;x++)for(var f=0;f<5;f++)d[x+5*f]=f+(2*x+3*f)%5*5;for(var b=1,E=0;E<24;E++){for(var P=0,F=0,D=0;D<7;D++){if(b&1){var S=(1<<D)-1;S<32?F^=1<<S:P^=1<<S-32}b&128?b=b<<1^113:b<<=1}p[E]=i.create(P,F)}})();var u=[];(function(){for(var x=0;x<25;x++)u[x]=i.create()})();var c=h.SHA3=a.extend({cfg:a.cfg.extend({outputLength:512}),_doReset:function(){for(var x=this._state=[],f=0;f<25;f++)x[f]=new i.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(x,f){for(var v=this._state,y=this.blockSize/2,m=0;m<y;m++){var b=x[f+2*m],E=x[f+2*m+1];b=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,E=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360;var P=v[m];P.high^=E,P.low^=b}for(var F=0;F<24;F++){for(var D=0;D<5;D++){for(var S=0,w=0,C=0;C<5;C++){var P=v[D+5*C];S^=P.high,w^=P.low}var A=u[D];A.high=S,A.low=w}for(var D=0;D<5;D++)for(var B=u[(D+4)%5],R=u[(D+1)%5],_=R.high,I=R.low,S=B.high^(_<<1|I>>>31),w=B.low^(I<<1|_>>>31),C=0;C<5;C++){var P=v[D+5*C];P.high^=S,P.low^=w}for(var N=1;N<25;N++){var P=v[N],K=P.high,L=P.low,H=l[N];if(H<32)var S=K<<H|L>>>32-H,w=L<<H|K>>>32-H;else var S=L<<H-32|K>>>64-H,w=K<<H-32|L>>>64-H;var T=u[d[N]];T.high=S,T.low=w}var k=u[0],q=v[0];k.high=q.high,k.low=q.low;for(var D=0;D<5;D++)for(var C=0;C<5;C++){var N=D+5*C,P=v[N],$=u[N],Y=u[(D+1)%5+5*C],se=u[(D+2)%5+5*C];P.high=$.high^~Y.high&se.high,P.low=$.low^~Y.low&se.low}var P=v[0],G=p[F];P.high^=G.high,P.low^=G.low}},_doFinalize:function(){var x=this._data,f=x.words,v=this._nDataBytes*8,y=x.sigBytes*8,m=this.blockSize*32;f[y>>>5]|=1<<24-y%32,f[(t.ceil((y+1)/m)*m>>>5)-1]|=128,x.sigBytes=f.length*4,this._process();for(var b=this._state,E=this.cfg.outputLength/8,P=E/8,F=[],D=0;D<P;D++){var S=b[D],w=S.high,C=S.low;w=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,C=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360,F.push(C),F.push(w)}return new s.init(F,E)},clone:function(){for(var x=a.clone.call(this),f=x._state=this._state.slice(0),v=0;v<25;v++)f[v]=f[v].clone();return x}});r.SHA3=a._createHelper(c),r.HmacSHA3=a._createHmacHelper(c)}(Math),e.SHA3})});var Ca=z((In,Fa)=>{O();j();(function(e,t){typeof In=="object"?Fa.exports=In=t(le()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(In,function(e){return function(t){var r=e,n=r.lib,s=n.WordArray,a=n.Hasher,o=r.algo,i=s.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),h=s.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),l=s.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),d=s.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),p=s.create([0,1518500249,1859775393,2400959708,2840853838]),u=s.create([1352829926,1548603684,1836072691,2053994217,0]),c=o.RIPEMD160=a.extend({_doReset:function(){this._hash=s.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(E,P){for(var F=0;F<16;F++){var D=P+F,S=E[D];E[D]=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360}var w=this._hash.words,C=p.words,A=u.words,B=i.words,R=h.words,_=l.words,I=d.words,N,K,L,H,T,k,q,$,Y,se;k=N=w[0],q=K=w[1],$=L=w[2],Y=H=w[3],se=T=w[4];for(var G,F=0;F<80;F+=1)G=N+E[P+B[F]]|0,F<16?G+=x(K,L,H)+C[0]:F<32?G+=f(K,L,H)+C[1]:F<48?G+=v(K,L,H)+C[2]:F<64?G+=y(K,L,H)+C[3]:G+=m(K,L,H)+C[4],G=G|0,G=b(G,_[F]),G=G+T|0,N=T,T=H,H=b(L,10),L=K,K=G,G=k+E[P+R[F]]|0,F<16?G+=m(q,$,Y)+A[0]:F<32?G+=y(q,$,Y)+A[1]:F<48?G+=v(q,$,Y)+A[2]:F<64?G+=f(q,$,Y)+A[3]:G+=x(q,$,Y)+A[4],G=G|0,G=b(G,I[F]),G=G+se|0,k=se,se=Y,Y=b($,10),$=q,q=G;G=w[1]+L+Y|0,w[1]=w[2]+H+se|0,w[2]=w[3]+T+k|0,w[3]=w[4]+N+q|0,w[4]=w[0]+K+$|0,w[0]=G},_doFinalize:function(){var E=this._data,P=E.words,F=this._nDataBytes*8,D=E.sigBytes*8;P[D>>>5]|=128<<24-D%32,P[(D+64>>>9<<4)+14]=(F<<8|F>>>24)&16711935|(F<<24|F>>>8)&4278255360,E.sigBytes=(P.length+1)*4,this._process();for(var S=this._hash,w=S.words,C=0;C<5;C++){var A=w[C];w[C]=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360}return S},clone:function(){var E=a.clone.call(this);return E._hash=this._hash.clone(),E}});function x(E,P,F){return E^P^F}function f(E,P,F){return E&P|~E&F}function v(E,P,F){return(E|~P)^F}function y(E,P,F){return E&F|P&~F}function m(E,P,F){return E^(P|~F)}function b(E,P){return E<<P|E>>>32-P}r.RIPEMD160=a._createHelper(c),r.HmacRIPEMD160=a._createHmacHelper(c)}(Math),e.RIPEMD160})});var Nn=z((Rn,_a)=>{O();j();(function(e,t){typeof Rn=="object"?_a.exports=Rn=t(le()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(Rn,function(e){(function(){var t=e,r=t.lib,n=r.Base,s=t.enc,a=s.Utf8,o=t.algo,i=o.HMAC=n.extend({init:function(h,l){h=this._hasher=new h.init,typeof l=="string"&&(l=a.parse(l));var d=h.blockSize,p=d*4;l.sigBytes>p&&(l=h.finalize(l)),l.clamp();for(var u=this._oKey=l.clone(),c=this._iKey=l.clone(),x=u.words,f=c.words,v=0;v<d;v++)x[v]^=1549556828,f[v]^=909522486;u.sigBytes=c.sigBytes=p,this.reset()},reset:function(){var h=this._hasher;h.reset(),h.update(this._iKey)},update:function(h){return this._hasher.update(h),this},finalize:function(h){var l=this._hasher,d=l.finalize(h);l.reset();var p=l.finalize(this._oKey.clone().concat(d));return p}})})()})});var Da=z((Hn,Ba)=>{O();j();(function(e,t,r){typeof Hn=="object"?Ba.exports=Hn=t(le(),An(),Nn()):typeof define=="function"&&define.amd?define(["./core","./sha1","./hmac"],t):t(e.CryptoJS)})(Hn,function(e){return function(){var t=e,r=t.lib,n=r.Base,s=r.WordArray,a=t.algo,o=a.SHA1,i=a.HMAC,h=a.PBKDF2=n.extend({cfg:n.extend({keySize:128/32,hasher:o,iterations:1}),init:function(l){this.cfg=this.cfg.extend(l)},compute:function(l,d){for(var p=this.cfg,u=i.create(p.hasher,l),c=s.create(),x=s.create([1]),f=c.words,v=x.words,y=p.keySize,m=p.iterations;f.length<y;){var b=u.update(d).finalize(x);u.reset();for(var E=b.words,P=E.length,F=b,D=1;D<m;D++){F=u.finalize(F),u.reset();for(var S=F.words,w=0;w<P;w++)E[w]^=S[w]}c.concat(b),v[0]++}return c.sigBytes=y*4,c}});t.PBKDF2=function(l,d,p){return h.create(p).compute(l,d)}}(),e.PBKDF2})});var Ut=z((Tn,Ia)=>{O();j();(function(e,t,r){typeof Tn=="object"?Ia.exports=Tn=t(le(),An(),Nn()):typeof define=="function"&&define.amd?define(["./core","./sha1","./hmac"],t):t(e.CryptoJS)})(Tn,function(e){return function(){var t=e,r=t.lib,n=r.Base,s=r.WordArray,a=t.algo,o=a.MD5,i=a.EvpKDF=n.extend({cfg:n.extend({keySize:128/32,hasher:o,iterations:1}),init:function(h){this.cfg=this.cfg.extend(h)},compute:function(h,l){for(var d=this.cfg,p=d.hasher.create(),u=s.create(),c=u.words,x=d.keySize,f=d.iterations;c.length<x;){v&&p.update(v);var v=p.update(h).finalize(l);p.reset();for(var y=1;y<f;y++)v=p.finalize(v),p.reset();u.concat(v)}return u.sigBytes=x*4,u}});t.EvpKDF=function(h,l,d){return i.create(d).compute(h,l)}}(),e.EvpKDF})});var Le=z((On,Ra)=>{O();j();(function(e,t,r){typeof On=="object"?Ra.exports=On=t(le(),Ut()):typeof define=="function"&&define.amd?define(["./core","./evpkdf"],t):t(e.CryptoJS)})(On,function(e){e.lib.Cipher||function(t){var r=e,n=r.lib,s=n.Base,a=n.WordArray,o=n.BufferedBlockAlgorithm,i=r.enc,h=i.Utf8,l=i.Base64,d=r.algo,p=d.EvpKDF,u=n.Cipher=o.extend({cfg:s.extend(),createEncryptor:function(A,B){return this.create(this._ENC_XFORM_MODE,A,B)},createDecryptor:function(A,B){return this.create(this._DEC_XFORM_MODE,A,B)},init:function(A,B,R){this.cfg=this.cfg.extend(R),this._xformMode=A,this._key=B,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(A){return this._append(A),this._process()},finalize:function(A){A&&this._append(A);var B=this._doFinalize();return B},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function A(B){return typeof B=="string"?C:D}return function(B){return{encrypt:function(R,_,I){return A(_).encrypt(B,R,_,I)},decrypt:function(R,_,I){return A(_).decrypt(B,R,_,I)}}}}()}),c=n.StreamCipher=u.extend({_doFinalize:function(){var A=this._process(!0);return A},blockSize:1}),x=r.mode={},f=n.BlockCipherMode=s.extend({createEncryptor:function(A,B){return this.Encryptor.create(A,B)},createDecryptor:function(A,B){return this.Decryptor.create(A,B)},init:function(A,B){this._cipher=A,this._iv=B}}),v=x.CBC=function(){var A=f.extend();A.Encryptor=A.extend({processBlock:function(R,_){var I=this._cipher,N=I.blockSize;B.call(this,R,_,N),I.encryptBlock(R,_),this._prevBlock=R.slice(_,_+N)}}),A.Decryptor=A.extend({processBlock:function(R,_){var I=this._cipher,N=I.blockSize,K=R.slice(_,_+N);I.decryptBlock(R,_),B.call(this,R,_,N),this._prevBlock=K}});function B(R,_,I){var N=this._iv;if(N){var K=N;this._iv=t}else var K=this._prevBlock;for(var L=0;L<I;L++)R[_+L]^=K[L]}return A}(),y=r.pad={},m=y.Pkcs7={pad:function(A,B){for(var R=B*4,_=R-A.sigBytes%R,I=_<<24|_<<16|_<<8|_,N=[],K=0;K<_;K+=4)N.push(I);var L=a.create(N,_);A.concat(L)},unpad:function(A){var B=A.words[A.sigBytes-1>>>2]&255;A.sigBytes-=B}},b=n.BlockCipher=u.extend({cfg:u.cfg.extend({mode:v,padding:m}),reset:function(){u.reset.call(this);var A=this.cfg,B=A.iv,R=A.mode;if(this._xformMode==this._ENC_XFORM_MODE)var _=R.createEncryptor;else{var _=R.createDecryptor;this._minBufferSize=1}this._mode&&this._mode.__creator==_?this._mode.init(this,B&&B.words):(this._mode=_.call(R,this,B&&B.words),this._mode.__creator=_)},_doProcessBlock:function(A,B){this._mode.processBlock(A,B)},_doFinalize:function(){var A=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){A.pad(this._data,this.blockSize);var B=this._process(!0)}else{var B=this._process(!0);A.unpad(B)}return B},blockSize:128/32}),E=n.CipherParams=s.extend({init:function(A){this.mixIn(A)},toString:function(A){return(A||this.formatter).stringify(this)}}),P=r.format={},F=P.OpenSSL={stringify:function(A){var B=A.ciphertext,R=A.salt;if(R)var _=a.create([1398893684,1701076831]).concat(R).concat(B);else var _=B;return _.toString(l)},parse:function(A){var B=l.parse(A),R=B.words;if(R[0]==1398893684&&R[1]==1701076831){var _=a.create(R.slice(2,4));R.splice(0,4),B.sigBytes-=16}return E.create({ciphertext:B,salt:_})}},D=n.SerializableCipher=s.extend({cfg:s.extend({format:F}),encrypt:function(A,B,R,_){_=this.cfg.extend(_);var I=A.createEncryptor(R,_),N=I.finalize(B),K=I.cfg;return E.create({ciphertext:N,key:R,iv:K.iv,algorithm:A,mode:K.mode,padding:K.padding,blockSize:A.blockSize,formatter:_.format})},decrypt:function(A,B,R,_){_=this.cfg.extend(_),B=this._parse(B,_.format);var I=A.createDecryptor(R,_).finalize(B.ciphertext);return I},_parse:function(A,B){return typeof A=="string"?B.parse(A,this):A}}),S=r.kdf={},w=S.OpenSSL={execute:function(A,B,R,_){_||(_=a.random(64/8));var I=p.create({keySize:B+R}).compute(A,_),N=a.create(I.words.slice(B),R*4);return I.sigBytes=B*4,E.create({key:I,iv:N,salt:_})}},C=n.PasswordBasedCipher=D.extend({cfg:D.cfg.extend({kdf:w}),encrypt:function(A,B,R,_){_=this.cfg.extend(_);var I=_.kdf.execute(R,A.keySize,A.ivSize);_.iv=I.iv;var N=D.encrypt.call(this,A,B,I.key,_);return N.mixIn(I),N},decrypt:function(A,B,R,_){_=this.cfg.extend(_),B=this._parse(B,_.format);var I=_.kdf.execute(R,A.keySize,A.ivSize,B.salt);_.iv=I.iv;var N=D.decrypt.call(this,A,B,I.key,_);return N}})}()})});var Ha=z((jn,Na)=>{O();j();(function(e,t,r){typeof jn=="object"?Na.exports=jn=t(le(),Le()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(jn,function(e){return e.mode.CFB=function(){var t=e.lib.BlockCipherMode.extend();t.Encryptor=t.extend({processBlock:function(n,s){var a=this._cipher,o=a.blockSize;r.call(this,n,s,o,a),this._prevBlock=n.slice(s,s+o)}}),t.Decryptor=t.extend({processBlock:function(n,s){var a=this._cipher,o=a.blockSize,i=n.slice(s,s+o);r.call(this,n,s,o,a),this._prevBlock=i}});function r(n,s,a,o){var i=this._iv;if(i){var h=i.slice(0);this._iv=void 0}else var h=this._prevBlock;o.encryptBlock(h,0);for(var l=0;l<a;l++)n[s+l]^=h[l]}return t}(),e.mode.CFB})});var Oa=z((qn,Ta)=>{O();j();(function(e,t,r){typeof qn=="object"?Ta.exports=qn=t(le(),Le()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(qn,function(e){return e.mode.CTR=function(){var t=e.lib.BlockCipherMode.extend(),r=t.Encryptor=t.extend({processBlock:function(n,s){var a=this._cipher,o=a.blockSize,i=this._iv,h=this._counter;i&&(h=this._counter=i.slice(0),this._iv=void 0);var l=h.slice(0);a.encryptBlock(l,0),h[o-1]=h[o-1]+1|0;for(var d=0;d<o;d++)n[s+d]^=l[d]}});return t.Decryptor=r,t}(),e.mode.CTR})});var qa=z((Kn,ja)=>{O();j();(function(e,t,r){typeof Kn=="object"?ja.exports=Kn=t(le(),Le()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(Kn,function(e){return e.mode.CTRGladman=function(){var t=e.lib.BlockCipherMode.extend();function r(a){if((a>>24&255)===255){var o=a>>16&255,i=a>>8&255,h=a&255;o===255?(o=0,i===255?(i=0,h===255?h=0:++h):++i):++o,a=0,a+=o<<16,a+=i<<8,a+=h}else a+=1<<24;return a}function n(a){return(a[0]=r(a[0]))===0&&(a[1]=r(a[1])),a}var s=t.Encryptor=t.extend({processBlock:function(a,o){var i=this._cipher,h=i.blockSize,l=this._iv,d=this._counter;l&&(d=this._counter=l.slice(0),this._iv=void 0),n(d);var p=d.slice(0);i.encryptBlock(p,0);for(var u=0;u<h;u++)a[o+u]^=p[u]}});return t.Decryptor=s,t}(),e.mode.CTRGladman})});var ka=z((kn,Ka)=>{O();j();(function(e,t,r){typeof kn=="object"?Ka.exports=kn=t(le(),Le()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(kn,function(e){return e.mode.OFB=function(){var t=e.lib.BlockCipherMode.extend(),r=t.Encryptor=t.extend({processBlock:function(n,s){var a=this._cipher,o=a.blockSize,i=this._iv,h=this._keystream;i&&(h=this._keystream=i.slice(0),this._iv=void 0),a.encryptBlock(h,0);for(var l=0;l<o;l++)n[s+l]^=h[l]}});return t.Decryptor=r,t}(),e.mode.OFB})});var Va=z((Mn,Ma)=>{O();j();(function(e,t,r){typeof Mn=="object"?Ma.exports=Mn=t(le(),Le()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(Mn,function(e){return e.mode.ECB=function(){var t=e.lib.BlockCipherMode.extend();return t.Encryptor=t.extend({processBlock:function(r,n){this._cipher.encryptBlock(r,n)}}),t.Decryptor=t.extend({processBlock:function(r,n){this._cipher.decryptBlock(r,n)}}),t}(),e.mode.ECB})});var Ua=z((Vn,La)=>{O();j();(function(e,t,r){typeof Vn=="object"?La.exports=Vn=t(le(),Le()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(Vn,function(e){return e.pad.AnsiX923={pad:function(t,r){var n=t.sigBytes,s=r*4,a=s-n%s,o=n+a-1;t.clamp(),t.words[o>>>2]|=a<<24-o%4*8,t.sigBytes+=a},unpad:function(t){var r=t.words[t.sigBytes-1>>>2]&255;t.sigBytes-=r}},e.pad.Ansix923})});var Wa=z((Ln,za)=>{O();j();(function(e,t,r){typeof Ln=="object"?za.exports=Ln=t(le(),Le()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(Ln,function(e){return e.pad.Iso10126={pad:function(t,r){var n=r*4,s=n-t.sigBytes%n;t.concat(e.lib.WordArray.random(s-1)).concat(e.lib.WordArray.create([s<<24],1))},unpad:function(t){var r=t.words[t.sigBytes-1>>>2]&255;t.sigBytes-=r}},e.pad.Iso10126})});var Xa=z((Un,Ga)=>{O();j();(function(e,t,r){typeof Un=="object"?Ga.exports=Un=t(le(),Le()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(Un,function(e){return e.pad.Iso97971={pad:function(t,r){t.concat(e.lib.WordArray.create([2147483648],1)),e.pad.ZeroPadding.pad(t,r)},unpad:function(t){e.pad.ZeroPadding.unpad(t),t.sigBytes--}},e.pad.Iso97971})});var Ya=z((zn,Ja)=>{O();j();(function(e,t,r){typeof zn=="object"?Ja.exports=zn=t(le(),Le()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(zn,function(e){return e.pad.ZeroPadding={pad:function(t,r){var n=r*4;t.clamp(),t.sigBytes+=n-(t.sigBytes%n||n)},unpad:function(t){for(var r=t.words,n=t.sigBytes-1;!(r[n>>>2]>>>24-n%4*8&255);)n--;t.sigBytes=n+1}},e.pad.ZeroPadding})});var Za=z((Wn,$a)=>{O();j();(function(e,t,r){typeof Wn=="object"?$a.exports=Wn=t(le(),Le()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(Wn,function(e){return e.pad.NoPadding={pad:function(){},unpad:function(){}},e.pad.NoPadding})});var eo=z((Gn,Qa)=>{O();j();(function(e,t,r){typeof Gn=="object"?Qa.exports=Gn=t(le(),Le()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(Gn,function(e){return function(t){var r=e,n=r.lib,s=n.CipherParams,a=r.enc,o=a.Hex,i=r.format,h=i.Hex={stringify:function(l){return l.ciphertext.toString(o)},parse:function(l){var d=o.parse(l);return s.create({ciphertext:d})}}}(),e.format.Hex})});var ro=z((Xn,to)=>{O();j();(function(e,t,r){typeof Xn=="object"?to.exports=Xn=t(le(),Qt(),er(),Ut(),Le()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],t):t(e.CryptoJS)})(Xn,function(e){return function(){var t=e,r=t.lib,n=r.BlockCipher,s=t.algo,a=[],o=[],i=[],h=[],l=[],d=[],p=[],u=[],c=[],x=[];(function(){for(var y=[],m=0;m<256;m++)m<128?y[m]=m<<1:y[m]=m<<1^283;for(var b=0,E=0,m=0;m<256;m++){var P=E^E<<1^E<<2^E<<3^E<<4;P=P>>>8^P&255^99,a[b]=P,o[P]=b;var F=y[b],D=y[F],S=y[D],w=y[P]*257^P*16843008;i[b]=w<<24|w>>>8,h[b]=w<<16|w>>>16,l[b]=w<<8|w>>>24,d[b]=w;var w=S*16843009^D*65537^F*257^b*16843008;p[P]=w<<24|w>>>8,u[P]=w<<16|w>>>16,c[P]=w<<8|w>>>24,x[P]=w,b?(b=F^y[y[y[S^F]]],E^=y[y[E]]):b=E=1}})();var f=[0,1,2,4,8,16,32,64,128,27,54],v=s.AES=n.extend({_doReset:function(){if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var y=this._keyPriorReset=this._key,m=y.words,b=y.sigBytes/4,E=this._nRounds=b+6,P=(E+1)*4,F=this._keySchedule=[],D=0;D<P;D++)if(D<b)F[D]=m[D];else{var S=F[D-1];D%b?b>6&&D%b==4&&(S=a[S>>>24]<<24|a[S>>>16&255]<<16|a[S>>>8&255]<<8|a[S&255]):(S=S<<8|S>>>24,S=a[S>>>24]<<24|a[S>>>16&255]<<16|a[S>>>8&255]<<8|a[S&255],S^=f[D/b|0]<<24),F[D]=F[D-b]^S}for(var w=this._invKeySchedule=[],C=0;C<P;C++){var D=P-C;if(C%4)var S=F[D];else var S=F[D-4];C<4||D<=4?w[C]=S:w[C]=p[a[S>>>24]]^u[a[S>>>16&255]]^c[a[S>>>8&255]]^x[a[S&255]]}}},encryptBlock:function(y,m){this._doCryptBlock(y,m,this._keySchedule,i,h,l,d,a)},decryptBlock:function(y,m){var b=y[m+1];y[m+1]=y[m+3],y[m+3]=b,this._doCryptBlock(y,m,this._invKeySchedule,p,u,c,x,o);var b=y[m+1];y[m+1]=y[m+3],y[m+3]=b},_doCryptBlock:function(y,m,b,E,P,F,D,S){for(var w=this._nRounds,C=y[m]^b[0],A=y[m+1]^b[1],B=y[m+2]^b[2],R=y[m+3]^b[3],_=4,I=1;I<w;I++){var N=E[C>>>24]^P[A>>>16&255]^F[B>>>8&255]^D[R&255]^b[_++],K=E[A>>>24]^P[B>>>16&255]^F[R>>>8&255]^D[C&255]^b[_++],L=E[B>>>24]^P[R>>>16&255]^F[C>>>8&255]^D[A&255]^b[_++],H=E[R>>>24]^P[C>>>16&255]^F[A>>>8&255]^D[B&255]^b[_++];C=N,A=K,B=L,R=H}var N=(S[C>>>24]<<24|S[A>>>16&255]<<16|S[B>>>8&255]<<8|S[R&255])^b[_++],K=(S[A>>>24]<<24|S[B>>>16&255]<<16|S[R>>>8&255]<<8|S[C&255])^b[_++],L=(S[B>>>24]<<24|S[R>>>16&255]<<16|S[C>>>8&255]<<8|S[A&255])^b[_++],H=(S[R>>>24]<<24|S[C>>>16&255]<<16|S[A>>>8&255]<<8|S[B&255])^b[_++];y[m]=N,y[m+1]=K,y[m+2]=L,y[m+3]=H},keySize:256/32});t.AES=n._createHelper(v)}(),e.AES})});var io=z((Jn,no)=>{O();j();(function(e,t,r){typeof Jn=="object"?no.exports=Jn=t(le(),Qt(),er(),Ut(),Le()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],t):t(e.CryptoJS)})(Jn,function(e){return function(){var t=e,r=t.lib,n=r.WordArray,s=r.BlockCipher,a=t.algo,o=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],i=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],h=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],l=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],d=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],p=a.DES=s.extend({_doReset:function(){for(var f=this._key,v=f.words,y=[],m=0;m<56;m++){var b=o[m]-1;y[m]=v[b>>>5]>>>31-b%32&1}for(var E=this._subKeys=[],P=0;P<16;P++){for(var F=E[P]=[],D=h[P],m=0;m<24;m++)F[m/6|0]|=y[(i[m]-1+D)%28]<<31-m%6,F[4+(m/6|0)]|=y[28+(i[m+24]-1+D)%28]<<31-m%6;F[0]=F[0]<<1|F[0]>>>31;for(var m=1;m<7;m++)F[m]=F[m]>>>(m-1)*4+3;F[7]=F[7]<<5|F[7]>>>27}for(var S=this._invSubKeys=[],m=0;m<16;m++)S[m]=E[15-m]},encryptBlock:function(f,v){this._doCryptBlock(f,v,this._subKeys)},decryptBlock:function(f,v){this._doCryptBlock(f,v,this._invSubKeys)},_doCryptBlock:function(f,v,y){this._lBlock=f[v],this._rBlock=f[v+1],u.call(this,4,252645135),u.call(this,16,65535),c.call(this,2,858993459),c.call(this,8,16711935),u.call(this,1,1431655765);for(var m=0;m<16;m++){for(var b=y[m],E=this._lBlock,P=this._rBlock,F=0,D=0;D<8;D++)F|=l[D][((P^b[D])&d[D])>>>0];this._lBlock=P,this._rBlock=E^F}var S=this._lBlock;this._lBlock=this._rBlock,this._rBlock=S,u.call(this,1,1431655765),c.call(this,8,16711935),c.call(this,2,858993459),u.call(this,16,65535),u.call(this,4,252645135),f[v]=this._lBlock,f[v+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function u(f,v){var y=(this._lBlock>>>f^this._rBlock)&v;this._rBlock^=y,this._lBlock^=y<<f}function c(f,v){var y=(this._rBlock>>>f^this._lBlock)&v;this._lBlock^=y,this._rBlock^=y<<f}t.DES=s._createHelper(p);var x=a.TripleDES=s.extend({_doReset:function(){var f=this._key,v=f.words;this._des1=p.createEncryptor(n.create(v.slice(0,2))),this._des2=p.createEncryptor(n.create(v.slice(2,4))),this._des3=p.createEncryptor(n.create(v.slice(4,6)))},encryptBlock:function(f,v){this._des1.encryptBlock(f,v),this._des2.decryptBlock(f,v),this._des3.encryptBlock(f,v)},decryptBlock:function(f,v){this._des3.decryptBlock(f,v),this._des2.encryptBlock(f,v),this._des1.decryptBlock(f,v)},keySize:192/32,ivSize:64/32,blockSize:64/32});t.TripleDES=s._createHelper(x)}(),e.TripleDES})});var ao=z((Yn,so)=>{O();j();(function(e,t,r){typeof Yn=="object"?so.exports=Yn=t(le(),Qt(),er(),Ut(),Le()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],t):t(e.CryptoJS)})(Yn,function(e){return function(){var t=e,r=t.lib,n=r.StreamCipher,s=t.algo,a=s.RC4=n.extend({_doReset:function(){for(var h=this._key,l=h.words,d=h.sigBytes,p=this._S=[],u=0;u<256;u++)p[u]=u;for(var u=0,c=0;u<256;u++){var x=u%d,f=l[x>>>2]>>>24-x%4*8&255;c=(c+p[u]+f)%256;var v=p[u];p[u]=p[c],p[c]=v}this._i=this._j=0},_doProcessBlock:function(h,l){h[l]^=o.call(this)},keySize:256/32,ivSize:0});function o(){for(var h=this._S,l=this._i,d=this._j,p=0,u=0;u<4;u++){l=(l+1)%256,d=(d+h[l])%256;var c=h[l];h[l]=h[d],h[d]=c,p|=h[(h[l]+h[d])%256]<<24-u*8}return this._i=l,this._j=d,p}t.RC4=n._createHelper(a);var i=s.RC4Drop=a.extend({cfg:a.cfg.extend({drop:192}),_doReset:function(){a._doReset.call(this);for(var h=this.cfg.drop;h>0;h--)o.call(this)}});t.RC4Drop=n._createHelper(i)}(),e.RC4})});var uo=z(($n,oo)=>{O();j();(function(e,t,r){typeof $n=="object"?oo.exports=$n=t(le(),Qt(),er(),Ut(),Le()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],t):t(e.CryptoJS)})($n,function(e){return function(){var t=e,r=t.lib,n=r.StreamCipher,s=t.algo,a=[],o=[],i=[],h=s.Rabbit=n.extend({_doReset:function(){for(var d=this._key.words,p=this.cfg.iv,u=0;u<4;u++)d[u]=(d[u]<<8|d[u]>>>24)&16711935|(d[u]<<24|d[u]>>>8)&4278255360;var c=this._X=[d[0],d[3]<<16|d[2]>>>16,d[1],d[0]<<16|d[3]>>>16,d[2],d[1]<<16|d[0]>>>16,d[3],d[2]<<16|d[1]>>>16],x=this._C=[d[2]<<16|d[2]>>>16,d[0]&4294901760|d[1]&65535,d[3]<<16|d[3]>>>16,d[1]&4294901760|d[2]&65535,d[0]<<16|d[0]>>>16,d[2]&4294901760|d[3]&65535,d[1]<<16|d[1]>>>16,d[3]&4294901760|d[0]&65535];this._b=0;for(var u=0;u<4;u++)l.call(this);for(var u=0;u<8;u++)x[u]^=c[u+4&7];if(p){var f=p.words,v=f[0],y=f[1],m=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360,b=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,E=m>>>16|b&4294901760,P=b<<16|m&65535;x[0]^=m,x[1]^=E,x[2]^=b,x[3]^=P,x[4]^=m,x[5]^=E,x[6]^=b,x[7]^=P;for(var u=0;u<4;u++)l.call(this)}},_doProcessBlock:function(d,p){var u=this._X;l.call(this),a[0]=u[0]^u[5]>>>16^u[3]<<16,a[1]=u[2]^u[7]>>>16^u[5]<<16,a[2]=u[4]^u[1]>>>16^u[7]<<16,a[3]=u[6]^u[3]>>>16^u[1]<<16;for(var c=0;c<4;c++)a[c]=(a[c]<<8|a[c]>>>24)&16711935|(a[c]<<24|a[c]>>>8)&4278255360,d[p+c]^=a[c]},blockSize:128/32,ivSize:64/32});function l(){for(var d=this._X,p=this._C,u=0;u<8;u++)o[u]=p[u];p[0]=p[0]+1295307597+this._b|0,p[1]=p[1]+3545052371+(p[0]>>>0<o[0]>>>0?1:0)|0,p[2]=p[2]+886263092+(p[1]>>>0<o[1]>>>0?1:0)|0,p[3]=p[3]+1295307597+(p[2]>>>0<o[2]>>>0?1:0)|0,p[4]=p[4]+3545052371+(p[3]>>>0<o[3]>>>0?1:0)|0,p[5]=p[5]+886263092+(p[4]>>>0<o[4]>>>0?1:0)|0,p[6]=p[6]+1295307597+(p[5]>>>0<o[5]>>>0?1:0)|0,p[7]=p[7]+3545052371+(p[6]>>>0<o[6]>>>0?1:0)|0,this._b=p[7]>>>0<o[7]>>>0?1:0;for(var u=0;u<8;u++){var c=d[u]+p[u],x=c&65535,f=c>>>16,v=((x*x>>>17)+x*f>>>15)+f*f,y=((c&4294901760)*c|0)+((c&65535)*c|0);i[u]=v^y}d[0]=i[0]+(i[7]<<16|i[7]>>>16)+(i[6]<<16|i[6]>>>16)|0,d[1]=i[1]+(i[0]<<8|i[0]>>>24)+i[7]|0,d[2]=i[2]+(i[1]<<16|i[1]>>>16)+(i[0]<<16|i[0]>>>16)|0,d[3]=i[3]+(i[2]<<8|i[2]>>>24)+i[1]|0,d[4]=i[4]+(i[3]<<16|i[3]>>>16)+(i[2]<<16|i[2]>>>16)|0,d[5]=i[5]+(i[4]<<8|i[4]>>>24)+i[3]|0,d[6]=i[6]+(i[5]<<16|i[5]>>>16)+(i[4]<<16|i[4]>>>16)|0,d[7]=i[7]+(i[6]<<8|i[6]>>>24)+i[5]|0}t.Rabbit=n._createHelper(h)}(),e.Rabbit})});var co=z((Zn,fo)=>{O();j();(function(e,t,r){typeof Zn=="object"?fo.exports=Zn=t(le(),Qt(),er(),Ut(),Le()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],t):t(e.CryptoJS)})(Zn,function(e){return function(){var t=e,r=t.lib,n=r.StreamCipher,s=t.algo,a=[],o=[],i=[],h=s.RabbitLegacy=n.extend({_doReset:function(){var d=this._key.words,p=this.cfg.iv,u=this._X=[d[0],d[3]<<16|d[2]>>>16,d[1],d[0]<<16|d[3]>>>16,d[2],d[1]<<16|d[0]>>>16,d[3],d[2]<<16|d[1]>>>16],c=this._C=[d[2]<<16|d[2]>>>16,d[0]&4294901760|d[1]&65535,d[3]<<16|d[3]>>>16,d[1]&4294901760|d[2]&65535,d[0]<<16|d[0]>>>16,d[2]&4294901760|d[3]&65535,d[1]<<16|d[1]>>>16,d[3]&4294901760|d[0]&65535];this._b=0;for(var x=0;x<4;x++)l.call(this);for(var x=0;x<8;x++)c[x]^=u[x+4&7];if(p){var f=p.words,v=f[0],y=f[1],m=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360,b=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,E=m>>>16|b&4294901760,P=b<<16|m&65535;c[0]^=m,c[1]^=E,c[2]^=b,c[3]^=P,c[4]^=m,c[5]^=E,c[6]^=b,c[7]^=P;for(var x=0;x<4;x++)l.call(this)}},_doProcessBlock:function(d,p){var u=this._X;l.call(this),a[0]=u[0]^u[5]>>>16^u[3]<<16,a[1]=u[2]^u[7]>>>16^u[5]<<16,a[2]=u[4]^u[1]>>>16^u[7]<<16,a[3]=u[6]^u[3]>>>16^u[1]<<16;for(var c=0;c<4;c++)a[c]=(a[c]<<8|a[c]>>>24)&16711935|(a[c]<<24|a[c]>>>8)&4278255360,d[p+c]^=a[c]},blockSize:128/32,ivSize:64/32});function l(){for(var d=this._X,p=this._C,u=0;u<8;u++)o[u]=p[u];p[0]=p[0]+1295307597+this._b|0,p[1]=p[1]+3545052371+(p[0]>>>0<o[0]>>>0?1:0)|0,p[2]=p[2]+886263092+(p[1]>>>0<o[1]>>>0?1:0)|0,p[3]=p[3]+1295307597+(p[2]>>>0<o[2]>>>0?1:0)|0,p[4]=p[4]+3545052371+(p[3]>>>0<o[3]>>>0?1:0)|0,p[5]=p[5]+886263092+(p[4]>>>0<o[4]>>>0?1:0)|0,p[6]=p[6]+1295307597+(p[5]>>>0<o[5]>>>0?1:0)|0,p[7]=p[7]+3545052371+(p[6]>>>0<o[6]>>>0?1:0)|0,this._b=p[7]>>>0<o[7]>>>0?1:0;for(var u=0;u<8;u++){var c=d[u]+p[u],x=c&65535,f=c>>>16,v=((x*x>>>17)+x*f>>>15)+f*f,y=((c&4294901760)*c|0)+((c&65535)*c|0);i[u]=v^y}d[0]=i[0]+(i[7]<<16|i[7]>>>16)+(i[6]<<16|i[6]>>>16)|0,d[1]=i[1]+(i[0]<<8|i[0]>>>24)+i[7]|0,d[2]=i[2]+(i[1]<<16|i[1]>>>16)+(i[0]<<16|i[0]>>>16)|0,d[3]=i[3]+(i[2]<<8|i[2]>>>24)+i[1]|0,d[4]=i[4]+(i[3]<<16|i[3]>>>16)+(i[2]<<16|i[2]>>>16)|0,d[5]=i[5]+(i[4]<<8|i[4]>>>24)+i[3]|0,d[6]=i[6]+(i[5]<<16|i[5]>>>16)+(i[4]<<16|i[4]>>>16)|0,d[7]=i[7]+(i[6]<<8|i[6]>>>24)+i[5]|0}t.RabbitLegacy=n._createHelper(h)}(),e.RabbitLegacy})});var es=z((Qn,ho)=>{O();j();(function(e,t,r){typeof Qn=="object"?ho.exports=Qn=t(le(),Wr(),la(),va(),Qt(),er(),An(),Z0(),Sa(),Q0(),Ea(),Aa(),Ca(),Nn(),Da(),Ut(),Le(),Ha(),Oa(),qa(),ka(),Va(),Ua(),Wa(),Xa(),Ya(),Za(),eo(),ro(),io(),ao(),uo(),co()):typeof define=="function"&&define.amd?define(["./core","./x64-core","./lib-typedarrays","./enc-utf16","./enc-base64","./md5","./sha1","./sha256","./sha224","./sha512","./sha384","./sha3","./ripemd160","./hmac","./pbkdf2","./evpkdf","./cipher-core","./mode-cfb","./mode-ctr","./mode-ctr-gladman","./mode-ofb","./mode-ecb","./pad-ansix923","./pad-iso10126","./pad-iso97971","./pad-zeropadding","./pad-nopadding","./format-hex","./aes","./tripledes","./rc4","./rabbit","./rabbit-legacy"],t):e.CryptoJS=t(e.CryptoJS)})(Qn,function(e){return e})});var ht=z(Oe=>{"use strict";O();j();var rh=Oe&&Oe.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),nh=Oe&&Oe.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),ih=Oe&&Oe.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&rh(t,e,r);return nh(t,e),t};Object.defineProperty(Oe,"__esModule",{value:!0});Oe.cvtBigintToUint8arrayNoPadding=Oe.cvtBigintToUint8array=Oe.cvtUint8arrayToBigint=Oe.randomSafePrime=Oe.RandomNum=Oe.HmacSHA512Int=Oe.SHA256Int=void 0;var sh=Ee(),ei=Ee(),lo=Ee(),ts=ih(es());function ah(e){let t=lo.base.sha256.create();for(let r of e){if(r<BigInt(0))throw new Error(`Cannot convert negative bigint to buffer. Given: ${r}`);let n=r.toString(16);n.length%2&&(n="0"+n),t.update(V.Buffer.from(n,"hex"))}return(0,sh.bufToBigint)(t.digest())}Oe.SHA256Int=ah;function oh(e){return e.length%2!==0&&(e="0"+e),e}function uh(e){let n=e.map(a=>oh(new lo.BN(a.toString()).toString(16))).map(a=>ts.enc.Hex.parse(a)).reduce((a,o)=>a.concat(o)),s=ts.HmacSHA512(n,"");return BigInt(`0x${ts.enc.Hex.stringify(s)}`)}Oe.HmacSHA512Int=uh;function fh(e){let t=BigInt(1),r=BigInt(2);if(e<=r)throw new Error("max has to be greater than two");return(0,ei.randBetween)(e-t,r)}Oe.RandomNum=fh;async function ch(e){let t=8*e-1;for(;;){let r=await(0,ei.prime)(t);for(;r<BigInt(3)<<BigInt(t-2);)r=await(0,ei.prime)(t);let n=2n*r+1n;if(await(0,ei.isProbablyPrime)(n))return n}}Oe.randomSafePrime=ch;function hh(e){let t=BigInt(0);for(let r=0;r<e.length;r++)t=t*BigInt(256)+BigInt(e[r]);return t}Oe.cvtUint8arrayToBigint=hh;function lh(e){let t=new Uint8Array(32),r=t.length-1;for(;e>0&&r>=0;)t[r]=Number(e%BigInt(256)),e=e/BigInt(256),r--;return t}Oe.cvtBigintToUint8array=lh;function dh(e){let t=[];for(;e>0n;){let n=Number(e%256n);t.push(n),e/=256n}return new Uint8Array(t).reverse()}Oe.cvtBigintToUint8arrayNoPadding=dh});var vo=z(Gr=>{"use strict";O();j();Object.defineProperty(Gr,"__esModule",{value:!0});Gr.Commitment=void 0;var rs=ht(),vh;(function(e){function t(s){let a=(0,rs.RandomNum)(2n**256n);return s.unshift(a),{C:(0,rs.HmacSHA512Int)(s.slice()),Msg:s}}e.NewCommitment=t;function r(s){return n(s)?s.Msg.slice(1):null}e.Open=r;function n(s){let a=(0,rs.HmacSHA512Int)(s.Msg);return s.C==a}e.Verify=n})(vh=Gr.Commitment||(Gr.Commitment={}))});var Ft=z(ve=>{"use strict";O();j();Object.defineProperty(ve,"__esModule",{value:!0});ve.GenRSAKeyPairError=ve.DecodeRsaPublicKeyError=ve.DecodeRSAPrivateKeyError=ve.RSADecodeError=ve.RSAEncodeError=ve.AESDecryptError=ve.AESEncryptError=ve.Bip32DeriveError=ve.Bip32NewChildKeyError=ve.CommitmentDeCommitfail=ve.SchnorrVerifyFail=ve.SchnorrVerifyError=ve.SchnorrProveError=ve.CreatPailKeyError=ve.MPCError=void 0;var ns=class extends Error{constructor(t,r){super(r.toString()),this.name=t}};ve.MPCError=ns;var ph="create paillier key error";ve.CreatPailKeyError=ph;var xh="schnorr prove error";ve.SchnorrProveError=xh;var gh="schnorr verify error";ve.SchnorrVerifyError=gh;var yh="schnorr verify fail";ve.SchnorrVerifyFail=yh;var mh="commitment DeCommit fail";ve.CommitmentDeCommitfail=mh;var Sh="bip32 new child key error";ve.Bip32NewChildKeyError=Sh;var bh="bip32 derive error";ve.Bip32DeriveError=bh;var wh="aes encrypt error";ve.AESEncryptError=wh;var Eh="aes decrypt error";ve.AESDecryptError=Eh;var Ph="rsa encode error";ve.RSAEncodeError=Ph;var Ah="rsa decode error";ve.RSADecodeError=Ah;var Fh="decode rsa private key error";ve.DecodeRSAPrivateKeyError=Fh;var Ch="decode rsa public key error";ve.DecodeRsaPublicKeyError=Ch;var _h="gen rsa key pair error";ve.GenRSAKeyPairError=_h});var go=z(zt=>{"use strict";O();j();Object.defineProperty(zt,"__esModule",{value:!0});zt.createPailKeyPair=zt.PailPrivKey=zt.PailPubKey=void 0;var is=ht(),wt=Ee(),po=Ft(),ti=class{constructor(t){this.n=t}n2(){return this.n.sqr()}g(){return this.n.addn(1)}encryptWithR(t,r){let n=this.n2(),s=wt.BN.red(n),a=r.toRed(s),o=this.n.toRed(s).redMul(t.toRed(s)).addn(1),i=a.redPow(this.n);return o.redMul(i).fromRed()}encrypt(t){let r=BigInt(this.n.toString());for(;;){let n=new wt.BN((0,is.RandomNum)(r).toString());if(n.gcd(this.n).eqn(1))return this.encryptWithR(t,n)}}HomoAdd(t,r){let n=wt.BN.red(this.n2());return t.toRed(n).redMul(r.toRed(n)).fromRed()}homomorphicAddPlain(t,r){let n=wt.BN.red(this.n2()),s=this.n.toRed(n).redMul(r.toRed(n)).addn(1);return t.toRed(n).redMul(s).fromRed()}homomorphicMulPlain(t,r){let n=wt.BN.red(this.n2());return t.toRed(n).redPow(r).fromRed()}};zt.PailPubKey=ti;var ri=class{constructor(t,r){this.lambda=t,this.pailPubKey=r}decrypt(t){let r=this.pailPubKey.n2(),n=this.pailPubKey.n,s=this.pailPubKey.g(),a=t.toRed(wt.BN.red(r)).redPow(this.lambda),o=xo(a.fromRed(),n),i=s.toRed(wt.BN.red(r)).redPow(this.lambda),l=xo(i.fromRed(),n).toRed(wt.BN.red(n)).redInvm();return o.mul(l).mod(n)}};zt.PailPrivKey=ri;function xo(e,t){return e.subn(1).div(t)}async function Bh(e){try{let t=0n,r=0n;for(;t==r;)t=await(0,is.randomSafePrime)(e/2),r=await(0,is.randomSafePrime)(e/2);if(t<r){let d=t;t=r,r=d}let n=t*r,s=t-1n,a=r-1n,o=s*a,i=(0,wt.eGcd)(s,a).g,h=o/i,l=new ti(new wt.BN(n.toString()));return[new ri(new wt.BN(h.toString()),l),l]}catch(t){return Promise.reject(new po.MPCError(po.CreatPailKeyError,t))}}zt.createPailKeyPair=Bh});var ss=z(Et=>{"use strict";O();j();var Dh=Et&&Et.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Ih=Et&&Et.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Rh=Et&&Et.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Dh(t,e,r);return Ih(t,e),t};Object.defineProperty(Et,"__esModule",{value:!0});Et.polynomial=void 0;var yo=Rh(Ee()),Nh;(function(e){async function t(a,o,i){let h=new Array(i+1);h[0]=o;for(let l=1;l<=i;l++){let d=await yo.prime(a.toString(2).length);h[l]=d}return{coefficients:h,qMod:a}}e.initPolynomial=t;function r(a,o){let i=a.coefficients[0],h=0n;for(let d=1;d<a.coefficients.length;d++)h*=o,i+=h*a.coefficients[d];let l=a.qMod;return i=(i%l+l)%l,{id:o,y:i}}e.evaluatePolynomial=r;function n(a,o){let i=new Array(o.length);for(let l in o)i[l]=o[l].id;let h=0n;for(let l of o)h+=s(a,l.id,l.y,i);return h=(h%a+a)%a,h}e.recoverSecret=n;function s(a,o,i,h){let l=i;for(let d=0;d<h.length;d++){let p=h[d];if(p===o)continue;let u=p-o;u=yo.modInv(u,a),u*=p,l*=u}return l=(l%a+a)%a,l}e.calLagrangian=s})(Nh=Et.polynomial||(Et.polynomial={}))});var So=z(ii=>{"use strict";O();j();Object.defineProperty(ii,"__esModule",{value:!0});ii.Feldman=void 0;var mo=ss(),ni=Ee(),as=class{constructor(t,r,n){if(!Number.isInteger(t))throw new Error("Expect integer threshold");if(t<2)throw new Error("Expect threshold >= 2");if(this.threshold=t,!Number.isInteger(r))throw new Error("Expect integer limit");if(r<t)throw new Error("Expect limit >= threshold");if(this.limit=r,n=="ed25519")this.primeOrder=ni.ed25519.CURVE.n;else if(n=="secp256k1")this.primeOrder=ni.secp256k1.CURVE.n;else throw new Error("Expect ed25519 or secp256k1 curve");this.curve=n}async evaluate(t){let r=await mo.polynomial.initPolynomial(this.primeOrder,t,this.threshold-1),n=new Array(this.limit);for(let a=1;a<=this.limit;a++){let o=BigInt(a);n[a-1]=mo.polynomial.evaluatePolynomial(r,o)}let s=new Array(r.coefficients.length);for(let a in r.coefficients)s[a]=await ni.ed25519.Point.fromPrivateKey(r.coefficients[a]);return{verifiers:s,shares:n}}async verify(t,r){if(r.length<this.threshold)throw new Error("not enough number of verifiers");let n=await ni.ed25519.Point.fromPrivateKey(t.y),s=1n,a=r[0];for(let o=1;o<=r.length;o++){s*=t.id;let i=r[o].multiply(s);a=a.add(i)}return n===a}};ii.Feldman=as});var Xr=z(Tt=>{"use strict";O();j();Object.defineProperty(Tt,"__esModule",{value:!0});Tt.Signature=Tt.ECPoint=Tt.CurveName=void 0;var vr=Ee(),bo=ht(),si;(function(e){e.Secp256k1="secp256k1",e.Ed25519="ed25519"})(si=Tt.CurveName||(Tt.CurveName={}));var pr=class{constructor(t,r,n){this.Curve=t,this.X=r,this.Y=n}toHex(){return this.Curve===si.Secp256k1?this.toEcdsaPoint().toHex(!0):this.toEd25519Point().toHex()}toEcdsaPoint(){return new vr.secp256k1.Point(this.X,this.Y)}toEd25519Point(){return new vr.ed25519.Point(this.X,this.Y)}static fromEcdsaPoint(t){return new pr(si.Secp256k1.toString(),t.x,t.y)}static fromEd25519Point(t){return new pr(si.Ed25519.toString(),t.x,t.y)}};Tt.ECPoint=pr;var xr=class{constructor(t,r){this.r=t,this.s=r}toEcdsaSignature(){return new vr.secp256k1.Signature(this.r,this.s)}toEd25519Signature(){let t=new Uint8Array((0,bo.cvtBigintToUint8array)(this.r)).reverse(),r=vr.ed25519.Point.fromHex(vr.ed25519.utils.bytesToHex(t));return new vr.ed25519.Signature(r,this.s)}static fromEcdsaSignature(t){return new xr(t.r,t.s)}static fromEd25519Signature(t){let r=new Uint8Array(t.r.toRawBytes()).reverse(),n=(0,bo.cvtUint8arrayToBigint)(r);return new xr(n,t.s)}};Tt.Signature=xr});var us=z(Wt=>{"use strict";O();j();Object.defineProperty(Wt,"__esModule",{value:!0});Wt.verify=Wt.prove=Wt.Proof=void 0;var wo=Xr(),os=ht(),tr=Ee(),ai=Ft(),oi=class{constructor(t,r){this.R=t,this.S=r}};Wt.Proof=oi;async function Hh(e,t,r){try{let n=tr.secp256k1.CURVE.n,s=(0,os.RandomNum)(n),a=tr.secp256k1.Point.fromPrivateKey(s),o=tr.secp256k1.Point.fromPrivateKey(BigInt(1)),i=(0,os.SHA256Int)([e,o.x,o.y,r.x,r.y,a.x,a.y])%n,h=(s+i*t)%n;return new oi(new wo.ECPoint(wo.CurveName.Secp256k1,a.x,a.y),h)}catch(n){return Promise.reject(new ai.MPCError(ai.SchnorrProveError,n))}}Wt.prove=Hh;function Th(e,t,r){try{let n=new tr.secp256k1.Point(t.R.X,t.R.Y),s=tr.secp256k1.CURVE.n,a=tr.secp256k1.Point.fromPrivateKey(BigInt(1)),o=(0,os.SHA256Int)([e,a.x,a.y,r.x,r.y,n.x,n.y])%s,i=tr.secp256k1.Point.fromPrivateKey(BigInt(t.S.toString(10))),h=r.multiply(o);return n.add(h).equals(i)}catch(n){throw new ai.MPCError(ai.SchnorrVerifyError,n)}}Wt.verify=Th});var cs=z(Ct=>{"use strict";O();j();Object.defineProperty(Ct,"__esModule",{value:!0});Ct.verify=Ct.prove=Ct.Proof=Ct.Ed25519Point=void 0;var fs=ht(),Jr=Ee(),ui=Xr(),fi=Ft(),ci=class{constructor(t,r,n){this.Curve=t,this.X=r,this.Y=n}};Ct.Ed25519Point=ci;var gr=class{constructor(t,r){this.R=t,this.S=r}JsonStringify(){let t=new ci("ed25519",this.R.X,this.R.Y);return JSON.stringify({R:t,S:this.S},(r,n)=>typeof n=="bigint"?n.toString():n)}static JsonParse(t){let r=JSON.parse(t),n=new ui.ECPoint(ui.CurveName.Ed25519.toString(),BigInt(r.R.X),BigInt(r.R.Y));return new gr(n,r.S)}};Ct.Proof=gr;async function Oh(e,t){try{let r=Jr.ed25519.CURVE.n,n=(0,fs.RandomNum)(r),s=BigInt(n.toString()),a=Jr.ed25519.Point.BASE.multiply(BigInt(n.toString())),o=(0,fs.SHA256Int)([t.x,t.y,a.x,a.y])%r,i=(s+o*e)%r;return new gr(new ui.ECPoint(ui.CurveName.Ed25519,a.x,a.y),i)}catch(r){return Promise.reject(new fi.MPCError(fi.SchnorrProveError,r))}}Ct.prove=Oh;function jh(e,t){try{let r=new Jr.ed25519.Point(e.R.X,e.R.Y),n=Jr.ed25519.CURVE.n,s=(0,fs.SHA256Int)([t.x,t.y,r.x,r.y])%n,a=BigInt(e.S.toString())%n,o=Jr.ed25519.Point.BASE.multiply(a),i=t.multiply(s);return r.add(i).equals(o)}catch(r){throw new fi.MPCError(fi.SchnorrVerifyError,r)}}Ct.verify=jh});var yr=z(ke=>{"use strict";O();j();var Eo=ke&&ke.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),qh=ke&&ke.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Yr=ke&&ke.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&Eo(t,e,r)},Po=ke&&ke.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Eo(t,e,r);return qh(t,e),t};Object.defineProperty(ke,"__esModule",{value:!0});ke.ed25519Schnorr=ke.ecdsaSchnorr=void 0;Yr(vo(),ke);Yr(go(),ke);Yr(So(),ke);Yr(ss(),ke);ke.ecdsaSchnorr=Po(us());ke.ed25519Schnorr=Po(cs());Yr(Xr(),ke)});var Co=z(mr=>{"use strict";O();j();Object.defineProperty(mr,"__esModule",{value:!0});mr.Ed25519Verify=mr.Ed25519Sign=void 0;var $r=yr(),_t=Ee(),Ao=ht(),Kh=e=>e.length!==0&&e.length%2===0&&!/[^a-fA-F0-9]/u.test(e),kh=e=>Uint8Array.from(e.match(/.{1,2}/g).map(t=>parseInt(t,16))),hs=class{constructor(t,r,n,s,a,o){this.deviceNumber=t,this.threshold=r,this.partList=n,this.publicKey=a,this.message=o,this.roundNumber=1;let i=new Array(n.length);for(let h=0;h<n.length;h++)i[h]=BigInt(n[h]);this.wi=$r.polynomial.calLagrangian(_t.ed25519.CURVE.n,BigInt(t),s,i)}async signStep1(){if(this.roundNumber!=1)throw new Error("not in round 1");this.ki=(0,Ao.RandomNum)(_t.ed25519.CURVE.n);let t=_t.ed25519.Point.BASE.multiply(this.ki),r=$r.Commitment.NewCommitment([t.x,t.y]);this.cmtD=r.Msg,this.roundNumber=2;let n=new Map;for(let s of this.partList){if(s==this.deviceNumber)continue;let a={c:r.C},o={from:this.deviceNumber,to:s,data:a};n.set(s,o)}return n}async signStep2(t){if(this.roundNumber!=2)throw new Error("not in round 2");if(t.length!=this.threshold-1)throw new Error("message number error");this.commitmentMap=new Map;for(let a of t){if(a.to!=this.deviceNumber)throw new Error("message sending error");let o=a.data;this.commitmentMap.set(a.from,o.c)}let r=_t.ed25519.Point.BASE.multiply(this.ki),n=await $r.ed25519Schnorr.prove(this.ki,r);this.roundNumber=3;let s=new Map;for(let a of this.partList){if(a==this.deviceNumber)continue;let o={witness:this.cmtD,proof:n},i={from:this.deviceNumber,to:a,data:o};s.set(a,i)}return s}async signStep3(t){if(this.roundNumber!=3)throw new Error("not in round 3");if(t.length!=this.threshold-1)throw new Error("message number error");let r=_t.ed25519.Point.BASE.multiply(this.ki);for(let i of t){if(i.to!=this.deviceNumber)throw new Error("message sending error");let h=i.data,d={C:this.commitmentMap.get(i.from),Msg:h.witness},p=$r.Commitment.Open(d);if(!p)throw new Error("commitment DeCommit fail");let u=BigInt(p[0].toString()),c=BigInt(p[1].toString()),x=new _t.ed25519.Point(u,c),f=h.proof;if(!$r.ed25519Schnorr.verify(f,x))throw new Error("schnorr verify fail");r=r.add(x)}let n=Vh(r.toRawBytes());if(!Kh(this.message))throw new Error("stored message not hex");let s=await _t.ed25519.utils.sha512(r.toRawBytes(),this.publicKey.toRawBytes(),kh(this.message)),a=Lh(s);return[Fo(this.ki+a*this.wi,_t.ed25519.CURVE.n),n]}};mr.Ed25519Sign=hs;async function Mh(e,t,r){let n=e.toEd25519Signature(),s=r.toEd25519Point(),a=await _t.ed25519.verify(n,t,s);return[e,a]}mr.Ed25519Verify=Mh;function Vh(e){let t=new Uint8Array(e);return t.reverse(),(0,Ao.cvtUint8arrayToBigint)(t)}function Lh(e){let t=BigInt("0x"+zh(Uint8Array.from(e).reverse()));return Fo(t,_t.ed25519.CURVE.l)}function Fo(e,t){let r=e%t;return r>=BigInt(0)?r:t+r}var Uh=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function zh(e){let t="";for(let r=0;r<e.length;r++)t+=Uh[e[r]];return t}});var hi=z(Sr=>{"use strict";O();j();Object.defineProperty(Sr,"__esModule",{value:!0});Sr.calPrivateOffset=Sr.TssKey=void 0;var rr=Ee(),Wh=ht(),_o=Ft(),Bo=rr.secp256k1.CURVE,Zr=class{constructor(t,r,n){this.shareI=t,this.publicKey=r,this.chaincode=n,this.offsetSonPri=new rr.BN(0)}async NewChildKey(t){try{let r=V.Buffer.from((0,Wh.cvtBigintToUint8arrayNoPadding)(this.publicKey.x)),n=Do(r,this.chaincode,t),s=new rr.BN(n.slice(0,32)),a=rr.secp256k1.Point.fromPrivateKey(BigInt(s.toString(10))),o=this.publicKey.add(a),i=this.shareI;i!=null&&(i=i.add(s),i=i.mod(new rr.BN(Bo.n.toString())));let h=this.offsetSonPri.add(s);h=h.mod(new rr.BN(Bo.n.toString()));let l=new Zr(i,o,n.slice(32));return l.offsetSonPri=h,l}catch(r){return Promise.reject(new _o.MPCError(_o.Bip32NewChildKeyError,r))}}};Sr.TssKey=Zr;function Do(e,t,r){let n=V.Buffer.allocUnsafe(4);n.writeUInt32BE(r,0);let s=V.Buffer.allocUnsafe(t.length+e.length+n.length);return t.copy(s,0),e.copy(s,t.length),n.copy(s,t.length+e.length),rr.base.hmacSHA512(V.Buffer.from(`Key share derivation:
`,"utf8"),s)}Sr.calPrivateOffset=Do});var ds=z(li=>{"use strict";O();j();Object.defineProperty(li,"__esModule",{value:!0});li.TssKey=void 0;var br=Ee(),Gh=hi(),Xh=ht(),Io=Ft(),ls=br.ed25519.CURVE,Qr=class{constructor(t,r,n){this.shareI=t,this.publicKey=r,this.chaincode=n,this.offsetSonPri=new br.BN(0)}async NewChildKey(t){try{let r=V.Buffer.from((0,Xh.cvtBigintToUint8arrayNoPadding)(this.publicKey.x)),n=(0,Gh.calPrivateOffset)(r,this.chaincode,t),s=new br.BN(n.slice(0,32)),a=br.ed25519.Point.BASE.multiply(BigInt(s.toString(10))%ls.n),o=this.publicKey.add(a),i=this.shareI;i!=null&&(i=i.add(s),i=i.mod(new br.BN(ls.n.toString())));let h=this.offsetSonPri.add(s);h=h.mod(new br.BN(ls.n.toString()));let l=new Qr(i,o,n.slice(32));return l.offsetSonPri=h,l}catch(r){return Promise.reject(new Io.MPCError(Io.Bip32NewChildKeyError,r))}}};li.TssKey=Qr});var di={};Cc(di,{abs:()=>nr,bitLength:()=>Jh,crt:()=>No,eGcd:()=>Ro,gcd:()=>Ho,lcm:()=>Yh,max:()=>$h,min:()=>Zh,modAdd:()=>Qh,modInv:()=>ps,modMultiply:()=>e1,modPow:()=>vs,phi:()=>To,toZn:()=>ir});function nr(e){return e>=0?e:-e}function Jh(e){if(typeof e=="number"&&(e=BigInt(e)),e===1n)return 1;let t=1;do t++;while((e>>=1n)>1n);return t}function Ro(e,t){if(typeof e=="number"&&(e=BigInt(e)),typeof t=="number"&&(t=BigInt(t)),e<=0n||t<=0n)throw new RangeError("a and b MUST be > 0");let r=0n,n=1n,s=1n,a=0n;for(;e!==0n;){let o=t/e,i=t%e,h=r-s*o,l=n-a*o;t=e,e=i,r=s,n=a,s=h,a=l}return{g:t,x:r,y:n}}function ir(e,t){if(typeof e=="number"&&(e=BigInt(e)),typeof t=="number"&&(t=BigInt(t)),t<=0n)throw new RangeError("n must be > 0");let r=e%t;return r<0n?r+t:r}function ps(e,t){let r=Ro(ir(e,t),t);if(r.g!==1n)throw new RangeError(`${e.toString()} does not have inverse modulo ${t.toString()}`);return ir(r.x,t)}function No(e,t,r){if(e.length!==t.length)throw new RangeError("The remainders and modulos arrays should have the same length");let n=r??t.reduce((s,a)=>s*a,1n);return t.reduce((s,a,o)=>{let i=n/a;return ir(s+i*ps(i,a)%n*e[o]%n,n)},0n)}function Ho(e,t){let r=typeof e=="number"?BigInt(nr(e)):nr(e),n=typeof t=="number"?BigInt(nr(t)):nr(t);if(r===0n)return n;if(n===0n)return r;let s=0n;for(;(1n&(r|n))===0n;)r>>=1n,n>>=1n,s++;for(;(1n&r)===0n;)r>>=1n;do{for(;(1n&n)===0n;)n>>=1n;if(r>n){let a=r;r=n,n=a}n-=r}while(n!==0n);return r<<s}function Yh(e,t){return typeof e=="number"&&(e=BigInt(e)),typeof t=="number"&&(t=BigInt(t)),e===0n&&t===0n?BigInt(0):nr(e/Ho(e,t)*t)}function $h(e,t){return e>=t?e:t}function Zh(e,t){return e>=t?t:e}function Qh(e,t){let r=BigInt(t);return ir(e.map(n=>BigInt(n)%r).reduce((n,s)=>n+s%r,0n),r)}function e1(e,t){let r=BigInt(t);return ir(e.map(n=>BigInt(n)%r).reduce((n,s)=>n*s%r,1n),r)}function To(e){return e.map(t=>t[0]**(t[1]-1n)*(t[0]-1n)).reduce((t,r)=>r*t,1n)}function vs(e,t,r,n){if(typeof e=="number"&&(e=BigInt(e)),typeof t=="number"&&(t=BigInt(t)),typeof r=="number"&&(r=BigInt(r)),r<=0n)throw new RangeError("n must be > 0");if(r===1n)return 0n;if(e=ir(e,r),t<0n)return ps(vs(e,nr(t),r,n),r);if(n!==void 0)return function(a,o,i,h){let l=h.map(u=>u[0]**u[1]),d=h.map(u=>To([u])),p=d.map((u,c)=>vs(a,o%u,l[c]));return No(p,l,i)}(e,t,r,function(a){let o={};return a.forEach(i=>{if(typeof i=="bigint"||typeof i=="number"){let h=String(i);o[h]===void 0?o[h]={p:BigInt(i),k:1n}:o[h].k+=1n}else{let h=String(i[0]);o[h]===void 0?o[h]={p:BigInt(i[0]),k:BigInt(i[1])}:o[h].k+=BigInt(i[1])}}),Object.values(o).map(i=>[i.p,i.k])}(n));let s=1n;for(;t>0;)t%2n===1n&&(s=s*e%r),t/=2n,e=e**2n%r;return s}var vi=Fc(()=>{O();j()});var gs=z(wr=>{"use strict";O();j();Object.defineProperty(wr,"__esModule",{value:!0});wr.PaillierAffineVerify=wr.PaillierAffineProve=void 0;var sr=Ee(),Oo=Xr(),Ot=ht(),Bt=(vi(),$0(di)),pi=sr.secp256k1.CURVE,Eg=BigInt(2),xs=2*256,jo=3*256,xi=3*256;function t1(e,t,r){let n=t.N*t.N,s=1n<<BigInt(xs+xi),a=1n<<BigInt(jo+xi),o=1n<<BigInt(xs),i=(0,Ot.RandomNum)(s),h=(0,Ot.RandomNum)(a),l=(0,Ot.RandomNum)(t.N),d=(0,Ot.RandomNum)(s*e.Ntilde),p=(0,Ot.RandomNum)(o*e.Ntilde),u=(0,Ot.RandomNum)(s*e.Ntilde),c=(0,Ot.RandomNum)(o*e.Ntilde),x=(0,Bt.modPow)(t.C,i,n);x=x*(0,Bt.modPow)(1n+t.N,h,n)%n,x=x*(0,Bt.modPow)(l,t.N,n)%n;let f=Oo.ECPoint.fromEcdsaPoint(sr.secp256k1.Point.fromPrivateKey(i%pi.n)),v=Oo.ECPoint.fromEcdsaPoint(sr.secp256k1.Point.fromPrivateKey(h%pi.n)),y=e.Commit(i,d),m=e.Commit(r.X,p),b=e.Commit(h,u),E=e.Commit(r.Y,c),F=(0,Ot.SHA256Int)([t.N,t.C,t.D,t.X.X,t.Y.X,x,f.X,v.X,y,m,b,E])%sr.secp256k1.CURVE.n,D=i+F*r.X,S=h+F*r.Y,w=d+F*p,C=u+F*c,A=l*(0,Bt.modPow)(r.Rho,F,t.N)%t.N;return{A:x,Bx:f,By:v,E:y,S:m,F:b,T:E,Z1:D,Z2:S,Z3:w,Z4:C,W:A,X:t.X,Y:t.Y}}wr.PaillierAffineProve=t1;function r1(e,t,r){let n=r.N*r.N,a=(0,Ot.SHA256Int)([r.N,r.C,r.D,r.X.X,r.Y.X,t.A,t.Bx.X,t.By.X,t.E,t.S,t.F,t.T])%sr.secp256k1.CURVE.n,o=(0,Bt.modPow)(r.C,t.Z1,n);o=o*(0,Bt.modPow)(1n+r.N,t.Z2,n)%n*(0,Bt.modPow)(t.W,r.N,n)%n;let i=t.A*(0,Bt.modPow)(r.D,a,n)%n;if(o!==i)return!1;let h=sr.secp256k1.Point.fromPrivateKey(t.Z1%pi.n),l=t.Bx.toEcdsaPoint().add(r.X.toEcdsaPoint().multiply(a));if(!h.equals(l))return!1;let d=sr.secp256k1.Point.fromPrivateKey(t.Z2%pi.n),p=t.By.toEcdsaPoint().add(r.Y.toEcdsaPoint().multiply(a));if(!d.equals(p))return!1;let u=e.Commit(t.Z1,t.Z3),c=t.E*(0,Bt.modPow)(t.S,a,e.Ntilde)%e.Ntilde;if(u!==c)return!1;let x=e.Commit(t.Z2,t.Z4),f=t.F*(0,Bt.modPow)(t.T,a,e.Ntilde)%e.Ntilde;return!(x!==f||t.Z1>=1n<<BigInt(xs+xi)||t.Z2>=1n<<BigInt(jo+xi))}wr.PaillierAffineVerify=r1});var ko=z(gi=>{"use strict";O();j();Object.defineProperty(gi,"__esModule",{value:!0});gi.P1=void 0;var en=Ee(),ys=yr(),tn=Ee(),qo=ht(),n1=gs(),i1=ys.Commitment.NewCommitment,Ko=tn.secp256k1.CURVE,ms=class{constructor(t,r,n,s,a){let o;try{o=(0,en.hexToBigint)(s)}catch{throw new Error(`message not hex: ${s}`)}this.sessionId=(0,qo.SHA256Int)([r.x,r.y,o]),this.k1=new en.BN((0,qo.RandomNum)(Ko.n).toString()),this.publicKey=r,this.paiPrivKey=n,this.message=s,this.cmtD=[],this.E_x1=t,this.ped=a}step1(){let t=tn.secp256k1.Point.fromPrivateKey(BigInt(this.k1.toString())),r=i1([this.sessionId,t.x,t.y]);return this.cmtD=r.Msg,r.C}step2(t,r){let n=BigInt(this.k1.toString()),s=tn.secp256k1.Point.fromPrivateKey(n);if(!ys.ecdsaSchnorr.verify(this.sessionId,t,r))throw new Error("schnorr verify fail");return this.R2=r,[ys.ecdsaSchnorr.prove(this.sessionId,n,s),this.cmtD]}step3(t,r){let n={N:BigInt(this.paiPrivKey.pailPubKey.n.toString()),C:BigInt(this.E_x1.toString()),D:BigInt(t.toString()),X:r.X,Y:r.Y};if(!(0,n1.PaillierAffineVerify)(this.ped,r,n))throw new Error("Paillier Affine verify fail");let a=new en.BN(Ko.n.toString()),i=this.R2?.multiply(BigInt(this.k1.toString()))?.x,h=new en.BN(i.toString()).mod(new en.BN(a)),l=this.paiPrivKey.decrypt(t),d=this.k1.invm(a),p=l.mul(d).mod(a),u=a.shrn(1);if(p.cmp(u)==1&&(p=a.sub(p)),p.isZero())throw new Error("calculated S is zero");let c=new tn.secp256k1.Signature(BigInt(h.toString()),BigInt(p.toString()));if(!tn.secp256k1.verify(c,this.message,this.publicKey))throw new Error("ecdsa sign verify fail");return[h,p]}};gi.P1=ms});var Uo=z(Dt=>{"use strict";O();j();Object.defineProperty(Dt,"__esModule",{value:!0});Dt.truncateHash=Dt.toU8=Dt.bits2int_modN=void 0;var Mo=2n**256n,s1=Mo-0x1000003d1n,a1=Mo-0x14551231950b75fc4402da1732fc9bebfn,o1=e=>Array.from(e).map(t=>u1(t,2)).join(""),u1=(e,t)=>e.toString(16).padStart(t,"0"),f1=e=>BigInt(`0x${o1(e)||"0"}`),c1=e=>{let t=e.length*8-256,r=f1(e);return t>0?r>>BigInt(t):r},h1=e=>l1(c1(e),a1);Dt.bits2int_modN=h1;var l1=(e,t=s1)=>{let r=e%t;return r>=0n?r:t+r},Vo=e=>typeof e=="string",d1=(e,t)=>!(e instanceof Uint8Array)||typeof t=="number"&&t>0&&e.length!==t?Ss("Uint8Array expected"):e,Lo=e=>new Uint8Array(e),v1=(e,t)=>d1(Vo(e)?p1(e):Lo(e),t);Dt.toU8=v1;var p1=e=>{let t=e.length;(!Vo(e)||t%2)&&Ss("hex invalid 1");let r=Lo(t/2);for(let n=0;n<r.length;n++){let s=n*2,a=e.slice(s,s+2),o=Number.parseInt(a,16);(Number.isNaN(o)||o<0)&&Ss("hex invalid 2"),r[n]=o}return r},Ss=(e="")=>{throw new Error(e)},x1=e=>(0,Dt.bits2int_modN)((0,Dt.toU8)(e,32));Dt.truncateHash=x1});var Wo=z(Si=>{"use strict";O();j();Object.defineProperty(Si,"__esModule",{value:!0});Si.P2=void 0;var ar=Ee(),rn=yr(),nn=Ee(),yi=ht(),zo=Uo(),g1=gs(),y1=(vi(),$0(di)),mi=nn.secp256k1.CURVE,bs=class{constructor(t,r,n,s,a,o){let i;try{i=(0,ar.hexToBigint)(a)}catch{throw new Error(`message not hex: ${a}`)}this.sessionId=(0,yi.SHA256Int)([s.x,s.y,i]),this.x2=t,this.E_x1=r,this.paiPub=n,this.publicKey=s,this.message=a,this.k2=new ar.BN((0,yi.RandomNum)(mi.n).toString()),this.cmtC=0n,this.ped=o}step1(t){this.cmtC=t;let r=nn.secp256k1.Point.fromPrivateKey(BigInt(this.k2.toString()));return[rn.ecdsaSchnorr.prove(this.sessionId,BigInt(this.k2.toString()),r),r]}step2(t,r){let n=new ar.BN(mi.n.toString()),s={C:this.cmtC,Msg:r},a=rn.Commitment.Open(s);if(!a)throw new Error("commitment DeCommit fail");if(this.sessionId!==a[0])throw new Error("p2 Step2 commitment sessionId error");let o=new nn.secp256k1.Point(a[1],a[2]);if(!rn.ecdsaSchnorr.verify(this.sessionId,t,o))throw new Error("schnorr verify fail");let l=o.multiply(BigInt(this.k2.toString()))?.x,d=new ar.BN(l.toString()).mod(n),p=this.k2.invm(n),u=m1(this.message);u=u.mul(p);let x=new ar.BN((0,yi.RandomNum)(mi.n*mi.n).toString()).mul(n),f=u.add(x),v=d.mul(p),y=f.add(v.mul(this.x2)),m=(0,yi.RandomNum)(BigInt(this.paiPub.n.toString())),b=this.paiPub.homomorphicMulPlain(this.E_x1,v),E=this.paiPub.homomorphicAddPlain(b,y),P=BigInt(this.paiPub.n.toString()),F=BigInt(this.paiPub.n2().toString()),D=new ar.BN((0,y1.modPow)(m,P,F).toString()),S=E.mul(D).mod(this.paiPub.n2()),w=rn.ECPoint.fromEcdsaPoint(nn.secp256k1.Point.fromPrivateKey(BigInt(v.mod(n).toString()))),C=rn.ECPoint.fromEcdsaPoint(nn.secp256k1.Point.fromPrivateKey(BigInt(y.mod(n).toString()))),A={N:BigInt(this.paiPub.n.toString()),C:BigInt(this.E_x1.toString()),D:BigInt(S.toString()),X:w,Y:C},B={X:BigInt(v.toString()),Y:BigInt(y.toString()),Rho:BigInt(m.toString())},R=(0,g1.PaillierAffineProve)(this.ped,A,B);return[S,R]}};Si.P2=bs;function m1(e){let t=(0,zo.bits2int_modN)((0,zo.toU8)(e,32));return new ar.BN(t.toString())}});var Jo=z(Ye=>{"use strict";O();j();var Go=Ye&&Ye.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),S1=Ye&&Ye.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),ws=Ye&&Ye.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&Go(t,e,r)},Xo=Ye&&Ye.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Go(t,e,r);return S1(t,e),t};Object.defineProperty(Ye,"__esModule",{value:!0});Ye.ed25519TssKey=Ye.ecdsaTssKey=void 0;ws(Co(),Ye);Ye.ecdsaTssKey=Xo(hi());Ye.ed25519TssKey=Xo(ds());ws(ko(),Ye);ws(Wo(),Ye)});var $o=z(Yo=>{"use strict";O();j();Object.defineProperty(Yo,"__esModule",{value:!0})});var wi=z(bi=>{"use strict";O();j();Object.defineProperty(bi,"__esModule",{value:!0});bi.md5=void 0;function b1(e){var t="0123456789abcdef";function r(P){var F,D="";for(F=0;F<=3;F++)D+=t.charAt(P>>F*8+4&15)+t.charAt(P>>F*8&15);return D}function n(P,F){var D=(P&65535)+(F&65535),S=(P>>16)+(F>>16)+(D>>16);return S<<16|D&65535}function s(P,F){return P<<F|P>>>32-F}function a(P,F,D,S,w,C){return n(s(n(n(F,P),n(S,C)),w),D)}function o(P,F,D,S,w,C,A){return a(F&D|~F&S,P,F,w,C,A)}function i(P,F,D,S,w,C,A){return a(F&S|D&~S,P,F,w,C,A)}function h(P,F,D,S,w,C,A){return a(F^D^S,P,F,w,C,A)}function l(P,F,D,S,w,C,A){return a(D^(F|~S),P,F,w,C,A)}function d(P){var F,D=(P.length+8>>6)+1,S=new Array(D*16);for(F=0;F<D*16;F++)S[F]=0;for(F=0;F<P.length;F++)S[F>>2]|=P.charCodeAt(F)<<F%4*8;return S[F>>2]|=128<<F%4*8,S[D*16-2]=P.length*8,S}var p,u=d(""+e),c=1732584193,x=-271733879,f=-1732584194,v=271733878,y,m,b,E;for(p=0;p<u.length;p+=16)y=c,m=x,b=f,E=v,c=o(c,x,f,v,u[p+0],7,-680876936),v=o(v,c,x,f,u[p+1],12,-389564586),f=o(f,v,c,x,u[p+2],17,606105819),x=o(x,f,v,c,u[p+3],22,-1044525330),c=o(c,x,f,v,u[p+4],7,-176418897),v=o(v,c,x,f,u[p+5],12,1200080426),f=o(f,v,c,x,u[p+6],17,-1473231341),x=o(x,f,v,c,u[p+7],22,-45705983),c=o(c,x,f,v,u[p+8],7,1770035416),v=o(v,c,x,f,u[p+9],12,-1958414417),f=o(f,v,c,x,u[p+10],17,-42063),x=o(x,f,v,c,u[p+11],22,-1990404162),c=o(c,x,f,v,u[p+12],7,1804603682),v=o(v,c,x,f,u[p+13],12,-40341101),f=o(f,v,c,x,u[p+14],17,-1502002290),x=o(x,f,v,c,u[p+15],22,1236535329),c=i(c,x,f,v,u[p+1],5,-165796510),v=i(v,c,x,f,u[p+6],9,-1069501632),f=i(f,v,c,x,u[p+11],14,643717713),x=i(x,f,v,c,u[p+0],20,-373897302),c=i(c,x,f,v,u[p+5],5,-701558691),v=i(v,c,x,f,u[p+10],9,38016083),f=i(f,v,c,x,u[p+15],14,-660478335),x=i(x,f,v,c,u[p+4],20,-405537848),c=i(c,x,f,v,u[p+9],5,568446438),v=i(v,c,x,f,u[p+14],9,-1019803690),f=i(f,v,c,x,u[p+3],14,-187363961),x=i(x,f,v,c,u[p+8],20,1163531501),c=i(c,x,f,v,u[p+13],5,-1444681467),v=i(v,c,x,f,u[p+2],9,-51403784),f=i(f,v,c,x,u[p+7],14,1735328473),x=i(x,f,v,c,u[p+12],20,-1926607734),c=h(c,x,f,v,u[p+5],4,-378558),v=h(v,c,x,f,u[p+8],11,-2022574463),f=h(f,v,c,x,u[p+11],16,1839030562),x=h(x,f,v,c,u[p+14],23,-35309556),c=h(c,x,f,v,u[p+1],4,-1530992060),v=h(v,c,x,f,u[p+4],11,1272893353),f=h(f,v,c,x,u[p+7],16,-155497632),x=h(x,f,v,c,u[p+10],23,-1094730640),c=h(c,x,f,v,u[p+13],4,681279174),v=h(v,c,x,f,u[p+0],11,-358537222),f=h(f,v,c,x,u[p+3],16,-722521979),x=h(x,f,v,c,u[p+6],23,76029189),c=h(c,x,f,v,u[p+9],4,-640364487),v=h(v,c,x,f,u[p+12],11,-421815835),f=h(f,v,c,x,u[p+15],16,530742520),x=h(x,f,v,c,u[p+2],23,-995338651),c=l(c,x,f,v,u[p+0],6,-198630844),v=l(v,c,x,f,u[p+7],10,1126891415),f=l(f,v,c,x,u[p+14],15,-1416354905),x=l(x,f,v,c,u[p+5],21,-57434055),c=l(c,x,f,v,u[p+12],6,1700485571),v=l(v,c,x,f,u[p+3],10,-1894986606),f=l(f,v,c,x,u[p+10],15,-1051523),x=l(x,f,v,c,u[p+1],21,-2054922799),c=l(c,x,f,v,u[p+8],6,1873313359),v=l(v,c,x,f,u[p+15],10,-30611744),f=l(f,v,c,x,u[p+6],15,-1560198380),x=l(x,f,v,c,u[p+13],21,1309151649),c=l(c,x,f,v,u[p+4],6,-145523070),v=l(v,c,x,f,u[p+11],10,-1120210379),f=l(f,v,c,x,u[p+2],15,718787259),x=l(x,f,v,c,u[p+9],21,-343485551),c=n(c,y),x=n(x,m),f=n(f,b),v=n(v,E);return r(c)+r(x)+r(f)+r(v)}bi.md5=b1});var Zo=z(je=>{"use strict";O();j();Object.defineProperty(je,"__esModule",{value:!0});je.sha256HexMsg=je.GetMapKeyTssSign=je.MpcVersion=je.Status=je.SignStep=je.FuncType=je.DeviceNumber=void 0;var Ei=Ee(),w1=wi(),E1;(function(e){e[e.P1_No=1]="P1_No",e[e.P2_No=2]="P2_No",e[e.P3_No=3]="P3_No"})(E1=je.DeviceNumber||(je.DeviceNumber={}));var P1;(function(e){e[e.ShakeHands=0]="ShakeHands",e[e.KeyGen=1]="KeyGen",e[e.ReShare=2]="ReShare",e[e.TssSign=3]="TssSign"})(P1=je.FuncType||(je.FuncType={}));var A1;(function(e){e[e.Step1=1]="Step1",e[e.Step2=2]="Step2",e[e.Step3=3]="Step3"})(A1=je.SignStep||(je.SignStep={}));var F1;(function(e){e[e.Success=1]="Success",e[e.Fail=2]="Fail"})(F1=je.Status||(je.Status={}));var C1;(function(e){e[e.Version_v0=0]="Version_v0",e[e.Version_v1=1]="Version_v1"})(C1=je.MpcVersion||(je.MpcVersion={}));function _1(e,t){let r=(0,w1.md5)(t);return`${e}-${r}`}je.GetMapKeyTssSign=_1;function B1(e){let t=Ei.secp256k1.CURVE.n,r=Ei.base.sha256(e),n=(0,Ei.bufToBigint)(r)%t,s=(0,Ei.bigintToHex)(n);return s.length%2&&(s="0"+s),s}je.sha256HexMsg=B1});var eu=z(lt=>{"use strict";O();j();Object.defineProperty(lt,"__esModule",{value:!0});lt.bigintStringify=lt.cvtEd25519MapToObj=lt.cvtObjToEd25519Map=lt.cvtEcdsaMapToObj=lt.cvtObjToEcdsaMap=void 0;var $e=Pt(),D1=us(),I1=cs();function R1(e){let t=new Map;for(let r of Object.keys(e)){let n=e[r],s={};if(n.hasOwnProperty("CmtC")&&n.CmtC!==null&&(s.CmtC=e[r].CmtC),n.hasOwnProperty("Witness")&&n.Witness!==null){s.Witness=[];for(let a of n.Witness)s.Witness.push(a)}n.hasOwnProperty("Proof")&&n.Proof!==null&&(s.Proof=new D1.Proof(new $e.ECPoint($e.CurveName.Secp256k1.toString(),BigInt(n.Proof.R.X),BigInt(n.Proof.R.Y)),n.Proof.S)),n.hasOwnProperty("R2")&&n.R2!==null&&(s.R2=new $e.ECPoint($e.CurveName.Secp256k1.toString(),BigInt(n.R2.X),BigInt(n.R2.Y))),n.hasOwnProperty("E_k2_h_rx")&&n.E_k2_h_rx!==null&&(s.E_k2_h_rx=BigInt(n.E_k2_h_rx)),n.hasOwnProperty("Signature")&&n.Signature!==null&&(s.Signature=new $e.Signature(BigInt(n.Signature.r),BigInt(n.Signature.s))),t.set(r,s)}return t}lt.cvtObjToEcdsaMap=R1;function N1(e){let t=Object.fromEntries(e.entries()),r={};for(let n of Object.keys(t)){let s={},a=t[n];if(a.CmtC!=null&&(s.CmtC=a.CmtC.toString(10)),a.Witness!=null){s.Witness=[];for(let o of a.Witness)s.Witness.push(o.toString(10))}a.Proof!=null&&(s.Proof={R:{Curve:$e.CurveName.Secp256k1,X:a.Proof.R.X,Y:a.Proof.R.Y},S:a.Proof.S.toString(10)}),a.R2!=null&&(s.R2={Curve:$e.CurveName.Secp256k1,X:a.R2.X,Y:a.R2.Y}),a.E_k2_h_rx!=null&&(s.E_k2_h_rx=a.E_k2_h_rx.toString()),a.Signature!=null&&(s.Signature={r:a.Signature.r,s:a.Signature.s}),r[n]=s}return r}lt.cvtEcdsaMapToObj=N1;function H1(e){let t=new Map;for(let r of Object.keys(e)){let n=e[r],s={};if(n.hasOwnProperty("OutputDataMap")&&n.OutputDataMap!=null){s.TssInput=[];for(let a of Object.keys(n.OutputDataMap))Number(a)===$e.DeviceNumber.P2_No&&s.TssInput.push(T1(n.OutputDataMap[a]))}n.hasOwnProperty("Signature")&&n.Signature!=null&&(s.Signature=new $e.Signature(BigInt(n.Signature.r),BigInt(n.Signature.s))),t.set(r,s)}return t}lt.cvtObjToEd25519Map=H1;function T1(e){let t={};if(e==null)return t;t.from=e.From,t.to=e.To;let r=(0,$e.JsonParseBigInt)(e.Data);if(t.data={},r.C!==void 0&&(t.data.c=r.C),r.Witness!==void 0){let n=[];if(r.hasOwnProperty("Witness"))for(let s of r.Witness)n.push(s);t.data.witness=n}return r.Proof!==void 0&&(t.data.proof=new I1.Proof(new $e.ECPoint($e.CurveName.Ed25519.toString(),BigInt(r.Proof.R.X),BigInt(r.Proof.R.Y)),BigInt(r.Proof.S))),t}function O1(e){let t={};for(let[r,n]of e.entries()){let s={};if(n.OutputDataMap!=null){let a=[];for(let[o,i]of n.OutputDataMap.entries())o===$e.DeviceNumber.P1_No&&a.push({From:$e.DeviceNumber.P2_No,To:$e.DeviceNumber.P1_No,Data:j1(i.data)});s.TssInput=a}n.Signature!=null&&(s.Signature={r:n.Signature.r,s:n.Signature.s}),t[r]=s}return t}lt.cvtEd25519MapToObj=O1;function j1(e){let t={};if(e.c!==void 0)t.C=e.c.toString(10);else if(e.witness!==void 0&&e.proof!==void 0){let r=[];for(let n of e.witness)r.push(n.toString(10));t.Witness=r,t.Proof={R:{Curve:$e.CurveName.Ed25519,X:e.proof.R.X,Y:e.proof.R.Y},S:e.proof.S}}return Qo(t)}function Qo(e){return JSON.stringify(e,(n,s)=>typeof s=="bigint"?s.toString():s).replace(/"(\d{16,})"/g,(n,s)=>s)}lt.bigintStringify=Qo});var ks=z(X=>{O();j();var sn={};sn.userAgent=!1;var Er={},q1="10.9.0",K1="jsrsasign(all) 10.9.0 (2023-11-27) (c) 2010-2023 Kenji Urushima | kjur.github.io/jsrsasign/license";var J=J||function(e,t){var r={},n=r.lib={},s=n.Base=function(){function c(){}return{extend:function(x){c.prototype=this;var f=new c;return x&&f.mixIn(x),f.hasOwnProperty("init")||(f.init=function(){f.$super.init.apply(this,arguments)}),f.init.prototype=f,f.$super=this,f},create:function(){var x=this.extend();return x.init.apply(x,arguments),x},init:function(){},mixIn:function(x){for(var f in x)x.hasOwnProperty(f)&&(this[f]=x[f]);x.hasOwnProperty("toString")&&(this.toString=x.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),a=n.WordArray=s.extend({init:function(c,x){c=this.words=c||[],x!=t?this.sigBytes=x:this.sigBytes=c.length*4},toString:function(c){return(c||i).stringify(this)},concat:function(c){var x=this.words,f=c.words,v=this.sigBytes,y=c.sigBytes;if(this.clamp(),v%4)for(var m=0;m<y;m++){var b=f[m>>>2]>>>24-m%4*8&255;x[v+m>>>2]|=b<<24-(v+m)%4*8}else for(var m=0;m<y;m+=4)x[v+m>>>2]=f[m>>>2];return this.sigBytes+=y,this},clamp:function(){var c=this.words,x=this.sigBytes;c[x>>>2]&=4294967295<<32-x%4*8,c.length=e.ceil(x/4)},clone:function(){var c=s.clone.call(this);return c.words=this.words.slice(0),c},random:function(c){for(var x=[],f=0;f<c;f+=4)x.push(e.random()*4294967296|0);return new a.init(x,c)}}),o=r.enc={},i=o.Hex={stringify:function(c){for(var x=c.words,f=c.sigBytes,v=[],y=0;y<f;y++){var m=x[y>>>2]>>>24-y%4*8&255;v.push((m>>>4).toString(16)),v.push((m&15).toString(16))}return v.join("")},parse:function(c){for(var x=c.length,f=[],v=0;v<x;v+=2)f[v>>>3]|=parseInt(c.substr(v,2),16)<<24-v%8*4;return new a.init(f,x/2)}},h=o.Latin1={stringify:function(c){for(var x=c.words,f=c.sigBytes,v=[],y=0;y<f;y++){var m=x[y>>>2]>>>24-y%4*8&255;v.push(String.fromCharCode(m))}return v.join("")},parse:function(c){for(var x=c.length,f=[],v=0;v<x;v++)f[v>>>2]|=(c.charCodeAt(v)&255)<<24-v%4*8;return new a.init(f,x)}},l=o.Utf8={stringify:function(c){try{return decodeURIComponent(escape(h.stringify(c)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(c){return h.parse(unescape(encodeURIComponent(c)))}},d=n.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(c){typeof c=="string"&&(c=l.parse(c)),this._data.concat(c),this._nDataBytes+=c.sigBytes},_process:function(c){var x=this._data,f=x.words,v=x.sigBytes,y=this.blockSize,m=y*4,b=v/m;c?b=e.ceil(b):b=e.max((b|0)-this._minBufferSize,0);var E=b*y,P=e.min(E*4,v);if(E){for(var F=0;F<E;F+=y)this._doProcessBlock(f,F);var D=f.splice(0,E);x.sigBytes-=P}return new a.init(D,P)},clone:function(){var c=s.clone.call(this);return c._data=this._data.clone(),c},_minBufferSize:0}),p=n.Hasher=d.extend({cfg:s.extend(),init:function(c){this.cfg=this.cfg.extend(c),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(c){return this._append(c),this._process(),this},finalize:function(c){c&&this._append(c);var x=this._doFinalize();return x},blockSize:512/32,_createHelper:function(c){return function(x,f){return new c.init(f).finalize(x)}},_createHmacHelper:function(c){return function(x,f){return new u.HMAC.init(c,f).finalize(x)}}}),u=r.algo={};return r}(Math);(function(e){var s=J,t=s.lib,r=t.Base,n=t.WordArray,s=s.x64={};s.Word=r.extend({init:function(a,o){this.high=a,this.low=o}}),s.WordArray=r.extend({init:function(a,o){a=this.words=a||[],this.sigBytes=o!=e?o:8*a.length},toX32:function(){for(var a=this.words,o=a.length,i=[],h=0;h<o;h++){var l=a[h];i.push(l.high),i.push(l.low)}return n.create(i,this.sigBytes)},clone:function(){for(var a=r.clone.call(this),o=a.words=this.words.slice(0),i=o.length,h=0;h<i;h++)o[h]=o[h].clone();return a}})})();J.lib.Cipher||function(e){var c=J,t=c.lib,r=t.Base,n=t.WordArray,s=t.BufferedBlockAlgorithm,a=c.enc.Base64,o=c.algo.EvpKDF,i=t.Cipher=s.extend({cfg:r.extend(),createEncryptor:function(f,v){return this.create(this._ENC_XFORM_MODE,f,v)},createDecryptor:function(f,v){return this.create(this._DEC_XFORM_MODE,f,v)},init:function(f,v,y){this.cfg=this.cfg.extend(y),this._xformMode=f,this._key=v,this.reset()},reset:function(){s.reset.call(this),this._doReset()},process:function(f){return this._append(f),this._process()},finalize:function(f){return f&&this._append(f),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(f){return{encrypt:function(v,y,m){return(typeof y=="string"?x:u).encrypt(f,v,y,m)},decrypt:function(v,y,m){return(typeof y=="string"?x:u).decrypt(f,v,y,m)}}}});t.StreamCipher=i.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var p=c.mode={},h=function(f,v,y){var m=this._iv;m?this._iv=e:m=this._prevBlock;for(var b=0;b<y;b++)f[v+b]^=m[b]},l=(t.BlockCipherMode=r.extend({createEncryptor:function(f,v){return this.Encryptor.create(f,v)},createDecryptor:function(f,v){return this.Decryptor.create(f,v)},init:function(f,v){this._cipher=f,this._iv=v}})).extend();l.Encryptor=l.extend({processBlock:function(f,v){var y=this._cipher,m=y.blockSize;h.call(this,f,v,m),y.encryptBlock(f,v),this._prevBlock=f.slice(v,v+m)}}),l.Decryptor=l.extend({processBlock:function(f,v){var y=this._cipher,m=y.blockSize,b=f.slice(v,v+m);y.decryptBlock(f,v),h.call(this,f,v,m),this._prevBlock=b}}),p=p.CBC=l,l=(c.pad={}).Pkcs7={pad:function(f,v){for(var y=4*v,y=y-f.sigBytes%y,m=y<<24|y<<16|y<<8|y,b=[],E=0;E<y;E+=4)b.push(m);y=n.create(b,y),f.concat(y)},unpad:function(f){f.sigBytes-=f.words[f.sigBytes-1>>>2]&255}},t.BlockCipher=i.extend({cfg:i.cfg.extend({mode:p,padding:l}),reset:function(){i.reset.call(this);var v=this.cfg,f=v.iv,v=v.mode;if(this._xformMode==this._ENC_XFORM_MODE)var y=v.createEncryptor;else y=v.createDecryptor,this._minBufferSize=1;this._mode=y.call(v,this,f&&f.words)},_doProcessBlock:function(f,v){this._mode.processBlock(f,v)},_doFinalize:function(){var f=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){f.pad(this._data,this.blockSize);var v=this._process(!0)}else v=this._process(!0),f.unpad(v);return v},blockSize:4});var d=t.CipherParams=r.extend({init:function(f){this.mixIn(f)},toString:function(f){return(f||this.formatter).stringify(this)}}),p=(c.format={}).OpenSSL={stringify:function(f){var v=f.ciphertext;return f=f.salt,(f?n.create([1398893684,1701076831]).concat(f).concat(v):v).toString(a)},parse:function(f){f=a.parse(f);var v=f.words;if(v[0]==1398893684&&v[1]==1701076831){var y=n.create(v.slice(2,4));v.splice(0,4),f.sigBytes-=16}return d.create({ciphertext:f,salt:y})}},u=t.SerializableCipher=r.extend({cfg:r.extend({format:p}),encrypt:function(f,v,y,m){m=this.cfg.extend(m);var b=f.createEncryptor(y,m);return v=b.finalize(v),b=b.cfg,d.create({ciphertext:v,key:y,iv:b.iv,algorithm:f,mode:b.mode,padding:b.padding,blockSize:f.blockSize,formatter:m.format})},decrypt:function(f,v,y,m){return m=this.cfg.extend(m),v=this._parse(v,m.format),f.createDecryptor(y,m).finalize(v.ciphertext)},_parse:function(f,v){return typeof f=="string"?v.parse(f,this):f}}),c=(c.kdf={}).OpenSSL={execute:function(f,v,y,m){return m||(m=n.random(8)),f=o.create({keySize:v+y}).compute(f,m),y=n.create(f.words.slice(v),4*y),f.sigBytes=4*v,d.create({key:f,iv:y,salt:m})}},x=t.PasswordBasedCipher=u.extend({cfg:u.cfg.extend({kdf:c}),encrypt:function(f,v,y,m){return m=this.cfg.extend(m),y=m.kdf.execute(y,f.keySize,f.ivSize),m.iv=y.iv,f=u.encrypt.call(this,f,v,y.key,m),f.mixIn(y),f},decrypt:function(f,v,y,m){return m=this.cfg.extend(m),v=this._parse(v,m.format),y=m.kdf.execute(y,f.keySize,f.ivSize,v.salt),m.iv=y.iv,u.decrypt.call(this,f,v,y.key,m)}})}();(function(){for(var e=J,t=e.lib.BlockCipher,F=e.algo,r=[],n=[],s=[],a=[],o=[],i=[],h=[],l=[],d=[],p=[],u=[],c=0;256>c;c++)u[c]=128>c?c<<1:c<<1^283;for(var x=0,f=0,c=0;256>c;c++){var v=f^f<<1^f<<2^f<<3^f<<4,v=v>>>8^v&255^99;r[x]=v,n[v]=x;var y=u[x],m=u[y],b=u[m],E=257*u[v]^16843008*v;s[x]=E<<24|E>>>8,a[x]=E<<16|E>>>16,o[x]=E<<8|E>>>24,i[x]=E,E=16843009*b^65537*m^257*y^16843008*x,h[v]=E<<24|E>>>8,l[v]=E<<16|E>>>16,d[v]=E<<8|E>>>24,p[v]=E,x?(x=y^u[u[u[b^y]]],f^=u[u[f]]):x=f=1}var P=[0,1,2,4,8,16,32,64,128,27,54],F=F.AES=t.extend({_doReset:function(){for(var w=this._key,D=w.words,S=w.sigBytes/4,w=4*((this._nRounds=S+6)+1),C=this._keySchedule=[],A=0;A<w;A++)if(A<S)C[A]=D[A];else{var B=C[A-1];A%S?6<S&&A%S==4&&(B=r[B>>>24]<<24|r[B>>>16&255]<<16|r[B>>>8&255]<<8|r[B&255]):(B=B<<8|B>>>24,B=r[B>>>24]<<24|r[B>>>16&255]<<16|r[B>>>8&255]<<8|r[B&255],B^=P[A/S|0]<<24),C[A]=C[A-S]^B}for(D=this._invKeySchedule=[],S=0;S<w;S++)A=w-S,B=S%4?C[A]:C[A-4],D[S]=4>S||4>=A?B:h[r[B>>>24]]^l[r[B>>>16&255]]^d[r[B>>>8&255]]^p[r[B&255]]},encryptBlock:function(D,S){this._doCryptBlock(D,S,this._keySchedule,s,a,o,i,r)},decryptBlock:function(D,S){var w=D[S+1];D[S+1]=D[S+3],D[S+3]=w,this._doCryptBlock(D,S,this._invKeySchedule,h,l,d,p,n),w=D[S+1],D[S+1]=D[S+3],D[S+3]=w},_doCryptBlock:function(D,S,w,C,A,B,R,_){for(var I=this._nRounds,q=D[S]^w[0],$=D[S+1]^w[1],Y=D[S+2]^w[2],k=D[S+3]^w[3],N=4,K=1;K<I;K++)var L=C[q>>>24]^A[$>>>16&255]^B[Y>>>8&255]^R[k&255]^w[N++],H=C[$>>>24]^A[Y>>>16&255]^B[k>>>8&255]^R[q&255]^w[N++],T=C[Y>>>24]^A[k>>>16&255]^B[q>>>8&255]^R[$&255]^w[N++],k=C[k>>>24]^A[q>>>16&255]^B[$>>>8&255]^R[Y&255]^w[N++],q=L,$=H,Y=T;L=(_[q>>>24]<<24|_[$>>>16&255]<<16|_[Y>>>8&255]<<8|_[k&255])^w[N++],H=(_[$>>>24]<<24|_[Y>>>16&255]<<16|_[k>>>8&255]<<8|_[q&255])^w[N++],T=(_[Y>>>24]<<24|_[k>>>16&255]<<16|_[q>>>8&255]<<8|_[$&255])^w[N++],k=(_[k>>>24]<<24|_[q>>>16&255]<<16|_[$>>>8&255]<<8|_[Y&255])^w[N++],D[S]=L,D[S+1]=H,D[S+2]=T,D[S+3]=k},keySize:8});e.AES=t._createHelper(F)})();(function(){function e(u,c){var x=(this._lBlock>>>u^this._rBlock)&c;this._rBlock^=x,this._lBlock^=x<<u}function t(u,c){var x=(this._rBlock>>>u^this._lBlock)&c;this._lBlock^=x,this._rBlock^=x<<u}var r=J,s=r.lib,n=s.WordArray,s=s.BlockCipher,a=r.algo,o=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],i=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],h=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],l=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],d=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],p=a.DES=s.extend({_doReset:function(){for(var u=this._key.words,c=[],x=0;56>x;x++){var f=o[x]-1;c[x]=u[f>>>5]>>>31-f%32&1}for(u=this._subKeys=[],f=0;16>f;f++){for(var v=u[f]=[],y=h[f],x=0;24>x;x++)v[x/6|0]|=c[(i[x]-1+y)%28]<<31-x%6,v[4+(x/6|0)]|=c[28+(i[x+24]-1+y)%28]<<31-x%6;for(v[0]=v[0]<<1|v[0]>>>31,x=1;7>x;x++)v[x]>>>=4*(x-1)+3;v[7]=v[7]<<5|v[7]>>>27}for(c=this._invSubKeys=[],x=0;16>x;x++)c[x]=u[15-x]},encryptBlock:function(u,c){this._doCryptBlock(u,c,this._subKeys)},decryptBlock:function(u,c){this._doCryptBlock(u,c,this._invSubKeys)},_doCryptBlock:function(u,c,x){this._lBlock=u[c],this._rBlock=u[c+1],e.call(this,4,252645135),e.call(this,16,65535),t.call(this,2,858993459),t.call(this,8,16711935),e.call(this,1,1431655765);for(var f=0;16>f;f++){for(var v=x[f],y=this._lBlock,m=this._rBlock,b=0,E=0;8>E;E++)b|=l[E][((m^v[E])&d[E])>>>0];this._lBlock=m,this._rBlock=y^b}x=this._lBlock,this._lBlock=this._rBlock,this._rBlock=x,e.call(this,1,1431655765),t.call(this,8,16711935),t.call(this,2,858993459),e.call(this,16,65535),e.call(this,4,252645135),u[c]=this._lBlock,u[c+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});r.DES=s._createHelper(p),a=a.TripleDES=s.extend({_doReset:function(){var u=this._key.words;this._des1=p.createEncryptor(n.create(u.slice(0,2))),this._des2=p.createEncryptor(n.create(u.slice(2,4))),this._des3=p.createEncryptor(n.create(u.slice(4,6)))},encryptBlock:function(u,c){this._des1.encryptBlock(u,c),this._des2.decryptBlock(u,c),this._des3.encryptBlock(u,c)},decryptBlock:function(u,c){this._des3.decryptBlock(u,c),this._des2.encryptBlock(u,c),this._des1.decryptBlock(u,c)},keySize:6,ivSize:2,blockSize:2}),r.TripleDES=s._createHelper(a)})();(function(){var e=J,t=e.lib.WordArray;e.enc.Base64={stringify:function(r){var n=r.words,s=r.sigBytes,a=this._map;r.clamp(),r=[];for(var o=0;o<s;o+=3)for(var i=(n[o>>>2]>>>24-8*(o%4)&255)<<16|(n[o+1>>>2]>>>24-8*((o+1)%4)&255)<<8|n[o+2>>>2]>>>24-8*((o+2)%4)&255,h=0;4>h&&o+.75*h<s;h++)r.push(a.charAt(i>>>6*(3-h)&63));if(n=a.charAt(64))for(;r.length%4;)r.push(n);return r.join("")},parse:function(r){var n=r.length,s=this._map,a=s.charAt(64);a&&(a=r.indexOf(a),a!=-1&&(n=a));for(var a=[],o=0,i=0;i<n;i++)if(i%4){var h=s.indexOf(r.charAt(i-1))<<2*(i%4),l=s.indexOf(r.charAt(i))>>>6-2*(i%4);a[o>>>2]|=(h|l)<<24-8*(o%4),o++}return t.create(a,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})();(function(e){function t(p,u,c,x,f,v,y){return p=p+(u&c|~u&x)+f+y,(p<<v|p>>>32-v)+u}function r(p,u,c,x,f,v,y){return p=p+(u&x|c&~x)+f+y,(p<<v|p>>>32-v)+u}function n(p,u,c,x,f,v,y){return p=p+(u^c^x)+f+y,(p<<v|p>>>32-v)+u}function s(p,u,c,x,f,v,y){return p=p+(c^(u|~x))+f+y,(p<<v|p>>>32-v)+u}for(var a=J,h=a.lib,o=h.WordArray,i=h.Hasher,h=a.algo,l=[],d=0;64>d;d++)l[d]=4294967296*e.abs(e.sin(d+1))|0;h=h.MD5=i.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(p,u){for(var c=0;16>c;c++){var x=u+c,f=p[x];p[x]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360}var c=this._hash.words,x=p[u+0],f=p[u+1],v=p[u+2],y=p[u+3],m=p[u+4],b=p[u+5],E=p[u+6],P=p[u+7],F=p[u+8],D=p[u+9],S=p[u+10],w=p[u+11],C=p[u+12],A=p[u+13],B=p[u+14],R=p[u+15],_=c[0],K=c[1],N=c[2],I=c[3],_=t(_,K,N,I,x,7,l[0]),I=t(I,_,K,N,f,12,l[1]),N=t(N,I,_,K,v,17,l[2]),K=t(K,N,I,_,y,22,l[3]),_=t(_,K,N,I,m,7,l[4]),I=t(I,_,K,N,b,12,l[5]),N=t(N,I,_,K,E,17,l[6]),K=t(K,N,I,_,P,22,l[7]),_=t(_,K,N,I,F,7,l[8]),I=t(I,_,K,N,D,12,l[9]),N=t(N,I,_,K,S,17,l[10]),K=t(K,N,I,_,w,22,l[11]),_=t(_,K,N,I,C,7,l[12]),I=t(I,_,K,N,A,12,l[13]),N=t(N,I,_,K,B,17,l[14]),K=t(K,N,I,_,R,22,l[15]),_=r(_,K,N,I,f,5,l[16]),I=r(I,_,K,N,E,9,l[17]),N=r(N,I,_,K,w,14,l[18]),K=r(K,N,I,_,x,20,l[19]),_=r(_,K,N,I,b,5,l[20]),I=r(I,_,K,N,S,9,l[21]),N=r(N,I,_,K,R,14,l[22]),K=r(K,N,I,_,m,20,l[23]),_=r(_,K,N,I,D,5,l[24]),I=r(I,_,K,N,B,9,l[25]),N=r(N,I,_,K,y,14,l[26]),K=r(K,N,I,_,F,20,l[27]),_=r(_,K,N,I,A,5,l[28]),I=r(I,_,K,N,v,9,l[29]),N=r(N,I,_,K,P,14,l[30]),K=r(K,N,I,_,C,20,l[31]),_=n(_,K,N,I,b,4,l[32]),I=n(I,_,K,N,F,11,l[33]),N=n(N,I,_,K,w,16,l[34]),K=n(K,N,I,_,B,23,l[35]),_=n(_,K,N,I,f,4,l[36]),I=n(I,_,K,N,m,11,l[37]),N=n(N,I,_,K,P,16,l[38]),K=n(K,N,I,_,S,23,l[39]),_=n(_,K,N,I,A,4,l[40]),I=n(I,_,K,N,x,11,l[41]),N=n(N,I,_,K,y,16,l[42]),K=n(K,N,I,_,E,23,l[43]),_=n(_,K,N,I,D,4,l[44]),I=n(I,_,K,N,C,11,l[45]),N=n(N,I,_,K,R,16,l[46]),K=n(K,N,I,_,v,23,l[47]),_=s(_,K,N,I,x,6,l[48]),I=s(I,_,K,N,P,10,l[49]),N=s(N,I,_,K,B,15,l[50]),K=s(K,N,I,_,b,21,l[51]),_=s(_,K,N,I,C,6,l[52]),I=s(I,_,K,N,y,10,l[53]),N=s(N,I,_,K,S,15,l[54]),K=s(K,N,I,_,f,21,l[55]),_=s(_,K,N,I,F,6,l[56]),I=s(I,_,K,N,R,10,l[57]),N=s(N,I,_,K,E,15,l[58]),K=s(K,N,I,_,A,21,l[59]),_=s(_,K,N,I,m,6,l[60]),I=s(I,_,K,N,w,10,l[61]),N=s(N,I,_,K,v,15,l[62]),K=s(K,N,I,_,D,21,l[63]);c[0]=c[0]+_|0,c[1]=c[1]+K|0,c[2]=c[2]+N|0,c[3]=c[3]+I|0},_doFinalize:function(){var p=this._data,u=p.words,c=8*this._nDataBytes,x=8*p.sigBytes;u[x>>>5]|=128<<24-x%32;var f=e.floor(c/4294967296);for(u[(x+64>>>9<<4)+15]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360,u[(x+64>>>9<<4)+14]=(c<<8|c>>>24)&16711935|(c<<24|c>>>8)&4278255360,p.sigBytes=4*(u.length+1),this._process(),p=this._hash,u=p.words,c=0;4>c;c++)x=u[c],u[c]=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360;return p},clone:function(){var p=i.clone.call(this);return p._hash=this._hash.clone(),p}}),a.MD5=i._createHelper(h),a.HmacMD5=i._createHmacHelper(h)})(Math);(function(){var e=J,s=e.lib,t=s.WordArray,r=s.Hasher,n=[],s=e.algo.SHA1=r.extend({_doReset:function(){this._hash=new t.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(a,o){for(var i=this._hash.words,h=i[0],l=i[1],d=i[2],p=i[3],u=i[4],c=0;80>c;c++){if(16>c)n[c]=a[o+c]|0;else{var x=n[c-3]^n[c-8]^n[c-14]^n[c-16];n[c]=x<<1|x>>>31}x=(h<<5|h>>>27)+u+n[c],x=20>c?x+((l&d|~l&p)+1518500249):40>c?x+((l^d^p)+1859775393):60>c?x+((l&d|l&p|d&p)-1894007588):x+((l^d^p)-899497514),u=p,p=d,d=l<<30|l>>>2,l=h,h=x}i[0]=i[0]+h|0,i[1]=i[1]+l|0,i[2]=i[2]+d|0,i[3]=i[3]+p|0,i[4]=i[4]+u|0},_doFinalize:function(){var a=this._data,o=a.words,i=8*this._nDataBytes,h=8*a.sigBytes;return o[h>>>5]|=128<<24-h%32,o[(h+64>>>9<<4)+14]=Math.floor(i/4294967296),o[(h+64>>>9<<4)+15]=i,a.sigBytes=4*o.length,this._process(),this._hash},clone:function(){var a=r.clone.call(this);return a._hash=this._hash.clone(),a}});e.SHA1=r._createHelper(s),e.HmacSHA1=r._createHmacHelper(s)})();(function(e){for(var t=J,c=t.lib,r=c.WordArray,n=c.Hasher,c=t.algo,s=[],a=[],o=function(f){return 4294967296*(f-(f|0))|0},i=2,h=0;64>h;){var l;e:{l=i;for(var d=e.sqrt(l),p=2;p<=d;p++)if(!(l%p)){l=!1;break e}l=!0}l&&(8>h&&(s[h]=o(e.pow(i,.5))),a[h]=o(e.pow(i,1/3)),h++),i++}var u=[],c=c.SHA256=n.extend({_doReset:function(){this._hash=new r.init(s.slice(0))},_doProcessBlock:function(x,f){for(var v=this._hash.words,y=v[0],m=v[1],b=v[2],E=v[3],P=v[4],F=v[5],D=v[6],S=v[7],w=0;64>w;w++){if(16>w)u[w]=x[f+w]|0;else{var C=u[w-15],A=u[w-2];u[w]=((C<<25|C>>>7)^(C<<14|C>>>18)^C>>>3)+u[w-7]+((A<<15|A>>>17)^(A<<13|A>>>19)^A>>>10)+u[w-16]}C=S+((P<<26|P>>>6)^(P<<21|P>>>11)^(P<<7|P>>>25))+(P&F^~P&D)+a[w]+u[w],A=((y<<30|y>>>2)^(y<<19|y>>>13)^(y<<10|y>>>22))+(y&m^y&b^m&b),S=D,D=F,F=P,P=E+C|0,E=b,b=m,m=y,y=C+A|0}v[0]=v[0]+y|0,v[1]=v[1]+m|0,v[2]=v[2]+b|0,v[3]=v[3]+E|0,v[4]=v[4]+P|0,v[5]=v[5]+F|0,v[6]=v[6]+D|0,v[7]=v[7]+S|0},_doFinalize:function(){var x=this._data,f=x.words,v=8*this._nDataBytes,y=8*x.sigBytes;return f[y>>>5]|=128<<24-y%32,f[(y+64>>>9<<4)+14]=e.floor(v/4294967296),f[(y+64>>>9<<4)+15]=v,x.sigBytes=4*f.length,this._process(),this._hash},clone:function(){var x=n.clone.call(this);return x._hash=this._hash.clone(),x}});t.SHA256=n._createHelper(c),t.HmacSHA256=n._createHmacHelper(c)})(Math);(function(){var e=J,t=e.lib.WordArray,n=e.algo,r=n.SHA256,n=n.SHA224=r.extend({_doReset:function(){this._hash=new t.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var s=r._doFinalize.call(this);return s.sigBytes-=4,s}});e.SHA224=r._createHelper(n),e.HmacSHA224=r._createHmacHelper(n)})();(function(){function e(){return n.create.apply(n,arguments)}for(var t=J,r=t.lib.Hasher,a=t.x64,n=a.Word,s=a.WordArray,a=t.algo,o=[e(1116352408,3609767458),e(1899447441,602891725),e(3049323471,3964484399),e(3921009573,2173295548),e(961987163,4081628472),e(1508970993,3053834265),e(2453635748,2937671579),e(2870763221,3664609560),e(3624381080,2734883394),e(310598401,1164996542),e(607225278,1323610764),e(1426881987,3590304994),e(1925078388,4068182383),e(2162078206,991336113),e(2614888103,633803317),e(3248222580,3479774868),e(3835390401,2666613458),e(4022224774,944711139),e(264347078,2341262773),e(604807628,2007800933),e(770255983,1495990901),e(1249150122,1856431235),e(1555081692,3175218132),e(1996064986,2198950837),e(2554220882,3999719339),e(2821834349,766784016),e(2952996808,2566594879),e(3210313671,3203337956),e(3336571891,1034457026),e(3584528711,2466948901),e(113926993,3758326383),e(338241895,168717936),e(666307205,1188179964),e(773529912,1546045734),e(1294757372,1522805485),e(1396182291,2643833823),e(1695183700,2343527390),e(1986661051,1014477480),e(2177026350,1206759142),e(2456956037,344077627),e(2730485921,1290863460),e(2820302411,3158454273),e(3259730800,3505952657),e(3345764771,106217008),e(3516065817,3606008344),e(3600352804,1432725776),e(4094571909,1467031594),e(275423344,851169720),e(430227734,3100823752),e(506948616,1363258195),e(659060556,3750685593),e(883997877,3785050280),e(958139571,3318307427),e(1322822218,3812723403),e(1537002063,2003034995),e(1747873779,3602036899),e(1955562222,1575990012),e(2024104815,1125592928),e(2227730452,2716904306),e(2361852424,442776044),e(2428436474,593698344),e(2756734187,3733110249),e(3204031479,2999351573),e(3329325298,3815920427),e(3391569614,3928383900),e(3515267271,566280711),e(3940187606,3454069534),e(4118630271,4000239992),e(116418474,1914138554),e(174292421,2731055270),e(289380356,3203993006),e(460393269,320620315),e(685471733,587496836),e(852142971,1086792851),e(1017036298,365543100),e(1126000580,2618297676),e(1288033470,3409855158),e(1501505948,4234509866),e(1607167915,987167468),e(1816402316,1246189591)],i=[],h=0;80>h;h++)i[h]=e();a=a.SHA512=r.extend({_doReset:function(){this._hash=new s.init([new n.init(1779033703,4089235720),new n.init(3144134277,2227873595),new n.init(1013904242,4271175723),new n.init(2773480762,1595750129),new n.init(1359893119,2917565137),new n.init(2600822924,725511199),new n.init(528734635,4215389547),new n.init(1541459225,327033209)])},_doProcessBlock:function(l,d){for(var m=this._hash.words,p=m[0],u=m[1],c=m[2],x=m[3],f=m[4],v=m[5],y=m[6],m=m[7],b=p.high,E=p.low,P=u.high,F=u.low,D=c.high,S=c.low,w=x.high,C=x.low,A=f.high,B=f.low,R=v.high,_=v.low,I=y.high,N=y.low,K=m.high,L=m.low,H=b,T=E,k=P,q=F,$=D,Y=S,se=w,G=C,me=A,ye=B,He=R,ie=_,ne=I,re=N,xe=K,be=L,oe=0;80>oe;oe++){var it=i[oe];if(16>oe)var Pe=it.high=l[d+2*oe]|0,fe=it.low=l[d+2*oe+1]|0;else{var Pe=i[oe-15],fe=Pe.high,Ke=Pe.low,Pe=(fe>>>1|Ke<<31)^(fe>>>8|Ke<<24)^fe>>>7,Ke=(Ke>>>1|fe<<31)^(Ke>>>8|fe<<24)^(Ke>>>7|fe<<25),Re=i[oe-2],fe=Re.high,ae=Re.low,Re=(fe>>>19|ae<<13)^(fe<<3|ae>>>29)^fe>>>6,ae=(ae>>>19|fe<<13)^(ae<<3|fe>>>29)^(ae>>>6|fe<<26),fe=i[oe-7],ot=fe.high,qe=i[oe-16],Te=qe.high,qe=qe.low,fe=Ke+fe.low,Pe=Pe+ot+(fe>>>0<Ke>>>0?1:0),fe=fe+ae,Pe=Pe+Re+(fe>>>0<ae>>>0?1:0),fe=fe+qe,Pe=Pe+Te+(fe>>>0<qe>>>0?1:0);it.high=Pe,it.low=fe}var ot=me&He^~me&ne,qe=ye&ie^~ye&re,it=H&k^H&$^k&$,Fe=T&q^T&Y^q&Y,Ke=(H>>>28|T<<4)^(H<<30|T>>>2)^(H<<25|T>>>7),Re=(T>>>28|H<<4)^(T<<30|H>>>2)^(T<<25|H>>>7),ae=o[oe],Ce=ae.high,Lt=ae.low,ae=be+((ye>>>14|me<<18)^(ye>>>18|me<<14)^(ye<<23|me>>>9)),Te=xe+((me>>>14|ye<<18)^(me>>>18|ye<<14)^(me<<23|ye>>>9))+(ae>>>0<be>>>0?1:0),ae=ae+qe,Te=Te+ot+(ae>>>0<qe>>>0?1:0),ae=ae+Lt,Te=Te+Ce+(ae>>>0<Lt>>>0?1:0),ae=ae+fe,Te=Te+Pe+(ae>>>0<fe>>>0?1:0),fe=Re+Fe,it=Ke+it+(fe>>>0<Re>>>0?1:0),xe=ne,be=re,ne=He,re=ie,He=me,ie=ye,ye=G+ae|0,me=se+Te+(ye>>>0<G>>>0?1:0)|0,se=$,G=Y,$=k,Y=q,k=H,q=T,T=ae+fe|0,H=Te+it+(T>>>0<ae>>>0?1:0)|0}E=p.low=E+T,p.high=b+H+(E>>>0<T>>>0?1:0),F=u.low=F+q,u.high=P+k+(F>>>0<q>>>0?1:0),S=c.low=S+Y,c.high=D+$+(S>>>0<Y>>>0?1:0),C=x.low=C+G,x.high=w+se+(C>>>0<G>>>0?1:0),B=f.low=B+ye,f.high=A+me+(B>>>0<ye>>>0?1:0),_=v.low=_+ie,v.high=R+He+(_>>>0<ie>>>0?1:0),N=y.low=N+re,y.high=I+ne+(N>>>0<re>>>0?1:0),L=m.low=L+be,m.high=K+xe+(L>>>0<be>>>0?1:0)},_doFinalize:function(){var l=this._data,d=l.words,p=8*this._nDataBytes,u=8*l.sigBytes;return d[u>>>5]|=128<<24-u%32,d[(u+128>>>10<<5)+30]=Math.floor(p/4294967296),d[(u+128>>>10<<5)+31]=p,l.sigBytes=4*d.length,this._process(),this._hash.toX32()},clone:function(){var l=r.clone.call(this);return l._hash=this._hash.clone(),l},blockSize:32}),t.SHA512=r._createHelper(a),t.HmacSHA512=r._createHmacHelper(a)})();(function(){var e=J,s=e.x64,t=s.Word,r=s.WordArray,s=e.algo,n=s.SHA512,s=s.SHA384=n.extend({_doReset:function(){this._hash=new r.init([new t.init(3418070365,3238371032),new t.init(1654270250,914150663),new t.init(2438529370,812702999),new t.init(355462360,4144912697),new t.init(1731405415,4290775857),new t.init(2394180231,1750603025),new t.init(3675008525,1694076839),new t.init(1203062813,3204075428)])},_doFinalize:function(){var a=n._doFinalize.call(this);return a.sigBytes-=16,a}});e.SHA384=n._createHelper(s),e.HmacSHA384=n._createHmacHelper(s)})();(function(){var e=J,l=e.lib,t=l.WordArray,r=l.Hasher,l=e.algo,n=t.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),s=t.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),a=t.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),o=t.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),i=t.create([0,1518500249,1859775393,2400959708,2840853838]),h=t.create([1352829926,1548603684,1836072691,2053994217,0]),l=l.RIPEMD160=r.extend({_doReset:function(){this._hash=t.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(d,p){for(var u=0;16>u;u++){var c=p+u,x=d[c];d[c]=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360}var c=this._hash.words,x=i.words,f=h.words,v=n.words,y=s.words,m=a.words,b=o.words,E,P,F,D,S,w,C,A,B,R;w=E=c[0],C=P=c[1],A=F=c[2],B=D=c[3],R=S=c[4];for(var _,u=0;80>u;u+=1)_=E+d[p+v[u]]|0,_=16>u?_+((P^F^D)+x[0]):32>u?_+((P&F|~P&D)+x[1]):48>u?_+(((P|~F)^D)+x[2]):64>u?_+((P&D|F&~D)+x[3]):_+((P^(F|~D))+x[4]),_|=0,_=_<<m[u]|_>>>32-m[u],_=_+S|0,E=S,S=D,D=F<<10|F>>>22,F=P,P=_,_=w+d[p+y[u]]|0,_=16>u?_+((C^(A|~B))+f[0]):32>u?_+((C&B|A&~B)+f[1]):48>u?_+(((C|~A)^B)+f[2]):64>u?_+((C&A|~C&B)+f[3]):_+((C^A^B)+f[4]),_|=0,_=_<<b[u]|_>>>32-b[u],_=_+R|0,w=R,R=B,B=A<<10|A>>>22,A=C,C=_;_=c[1]+F+B|0,c[1]=c[2]+D+R|0,c[2]=c[3]+S+w|0,c[3]=c[4]+E+C|0,c[4]=c[0]+P+A|0,c[0]=_},_doFinalize:function(){var d=this._data,p=d.words,u=8*this._nDataBytes,c=8*d.sigBytes;for(p[c>>>5]|=128<<24-c%32,p[(c+64>>>9<<4)+14]=(u<<8|u>>>24)&16711935|(u<<24|u>>>8)&4278255360,d.sigBytes=4*(p.length+1),this._process(),d=this._hash,p=d.words,u=0;5>u;u++)c=p[u],p[u]=(c<<8|c>>>24)&16711935|(c<<24|c>>>8)&4278255360;return d},clone:function(){var d=r.clone.call(this);return d._hash=this._hash.clone(),d}});e.RIPEMD160=r._createHelper(l),e.HmacRIPEMD160=r._createHmacHelper(l)})(Math);(function(){var e=J,t=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(r,n){r=this._hasher=new r.init,typeof n=="string"&&(n=t.parse(n));var s=r.blockSize,a=4*s;n.sigBytes>a&&(n=r.finalize(n)),n.clamp();for(var o=this._oKey=n.clone(),i=this._iKey=n.clone(),h=o.words,l=i.words,d=0;d<s;d++)h[d]^=1549556828,l[d]^=909522486;o.sigBytes=i.sigBytes=a,this.reset()},reset:function(){var r=this._hasher;r.reset(),r.update(this._iKey)},update:function(r){return this._hasher.update(r),this},finalize:function(r){var n=this._hasher;return r=n.finalize(r),n.reset(),n.finalize(this._oKey.clone().concat(r))}})})();(function(){var e=J,n=e.lib,t=n.Base,r=n.WordArray,n=e.algo,s=n.HMAC,a=n.PBKDF2=t.extend({cfg:t.extend({keySize:4,hasher:n.SHA1,iterations:1}),init:function(o){this.cfg=this.cfg.extend(o)},compute:function(o,i){for(var x=this.cfg,h=s.create(x.hasher,o),l=r.create(),d=r.create([1]),p=l.words,u=d.words,c=x.keySize,x=x.iterations;p.length<c;){var f=h.update(i).finalize(d);h.reset();for(var v=f.words,y=v.length,m=f,b=1;b<x;b++){m=h.finalize(m),h.reset();for(var E=m.words,P=0;P<y;P++)v[P]^=E[P]}l.concat(f),u[0]++}return l.sigBytes=4*c,l}});e.PBKDF2=function(o,i,h){return a.create(h).compute(o,i)}})();var Pr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Fs="=";function qt(e){var t,r,n="";for(t=0;t+3<=e.length;t+=3)r=parseInt(e.substring(t,t+3),16),n+=Pr.charAt(r>>6)+Pr.charAt(r&63);if(t+1==e.length?(r=parseInt(e.substring(t,t+1),16),n+=Pr.charAt(r<<2)):t+2==e.length&&(r=parseInt(e.substring(t,t+2),16),n+=Pr.charAt(r>>2)+Pr.charAt((r&3)<<4)),Fs)for(;(n.length&3)>0;)n+=Fs;return n}function Fr(e){var t="",r,n=0,s,a;for(r=0;r<e.length&&e.charAt(r)!=Fs;++r)a=Pr.indexOf(e.charAt(r)),!(a<0)&&(n==0?(t+=jt(a>>2),s=a&3,n=1):n==1?(t+=jt(s<<2|a>>4),s=a&15,n=2):n==2?(t+=jt(s),t+=jt(a>>2),s=a&3,n=3):(t+=jt(s<<2|a>>4),t+=jt(a&15),n=0));return n==1&&(t+=jt(s<<2)),t}function au(e){var t=Fr(e),r,n=new Array;for(r=0;2*r<t.length;++r)n[r]=parseInt(t.substring(2*r,2*r+2),16);return n}var Xt,k1=0xdeadbeefcafe,tu=(k1&16777215)==15715070;function M(e,t,r){e!=null&&(typeof e=="number"?this.fromNumber(e,t,r):t==null&&typeof e!="string"?this.fromString(e,256):this.fromString(e,t))}function ce(){return new M(null)}function M1(e,t,r,n,s,a){for(;--a>=0;){var o=t*this[e++]+r[n]+s;s=Math.floor(o/67108864),r[n++]=o&67108863}return s}function V1(e,t,r,n,s,a){for(var o=t&32767,i=t>>15;--a>=0;){var h=this[e]&32767,l=this[e++]>>15,d=i*h+l*o;h=o*h+((d&32767)<<15)+r[n]+(s&1073741823),s=(h>>>30)+(d>>>15)+i*l+(s>>>30),r[n++]=h&1073741823}return s}function L1(e,t,r,n,s,a){for(var o=t&16383,i=t>>14;--a>=0;){var h=this[e]&16383,l=this[e++]>>14,d=i*h+l*o;h=o*h+((d&16383)<<14)+r[n]+s,s=(h>>28)+(d>>14)+i*l,r[n++]=h&268435455}return s}tu&&sn.appName=="Microsoft Internet Explorer"?(M.prototype.am=V1,Xt=30):tu&&sn.appName!="Netscape"?(M.prototype.am=M1,Xt=26):(M.prototype.am=L1,Xt=28);M.prototype.DB=Xt;M.prototype.DM=(1<<Xt)-1;M.prototype.DV=1<<Xt;var Is=52;M.prototype.FV=Math.pow(2,Is);M.prototype.F1=Is-Xt;M.prototype.F2=2*Xt-Is;var U1="0123456789abcdefghijklmnopqrstuvwxyz",_i=new Array,Cr,vt;Cr="0".charCodeAt(0);for(vt=0;vt<=9;++vt)_i[Cr++]=vt;Cr="a".charCodeAt(0);for(vt=10;vt<36;++vt)_i[Cr++]=vt;Cr="A".charCodeAt(0);for(vt=10;vt<36;++vt)_i[Cr++]=vt;function jt(e){return U1.charAt(e)}function ou(e,t){var r=_i[e.charCodeAt(t)];return r??-1}function z1(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s}function W1(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0}function Gt(e){var t=ce();return t.fromInt(e),t}function G1(e,t){var r;if(t==16)r=4;else if(t==8)r=3;else if(t==256)r=8;else if(t==2)r=1;else if(t==32)r=5;else if(t==4)r=2;else{this.fromRadix(e,t);return}this.t=0,this.s=0;for(var n=e.length,s=!1,a=0;--n>=0;){var o=r==8?e[n]&255:ou(e,n);if(o<0){e.charAt(n)=="-"&&(s=!0);continue}s=!1,a==0?this[this.t++]=o:a+r>this.DB?(this[this.t-1]|=(o&(1<<this.DB-a)-1)<<a,this[this.t++]=o>>this.DB-a):this[this.t-1]|=o<<a,a+=r,a>=this.DB&&(a-=this.DB)}r==8&&(e[0]&128)!=0&&(this.s=-1,a>0&&(this[this.t-1]|=(1<<this.DB-a)-1<<a)),this.clamp(),s&&M.ZERO.subTo(this,this)}function X1(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t}function J1(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else return this.toRadix(e);var r=(1<<t)-1,n,s=!1,a="",o=this.t,i=this.DB-o*this.DB%t;if(o-- >0)for(i<this.DB&&(n=this[o]>>i)>0&&(s=!0,a=jt(n));o>=0;)i<t?(n=(this[o]&(1<<i)-1)<<t-i,n|=this[--o]>>(i+=this.DB-t)):(n=this[o]>>(i-=t)&r,i<=0&&(i+=this.DB,--o)),n>0&&(s=!0),s&&(a+=jt(n));return s?a:"0"}function Y1(){var e=ce();return M.ZERO.subTo(this,e),e}function $1(){return this.s<0?this.negate():this}function Z1(e){var t=this.s-e.s;if(t!=0)return t;var r=this.t;if(t=r-e.t,t!=0)return this.s<0?-t:t;for(;--r>=0;)if((t=this[r]-e[r])!=0)return t;return 0}function Bi(e){var t=1,r;return(r=e>>>16)!=0&&(e=r,t+=16),(r=e>>8)!=0&&(e=r,t+=8),(r=e>>4)!=0&&(e=r,t+=4),(r=e>>2)!=0&&(e=r,t+=2),(r=e>>1)!=0&&(e=r,t+=1),t}function Q1(){return this.t<=0?0:this.DB*(this.t-1)+Bi(this[this.t-1]^this.s&this.DM)}function el(e,t){var r;for(r=this.t-1;r>=0;--r)t[r+e]=this[r];for(r=e-1;r>=0;--r)t[r]=0;t.t=this.t+e,t.s=this.s}function tl(e,t){for(var r=e;r<this.t;++r)t[r-e]=this[r];t.t=Math.max(this.t-e,0),t.s=this.s}function rl(e,t){var r=e%this.DB,n=this.DB-r,s=(1<<n)-1,a=Math.floor(e/this.DB),o=this.s<<r&this.DM,i;for(i=this.t-1;i>=0;--i)t[i+a+1]=this[i]>>n|o,o=(this[i]&s)<<r;for(i=a-1;i>=0;--i)t[i]=0;t[a]=o,t.t=this.t+a+1,t.s=this.s,t.clamp()}function nl(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t){t.t=0;return}var n=e%this.DB,s=this.DB-n,a=(1<<n)-1;t[0]=this[r]>>n;for(var o=r+1;o<this.t;++o)t[o-r-1]|=(this[o]&a)<<s,t[o-r]=this[o]>>n;n>0&&(t[this.t-r-1]|=(this.s&a)<<s),t.t=this.t-r,t.clamp()}function il(e,t){for(var r=0,n=0,s=Math.min(e.t,this.t);r<s;)n+=this[r]-e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e[r],t[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t[r++]=this.DV+n:n>0&&(t[r++]=n),t.t=r,t.clamp()}function sl(e,t){var r=this.abs(),n=e.abs(),s=r.t;for(t.t=s+n.t;--s>=0;)t[s]=0;for(s=0;s<n.t;++s)t[s+r.t]=r.am(0,n[s],t,s,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&M.ZERO.subTo(t,t)}function al(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t[r],e,2*r,0,1);(e[r+t.t]+=t.am(r+1,2*t[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e[r+t.t]-=t.DV,e[r+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(r,t[r],e,2*r,0,1)),e.s=0,e.clamp()}function ol(e,t,r){var n=e.abs();if(!(n.t<=0)){var s=this.abs();if(s.t<n.t){t?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=ce());var a=ce(),o=this.s,i=e.s,h=this.DB-Bi(n[n.t-1]);h>0?(n.lShiftTo(h,a),s.lShiftTo(h,r)):(n.copyTo(a),s.copyTo(r));var l=a.t,d=a[l-1];if(d!=0){var p=d*(1<<this.F1)+(l>1?a[l-2]>>this.F2:0),u=this.FV/p,c=(1<<this.F1)/p,x=1<<this.F2,f=r.t,v=f-l,y=t??ce();for(a.dlShiftTo(v,y),r.compareTo(y)>=0&&(r[r.t++]=1,r.subTo(y,r)),M.ONE.dlShiftTo(l,y),y.subTo(a,a);a.t<l;)a[a.t++]=0;for(;--v>=0;){var m=r[--f]==d?this.DM:Math.floor(r[f]*u+(r[f-1]+x)*c);if((r[f]+=a.am(0,m,r,v,0,l))<m)for(a.dlShiftTo(v,y),r.subTo(y,r);r[f]<--m;)r.subTo(y,r)}t!=null&&(r.drShiftTo(l,t),o!=i&&M.ZERO.subTo(t,t)),r.t=l,r.clamp(),h>0&&r.rShiftTo(h,r),o<0&&M.ZERO.subTo(r,r)}}}function ul(e){var t=ce();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(M.ZERO)>0&&e.subTo(t,t),t}function or(e){this.m=e}function fl(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function cl(e){return e}function hl(e){e.divRemTo(this.m,null,e)}function ll(e,t,r){e.multiplyTo(t,r),this.reduce(r)}function dl(e,t){e.squareTo(t),this.reduce(t)}or.prototype.convert=fl;or.prototype.revert=cl;or.prototype.reduce=hl;or.prototype.mulTo=ll;or.prototype.sqrTo=dl;function vl(){if(this.t<1)return 0;var e=this[0];if((e&1)==0)return 0;var t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function ur(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function pl(e){var t=ce();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(M.ZERO)>0&&this.m.subTo(t,t),t}function xl(e){var t=ce();return e.copyTo(t),this.reduce(t),t}function gl(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=e[t]&32767,n=r*this.mpl+((r*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e[r]+=this.m.am(0,n,e,t,0,this.m.t);e[r]>=e.DV;)e[r]-=e.DV,e[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function yl(e,t){e.squareTo(t),this.reduce(t)}function ml(e,t,r){e.multiplyTo(t,r),this.reduce(r)}ur.prototype.convert=pl;ur.prototype.revert=xl;ur.prototype.reduce=gl;ur.prototype.mulTo=ml;ur.prototype.sqrTo=yl;function Sl(){return(this.t>0?this[0]&1:this.s)==0}function bl(e,t){if(e>4294967295||e<1)return M.ONE;var r=ce(),n=ce(),s=t.convert(this),a=Bi(e)-1;for(s.copyTo(r);--a>=0;)if(t.sqrTo(r,n),(e&1<<a)>0)t.mulTo(n,s,r);else{var o=r;r=n,n=o}return t.revert(r)}function wl(e,t){var r;return e<256||t.isEven()?r=new or(t):r=new ur(t),this.exp(e,r)}M.prototype.copyTo=z1;M.prototype.fromInt=W1;M.prototype.fromString=G1;M.prototype.clamp=X1;M.prototype.dlShiftTo=el;M.prototype.drShiftTo=tl;M.prototype.lShiftTo=rl;M.prototype.rShiftTo=nl;M.prototype.subTo=il;M.prototype.multiplyTo=sl;M.prototype.squareTo=al;M.prototype.divRemTo=ol;M.prototype.invDigit=vl;M.prototype.isEven=Sl;M.prototype.exp=bl;M.prototype.toString=J1;M.prototype.negate=Y1;M.prototype.abs=$1;M.prototype.compareTo=Z1;M.prototype.bitLength=Q1;M.prototype.mod=ul;M.prototype.modPowInt=wl;M.ZERO=Gt(0);M.ONE=Gt(1);function El(){var e=ce();return this.copyTo(e),e}function Pl(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function Al(){return this.t==0?this.s:this[0]<<24>>24}function Fl(){return this.t==0?this.s:this[0]<<16>>16}function Cl(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function _l(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function Bl(e){if(e==null&&(e=10),this.signum()==0||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=Gt(r),s=ce(),a=ce(),o="";for(this.divRemTo(n,s,a);s.signum()>0;)o=(r+a.intValue()).toString(e).substr(1)+o,s.divRemTo(n,s,a);return a.intValue().toString(e)+o}function Dl(e,t){this.fromInt(0),t==null&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),s=!1,a=0,o=0,i=0;i<e.length;++i){var h=ou(e,i);if(h<0){e.charAt(i)=="-"&&this.signum()==0&&(s=!0);continue}o=t*o+h,++a>=r&&(this.dMultiply(n),this.dAddOffset(o,0),a=0,o=0)}a>0&&(this.dMultiply(Math.pow(t,a)),this.dAddOffset(o,0)),s&&M.ZERO.subTo(this,this)}function Il(e,t,r){if(typeof t=="number")if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(M.ONE.shiftLeft(e-1),Rs,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(M.ONE.shiftLeft(e-1),this);else{var n=new Array,s=e&7;n.length=(e>>3)+1,t.nextBytes(n),s>0?n[0]&=(1<<s)-1:n[0]=0,this.fromString(n,256)}}function Rl(){var e=this.t,t=new Array;t[0]=this.s;var r=this.DB-e*this.DB%8,n,s=0;if(e-- >0)for(r<this.DB&&(n=this[e]>>r)!=(this.s&this.DM)>>r&&(t[s++]=n|this.s<<this.DB-r);e>=0;)r<8?(n=(this[e]&(1<<r)-1)<<8-r,n|=this[--e]>>(r+=this.DB-8)):(n=this[e]>>(r-=8)&255,r<=0&&(r+=this.DB,--e)),(n&128)!=0&&(n|=-256),s==0&&(this.s&128)!=(n&128)&&++s,(s>0||n!=this.s)&&(t[s++]=n);return t}function Nl(e){return this.compareTo(e)==0}function Hl(e){return this.compareTo(e)<0?this:e}function Tl(e){return this.compareTo(e)>0?this:e}function Ol(e,t,r){var n,s,a=Math.min(e.t,this.t);for(n=0;n<a;++n)r[n]=t(this[n],e[n]);if(e.t<this.t){for(s=e.s&this.DM,n=a;n<this.t;++n)r[n]=t(this[n],s);r.t=this.t}else{for(s=this.s&this.DM,n=a;n<e.t;++n)r[n]=t(s,e[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()}function jl(e,t){return e&t}function ql(e){var t=ce();return this.bitwiseTo(e,jl,t),t}function Rs(e,t){return e|t}function Kl(e){var t=ce();return this.bitwiseTo(e,Rs,t),t}function uu(e,t){return e^t}function kl(e){var t=ce();return this.bitwiseTo(e,uu,t),t}function fu(e,t){return e&~t}function Ml(e){var t=ce();return this.bitwiseTo(e,fu,t),t}function Vl(){for(var e=ce(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e}function Ll(e){var t=ce();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}function Ul(e){var t=ce();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}function zl(e){if(e==0)return-1;var t=0;return(e&65535)==0&&(e>>=16,t+=16),(e&255)==0&&(e>>=8,t+=8),(e&15)==0&&(e>>=4,t+=4),(e&3)==0&&(e>>=2,t+=2),(e&1)==0&&++t,t}function Wl(){for(var e=0;e<this.t;++e)if(this[e]!=0)return e*this.DB+zl(this[e]);return this.s<0?this.t*this.DB:-1}function Gl(e){for(var t=0;e!=0;)e&=e-1,++t;return t}function Xl(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=Gl(this[r]^t);return e}function Jl(e){var t=Math.floor(e/this.DB);return t>=this.t?this.s!=0:(this[t]&1<<e%this.DB)!=0}function Yl(e,t){var r=M.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r}function $l(e){return this.changeBit(e,Rs)}function Zl(e){return this.changeBit(e,fu)}function Ql(e){return this.changeBit(e,uu)}function ed(e,t){for(var r=0,n=0,s=Math.min(e.t,this.t);r<s;)n+=this[r]+e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e[r],t[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t[r++]=n:n<-1&&(t[r++]=this.DV+n),t.t=r,t.clamp()}function td(e){var t=ce();return this.addTo(e,t),t}function rd(e){var t=ce();return this.subTo(e,t),t}function nd(e){var t=ce();return this.multiplyTo(e,t),t}function id(){var e=ce();return this.squareTo(e),e}function sd(e){var t=ce();return this.divRemTo(e,t,null),t}function ad(e){var t=ce();return this.divRemTo(e,null,t),t}function od(e){var t=ce(),r=ce();return this.divRemTo(e,t,r),new Array(t,r)}function ud(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function fd(e,t){if(e!=0){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}}function on(){}function cu(e){return e}function cd(e,t,r){e.multiplyTo(t,r)}function hd(e,t){e.squareTo(t)}on.prototype.convert=cu;on.prototype.revert=cu;on.prototype.mulTo=cd;on.prototype.sqrTo=hd;function ld(e){return this.exp(e,new on)}function dd(e,t,r){var n=Math.min(this.t+e.t,t);for(r.s=0,r.t=n;n>0;)r[--n]=0;var s;for(s=r.t-this.t;n<s;++n)r[n+this.t]=this.am(0,e[n],r,n,0,this.t);for(s=Math.min(e.t,t);n<s;++n)this.am(0,e[n],r,n,0,t-n);r.clamp()}function vd(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r[this.t+n-t]=this.am(t-n,e[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)}function _r(e){this.r2=ce(),this.q3=ce(),M.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function pd(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=ce();return e.copyTo(t),this.reduce(t),t}function xd(e){return e}function gd(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)}function yd(e,t){e.squareTo(t),this.reduce(t)}function md(e,t,r){e.multiplyTo(t,r),this.reduce(r)}_r.prototype.convert=pd;_r.prototype.revert=xd;_r.prototype.reduce=gd;_r.prototype.mulTo=md;_r.prototype.sqrTo=yd;function Sd(e,t){var r=e.bitLength(),n,s=Gt(1),a;if(r<=0)return s;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?a=new or(t):t.isEven()?a=new _r(t):a=new ur(t);var o=new Array,i=3,h=n-1,l=(1<<n)-1;if(o[1]=a.convert(this),n>1){var d=ce();for(a.sqrTo(o[1],d);i<=l;)o[i]=ce(),a.mulTo(d,o[i-2],o[i]),i+=2}var p=e.t-1,u,c=!0,x=ce(),f;for(r=Bi(e[p])-1;p>=0;){for(r>=h?u=e[p]>>r-h&l:(u=(e[p]&(1<<r+1)-1)<<h-r,p>0&&(u|=e[p-1]>>this.DB+r-h)),i=n;(u&1)==0;)u>>=1,--i;if((r-=i)<0&&(r+=this.DB,--p),c)o[u].copyTo(s),c=!1;else{for(;i>1;)a.sqrTo(s,x),a.sqrTo(x,s),i-=2;i>0?a.sqrTo(s,x):(f=s,s=x,x=f),a.mulTo(x,o[u],s)}for(;p>=0&&(e[p]&1<<r)==0;)a.sqrTo(s,x),f=s,s=x,x=f,--r<0&&(r=this.DB-1,--p)}return a.revert(s)}function bd(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var s=t.getLowestSetBit(),a=r.getLowestSetBit();if(a<0)return t;for(s<a&&(a=s),a>0&&(t.rShiftTo(a,t),r.rShiftTo(a,r));t.signum()>0;)(s=t.getLowestSetBit())>0&&t.rShiftTo(s,t),(s=r.getLowestSetBit())>0&&r.rShiftTo(s,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return a>0&&r.lShiftTo(a,r),r}function wd(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(t==0)r=this[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this[n])%e;return r}function Ed(e){var t=e.isEven();if(this.isEven()&&t||e.signum()==0)return M.ZERO;for(var r=e.clone(),n=this.clone(),s=Gt(1),a=Gt(0),o=Gt(0),i=Gt(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),t?((!s.isEven()||!a.isEven())&&(s.addTo(this,s),a.subTo(e,a)),s.rShiftTo(1,s)):a.isEven()||a.subTo(e,a),a.rShiftTo(1,a);for(;n.isEven();)n.rShiftTo(1,n),t?((!o.isEven()||!i.isEven())&&(o.addTo(this,o),i.subTo(e,i)),o.rShiftTo(1,o)):i.isEven()||i.subTo(e,i),i.rShiftTo(1,i);r.compareTo(n)>=0?(r.subTo(n,r),t&&s.subTo(o,s),a.subTo(i,a)):(n.subTo(r,n),t&&o.subTo(s,o),i.subTo(a,i))}if(n.compareTo(M.ONE)!=0)return M.ZERO;if(i.compareTo(e)>=0)return i.subtract(e);if(i.signum()<0)i.addTo(e,i);else return i;return i.signum()<0?i.add(e):i}var nt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],Pd=(1<<26)/nt[nt.length-1];function Ad(e){var t,r=this.abs();if(r.t==1&&r[0]<=nt[nt.length-1]){for(t=0;t<nt.length;++t)if(r[0]==nt[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<nt.length;){for(var n=nt[t],s=t+1;s<nt.length&&n<Pd;)n*=nt[s++];for(n=r.modInt(n);t<s;)if(n%nt[t++]==0)return!1}return r.millerRabin(e)}function Fd(e){var t=this.subtract(M.ONE),r=t.getLowestSetBit();if(r<=0)return!1;var n=t.shiftRight(r);e=e+1>>1,e>nt.length&&(e=nt.length);for(var s=ce(),a=0;a<e;++a){s.fromInt(nt[Math.floor(Math.random()*nt.length)]);var o=s.modPow(n,this);if(o.compareTo(M.ONE)!=0&&o.compareTo(t)!=0){for(var i=1;i++<r&&o.compareTo(t)!=0;)if(o=o.modPowInt(2,this),o.compareTo(M.ONE)==0)return!1;if(o.compareTo(t)!=0)return!1}}return!0}M.prototype.chunkSize=Cl;M.prototype.toRadix=Bl;M.prototype.fromRadix=Dl;M.prototype.fromNumber=Il;M.prototype.bitwiseTo=Ol;M.prototype.changeBit=Yl;M.prototype.addTo=ed;M.prototype.dMultiply=ud;M.prototype.dAddOffset=fd;M.prototype.multiplyLowerTo=dd;M.prototype.multiplyUpperTo=vd;M.prototype.modInt=wd;M.prototype.millerRabin=Fd;M.prototype.clone=El;M.prototype.intValue=Pl;M.prototype.byteValue=Al;M.prototype.shortValue=Fl;M.prototype.signum=_l;M.prototype.toByteArray=Rl;M.prototype.equals=Nl;M.prototype.min=Hl;M.prototype.max=Tl;M.prototype.and=ql;M.prototype.or=Kl;M.prototype.xor=kl;M.prototype.andNot=Ml;M.prototype.not=Vl;M.prototype.shiftLeft=Ll;M.prototype.shiftRight=Ul;M.prototype.getLowestSetBit=Wl;M.prototype.bitCount=Xl;M.prototype.testBit=Jl;M.prototype.setBit=$l;M.prototype.clearBit=Zl;M.prototype.flipBit=Ql;M.prototype.add=td;M.prototype.subtract=rd;M.prototype.multiply=nd;M.prototype.divide=sd;M.prototype.remainder=ad;M.prototype.divideAndRemainder=od;M.prototype.modPow=Sd;M.prototype.modInverse=Ed;M.prototype.pow=ld;M.prototype.gcd=bd;M.prototype.isProbablePrime=Ad;M.prototype.square=id;function Ns(){this.i=0,this.j=0,this.S=new Array}function Cd(e){var t,r,n;for(t=0;t<256;++t)this.S[t]=t;for(r=0,t=0;t<256;++t)r=r+this.S[t]+e[t%e.length]&255,n=this.S[t],this.S[t]=this.S[r],this.S[r]=n;this.i=0,this.j=0}function _d(){var e;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,e=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=e,this.S[e+this.S[this.i]&255]}Ns.prototype.init=Cd;Ns.prototype.next=_d;function Bd(){return new Ns}var Cs=256;var Pi,ft,Ue;function Dd(e){ft[Ue++]^=e&255,ft[Ue++]^=e>>8&255,ft[Ue++]^=e>>16&255,ft[Ue++]^=e>>24&255,Ue>=Cs&&(Ue-=Cs)}function Hs(){Dd(new Date().getTime())}if(ft==null){if(ft=new Array,Ue=0,Er!==void 0&&(Er.crypto!==void 0||Er.msCrypto!==void 0)){if(Es=Er.crypto||Er.msCrypto,Es.getRandomValues)for(Ps=new Uint8Array(32),Es.getRandomValues(Ps),dt=0;dt<32;++dt)ft[Ue++]=Ps[dt];else if(sn.appName=="Netscape"&&sn.appVersion<"5")for(As=Er.crypto.random(32),dt=0;dt<As.length;++dt)ft[Ue++]=As.charCodeAt(dt)&255}for(;Ue<Cs;)dt=Math.floor(65536*Math.random()),ft[Ue++]=dt>>>8,ft[Ue++]=dt&255;Ue=0,Hs()}var dt,Es,Ps,As;function Id(){if(Pi==null){for(Hs(),Pi=Bd(),Pi.init(ft),Ue=0;Ue<ft.length;++Ue)ft[Ue]=0;Ue=0}return Pi.next()}function Rd(e){var t;for(t=0;t<e.length;++t)e[t]=Id()}function Jt(){}Jt.prototype.nextBytes=Rd;function Qe(e,t){return new M(e,t)}function Nd(e,t){if(t<e.length+11)throw"Message too long for RSA";for(var r=new Array,n=e.length-1;n>=0&&t>0;){var s=e.charCodeAt(n--);s<128?r[--t]=s:s>127&&s<2048?(r[--t]=s&63|128,r[--t]=s>>6|192):(r[--t]=s&63|128,r[--t]=s>>6&63|128,r[--t]=s>>12|224)}r[--t]=0;for(var a=new Jt,o=new Array;t>2;){for(o[0]=0;o[0]==0;)a.nextBytes(o);r[--t]=o[0]}return r[--t]=2,r[--t]=0,new M(r)}function ru(e,t,r){for(var n="",s=0;n.length<t;)n+=r(String.fromCharCode.apply(String,e.concat([(s&4278190080)>>24,(s&16711680)>>16,(s&65280)>>8,s&255]))),s+=1;return n}function Hd(e,t,r,n){var s=g.crypto.MessageDigest,a=g.crypto.Util,o=null;if(r||(r="sha1"),typeof r=="string"&&(o=s.getCanonicalAlgName(r),n=s.getHashLength(o),r=function(f){return et(a.hashHex(pt(f),o))}),e.length+2*n+2>t)throw"Message too long for RSA";var i="",h;for(h=0;h<t-e.length-2*n-2;h+=1)i+="\0";var l=r("")+i+""+e,d=new Array(n);new Jt().nextBytes(d);var p=ru(d,l.length,r),u=[];for(h=0;h<l.length;h+=1)u[h]=l.charCodeAt(h)^p.charCodeAt(h);var c=ru(u,d.length,r),x=[0];for(h=0;h<d.length;h+=1)x[h+1]=d[h]^c.charCodeAt(h);return new M(x.concat(u))}function ee(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function Td(e,t){if(this.isPublic=!0,this.isPrivate=!1,typeof e!="string")this.n=e,this.e=t;else if(e!=null&&t!=null&&e.length>0&&t.length>0)this.n=Qe(e,16),this.e=parseInt(t,16);else throw"Invalid RSA public key"}function Od(e){return e.modPowInt(this.e,this.n)}function jd(e){var t=Nd(e,this.n.bitLength()+7>>3);if(t==null)return null;var r=this.doPublic(t);if(r==null)return null;var n=r.toString(16);return(n.length&1)==0?n:"0"+n}function qd(e,t,r){var n=this.n.bitLength()+7>>3,s=Hd(e,n,t,r);if(s==null)return null;var a=this.doPublic(s);if(a==null)return null;for(var o=a.toString(16);o.length<n*2;)o="0"+o;return o}ee.prototype.doPublic=Od;ee.prototype.setPublic=Td;ee.prototype.encrypt=jd;ee.prototype.encryptOAEP=qd;ee.prototype.type="RSA";function Kd(e,t){for(var r=e.toByteArray(),n=0;n<r.length&&r[n]==0;)++n;if(r.length-n!=t-1||r[n]!=2)return null;for(++n;r[n]!=0;)if(++n>=r.length)return null;for(var s="";++n<r.length;){var a=r[n]&255;a<128?s+=String.fromCharCode(a):a>191&&a<224?(s+=String.fromCharCode((a&31)<<6|r[n+1]&63),++n):(s+=String.fromCharCode((a&15)<<12|(r[n+1]&63)<<6|r[n+2]&63),n+=2)}return s}function nu(e,t,r){for(var n="",s=0;n.length<t;)n+=r(e+String.fromCharCode.apply(String,[(s&4278190080)>>24,(s&16711680)>>16,(s&65280)>>8,s&255])),s+=1;return n}function kd(e,t,r,n){var s=g.crypto.MessageDigest,a=g.crypto.Util,o=null;r||(r="sha1"),typeof r=="string"&&(o=s.getCanonicalAlgName(r),n=s.getHashLength(o),r=function(v){return et(a.hashHex(pt(v),o))}),e=e.toByteArray();var p;for(p=0;p<e.length;p+=1)e[p]&=255;for(;e.length<t;)e.unshift(0);if(e=String.fromCharCode.apply(String,e),e.length<2*n+2)throw"Cipher too short";var i=e.substr(1,n),h=e.substr(n+1),l=nu(h,n,r),d=[],p;for(p=0;p<i.length;p+=1)d[p]=i.charCodeAt(p)^l.charCodeAt(p);var u=nu(String.fromCharCode.apply(String,d),e.length-n,r),c=[];for(p=0;p<h.length;p+=1)c[p]=h.charCodeAt(p)^u.charCodeAt(p);if(c=String.fromCharCode.apply(String,c),c.substr(0,n)!==r(""))throw"Hash mismatch";c=c.substr(n);var x=c.indexOf(""),f=x!=-1?c.substr(0,x).lastIndexOf("\0"):-1;if(f+1!=x)throw"Malformed data";return c.substr(x+1)}function Md(e,t,r){if(this.isPrivate=!0,typeof e!="string")this.n=e,this.e=t,this.d=r;else if(e!=null&&t!=null&&e.length>0&&t.length>0)this.n=Qe(e,16),this.e=parseInt(t,16),this.d=Qe(r,16);else throw"Invalid RSA private key"}function Vd(e,t,r,n,s,a,o,i){if(this.isPrivate=!0,this.isPublic=!1,e==null)throw"RSASetPrivateEx N == null";if(t==null)throw"RSASetPrivateEx E == null";if(e.length==0)throw"RSASetPrivateEx N.length == 0";if(t.length==0)throw"RSASetPrivateEx E.length == 0";if(e!=null&&t!=null&&e.length>0&&t.length>0)this.n=Qe(e,16),this.e=parseInt(t,16),this.d=Qe(r,16),this.p=Qe(n,16),this.q=Qe(s,16),this.dmp1=Qe(a,16),this.dmq1=Qe(o,16),this.coeff=Qe(i,16);else throw"Invalid RSA private key in RSASetPrivateEx"}function Ld(e,t){var r=new Jt,n=e>>1;this.e=parseInt(t,16);for(var s=new M(t,16),a=e/2-100,o=M.ONE.shiftLeft(a);;){for(;this.p=new M(e-n,1,r),!(this.p.subtract(M.ONE).gcd(s).compareTo(M.ONE)==0&&this.p.isProbablePrime(10)););for(;this.q=new M(n,1,r),!(this.q.subtract(M.ONE).gcd(s).compareTo(M.ONE)==0&&this.q.isProbablePrime(10)););if(this.p.compareTo(this.q)<=0){var i=this.p;this.p=this.q,this.q=i}var h=this.q.subtract(this.p).abs();if(!(h.bitLength()<a||h.compareTo(o)<=0)){var l=this.p.subtract(M.ONE),d=this.q.subtract(M.ONE),p=l.multiply(d);if(p.gcd(s).compareTo(M.ONE)==0&&(this.n=this.p.multiply(this.q),this.n.bitLength()==e)){this.d=s.modInverse(p),this.dmp1=this.d.mod(l),this.dmq1=this.d.mod(d),this.coeff=this.q.modInverse(this.p);break}}}this.isPrivate=!0}function Ud(e){if(this.p==null||this.q==null)return e.modPow(this.d,this.n);for(var t=e.mod(this.p).modPow(this.dmp1,this.p),r=e.mod(this.q).modPow(this.dmq1,this.q);t.compareTo(r)<0;)t=t.add(this.p);return t.subtract(r).multiply(this.coeff).mod(this.p).multiply(this.q).add(r)}function zd(e){if(e.length!=Math.ceil(this.n.bitLength()/4))throw new Error("wrong ctext length");var t=Qe(e,16),r=this.doPrivate(t);return r==null?null:Kd(r,this.n.bitLength()+7>>3)}function Wd(e,t,r){if(e.length!=Math.ceil(this.n.bitLength()/4))throw new Error("wrong ctext length");var n=Qe(e,16),s=this.doPrivate(n);return s==null?null:kd(s,this.n.bitLength()+7>>3,t,r)}ee.prototype.doPrivate=Ud;ee.prototype.setPrivate=Md;ee.prototype.setPrivateEx=Vd;ee.prototype.generate=Ld;ee.prototype.decrypt=zd;ee.prototype.decryptOAEP=Wd;function Ve(e,t){this.x=t,this.q=e}function Gd(e){return e==this?!0:this.q.equals(e.q)&&this.x.equals(e.x)}function Xd(){return this.x}function Jd(){return new Ve(this.q,this.x.negate().mod(this.q))}function Yd(e){return new Ve(this.q,this.x.add(e.toBigInteger()).mod(this.q))}function $d(e){return new Ve(this.q,this.x.subtract(e.toBigInteger()).mod(this.q))}function Zd(e){return new Ve(this.q,this.x.multiply(e.toBigInteger()).mod(this.q))}function Qd(){return new Ve(this.q,this.x.square().mod(this.q))}function ev(e){return new Ve(this.q,this.x.multiply(e.toBigInteger().modInverse(this.q)).mod(this.q))}Ve.prototype.equals=Gd;Ve.prototype.toBigInteger=Xd;Ve.prototype.negate=Jd;Ve.prototype.add=Yd;Ve.prototype.subtract=$d;Ve.prototype.multiply=Zd;Ve.prototype.square=Qd;Ve.prototype.divide=ev;Ve.prototype.sqrt=function(){return new Ve(this.q,this.x.sqrt().mod(this.q))};function pe(e,t,r,n){this.curve=e,this.x=t,this.y=r,n==null?this.z=M.ONE:this.z=n,this.zinv=null}function tv(){return this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function rv(){return this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function nv(e){if(e==this)return!0;if(this.isInfinity())return e.isInfinity();if(e.isInfinity())return this.isInfinity();var t,r;return t=e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q),t.equals(M.ZERO)?(r=e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q),r.equals(M.ZERO)):!1}function iv(){return this.x==null&&this.y==null?!0:this.z.equals(M.ZERO)&&!this.y.toBigInteger().equals(M.ZERO)}function sv(){return new pe(this.curve,this.x,this.y.negate(),this.z)}function av(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q),r=e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q);if(M.ZERO.equals(r))return M.ZERO.equals(t)?this.twice():this.curve.getInfinity();var n=new M("3"),s=this.x.toBigInteger(),a=this.y.toBigInteger(),o=e.x.toBigInteger(),i=e.y.toBigInteger(),h=r.square(),l=h.multiply(r),d=s.multiply(h),p=t.square().multiply(this.z),u=p.subtract(d.shiftLeft(1)).multiply(e.z).subtract(l).multiply(r).mod(this.curve.q),c=d.multiply(n).multiply(t).subtract(a.multiply(l)).subtract(p.multiply(t)).multiply(e.z).add(t.multiply(l)).mod(this.curve.q),x=l.multiply(this.z).multiply(e.z).mod(this.curve.q);return new pe(this.curve,this.curve.fromBigInteger(u),this.curve.fromBigInteger(c),x)}function ov(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var e=new M("3"),t=this.x.toBigInteger(),r=this.y.toBigInteger(),n=r.multiply(this.z),s=n.multiply(r).mod(this.curve.q),a=this.curve.a.toBigInteger(),o=t.square().multiply(e);M.ZERO.equals(a)||(o=o.add(this.z.square().multiply(a))),o=o.mod(this.curve.q);var i=o.square().subtract(t.shiftLeft(3).multiply(s)).shiftLeft(1).multiply(n).mod(this.curve.q),h=o.multiply(e).multiply(t).subtract(s.shiftLeft(1)).shiftLeft(2).multiply(s).subtract(o.square().multiply(o)).mod(this.curve.q),l=n.square().multiply(n).shiftLeft(3).mod(this.curve.q);return new pe(this.curve,this.curve.fromBigInteger(i),this.curve.fromBigInteger(h),l)}function uv(e){if(this.isInfinity())return this;if(e.signum()==0)return this.curve.getInfinity();var t=e,r=t.multiply(new M("3")),n=this.negate(),s=this,a=this.curve.q.subtract(e),o=a.multiply(new M("3")),i=new pe(this.curve,this.x,this.y),h=i.negate(),l;for(l=r.bitLength()-2;l>0;--l){s=s.twice();var d=r.testBit(l),p=t.testBit(l);d!=p&&(s=s.add(d?this:n))}for(l=o.bitLength()-2;l>0;--l){i=i.twice();var u=o.testBit(l),c=a.testBit(l);u!=c&&(i=i.add(u?i:h))}return s}function fv(e,t,r){var n;e.bitLength()>r.bitLength()?n=e.bitLength()-1:n=r.bitLength()-1;for(var s=this.curve.getInfinity(),a=this.add(t);n>=0;)s=s.twice(),e.testBit(n)?r.testBit(n)?s=s.add(a):s=s.add(this):r.testBit(n)&&(s=s.add(t)),--n;return s}pe.prototype.getX=tv;pe.prototype.getY=rv;pe.prototype.equals=nv;pe.prototype.isInfinity=iv;pe.prototype.negate=sv;pe.prototype.add=av;pe.prototype.twice=ov;pe.prototype.multiply=uv;pe.prototype.multiplyTwo=fv;function Kt(e,t,r){this.q=e,this.a=this.fromBigInteger(t),this.b=this.fromBigInteger(r),this.infinity=new pe(this,null,null)}function cv(){return this.q}function hv(){return this.a}function lv(){return this.b}function dv(e){return e==this?!0:this.q.equals(e.q)&&this.a.equals(e.a)&&this.b.equals(e.b)}function vv(){return this.infinity}function pv(e){return new Ve(this.q,e)}function xv(e){switch(parseInt(e.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:var t=e.substr(0,2),r=e.substr(2),n=this.fromBigInteger(new M(l,16)),s=this.getA(),a=this.getB(),o=n.square().add(s).multiply(n).add(a),i=o.sqrt();return t=="03"&&(i=i.negate()),new pe(this,n,i);case 4:case 6:case 7:var h=(e.length-2)/2,l=e.substr(2,h),d=e.substr(h+2,h);return new pe(this,this.fromBigInteger(new M(l,16)),this.fromBigInteger(new M(d,16)));default:return null}}Kt.prototype.getQ=cv;Kt.prototype.getA=hv;Kt.prototype.getB=lv;Kt.prototype.equals=dv;Kt.prototype.getInfinity=vv;Kt.prototype.fromBigInteger=pv;Kt.prototype.decodePointHex=xv;Ve.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)};pe.prototype.getEncoded=function(e){var t=function(a,o){var i=a.toByteArrayUnsigned();if(o<i.length)i=i.slice(i.length-o);else for(;o>i.length;)i.unshift(0);return i},r=this.getX().toBigInteger(),n=this.getY().toBigInteger(),s=t(r,32);return e?n.isEven()?s.unshift(2):s.unshift(3):(s.unshift(4),s=s.concat(t(n,32))),s};pe.decodeFrom=function(e,t){var r=t[0],n=t.length-1,s=t.slice(1,1+n/2),a=t.slice(1+n/2,1+n);s.unshift(0),a.unshift(0);var o=new M(s),i=new M(a);return new pe(e,e.fromBigInteger(o),e.fromBigInteger(i))};pe.decodeFromHex=function(e,t){var r=t.substr(0,2),n=t.length-2,s=t.substr(2,n/2),a=t.substr(2+n/2,n/2),o=new M(s,16),i=new M(a,16);return new pe(e,e.fromBigInteger(o),e.fromBigInteger(i))};pe.prototype.add2D=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;if(this.x.equals(e.x))return this.y.equals(e.y)?this.twice():this.curve.getInfinity();var t=e.x.subtract(this.x),r=e.y.subtract(this.y),n=r.divide(t),s=n.square().subtract(this.x).subtract(e.x),a=n.multiply(this.x.subtract(s)).subtract(this.y);return new pe(this.curve,s,a)};pe.prototype.twice2D=function(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var e=this.curve.fromBigInteger(M.valueOf(2)),t=this.curve.fromBigInteger(M.valueOf(3)),r=this.x.square().multiply(t).add(this.curve.a).divide(this.y.multiply(e)),n=r.square().subtract(this.x.multiply(e)),s=r.multiply(this.x.subtract(n)).subtract(this.y);return new pe(this.curve,n,s)};pe.prototype.multiply2D=function(e){if(this.isInfinity())return this;if(e.signum()==0)return this.curve.getInfinity();var t=e,r=t.multiply(new M("3")),n=this.negate(),s=this,a;for(a=r.bitLength()-2;a>0;--a){s=s.twice();var o=r.testBit(a),i=t.testBit(a);o!=i&&(s=s.add2D(o?this:n))}return s};pe.prototype.isOnCurve=function(){var e=this.getX().toBigInteger(),t=this.getY().toBigInteger(),r=this.curve.getA().toBigInteger(),n=this.curve.getB().toBigInteger(),s=this.curve.getQ(),a=t.multiply(t).mod(s),o=e.multiply(e).multiply(e).add(r.multiply(e)).add(n).mod(s);return a.equals(o)};pe.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"};pe.prototype.validate=function(){var e=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var t=this.getX().toBigInteger(),r=this.getY().toBigInteger();if(t.compareTo(M.ONE)<0||t.compareTo(e.subtract(M.ONE))>0)throw new Error("x coordinate out of bounds");if(r.compareTo(M.ONE)<0||r.compareTo(e.subtract(M.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(e).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};var hu=function(){var e="(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)",t='(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))',r='(?:"'+t+'*")',n=new RegExp("(?:false|true|null|[\\{\\}\\[\\]]|"+e+"|"+r+")","g"),s=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),a={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"};function o(p,u,c){return u?a[u]:String.fromCharCode(parseInt(c,16))}var i=new String(""),h="\\",l={"{":Object,"[":Array},d=Object.hasOwnProperty;return function(p,u){var c=p.match(n),x,f=c[0],v=!1;f==="{"?x={}:f==="["?x=[]:(x=[],v=!0);for(var y,m=[x],b=1-v,E=c.length;b<E;++b){f=c[b];var P;switch(f.charCodeAt(0)){default:P=m[0],P[y||P.length]=+f,y=void 0;break;case 34:if(f=f.substring(1,f.length-1),f.indexOf(h)!==-1&&(f=f.replace(s,o)),P=m[0],!y)if(P instanceof Array)y=P.length;else{y=f||i;break}P[y]=f,y=void 0;break;case 91:P=m[0],m.unshift(P[y||P.length]=[]),y=void 0;break;case 93:m.shift();break;case 102:P=m[0],P[y||P.length]=!1,y=void 0;break;case 110:P=m[0],P[y||P.length]=null,y=void 0;break;case 116:P=m[0],P[y||P.length]=!0,y=void 0;break;case 123:P=m[0],m.unshift(P[y||P.length]={}),y=void 0;break;case 125:m.shift();break}}if(v){if(m.length!==1)throw new Error;x=x[0]}else if(m.length)throw new Error;if(u){var F=function(D,S){var w=D[S];if(w&&typeof w=="object"){var C=null;for(var A in w)if(d.call(w,A)&&w!==D){var B=F(w,A);B!==void 0?w[A]=B:(C||(C=[]),C.push(A))}if(C)for(var R=C.length;--R>=0;)delete w[C[R]]}return u.call(D,S,w)};x=F({"":x},"")}return x}}();(typeof g>"u"||!g)&&(g={});(typeof g.asn1>"u"||!g.asn1)&&(g.asn1={});g.asn1.ASN1Util=new function(){this.integerToByteHex=function(e){var t=e.toString(16);return t.length%2==1&&(t="0"+t),t},this.bigIntToMinTwosComplementsHex=function(e){return fn(e)},this.getPEMStringFromHex=function(e,t){return Ze(e,t)},this.newObject=function(e){var t=g,r=t.asn1,n=r.ASN1Object,s=r.DERBoolean,a=r.DERInteger,o=r.DERBitString,i=r.DEROctetString,h=r.DERNull,l=r.DERObjectIdentifier,d=r.DEREnumerated,p=r.DERUTF8String,u=r.DERNumericString,c=r.DERPrintableString,x=r.DERTeletexString,f=r.DERIA5String,v=r.DERUTCTime,y=r.DERGeneralizedTime,m=r.DERVisibleString,b=r.DERBMPString,E=r.DERSequence,P=r.DERSet,F=r.DERTaggedObject,D=r.ASN1Util.newObject;if(e instanceof r.ASN1Object)return e;var S=Object.keys(e);if(S.length!=1)throw new Error("key of param shall be only one.");var w=S[0];if(":asn1:bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:visstr:bmpstr:seq:set:tag:".indexOf(":"+w+":")==-1)throw new Error("undefined key: "+w);if(w=="bool")return new s(e[w]);if(w=="int")return new a(e[w]);if(w=="bitstr")return new o(e[w]);if(w=="octstr")return new i(e[w]);if(w=="null")return new h(e[w]);if(w=="oid")return new l(e[w]);if(w=="enum")return new d(e[w]);if(w=="utf8str")return new p(e[w]);if(w=="numstr")return new u(e[w]);if(w=="prnstr")return new c(e[w]);if(w=="telstr")return new x(e[w]);if(w=="ia5str")return new f(e[w]);if(w=="utctime")return new v(e[w]);if(w=="gentime")return new y(e[w]);if(w=="visstr")return new m(e[w]);if(w=="bmpstr")return new b(e[w]);if(w=="asn1")return new n(e[w]);if(w=="seq"){for(var C=e[w],A=[],B=0;B<C.length;B++){var R=D(C[B]);A.push(R)}return new E({array:A})}if(w=="set"){for(var C=e[w],A=[],B=0;B<C.length;B++){var R=D(C[B]);A.push(R)}return new P({array:A})}if(w=="tag"){var _=e[w];if(Object.prototype.toString.call(_)==="[object Array]"&&_.length==3){var I=D(_[2]);return new F({tag:_[0],explicit:_[1],obj:I})}else return new F(_)}},this.jsonToASN1HEX=function(e){var t=this.newObject(e);return t.tohex()}};g.asn1.ASN1Util.oidHexToInt=function(e){for(var s="",t=parseInt(e.substr(0,2),16),r=Math.floor(t/40),n=t%40,s=r+"."+n,a="",o=2;o<e.length;o+=2){var i=parseInt(e.substr(o,2),16),h=("00000000"+i.toString(2)).slice(-8);if(a=a+h.substr(1,7),h.substr(0,1)=="0"){var l=new M(a,2);s=s+"."+l.toString(10),a=""}}return s};g.asn1.ASN1Util.oidIntToHex=function(e){var t=function(i){var h=i.toString(16);return h.length==1&&(h="0"+h),h},r=function(i){var h="",l=new M(i,10),d=l.toString(2),p=7-d.length%7;p==7&&(p=0);for(var u="",c=0;c<p;c++)u+="0";d=u+d;for(var c=0;c<d.length-1;c+=7){var x=d.substr(c,7);c!=d.length-7&&(x="1"+x),h+=t(parseInt(x,2))}return h};if(!e.match(/^[0-9.]+$/))throw"malformed oid string: "+e;var n="",s=e.split("."),a=parseInt(s[0])*40+parseInt(s[1]);n+=t(a),s.splice(0,2);for(var o=0;o<s.length;o++)n+=r(s[o]);return n};g.asn1.ASN1Object=function(e){var t=!0,r=null,n="00",s="00",a="";this.params=null,this.getLengthHexFromValue=function(){if(typeof this.hV>"u"||this.hV==null)throw new Error("this.hV is null or undefined");if(this.hV.length%2==1)throw new Error("value hex must be even length: n="+a.length+",v="+this.hV);var o=this.hV.length/2,i=o.toString(16);if(i.length%2==1&&(i="0"+i),o<128)return i;var h=i.length/2;if(h>15)throw new Error("ASN.1 length too long to represent by 8x: n = "+o.toString(16));var l=128+h;return l.toString(16)+i},this.tohex=function(){return(this.hTLV==null||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getEncodedHex=function(){return this.tohex()},this.getValueHex=function(){return this.tohex(),this.hV},this.getFreshValueHex=function(){return""},this.setByParam=function(o){this.params=o},e!=null&&e.tlv!=null&&(this.hTLV=e.tlv,this.isModified=!1)};g.asn1.DERAbstractString=function(e){g.asn1.DERAbstractString.superclass.constructor.call(this);var t=null,r=null;this.getString=function(){return this.s},this.setString=function(n){this.hTLV=null,this.isModified=!0,this.s=n,this.hV=Ii(this.s).toLowerCase()},this.setStringHex=function(n){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=n},this.getFreshValueHex=function(){return this.hV},typeof e<"u"&&(typeof e=="string"?this.setString(e):typeof e.str<"u"?this.setString(e.str):typeof e.hex<"u"&&this.setStringHex(e.hex))};U(g.asn1.DERAbstractString,g.asn1.ASN1Object);g.asn1.DERAbstractTime=function(e){g.asn1.DERAbstractTime.superclass.constructor.call(this);var t=null,r=null;this.localDateToUTC=function(n){var s=n.getTime()+n.getTimezoneOffset()*6e4,a=new Date(s);return a},this.formatDate=function(n,s,a){var o=this.zeroPadding,i=this.localDateToUTC(n),h=String(i.getFullYear());s=="utc"&&(h=h.substr(2,2));var l=o(String(i.getMonth()+1),2),d=o(String(i.getDate()),2),p=o(String(i.getHours()),2),u=o(String(i.getMinutes()),2),c=o(String(i.getSeconds()),2),x=h+l+d+p+u+c;if(a===!0){var f=i.getMilliseconds();if(f!=0){var v=o(String(f),3);v=v.replace(/[0]+$/,""),x=x+"."+v}}return x+"Z"},this.zeroPadding=function(n,s){return n.length>=s?n:new Array(s-n.length+1).join("0")+n},this.setByParam=function(n){this.hV=null,this.hTLV=null,this.params=n},this.getString=function(){},this.setString=function(n){this.hTLV=null,this.isModified=!0,this.params==null&&(this.params={}),this.params.str=n},this.setByDate=function(n){this.hTLV=null,this.isModified=!0,this.params==null&&(this.params={}),this.params.date=n},this.setByDateValue=function(n,s,a,o,i,h){var l=new Date(Date.UTC(n,s-1,a,o,i,h,0));this.setByDate(l)},this.getFreshValueHex=function(){return this.hV}};U(g.asn1.DERAbstractTime,g.asn1.ASN1Object);g.asn1.DERAbstractStructured=function(e){g.asn1.DERAbstractString.superclass.constructor.call(this);var t=null;this.setByASN1ObjectArray=function(r){this.hTLV=null,this.isModified=!0,this.asn1Array=r},this.appendASN1Object=function(r){this.hTLV=null,this.isModified=!0,this.asn1Array.push(r)},this.asn1Array=new Array,typeof e<"u"&&typeof e.array<"u"&&(this.asn1Array=e.array)};U(g.asn1.DERAbstractStructured,g.asn1.ASN1Object);g.asn1.DERBoolean=function(e){g.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",e==!1?this.hTLV="010100":this.hTLV="0101ff"};U(g.asn1.DERBoolean,g.asn1.ASN1Object);g.asn1.DERInteger=function(e){g.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.params=null;var t=fn;this.setByBigInteger=function(r){this.isModified=!0,this.params={bigint:r}},this.setByInteger=function(r){this.isModified=!0,this.params=r},this.setValueHex=function(r){this.isModified=!0,this.params={hex:r}},this.getFreshValueHex=function(){var r=this.params,n=null;if(r==null)throw new Error("value not set");if(typeof r=="object"&&r.hex!=null)return this.hV=r.hex,this.hV;if(typeof r=="number")n=new M(String(r),10);else if(r.int!=null)n=new M(String(r.int),10);else if(r.bigint!=null)n=r.bigint;else throw new Error("wrong parameter");return this.hV=t(n),this.hV},e!=null&&(this.params=e)};U(g.asn1.DERInteger,g.asn1.ASN1Object);g.asn1.DERBitString=function(e){if(e!==void 0&&typeof e.obj<"u"){var t=g.asn1.ASN1Util.newObject(e.obj);e.hex="00"+t.tohex()}g.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(r){this.hTLV=null,this.isModified=!0,this.hV=r},this.setUnusedBitsAndHexValue=function(r,n){if(r<0||7<r)throw"unused bits shall be from 0 to 7: u = "+r;var s="0"+r;this.hTLV=null,this.isModified=!0,this.hV=s+n},this.setByBinaryString=function(r){r=r.replace(/0+$/,"");var n=8-r.length%8;n==8&&(n=0),r+="0000000".substr(0,n);for(var s="",a=0;a<r.length-1;a+=8){var o=r.substr(a,8),i=parseInt(o,2).toString(16);i.length==1&&(i="0"+i),s+=i}this.hTLV=null,this.isModified=!0,this.hV="0"+n+s},this.setByBooleanArray=function(r){for(var n="",s=0;s<r.length;s++)r[s]==!0?n+="1":n+="0";this.setByBinaryString(n)},this.newFalseArray=function(r){for(var n=new Array(r),s=0;s<r;s++)n[s]=!1;return n},this.getFreshValueHex=function(){return this.hV},typeof e<"u"&&(typeof e=="string"&&e.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(e):typeof e.hex<"u"?this.setHexValueIncludingUnusedBits(e.hex):typeof e.bin<"u"?this.setByBinaryString(e.bin):typeof e.array<"u"&&this.setByBooleanArray(e.array))};U(g.asn1.DERBitString,g.asn1.ASN1Object);g.asn1.DEROctetString=function(e){if(e!==void 0&&typeof e.obj<"u"){var t=g.asn1.ASN1Util.newObject(e.obj);e.hex=t.tohex()}g.asn1.DEROctetString.superclass.constructor.call(this,e),this.hT="04"};U(g.asn1.DEROctetString,g.asn1.DERAbstractString);g.asn1.DERNull=function(){g.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"};U(g.asn1.DERNull,g.asn1.ASN1Object);g.asn1.DERObjectIdentifier=function(e){g.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.setValueOidString=function(t){var r=yu(t);if(r==null)throw new Error("malformed oid string: "+t);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=r},this.setValueName=function(t){var r=g.asn1.x509.OID.name2oid(t);if(r!=="")this.setValueOidString(r);else throw new Error("DERObjectIdentifier oidName undefined: "+t)},this.setValueNameOrOid=function(t){t.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(t):this.setValueName(t)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(t){typeof t=="string"?this.setValueNameOrOid(t):t.oid!==void 0?this.setValueNameOrOid(t.oid):t.name!==void 0?this.setValueNameOrOid(t.name):t.hex!==void 0&&this.setValueHex(t.hex)},e!==void 0&&this.setByParam(e)};U(g.asn1.DERObjectIdentifier,g.asn1.ASN1Object);g.asn1.DEREnumerated=function(e){g.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(t){this.hTLV=null,this.isModified=!0,this.hV=fn(t)},this.setByInteger=function(t){var r=new M(String(t),10);this.setByBigInteger(r)},this.setValueHex=function(t){this.hV=t},this.getFreshValueHex=function(){return this.hV},typeof e<"u"&&(typeof e.int<"u"?this.setByInteger(e.int):typeof e=="number"?this.setByInteger(e):typeof e.hex<"u"&&this.setValueHex(e.hex))};U(g.asn1.DEREnumerated,g.asn1.ASN1Object);g.asn1.DERUTF8String=function(e){g.asn1.DERUTF8String.superclass.constructor.call(this,e),this.hT="0c"};U(g.asn1.DERUTF8String,g.asn1.DERAbstractString);g.asn1.DERNumericString=function(e){g.asn1.DERNumericString.superclass.constructor.call(this,e),this.hT="12"};U(g.asn1.DERNumericString,g.asn1.DERAbstractString);g.asn1.DERPrintableString=function(e){g.asn1.DERPrintableString.superclass.constructor.call(this,e),this.hT="13"};U(g.asn1.DERPrintableString,g.asn1.DERAbstractString);g.asn1.DERTeletexString=function(e){g.asn1.DERTeletexString.superclass.constructor.call(this,e),this.hT="14"};U(g.asn1.DERTeletexString,g.asn1.DERAbstractString);g.asn1.DERIA5String=function(e){g.asn1.DERIA5String.superclass.constructor.call(this,e),this.hT="16"};U(g.asn1.DERIA5String,g.asn1.DERAbstractString);g.asn1.DERVisibleString=function(e){g.asn1.DERIA5String.superclass.constructor.call(this,e),this.hT="1a"};U(g.asn1.DERVisibleString,g.asn1.DERAbstractString);g.asn1.DERBMPString=function(e){g.asn1.DERBMPString.superclass.constructor.call(this,e),this.hT="1e"};U(g.asn1.DERBMPString,g.asn1.DERAbstractString);g.asn1.DERUTCTime=function(e){g.asn1.DERUTCTime.superclass.constructor.call(this,e),this.hT="17",this.params=void 0,this.getFreshValueHex=function(){var t=this.params;if(this.params==null&&(t={date:new Date}),typeof t=="string")if(t.match(/^[0-9]{12}Z$/)||t.match(/^[0-9]{12}\.[0-9]+Z$/))this.hV=st(t);else throw new Error("malformed string for UTCTime: "+t);else if(t.str!=null)this.hV=st(t.str);else if(t.date==null&&t.millis==!0){var r=new Date;this.hV=st(this.formatDate(r,"utc",!0))}else if(t.date!=null&&t.date instanceof Date){var n=t.millis===!0;this.hV=st(this.formatDate(t.date,"utc",n))}else t instanceof Date&&(this.hV=st(this.formatDate(t,"utc")));if(this.hV==null)throw new Error("parameter not specified properly for UTCTime");return this.hV},e!=null&&this.setByParam(e)};U(g.asn1.DERUTCTime,g.asn1.DERAbstractTime);g.asn1.DERGeneralizedTime=function(e){g.asn1.DERGeneralizedTime.superclass.constructor.call(this,e),this.hT="18",this.params=e,this.getFreshValueHex=function(){var t=this.params;if(this.params==null&&(t={date:new Date}),typeof t=="string")if(t.match(/^[0-9]{14}Z$/)||t.match(/^[0-9]{14}\.[0-9]+Z$/))this.hV=st(t);else throw new Error("malformed string for GeneralizedTime: "+t);else if(t.str!=null)this.hV=st(t.str);else if(t.date==null&&t.millis==!0){var r=new Date;this.hV=st(this.formatDate(r,"gen",!0))}else if(t.date!=null&&t.date instanceof Date){var n=t.millis===!0;this.hV=st(this.formatDate(t.date,"gen",n))}else t instanceof Date&&(this.hV=st(this.formatDate(t,"gen")));if(this.hV==null)throw new Error("parameter not specified properly for GeneralizedTime");return this.hV},e!=null&&this.setByParam(e)};U(g.asn1.DERGeneralizedTime,g.asn1.DERAbstractTime);g.asn1.DERSequence=function(e){g.asn1.DERSequence.superclass.constructor.call(this,e),this.hT="30",this.getFreshValueHex=function(){for(var t="",r=0;r<this.asn1Array.length;r++){var n=this.asn1Array[r];t+=n.tohex()}return this.hV=t,this.hV}};U(g.asn1.DERSequence,g.asn1.DERAbstractStructured);g.asn1.DERSet=function(e){g.asn1.DERSet.superclass.constructor.call(this,e),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var t=new Array,r=0;r<this.asn1Array.length;r++){var n=this.asn1Array[r];t.push(n.tohex())}return this.sortFlag==!0&&t.sort(),this.hV=t.join(""),this.hV},typeof e<"u"&&typeof e.sortflag<"u"&&e.sortflag==!1&&(this.sortFlag=!1)};U(g.asn1.DERSet,g.asn1.DERAbstractStructured);g.asn1.DERTaggedObject=function(e){g.asn1.DERTaggedObject.superclass.constructor.call(this);var t=g.asn1,r=W,n=r.getV,s=r.isASN1HEX,a=t.ASN1Util.newObject;this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.params={tag:"a0",explicit:!0},this.setASN1Object=function(o,i,h){this.params={tag:i,explicit:o,obj:h}},this.getFreshValueHex=function(){var o=this.params;if(o.explicit==null&&(o.explicit=!0),o.tage!=null&&(o.tag=o.tage,o.explicit=!0),o.tagi!=null&&(o.tag=o.tagi,o.explicit=!1),o.str!=null)this.hV=Ii(o.str);else if(o.hex!=null)this.hV=o.hex;else if(o.obj!=null){var i;o.obj instanceof t.ASN1Object?i=o.obj.tohex():typeof o.obj=="object"&&(i=a(o.obj).tohex()),o.explicit?this.hV=i:this.hV=n(i,0)}else throw new Error("str, hex nor obj not specified");return o.tag==null&&(o.tag="a0"),this.hT=o.tag,this.hTLV=null,this.isModified=!0,this.hV},this.setByParam=function(o){this.params=o},e!==void 0&&this.setByParam(e)};U(g.asn1.DERTaggedObject,g.asn1.ASN1Object);var W=new function(){};W.getLblen=function(e,t){if(e.substr(t+2,1)!="8")return 1;var r=parseInt(e.substr(t+3,1));return r==0?-1:0<r&&r<10?r+1:-2};W.getL=function(e,t){var r=W.getLblen(e,t);return r<1?"":e.substr(t+2,r*2)};W.getVblen=function(e,t){var r,n;return r=W.getL(e,t),r==""?-1:(r.substr(0,1)==="8"?n=new M(r.substr(2),16):n=new M(r,16),n.intValue())};W.getVidx=function(e,t){var r=W.getLblen(e,t);return r<0?r:t+(r+1)*2};W.getV=function(e,t){var r=W.getVidx(e,t),n=W.getVblen(e,t);return e.substr(r,n*2)};W.getTLV=function(e,t){return e.substr(t,2)+W.getL(e,t)+W.getV(e,t)};W.getTLVblen=function(e,t){return 2+W.getLblen(e,t)*2+W.getVblen(e,t)*2};W.getNextSiblingIdx=function(e,t){var r=W.getVidx(e,t),n=W.getVblen(e,t);return r+n*2};W.getChildIdx=function(e,t){var r=W,n=[],s,a,o;s=r.getVidx(e,t),a=r.getVblen(e,t)*2,e.substr(t,2)=="03"&&(s+=2,a-=2),o=0;for(var i=s;o<=a;){var h=r.getTLVblen(e,i);if(o+=h,o<=a&&n.push(i),i+=h,o>=a)break}return n};W.getNthChildIdx=function(e,t,r){var n=W.getChildIdx(e,t);return n[r]};W.getIdxbyList=function(e,t,r,n){var s=W,a,o;return r.length==0?n!==void 0&&e.substr(t,2)!==n?-1:t:(a=r.shift(),o=s.getChildIdx(e,t),a>=o.length?-1:s.getIdxbyList(e,o[a],r,n))};W.getIdxbyListEx=function(e,t,r,n){var s=W,a,o;if(r.length==0)return n!==void 0&&e.substr(t,2)!==n?-1:t;a=r.shift(),o=s.getChildIdx(e,t);for(var i=0,h=0;h<o.length;h++){var l=e.substr(o[h],2);if(typeof a=="number"&&!s.isContextTag(l)&&i==a||typeof a=="string"&&s.isContextTag(l,a))return s.getIdxbyListEx(e,o[h],r,n);s.isContextTag(l)||i++}return-1};W.getTLVbyList=function(e,t,r,n){var s=W,a=s.getIdxbyList(e,t,r,n);return a==-1||a>=e.length?null:s.getTLV(e,a)};W.getTLVbyListEx=function(e,t,r,n){var s=W,a=s.getIdxbyListEx(e,t,r,n);return a==-1?null:s.getTLV(e,a)};W.getVbyList=function(e,t,r,n,s){var a=W,o,i;return o=a.getIdxbyList(e,t,r,n),o==-1||o>=e.length?null:(i=a.getV(e,o),s===!0&&(i=i.substr(2)),i)};W.getVbyListEx=function(e,t,r,n,s){var a=W,o,i,h;return o=a.getIdxbyListEx(e,t,r,n),o==-1?null:(h=a.getV(e,o),e.substr(o,2)=="03"&&s!==!1&&(h=h.substr(2)),h)};W.getInt=function(e,t,r){r==null&&(r=-1);try{var n=e.substr(t,2);if(n!="02"&&n!="03")return r;var s=W.getV(e,t);return n=="02"?parseInt(s,16):Su(s)}catch{return r}};W.getOID=function(e,t,r){r==null&&(r=null);try{if(e.substr(t,2)!="06")return r;var n=W.getV(e,t);return Oi(n)}catch{return r}};W.getOIDName=function(e,t,r){r==null&&(r=null);try{var n=W.getOID(e,t,r);if(n==r)return r;var s=g.asn1.x509.OID.oid2name(n);return s==""?n:s}catch{return r}};W.getString=function(e,t,r){r==null&&(r=null);try{var n=W.getV(e,t);return et(n)}catch{return r}};W.hextooidstr=function(e){var t=function(p,u){return p.length>=u?p:new Array(u-p.length+1).join("0")+p},r=[],n=e.substr(0,2),s=parseInt(n,16);r[0]=new String(Math.floor(s/40)),r[1]=new String(s%40);for(var a=e.substr(2),o=[],i=0;i<a.length/2;i++)o.push(parseInt(a.substr(i*2,2),16));for(var h=[],l="",i=0;i<o.length;i++)o[i]&128?l=l+t((o[i]&127).toString(2),7):(l=l+t((o[i]&127).toString(2),7),h.push(new String(parseInt(l,2))),l="");var d=r.join(".");return h.length>0&&(d=d+"."+h.join(".")),d};W.dump=function(e,t,r,n){var s=W,a=s.getV,o=s.dump,i=s.getChildIdx,h=e;e instanceof g.asn1.ASN1Object&&(h=e.tohex());var l=function(D,S){if(D.length<=S*2)return D;var w=D.substr(0,S)+"..(total "+D.length/2+"bytes).."+D.substr(D.length-S,S);return w};t===void 0&&(t={ommit_long_octet:32}),r===void 0&&(r=0),n===void 0&&(n="");var d=t.ommit_long_octet,P=h.substr(r,2);if(P=="01"){var p=a(h,r);return p=="00"?n+`BOOLEAN FALSE
`:n+`BOOLEAN TRUE
`}if(P=="02"){var p=a(h,r);return n+"INTEGER "+l(p,d)+`
`}if(P=="03"){var p=a(h,r);if(s.isASN1HEX(p.substr(2))){var u=n+`BITSTRING, encapsulates
`;return u=u+o(p.substr(2),t,0,n+"  "),u}else return n+"BITSTRING "+l(p,d)+`
`}if(P=="04"){var p=a(h,r);if(s.isASN1HEX(p)){var u=n+`OCTETSTRING, encapsulates
`;return u=u+o(p,t,0,n+"  "),u}else return n+"OCTETSTRING "+l(p,d)+`
`}if(P=="05")return n+`NULL
`;if(P=="06"){var c=a(h,r),x=g.asn1.ASN1Util.oidHexToInt(c),f=g.asn1.x509.OID.oid2name(x),v=x.replace(/\./g," ");return f!=""?n+"ObjectIdentifier "+f+" ("+v+`)
`:n+"ObjectIdentifier ("+v+`)
`}if(P=="0a")return n+"ENUMERATED "+parseInt(a(h,r))+`
`;if(P=="0c")return n+"UTF8String '"+ge(a(h,r))+`'
`;if(P=="13")return n+"PrintableString '"+ge(a(h,r))+`'
`;if(P=="14")return n+"TeletexString '"+ge(a(h,r))+`'
`;if(P=="16")return n+"IA5String '"+ge(a(h,r))+`'
`;if(P=="17")return n+"UTCTime "+ge(a(h,r))+`
`;if(P=="18")return n+"GeneralizedTime "+ge(a(h,r))+`
`;if(P=="1a")return n+"VisualString '"+ge(a(h,r))+`'
`;if(P=="1e")return n+"BMPString '"+qs(a(h,r))+`'
`;if(P=="30"){if(h.substr(r,4)=="3000")return n+`SEQUENCE {}
`;var u=n+`SEQUENCE
`,y=i(h,r),m=t;if((y.length==2||y.length==3)&&h.substr(y[0],2)=="06"&&h.substr(y[y.length-1],2)=="04"){var f=s.oidname(a(h,y[0])),b=JSON.parse(JSON.stringify(t));b.x509ExtName=f,m=b}for(var E=0;E<y.length;E++)u=u+o(h,m,y[E],n+"  ");return u}if(P=="31"){for(var u=n+`SET
`,y=i(h,r),E=0;E<y.length;E++)u=u+o(h,t,y[E],n+"  ");return u}var P=parseInt(P,16);if((P&128)!=0){var F=P&31;if((P&32)!=0){for(var u=n+"["+F+`]
`,y=i(h,r),E=0;E<y.length;E++)u=u+o(h,t,y[E],n+"  ");return u}else{var p=a(h,r);if(W.isASN1HEX(p)){var u=n+"["+F+`]
`;return u=u+o(p,t,0,n+"  "),u}else(p.substr(0,8)=="68747470"||t.x509ExtName==="subjectAltName"&&F==2)&&(p=ge(p));var u=n+"["+F+"] "+p+`
`;return u}}return n+"UNKNOWN("+P+") "+a(h,r)+`
`};W.parse=function(e){var t=W,r=t.parse,n=t.isASN1HEX,s=t.getV,a=t.getTLV,o=t.getChildIdx,i=g.asn1,h=i.ASN1Util.oidHexToInt,l=i.x509.OID.oid2name,d=ge,p=qs,u=wv,c={"0c":"utf8str",12:"numstr",13:"prnstr",14:"telstr",16:"ia5str",17:"utctime",18:"gentime","1a":"visstr","1e":"bmpstr",30:"seq",31:"set"},x=function(w){for(var C=[],A=o(w,0),B=0;B<A.length;B++){var R=A[B],_=a(w,R),I=r(_);C.push(I)}return C},f=e.substr(0,2),v={},y=s(e,0);if(f=="01")return e=="0101ff"?{bool:!0}:{bool:!1};if(f=="02")return{int:{hex:y}};if(f=="03")try{if(y.substr(0,2)!="00")throw"not encap";var m=y.substr(2);if(!n(m))throw"not encap";return{bitstr:{obj:r(m)}}}catch{var b=null;return y.length<=10&&(b=wu(y)),b==null?{bitstr:{hex:y}}:{bitstr:{bin:b}}}else if(f=="04")try{if(!n(y))throw"not encap";return{octstr:{obj:r(y)}}}catch{return{octstr:{hex:y}}}else{if(f=="05")return{null:""};if(f=="06"){var E=h(y),P=l(E);return P==""?{oid:E}:{oid:P}}else{if(f=="0a")return y.length>4?{enum:{hex:y}}:{enum:parseInt(y,16)};if(f=="30"||f=="31")return v[c[f]]=x(e),v;if(f=="14"){var F=u(y);return v[c[f]]={str:F},v}else if(f=="1e"){var F=p(y);return v[c[f]]={str:F},v}else if(":0c:12:13:16:17:18:1a:".indexOf(f)!=-1){var F=d(y);return v[c[f]]={str:F},v}else if(f.match(/^8[0-9]$/)){var F=d(y);return F==null|F==""?{tag:{tag:f,explicit:!1,hex:y}}:F.match(/[\x00-\x1F\x7F-\x9F]/)!=null||F.match(/[\u0000-\u001F\u0080\u009F]/)!=null?{tag:{tag:f,explicit:!1,hex:y}}:{tag:{tag:f,explicit:!1,str:F}}}else if(f.match(/^a[0-9]$/))try{if(!n(y))throw new Error("not encap");return{tag:{tag:f,explicit:!0,obj:r(y)}}}catch{return{tag:{tag:f,explicit:!0,hex:y}}}else{var D=new g.asn1.ASN1Object;D.hV=y;var S=D.getLengthHexFromValue();return{asn1:{tlv:f+S+y}}}}}};W.isContextTag=function(e,t){e=e.toLowerCase();var r,n;try{r=parseInt(e,16)}catch{return-1}if(t===void 0)return(r&192)==128;try{var s=t.match(/^\[[0-9]+\]$/);return s==null||(n=parseInt(t.substr(1,t.length-1),10),n>31)?!1:(r&192)==128&&(r&31)==n}catch{return!1}};W.isASN1HEX=function(e){var t=W;if(e.length%2==1)return!1;var r=t.getVblen(e,0),n=e.substr(0,2),s=t.getL(e,0),a=e.length-n.length-s.length;return a==r*2};W.checkStrictDER=function(e,t,r,n,s){var a=W;if(r===void 0){if(typeof e!="string")throw new Error("not hex string");if(e=e.toLowerCase(),!g.lang.String.isHex(e))throw new Error("not hex string");r=e.length,n=e.length/2,n<128?s=1:s=Math.ceil(n.toString(16))+1}var o=a.getL(e,t);if(o.length>s*2)throw new Error("L of TLV too long: idx="+t);var i=a.getVblen(e,t);if(i>n)throw new Error("value of L too long than hex: idx="+t);var h=a.getTLV(e,t),l=h.length-2-a.getL(e,t).length;if(l!==i*2)throw new Error("V string length and L's value not the same:"+l+"/"+i*2);if(t===0&&e.length!=h.length)throw new Error("total length and TLV length unmatch:"+e.length+"!="+h.length);var d=e.substr(t,2);if(d==="02"){var p=a.getVidx(e,t);if(e.substr(p,2)=="00"&&e.charCodeAt(p+2)<56)throw new Error("not least zeros for DER INTEGER")}if(parseInt(d,16)&32){for(var u=a.getVblen(e,t),c=0,x=a.getChildIdx(e,t),f=0;f<x.length;f++){var v=a.getTLV(e,x[f]);c+=v.length,a.checkStrictDER(e,x[f],r,n,s)}if(u*2!=c)throw new Error("sum of children's TLV length and L unmatch: "+u*2+"!="+c)}};W.oidname=function(e){var t=g.asn1;g.lang.String.isHex(e)&&(e=t.ASN1Util.oidHexToInt(e));var r=t.x509.OID.oid2name(e);return r===""&&(r=e),r};(typeof g>"u"||!g)&&(g={});(typeof g.asn1>"u"||!g.asn1)&&(g.asn1={});(typeof g.asn1.x509>"u"||!g.asn1.x509)&&(g.asn1.x509={});g.asn1.x509.Certificate=function(e){g.asn1.x509.Certificate.superclass.constructor.call(this);var t=g,r=t.asn1,n=r.DERBitString,s=r.DERSequence,a=r.x509,o=a.TBSCertificate,i=a.AlgorithmIdentifier;this.params=void 0,this.setByParam=function(h){this.params=h},this.sign=function(){var h=this.params,l=h.sigalg;h.sigalg.name!=null&&(l=h.sigalg.name);var d=h.tbsobj.tohex(),p=new g.crypto.Signature({alg:l});p.init(h.cakey),p.updateHex(d),h.sighex=p.sign()},this.getPEM=function(){return Ze(this.tohex(),"CERTIFICATE")},this.tohex=function(){var h=this.params;if((h.tbsobj==null||h.tbsobj==null)&&(h.tbsobj=new o(h)),h.sighex==null&&h.cakey!=null&&this.sign(),h.sighex==null)throw new Error("sighex or cakey parameter not defined");var l=[];l.push(h.tbsobj),l.push(new i({name:h.sigalg})),l.push(new n({hex:"00"+h.sighex}));var d=new s({array:l});return d.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&(this.params=e)};U(g.asn1.x509.Certificate,g.asn1.ASN1Object);g.asn1.x509.TBSCertificate=function(e){g.asn1.x509.TBSCertificate.superclass.constructor.call(this);var t=g,r=t.asn1,n=r.x509,s=r.DERTaggedObject,a=r.DERInteger,o=r.DERSequence,i=n.AlgorithmIdentifier,h=n.Time,l=n.X500Name,d=n.Extensions,p=n.SubjectPublicKeyInfo;this.params=null,this.setByParam=function(u){this.params=u},this.tohex=function(){var u=[],c=this.params;if(c.version!=null||c.version!=1){var x=2;c.version!=null&&(x=c.version-1);var f=new s({obj:new a({int:x})});u.push(f)}u.push(new a(c.serial)),u.push(new i({name:c.sigalg})),u.push(new l(c.issuer)),u.push(new o({array:[new h(c.notbefore),new h(c.notafter)]})),u.push(new l(c.subject)),u.push(new p(ue.getKey(c.sbjpubkey))),c.ext!==void 0&&c.ext.length>0&&u.push(new s({tag:"a3",obj:new d(c.ext)}));var v=new g.asn1.DERSequence({array:u});return v.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};U(g.asn1.x509.TBSCertificate,g.asn1.ASN1Object);g.asn1.x509.Extensions=function(e){g.asn1.x509.Extensions.superclass.constructor.call(this);var t=g,r=t.asn1,n=r.DERSequence,s=r.x509;this.aParam=[],this.setByParam=function(a){this.aParam=a},this.tohex=function(){for(var a=[],o=0;o<this.aParam.length;o++){var i=this.aParam[o],h=i.extname,l=null;if(i.extn!=null)l=new s.PrivateExtension(i);else if(h=="subjectKeyIdentifier")l=new s.SubjectKeyIdentifier(i);else if(h=="keyUsage")l=new s.KeyUsage(i);else if(h=="subjectAltName")l=new s.SubjectAltName(i);else if(h=="issuerAltName")l=new s.IssuerAltName(i);else if(h=="basicConstraints")l=new s.BasicConstraints(i);else if(h=="nameConstraints")l=new s.NameConstraints(i);else if(h=="cRLDistributionPoints")l=new s.CRLDistributionPoints(i);else if(h=="certificatePolicies")l=new s.CertificatePolicies(i);else if(h=="policyMappings")l=new s.PolicyMappings(i);else if(h=="policyConstraints")l=new s.PolicyConstraints(i);else if(h=="inhibitAnyPolicy")l=new s.InhibitAnyPolicy(i);else if(h=="authorityKeyIdentifier")l=new s.AuthorityKeyIdentifier(i);else if(h=="extKeyUsage")l=new s.ExtKeyUsage(i);else if(h=="authorityInfoAccess")l=new s.AuthorityInfoAccess(i);else if(h=="cRLNumber")l=new s.CRLNumber(i);else if(h=="cRLReason")l=new s.CRLReason(i);else if(h=="ocspNonce")l=new s.OCSPNonce(i);else if(h=="ocspNoCheck")l=new s.OCSPNoCheck(i);else if(h=="adobeTimeStamp")l=new s.AdobeTimeStamp(i);else if(h=="subjectDirectoryAttributes")l=new s.SubjectDirectoryAttributes(i);else throw new Error("extension not supported:"+JSON.stringify(i));l!=null&&a.push(l)}var d=new n({array:a});return d.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};U(g.asn1.x509.Extensions,g.asn1.ASN1Object);g.asn1.x509.Extension=function(e){g.asn1.x509.Extension.superclass.constructor.call(this);var t=null,r=g,n=r.asn1,s=n.DERObjectIdentifier,a=n.DEROctetString,o=n.DERBitString,i=n.DERBoolean,h=n.DERSequence;this.tohex=function(){var l=new s({oid:this.oid}),d=new a({hex:this.getExtnValueHex()}),p=new Array;p.push(l),this.critical&&p.push(new i),p.push(d);var u=new h({array:p});return u.tohex()},this.getEncodedHex=function(){return this.tohex()},this.critical=!1,e!==void 0&&e.critical!==void 0&&(this.critical=e.critical)};U(g.asn1.x509.Extension,g.asn1.ASN1Object);g.asn1.x509.KeyUsage=function(e){g.asn1.x509.KeyUsage.superclass.constructor.call(this,e);var t=Error,r={digitalSignature:0,nonRepudiation:1,keyEncipherment:2,dataEncipherment:3,keyAgreement:4,keyCertSign:5,cRLSign:6,encipherOnly:7,decipherOnly:8};this.getExtnValueHex=function(){var n=this.getBinValue();return this.asn1ExtnValue=new g.asn1.DERBitString({bin:n}),this.asn1ExtnValue.tohex()},this.getBinValue=function(){var n=this.params;if(typeof n!="object"||typeof n.names!="object"&&typeof n.bin!="string")throw new t("parameter not yet set");if(n.names!=null)return Ci(n.names,r);if(n.bin!=null)return n.bin;throw new t("parameter not set properly")},this.oid="2.5.29.15",e!==void 0&&(this.params=e)};U(g.asn1.x509.KeyUsage,g.asn1.x509.Extension);g.asn1.x509.BasicConstraints=function(e){g.asn1.x509.BasicConstraints.superclass.constructor.call(this,e);var t=g.asn1,r=t.DERBoolean,n=t.DERInteger,s=t.DERSequence,a=!1,o=-1;this.getExtnValueHex=function(){var i=new Array;this.cA&&i.push(new r),this.pathLen>-1&&i.push(new n({int:this.pathLen}));var h=new s({array:i});return this.asn1ExtnValue=h,this.asn1ExtnValue.tohex()},this.oid="2.5.29.19",this.cA=!1,this.pathLen=-1,e!==void 0&&(e.cA!==void 0&&(this.cA=e.cA),e.pathLen!==void 0&&(this.pathLen=e.pathLen))};U(g.asn1.x509.BasicConstraints,g.asn1.x509.Extension);g.asn1.x509.CRLDistributionPoints=function(e){g.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,e);var t=g,r=t.asn1,n=r.x509;this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.setByDPArray=function(s){for(var a=[],o=0;o<s.length;o++)if(s[o]instanceof g.asn1.ASN1Object)a.push(s[o]);else{var i=new n.DistributionPoint(s[o]);a.push(i)}this.asn1ExtnValue=new r.DERSequence({array:a})},this.setByOneURI=function(s){var a=new n.DistributionPoint({fulluri:s});this.setByDPArray([a])},this.oid="2.5.29.31",e!==void 0&&(e.array!==void 0?this.setByDPArray(e.array):e.uri!==void 0&&this.setByOneURI(e.uri))};U(g.asn1.x509.CRLDistributionPoints,g.asn1.x509.Extension);g.asn1.x509.DistributionPoint=function(e){g.asn1.x509.DistributionPoint.superclass.constructor.call(this);var t=null,r=g,n=r.asn1,s=n.x509.DistributionPointName;this.tohex=function(){var a=new n.DERSequence;if(this.asn1DP!=null){var o=new n.DERTaggedObject({explicit:!0,tag:"a0",obj:this.asn1DP});a.appendASN1Object(o)}return this.hTLV=a.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(e.dpobj!==void 0?this.asn1DP=e.dpobj:e.dpname!==void 0?this.asn1DP=new s(e.dpname):e.fulluri!==void 0&&(this.asn1DP=new s({full:[{uri:e.fulluri}]})))};U(g.asn1.x509.DistributionPoint,g.asn1.ASN1Object);g.asn1.x509.DistributionPointName=function(e){g.asn1.x509.DistributionPointName.superclass.constructor.call(this);var t=null,r=null,n=null,s=null,a=g,o=a.asn1,i=o.DERTaggedObject;if(this.tohex=function(){if(this.type!="full")throw new Error("currently type shall be 'full': "+this.type);return this.asn1Obj=new i({explicit:!1,tag:this.tag,obj:this.asn1V}),this.hTLV=this.asn1Obj.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0)if(o.x509.GeneralNames.prototype.isPrototypeOf(e))this.type="full",this.tag="a0",this.asn1V=e;else if(e.full!==void 0)this.type="full",this.tag="a0",this.asn1V=new o.x509.GeneralNames(e.full);else throw new Error("This class supports GeneralNames only as argument")};U(g.asn1.x509.DistributionPointName,g.asn1.ASN1Object);g.asn1.x509.CertificatePolicies=function(e){g.asn1.x509.CertificatePolicies.superclass.constructor.call(this,e);var t=g,r=t.asn1,n=r.x509,s=r.DERSequence,a=n.PolicyInformation;this.params=null,this.getExtnValueHex=function(){for(var o=[],i=0;i<this.params.array.length;i++)o.push(new a(this.params.array[i]));var h=new s({array:o});return this.asn1ExtnValue=h,this.asn1ExtnValue.tohex()},this.oid="2.5.29.32",e!==void 0&&(this.params=e)};U(g.asn1.x509.CertificatePolicies,g.asn1.x509.Extension);g.asn1.x509.PolicyInformation=function(e){g.asn1.x509.PolicyInformation.superclass.constructor.call(this,e);var t=g.asn1,r=t.DERSequence,n=t.DERObjectIdentifier,s=t.x509.PolicyQualifierInfo;this.params=null,this.tohex=function(){if(this.params.policyoid===void 0&&this.params.array===void 0)throw new Error("parameter oid and array missing");var a=[new n(this.params.policyoid)];if(this.params.array!==void 0){for(var o=[],i=0;i<this.params.array.length;i++)o.push(new s(this.params.array[i]));o.length>0&&a.push(new r({array:o}))}var h=new r({array:a});return h.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(this.params=e)};U(g.asn1.x509.PolicyInformation,g.asn1.ASN1Object);g.asn1.x509.PolicyQualifierInfo=function(e){g.asn1.x509.PolicyQualifierInfo.superclass.constructor.call(this,e);var t=g.asn1,r=t.DERSequence,n=t.DERIA5String,s=t.DERObjectIdentifier,a=t.x509.UserNotice;this.params=null,this.tohex=function(){if(this.params.cps!==void 0){var o=new r({array:[new s({oid:"1.3.6.1.5.5.7.2.1"}),new n({str:this.params.cps})]});return o.tohex()}if(this.params.unotice!=null){var o=new r({array:[new s({oid:"1.3.6.1.5.5.7.2.2"}),new a(this.params.unotice)]});return o.tohex()}},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(this.params=e)};U(g.asn1.x509.PolicyQualifierInfo,g.asn1.ASN1Object);g.asn1.x509.UserNotice=function(e){g.asn1.x509.UserNotice.superclass.constructor.call(this,e);var t=g.asn1.DERSequence,r=g.asn1.DERInteger,n=g.asn1.x509.DisplayText,s=g.asn1.x509.NoticeReference;this.params=null,this.tohex=function(){var a=[];this.params.noticeref!==void 0&&a.push(new s(this.params.noticeref)),this.params.exptext!==void 0&&a.push(new n(this.params.exptext));var o=new t({array:a});return o.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(this.params=e)};U(g.asn1.x509.UserNotice,g.asn1.ASN1Object);g.asn1.x509.NoticeReference=function(e){g.asn1.x509.NoticeReference.superclass.constructor.call(this,e);var t=g.asn1.DERSequence,r=g.asn1.DERInteger,n=g.asn1.x509.DisplayText;this.params=null,this.tohex=function(){var s=[];if(this.params.org!==void 0&&s.push(new n(this.params.org)),this.params.noticenum!==void 0){for(var a=[],o=this.params.noticenum,i=0;i<o.length;i++)a.push(new r(o[i]));s.push(new t({array:a}))}if(s.length==0)throw new Error("parameter is empty");var h=new t({array:s});return h.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(this.params=e)};U(g.asn1.x509.NoticeReference,g.asn1.ASN1Object);g.asn1.x509.DisplayText=function(e){g.asn1.x509.DisplayText.superclass.constructor.call(this,e),this.hT="0c",e!==void 0&&(e.type==="ia5"?this.hT="16":e.type==="vis"?this.hT="1a":e.type==="bmp"&&(this.hT="1e"))};U(g.asn1.x509.DisplayText,g.asn1.DERAbstractString);g.asn1.x509.PolicyMappings=function(e){g.asn1.x509.PolicyMappings.superclass.constructor.call(this,e);var t=g,r=t.asn1,n=r.x509,s=r.ASN1Util.newObject;this.params=null,this.getExtnValueHex=function(){for(var a=this.params,o=[],i=0;i<a.array.length;i++){var h=a.array[i];o.push({seq:[{oid:h[0]},{oid:h[1]}]})}return this.asn1ExtnValue=s({seq:o}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.33",e!==void 0&&(this.params=e)};U(g.asn1.x509.PolicyMappings,g.asn1.x509.Extension);g.asn1.x509.PolicyConstraints=function(e){g.asn1.x509.PolicyConstraints.superclass.constructor.call(this,e);var t=g,r=t.asn1,n=r.x509,s=r.ASN1Util.newObject;this.params=null,this.getExtnValueHex=function(){var a=this.params,o=[];return a.reqexp!=null&&o.push({tag:{tagi:"80",obj:{int:a.reqexp}}}),a.inhibit!=null&&o.push({tag:{tagi:"81",obj:{int:a.inhibit}}}),this.asn1ExtnValue=s({seq:o}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.36",e!==void 0&&(this.params=e)};U(g.asn1.x509.PolicyConstraints,g.asn1.x509.Extension);g.asn1.x509.InhibitAnyPolicy=function(e){g.asn1.x509.InhibitAnyPolicy.superclass.constructor.call(this,e);var t=g,r=t.asn1,n=r.x509,s=r.ASN1Util.newObject;this.params=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=s({int:this.params.skip}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.54",e!==void 0&&(this.params=e)};U(g.asn1.x509.InhibitAnyPolicy,g.asn1.x509.Extension);g.asn1.x509.NameConstraints=function(e){g.asn1.x509.NameConstraints.superclass.constructor.call(this,e);var t=g,r=t.asn1,n=r.x509,s=r.ASN1Util.newObject,a=n.GeneralSubtree;this.params=null,this.getExtnValueHex=function(){var o=this.params,i=[];if(o.permit!=null&&o.permit.length!=null){for(var h=[],l=0;l<o.permit.length;l++)h.push(new a(o.permit[l]));i.push({tag:{tagi:"a0",obj:{seq:h}}})}if(o.exclude!=null&&o.exclude.length!=null){for(var d=[],l=0;l<o.exclude.length;l++)d.push(new a(o.exclude[l]));i.push({tag:{tagi:"a1",obj:{seq:d}}})}return this.asn1ExtnValue=s({seq:i}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.30",e!==void 0&&(this.params=e)};U(g.asn1.x509.NameConstraints,g.asn1.x509.Extension);g.asn1.x509.GeneralSubtree=function(e){g.asn1.x509.GeneralSubtree.superclass.constructor.call(this);var t=g.asn1,r=t.x509,n=r.GeneralName,s=t.ASN1Util.newObject;this.params=null,this.setByParam=function(a){this.params=a},this.tohex=function(){var a=this.params,o=[new n(a)];a.min!=null&&o.push({tag:{tagi:"80",obj:{int:a.min}}}),a.max!=null&&o.push({tag:{tagi:"81",obj:{int:a.max}}});var i=s({seq:o});return i.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};U(g.asn1.x509.GeneralSubtree,g.asn1.ASN1Object);g.asn1.x509.ExtKeyUsage=function(e){g.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,e);var t=g,r=t.asn1;this.setPurposeArray=function(n){this.asn1ExtnValue=new r.DERSequence;for(var s=0;s<n.length;s++){var a=new r.DERObjectIdentifier(n[s]);this.asn1ExtnValue.appendASN1Object(a)}},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.37",e!==void 0&&e.array!==void 0&&this.setPurposeArray(e.array)};U(g.asn1.x509.ExtKeyUsage,g.asn1.x509.Extension);g.asn1.x509.AuthorityKeyIdentifier=function(e){g.asn1.x509.AuthorityKeyIdentifier.superclass.constructor.call(this,e);var t=g,r=t.asn1,n=r.DERTaggedObject,s=r.x509.GeneralNames,a=t.crypto.Util.isKey;this.asn1KID=null,this.asn1CertIssuer=null,this.asn1CertSN=null,this.getExtnValueHex=function(){var o=new Array;this.asn1KID&&o.push(new n({explicit:!1,tag:"80",obj:this.asn1KID})),this.asn1CertIssuer&&o.push(new n({explicit:!1,tag:"a1",obj:new s([{dn:this.asn1CertIssuer}])})),this.asn1CertSN&&o.push(new n({explicit:!1,tag:"82",obj:this.asn1CertSN}));var i=new r.DERSequence({array:o});return this.asn1ExtnValue=i,this.asn1ExtnValue.tohex()},this.setKIDByParam=function(o){if(o.str!==void 0||o.hex!==void 0)this.asn1KID=new g.asn1.DEROctetString(o);else if(typeof o=="object"&&g.crypto.Util.isKey(o)||typeof o=="string"&&o.indexOf("BEGIN ")!=-1){var i=o;typeof o=="string"&&(i=ue.getKey(o));var h=ue.getKeyID(i);this.asn1KID=new g.asn1.DEROctetString({hex:h})}},this.setCertIssuerByParam=function(o){o.str!==void 0||o.ldapstr!==void 0||o.hex!==void 0||o.certsubject!==void 0||o.certissuer!==void 0?this.asn1CertIssuer=new g.asn1.x509.X500Name(o):typeof o=="string"&&o.indexOf("BEGIN ")!=-1&&o.indexOf("CERTIFICATE")!=-1&&(this.asn1CertIssuer=new g.asn1.x509.X500Name({certissuer:o}))},this.setCertSNByParam=function(o){if(o.str!==void 0||o.bigint!==void 0||o.hex!==void 0)this.asn1CertSN=new g.asn1.DERInteger(o);else if(typeof o=="string"&&o.indexOf("BEGIN ")!=-1&&o.indexOf("CERTIFICATE")){var i=new te;i.readCertPEM(o);var h=i.getSerialNumberHex();this.asn1CertSN=new g.asn1.DERInteger({hex:h})}},this.oid="2.5.29.35",e!==void 0&&(e.kid!==void 0&&this.setKIDByParam(e.kid),e.issuer!==void 0&&this.setCertIssuerByParam(e.issuer),e.sn!==void 0&&this.setCertSNByParam(e.sn),e.issuersn!==void 0&&typeof e.issuersn=="string"&&e.issuersn.indexOf("BEGIN ")!=-1&&e.issuersn.indexOf("CERTIFICATE")&&(this.setCertSNByParam(e.issuersn),this.setCertIssuerByParam(e.issuersn)))};U(g.asn1.x509.AuthorityKeyIdentifier,g.asn1.x509.Extension);g.asn1.x509.SubjectKeyIdentifier=function(e){g.asn1.x509.SubjectKeyIdentifier.superclass.constructor.call(this,e);var t=g,r=t.asn1,n=r.DEROctetString;this.asn1KID=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=this.asn1KID,this.asn1ExtnValue.tohex()},this.setKIDByParam=function(s){if(s.str!==void 0||s.hex!==void 0)this.asn1KID=new n(s);else if(typeof s=="object"&&g.crypto.Util.isKey(s)||typeof s=="string"&&s.indexOf("BEGIN")!=-1){var a=s;typeof s=="string"&&(a=ue.getKey(s));var o=ue.getKeyID(a);this.asn1KID=new g.asn1.DEROctetString({hex:o})}},this.oid="2.5.29.14",e!==void 0&&e.kid!==void 0&&this.setKIDByParam(e.kid)};U(g.asn1.x509.SubjectKeyIdentifier,g.asn1.x509.Extension);g.asn1.x509.AuthorityInfoAccess=function(e){g.asn1.x509.AuthorityInfoAccess.superclass.constructor.call(this,e),this.setAccessDescriptionArray=function(t){for(var r=new Array,n=g,s=n.asn1,a=s.DERSequence,o=s.DERObjectIdentifier,i=s.x509.GeneralName,h=0;h<t.length;h++){var l,d=t[h];if(d.ocsp!==void 0)l=new a({array:[new o({oid:"1.3.6.1.5.5.7.48.1"}),new i({uri:d.ocsp})]});else if(d.caissuer!==void 0)l=new a({array:[new o({oid:"1.3.6.1.5.5.7.48.2"}),new i({uri:d.caissuer})]});else throw new Error("unknown AccessMethod parameter: "+JSON.stringify(d));r.push(l)}this.asn1ExtnValue=new a({array:r})},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.1.1",e!==void 0&&e.array!==void 0&&this.setAccessDescriptionArray(e.array)};U(g.asn1.x509.AuthorityInfoAccess,g.asn1.x509.Extension);g.asn1.x509.SubjectAltName=function(e){g.asn1.x509.SubjectAltName.superclass.constructor.call(this,e),this.setNameArray=function(t){this.asn1ExtnValue=new g.asn1.x509.GeneralNames(t)},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.17",e!==void 0&&e.array!==void 0&&this.setNameArray(e.array)};U(g.asn1.x509.SubjectAltName,g.asn1.x509.Extension);g.asn1.x509.IssuerAltName=function(e){g.asn1.x509.IssuerAltName.superclass.constructor.call(this,e),this.setNameArray=function(t){this.asn1ExtnValue=new g.asn1.x509.GeneralNames(t)},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.18",e!==void 0&&e.array!==void 0&&this.setNameArray(e.array)};U(g.asn1.x509.IssuerAltName,g.asn1.x509.Extension);g.asn1.x509.SubjectDirectoryAttributes=function(e){g.asn1.x509.SubjectDirectoryAttributes.superclass.constructor.call(this,e);var t=g.asn1,r=t.DERSequence,n=t.ASN1Util.newObject,s=t.x509.OID.name2oid;this.params=null,this.getExtnValueHex=function(){for(var a=[],o=0;o<this.params.array.length;o++){var i=this.params.array[o];if(i.attr!=null&&i.array!=null){var h={seq:[{oid:i.attr},{set:i.array}]};a.push(n(h));continue}var l={seq:[{oid:"1.2.3.4"},{set:[{utf8str:"DE"}]}]};if(i.attr=="dateOfBirth")l.seq[0].oid=s(i.attr),l.seq[1].set[0]={gentime:i.str};else if(i.attr=="placeOfBirth")l.seq[0].oid=s(i.attr),l.seq[1].set[0]={utf8str:i.str};else if(i.attr=="gender")l.seq[0].oid=s(i.attr),l.seq[1].set[0]={prnstr:i.str};else if(i.attr=="countryOfCitizenship")l.seq[0].oid=s(i.attr),l.seq[1].set[0]={prnstr:i.str};else if(i.attr=="countryOfResidence")l.seq[0].oid=s(i.attr),l.seq[1].set[0]={prnstr:i.str};else throw new Error("unsupported attribute: "+i.attr);a.push(new n(l))}var d=new r({array:a});return this.asn1ExtnValue=d,this.asn1ExtnValue.tohex()},this.oid="2.5.29.9",e!==void 0&&(this.params=e)};U(g.asn1.x509.SubjectDirectoryAttributes,g.asn1.x509.Extension);g.asn1.x509.PrivateExtension=function(e){g.asn1.x509.PrivateExtension.superclass.constructor.call(this,e);var t=g,r=t.lang.String.isHex,n=t.asn1,s=n.x509.OID.name2oid,a=n.ASN1Util.newObject;this.params=null,this.setByParam=function(o){this.oid=s(o.extname),this.params=o},this.getExtnValueHex=function(){if(this.params.extname==null||this.params.extn==null)throw new Error("extname or extnhex not specified");var o=this.params.extn;if(typeof o=="string"&&r(o))return o;if(typeof o=="object")try{return a(o).tohex()}catch{}throw new Error("unsupported extn value")},e!=null&&this.setByParam(e)};U(g.asn1.x509.PrivateExtension,g.asn1.x509.Extension);g.asn1.x509.CRL=function(e){g.asn1.x509.CRL.superclass.constructor.call(this);var t=g,r=t.asn1,n=r.DERSequence,s=r.DERBitString,a=r.x509,o=a.AlgorithmIdentifier,i=a.TBSCertList;this.params=void 0,this.setByParam=function(h){this.params=h},this.sign=function(){var h=new i(this.params).tohex(),l=new g.crypto.Signature({alg:this.params.sigalg});l.init(this.params.cakey),l.updateHex(h);var d=l.sign();this.params.sighex=d},this.getPEM=function(){return Ze(this.tohex(),"X509 CRL")},this.tohex=function(){var h=this.params;if(h.tbsobj==null&&(h.tbsobj=new i(h)),h.sighex==null&&h.cakey!=null&&this.sign(),h.sighex==null)throw new Error("sighex or cakey parameter not defined");var l=[];l.push(h.tbsobj),l.push(new o({name:h.sigalg})),l.push(new s({hex:"00"+h.sighex}));var d=new n({array:l});return d.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&(this.params=e)};U(g.asn1.x509.CRL,g.asn1.ASN1Object);g.asn1.x509.TBSCertList=function(e){g.asn1.x509.TBSCertList.superclass.constructor.call(this);var t=g,r=t.asn1,n=r.DERInteger,s=r.DERSequence,a=r.DERTaggedObject,o=r.DERObjectIdentifier,i=r.x509,h=i.AlgorithmIdentifier,l=i.Time,d=i.Extensions,p=i.X500Name;this.params=null,this.setByParam=function(u){this.params=u},this.getRevCertSequence=function(){for(var u=[],c=this.params.revcert,x=0;x<c.length;x++){var f=[new n(c[x].sn),new l(c[x].date)];c[x].ext!=null&&f.push(new d(c[x].ext)),u.push(new s({array:f}))}return new s({array:u})},this.tohex=function(){var u=[],c=this.params;if(c.version!=null){var x=c.version-1,f=new n({int:x});u.push(f)}if(u.push(new h({name:c.sigalg})),u.push(new p(c.issuer)),u.push(new l(c.thisupdate)),c.nextupdate!=null&&u.push(new l(c.nextupdate)),c.revcert!=null&&u.push(this.getRevCertSequence()),c.ext!=null){var v=new d(c.ext);u.push(new a({tag:"a0",explicit:!0,obj:v}))}var y=new s({array:u});return y.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};U(g.asn1.x509.TBSCertList,g.asn1.ASN1Object);g.asn1.x509.CRLEntry=function(e){g.asn1.x509.CRLEntry.superclass.constructor.call(this);var t=null,r=null,n=g,s=n.asn1;this.setCertSerial=function(a){this.sn=new s.DERInteger(a)},this.setRevocationDate=function(a){this.time=new s.x509.Time(a)},this.tohex=function(){var a=new s.DERSequence({array:[this.sn,this.time]});return this.TLV=a.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(e.time!==void 0&&this.setRevocationDate(e.time),e.sn!==void 0&&this.setCertSerial(e.sn))};U(g.asn1.x509.CRLEntry,g.asn1.ASN1Object);g.asn1.x509.CRLNumber=function(e){g.asn1.x509.CRLNumber.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new g.asn1.DERInteger(this.params.num),this.asn1ExtnValue.tohex()},this.oid="2.5.29.20",e!=null&&(this.params=e)};U(g.asn1.x509.CRLNumber,g.asn1.x509.Extension);g.asn1.x509.CRLReason=function(e){g.asn1.x509.CRLReason.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new g.asn1.DEREnumerated(this.params.code),this.asn1ExtnValue.tohex()},this.oid="2.5.29.21",e!=null&&(this.params=e)};U(g.asn1.x509.CRLReason,g.asn1.x509.Extension);g.asn1.x509.OCSPNonce=function(e){g.asn1.x509.OCSPNonce.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new g.asn1.DEROctetString(this.params),this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.48.1.2",e!=null&&(this.params=e)};U(g.asn1.x509.OCSPNonce,g.asn1.x509.Extension);g.asn1.x509.OCSPNoCheck=function(e){g.asn1.x509.OCSPNoCheck.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new g.asn1.DERNull,this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.48.1.5",e!=null&&(this.params=e)};U(g.asn1.x509.OCSPNoCheck,g.asn1.x509.Extension);g.asn1.x509.AdobeTimeStamp=function(e){g.asn1.x509.AdobeTimeStamp.superclass.constructor.call(this,e);var t=g,r=t.asn1,n=r.DERInteger,s=r.DERBoolean,a=r.DERSequence,o=r.x509.GeneralName;this.params=null,this.getExtnValueHex=function(){var i=this.params,h=[new n(1)];return h.push(new o({uri:i.uri})),i.reqauth!=null&&h.push(new s(i.reqauth)),this.asn1ExtnValue=new a({array:h}),this.asn1ExtnValue.tohex()},this.oid="1.2.840.113583.1.1.9.1",e!==void 0&&this.setByParam(e)};U(g.asn1.x509.AdobeTimeStamp,g.asn1.x509.Extension);g.asn1.x509.X500Name=function(e){g.asn1.x509.X500Name.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var t=g,r=t.asn1,n=r.x509,s=n.RDN,a=Ne;this.setByString=function(o,i){i!==void 0&&(this.sRule=i);var h=o.split("/");h.shift();for(var l=[],d=0;d<h.length;d++)if(h[d].match(/^[^=]+=.+$/))l.push(h[d]);else{var p=l.length-1;l[p]=l[p]+"/"+h[d]}for(var d=0;d<l.length;d++)this.asn1Array.push(new s({str:l[d],rule:this.sRule}))},this.setByLdapString=function(o,i){i!==void 0&&(this.sRule=i);var h=n.X500Name.ldapToCompat(o);this.setByString(h,i)},this.setByObject=function(o,i){i!==void 0&&(this.sRule=i);for(var h in o)if(o.hasOwnProperty(h)){var l=new s({str:h+"="+o[h],rule:this.sRule});this.asn1Array?this.asn1Array.push(l):this.asn1Array=[l]}},this.setByParam=function(o){if(o.rule!==void 0&&(this.sRule=o.rule),o.array!==void 0)this.paramArray=o.array;else if(o.str!==void 0)this.setByString(o.str);else if(o.ldapstr!==void 0)this.setByLdapString(o.ldapstr);else if(o.hex!==void 0)this.hTLV=o.hex;else if(o.certissuer!==void 0){var i=new te;i.readCertPEM(o.certissuer),this.hTLV=i.getIssuerHex()}else if(o.certsubject!==void 0){var i=new te;i.readCertPEM(o.certsubject),this.hTLV=i.getSubjectHex()}else typeof o=="object"&&o.certsubject===void 0&&o.certissuer===void 0&&this.setByObject(o)},this.tohex=function(){if(typeof this.hTLV=="string")return this.hTLV;if(this.asn1Array.length==0&&this.paramArray.length>0)for(var o=0;o<this.paramArray.length;o++){var i={array:this.paramArray[o]};this.sRule!="utf8"&&(i.rule=this.sRule);var h=new s(i);this.asn1Array.push(h)}var l=new r.DERSequence({array:this.asn1Array});return this.hTLV=l.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};U(g.asn1.x509.X500Name,g.asn1.ASN1Object);g.asn1.x509.X500Name.compatToLDAP=function(e){if(e.substr(0,1)!=="/")throw"malformed input";var t="";e=e.substr(1);var r=e.split("/");return r.reverse(),r=r.map(function(n){return n.replace(/,/,"\\,")}),r.join(",")};g.asn1.x509.X500Name.onelineToLDAP=function(e){return g.asn1.x509.X500Name.compatToLDAP(e)};g.asn1.x509.X500Name.ldapToCompat=function(e){for(var t=e.split(","),r=!1,n=[],s=0;t.length>0;s++){var a=t.shift();if(r===!0){var o=n.pop(),i=(o+","+a).replace(/\\,/g,",");n.push(i),r=!1}else n.push(a);a.substr(-1,1)==="\\"&&(r=!0)}return n=n.map(function(h){return h.replace("/","\\/")}),n.reverse(),"/"+n.join("/")};g.asn1.x509.X500Name.ldapToOneline=function(e){return g.asn1.x509.X500Name.ldapToCompat(e)};g.asn1.x509.RDN=function(e){g.asn1.x509.RDN.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var t=g.asn1.x509.AttributeTypeAndValue;this.setByParam=function(r){r.rule!==void 0&&(this.sRule=r.rule),r.str!==void 0&&this.addByMultiValuedString(r.str),r.array!==void 0&&(this.paramArray=r.array)},this.addByString=function(r){this.asn1Array.push(new g.asn1.x509.AttributeTypeAndValue({str:r,rule:this.sRule}))},this.addByMultiValuedString=function(r){for(var n=g.asn1.x509.RDN.parseString(r),s=0;s<n.length;s++)this.addByString(n[s])},this.tohex=function(){if(this.asn1Array.length==0&&this.paramArray.length>0)for(var r=0;r<this.paramArray.length;r++){var n=this.paramArray[r];n.rule!==void 0&&this.sRule!="utf8"&&(n.rule=this.sRule);var s=new t(n);this.asn1Array.push(s)}var a=new g.asn1.DERSet({array:this.asn1Array});return this.TLV=a.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};U(g.asn1.x509.RDN,g.asn1.ASN1Object);g.asn1.x509.RDN.parseString=function(e){for(var t=e.split(/\+/),r=!1,n=[],s=0;t.length>0;s++){var a=t.shift();if(r===!0){var o=n.pop(),i=(o+"+"+a).replace(/\\\+/g,"+");n.push(i),r=!1}else n.push(a);a.substr(-1,1)==="\\"&&(r=!0)}for(var h=!1,l=[],s=0;n.length>0;s++){var a=n.shift();if(h===!0){var d=l.pop();if(a.match(/"$/)){var i=(d+"+"+a).replace(/^([^=]+)="(.*)"$/,"$1=$2");l.push(i),h=!1}else l.push(d+"+"+a)}else l.push(a);a.match(/^[^=]+="/)&&(h=!0)}return l};g.asn1.x509.AttributeTypeAndValue=function(e){g.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this),this.sRule="utf8",this.sType=null,this.sValue=null,this.dsType=null;var t=g,r=t.asn1,n=r.DERSequence,s=r.DERUTF8String,a=r.DERPrintableString,o=r.DERTeletexString,i=r.DERIA5String,h=r.DERVisibleString,l=r.DERBMPString,d=t.lang.String.isMail,p=t.lang.String.isPrintable;this.setByParam=function(u){if(u.rule!==void 0&&(this.sRule=u.rule),u.ds!==void 0&&(this.dsType=u.ds),u.value===void 0&&u.str!==void 0){var c=u.str,x=c.match(/^([^=]+)=(.+)$/);if(x)this.sType=x[1],this.sValue=x[2];else throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr)}else this.sType=u.type,this.sValue=u.value},this.setByString=function(u,c){c!==void 0&&(this.sRule=c);var x=u.match(/^([^=]+)=(.+)$/);if(x)this.setByAttrTypeAndValueStr(x[1],x[2]);else throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr)},this._getDsType=function(){var u=this.sType,c=this.sValue,x=this.sRule;return x==="prn"?u=="CN"&&d(c)?"ia5":p(c)?"prn":"utf8":x==="utf8"?u=="CN"&&d(c)?"ia5":u=="C"?"prn":"utf8":"utf8"},this.setByAttrTypeAndValueStr=function(u,c,x){x!==void 0&&(this.sRule=x),this.sType=u,this.sValue=c},this.getValueObj=function(u,c){if(u=="utf8")return new s({str:c});if(u=="prn")return new a({str:c});if(u=="tel")return new o({str:c});if(u=="ia5")return new i({str:c});if(u=="vis")return new h({str:c});if(u=="bmp")return new l({str:c});throw new Error("unsupported directory string type: type="+u+" value="+c)},this.tohex=function(){this.dsType==null&&(this.dsType=this._getDsType());var u=g.asn1.x509.OID.atype2obj(this.sType),c=this.getValueObj(this.dsType,this.sValue),x=new n({array:[u,c]});return this.TLV=x.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};U(g.asn1.x509.AttributeTypeAndValue,g.asn1.ASN1Object);g.asn1.x509.SubjectPublicKeyInfo=function(e){g.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this);var t=null,r=null,n=g,s=n.asn1,a=s.DERInteger,o=s.DERBitString,i=s.DERObjectIdentifier,h=s.DERSequence,l=s.ASN1Util.newObject,d=s.x509,p=d.AlgorithmIdentifier,u=n.crypto,c=u.ECDSA,x=u.DSA;this.getASN1Object=function(){if(this.asn1AlgId==null||this.asn1SubjPKey==null)throw"algId and/or subjPubKey not set";var f=new h({array:[this.asn1AlgId,this.asn1SubjPKey]});return f},this.tohex=function(){var f=this.getASN1Object();return this.hTLV=f.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},this.setPubKey=function(f){try{if(f instanceof ee){var v=l({seq:[{int:{bigint:f.n}},{int:{int:f.e}}]}),y=v.tohex();this.asn1AlgId=new p({name:"rsaEncryption"}),this.asn1SubjPKey=new o({hex:"00"+y})}}catch{}try{if(f instanceof g.crypto.ECDSA){var m=new i({name:f.curveName});this.asn1AlgId=new p({name:"ecPublicKey",asn1params:m}),this.asn1SubjPKey=new o({hex:"00"+f.pubKeyHex})}}catch{}try{if(f instanceof g.crypto.DSA){var m=new l({seq:[{int:{bigint:f.p}},{int:{bigint:f.q}},{int:{bigint:f.g}}]});this.asn1AlgId=new p({name:"dsa",asn1params:m});var b=new a({bigint:f.y});this.asn1SubjPKey=new o({hex:"00"+b.tohex()})}}catch{}},e!==void 0&&this.setPubKey(e)};U(g.asn1.x509.SubjectPublicKeyInfo,g.asn1.ASN1Object);g.asn1.x509.Time=function(e){g.asn1.x509.Time.superclass.constructor.call(this);var t=null,r=null,n=g,s=n.asn1,a=s.DERUTCTime,o=s.DERGeneralizedTime;this.params=null,this.type=null,this.setTimeParams=function(i){this.timeParams=i},this.setByParam=function(i){this.params=i},this.getType=function(i){return i.match(/^[0-9]{12}Z$/)?"utc":i.match(/^[0-9]{14}Z$/)?"gen":i.match(/^[0-9]{12}\.[0-9]+Z$/)?"utc":i.match(/^[0-9]{14}\.[0-9]+Z$/)?"gen":null},this.tohex=function(){var i=this.params,h=null;if(typeof i=="string"&&(i={str:i}),i!=null&&i.str&&(i.type==null||i.type==null)&&(i.type=this.getType(i.str)),i!=null&&i.str?(i.type=="utc"&&(h=new a(i.str)),i.type=="gen"&&(h=new o(i.str))):this.type=="gen"?h=new o:h=new a,h==null)throw new Error("wrong setting for Time");return this.TLV=h.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};g.asn1.x509.Time_bak=function(e){g.asn1.x509.Time_bak.superclass.constructor.call(this);var t=null,r=null,n=g,s=n.asn1,a=s.DERUTCTime,o=s.DERGeneralizedTime;this.setTimeParams=function(i){this.timeParams=i},this.tohex=function(){var i=null;return this.timeParams!=null?this.type=="utc"?i=new a(this.timeParams):i=new o(this.timeParams):this.type=="utc"?i=new a:i=new o,this.TLV=i.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},this.type="utc",e!==void 0&&(e.type!==void 0?this.type=e.type:e.str!==void 0&&(e.str.match(/^[0-9]{12}Z$/)&&(this.type="utc"),e.str.match(/^[0-9]{14}Z$/)&&(this.type="gen")),this.timeParams=e)};U(g.asn1.x509.Time,g.asn1.ASN1Object);g.asn1.x509.AlgorithmIdentifier=function(e){g.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this),this.nameAlg=null,this.asn1Alg=null,this.asn1Params=null,this.paramEmpty=!1;var t=g,r=t.asn1,n=r.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV;if(this.tohex=function(){if(this.nameAlg===null&&this.asn1Alg===null)throw new Error("algorithm not specified");if(this.nameAlg!==null){var a=null;for(var o in n)o===this.nameAlg&&(a=n[o]);if(a!==null)return this.hTLV=a,this.hTLV}this.nameAlg!==null&&this.asn1Alg===null&&(this.asn1Alg=r.x509.OID.name2obj(this.nameAlg));var i=[this.asn1Alg];this.asn1Params!==null&&i.push(this.asn1Params);var h=new r.DERSequence({array:i});return this.hTLV=h.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(e.name!==void 0&&(this.nameAlg=e.name),e.asn1params!==void 0&&(this.asn1Params=e.asn1params),e.paramempty!==void 0&&(this.paramEmpty=e.paramempty)),this.asn1Params===null&&this.paramEmpty===!1&&this.nameAlg!==null){this.nameAlg.name!==void 0&&(this.nameAlg=this.nameAlg.name);var s=this.nameAlg.toLowerCase();s.substr(-7,7)!=="withdsa"&&s.substr(-9,9)!=="withecdsa"&&(this.asn1Params=new r.DERNull)}};U(g.asn1.x509.AlgorithmIdentifier,g.asn1.ASN1Object);g.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV={SHAwithRSAandMGF1:"300d06092a864886f70d01010a3000",SHA256withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040201a11a301806092a864886f70d010108300b0609608648016503040201a203020120",SHA384withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040202a11a301806092a864886f70d010108300b0609608648016503040202a203020130",SHA512withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040203a11a301806092a864886f70d010108300b0609608648016503040203a203020140"};g.asn1.x509.GeneralName=function(e){g.asn1.x509.GeneralName.superclass.constructor.call(this);var t={rfc822:"81",dns:"82",dn:"a4",uri:"86",ip:"87",otherName:"a0"},r=g,n=r.asn1,s=n.x509,a=s.X500Name,o=s.OtherName,i=n.DERIA5String,h=n.DERPrintableString,l=n.DEROctetString,d=n.DERTaggedObject,p=n.ASN1Object,u=Error;this.params=null,this.setByParam=function(c){this.params=c},this.tohex=function(){var c=this.params,x,v,f,v=!1;if(c.other!==void 0)x="a0",f=new o(c.other);else if(c.rfc822!==void 0)x="81",f=new i({str:c.rfc822});else if(c.dns!==void 0)x="82",f=new i({str:c.dns});else if(c.dn!==void 0)x="a4",v=!0,typeof c.dn=="string"?f=new a({str:c.dn}):c.dn instanceof g.asn1.x509.X500Name?f=c.dn:f=new a(c.dn);else if(c.ldapdn!==void 0)x="a4",v=!0,f=new a({ldapstr:c.ldapdn});else if(c.certissuer!==void 0||c.certsubj!==void 0){x="a4",v=!0;var y,m,b=null;if(c.certsubj!==void 0?(y=!1,m=c.certsubj):(y=!0,m=c.certissuer),m.match(/^[0-9A-Fa-f]+$/)&&b==m,m.indexOf("-----BEGIN ")!=-1&&(b=Ne(m)),b==null)throw new Error("certsubj/certissuer not cert");var E=new te;E.hex=b;var P;y?P=E.getIssuerHex():P=E.getSubjectHex(),f=new p,f.hTLV=P}else if(c.uri!==void 0)x="86",f=new i({str:c.uri});else if(c.ip!==void 0){x="87";var F,D=c.ip;try{if(D.match(/^[0-9a-f]+$/)){var S=D.length;if(S==8||S==16||S==32||S==64)F=D;else throw"err"}else F=js(D)}catch(C){throw new u("malformed IP address: "+c.ip+":"+C.message)}f=new l({hex:F})}else throw new u("improper params");var w=new d({tag:x,explicit:v,obj:f});return w.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};U(g.asn1.x509.GeneralName,g.asn1.ASN1Object);g.asn1.x509.GeneralNames=function(e){g.asn1.x509.GeneralNames.superclass.constructor.call(this);var t=null,r=g,n=r.asn1;this.setByParamArray=function(s){for(var a=0;a<s.length;a++){var o=new n.x509.GeneralName(s[a]);this.asn1Array.push(o)}},this.tohex=function(){var s=new n.DERSequence({array:this.asn1Array});return s.tohex()},this.getEncodedHex=function(){return this.tohex()},this.asn1Array=new Array,typeof e<"u"&&this.setByParamArray(e)};U(g.asn1.x509.GeneralNames,g.asn1.ASN1Object);g.asn1.x509.OtherName=function(e){g.asn1.x509.OtherName.superclass.constructor.call(this);var t=null,r=null,n=g,s=n.asn1,a=s.DERObjectIdentifier,o=s.DERSequence,i=s.ASN1Util.newObject;this.params=null,this.setByParam=function(h){this.params=h},this.tohex=function(){var h=this.params;if(h.oid==null||h.value==null)throw new Error("oid or value not specified");var l=new a({oid:h.oid}),d=i({tag:{tag:"a0",explicit:!0,obj:h.value}}),p=new o({array:[l,d]});return p.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};U(g.asn1.x509.OtherName,g.asn1.ASN1Object);g.asn1.x509.OID=new function(){var e=g.asn1.DERObjectIdentifier;this.name2oidList={"aes128-CBC":"2.16.840.1.101.3.4.1.2","aes256-CBC":"2.16.840.1.101.3.4.1.42",sha1:"1.3.14.3.2.26",sha256:"2.16.840.1.101.3.4.2.1",sha384:"2.16.840.1.101.3.4.2.2",sha512:"2.16.840.1.101.3.4.2.3",sha224:"2.16.840.1.101.3.4.2.4",md5:"1.2.840.113549.2.5",md2:"1.3.14.7.2.2.1",ripemd160:"1.3.36.3.2.1",hmacWithSHA1:"1.2.840.113549.2.7",hmacWithSHA224:"1.2.840.113549.2.8",hmacWithSHA256:"1.2.840.113549.2.9",hmacWithSHA384:"1.2.840.113549.2.10",hmacWithSHA512:"1.2.840.113549.2.11",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5","pkcs1-MGF":"1.2.840.113549.1.1.8",rsaPSS:"1.2.840.113549.1.1.10",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",commonName:"2.5.4.3",countryName:"2.5.4.6",localityName:"2.5.4.7",stateOrProvinceName:"2.5.4.8",streetAddress:"2.5.4.9",organizationName:"2.5.4.10",organizationalUnitName:"2.5.4.11",domainComponent:"0.9.2342.19200300.100.1.25",userId:"0.9.2342.19200300.100.1.1",surname:"2.5.4.4",givenName:"2.5.4.42",title:"2.5.4.12",distinguishedName:"2.5.4.49",emailAddress:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3",subjectDirectoryAttributes:"2.5.29.9",subjectKeyIdentifier:"2.5.29.14",keyUsage:"2.5.29.15",subjectAltName:"2.5.29.17",issuerAltName:"2.5.29.18",basicConstraints:"2.5.29.19",cRLNumber:"2.5.29.20",cRLReason:"2.5.29.21",nameConstraints:"2.5.29.30",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",anyPolicy:"2.5.29.32.0",policyMappings:"2.5.29.33",authorityKeyIdentifier:"2.5.29.35",policyConstraints:"2.5.29.36",extKeyUsage:"2.5.29.37",inhibitAnyPolicy:"2.5.29.54",authorityInfoAccess:"1.3.6.1.5.5.7.1.1",ocsp:"1.3.6.1.5.5.7.48.1",ocspBasic:"1.3.6.1.5.5.7.48.1.1",ocspNonce:"1.3.6.1.5.5.7.48.1.2",ocspNoCheck:"1.3.6.1.5.5.7.48.1.5",caIssuers:"1.3.6.1.5.5.7.48.2",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",smtpUTF8Mailbox:"1.3.6.1.5.5.7.8.9",dateOfBirth:"1.3.6.1.5.5.7.9.1",placeOfBirth:"1.3.6.1.5.5.7.9.2",gender:"1.3.6.1.5.5.7.9.3",countryOfCitizenship:"1.3.6.1.5.5.7.9.4",countryOfResidence:"1.3.6.1.5.5.7.9.5",ecPublicKey:"1.2.840.10045.2.1","P-256":"1.2.840.10045.3.1.7",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",secp521r1:"1.3.132.0.35",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7",data:"1.2.840.113549.1.7.1","signed-data":"1.2.840.113549.1.7.2","enveloped-data":"1.2.840.113549.1.7.3","digested-data":"1.2.840.113549.1.7.5","encrypted-data":"1.2.840.113549.1.7.6","authenticated-data":"1.2.840.113549.1.9.16.1.2",tstinfo:"1.2.840.113549.1.9.16.1.4",signingCertificate:"1.2.840.113549.1.9.16.2.12",timeStampToken:"1.2.840.113549.1.9.16.2.14",signaturePolicyIdentifier:"1.2.840.113549.1.9.16.2.15",etsArchiveTimeStamp:"1.2.840.113549.1.9.16.2.27",signingCertificateV2:"1.2.840.113549.1.9.16.2.47",etsArchiveTimeStampV2:"1.2.840.113549.1.9.16.2.48",extensionRequest:"1.2.840.113549.1.9.14",contentType:"1.2.840.113549.1.9.3",messageDigest:"1.2.840.113549.1.9.4",signingTime:"1.2.840.113549.1.9.5",counterSignature:"1.2.840.113549.1.9.6",archiveTimeStampV3:"0.4.0.1733.2.4",pdfRevocationInfoArchival:"1.2.840.113583.1.1.8",adobeTimeStamp:"1.2.840.113583.1.1.9.1",smimeMailboxLegacy:"2.23.140.1.5.1.1",smimeMailboxMulti:"2.23.140.1.5.1.2",smimeMailboxStrict:"2.23.140.1.5.1.3",smimeOrganizationLegacy:"2.23.140.1.5.2.1",smimeOrganizationMulti:"2.23.140.1.5.2.2",smimeOrganizationStrict:"2.23.140.1.5.2.3",smimeSponsorLegacy:"2.23.140.1.5.3.1",smimeSponsorMulti:"2.23.140.1.5.3.2",smimeSponsorStrict:"2.23.140.1.5.3.3",smimeIndividualLegacy:"2.23.140.1.5.4.1",smimeIndividualMulti:"2.23.140.1.5.4.2",smimeIndividualStrict:"2.23.140.1.5.4.3"},this.atype2oidList={CN:"2.5.4.3",L:"2.5.4.7",ST:"2.5.4.8",O:"2.5.4.10",OU:"2.5.4.11",C:"2.5.4.6",STREET:"2.5.4.9",DC:"0.9.2342.19200300.100.1.25",UID:"0.9.2342.19200300.100.1.1",SN:"2.5.4.4",T:"2.5.4.12",GN:"2.5.4.42",DN:"2.5.4.49",E:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",serialNumber:"2.5.4.5",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3"},this.objCache={},this.name2obj=function(t){if(typeof this.objCache[t]<"u")return this.objCache[t];if(typeof this.name2oidList[t]>"u")throw"Name of ObjectIdentifier not defined: "+t;var r=this.name2oidList[t],n=new e({oid:r});return this.objCache[t]=n,n},this.atype2obj=function(t){if(this.objCache[t]!==void 0)return this.objCache[t];var r;if(t.match(/^\d+\.\d+\.[0-9.]+$/))r=t;else if(this.atype2oidList[t]!==void 0)r=this.atype2oidList[t];else if(this.name2oidList[t]!==void 0)r=this.name2oidList[t];else throw new Error("AttributeType name undefined: "+t);var n=new e({oid:r});return this.objCache[t]=n,n},this.registerOIDs=function(t){if(!!this.checkOIDs(t))for(var r in t)this.name2oidList[r]=t[r]},this.checkOIDs=function(t){try{var r=Object.keys(t);return r.length==0?!1:(r.map(function(n,s,a){var o=this[n];if(!o.match(/^[0-2]\.[0-9.]+$/))throw new Error("value is not OID")},t),!0)}catch{return!1}}};g.asn1.x509.OID.oid2name=function(e){var t=g.asn1.x509.OID.name2oidList;for(var r in t)if(t[r]==e)return r;return""};g.asn1.x509.OID.oid2atype=function(e){var t=g.asn1.x509.OID.atype2oidList;for(var r in t)if(t[r]==e)return r;return e};g.asn1.x509.OID.name2oid=function(e){if(e.match(/^[0-9.]+$/))return e;var t=g.asn1.x509.OID.name2oidList;return t[e]===void 0?"":t[e]};g.asn1.x509.X509Util={};g.asn1.x509.X509Util.newCertPEM=function(e){var t=g.asn1.x509,r=t.TBSCertificate,n=t.Certificate,s=new n(e);return s.getPEM()};(typeof g>"u"||!g)&&(g={});(typeof g.asn1>"u"||!g.asn1)&&(g.asn1={});(typeof g.asn1.cms>"u"||!g.asn1.cms)&&(g.asn1.cms={});g.asn1.cms.Attribute=function(e){var t=Error,r=g,n=r.asn1,s=n.DERSequence,a=n.DERSet,o=n.DERObjectIdentifier;this.params=null,this.typeOid=null,this.setByParam=function(i){this.params=i},this.getValueArray=function(){throw new t("not yet implemented abstract")},this.tohex=function(){var i=new o({oid:this.typeOid}),h=new a({array:this.getValueArray()}),l=new s({array:[i,h]});return l.tohex()},this.getEncodedHex=function(){return this.tohex()}};U(g.asn1.cms.Attribute,g.asn1.ASN1Object);g.asn1.cms.ContentType=function(e){var t=g,r=t.asn1;r.cms.ContentType.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.3",this.getValueArray=function(){var n=new r.DERObjectIdentifier(this.params.type);return[n]},e!=null&&this.setByParam(e)};U(g.asn1.cms.ContentType,g.asn1.cms.Attribute);g.asn1.cms.MessageDigest=function(e){var t=g,r=t.asn1,n=r.DEROctetString,s=r.cms;s.MessageDigest.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.4",this.getValueArray=function(){var a=new n(this.params);return[a]},e!=null&&this.setByParam(e)};U(g.asn1.cms.MessageDigest,g.asn1.cms.Attribute);g.asn1.cms.SigningTime=function(e){var t=g,r=t.asn1;r.cms.SigningTime.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.5",this.getValueArray=function(){var n=new r.x509.Time(this.params);return[n]},e!=null&&this.setByParam(e)};U(g.asn1.cms.SigningTime,g.asn1.cms.Attribute);g.asn1.cms.SigningCertificate=function(e){var t=Error,r=g,n=r.asn1,s=n.DERSequence,a=n.cms,o=a.ESSCertID,i=r.crypto;a.SigningCertificate.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.12",this.getValueArray=function(){if(this.params==null||this.params==null||this.params.array==null)throw new t("parameter 'array' not specified");for(var h=this.params.array,l=[],d=0;d<h.length;d++){var p=h[d];e.hasis==!1&&typeof p=="string"&&(p.indexOf("-----BEGIN")!=-1||W.isASN1HEX(p))&&(p={cert:p}),p.hasis!=!1&&e.hasis==!1&&(p.hasis=!1),l.push(new o(p))}var u=new s({array:l}),c=new s({array:[u]});return[c]},e!=null&&this.setByParam(e)};U(g.asn1.cms.SigningCertificate,g.asn1.cms.Attribute);g.asn1.cms.ESSCertID=function(e){g.asn1.cms.ESSCertID.superclass.constructor.call(this);var t=Error,r=g,n=r.asn1,s=n.DEROctetString,a=n.DERSequence,o=n.cms.IssuerSerial;this.params=null,this.getCertHash=function(i,h){if(i.hash!=null)return i.hash;if(typeof i=="string"&&i.indexOf("-----BEGIN")==-1&&!W.isASN1HEX(i))return i;var l;if(typeof i=="string")l=i;else if(i.cert!=null)l=i.cert;else throw new t("hash nor cert unspecified");var d;l.indexOf("-----BEGIN")!=-1?d=Ne(l):d=l,typeof i=="string"&&(i.indexOf("-----BEGIN")!=-1?d=Ne(i):W.isASN1HEX(i)&&(d=i));var p;if(i.alg!=null)p=i.alg;else if(h!=null)p=h;else throw new t("hash alg unspecified");return r.crypto.Util.hashHex(d,p)},this.tohex=function(){var i=this.params,h=this.getCertHash(i,"sha1"),l=[];l.push(new s({hex:h})),(typeof i=="string"&&i.indexOf("-----BEGIN")!=-1||i.cert!=null&&i.hasis!=!1||i.issuer!=null&&i.serial!=null)&&l.push(new o(i));var d=new a({array:l});return d.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};U(g.asn1.cms.ESSCertID,g.asn1.ASN1Object);g.asn1.cms.SigningCertificateV2=function(e){var t=Error,r=g,n=r.asn1,s=n.DERSequence,a=n.x509,o=n.cms,i=o.ESSCertIDv2,h=r.crypto;o.SigningCertificateV2.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.47",this.getValueArray=function(){if(this.params==null||this.params==null||this.params.array==null)throw new t("parameter 'array' not specified");for(var l=this.params.array,d=[],p=0;p<l.length;p++){var u=l[p];(e.alg!=null||e.hasis==!1)&&typeof u=="string"&&(u.indexOf("-----BEGIN")!=-1||W.isASN1HEX(u))&&(u={cert:u}),u.alg==null&&e.alg!=null&&(u.alg=e.alg),u.hasis!=!1&&e.hasis==!1&&(u.hasis=!1),d.push(new i(u))}var c=new s({array:d}),x=new s({array:[c]});return[x]},e!=null&&this.setByParam(e)};U(g.asn1.cms.SigningCertificateV2,g.asn1.cms.Attribute);g.asn1.cms.ESSCertIDv2=function(e){g.asn1.cms.ESSCertIDv2.superclass.constructor.call(this);var t=Error,r=g,n=r.asn1,s=n.DEROctetString,a=n.DERSequence,o=n.cms.IssuerSerial,i=n.x509.AlgorithmIdentifier;this.params=null,this.tohex=function(){var h=this.params,l=this.getCertHash(h,"sha256"),d=[];h.alg!=null&&h.alg!="sha256"&&d.push(new i({name:h.alg})),d.push(new s({hex:l})),(typeof h=="string"&&h.indexOf("-----BEGIN")!=-1||h.cert!=null&&h.hasis!=!1||h.issuer!=null&&h.serial!=null)&&d.push(new o(h));var p=new a({array:d});return p.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};U(g.asn1.cms.ESSCertIDv2,g.asn1.cms.ESSCertID);g.asn1.cms.IssuerSerial=function(e){var t=Error,r=g,n=r.asn1,s=n.DERInteger,a=n.DERSequence,o=n.cms,i=n.x509,h=i.GeneralNames,l=te;o.IssuerSerial.superclass.constructor.call(this),this.setByParam=function(d){this.params=d},this.tohex=function(){var d=this.params,p,u;if(typeof d=="string"&&d.indexOf("-----BEGIN")!=-1||d.cert!=null){var c;d.cert!=null?c=d.cert:c=d;var x=new l;x.readCertPEM(c),p=x.getIssuer(),u={hex:x.getSerialNumberHex()}}else if(d.issuer!=null&&d.serial)p=d.issuer,u=d.serial;else throw new t("cert or issuer and serial parameter not specified");var f=new h([{dn:p}]),v=new s(u),y=new a({array:[f,v]});return y.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};U(g.asn1.cms.IssuerSerial,g.asn1.ASN1Object);g.asn1.cms.SignerIdentifier=function(e){var t=g,r=t.asn1,n=r.DERInteger,s=r.DERSequence,a=r.cms,o=a.IssuerAndSerialNumber,i=a.SubjectKeyIdentifier,h=r.x509,l=h.X500Name,d=te,p=Error;a.SignerIdentifier.superclass.constructor.call(this),this.params=null,this.tohex=function(){var u=this.params;if(u.type=="isssn"){var c=new o(u);return c.tohex()}else if(u.type=="skid"){var x=new i(u);return x.tohex()}else throw new Error("wrong property for isssn or skid")},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};U(g.asn1.cms.SignerIdentifier,g.asn1.ASN1Object);g.asn1.cms.IssuerAndSerialNumber=function(e){var t=g,r=t.asn1,n=r.DERInteger,s=r.DERSequence,a=r.cms,o=r.x509,i=o.X500Name,h=te,l=Error;a.IssuerAndSerialNumber.superclass.constructor.call(this),this.params=null,this.tohex=function(){var d=this.params,p,u;if(typeof d=="string"&&d.indexOf("-----BEGIN")!=-1||d.cert!=null){var c;d.cert!=null?c=d.cert:c=d;var x=new h;x.readCertPEM(c),p=x.getIssuer(),u={hex:x.getSerialNumberHex()}}else if(d.issuer!=null&&d.serial)p=d.issuer,u=d.serial;else throw new l("cert or issuer and serial parameter not specified");var f=new i(p),v=new n(u),y=new s({array:[f,v]});return y.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(d){this.params=d},e!=null&&this.setByParam(e)};U(g.asn1.cms.IssuerAndSerialNumber,g.asn1.ASN1Object);g.asn1.cms.SubjectKeyIdentifier=function(e){var t=g,r=t.asn1,n=r.DERInteger,s=r.DERSequence,a=r.ASN1Util.newObject,o=r.cms,i=o.IssuerAndSerialName,h=o.SubjectKeyIdentifier,l=r.x509,d=l.X500Name,p=te,u=Error;o.SubjectKeyIdentifier.superclass.constructor.call(this),this.tohex=function(){var c=this.params;if(c.cert==null&&c.skid==null)throw new u("property cert nor skid undefined");var x;if(c.cert!=null){var f=new p(c.cert),v=f.getExtSubjectKeyIdentifier();x=v.kid.hex}else c.skid!=null&&(x=c.skid);var y=a({tag:{tage:"a0",obj:{octstr:{hex:x}}}});return y.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};U(g.asn1.cms.SubjectKeyIdentifier,g.asn1.ASN1Object);g.asn1.cms.AttributeList=function(e){var t=Error,r=g,n=r.asn1,s=n.DERSet,a=n.cms;a.AttributeList.superclass.constructor.call(this),this.params=null,this.hTLV=null,this.setByParam=function(o){this.params=o},this.tohex=function(){var o=this.params;if(this.hTLV!=null)return this.hTLV;var i=!0;o.sortflag!=null&&(i=o.sortflag);for(var h=o.array,l=[],d=0;d<h.length;d++){var p=h[d],u=p.attr;if(u=="contentType")l.push(new a.ContentType(p));else if(u=="messageDigest")l.push(new a.MessageDigest(p));else if(u=="signingTime")l.push(new a.SigningTime(p));else if(u=="signingCertificate")l.push(new a.SigningCertificate(p));else if(u=="signingCertificateV2")l.push(new a.SigningCertificateV2(p));else if(u=="signaturePolicyIdentifier")l.push(new g.asn1.cades.SignaturePolicyIdentifier(p));else if(u=="signatureTimeStamp"||u=="timeStampToken")l.push(new g.asn1.cades.SignatureTimeStamp(p));else throw new t("unknown attr: "+u)}var c=new s({array:l,sortflag:i});return this.hTLV=c.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};U(g.asn1.cms.AttributeList,g.asn1.ASN1Object);g.asn1.cms.SignerInfo=function(e){var t=Error,r=g,n=r.asn1,s=n.DERInteger,a=n.DEROctetString,o=n.DERSequence,i=n.DERTaggedObject,h=n.cms,l=h.SignerIdentifier,d=h.AttributeList,p=h.ContentType,u=h.EncapsulatedContentInfo,c=h.MessageDigest,x=h.SignedData,f=n.x509,v=f.AlgorithmIdentifier,y=r.crypto,m=ue;h.SignerInfo.superclass.constructor.call(this),this.params=null,this.sign=function(){var b=this.params,E=b.sigalg,P=new d(b.sattrs).tohex(),F=m.getKey(b.signkey),D=new y.Signature({alg:E});D.init(F),D.updateHex(P);var S=D.sign();b.sighex=S},this.tohex=function(){var b=this.params,E=[];if(E.push(new s({int:b.version})),E.push(new l(b.id)),E.push(new v({name:b.hashalg})),b.sattrs!=null){var P=new d(b.sattrs);try{E.push(new i({tag:"a0",explicit:!1,obj:P}))}catch(D){throw new t("si sattr error: "+D)}}if(b.sigalgfield!=null?E.push(new v({name:b.sigalgfield})):E.push(new v({name:b.sigalg})),b.sighex==null&&b.signkey!=null&&this.sign(),E.push(new a({hex:b.sighex})),b.uattrs!=null){var P=new d(b.uattrs);try{E.push(new i({tag:"a1",explicit:!1,obj:P}))}catch(S){throw new t("si uattr error: "+S)}}var F=new o({array:E});return F.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};U(g.asn1.cms.SignerInfo,g.asn1.ASN1Object);g.asn1.cms.EncapsulatedContentInfo=function(e){var t=g,r=t.asn1,n=r.DERTaggedObject,s=r.DERSequence,a=r.DERObjectIdentifier,o=r.DEROctetString,i=r.cms;i.EncapsulatedContentInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var h=this.params,l=[];if(l.push(new a(h.type)),h.content!=null&&(h.content.hex!=null||h.content.str!=null)&&h.isDetached!=!0){var d=new o(h.content),p=new n({tag:"a0",explicit:!0,obj:d});l.push(p)}var u=new s({array:l});return u.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(h){this.params=h},e!=null&&this.setByParam(e)};U(g.asn1.cms.EncapsulatedContentInfo,g.asn1.ASN1Object);g.asn1.cms.ContentInfo=function(e){var t=g,r=t.asn1,n=r.DERTaggedObject,s=r.DERSequence,a=r.DERObjectIdentifier,o=r.x509,i=o.OID.name2obj;g.asn1.cms.ContentInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var h=this.params,l=[];l.push(new a(h.type));var d=new n({tag:"a0",explicit:!0,obj:h.obj});l.push(d);var p=new s({array:l});return p.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(h){this.params=h},e!=null&&this.setByParam(e)};U(g.asn1.cms.ContentInfo,g.asn1.ASN1Object);g.asn1.cms.SignedData=function(e){var t=Error,r=g,n=r.asn1,s=n.ASN1Object,a=n.DERInteger,o=n.DERSet,i=n.DERSequence,h=n.DERTaggedObject,l=n.cms,d=l.EncapsulatedContentInfo,p=l.SignerInfo,u=l.ContentInfo,c=l.CertificateSet,x=l.RevocationInfoChoices,f=n.x509,v=f.AlgorithmIdentifier;g.asn1.cms.SignedData.superclass.constructor.call(this),this.params=null,this.checkAndFixParam=function(){var y=this.params;this._setDigestAlgs(y),this._setContentTypeByEContent(y),this._setMessageDigestByEContent(y),this._setSignerInfoVersion(y),this._setSignedDataVersion(y)},this._setDigestAlgs=function(y){for(var m={},b=y.sinfos,E=0;E<b.length;E++){var P=b[E];m[P.hashalg]=1}y.hashalgs=Object.keys(m).sort()},this._setContentTypeByEContent=function(y){for(var m=y.econtent.type,b=y.sinfos,E=0;E<b.length;E++){var P=b[E],F=this._getAttrParamByName(P,"contentType");F.type=m}},this._setMessageDigestByEContent=function(y){var m=y.econtent,b=y.econtent.type,E=m.content.hex;E==null&&m.type=="data"&&m.content.str!=null&&(E=pt(m.content.str));for(var P=y.sinfos,F=0;F<P.length;F++){var D=P[F],S=D.hashalg,w=this._getAttrParamByName(D,"messageDigest"),C=g.crypto.Util.hashHex(E,S);w.hex=C}},this._getAttrParamByName=function(y,m){for(var b=y.sattrs.array,E=0;E<b.length;E++)if(b[E].attr==m)return b[E]},this._setSignerInfoVersion=function(y){for(var m=y.sinfos,b=0;b<m.length;b++){var E=m[b],P=1;E.id.type=="skid"&&(P=3),E.version=P}},this._setSignedDataVersion=function(y){var m=this._getSignedDataVersion(y);y.version=m},this._getSignedDataVersion=function(y){if(y.revinfos!=null)for(var m=y.revinfos,b=0;b<m.length;b++){var E=m[b];if(E.ocsp!=null)return 5}for(var P=y.sinfos,b=0;b<P.length;b++){var F=y.sinfos[b];if(F.version==3)return 3}return y.econtent.type!="data"?3:1},this.tohex=function(){var y=this.params;this.getEncodedHexPrepare!=null&&this.getEncodedHexPrepare(),y.fixed!=!0&&this.checkAndFixParam();var m=[];m.push(new a({int:y.version}));for(var b=[],E=0;E<y.hashalgs.length;E++){var P=y.hashalgs[E];b.push(new v({name:P}))}m.push(new o({array:b})),m.push(new d(y.econtent)),y.certs!=null&&m.push(new c(y.certs)),y.revinfos!=null&&m.push(new x(y.revinfos));for(var F=[],E=0;E<y.sinfos.length;E++){var D=y.sinfos[E];F.push(new p(D))}m.push(new o({array:F}));var S=new i({array:m});return S.tohex()},this.getEncodedHex=function(){return this.tohex()},this.getContentInfo=function(){var y=new u({type:"signed-data",obj:this});return y},this.getContentInfoEncodedHex=function(){return this.getContentInfo().tohex()},e!=null&&this.setByParam(e)};U(g.asn1.cms.SignedData,g.asn1.ASN1Object);g.asn1.cms.CertificateSet=function(e){g.asn1.cms.CertificateSet.superclass.constructor.call(this);var t=Error,r=g.asn1,n=r.DERTaggedObject,s=r.DERSet,a=r.ASN1Object;this.params=null,this.tohex=function(){var o=this.params,i=[],h;if(o instanceof Array)h=o;else if(o.array!=null)h=o.array;else throw new t("cert array not specified");for(var l=0;l<h.length;l++){var d=h[l],p=Ne(d),u=new a;u.hTLV=p,i.push(u)}var c={array:i};o.sortflag==!1&&(c.sortflag=!1);var x=new s(c),f=new n({tag:"a0",explicit:!1,obj:x});return f.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};U(g.asn1.cms.CertificateSet,g.asn1.ASN1Object);g.asn1.cms.RevocationInfoChoices=function(e){g.asn1.cms.RevocationInfoChoices.superclass.constructor.call(this),this.params=null,this.tohex=function(){var t=this.params;if(!t instanceof Array)throw new Error("params is not array");for(var r=[],n=0;n<t.length;n++)r.push(new g.asn1.cms.RevocationInfoChoice(t[n]));var s=g.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:{set:r}}});return s.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};U(g.asn1.cms.RevocationInfoChoices,g.asn1.ASN1Object);g.asn1.cms.RevocationInfoChoice=function(e){g.asn1.cms.RevocationInfoChoice.superclass.constructor.call(this),this.params=null,this.tohex=function(){var t=this.params;if(t.crl!=null&&typeof t.crl=="string"){var r=t.crl;return t.crl.indexOf("-----BEGIN")!=-1&&(r=Ne(t.crl)),r}else if(t.ocsp!=null){var n=g.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:new g.asn1.cms.OtherRevocationFormat(t)}});return n.tohex()}else throw new Error("property crl or ocsp undefined")},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};U(g.asn1.cms.RevocationInfoChoice,g.asn1.ASN1Object);g.asn1.cms.OtherRevocationFormat=function(e){g.asn1.cms.OtherRevocationFormat.superclass.constructor.call(this);var t=Error,r=g,n=r.asn1,s=n.ASN1Util.newObject,a=r.lang.String.isHex;this.params=null,this.tohex=function(){var o=this.params;if(o.ocsp==null)throw new t("property ocsp not specified");if(!a(o.ocsp)||!W.isASN1HEX(o.ocsp))throw new t("ocsp value not ASN.1 hex string");var i=s({seq:[{oid:"1.3.6.1.5.5.7.16.2"},{asn1:{tlv:o.ocsp}}]});return i.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};U(g.asn1.cms.OtherRevocationFormat,g.asn1.ASN1Object);g.asn1.cms.CMSUtil=new function(){};g.asn1.cms.CMSUtil.newSignedData=function(e){return new g.asn1.cms.SignedData(e)};g.asn1.cms.CMSUtil.verifySignedData=function(e){var t=g,r=t.asn1,n=r.cms,s=n.SignerInfo,a=n.SignedData,o=n.SigningTime,i=n.SigningCertificate,h=n.SigningCertificateV2,l=r.cades,d=l.SignaturePolicyIdentifier,p=t.lang.String.isHex,u=W,c=u.getVbyList,x=u.getTLVbyList,f=u.getIdxbyList,v=u.getChildIdx,y=u.getTLV,m=u.oidname,b=t.crypto.Util.hashHex;e.cms===void 0&&p(e.cms);var E=e.cms,P=function(I,N){for(var K,L=3;L<6;L++)if(K=f(I,0,[1,0,L]),K!==void 0){var H=I.substr(K,2);H==="a0"&&(N.certsIdx=K),H==="a1"&&(N.revinfosIdx=K),H==="31"&&(N.signerinfosIdx=K)}},F=function(I,N){var K=N.signerinfosIdx;if(K!==void 0){var L=v(I,K);N.signerInfoIdxList=L;for(var H=0;H<L.length;H++){var T=L[H],k={idx:T};D(I,k),N.signerInfos.push(k)}}},D=function(I,N){var K=N.idx;N.signerid_issuer1=x(I,K,[1,0],"30"),N.signerid_serial1=c(I,K,[1,1],"02"),N.hashalg=m(c(I,K,[2,0],"06"));var L=f(I,K,[3],"a0");N.idxSignedAttrs=L,S(I,N,L);var H=v(I,K),T=H.length;if(T<6)throw"malformed SignerInfo";N.sigalg=m(c(I,K,[T-2,0],"06")),N.sigval=c(I,K,[T-1],"04")},S=function(I,N,K){var L=v(I,K);N.signedAttrIdxList=L;for(var H=0;H<L.length;H++){var T=L[H],k=c(I,T,[0],"06"),q;k==="2a864886f70d010905"?(q=ge(c(I,T,[1,0])),N.saSigningTime=q):k==="2a864886f70d010904"&&(q=c(I,T,[1,0],"04"),N.saMessageDigest=q)}},w=function(I,N){if(c(I,0,[0],"06")!=="2a864886f70d010702")return N;N.cmsType="signedData",N.econtent=c(I,0,[1,0,2,1,0]),P(I,N),N.signerInfos=[],F(I,N)},C=function(I,N){for(var K=N.parse.signerInfos,L=K.length,H=!0,T=0;T<L;T++){var k=K[T];B(I,N,k,T),k.isValid||(H=!1)}N.isValid=H},A=function(I,N,K,L){var H=N.parse.certsIdx,T;if(N.certs===void 0){T=[],N.certkeys=[];for(var k=v(I,H),q=0;q<k.length;q++){var $=y(I,k[q]),Y=new te;Y.readCertHex($),T[q]=Y,N.certkeys[q]=Y.getPublicKey()}N.certs=T}else T=N.certs;N.cccc=T.length,N.cccci=k.length;for(var q=0;q<T.length;q++){var se=Y.getIssuerHex(),G=Y.getSerialNumberHex();K.signerid_issuer1===se&&K.signerid_serial1===G&&(K.certkey_idx=q)}},B=function(I,N,K,L){K.verifyDetail={};var H=K.verifyDetail,T=N.parse.econtent,k=K.hashalg,q=K.saMessageDigest;H.validMessageDigest=!1,b(T,k)===q&&(H.validMessageDigest=!0),A(I,N,K,L),H.validSignatureValue=!1;var $=K.sigalg,Y="31"+y(I,K.idxSignedAttrs).substr(2);K.signedattrshex=Y;var se=N.certs[K.certkey_idx].getPublicKey(),G=new g.crypto.Signature({alg:$});G.init(se),G.updateHex(Y);var me=G.verify(K.sigval);H.validSignatureValue_isValid=me,me===!0&&(H.validSignatureValue=!0),K.isValid=!1,H.validMessageDigest&&H.validSignatureValue&&(K.isValid=!0)},R=function(){},_={isValid:!1,parse:{}};return w(E,_.parse),C(E,_),_};g.asn1.cms.CMSParser=function(){var e=Error,t=te,r=new t,n=W,s=n.getV,a=n.getTLV,o=n.getIdxbyList,i=n.getTLVbyList,h=n.getTLVbyListEx,l=n.getVbyList,d=n.getVbyListEx,p=n.getChildIdx;this.getCMSSignedData=function(u){var c=i(u,0,[1,0]),x=this.getSignedData(c);return x},this.getSignedData=function(u){var c=p(u,0),x={},f=s(u,c[0]),v=parseInt(f,16);x.version=v;var y=a(u,c[1]);x.hashalgs=this.getHashAlgArray(y);var m=a(u,c[2]);x.econtent=this.getEContent(m);var b=h(u,0,["[0]"]);b!=null&&(x.certs=this.getCertificateSet(b));var E=h(u,0,["[1]"]);E!=null;var P=h(u,0,[3]);return x.sinfos=this.getSignerInfos(P),x},this.getHashAlgArray=function(u){for(var c=p(u,0),x=new t,f=[],v=0;v<c.length;v++){var y=a(u,c[v]),m=x.getAlgorithmIdentifierName(y);f.push(m)}return f},this.getEContent=function(u){var c={},x=l(u,0,[0]),f=l(u,0,[1,0]);return c.type=g.asn1.x509.OID.oid2name(W.hextooidstr(x)),c.content={hex:f},c},this.getSignerInfos=function(u){for(var c=[],x=p(u,0),f=0;f<x.length;f++){var v=a(u,x[f]),y=this.getSignerInfo(v);c.push(y)}return c},this.getSignerInfo=function(u){var c={},x=p(u,0),f=n.getInt(u,x[0],-1);f!=-1&&(c.version=f);var v=a(u,x[1]),y=this.getIssuerAndSerialNumber(v);c.id=y;var m=a(u,x[2]),b=r.getAlgorithmIdentifierName(m);c.hashalg=b;var E=h(u,0,["[0]"]);if(E!=null){var P=this.getAttributeList(E);c.sattrs=P}var F=h(u,0,[3]),D=r.getAlgorithmIdentifierName(F);c.sigalg=D;var S=d(u,0,[4]);c.sighex=S;var w=h(u,0,["[1]"]);if(w!=null){var C=this.getAttributeList(w);c.uattrs=C}return c},this.getSignerIdentifier=function(u){if(u.substr(0,2)=="30")return this.getIssuerAndSerialNumber(u);throw new Error("SKID of signerIdentifier not supported")},this.getIssuerAndSerialNumber=function(u){var c={type:"isssn"},x=p(u,0),f=a(u,x[0]);c.issuer=r.getX500Name(f);var v=s(u,x[1]);return c.serial={hex:v},c},this.getAttributeList=function(u){for(var c=[],x=p(u,0),f=0;f<x.length;f++){var v=a(u,x[f]),y=this.getAttribute(v);c.push(y)}return{array:c}},this.getAttribute=function(u){var c={},x=p(u,0),f=n.getOID(u,x[0]),v=g.asn1.x509.OID.oid2name(f);c.attr=v;var y=a(u,x[1]),m=p(y,0);if(m.length==1)c.valhex=a(y,m[0]);else{for(var b=[],E=0;E<m.length;E++)b.push(a(y,m[E]));c.valhex=b}return v=="contentType"?this.setContentType(c):v=="messageDigest"?this.setMessageDigest(c):v=="signingTime"?this.setSigningTime(c):v=="signingCertificate"?this.setSigningCertificate(c):v=="signingCertificateV2"?this.setSigningCertificateV2(c):v=="signaturePolicyIdentifier"&&this.setSignaturePolicyIdentifier(c),c},this.setContentType=function(u){var c=n.getOIDName(u.valhex,0,null);c!=null&&(u.type=c,delete u.valhex)},this.setSigningTime=function(u){var c=s(u.valhex,0),x=ge(c);u.str=x,delete u.valhex},this.setMessageDigest=function(u){var c=s(u.valhex,0);u.hex=c,delete u.valhex},this.setSigningCertificate=function(u){var c=p(u.valhex,0);if(c.length>0){for(var x=a(u.valhex,c[0]),f=p(x,0),v=[],y=0;y<f.length;y++){var m=a(x,f[y]),b=this.getESSCertID(m);v.push(b)}u.array=v}if(c.length>1){var E=a(u.valhex,c[1]);u.polhex=E}delete u.valhex},this.setSignaturePolicyIdentifier=function(u){var c=p(u.valhex,0);if(c.length>0){var x=n.getOID(u.valhex,c[0]);u.oid=x}if(c.length>1){var f=new t,v=p(u.valhex,c[1]),y=a(u.valhex,v[0]),m=f.getAlgorithmIdentifierName(y);u.alg=m;var b=s(u.valhex,v[1]);u.hash=b}delete u.valhex},this.setSigningCertificateV2=function(u){var c=p(u.valhex,0);if(c.length>0){for(var x=a(u.valhex,c[0]),f=p(x,0),v=[],y=0;y<f.length;y++){var m=a(x,f[y]),b=this.getESSCertIDv2(m);v.push(b)}u.array=v}if(c.length>1){var E=a(u.valhex,c[1]);u.polhex=E}delete u.valhex},this.getESSCertID=function(u){var c={},x=p(u,0);if(x.length>0){var f=s(u,x[0]);c.hash=f}if(x.length>1){var v=a(u,x[1]),y=this.getIssuerSerial(v);y.serial!=null&&(c.serial=y.serial),y.issuer!=null&&(c.issuer=y.issuer)}return c},this.getESSCertIDv2=function(u){var c={},x=p(u,0);if(x.length<1||3<x.length)throw new e("wrong number of elements");var f=0;if(u.substr(x[0],2)=="30"){var v=a(u,x[0]);c.alg=r.getAlgorithmIdentifierName(v),f++}else c.alg="sha256";var y=s(u,x[f]);if(c.hash=y,x.length>f+1){var m=a(u,x[f+1]),b=this.getIssuerSerial(m);c.issuer=b.issuer,c.serial=b.serial}return c},this.getIssuerSerial=function(u){var c={},x=p(u,0),f=a(u,x[0]),v=r.getGeneralNames(f),y=v[0].dn;c.issuer=y;var m=s(u,x[1]);return c.serial={hex:m},c},this.getCertificateSet=function(u){for(var c=p(u,0),x=[],f=0;f<c.length;f++){var v=a(u,c[f]);if(v.substr(0,2)=="30"){var y=Ze(v,"CERTIFICATE");x.push(y)}}return{array:x,sortflag:!1}}};(typeof g>"u"||!g)&&(g={});(typeof g.asn1>"u"||!g.asn1)&&(g.asn1={});(typeof g.asn1.tsp>"u"||!g.asn1.tsp)&&(g.asn1.tsp={});g.asn1.tsp.TimeStampToken=function(e){var t=g,r=t.asn1,n=r.tsp;n.TimeStampToken.superclass.constructor.call(this),this.params=null,this.getEncodedHexPrepare=function(){var s=new n.TSTInfo(this.params.econtent.content);this.params.econtent.content.hex=s.tohex()},e!=null&&this.setByParam(e)};U(g.asn1.tsp.TimeStampToken,g.asn1.cms.SignedData);g.asn1.tsp.TSTInfo=function(e){var t=Error,r=g,n=r.asn1,s=n.DERSequence,a=n.DERInteger,o=n.DERBoolean,i=n.DERGeneralizedTime,h=n.DERObjectIdentifier,l=n.DERTaggedObject,d=n.tsp,p=d.MessageImprint,u=d.Accuracy,c=n.x509.X500Name,x=n.x509.GeneralName;if(d.TSTInfo.superclass.constructor.call(this),this.dVersion=new a({int:1}),this.dPolicy=null,this.dMessageImprint=null,this.dSerial=null,this.dGenTime=null,this.dAccuracy=null,this.dOrdering=null,this.dNonce=null,this.dTsa=null,this.tohex=function(){var f=[this.dVersion];if(this.dPolicy==null)throw new Error("policy shall be specified.");if(f.push(this.dPolicy),this.dMessageImprint==null)throw new Error("messageImprint shall be specified.");if(f.push(this.dMessageImprint),this.dSerial==null)throw new Error("serialNumber shall be specified.");if(f.push(this.dSerial),this.dGenTime==null)throw new Error("genTime shall be specified.");f.push(this.dGenTime),this.dAccuracy!=null&&f.push(this.dAccuracy),this.dOrdering!=null&&f.push(this.dOrdering),this.dNonce!=null&&f.push(this.dNonce),this.dTsa!=null&&f.push(this.dTsa);var v=new s({array:f});return this.hTLV=v.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0){if(typeof e.policy=="string"){if(!e.policy.match(/^[0-9.]+$/))throw"policy shall be oid like 0.1.4.134";this.dPolicy=new h({oid:e.policy})}e.messageImprint!==void 0&&(this.dMessageImprint=new p(e.messageImprint)),e.serial!==void 0&&(this.dSerial=new a(e.serial)),e.genTime!==void 0&&(this.dGenTime=new i(e.genTime)),e.accuracy!==void 0&&(this.dAccuracy=new u(e.accuracy)),e.ordering!==void 0&&e.ordering==!0&&(this.dOrdering=new o),e.nonce!==void 0&&(this.dNonce=new a(e.nonce)),e.tsa!==void 0&&(this.dTsa=new l({tag:"a0",explicit:!0,obj:new x({dn:e.tsa})}))}};U(g.asn1.tsp.TSTInfo,g.asn1.ASN1Object);g.asn1.tsp.Accuracy=function(e){var t=g,r=t.asn1,n=r.ASN1Util.newObject;r.tsp.Accuracy.superclass.constructor.call(this),this.params=null,this.tohex=function(){var s=this.params,a=[];return s.seconds!=null&&typeof s.seconds=="number"&&a.push({int:s.seconds}),s.millis!=null&&typeof s.millis=="number"&&a.push({tag:{tagi:"80",obj:{int:s.millis}}}),s.micros!=null&&typeof s.micros=="number"&&a.push({tag:{tagi:"81",obj:{int:s.micros}}}),n({seq:a}).tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};U(g.asn1.tsp.Accuracy,g.asn1.ASN1Object);g.asn1.tsp.MessageImprint=function(e){var t=g,r=t.asn1,n=r.DERSequence,s=r.DEROctetString,a=r.x509,o=a.AlgorithmIdentifier;r.tsp.MessageImprint.superclass.constructor.call(this),this.params=null,this.tohex=function(){var i=this.params,h=new o({name:i.alg}),l=new s({hex:i.hash}),d=new n({array:[h,l]});return d.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};U(g.asn1.tsp.MessageImprint,g.asn1.ASN1Object);g.asn1.tsp.TimeStampReq=function(e){var t=g,r=t.asn1,n=r.DERSequence,s=r.DERInteger,a=r.DERBoolean,o=r.ASN1Object,i=r.DERObjectIdentifier,h=r.tsp,l=h.MessageImprint;h.TimeStampReq.superclass.constructor.call(this),this.params=null,this.tohex=function(){var d=this.params,p=[];p.push(new s({int:1})),d.messageImprint instanceof g.asn1.ASN1Object?p.push(d.messageImprint):p.push(new l(d.messageImprint)),d.policy!=null&&p.push(new i(d.policy)),d.nonce!=null&&p.push(new s(d.nonce)),d.certreq==!0&&p.push(new a);var u=new n({array:p});return u.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};U(g.asn1.tsp.TimeStampReq,g.asn1.ASN1Object);g.asn1.tsp.TimeStampResp=function(e){var t=g,r=t.asn1,n=r.DERSequence,s=r.ASN1Object,a=r.tsp,o=a.PKIStatusInfo;a.TimeStampResp.superclass.constructor.call(this),this.params=null,this.tohex=function(){var i=this.params,h=[];if(i.econtent!=null||i.tst!=null)if(i.statusinfo!=null?h.push(new o(i.statusinfo)):h.push(new o("granted")),i.econtent!=null)h.push(new a.TimeStampToken(i).getContentInfo());else if(i.tst instanceof r.ASN1Object)h.push(i.tst);else throw new Error("improper member tst value");else if(i.statusinfo!=null)h.push(new o(i.statusinfo));else throw new Error("parameter for token nor statusinfo not specified");var l=new n({array:h});return l.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};U(g.asn1.tsp.TimeStampResp,g.asn1.ASN1Object);g.asn1.tsp.PKIStatusInfo=function(e){var t=Error,r=g,n=r.asn1,s=n.DERSequence,a=n.tsp,o=a.PKIStatus,i=a.PKIFreeText,h=a.PKIFailureInfo;a.PKIStatusInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var l=this.params,d=[];if(typeof l=="string")d.push(new o(l));else{if(l.status==null)throw new t("property 'status' unspecified");d.push(new o(l.status)),l.statusstr!=null&&d.push(new i(l.statusstr)),l.failinfo!=null&&d.push(new h(l.failinfo))}var p=new s({array:d});return p.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};U(g.asn1.tsp.PKIStatusInfo,g.asn1.ASN1Object);g.asn1.tsp.PKIStatus=function(e){var t=Error,r=g,n=r.asn1,s=n.DERInteger,a=n.tsp;a.PKIStatus.superclass.constructor.call(this);var o={granted:0,grantedWithMods:1,rejection:2,waiting:3,revocationWarning:4,revocationNotification:5};this.params=null,this.tohex=function(){var i=this.params,h,l;if(typeof i=="string")try{l=o[i]}catch{throw new t("undefined name: "+i)}else if(typeof i=="number")l=i;else throw new t("unsupported params");return new s({int:l}).tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};U(g.asn1.tsp.PKIStatus,g.asn1.ASN1Object);g.asn1.tsp.PKIFreeText=function(e){var t=Error,r=g,n=r.asn1,s=n.DERSequence,a=n.DERUTF8String,o=n.tsp;o.PKIFreeText.superclass.constructor.call(this),this.params=null,this.tohex=function(){var i=this.params;if(!i instanceof Array)throw new t("wrong params: not array");for(var h=[],l=0;l<i.length;l++)h.push(new a({str:i[l]}));var d=new s({array:h});return d.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};U(g.asn1.tsp.PKIFreeText,g.asn1.ASN1Object);g.asn1.tsp.PKIFailureInfo=function(e){var t=Error,r=g,n=r.asn1,s=n.DERBitString,a=n.tsp,o=a.PKIFailureInfo,i={badAlg:0,badRequest:2,badDataFormat:5,timeNotAvailable:14,unacceptedPolicy:15,unacceptedExtension:16,addInfoNotAvailable:17,systemFailure:25};o.superclass.constructor.call(this),this.params=null,this.getBinValue=function(){var h=this.params,l=0;if(typeof h=="number"&&0<=h&&h<=25){l|=1<<h;for(var d=l.toString(2),p="",u=d.length-1;u>=0;u--)p+=d[u];return p}else{if(typeof h=="string"&&i[h]!=null)return Ci([h],i);if(typeof h=="object"&&h.length!=null)return Ci(h,i);throw new t("wrong params")}},this.tohex=function(){var h=this.params,l=this.getBinValue();return new s({bin:l}).tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};U(g.asn1.tsp.PKIFailureInfo,g.asn1.ASN1Object);g.asn1.tsp.AbstractTSAAdapter=function(e){this.getTSTHex=function(t,r){throw"not implemented yet"}};g.asn1.tsp.SimpleTSAAdapter=function(e){var t=g,r=t.asn1,n=r.tsp,s=t.crypto.Util.hashHex;n.SimpleTSAAdapter.superclass.constructor.call(this),this.params=null,this.serial=0,this.getTSTHex=function(a,o){var i=s(a,o);this.params.econtent.content.messageImprint={alg:o,hash:i},this.params.econtent.content.serial={int:this.serial++};var h=Math.floor(Math.random()*1e9);this.params.econtent.content.nonce={int:h};var l=new n.TimeStampToken(this.params);return l.getContentInfoEncodedHex()},e!==void 0&&(this.params=e)};U(g.asn1.tsp.SimpleTSAAdapter,g.asn1.tsp.AbstractTSAAdapter);g.asn1.tsp.FixedTSAAdapter=function(e){var t=g,r=t.asn1,n=r.tsp,s=t.crypto.Util.hashHex;n.FixedTSAAdapter.superclass.constructor.call(this),this.params=null,this.getTSTHex=function(a,o){var i=s(a,o);this.params.econtent.content.messageImprint={alg:o,hash:i};var h=new n.TimeStampToken(this.params);return h.getContentInfoEncodedHex()},e!==void 0&&(this.params=e)};U(g.asn1.tsp.FixedTSAAdapter,g.asn1.tsp.AbstractTSAAdapter);g.asn1.tsp.TSPUtil=new function(){};g.asn1.tsp.TSPUtil.newTimeStampToken=function(e){return new g.asn1.tsp.TimeStampToken(e)};g.asn1.tsp.TSPUtil.parseTimeStampReq=function(e){var t=new g.asn1.tsp.TSPParser;return t.getTimeStampReq(e)};g.asn1.tsp.TSPUtil.parseMessageImprint=function(e){var t=new g.asn1.tsp.TSPParser;return t.getMessageImprint(e)};g.asn1.tsp.TSPParser=function(){var e=Error,t=te,r=new t,n=W,s=n.getV,a=n.getTLV,o=n.getIdxbyList,i=n.getTLVbyListEx,h=n.getChildIdx,l=["granted","grantedWithMods","rejection","waiting","revocationWarning","revocationNotification"],d={0:"badAlg",2:"badRequest",5:"badDataFormat",14:"timeNotAvailable",15:"unacceptedPolicy",16:"unacceptedExtension",17:"addInfoNotAvailable",25:"systemFailure"};this.getResponse=function(p){var u=h(p,0);if(u.length==1)return this.getPKIStatusInfo(a(p,u[0]));if(u.length>1){var c=this.getPKIStatusInfo(a(p,u[0])),x=a(p,u[1]),f=this.getToken(x);return f.statusinfo=c,f}},this.getToken=function(p){var u=new g.asn1.cms.CMSParser,c=u.getCMSSignedData(p);return this.setTSTInfo(c),c},this.setTSTInfo=function(p){var u=p.econtent;if(u.type=="tstinfo"){var c=u.content.hex,x=this.getTSTInfo(c);u.content=x}},this.getTSTInfo=function(p){var u={},c=h(p,0),x=s(p,c[1]);u.policy=Oi(x);var f=a(p,c[2]);u.messageImprint=this.getMessageImprint(f);var v=s(p,c[3]);u.serial={hex:v};var y=s(p,c[4]);u.genTime={str:ge(y)};var m=0;if(c.length>5&&p.substr(c[5],2)=="30"){var b=a(p,c[5]);u.accuracy=this.getAccuracy(b),m++}if(c.length>5+m&&p.substr(c[5+m],2)=="01"){var E=s(p,c[5+m]);E=="ff"&&(u.ordering=!0),m++}if(c.length>5+m&&p.substr(c[5+m],2)=="02"){var P=s(p,c[5+m]);u.nonce={hex:P},m++}if(c.length>5+m&&p.substr(c[5+m],2)=="a0"){var F=a(p,c[5+m]);F="30"+F.substr(2),pGeneralNames=r.getGeneralNames(F);var D=pGeneralNames[0].dn;u.tsa=D,m++}if(c.length>5+m&&p.substr(c[5+m],2)=="a1"){var S=a(p,c[5+m]);S="30"+S.substr(2);var w=r.getExtParamArray(S);u.ext=w,m++}return u},this.getAccuracy=function(p){for(var u={},c=h(p,0),x=0;x<c.length;x++){var f=p.substr(c[x],2),v=s(p,c[x]),y=parseInt(v,16);f=="02"?u.seconds=y:f=="80"?u.millis=y:f=="81"&&(u.micros=y)}return u},this.getMessageImprint=function(p){if(p.substr(0,2)!="30")throw new Error("head of messageImprint hex shall be x30");var u={},c=h(p,0),x=o(p,0,[0,0]),f=s(p,x),v=n.hextooidstr(f),y=g.asn1.x509.OID.oid2name(v);if(y=="")throw new Error("hashAlg name undefined: "+v);var m=y,b=o(p,0,[1]);return u.alg=m,u.hash=s(p,b),u},this.getPKIStatusInfo=function(p){var u={},c=h(p,0),x=0;try{var f=s(p,c[0]),v=parseInt(f,16);u.status=l[v]}catch{}if(c.length>1&&p.substr(c[1],2)=="30"){var y=a(p,c[1]);u.statusstr=this.getPKIFreeText(y),x++}if(c.length>x&&p.substr(c[1+x],2)=="03"){var m=a(p,c[1+x]);u.failinfo=this.getPKIFailureInfo(m)}return u},this.getPKIFreeText=function(p){for(var u=[],c=h(p,0),x=0;x<c.length;x++)u.push(n.getString(p,c[x]));return u},this.getPKIFailureInfo=function(p){var u=n.getInt(p,0);return d[u]!=null?d[u]:u},this.getTimeStampReq=function(p){var u={};u.certreq=!1;var c=h(p,0);if(c.length<2)throw new Error("TimeStampReq must have at least 2 items");var x=a(p,c[1]);u.messageImprint=g.asn1.tsp.TSPUtil.parseMessageImprint(x);for(var f=2;f<c.length;f++){var v=c[f],y=p.substr(v,2);if(y=="06"){var m=s(p,v);u.policy=n.hextooidstr(m)}y=="02"&&(u.nonce=s(p,v)),y=="01"&&(u.certreq=!0)}return u}};(typeof g>"u"||!g)&&(g={});(typeof g.asn1>"u"||!g.asn1)&&(g.asn1={});(typeof g.asn1.cades>"u"||!g.asn1.cades)&&(g.asn1.cades={});g.asn1.cades.SignaturePolicyIdentifier=function(e){var t=g,r=t.asn1,n=r.cades,s=n.SignaturePolicyId;n.SignaturePolicyIdentifier.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.15",this.params=null,this.getValueArray=function(){return[new s(this.params)]},this.setByParam=function(a){this.params=a},e!=null&&this.setByParam(e)};U(g.asn1.cades.SignaturePolicyIdentifier,g.asn1.cms.Attribute);g.asn1.cades.SignaturePolicyId=function(e){var t=g,r=t.asn1,n=r.DERSequence,s=r.DERObjectIdentifier,a=r.x509,o=a.AlgorithmIdentifier,i=r.cades,h=i.SignaturePolicyId,l=i.OtherHashAlgAndValue;h.superclass.constructor.call(this),this.params=null,this.tohex=function(){var d=this.params,p=[];p.push(new s(d.oid)),p.push(new l(d));var u=new n({array:p});return u.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(d){this.params=d},e!=null&&this.setByParam(e)};U(g.asn1.cades.SignaturePolicyId,g.asn1.ASN1Object);g.asn1.cades.OtherHashAlgAndValue=function(e){var t=Error,r=g,n=r.asn1,s=n.DERSequence,a=n.DEROctetString,o=n.x509,i=o.AlgorithmIdentifier,h=n.cades,l=h.OtherHashAlgAndValue;l.superclass.constructor.call(this),this.params=null,this.tohex=function(){var d=this.params;if(d.alg==null)throw new t("property 'alg' not specified");if(d.hash==null&&d.cert==null)throw new t("property 'hash' nor 'cert' not specified");var p=null;if(d.hash!=null)p=d.hash;else if(d.cert!=null){if(typeof d.cert!="string")throw new t("cert not string");var u=d.cert;d.cert.indexOf("-----BEGIN")!=-1&&(u=Ne(d.cert)),p=g.crypto.Util.hashHex(u,d.alg)}var c=[];c.push(new i({name:d.alg})),c.push(new a({hex:p}));var x=new s({array:c});return x.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};U(g.asn1.cades.OtherHashAlgAndValue,g.asn1.ASN1Object);g.asn1.cades.OtherHashValue=function(e){g.asn1.cades.OtherHashValue.superclass.constructor.call(this);var t=Error,r=g,n=r.lang.String.isHex,s=r.asn1,a=s.DEROctetString,o=r.crypto.Util.hashHex;this.params=null,this.tohex=function(){var i=this.params;if(i.hash==null&&i.cert==null)throw new t("hash or cert not specified");var h=null;if(i.hash!=null)h=i.hash;else if(i.cert!=null){if(typeof i.cert!="string")throw new t("cert not string");var l=i.cert;i.cert.indexOf("-----BEGIN")!=-1&&(l=Ne(i.cert)),h=g.crypto.Util.hashHex(l,"sha1")}return new a({hex:h}).tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};U(g.asn1.cades.OtherHashValue,g.asn1.ASN1Object);g.asn1.cades.SignatureTimeStamp=function(e){var t=Error,r=g,n=r.lang.String.isHex,s=r.asn1,a=s.ASN1Object,o=s.x509,i=s.cades;i.SignatureTimeStamp.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.14",this.params=null,this.getValueArray=function(){var h=this.params;if(h.tst!=null)if(n(h.tst)){var l=new a;return l.hTLV=h.tst,[l]}else{if(h.tst instanceof a)return[h.tst];throw new t("params.tst has wrong value")}else if(h.res!=null){var d=h.res;if(d instanceof a&&(d=d.tohex()),typeof d!="string"||!n(d))throw new t("params.res has wrong value");var p=W.getTLVbyList(d,0,[1]),l=new a;return l.hTLV=h.tst,[l]}},e!=null&&this.setByParam(e)};U(g.asn1.cades.SignatureTimeStamp,g.asn1.cms.Attribute);g.asn1.cades.CompleteCertificateRefs=function(e){var t=Error,r=g,n=r.asn1,s=n.DERSequence,a=n.cades,o=a.OtherCertID,i=r.lang.String.isHex;a.CompleteCertificateRefs.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.21",this.params=null,this.getValueArray=function(){for(var h=this.params,l=[],d=0;d<h.array.length;d++){var p=h.array[d];if(typeof p=="string")if(p.indexOf("-----BEGIN")!=-1)p={cert:p};else if(i(p))p={hash:p};else throw new t("unsupported value: "+p);h.alg!=null&&p.alg==null&&(p.alg=h.alg),h.hasis!=null&&p.hasis==null&&(p.hasis=h.hasis);var u=new o(p);l.push(u)}var c=new s({array:l});return[c]},e!=null&&this.setByParam(e)};U(g.asn1.cades.CompleteCertificateRefs,g.asn1.cms.Attribute);g.asn1.cades.OtherCertID=function(e){var t=g,r=t.asn1,n=r.DERSequence,s=r.cms,a=s.IssuerSerial,o=r.cades,i=o.OtherHashValue,h=o.OtherHashAlgAndValue;o.OtherCertID.superclass.constructor.call(this),this.params=e,this.tohex=function(){var l=this.params;typeof l=="string"&&(l.indexOf("-----BEGIN")!=-1?l={cert:l}:_isHex(l)&&(l={hash:l}));var d=[],p=null;if(l.alg!=null?p=new h(l):p=new i(l),d.push(p),l.cert!=null&&l.hasis==!0||l.issuer!=null&&l.serial!=null){var u=new a(l);d.push(u)}var c=new n({array:d});return c.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};U(g.asn1.cades.OtherCertID,g.asn1.ASN1Object);g.asn1.cades.OtherHash=function(e){var t=Error,r=g,n=r.asn1,s=n.cms,a=n.cades,o=a.OtherHashAlgAndValue,i=a.OtherHashValue,h=r.crypto.Util.hashHex,l=r.lang.String.isHex;a.OtherHash.superclass.constructor.call(this),this.params=null,this.tohex=function(){var d=this.params;typeof d=="string"&&(d.indexOf("-----BEGIN")!=-1?d={cert:d}:l(d)&&(d={hash:d}));var p=null;return d.alg!=null?p=new o(d):p=new i(d),p.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};U(g.asn1.cades.OtherHash,g.asn1.ASN1Object);g.asn1.cades.CAdESUtil=new function(){};g.asn1.cades.CAdESUtil.parseSignedDataForAddingUnsigned=function(e){var t=new g.asn1.cms.CMSParser,r=t.getCMSSignedData(e);return r};g.asn1.cades.CAdESUtil.parseSignerInfoForAddingUnsigned=function(e,t,r){var n=W,s=n.getChildIdx,a=n.getTLV,o=n.getV,i=g,h=i.asn1,l=h.ASN1Object,d=h.cms,p=d.AttributeList,u=d.SignerInfo,c={},x=s(e,t);if(x.length!=6)throw"not supported items for SignerInfo (!=6)";var f=x.shift();c.version=a(e,f);var v=x.shift();c.si=a(e,v);var y=x.shift();c.digalg=a(e,y);var m=x.shift();c.sattrs=a(e,m);var b=x.shift();c.sigalg=a(e,b);var E=x.shift();c.sig=a(e,E),c.sigval=o(e,E);var P=null;return c.obj=new u,P=new l,P.hTLV=c.version,c.obj.dCMSVersion=P,P=new l,P.hTLV=c.si,c.obj.dSignerIdentifier=P,P=new l,P.hTLV=c.digalg,c.obj.dDigestAlgorithm=P,P=new l,P.hTLV=c.sattrs,c.obj.dSignedAttrs=P,P=new l,P.hTLV=c.sigalg,c.obj.dSigAlg=P,P=new l,P.hTLV=c.sig,c.obj.dSig=P,c.obj.dUnsignedAttrs=new p,c};(typeof g.asn1.csr>"u"||!g.asn1.csr)&&(g.asn1.csr={});g.asn1.csr.CertificationRequest=function(e){var t=g,r=t.asn1,n=r.DERBitString,s=r.DERSequence,a=r.csr,o=r.x509,i=a.CertificationRequestInfo;a.CertificationRequest.superclass.constructor.call(this),this.setByParam=function(h){this.params=h},this.sign=function(){var h=new i(this.params).tohex(),l=new g.crypto.Signature({alg:this.params.sigalg});l.init(this.params.sbjprvkey),l.updateHex(h);var d=l.sign();this.params.sighex=d},this.getPEM=function(){return Ze(this.tohex(),"CERTIFICATE REQUEST")},this.tohex=function(){var h=this.params,l=new g.asn1.csr.CertificationRequestInfo(this.params),d=new g.asn1.x509.AlgorithmIdentifier({name:h.sigalg});if(h.sighex==null&&h.sbjprvkey!=null&&this.sign(),h.sighex==null)throw new Error("sighex or sbjprvkey parameter not defined");var p=new n({hex:"00"+h.sighex}),u=new s({array:[l,d,p]});return u.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};U(g.asn1.csr.CertificationRequest,g.asn1.ASN1Object);g.asn1.csr.CertificationRequestInfo=function(e){var t=g,r=t.asn1,n=r.DERBitString,s=r.DERSequence,a=r.DERInteger,o=r.DERUTF8String,i=r.DERTaggedObject,h=r.ASN1Util.newObject,l=r.csr,d=r.x509,p=d.X500Name,u=d.Extensions,c=d.SubjectPublicKeyInfo,x=l.AttributeList;l.CertificationRequestInfo.superclass.constructor.call(this),this.params=null,this.setByParam=function(v){v!=null&&(this.params=v)},this.tohex=function(){var v=this.params,y=[];if(y.push(new a({int:0})),y.push(new p(v.subject)),y.push(new c(ue.getKey(v.sbjpubkey))),v.attrs!=null){var m=f(v.attrs),b=h({tag:{tage:"a0",obj:m}});y.push(b)}else if(v.extreq!=null){var E=new u(v.extreq),b=h({tag:{tage:"a0",obj:{seq:[{oid:"1.2.840.113549.1.9.14"},{set:[E]}]}}});y.push(b)}else y.push(new i({tag:"a0",explicit:!1,obj:new o({str:""})}));var P=new s({array:y});return P.tohex()},this.getEncodedHex=function(){return this.tohex()};function f(v){for(var y=Error,m=g.asn1.x509.Extensions,b=[],E=0;E<v.length;E++){var P=v[E],F=P.attr;if(F=="extensionRequest"){var D=new m(P.ext),S={seq:[{oid:"1.2.840.113549.1.9.14"},{set:[D]}]};b.push(S)}else if(F=="unstructuredName"){var S={seq:[{oid:"1.2.840.113549.1.9.2"},{set:P.names}]};b.push(S)}else if(F=="challengePassword"){var S={seq:[{oid:"1.2.840.113549.1.9.7"},{set:[{utf8str:P.password}]}]};b.push(S)}else throw new y("unknown CSR attribute")}return{set:b}}e!=null&&this.setByParam(e)};U(g.asn1.csr.CertificationRequestInfo,g.asn1.ASN1Object);g.asn1.csr.AttributeList=function(e){function t(r){}};U(g.asn1.csr.AttributeList,g.asn1.ASN1Object);g.asn1.csr.CSRUtil=new function(){};g.asn1.csr.CSRUtil.newCSRPEM=function(e){var t=ue,r=g.asn1.csr,n=new r.CertificationRequest(e),s=n.getPEM();return s};g.asn1.csr.CSRUtil.getParam=function(e,t){var r=W,n=r.getV,s=r.getIdxbyList,a=r.getTLVbyList,o=r.getTLVbyListEx,i=r.getVbyListEx,h=function(m){var b=s(m,0,[0,3,0,0],"06");return n(m,b)!="2a864886f70d01090e"?null:a(m,0,[0,3,0,1,0],"30")},l={};if(e.indexOf("-----BEGIN CERTIFICATE REQUEST")==-1)throw new Error("argument is not PEM file");var d=Ne(e,"CERTIFICATE REQUEST");t&&(l.tbs=a(d,0,[0]));try{var p=o(d,0,[0,1]);if(p=="3000")l.subject={};else{var f=new te;l.subject=f.getX500Name(p)}}catch{}var u=o(d,0,[0,2]),c=ue.getKey(u,null,"pkcs8pub");l.sbjpubkey=ue.getPEM(c,"PKCS8PUB");var x=h(d),f=new te;x!=null&&(l.extreq=f.getExtParamArray(x));try{var v=o(d,0,[1],"30"),f=new te;l.sigalg=f.getAlgorithmIdentifierName(v)}catch{}try{var y=i(d,0,[2]);l.sighex=y}catch{}return l};g.asn1.csr.CSRUtil.verifySignature=function(e){try{var t=null;if(typeof e=="string"&&e.indexOf("-----BEGIN CERTIFICATE REQUEST")!=-1?t=g.asn1.csr.CSRUtil.getParam(e,!0):typeof e=="object"&&e.sbjpubkey!=null&&e.sigalg!=null&&e.sighex!=null&&e.tbs!=null&&(t=e),t==null)return!1;var r=new g.crypto.Signature({alg:t.sigalg});return r.init(t.sbjpubkey),r.updateHex(t.tbs),r.verify(t.sighex)}catch(n){return alert(n),!1}};(typeof g>"u"||!g)&&(g={});(typeof g.asn1>"u"||!g.asn1)&&(g.asn1={});(typeof g.asn1.ocsp>"u"||!g.asn1.ocsp)&&(g.asn1.ocsp={});g.asn1.ocsp.DEFAULT_HASH="sha1";g.asn1.ocsp.OCSPResponse=function(e){g.asn1.ocsp.OCSPResponse.superclass.constructor.call(this);var t=g.asn1.DEREnumerated,r=g.asn1.ASN1Util.newObject,n=g.asn1.ocsp.ResponseBytes,s=["successful","malformedRequest","internalError","tryLater","_not_used_","sigRequired","unauthorized"];this.params=null,this._getStatusCode=function(){var a=this.params.resstatus;return typeof a=="number"?a:typeof a!="string"?-1:s.indexOf(a)},this.setByParam=function(a){this.params=a},this.tohex=function(){var a=this.params,o=this._getStatusCode();if(o==-1)throw new Error("responseStatus not supported: "+a.resstatus);if(o!=0)return r({seq:[{enum:{int:o}}]}).tohex();var i=new n(a);return r({seq:[{enum:{int:0}},{tag:{tag:"a0",explicit:!0,obj:i}}]}).tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};U(g.asn1.ocsp.OCSPResponse,g.asn1.ASN1Object);g.asn1.ocsp.ResponseBytes=function(e){g.asn1.ocsp.ResponseBytes.superclass.constructor.call(this);var t=g.asn1,r=t.DERSequence,n=t.DERObjectIdentifier,s=t.DEROctetString,a=t.ocsp.BasicOCSPResponse;this.params=null,this.setByParam=function(o){this.params=o},this.tohex=function(){var o=this.params;if(o.restype!="ocspBasic")throw new Error("not supported responseType: "+o.restype);var i=new a(o),h=[];h.push(new n({name:"ocspBasic"})),h.push(new s({hex:i.tohex()}));var l=new r({array:h});return l.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};U(g.asn1.ocsp.ResponseBytes,g.asn1.ASN1Object);g.asn1.ocsp.BasicOCSPResponse=function(e){g.asn1.ocsp.BasicOCSPResponse.superclass.constructor.call(this);var t=Error,r=g.asn1,n=r.ASN1Object,s=r.DERSequence,a=r.DERGeneralizedTime,o=r.DERTaggedObject,i=r.DERBitString,h=r.x509.Extensions,l=r.x509.AlgorithmIdentifier,d=r.ocsp,p=d.ResponderID;_SingleResponseList=d.SingleResponseList,_ResponseData=d.ResponseData,this.params=null,this.setByParam=function(u){this.params=u},this.sign=function(){var u=this.params,c=u.tbsresp.tohex(),x=new g.crypto.Signature({alg:u.sigalg});x.init(u.reskey),x.updateHex(c),u.sighex=x.sign()},this.tohex=function(){var u=this.params;u.tbsresp==null&&(u.tbsresp=new _ResponseData(u)),u.sighex==null&&u.reskey!=null&&this.sign();var c=[];if(c.push(u.tbsresp),c.push(new l({name:u.sigalg})),c.push(new i({hex:"00"+u.sighex})),u.certs!=null&&u.certs.length!=null){for(var x=[],f=0;f<u.certs.length;f++){var v=u.certs[f],y=null;if(W.isASN1HEX(v))y=v;else if(v.match(/-----BEGIN/))y=Ne(v);else throw new t("certs["+f+"] not hex or PEM");x.push(new n({tlv:y}))}var m=new s({array:x});c.push(new o({tag:"a0",explicit:!0,obj:m}))}var b=new s({array:c});return b.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};U(g.asn1.ocsp.BasicOCSPResponse,g.asn1.ASN1Object);g.asn1.ocsp.ResponseData=function(e){g.asn1.ocsp.ResponseData.superclass.constructor.call(this);var t=Error,r=g.asn1,n=r.DERSequence,s=r.DERGeneralizedTime,a=r.DERTaggedObject,o=r.x509.Extensions,i=r.ocsp,h=i.ResponderID;_SingleResponseList=i.SingleResponseList,this.params=null,this.tohex=function(){var l=this.params;l.respid!=null&&new t("respid not specified"),l.prodat!=null&&new t("prodat not specified"),l.array!=null&&new t("array not specified");var d=[];if(d.push(new h(l.respid)),d.push(new s(l.prodat)),d.push(new _SingleResponseList(l.array)),l.ext!=null){var p=new o(l.ext);d.push(new a({tag:"a1",explicit:!0,obj:p}))}var u=new n({array:d});return u.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(l){this.params=l},e!==void 0&&this.setByParam(e)};U(g.asn1.ocsp.ResponseData,g.asn1.ASN1Object);g.asn1.ocsp.ResponderID=function(e){g.asn1.ocsp.ResponderID.superclass.constructor.call(this);var t=g,r=t.asn1,n=r.ASN1Util.newObject,s=r.x509.X500Name,a=t.lang.String.isHex,o=Error;this.params=null,this.tohex=function(){var i=this.params;if(i.key!=null){var h=null;if(typeof i.key=="string"){if(a(i.key)&&(h=i.key),i.key.match(/-----BEGIN CERTIFICATE/)){var l=new te(i.key),d=l.getExtSubjectKeyIdentifier();d!=null&&(h=d.kid.hex)}}else if(i.key instanceof te){var d=i.key.getExtSubjectKeyIdentifier();d!=null&&(h=d.kid.hex)}if(h==null)throw new o("wrong key member value");var p=n({tag:{tag:"a2",explicit:!0,obj:{octstr:{hex:h}}}});return p.tohex()}else if(i.name!=null){var u=null;if(typeof i.name=="string"&&i.name.match(/-----BEGIN CERTIFICATE/)){var l=new te(i.name);u=l.getSubject()}else i.name instanceof te?u=i.name.getSubject():typeof i.name=="object"&&(i.name.array!=null||i.name.str!=null)&&(u=i.name);if(u==null)throw new o("wrong name member value");var p=n({tag:{tag:"a1",explicit:!0,obj:new s(u)}});return p.tohex()}throw new o("key or name not specified")},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(i){this.params=i},e!==void 0&&this.setByParam(e)};U(g.asn1.ocsp.ResponderID,g.asn1.ASN1Object);g.asn1.ocsp.SingleResponseList=function(e){g.asn1.ocsp.SingleResponseList.superclass.constructor.call(this);var t=g.asn1,r=t.DERSequence,n=t.ocsp.SingleResponse;this.params=null,this.tohex=function(){var s=this.params;if(typeof s!="object"||s.length==null)throw new Error("params not specified properly");for(var a=[],o=0;o<s.length;o++)a.push(new n(s[o]));var i=new r({array:a});return i.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(s){this.params=s},e!==void 0&&this.setByParam(e)};U(g.asn1.ocsp.SingleResponseList,g.asn1.ASN1Object);g.asn1.ocsp.SingleResponse=function(e){var t=Error,r=g,n=r.asn1,s=n.DERSequence,a=n.DERGeneralizedTime,o=n.DERTaggedObject,i=n.ocsp,h=i.CertID,l=i.CertStatus,d=n.x509,p=d.Extensions;i.SingleResponse.superclass.constructor.call(this),this.params=null,this.tohex=function(){var u=this.params,c=[];if(u.certid==null)throw new t("certid unspecified");if(u.status==null)throw new t("status unspecified");if(u.thisupdate==null)throw new t("thisupdate unspecified");if(c.push(new h(u.certid)),c.push(new l(u.status)),c.push(new a(u.thisupdate)),u.nextupdate!=null){var x=new a(u.nextupdate);c.push(new o({tag:"a0",explicit:!0,obj:x}))}if(u.ext!=null){var f=new p(u.ext);c.push(new o({tag:"a1",explicit:!0,obj:f}))}var v=new s({array:c});return v.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(u){this.params=u},e!==void 0&&this.setByParam(e)};U(g.asn1.ocsp.SingleResponse,g.asn1.ASN1Object);g.asn1.ocsp.CertID=function(e){var t=g,r=t.asn1,n=r.DEROctetString,s=r.DERInteger,a=r.DERSequence,o=r.x509,i=o.AlgorithmIdentifier,h=r.ocsp,l=h.DEFAULT_HASH,d=t.crypto,p=d.Util.hashHex,u=te,c=W,x=c.getVbyList;h.CertID.superclass.constructor.call(this),this.DEFAULT_HASH="sha1",this.params=null,this.setByValue=function(f,v,y,m){m==null&&(m=this.DEFAULT_HASH),this.params={alg:m,issname:f,isskey:v,sbjsn:y}},this.setByCert=function(f,v,y){y==null&&(y=this.DEFAULT_HASH),this.params={alg:y,issuerCert:f,subjectCert:v}},this.getParamByCerts=function(f,v,y){y==null&&(y=this.DEFAULT_HASH);var m=new u(f),b=new u(v),E=p(m.getSubjectHex(),y),P=m.getPublicKeyHex(),F=p(x(P,0,[1],"03",!0),y),D=b.getSerialNumberHex(),S={alg:y,issname:E,isskey:F,sbjsn:D};return S},this.tohex=function(){if(typeof this.params!="object")throw new Error("params not set");var f=this.params,v,y,m,b;if(f.alg==null?b=this.DEFAULT_HASH:b=f.alg,f.issuerCert!=null&&f.subjectCert!=null){var E=this.getParamByCerts(f.issuerCert,f.subjectCert,b);v=E.issname,y=E.isskey,m=E.sbjsn}else if(f.issname!=null&&f.isskey!=null&&f.sbjsn!=null)v=f.issname,y=f.isskey,m=f.sbjsn;else throw new Error("required param members not defined");var P=new i({name:b}),F=new n({hex:v}),D=new n({hex:y}),S=new s({hex:m}),w=new a({array:[P,F,D,S]});return this.hTLV=w.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};U(g.asn1.ocsp.CertID,g.asn1.ASN1Object);g.asn1.ocsp.CertStatus=function(e){g.asn1.ocsp.CertStatus.superclass.constructor.call(this),this.params=null,this.tohex=function(){var t=this.params;if(t.status=="good")return"8000";if(t.status=="unknown")return"8200";if(t.status=="revoked"){var r=[{gentime:{str:t.time}}];t.reason!=null&&r.push({tag:{tag:"a0",explicit:!0,obj:{enum:{int:t.reason}}}});var n={tag:"a1",explicit:!1,obj:{seq:r}};return g.asn1.ASN1Util.newObject({tag:n}).tohex()}throw new Error("bad status")},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(t){this.params=t},e!==void 0&&this.setByParam(e)};U(g.asn1.ocsp.CertStatus,g.asn1.ASN1Object);g.asn1.ocsp.Request=function(e){var t=g,r=t.asn1,n=r.DERSequence,s=r.ocsp;if(s.Request.superclass.constructor.call(this),this.dReqCert=null,this.dExt=null,this.tohex=function(){var o=[];if(this.dReqCert===null)throw"reqCert not set";o.push(this.dReqCert);var i=new n({array:o});return this.hTLV=i.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},typeof e<"u"){var a=new s.CertID(e);this.dReqCert=a}};U(g.asn1.ocsp.Request,g.asn1.ASN1Object);g.asn1.ocsp.TBSRequest=function(e){var t=g,r=t.asn1,n=r.DERSequence,s=r.ocsp;s.TBSRequest.superclass.constructor.call(this),this.version=0,this.dRequestorName=null,this.dRequestList=[],this.dRequestExt=null,this.setRequestListByParam=function(a){for(var o=[],i=0;i<a.length;i++){var h=new s.Request(a[0]);o.push(h)}this.dRequestList=o},this.tohex=function(){var a=[];if(this.version!==0)throw"not supported version: "+this.version;if(this.dRequestorName!==null)throw"requestorName not supported";var o=new n({array:this.dRequestList});if(a.push(o),this.dRequestExt!==null)throw"requestExtensions not supported";var i=new n({array:a});return this.hTLV=i.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&e.reqList!==void 0&&this.setRequestListByParam(e.reqList)};U(g.asn1.ocsp.TBSRequest,g.asn1.ASN1Object);g.asn1.ocsp.OCSPRequest=function(e){var t=g,r=t.asn1,n=r.DERSequence,s=r.ocsp;if(s.OCSPRequest.superclass.constructor.call(this),this.dTbsRequest=null,this.dOptionalSignature=null,this.tohex=function(){var o=[];if(this.dTbsRequest!==null)o.push(this.dTbsRequest);else throw"tbsRequest not set";if(this.dOptionalSignature!==null)throw"optionalSignature not supported";var i=new n({array:o});return this.hTLV=i.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&e.reqList!==void 0){var a=new s.TBSRequest(e);this.dTbsRequest=a}};U(g.asn1.ocsp.OCSPRequest,g.asn1.ASN1Object);g.asn1.ocsp.OCSPUtil={};g.asn1.ocsp.OCSPUtil.getRequestHex=function(e,t,r){var n=g,s=n.asn1,a=s.ocsp;r===void 0&&(r=a.DEFAULT_HASH);var o={alg:r,issuerCert:e,subjectCert:t},i=new a.OCSPRequest({reqList:[o]});return i.tohex()};g.asn1.ocsp.OCSPUtil.getOCSPResponseInfo=function(e){var t=W,r=t.getVbyList,n=t.getVbyListEx,s=t.getIdxbyList,a=t.getIdxbyListEx,o=t.getV,i={};try{var h=n(e,0,[0],"0a");i.responseStatus=parseInt(h,16)}catch{}if(i.responseStatus!==0)return i;try{var l=s(e,0,[1,0,1,0,0,2,0,1]);e.substr(l,2)==="80"?i.certStatus="good":e.substr(l,2)==="a1"?(i.certStatus="revoked",i.revocationTime=ge(r(e,l,[0]))):e.substr(l,2)==="82"&&(i.certStatus="unknown")}catch{}try{var d=s(e,0,[1,0,1,0,0,2,0,2]);i.thisUpdate=ge(o(e,d))}catch{}try{var p=s(e,0,[1,0,1,0,0,2,0,3]);e.substr(p,2)==="a0"&&(i.nextUpdate=ge(r(e,p,[0])))}catch{}return i};g.asn1.ocsp.OCSPParser=function(){var e=Error,t=te,r=new t,n=W,s=n.getV,a=n.getTLV,o=n.getIdxbyList,i=n.getVbyList,h=n.getTLVbyList,l=n.getVbyListEx,d=n.getTLVbyListEx,p=n.getChildIdx;this.getOCSPRequest=function(u){var c=p(u,0);if(c.length!=1&&c.length!=2)throw new e("wrong number elements: "+c.length);var x=this.getTBSRequest(a(u,c[0]));return x},this.getTBSRequest=function(u){var c={},x=d(u,0,[0],"30");c.array=this.getRequestList(x);var f=d(u,0,["[2]",0],"30");return f!=null&&(c.ext=r.getExtParamArray(f)),c},this.getRequestList=function(u){for(var c=[],x=p(u,0),f=0;f<x.length;f++){var u=a(u,x[f]);c.push(this.getRequest(u))}return c},this.getRequest=function(u){var c=p(u,0);if(c.length!=1&&c.length!=2)throw new e("wrong number elements: "+c.length);var x=this.getCertID(a(u,c[0]));if(c.length==2){var f=o(u,0,[1,0]);x.ext=r.getExtParamArray(a(u,f))}return x},this.getCertID=function(u){var c=p(u,0);if(c.length!=4)throw new e("wrong number elements: "+c.length);var x=new t,f={};return f.alg=x.getAlgorithmIdentifierName(a(u,c[0])),f.issname=s(u,c[1]),f.isskey=s(u,c[2]),f.sbjsn=s(u,c[3]),f},this.getOCSPResponse=function(u){var c=p(u,0),x,f=s(u,c[0]),v=parseInt(f);if(c.length==1)return{resstatus:v};var y=h(u,0,[1,0]);return x=this.getResponseBytes(y),x.resstatus=v,x},this.getResponseBytes=function(u){var c=p(u,0),x,f=h(u,0,[1,0]);x=this.getBasicOCSPResponse(f);var v=s(u,c[0]);return x.restype=g.asn1.x509.OID.oid2name(Oi(v)),x},this.getBasicOCSPResponse=function(u){var c=p(u,0),x;x=this.getResponseData(a(u,c[0]));var f=new te;x.alg=f.getAlgorithmIdentifierName(a(u,c[1]));var v=s(u,c[2]);x.sighex=v.substr(2);var y=l(u,0,["[0]"]);if(y!=null){for(var m=p(y,0),b=[],E=0;E<m.length;E++){var P=a(y,m[E]);b.push(P)}x.certs=b}return x},this.getResponseData=function(u){var c=p(u,0),x=c.length,f={},v=0;u.substr(c[0],2)=="a0"&&v++,f.respid=this.getResponderID(a(u,c[v++]));var y=s(u,c[v++]);if(f.prodat=ge(y),f.array=this.getSingleResponseList(a(u,c[v++])),u.substr(c[x-1],2)=="a1"){var m=h(u,c[x-1],[0]),b=new te;f.ext=b.getExtParamArray(m)}return f},this.getResponderID=function(u){var c={};if(u.substr(0,2)=="a2"){var x=i(u,0,[0]);c.key=x}if(u.substr(0,2)=="a1"){var f=h(u,0,[0]),v=new te;c.name=v.getX500Name(f)}return c},this.getSingleResponseList=function(u){for(var c=p(u,0),x=[],f=0;f<c.length;f++){var v=this.getSingleResponse(a(u,c[f]));x.push(v)}return x},this.getSingleResponse=function(u){var c=p(u,0),x={},f=this.getCertID(a(u,c[0]));x.certid=f;var v=this.getCertStatus(a(u,c[1]));if(x.status=v,u.substr(c[2],2)=="18"){var y=s(u,c[2]);x.thisupdate=ge(y)}for(var m=3;m<c.length;m++){if(u.substr(c[m],2)=="a0"){var b=i(u,c[m],[0],"18");x.nextupdate=ge(b)}if(u.substr(c[m],2)=="a1"){var E=new te,P=h(u,0,[m,0]);x.ext=E.getExtParamArray(P)}}return x},this.getCertStatus=function(u){var c={};if(u=="8000")return{status:"good"};if(u=="8200")return{status:"unknown"};if(u.substr(0,2)=="a1"){c.status="revoked";var x=i(u,0,[0]),f=ge(x);c.time=f}return c}};var g;(typeof g>"u"||!g)&&(g={});(typeof g.lang>"u"||!g.lang)&&(g.lang={});g.lang.String=function(){};function lu(e){for(var t=new Array,r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}function du(e){for(var t="",r=0;r<e.length;r++)t=t+String.fromCharCode(e[r]);return t}function Di(e){for(var t="",r=0;r<e.length;r++){var n=e[r].toString(16);n.length==1&&(n="0"+n),t=t+n}return t}function st(e){return Di(lu(e))}function gv(e){return qt(st(e))}function yv(e){return Ar(qt(st(e)))}function mv(e){return du(au(un(e)))}function Ar(e){return e=e.replace(/\=/g,""),e=e.replace(/\+/g,"-"),e=e.replace(/\//g,"_"),e}function un(e){return e.length%4==2?e=e+"==":e.length%4==3&&(e=e+"="),e=e.replace(/-/g,"+"),e=e.replace(/_/g,"/"),e}function Me(e){return e.length%2==1&&(e="0"+e),Ar(qt(e))}function _e(e){return Fr(un(e))}var an,At;typeof V.Buffer=="function"?(an=function(e){return Ar(V.Buffer.from(e,"utf8").toString("base64"))},At=function(e){return V.Buffer.from(un(e),"base64").toString("utf8")}):(an=function(e){return Me(Ni(Ti(e)))},At=function(e){return decodeURIComponent(Hi(_e(e)))});function Sv(e){return qt(Ni(Ti(e)))}function bv(e){return decodeURIComponent(Hi(Fr(e)))}function Ii(e){return Ni(Ti(e)).toLowerCase()}function ge(e){try{return decodeURIComponent(Hi(e))}catch{return null}}function wv(e){return ge(Ev(e))}function Ev(e){for(var t=e.match(/.{1,2}/g),r=[],n=0;n<t.length;n++){var s=parseInt(t[n],16);161<=s&&s<=191?(r.push("c2"),r.push(t[n])):192<=s&&s<=255?(r.push("c3"),r.push((s-64).toString(16))):r.push(t[n])}return r.join("")}function et(e){for(var t="",r=0;r<e.length-1;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t}function pt(e){for(var t="",r=0;r<e.length;r++)t+=("0"+e.charCodeAt(r).toString(16)).slice(-2);return t}function Ts(e){return qt(e)}function Pv(e){return Ri(Ts(e),64)}function Ri(e,t){return e=e.replace(new RegExp("(.{"+t+"})","g"),`$1\r
`),e=e.replace(/\s+$/,""),e}function vu(e){var t=e.replace(/[^0-9A-Za-z\/+=]*/g,""),r=Fr(t);return r}function Av(e,t){return"-----BEGIN "+t+`-----\r
`+Ri(e,64)+`\r
-----END `+t+`-----\r
`}function Ze(e,t){return"-----BEGIN "+t+`-----\r
`+Ri(Ts(e),64)+`\r
-----END `+t+`-----\r
`}function Ne(e,t){if(e.indexOf("-----BEGIN ")==-1)throw new Error("can't find PEM header");return t!==void 0?(e=e.replace(new RegExp("^[^]*-----BEGIN "+t+"-----"),""),e=e.replace(new RegExp("-----END "+t+"-----[^]*$"),"")):(e=e.replace(/^[^]*-----BEGIN [^-]+-----/,""),e=e.replace(/-----END [^-]+-----[^]*$/,"")),vu(e)}function Fv(e){return e.indexOf("-----BEGIN ")==-1||e.indexOf("-----END ")==-1?null:(e=e.replace(/^[\s\S]*?-----BEGIN [^-]+-----/m,""),e=e.replace(/-----END [\s\S]+$/m,""),e=e.replace(/\s+/g,""),e.match(/^[0-9a-zA-Z+/=]+$/)?e:null)}function Cv(e){if(e.length%2!=0)throw"input is not even length";if(e.match(/^[0-9A-Fa-f]+$/)==null)throw"input is not hexadecimal";for(var t=new ArrayBuffer(e.length/2),r=new DataView(t),n=0;n<e.length/2;n++)r.setUint8(n,parseInt(e.substr(n*2,2),16));return t}function _v(e){for(var t="",r=new DataView(e),n=0;n<e.byteLength;n++)t+=("00"+r.getUint8(n).toString(16)).slice(-2);return t}function Os(e){var t,r,n,s,a,o,i,h,l,d,p,u;if(e=xu(e),u=e.match(/^(\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/),u)return t=parseInt(u[1]),r=parseInt(u[2])-1,n=parseInt(u[3]),s=parseInt(u[4]),a=parseInt(u[5]),o=parseInt(u[6]),i=0,d=u[7],d!==""&&(p=(d.substr(1)+"00").substr(0,3),i=parseInt(p)),Date.UTC(t,r,n,s,a,o,i);throw new Error("unsupported zulu format: "+e)}function Bv(e){var t=new Date(e),r=("0000"+t.getUTCFullYear()).slice(-4),n=("00"+(t.getUTCMonth()+1)).slice(-2),s=("00"+t.getUTCDate()).slice(-2),a=("00"+t.getUTCHours()).slice(-2),o=("00"+t.getUTCMinutes()).slice(-2),i=("00"+t.getUTCSeconds()).slice(-2),h=("000"+t.getUTCMilliseconds()).slice(-3);return h=h.replace(/0+$/,""),h=h!=""?"."+h:h,r+n+s+a+o+i+h+"Z"}function pu(e){return Math.round(Os(e)/1e3)}function Dv(e){return new Date(Os(e))}function Iv(e,t,r){var n,s=e.getUTCFullYear();if(t){if(s<1950||2049<s)throw"not proper year for UTCTime: "+s;n=(""+s).slice(-2)}else n=("000"+s).slice(-4);if(n+=("0"+(e.getUTCMonth()+1)).slice(-2),n+=("0"+e.getUTCDate()).slice(-2),n+=("0"+e.getUTCHours()).slice(-2),n+=("0"+e.getUTCMinutes()).slice(-2),n+=("0"+e.getUTCSeconds()).slice(-2),r){var a=e.getUTCMilliseconds();a!==0&&(a=("00"+a).slice(-3),a=a.replace(/0+$/g,""),n+="."+a)}return n+="Z",n}function xu(e){return e.match(/^[0-9]{12}Z$/)||e.match(/^[0-9]{12}[.][0-9]*Z$/)?e.match(/^[0-4]/)?"20"+e:"19"+e:e}function Ni(e){return e.replace(/%/g,"")}function Hi(e){return e.replace(/(..)/g,"%$1")}function _s(e){var t="malformed IPv6 address";if(!e.match(/^[0-9A-Fa-f:]+$/))throw t;e=e.toLowerCase();var r=e.split(":").length-1;if(r<2)throw t;var n=":".repeat(7-r+2);e=e.replace("::",n);var s=e.split(":");if(s.length!=8)throw t;for(var a=0;a<8;a++)s[a]=("0000"+s[a]).slice(-4);return s.join("")}function Bs(e){if(!e.match(/^[0-9A-Fa-f]{32}$/))throw new Error("malformed IPv6 address: "+e);e=e.toLowerCase();var t=e.match(/.{1,4}/g);t=t.map(function(s){return s.replace(/^0+/,"")}),t=t.map(function(s){return s==""?"0":s}),e=":"+t.join(":")+":";var r=e.match(/:(0:){2,}/g);if(r==null)return e.slice(1,-1);var n=r.sort().slice(-1)[0];return e=e.replace(n.substr(0,n.length-1),":"),e.substr(0,2)!="::"&&(e=e.substr(1)),e.substr(-2,2)!="::"&&(e=e.substr(0,e.length-1)),e}function Ai(e){var t=new Error("malformed hex value");if(!e.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw t;if(e.length==8){var r;try{return r=parseInt(e.substr(0,2),16)+"."+parseInt(e.substr(2,2),16)+"."+parseInt(e.substr(4,2),16)+"."+parseInt(e.substr(6,2),16),r}catch{throw t}}else if(e.length==16)try{return Ai(e.substr(0,8))+"/"+iu(e.substr(8))}catch{throw t}else{if(e.length==32)return Bs(e);if(e.length==64){try{return Bs(e.substr(0,32))+"/"+iu(e.substr(32))}catch{throw t}return}else return e}}function iu(e){var t=new Error("malformed mask"),r;try{r=new M(e,16).toString(2)}catch{throw t}if(!r.match(/^1*0*$/))throw t;return r.replace(/0+$/,"").length}function js(e){var t=new Error("malformed IP address");if(e=e.toLowerCase(e),!e.match(/^[0-9a-f.:/]+$/))throw t;if(e.match(/^[0-9.]+$/)){var r=e.split(".");if(r.length!==4)throw t;var n="";try{for(var s=0;s<4;s++){var a=parseInt(r[s]);n+=("0"+a.toString(16)).slice(-2)}return n}catch{throw t}}else if(e.match(/^[0-9.]+\/[0-9]+$/)){var o=e.split("/");return js(o[0])+su(parseInt(o[1]),32)}else{if(e.match(/^[0-9a-f:]+$/)&&e.indexOf(":")!==-1)return _s(e);if(e.match(/^[0-9a-f:]+\/[0-9]+$/)&&e.indexOf(":")!==-1){var o=e.split("/");return _s(o[0])+su(parseInt(o[1]),128)}else throw t}}function su(e,t){if(t==32&&e==0)return"00000000";if(t==128&&e==0)return"00000000000000000000000000000000";var r=Array(e+1).join("1")+Array(t-e+1).join("0");return new M(r,2).toString(16)}function qs(e){function t(s){var a=parseInt(s.substr(0,2),16),o=parseInt(s.substr(2),16);if(a==0&o<128)return String.fromCharCode(o);if(a<8){var i=192|(a&7)<<3|(o&192)>>6,h=128|o&63;return ge(i.toString(16)+h.toString(16))}var i=224|(a&240)>>4,h=128|(a&15)<<2|(o&192)>>6,l=128|o&63;return ge(i.toString(16)+h.toString(16)+l.toString(16))}var r=e.match(/.{4}/g),n=r.map(t);return n.join("")}function Ti(e){for(var t=encodeURIComponent(e),r="",n=0;n<t.length;n++)t[n]=="%"?(r=r+t.substr(n,3),n=n+2):r=r+"%"+st(t[n]);return r}function Rv(e){return e=e.replace(/\r\n/mg,`
`),e}function Nv(e){return e=e.replace(/\r\n/mg,`
`),e=e.replace(/\n/mg,`\r
`),e}g.lang.String.isInteger=function(e){return e.match(/^[0-9]+$/)?!0:!!e.match(/^-[0-9]+$/)};g.lang.String.isHex=function(e){return gu(e)};function gu(e){return!!(e.length%2==0&&(e.match(/^[0-9a-f]+$/)||e.match(/^[0-9A-F]+$/)))}g.lang.String.isBase64=function(e){return e=e.replace(/\s+/g,""),!!(e.match(/^[0-9A-Za-z+\/]+={0,3}$/)&&e.length%4==0)};g.lang.String.isBase64URL=function(e){return e.match(/[+/=]/)?!1:(e=un(e),g.lang.String.isBase64(e))};function Ks(e){return!!e.match(/^[0-9A-Za-z-_.]+$/)}g.lang.String.isIntegerArray=function(e){return e=e.replace(/\s+/g,""),!!e.match(/^\[[0-9,]+\]$/)};g.lang.String.isPrintable=function(e){return e.match(/^[0-9A-Za-z '()+,-./:=?]*$/)!==null};g.lang.String.isIA5=function(e){return e.match(/^[\x20-\x21\x23-\x7f]*$/)!==null};g.lang.String.isMail=function(e){return e.match(/^[A-Za-z0-9]{1}[A-Za-z0-9_.-]*@{1}[A-Za-z0-9_.-]{1,}\.[A-Za-z0-9]{1,}$/)!==null};function Ds(e){return e.length%2==1?"0"+e:e.substr(0,1)>"7"?"00"+e:e}function Hv(e){e=e.replace(/^\s*\[\s*/,""),e=e.replace(/\s*\]\s*$/,""),e=e.replace(/\s*/g,"");try{var t=e.split(/,/).map(function(r,n,s){var a=parseInt(r);if(a<0||255<a)throw"integer not in range 0-255";var o=("00"+a.toString(16)).slice(-2);return o}).join("");return t}catch(r){throw"malformed integer array string: "+r}}var Tv=function(e,t){var r=e.length;e.length>t.length&&(r=t.length);for(var n=0;n<r;n++)if(e.charCodeAt(n)!=t.charCodeAt(n))return n;return e.length!=t.length?r:-1};function yu(e){var t=function(i){var h=i.toString(16);return h.length==1&&(h="0"+h),h},r=function(i){var h="",l=parseInt(i,10),d=l.toString(2),p=7-d.length%7;p==7&&(p=0);for(var u="",c=0;c<p;c++)u+="0";d=u+d;for(var c=0;c<d.length-1;c+=7){var x=d.substr(c,7);c!=d.length-7&&(x="1"+x),h+=t(parseInt(x,2))}return h};try{if(!e.match(/^[0-9.]+$/))return null;var n="",s=e.split("."),a=parseInt(s[0],10)*40+parseInt(s[1],10);n+=t(a),s.splice(0,2);for(var o=0;o<s.length;o++)n+=r(s[o]);return n}catch{return null}}function Oi(e){if(!gu(e))return null;try{var t=[],r=e.substr(0,2),n=parseInt(r,16);t[0]=new String(Math.floor(n/40)),t[1]=new String(n%40);for(var s=e.substr(2),a=[],o=0;o<s.length/2;o++)a.push(parseInt(s.substr(o*2,2),16));for(var i=[],h="",o=0;o<a.length;o++)a[o]&128?h=h+Fi((a[o]&127).toString(2),7):(h=h+Fi((a[o]&127).toString(2),7),i.push(new String(parseInt(h,2))),h="");var l=t.join(".");return i.length>0&&(l=l+"."+i.join(".")),l}catch{return null}}function mu(e){var t=new M(String(e),10);return fn(t)}function fn(e){var t=e.toString(16);if(t.substr(0,1)!="-")return t.length%2==1?t="0"+t:t.match(/^[0-7]/)||(t="00"+t),t;var r=t.substr(1),n=r.length;n%2==1?n+=1:t.match(/^[0-7]/)||(n+=2);for(var s="",a=0;a<n;a++)s+="f";var o=new M(s,16),i=o.xor(e).add(M.ONE);return t=i.toString(16).replace(/^-/,""),t}var Fi=function(e,t,r){return r==null&&(r="0"),e.length>=t?e:new Array(t-e.length+1).join(r)+e};function Su(e){if(e.length%2!=0||(e=e.toLowerCase(),e.match(/^[0-9a-f]+$/)==null))return-1;try{var t=e.substr(0,2);if(t=="00")return parseInt(e.substr(2),16);var r=parseInt(t,16);if(r>7)return-1;var n=e.substr(2),s=parseInt(n,16).toString(2);s=="0"&&(s="00000000"),s=s.slice(0,0-r);var a=parseInt(s,2);return a==NaN?-1:a}catch{return-1}}function bu(e){if(typeof e!="number"||e<0)return null;var t=Number(e).toString(2),r=8-t.length%8;r==8&&(r=0),t=t+Fi("",r,"0");var n=parseInt(t,2).toString(16);n.length%2==1&&(n="0"+n);var s="0"+r;return s+n}function wu(e){if(typeof e!="string"||e.length%2!=0||!e.match(/^[0-9a-f]+$/))return null;try{var t=parseInt(e.substr(0,2),16);if(t<0||7<t)return null;for(var r=e.substr(2),n="",s=0;s<r.length;s+=2){var a=r.substr(s,2),o=parseInt(a,16).toString(2);o=("0000000"+o).slice(-8),n+=o}return n.substr(0,n.length-t)}catch{return null}}function Ov(e){if(typeof e!="string"||e.match(/^[01]+$/)==null)return null;try{var t=parseInt(e,2);return bu(t)}catch{return null}}function Ci(e,t){for(var r=0,n=0;n<e.length;n++)r|=1<<t[e[n]];for(var s=r.toString(2),a="",n=s.length-1;n>=0;n--)a+=s[n];return a}function Se(e,n,r){if(typeof e=="object"){for(var n=String(n).split("."),s=0;s<n.length&&e;s++){var a=n[s];a.match(/^[0-9]+$/)&&(a=parseInt(a)),e=e[a]}return e||e===!1?e:r}}function U(e,t){var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.superclass=t.prototype,t.prototype.constructor==Object.prototype.constructor&&(t.prototype.constructor=t)}(typeof g>"u"||!g)&&(g={});(typeof g.crypto>"u"||!g.crypto)&&(g.crypto={});g.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHAwithRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:J.algo.MD5,sha1:J.algo.SHA1,sha224:J.algo.SHA224,sha256:J.algo.SHA256,sha384:J.algo.SHA384,sha512:J.algo.SHA512,ripemd160:J.algo.RIPEMD160},this.getDigestInfoHex=function(e,t){if(typeof this.DIGESTINFOHEAD[t]>"u")throw"alg not supported in Util.DIGESTINFOHEAD: "+t;return this.DIGESTINFOHEAD[t]+e},this.getPaddedDigestInfoHex=function(e,t,r){var n=this.getDigestInfoHex(e,t),s=r/4;if(n.length+22>s)throw"key is too short for SigAlg: keylen="+r+","+t;for(var a="0001",o="00"+n,i="",h=s-a.length-o.length,l=0;l<h;l+=2)i+="ff";var d=a+i+o;return d},this.hashString=function(e,t){var r=new g.crypto.MessageDigest({alg:t});return r.digestString(e)},this.hashHex=function(e,t){var r=new g.crypto.MessageDigest({alg:t});return r.digestHex(e)},this.sha1=function(e){return this.hashString(e,"sha1")},this.sha256=function(e){return this.hashString(e,"sha256")},this.sha256Hex=function(e){return this.hashHex(e,"sha256")},this.sha512=function(e){return this.hashString(e,"sha512")},this.sha512Hex=function(e){return this.hashHex(e,"sha512")},this.isKey=function(e){return e instanceof ee||e instanceof g.crypto.DSA||e instanceof g.crypto.ECDSA}};g.crypto.Util.md5=function(e){var t=new g.crypto.MessageDigest({alg:"md5",prov:"cryptojs"});return t.digestString(e)};g.crypto.Util.ripemd160=function(e){var t=new g.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"});return t.digestString(e)};g.crypto.Util.SECURERANDOMGEN=new Jt;g.crypto.Util.getRandomHexOfNbytes=function(e){var t=new Array(e);return g.crypto.Util.SECURERANDOMGEN.nextBytes(t),Di(t)};g.crypto.Util.getRandomBigIntegerOfNbytes=function(e){return new M(g.crypto.Util.getRandomHexOfNbytes(e),16)};g.crypto.Util.getRandomHexOfNbits=function(e){var t=e%8,r=(e-t)/8,n=new Array(r+1);return g.crypto.Util.SECURERANDOMGEN.nextBytes(n),n[0]=(255<<t&255^255)&n[0],Di(n)};g.crypto.Util.getRandomBigIntegerOfNbits=function(e){return new M(g.crypto.Util.getRandomHexOfNbits(e),16)};g.crypto.Util.getRandomBigIntegerZeroToMax=function(e){for(var t=e.bitLength();;){var r=g.crypto.Util.getRandomBigIntegerOfNbits(t);if(e.compareTo(r)!=-1)return r}};g.crypto.Util.getRandomBigIntegerMinToMax=function(e,t){var r=e.compareTo(t);if(r==1)throw"biMin is greater than biMax";if(r==0)return e;var n=t.subtract(e),s=g.crypto.Util.getRandomBigIntegerZeroToMax(n);return s.add(e)};g.crypto.MessageDigest=function(e){var t=null,r=null,n=null;this.setAlgAndProvider=function(s,a){if(s=g.crypto.MessageDigest.getCanonicalAlgName(s),s!==null&&a===void 0&&(a=g.crypto.Util.DEFAULTPROVIDER[s]),":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(s)!=-1&&a=="cryptojs"){try{this.md=g.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[s].create()}catch(o){throw"setAlgAndProvider hash alg set fail alg="+s+"/"+o}this.updateString=function(o){this.md.update(o)},this.updateHex=function(o){var i=J.enc.Hex.parse(o);this.md.update(i)},this.digest=function(){var o=this.md.finalize();return o.toString(J.enc.Hex)},this.digestString=function(o){return this.updateString(o),this.digest()},this.digestHex=function(o){return this.updateHex(o),this.digest()}}if(":sha256:".indexOf(s)!=-1&&a=="sjcl"){try{this.md=new sjcl.hash.sha256}catch(o){throw"setAlgAndProvider hash alg set fail alg="+s+"/"+o}this.updateString=function(o){this.md.update(o)},this.updateHex=function(o){var i=sjcl.codec.hex.toBits(o);this.md.update(i)},this.digest=function(){var o=this.md.finalize();return sjcl.codec.hex.fromBits(o)},this.digestString=function(o){return this.updateString(o),this.digest()},this.digestHex=function(o){return this.updateHex(o),this.digest()}}},this.updateString=function(s){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(s){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(s){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(s){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},e!==void 0&&e.alg!==void 0&&(this.algName=e.alg,e.prov===void 0&&(this.provName=g.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))};g.crypto.MessageDigest.getCanonicalAlgName=function(e){return typeof e=="string"&&(e=e.toLowerCase(),e=e.replace(/-/,"")),e};g.crypto.MessageDigest.getHashLength=function(e){var t=g.crypto.MessageDigest,r=t.getCanonicalAlgName(e);if(t.HASHLENGTH[r]===void 0)throw"not supported algorithm: "+e;return t.HASHLENGTH[r]};g.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20};g.crypto.Mac=function(e){var t=null,r=null,n=null,s=null,a=null;this.setAlgAndProvider=function(o,i){if(o=o.toLowerCase(),o==null&&(o="hmacsha1"),o=o.toLowerCase(),o.substr(0,4)!="hmac")throw"setAlgAndProvider unsupported HMAC alg: "+o;i===void 0&&(i=g.crypto.Util.DEFAULTPROVIDER[o]),this.algProv=o+"/"+i;var h=o.substr(4);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(h)!=-1&&i=="cryptojs"){try{var l=g.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[h];this.mac=J.algo.HMAC.create(l,this.pass)}catch(d){throw"setAlgAndProvider hash alg set fail hashAlg="+h+"/"+d}this.updateString=function(d){this.mac.update(d)},this.updateHex=function(d){var p=J.enc.Hex.parse(d);this.mac.update(p)},this.doFinal=function(){var d=this.mac.finalize();return d.toString(J.enc.Hex)},this.doFinalString=function(d){return this.updateString(d),this.doFinal()},this.doFinalHex=function(d){return this.updateHex(d),this.doFinal()}}},this.updateString=function(o){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(o){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(o){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(o){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(o){if(typeof o=="string"){var i=o;(o.length%2==1||!o.match(/^[0-9A-Fa-f]+$/))&&(i=pt(o)),this.pass=J.enc.Hex.parse(i);return}if(typeof o!="object")throw"KJUR.crypto.Mac unsupported password type: "+o;var i=null;if(o.hex!==void 0){if(o.hex.length%2!=0||!o.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+o.hex;i=o.hex}if(o.utf8!==void 0&&(i=Ii(o.utf8)),o.rstr!==void 0&&(i=pt(o.rstr)),o.b64!==void 0&&(i=Fr(o.b64)),o.b64u!==void 0&&(i=_e(o.b64u)),i==null)throw"KJUR.crypto.Mac unsupported password type: "+o;this.pass=J.enc.Hex.parse(i)},e!==void 0&&(e.pass!==void 0&&this.setPassword(e.pass),e.alg!==void 0&&(this.algName=e.alg,e.prov===void 0&&(this.provName=g.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))};g.crypto.Signature=function(e){var t=null,r=null,n=null,s=null,a=null,o=null,i=null,h=null,l=null,d=null,p=-1,u=null,c=null,x=null,f=null,v=null;if(this._setAlgNames=function(){var y=this.algName.match(/^(.+)with(.+)$/);y&&(this.mdAlgName=y[1].toLowerCase(),this.pubkeyAlgName=y[2].toLowerCase(),this.pubkeyAlgName=="rsaandmgf1"&&this.mdAlgName=="sha"&&(this.mdAlgName="sha1"))},this._zeroPaddingOfSignature=function(y,m){for(var b="",E=m/4-y.length,P=0;P<E;P++)b=b+"0";return b+y},this.setAlgAndProvider=function(y,m){if(this._setAlgNames(),m!="cryptojs/jsrsa")throw new Error("provider not supported: "+m);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)!=-1){try{this.md=new g.crypto.MessageDigest({alg:this.mdAlgName})}catch(b){throw new Error("setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+b)}this.init=function(b,E){var P=null;try{E===void 0?P=ue.getKey(b):P=ue.getKey(b,E)}catch(F){throw"init failed:"+F}if(P.isPrivate===!0)this.prvKey=P,this.state="SIGN";else if(P.isPublic===!0)this.pubKey=P,this.state="VERIFY";else throw"init failed.:"+P},this.updateString=function(b){this.md.updateString(b)},this.updateHex=function(b){this.md.updateHex(b)},this.sign=function(){if(this.sHashHex=this.md.digest(),this.prvKey===void 0&&this.ecprvhex!==void 0&&this.eccurvename!==void 0&&g.crypto.ECDSA!==void 0&&(this.prvKey=new g.crypto.ECDSA({curve:this.eccurvename,prv:this.ecprvhex})),this.prvKey instanceof ee&&this.pubkeyAlgName==="rsaandmgf1")this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof ee&&this.pubkeyAlgName==="rsa")this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof g.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else if(this.prvKey instanceof g.crypto.DSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;return this.hSign},this.signString=function(b){return this.updateString(b),this.sign()},this.signHex=function(b){return this.updateHex(b),this.sign()},this.verify=function(b){if(this.sHashHex=this.md.digest(),this.pubKey===void 0&&this.ecpubhex!==void 0&&this.eccurvename!==void 0&&g.crypto.ECDSA!==void 0&&(this.pubKey=new g.crypto.ECDSA({curve:this.eccurvename,pub:this.ecpubhex})),this.pubKey instanceof ee&&this.pubkeyAlgName==="rsaandmgf1")return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,b,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof ee&&this.pubkeyAlgName==="rsa")return this.pubKey.verifyWithMessageHash(this.sHashHex,b);if(g.crypto.ECDSA!==void 0&&this.pubKey instanceof g.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,b);if(g.crypto.DSA!==void 0&&this.pubKey instanceof g.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,b);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(y,m){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(y){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(y){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(y){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(y){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(y){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=e,e!==void 0&&(e.alg!==void 0&&(this.algName=e.alg,e.prov===void 0?this.provName=g.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=e.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),e.psssaltlen!==void 0&&(this.pssSaltLen=e.psssaltlen),e.prvkeypem!==void 0)){if(e.prvkeypas!==void 0)throw"both prvkeypem and prvkeypas parameters not supported";try{var t=ue.getKey(e.prvkeypem);this.init(t)}catch(y){throw"fatal error to load pem private key: "+y}}};g.crypto.Cipher=function(e){};g.crypto.Cipher.encrypt=function(e,t,r,n){if(Se(n,"enclag")!=null&&(r=n.encalg),typeof r=="string"&&r.substr(-4)=="-CBC"){var s=t,a=e;Se(n,"key")!=null&&(s=n.key),Se(n,"enc")!=null&&(hEnc=n.enc);var o=J.enc.Hex.parse(s),i=J.enc.Hex.parse(a),h=J.enc.Hex.parse(n.iv),l;if(r=="des-EDE3-CBC")l=J.TripleDES.encrypt(i,o,{iv:h});else if(r=="aes128-CBC"||r=="aes256-CBC")l=J.AES.encrypt(i,o,{iv:h});else throw new Error("unsupported algorithm: "+r);return l+""}else if(t instanceof ee&&t.isPublic){var d=g.crypto.Cipher.getAlgByKeyAndName(t,r);if(d==="RSA")return t.encrypt(e);if(d==="RSAOAEP")return t.encryptOAEP(e,"sha1");var p=d.match(/^RSAOAEP(\d+)$/);if(p!==null)return t.encryptOAEP(e,"sha"+p[1]);throw"Cipher.encrypt: unsupported algorithm for RSAKey: "+r}else throw"Cipher.encrypt: unsupported key or algorithm"};g.crypto.Cipher.decrypt=function(e,t,r,n){if(Se(n,"enclag")!=null&&(r=n.encalg),typeof r=="string"&&r.substr(-4)=="-CBC"){var s=t,a=e;Se(n,"key")!=null&&(s=n.key),Se(n,"enc")!=null&&(a=n.enc);var o=J.enc.Hex.parse(s),i=J.enc.Hex.parse(a),h=J.enc.Hex.parse(n.iv),l;if(r=="des-EDE3-CBC")l=J.TripleDES.decrypt({ciphertext:i},o,{iv:h});else if(r=="aes128-CBC"||r=="aes256-CBC")l=J.AES.decrypt({ciphertext:i},o,{iv:h});else throw new Error("unsupported algorithm: "+r);return J.enc.Hex.stringify(l)}else if(t instanceof ee&&t.isPrivate){var d=g.crypto.Cipher.getAlgByKeyAndName(t,r);if(d==="RSA")return t.decrypt(e);if(d==="RSAOAEP")return t.decryptOAEP(e,"sha1");var p=d.match(/^RSAOAEP(\d+)$/);if(p!==null)return t.decryptOAEP(e,"sha"+p[1]);throw"Cipher.decrypt: unsupported algorithm for RSAKey: "+r}else throw"Cipher.decrypt: unsupported key or algorithm"};g.crypto.Cipher.getAlgByKeyAndName=function(e,t){if(e instanceof ee){if(":RSA:RSAOAEP:RSAOAEP224:RSAOAEP256:RSAOAEP384:RSAOAEP512:".indexOf(t)!=-1)return t;if(t==null)return"RSA";throw"getAlgByKeyAndName: not supported algorithm name for RSAKey: "+t}throw"getAlgByKeyAndName: not supported algorithm name: "+t};g.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040022":"secp384r1","2b81040023":"secp521r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}};(typeof g>"u"||!g)&&(g={});(typeof g.crypto>"u"||!g.crypto)&&(g.crypto={});g.crypto.ECDSA=function(e){var t="secp256r1",r=null,n=null,s=null,a=Error,o=M,i=pe,h=g.crypto.ECDSA,l=g.crypto.ECParameterDB,d=h.getName,p=W,u=p.getVbyListEx,c=p.isASN1HEX,x=new Jt,f=null;this.type="EC",this.isPrivate=!1,this.isPublic=!1;function v(y,m,b,E){for(var P=Math.max(m.bitLength(),E.bitLength()),F=y.add2D(b),D=y.curve.getInfinity(),S=P-1;S>=0;--S)D=D.twice2D(),D.z=o.ONE,m.testBit(S)?E.testBit(S)?D=D.add2D(F):D=D.add2D(y):E.testBit(S)&&(D=D.add2D(b));return D}this.getBigRandom=function(y){return new o(y.bitLength(),x).mod(y.subtract(o.ONE)).add(o.ONE)},this.setNamedCurve=function(y){this.ecparams=l.getByName(y),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=y},this.setPrivateKeyHex=function(y){this.isPrivate=!0,this.prvKeyHex=y},this.setPublicKeyHex=function(y){this.isPublic=!0,this.pubKeyHex=y},this.getPublicKeyXYHex=function(){var y=this.pubKeyHex;if(y.substr(0,2)!=="04")throw"this method supports uncompressed format(04) only";var m=this.ecparams.keycharlen;if(y.length!==2+m*2)throw"malformed public key hex length";var b={};return b.x=y.substr(2,m),b.y=y.substr(2+m),b},this.getShortNISTPCurveName=function(){var y=this.curveName;return y==="secp256r1"||y==="NIST P-256"||y==="P-256"||y==="prime256v1"?"P-256":y==="secp384r1"||y==="NIST P-384"||y==="P-384"?"P-384":y==="secp521r1"||y==="NIST P-521"||y==="P-521"?"P-521":null},this.generateKeyPairHex=function(){var y=this.ecparams.n,m=this.getBigRandom(y),b=this.ecparams.keycharlen,E=("0000000000"+m.toString(16)).slice(-b);this.setPrivateKeyHex(E);var P=this.generatePublicKeyHex();return{ecprvhex:E,ecpubhex:P}},this.generatePublicKeyHex=function(){var y=new o(this.prvKeyHex,16),m=this.ecparams.G.multiply(y),b=m.getX().toBigInteger(),E=m.getY().toBigInteger(),P=this.ecparams.keycharlen,F=("0000000000"+b.toString(16)).slice(-P),D=("0000000000"+E.toString(16)).slice(-P),S="04"+F+D;return this.setPublicKeyHex(S),S},this.signWithMessageHash=function(y){return this.signHex(y,this.prvKeyHex)},this.signHex=function(y,m){var b=new o(m,16),E=this.ecparams.n,P=new o(y.substring(0,this.ecparams.keycharlen),16);do var F=this.getBigRandom(E),D=this.ecparams.G,S=D.multiply(F),w=S.getX().toBigInteger().mod(E);while(w.compareTo(o.ZERO)<=0);var C=F.modInverse(E).multiply(P.add(b.multiply(w))).mod(E);return h.biRSSigToASN1Sig(w,C)},this.sign=function(y,m){var b=m,E=this.ecparams.n,P=o.fromByteArrayUnsigned(y);do var F=this.getBigRandom(E),D=this.ecparams.G,S=D.multiply(F),w=S.getX().toBigInteger().mod(E);while(w.compareTo(M.ZERO)<=0);var C=F.modInverse(E).multiply(P.add(b.multiply(w))).mod(E);return this.serializeSig(w,C)},this.verifyWithMessageHash=function(y,m){return this.verifyHex(y,m,this.pubKeyHex)},this.verifyHex=function(y,m,b){try{var E,P,F=h.parseSigHex(m);E=F.r,P=F.s;var D=i.decodeFromHex(this.ecparams.curve,b),S=new o(y.substring(0,this.ecparams.keycharlen),16);return this.verifyRaw(S,E,P,D)}catch{return!1}},this.verify=function(y,m,b){var E,P;if(Bitcoin.Util.isArray(m)){var F=this.parseSig(m);E=F.r,P=F.s}else if(typeof m=="object"&&m.r&&m.s)E=m.r,P=m.s;else throw"Invalid value for signature";var D;if(b instanceof pe)D=b;else if(Bitcoin.Util.isArray(b))D=i.decodeFrom(this.ecparams.curve,b);else throw"Invalid format for pubkey value, must be byte array or ECPointFp";var S=o.fromByteArrayUnsigned(y);return this.verifyRaw(S,E,P,D)},this.verifyRaw=function(y,m,b,E){var P=this.ecparams.n,F=this.ecparams.G;if(m.compareTo(o.ONE)<0||m.compareTo(P)>=0||b.compareTo(o.ONE)<0||b.compareTo(P)>=0)return!1;var D=b.modInverse(P),S=y.multiply(D).mod(P),w=m.multiply(D).mod(P),C=F.multiply(S).add(E.multiply(w)),A=C.getX().toBigInteger().mod(P);return A.equals(m)},this.serializeSig=function(y,m){var b=y.toByteArraySigned(),E=m.toByteArraySigned(),P=[];return P.push(2),P.push(b.length),P=P.concat(b),P.push(2),P.push(E.length),P=P.concat(E),P.unshift(P.length),P.unshift(48),P},this.parseSig=function(y){var m;if(y[0]!=48)throw new Error("Signature not a valid DERSequence");if(m=2,y[m]!=2)throw new Error("First element in signature must be a DERInteger");var b=y.slice(m+2,m+2+y[m+1]);if(m+=2+y[m+1],y[m]!=2)throw new Error("Second element in signature must be a DERInteger");var E=y.slice(m+2,m+2+y[m+1]);m+=2+y[m+1];var P=o.fromByteArrayUnsigned(b),F=o.fromByteArrayUnsigned(E);return{r:P,s:F}},this.parseSigCompact=function(y){if(y.length!==65)throw"Signature has the wrong length";var m=y[0]-27;if(m<0||m>7)throw"Invalid signature type";var b=this.ecparams.n,E=o.fromByteArrayUnsigned(y.slice(1,33)).mod(b),P=o.fromByteArrayUnsigned(y.slice(33,65)).mod(b);return{r:E,s:P,i:m}},this.readPKCS5PrvKeyHex=function(y){if(c(y)===!1)throw new Error("not ASN.1 hex string");var m,b,E;try{m=u(y,0,["[0]",0],"06"),b=u(y,0,[1],"04");try{E=u(y,0,["[1]",0],"03")}catch{}}catch{throw new Error("malformed PKCS#1/5 plain ECC private key")}if(this.curveName=d(m),this.curveName===void 0)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(E),this.setPrivateKeyHex(b),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(y){if(c(y)===!1)throw new a("not ASN.1 hex string");var m,b,E,P;try{m=u(y,0,[1,0],"06"),b=u(y,0,[1,1],"06"),E=u(y,0,[2,0,1],"04");try{P=u(y,0,[2,0,"[1]",0],"03")}catch{}}catch{throw new a("malformed PKCS#8 plain ECC private key")}if(this.curveName=d(b),this.curveName===void 0)throw new a("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(P),this.setPrivateKeyHex(E),this.isPublic=!1},this.readPKCS8PubKeyHex=function(y){if(c(y)===!1)throw new a("not ASN.1 hex string");var m,b,E;try{m=u(y,0,[0,0],"06"),b=u(y,0,[0,1],"06"),E=u(y,0,[1],"03")}catch{throw new a("malformed PKCS#8 ECC public key")}if(this.curveName=d(b),this.curveName===null)throw new a("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(E)},this.readCertPubKeyHex=function(y,m){if(c(y)===!1)throw new a("not ASN.1 hex string");var b,E;try{b=u(y,0,[0,5,0,1],"06"),E=u(y,0,[0,5,1],"03")}catch{throw new a("malformed X.509 certificate ECC public key")}if(this.curveName=d(b),this.curveName===null)throw new a("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(E)},e!==void 0&&e.curve!==void 0&&(this.curveName=e.curve),this.curveName===void 0&&(this.curveName=t),this.setNamedCurve(this.curveName),e!==void 0&&(e.prv!==void 0&&this.setPrivateKeyHex(e.prv),e.pub!==void 0&&this.setPublicKeyHex(e.pub))};g.crypto.ECDSA.parseSigHex=function(e){var t=g.crypto.ECDSA.parseSigHexInHexRS(e),r=new M(t.r,16),n=new M(t.s,16);return{r,s:n}};g.crypto.ECDSA.parseSigHexInHexRS=function(e){var t=W,r=t.getChildIdx,n=t.getV;if(t.checkStrictDER(e,0),e.substr(0,2)!="30")throw new Error("signature is not a ASN.1 sequence");var s=r(e,0);if(s.length!=2)throw new Error("signature shall have two elements");var a=s[0],o=s[1];if(e.substr(a,2)!="02")throw new Error("1st item not ASN.1 integer");if(e.substr(o,2)!="02")throw new Error("2nd item not ASN.1 integer");var i=n(e,a),h=n(e,o);return{r:i,s:h}};g.crypto.ECDSA.asn1SigToConcatSig=function(e){var t=g.crypto.ECDSA.parseSigHexInHexRS(e),r=t.r,n=t.s;if(r.length>=130&&r.length<=134){if(r.length%2!=0)throw Error("unknown ECDSA sig r length error");if(n.length%2!=0)throw Error("unknown ECDSA sig s length error");r.substr(0,2)=="00"&&(r=r.substr(2)),n.substr(0,2)=="00"&&(n=n.substr(2));var s=Math.max(r.length,n.length);return r=("000000"+r).slice(-s),n=("000000"+n).slice(-s),r+n}if(r.substr(0,2)=="00"&&r.length%32==2&&(r=r.substr(2)),n.substr(0,2)=="00"&&n.length%32==2&&(n=n.substr(2)),r.length%32==30&&(r="00"+r),n.length%32==30&&(n="00"+n),r.length%32!=0)throw Error("unknown ECDSA sig r length error");if(n.length%32!=0)throw Error("unknown ECDSA sig s length error");return r+n};g.crypto.ECDSA.concatSigToASN1Sig=function(e){if(e.length%4!=0)throw Error("unknown ECDSA concatinated r-s sig length error");var t=e.substr(0,e.length/2),r=e.substr(e.length/2);return g.crypto.ECDSA.hexRSSigToASN1Sig(t,r)};g.crypto.ECDSA.hexRSSigToASN1Sig=function(e,t){var r=new M(e,16),n=new M(t,16);return g.crypto.ECDSA.biRSSigToASN1Sig(r,n)};g.crypto.ECDSA.biRSSigToASN1Sig=function(e,t){var r=g.asn1,n=new r.DERInteger({bigint:e}),s=new r.DERInteger({bigint:t}),a=new r.DERSequence({array:[n,s]});return a.tohex()};g.crypto.ECDSA.getName=function(e){return e==="2b8104001f"?"secp192k1":e==="2a8648ce3d030107"?"secp256r1":e==="2b8104000a"?"secp256k1":e==="2b81040021"?"secp224r1":e==="2b81040022"?"secp384r1":e==="2b81040023"?"secp521r1":"|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(e)!==-1?"secp256r1":"|secp256k1|".indexOf(e)!==-1?"secp256k1":"|secp224r1|NIST P-224|P-224|".indexOf(e)!==-1?"secp224r1":"|secp384r1|NIST P-384|P-384|".indexOf(e)!==-1?"secp384r1":"|secp521r1|NIST P-521|P-521|".indexOf(e)!==-1?"secp521r1":null};(typeof g>"u"||!g)&&(g={});(typeof g.crypto>"u"||!g.crypto)&&(g.crypto={});g.crypto.ECParameterDB=new function(){var e={},t={};function r(n){return new M(n,16)}this.getByName=function(n){var s=n;if(typeof t[s]<"u"&&(s=t[n]),typeof e[s]<"u")return e[s];throw"unregistered EC curve name: "+s},this.regist=function(n,s,a,o,i,h,l,d,p,u,c,x){e[n]={};var f=r(a),v=r(o),y=r(i),m=r(h),b=r(l),E=new Kt(f,v,y),P=E.decodePointHex("04"+d+p);e[n].name=n,e[n].keylen=s,e[n].keycharlen=Math.ceil(s/8)*2,e[n].curve=E,e[n].G=P,e[n].n=m,e[n].h=b,e[n].oid=c,e[n].info=x;for(var F=0;F<u.length;F++)t[u[F]]=n}};g.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field");g.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field");g.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field");g.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]);g.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]);g.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]);g.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]);g.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]);g.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]);g.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","00C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]);(typeof g>"u"||!g)&&(g={});(typeof g.crypto>"u"||!g.crypto)&&(g.crypto={});g.crypto.DSA=function(){var e=W,t=e.getVbyList,r=e.getVbyListEx,n=e.isASN1HEX,s=M;this.p=null,this.q=null,this.g=null,this.y=null,this.x=null,this.type="DSA",this.isPrivate=!1,this.isPublic=!1,this.setPrivate=function(a,o,i,h,l){this.isPrivate=!0,this.p=a,this.q=o,this.g=i,this.y=h,this.x=l},this.setPrivateHex=function(a,o,i,h,l){var d,p,u,c,x;d=new M(a,16),p=new M(o,16),u=new M(i,16),typeof h=="string"&&h.length>1?c=new M(h,16):c=null,x=new M(l,16),this.setPrivate(d,p,u,c,x)},this.setPublic=function(a,o,i,h){this.isPublic=!0,this.p=a,this.q=o,this.g=i,this.y=h,this.x=null},this.setPublicHex=function(a,o,i,h){var l,d,p,u;l=new M(a,16),d=new M(o,16),p=new M(i,16),u=new M(h,16),this.setPublic(l,d,p,u)},this.signWithMessageHash=function(a){var o=this.p,i=this.q,h=this.g,l=this.y,d=this.x,p=g.crypto.Util.getRandomBigIntegerMinToMax(M.ONE.add(M.ONE),i.subtract(M.ONE)),u=a.substr(0,i.bitLength()/4),c=new M(u,16),x=h.modPow(p,o).mod(i),f=p.modInverse(i).multiply(c.add(d.multiply(x))).mod(i),v=g.asn1.ASN1Util.jsonToASN1HEX({seq:[{int:{bigint:x}},{int:{bigint:f}}]});return v},this.verifyWithMessageHash=function(a,o){var i=this.p,h=this.q,l=this.g,d=this.y,p=this.parseASN1Signature(o),u=p[0],c=p[1],x=a.substr(0,h.bitLength()/4),f=new M(x,16);if(M.ZERO.compareTo(u)>0||u.compareTo(h)>0||M.ZERO.compareTo(c)>=0||c.compareTo(h)>0)throw"invalid DSA signature";var v=c.modInverse(h),y=f.multiply(v).mod(h),m=u.multiply(v).mod(h),b=l.modPow(y,i).multiply(d.modPow(m,i)).mod(i).mod(h);return b.compareTo(u)==0},this.parseASN1Signature=function(a){try{var o=new s(r(a,0,[0],"02"),16),i=new s(r(a,0,[1],"02"),16);return[o,i]}catch{throw new Error("malformed ASN.1 DSA signature")}},this.readPKCS5PrvKeyHex=function(a){var o,i,h,l,d;if(n(a)===!1)throw new Error("not ASN.1 hex string");try{o=r(a,0,[1],"02"),i=r(a,0,[2],"02"),h=r(a,0,[3],"02"),l=r(a,0,[4],"02"),d=r(a,0,[5],"02")}catch{throw new Error("malformed PKCS#1/5 plain DSA private key")}this.setPrivateHex(o,i,h,l,d)},this.readPKCS8PrvKeyHex=function(a){var o,i,h,l;if(n(a)===!1)throw new Error("not ASN.1 hex string");try{o=r(a,0,[1,1,0],"02"),i=r(a,0,[1,1,1],"02"),h=r(a,0,[1,1,2],"02"),l=r(a,0,[2,0],"02")}catch{throw new Error("malformed PKCS#8 plain DSA private key")}this.setPrivateHex(o,i,h,null,l)},this.readPKCS8PubKeyHex=function(a){var o,i,h,l;if(n(a)===!1)throw new Error("not ASN.1 hex string");try{o=r(a,0,[0,1,0],"02"),i=r(a,0,[0,1,1],"02"),h=r(a,0,[0,1,2],"02"),l=r(a,0,[1,0],"02")}catch{throw new Error("malformed PKCS#8 DSA public key")}this.setPublicHex(o,i,h,l)},this.readCertPubKeyHex=function(a,o){var i,h,l,d;if(n(a)===!1)throw new Error("not ASN.1 hex string");try{i=r(a,0,[0,5,0,1,0],"02"),h=r(a,0,[0,5,0,1,1],"02"),l=r(a,0,[0,5,0,1,2],"02"),d=r(a,0,[0,5,1,0],"02")}catch{throw new Error("malformed X.509 certificate DSA public key")}this.setPublicHex(i,h,l,d)}};var ue=function(){var e=function(f,v,y){return n(J.AES,f,v,y)},t=function(f,v,y){return n(J.TripleDES,f,v,y)},r=function(f,v,y){return n(J.DES,f,v,y)},n=function(f,v,y,m){var b=J.enc.Hex.parse(v),E=J.enc.Hex.parse(y),P=J.enc.Hex.parse(m),F={};F.key=E,F.iv=P,F.ciphertext=b;var D=f.decrypt(F,E,{iv:P});return J.enc.Hex.stringify(D)},s=function(f,v,y){return i(J.AES,f,v,y)},a=function(f,v,y){return i(J.TripleDES,f,v,y)},o=function(f,v,y){return i(J.DES,f,v,y)},i=function(f,v,y,m){var b=J.enc.Hex.parse(v),E=J.enc.Hex.parse(y),P=J.enc.Hex.parse(m),F=f.encrypt(b,E,{iv:P}),D=J.enc.Hex.parse(F.toString()),S=J.enc.Base64.stringify(D);return S},h={"AES-256-CBC":{proc:e,eproc:s,keylen:32,ivlen:16},"AES-192-CBC":{proc:e,eproc:s,keylen:24,ivlen:16},"AES-128-CBC":{proc:e,eproc:s,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:t,eproc:a,keylen:24,ivlen:8},"DES-CBC":{proc:r,eproc:o,keylen:8,ivlen:8}},l=function(f){return h[f].proc},d=function(f){var v=J.lib.WordArray.random(f),y=J.enc.Hex.stringify(v);return y},p=function(f){var v={},y=f.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));y&&(v.cipher=y[1],v.ivsalt=y[2]);var m=f.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));m&&(v.type=m[1]);var b=-1,E=0;f.indexOf(`\r
\r
`)!=-1&&(b=f.indexOf(`\r
\r
`),E=2),f.indexOf(`

`)!=-1&&(b=f.indexOf(`

`),E=1);var P=f.indexOf("-----END");if(b!=-1&&P!=-1){var F=f.substring(b+E*2,P-E);F=F.replace(/\s+/g,""),v.data=F}return v},u=function(f,v,y){for(var m=y.substring(0,16),b=J.enc.Hex.parse(m),E=J.enc.Utf8.parse(v),P=h[f].keylen+h[f].ivlen,F="",D=null;;){var S=J.algo.MD5.create();if(D!=null&&S.update(D),S.update(E),S.update(b),D=S.finalize(),F=F+J.enc.Hex.stringify(D),F.length>=P*2)break}var w={};return w.keyhex=F.substr(0,h[f].keylen*2),w.ivhex=F.substr(h[f].keylen*2,h[f].ivlen*2),w},c=function(f,v,y,m){var b=J.enc.Base64.parse(f),E=J.enc.Hex.stringify(b),P=h[v].proc,F=P(E,y,m);return F},x=function(f,v,y,m){var b=h[v].eproc,E=b(f,y,m);return E};return{version:"1.0.0",parsePKCS5PEM:function(f){return p(f)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(f,v,y){return u(f,v,y)},decryptKeyB64:function(f,v,y,m){return c(f,v,y,m)},getDecryptedKeyHex:function(f,v){var y=p(f),m=y.type,b=y.cipher,E=y.ivsalt,P=y.data,F=u(b,v,E),D=F.keyhex,S=c(P,b,D,E);return S},getEncryptedPKCS5PEMFromPrvKeyHex:function(f,v,y,m,b){var C="";if((typeof m>"u"||m==null)&&(m="AES-256-CBC"),typeof h[m]>"u")throw new Error("KEYUTIL unsupported algorithm: "+m);if(typeof b>"u"||b==null){var E=h[m].ivlen,P=d(E);b=P.toUpperCase()}var F=u(m,y,b),D=F.keyhex,S=x(v,m,D,b),w=S.replace(/(.{64})/g,`$1\r
`),C="-----BEGIN "+f+` PRIVATE KEY-----\r
`;return C+=`Proc-Type: 4,ENCRYPTED\r
`,C+="DEK-Info: "+m+","+b+`\r
`,C+=`\r
`,C+=w,C+=`\r
-----END `+f+` PRIVATE KEY-----\r
`,C},getEncryptedPKCS8PEM:function(f,v,y){var m=this.getEncryptedPKCS8Hex(f,v,y);return Ze(m,"ENCRYPTED PRIVATE KEY")},getEncryptedPKCS8Hex:function(f,v,y){var m;y==null||y==null?m={}:m=JSON.parse(JSON.stringify(y)),m.plain=f,this.initPBES2Param(m),this.encryptPBES2Param(m,v);var b=this.generatePBES2ASN1Param(m);return g.asn1.ASN1Util.newObject(b).tohex()},initPBES2Param:function(f){if(Se(f,"encalg")==null&&(f.encalg="aes256-CBC"),Se(f,"iter")==null&&(f.iter=2048),Se(f,"prf")==null&&(f.prf="hmacWithSHA256"),Se(f,"salt")==null&&(f.salt=J.enc.Hex.stringify(J.lib.WordArray.random(8))),Se(f,"enciv")==null){var v;f.encalg=="des-EDE3-CBC"&&(v=8),f.encalg=="aes128-CBC"&&(v=16),f.encalg=="aes256-CBC"&&(v=16),f.enciv=J.enc.Hex.stringify(J.lib.WordArray.random(v))}},encryptPBES2Param:function(f,v){var y=ue.getDKFromPBES2Param(f,v);try{var m=g.crypto.Cipher.encrypt(f.plain,y,f.encalg,{iv:f.enciv})}catch{throw new Error("encrypt error: "+f.plain+" "+y+" "+f.encalg+" "+f.enciv)}f.enc=m},generatePBES2ASN1Param:function(f){var v={seq:[{seq:[{oid:"pkcs5PBES2"},{seq:[{seq:[{oid:"pkcs5PBKDF2"},{seq:[{octstr:{hex:f.salt}},{int:{hex:mu(f.iter)}}]}]},{seq:[{oid:f.encalg},{octstr:{hex:f.enciv}}]}]}]},{octstr:{hex:f.enc}}]};return f.prf!="hmacWithSHA1"&&v.seq[0].seq[1].seq[0].seq[1].seq.push({seq:[{oid:f.prf},{null:""}]}),v},parseHexOfEncryptedPKCS8:function(f){var v=W,y=v.getChildIdx,m=v.getV,b={},E=y(f,0);if(E.length!=2)throw new Error("malformed format: SEQUENCE(0).items != 2: "+E.length);b.ciphertext=m(f,E[1]);var P=y(f,E[0]);if(P.length!=2)throw new Error("malformed format: SEQUENCE(0.0).items != 2: "+P.length);if(m(f,P[0])!="2a864886f70d01050d")throw new Error("this only supports pkcs5PBES2");var F=y(f,P[1]);if(P.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1).items != 2: "+F.length);var D=y(f,F[1]);if(D.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1.1).items != 2: "+D.length);if(m(f,D[0])!="2a864886f70d0307")throw"this only supports TripleDES";b.encryptionSchemeAlg="TripleDES",b.encryptionSchemeIV=m(f,D[1]);var S=y(f,F[0]);if(S.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1.0).items != 2: "+S.length);if(m(f,S[0])!="2a864886f70d01050c")throw new Error("this only supports pkcs5PBKDF2");var w=y(f,S[1]);if(w.length<2)throw new Error("malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+w.length);b.pbkdf2Salt=m(f,w[0]);var C=m(f,w[1]);try{b.pbkdf2Iter=parseInt(C,16)}catch{throw new Error("malformed format pbkdf2Iter: "+C)}return b},getPBKDF2KeyHexFromParam:function(f,v){var y=J.enc.Hex.parse(f.pbkdf2Salt),m=f.pbkdf2Iter,b=J.PBKDF2(v,y,{keySize:192/32,iterations:m}),E=J.enc.Hex.stringify(b);return E},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(f,v){var y=Ne(f,"ENCRYPTED PRIVATE KEY"),m=this.parseHexOfEncryptedPKCS8(y),b=ue.getPBKDF2KeyHexFromParam(m,v),E={};E.ciphertext=J.enc.Hex.parse(m.ciphertext);var P=J.enc.Hex.parse(b),F=J.enc.Hex.parse(m.encryptionSchemeIV),D=J.TripleDES.decrypt(E,P,{iv:F}),S=J.enc.Hex.stringify(D);return S},parsePBES2:function(f){var v=W.parse(f);if(Se(v,"seq.0.seq.0.oid")!="pkcs5PBES2"||Se(v,"seq.0.seq.1.seq.0.seq.0.oid")!="pkcs5PBKDF2")throw new Error("not pkcs5PBES2 and pkcs5PBKDF2 used");var y=Se(v,"seq.0.seq.1.seq.0.seq.1.seq");if(y==null)throw new Error("PBKDF2 parameter not found");var m=Se(y,"0.octstr.hex"),b=Se(y,"1.int.hex"),E=Se(y,"2.seq.0.oid","hmacWithSHA1"),P=-1;try{P=parseInt(b,16)}catch{throw new Error("iter not proper value")}var F=Se(v,"seq.0.seq.1.seq.1.seq.0.oid"),D=Se(v,"seq.0.seq.1.seq.1.seq.1.octstr.hex"),S=Se(v,"seq.1.octstr.hex");if(F==null||D==null||S==null)throw new Error("encalg, enciv or enc is undefined");var w={salt:m,iter:P,prf:E,encalg:F,enciv:D,enc:S};return w},getDKFromPBES2Param:function(f,v){var y={hmacWithSHA1:J.algo.SHA1,hmacWithSHA224:J.algo.SHA224,hmacWithSHA256:J.algo.SHA256,hmacWithSHA384:J.algo.SHA384,hmacWithSHA512:J.algo.SHA512},m={"des-EDE3-CBC":192/32,"aes128-CBC":128/32,"aes256-CBC":256/32},b=y[f.prf];if(b==null)throw new Error("unsupported prf");var E=m[f.encalg];if(E==null)throw new Error("unsupported encalg");var P=J.enc.Hex.parse(f.salt),F=f.iter;try{var D=J.PBKDF2(v,P,{keySize:E,iterations:F,hasher:b});return J.enc.Hex.stringify(D)}catch(S){throw new Error("PBKDF2 error: "+S+" "+JSON.stringify(f)+" "+v)}},getPlainHexFromEncryptedPKCS8PEM:function(f,v){if(f.indexOf("BEGIN ENCRYPTED PRIVATE KEY")==-1)throw new Error("not Encrypted PKCS#8 PEM string");var y=Ne(f),m;try{m=ue.parsePBES2(y)}catch(E){throw new Error("malformed PBES2 format: "+E.message)}var b=ue.getDKFromPBES2Param(m,v);return g.crypto.Cipher.decrypt(m.enc,b,m.encalg,{iv:m.enciv})},getKeyFromEncryptedPKCS8PEM:function(f,v){var y=this.getPlainHexFromEncryptedPKCS8PEM(f,v),m=this.getKeyFromPlainPrivatePKCS8Hex(y);return m},parsePlainPrivatePKCS8Hex:function(f){var v=W,y=v.getChildIdx,m=v.getV,b={};if(b.algparam=null,f.substr(0,2)!="30")throw new Error("malformed plain PKCS8 private key(code:001)");var E=y(f,0);if(E.length<3)throw new Error("malformed plain PKCS8 private key(code:002)");if(f.substr(E[1],2)!="30")throw new Error("malformed PKCS8 private key(code:003)");var P=y(f,E[1]);if(P.length!=2)throw new Error("malformed PKCS8 private key(code:004)");if(f.substr(P[0],2)!="06")throw new Error("malformed PKCS8 private key(code:005)");if(b.algoid=m(f,P[0]),f.substr(P[1],2)=="06"&&(b.algparam=m(f,P[1])),f.substr(E[2],2)!="04")throw new Error("malformed PKCS8 private key(code:006)");return b.keyidx=v.getVidx(f,E[2]),b},getKeyFromPlainPrivatePKCS8PEM:function(f){var v=Ne(f,"PRIVATE KEY"),y=this.getKeyFromPlainPrivatePKCS8Hex(v);return y},getKeyFromPlainPrivatePKCS8Hex:function(f){var v=this.parsePlainPrivatePKCS8Hex(f),y;if(v.algoid=="2a864886f70d010101")y=new ee;else if(v.algoid=="2a8648ce380401")y=new g.crypto.DSA;else if(v.algoid=="2a8648ce3d0201")y=new g.crypto.ECDSA;else throw new Error("unsupported private key algorithm");return y.readPKCS8PrvKeyHex(f),y},_getKeyFromPublicPKCS8Hex:function(f){var v,y=W.getVbyList(f,0,[0,0],"06");if(y==="2a864886f70d010101")v=new ee;else if(y==="2a8648ce380401")v=new g.crypto.DSA;else if(y==="2a8648ce3d0201")v=new g.crypto.ECDSA;else throw new Error("unsupported PKCS#8 public key hex");return v.readPKCS8PubKeyHex(f),v},parsePublicRawRSAKeyHex:function(f){var v=W,y=v.getChildIdx,m=v.getV,b={};if(f.substr(0,2)!="30")throw new Error("malformed RSA key(code:001)");var E=y(f,0);if(E.length!=2)throw new Error("malformed RSA key(code:002)");if(f.substr(E[0],2)!="02")throw new Error("malformed RSA key(code:003)");if(b.n=m(f,E[0]),f.substr(E[1],2)!="02")throw new Error("malformed RSA key(code:004)");return b.e=m(f,E[1]),b},parsePublicPKCS8Hex:function(f){var v=W,y=v.getChildIdx,m=v.getV,b={};b.algparam=null;var E=y(f,0);if(E.length!=2)throw new Error("outer DERSequence shall have 2 elements: "+E.length);var P=E[0];if(f.substr(P,2)!="30")throw new Error("malformed PKCS8 public key(code:001)");var F=y(f,P);if(F.length!=2)throw new Error("malformed PKCS8 public key(code:002)");if(f.substr(F[0],2)!="06")throw new Error("malformed PKCS8 public key(code:003)");if(b.algoid=m(f,F[0]),f.substr(F[1],2)=="06"?b.algparam=m(f,F[1]):f.substr(F[1],2)=="30"&&(b.algparam={},b.algparam.p=v.getVbyList(f,F[1],[0],"02"),b.algparam.q=v.getVbyList(f,F[1],[1],"02"),b.algparam.g=v.getVbyList(f,F[1],[2],"02")),f.substr(E[1],2)!="03")throw new Error("malformed PKCS8 public key(code:004)");return b.key=m(f,E[1]).substr(2),b}}}();ue.getKey=function(e,t,r){var n=W,s=n.getChildIdx,a=n.getV,o=n.getVbyList,i=g.crypto,h=i.ECDSA,l=i.DSA,d=ee,p=Ne,u=ue;if(typeof d<"u"&&e instanceof d||typeof h<"u"&&e instanceof h||typeof l<"u"&&e instanceof l)return e;if(e.curve!==void 0&&e.xy!==void 0&&e.d===void 0)return new h({pub:e.xy,curve:e.curve});if(e.curve!==void 0&&e.d!==void 0)return new h({prv:e.d,curve:e.curve});if(e.kty===void 0&&e.n!==void 0&&e.e!==void 0&&e.d===void 0){var c=new d;return c.setPublic(e.n,e.e),c}if(e.kty===void 0&&e.n!==void 0&&e.e!==void 0&&e.d!==void 0&&e.p!==void 0&&e.q!==void 0&&e.dp!==void 0&&e.dq!==void 0&&e.co!==void 0&&e.qi===void 0){var c=new d;return c.setPrivateEx(e.n,e.e,e.d,e.p,e.q,e.dp,e.dq,e.co),c}if(e.kty===void 0&&e.n!==void 0&&e.e!==void 0&&e.d!==void 0&&e.p===void 0){var c=new d;return c.setPrivate(e.n,e.e,e.d),c}if(e.p!==void 0&&e.q!==void 0&&e.g!==void 0&&e.y!==void 0&&e.x===void 0){var c=new l;return c.setPublic(e.p,e.q,e.g,e.y),c}if(e.p!==void 0&&e.q!==void 0&&e.g!==void 0&&e.y!==void 0&&e.x!==void 0){var c=new l;return c.setPrivate(e.p,e.q,e.g,e.y,e.x),c}if(e.kty==="RSA"&&e.n!==void 0&&e.e!==void 0&&e.d===void 0){var c=new d;return c.setPublic(_e(e.n),_e(e.e)),c}if(e.kty==="RSA"&&e.n!==void 0&&e.e!==void 0&&e.d!==void 0&&e.p!==void 0&&e.q!==void 0&&e.dp!==void 0&&e.dq!==void 0&&e.qi!==void 0){var c=new d;return c.setPrivateEx(_e(e.n),_e(e.e),_e(e.d),_e(e.p),_e(e.q),_e(e.dp),_e(e.dq),_e(e.qi)),c}if(e.kty==="RSA"&&e.n!==void 0&&e.e!==void 0&&e.d!==void 0){var c=new d;return c.setPrivate(_e(e.n),_e(e.e),_e(e.d)),c}if(e.kty==="EC"&&e.crv!==void 0&&e.x!==void 0&&e.y!==void 0&&e.d===void 0){var x=new h({curve:e.crv}),f=x.ecparams.keycharlen,v=("0000000000"+_e(e.x)).slice(-f),y=("0000000000"+_e(e.y)).slice(-f),m="04"+v+y;return x.setPublicKeyHex(m),x}if(e.kty==="EC"&&e.crv!==void 0&&e.x!==void 0&&e.y!==void 0&&e.d!==void 0){var x=new h({curve:e.crv}),f=x.ecparams.keycharlen,v=("0000000000"+_e(e.x)).slice(-f),y=("0000000000"+_e(e.y)).slice(-f),m="04"+v+y,b=("0000000000"+_e(e.d)).slice(-f);return x.setPublicKeyHex(m),x.setPrivateKeyHex(b),x}if(r==="pkcs5prv"){var E=e,n=W,P,c;if(P=s(E,0),P.length===9)c=new d,c.readPKCS5PrvKeyHex(E);else if(P.length===6)c=new l,c.readPKCS5PrvKeyHex(E);else if(P.length>2&&E.substr(P[1],2)==="04")c=new h,c.readPKCS5PrvKeyHex(E);else throw new Error("unsupported PKCS#1/5 hexadecimal key");return c}if(r==="pkcs8prv"){var c=u.getKeyFromPlainPrivatePKCS8Hex(e);return c}if(r==="pkcs8pub")return u._getKeyFromPublicPKCS8Hex(e);if(r==="x509pub")return te.getPublicKeyFromCertHex(e);if(e.indexOf("-END CERTIFICATE-",0)!=-1||e.indexOf("-END X509 CERTIFICATE-",0)!=-1||e.indexOf("-END TRUSTED CERTIFICATE-",0)!=-1)return te.getPublicKeyFromCertPEM(e);if(e.indexOf("-END PUBLIC KEY-")!=-1){var F=Ne(e,"PUBLIC KEY");return u._getKeyFromPublicPKCS8Hex(F)}if(e.indexOf("-END RSA PRIVATE KEY-")!=-1&&e.indexOf("4,ENCRYPTED")==-1){var D=p(e,"RSA PRIVATE KEY");return u.getKey(D,null,"pkcs5prv")}if(e.indexOf("-END DSA PRIVATE KEY-")!=-1&&e.indexOf("4,ENCRYPTED")==-1){var S=p(e,"DSA PRIVATE KEY"),w=o(S,0,[1],"02"),C=o(S,0,[2],"02"),A=o(S,0,[3],"02"),B=o(S,0,[4],"02"),R=o(S,0,[5],"02"),c=new l;return c.setPrivate(new M(w,16),new M(C,16),new M(A,16),new M(B,16),new M(R,16)),c}if(e.indexOf("-END EC PRIVATE KEY-")!=-1&&e.indexOf("4,ENCRYPTED")==-1){var D=p(e,"EC PRIVATE KEY");return u.getKey(D,null,"pkcs5prv")}if(e.indexOf("-END PRIVATE KEY-")!=-1)return u.getKeyFromPlainPrivatePKCS8PEM(e);if(e.indexOf("-END RSA PRIVATE KEY-")!=-1&&e.indexOf("4,ENCRYPTED")!=-1){var _=u.getDecryptedKeyHex(e,t),I=new ee;return I.readPKCS5PrvKeyHex(_),I}if(e.indexOf("-END EC PRIVATE KEY-")!=-1&&e.indexOf("4,ENCRYPTED")!=-1){var S=u.getDecryptedKeyHex(e,t),c=o(S,0,[1],"04"),N=o(S,0,[2,0],"06"),K=o(S,0,[3,0],"03").substr(2),L="";if(g.crypto.OID.oidhex2name[N]!==void 0)L=g.crypto.OID.oidhex2name[N];else throw new Error("undefined OID(hex) in KJUR.crypto.OID: "+N);var x=new h({curve:L});return x.setPublicKeyHex(K),x.setPrivateKeyHex(c),x.isPublic=!1,x}if(e.indexOf("-END DSA PRIVATE KEY-")!=-1&&e.indexOf("4,ENCRYPTED")!=-1){var S=u.getDecryptedKeyHex(e,t),w=o(S,0,[1],"02"),C=o(S,0,[2],"02"),A=o(S,0,[3],"02"),B=o(S,0,[4],"02"),R=o(S,0,[5],"02"),c=new l;return c.setPrivate(new M(w,16),new M(C,16),new M(A,16),new M(B,16),new M(R,16)),c}if(e.indexOf("-END ENCRYPTED PRIVATE KEY-")!=-1)return u.getKeyFromEncryptedPKCS8PEM(e,t);throw new Error("not supported argument")};ue.generateKeypair=function(e,t){if(e=="RSA"){var r=t,n=new ee;n.generate(r,"10001"),n.isPrivate=!0,n.isPublic=!0;var s=new ee,a=n.n.toString(16),o=n.e.toString(16);s.setPublic(a,o),s.isPrivate=!1,s.isPublic=!0;var i={};return i.prvKeyObj=n,i.pubKeyObj=s,i}else if(e=="EC"){var h=t,l=new g.crypto.ECDSA({curve:h}),d=l.generateKeyPairHex(),n=new g.crypto.ECDSA({curve:h});n.setPublicKeyHex(d.ecpubhex),n.setPrivateKeyHex(d.ecprvhex),n.isPrivate=!0,n.isPublic=!1;var s=new g.crypto.ECDSA({curve:h});s.setPublicKeyHex(d.ecpubhex),s.isPrivate=!1,s.isPublic=!0;var i={};return i.prvKeyObj=n,i.pubKeyObj=s,i}else throw new Error("unknown algorithm: "+e)};ue.getPEM=function(e,t,r,n,s,a){var o=g,i=o.asn1,h=i.DERObjectIdentifier,l=i.DERInteger,d=i.ASN1Util.newObject,p=i.x509,u=p.SubjectPublicKeyInfo,c=o.crypto,x=c.DSA,f=c.ECDSA,v=ee;function y(I){var N=d({seq:[{int:0},{int:{bigint:I.n}},{int:I.e},{int:{bigint:I.d}},{int:{bigint:I.p}},{int:{bigint:I.q}},{int:{bigint:I.dmp1}},{int:{bigint:I.dmq1}},{int:{bigint:I.coeff}}]});return N}function m(I){var N=d({seq:[{int:1},{octstr:{hex:I.prvKeyHex}},{tag:["a0",!0,{oid:{name:I.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+I.pubKeyHex}}]}]});return N}function b(I){var N=d({seq:[{int:0},{int:{bigint:I.p}},{int:{bigint:I.q}},{int:{bigint:I.g}},{int:{bigint:I.y}},{int:{bigint:I.x}}]});return N}if((v!==void 0&&e instanceof v||x!==void 0&&e instanceof x||f!==void 0&&e instanceof f)&&e.isPublic==!0&&(t===void 0||t=="PKCS8PUB")){var E=new u(e),P=E.tohex();return Ze(P,"PUBLIC KEY")}if(t=="PKCS1PRV"&&v!==void 0&&e instanceof v&&(r===void 0||r==null)&&e.isPrivate==!0){var E=y(e),P=E.tohex();return Ze(P,"RSA PRIVATE KEY")}if(t=="PKCS1PRV"&&f!==void 0&&e instanceof f&&(r===void 0||r==null)&&e.isPrivate==!0){var F=new h({name:e.curveName}),D=F.tohex(),S=m(e),w=S.tohex(),C="";return C+=Ze(D,"EC PARAMETERS"),C+=Ze(w,"EC PRIVATE KEY"),C}if(t=="PKCS1PRV"&&x!==void 0&&e instanceof x&&(r===void 0||r==null)&&e.isPrivate==!0){var E=b(e),P=E.tohex();return Ze(P,"DSA PRIVATE KEY")}if(t=="PKCS5PRV"&&v!==void 0&&e instanceof v&&r!==void 0&&r!=null&&e.isPrivate==!0){var E=y(e),P=E.tohex();return n===void 0&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",P,r,n,a)}if(t=="PKCS5PRV"&&f!==void 0&&e instanceof f&&r!==void 0&&r!=null&&e.isPrivate==!0){var E=m(e),P=E.tohex();return n===void 0&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",P,r,n,a)}if(t=="PKCS5PRV"&&x!==void 0&&e instanceof x&&r!==void 0&&r!=null&&e.isPrivate==!0){var E=b(e),P=E.tohex();return n===void 0&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",P,r,n,a)}var A=function(I,N){if(typeof N=="string")return ue.getEncryptedPKCS8PEM(I,N);if(typeof N=="object"&&Se(N,"passcode")!=null){var K=JSON.parse(JSON.stringify(N)),L=K.passcode;return delete K.passcode,ue.getEncryptedPKCS8PEM(I,L,K)}};if(t=="PKCS8PRV"&&v!=null&&e instanceof v&&e.isPrivate==!0){var B=y(e),R=B.tohex(),E=d({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:R}}]}),P=E.tohex();return r===void 0||r==null?Ze(P,"PRIVATE KEY"):A(P,r)}if(t=="PKCS8PRV"&&f!==void 0&&e instanceof f&&e.isPrivate==!0){var _={seq:[{int:1},{octstr:{hex:e.prvKeyHex}}]};typeof e.pubKeyHex=="string"&&_.seq.push({tag:["a1",!0,{bitstr:{hex:"00"+e.pubKeyHex}}]});var B=new d(_),R=B.tohex(),E=d({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:e.curveName}}]},{octstr:{hex:R}}]}),P=E.tohex();return r===void 0||r==null?Ze(P,"PRIVATE KEY"):A(P,r)}if(t=="PKCS8PRV"&&x!==void 0&&e instanceof x&&e.isPrivate==!0){var B=new l({bigint:e.x}),R=B.tohex(),E=d({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.g}}]}]},{octstr:{hex:R}}]}),P=E.tohex();return r===void 0||r==null?Ze(P,"PRIVATE KEY"):A(P,r)}throw new Error("unsupported object nor format")};ue.getKeyFromCSRPEM=function(e){var t=Ne(e,"CERTIFICATE REQUEST"),r=ue.getKeyFromCSRHex(t);return r};ue.getKeyFromCSRHex=function(e){var t=ue.parseCSRHex(e),r=ue.getKey(t.p8pubkeyhex,null,"pkcs8pub");return r};ue.parseCSRHex=function(e){var t=W,r=t.getChildIdx,n=t.getTLV,s={},a=e;if(a.substr(0,2)!="30")throw new Error("malformed CSR(code:001)");var o=r(a,0);if(o.length<1)throw new Error("malformed CSR(code:002)");if(a.substr(o[0],2)!="30")throw new Error("malformed CSR(code:003)");var i=r(a,o[0]);if(i.length<3)throw new Error("malformed CSR(code:004)");return s.p8pubkeyhex=n(a,i[2]),s};ue.getKeyID=function(e){var t=ue,r=W;typeof e=="string"&&e.indexOf("BEGIN ")!=-1&&(e=t.getKey(e));var n=Ne(t.getPEM(e)),s=r.getIdxbyList(n,0,[1]),a=r.getV(n,s).substring(2);return g.crypto.Util.hashHex(a,"sha1")};ue.getJWK=function(e,t,r,n,s){var a,o={},i,h=g.crypto.Util.hashHex;if(typeof e=="string")a=ue.getKey(e),e.indexOf("CERTIFICATE")!=-1&&(i=Ne(e));else if(typeof e=="object")e instanceof te?(a=e.getPublicKey(),i=e.hex):a=e;else throw new Error("unsupported keyinfo type");if(a instanceof ee&&a.isPrivate)o.kty="RSA",o.n=Me(a.n.toString(16)),o.e=Me(a.e.toString(16)),o.d=Me(a.d.toString(16)),o.p=Me(a.p.toString(16)),o.q=Me(a.q.toString(16)),o.dp=Me(a.dmp1.toString(16)),o.dq=Me(a.dmq1.toString(16)),o.qi=Me(a.coeff.toString(16));else if(a instanceof ee&&a.isPublic)o.kty="RSA",o.n=Me(a.n.toString(16)),o.e=Me(a.e.toString(16));else if(a instanceof g.crypto.ECDSA&&a.isPrivate){var l=a.getShortNISTPCurveName();if(l!=="P-256"&&l!=="P-384"&&l!=="P-521")throw new Error("unsupported curve name for JWT: "+l);var d=a.getPublicKeyXYHex();o.kty="EC",o.crv=l,o.x=Me(d.x),o.y=Me(d.y),o.d=Me(a.prvKeyHex)}else if(a instanceof g.crypto.ECDSA&&a.isPublic){var l=a.getShortNISTPCurveName();if(l!=="P-256"&&l!=="P-384"&&l!=="P-521")throw new Error("unsupported curve name for JWT: "+l);var d=a.getPublicKeyXYHex();o.kty="EC",o.crv=l,o.x=Me(d.x),o.y=Me(d.y)}if(o.kty==null)throw new Error("unsupported keyinfo");return!a.isPrivate&&t!=!0&&(o.kid=g.jws.JWS.getJWKthumbprint(o)),i!=null&&r!=!0&&(o.x5c=[qt(i)]),i!=null&&n!=!0&&(o.x5t=Ar(qt(h(i,"sha1")))),i!=null&&s!=!0&&(o["x5t#S256"]=Ar(qt(h(i,"sha256")))),o};ue.getJWKFromKey=function(e){return ue.getJWK(e,!0,!0,!0,!0)};ee.getPosArrayOfChildrenFromHex=function(e){return W.getChildIdx(e,0)};ee.getHexValueArrayOfChildrenFromHex=function(e){var t=W,r=t.getV,u=ee.getPosArrayOfChildrenFromHex(e),n=r(e,u[0]),s=r(e,u[1]),a=r(e,u[2]),o=r(e,u[3]),i=r(e,u[4]),h=r(e,u[5]),l=r(e,u[6]),d=r(e,u[7]),p=r(e,u[8]),u=new Array;return u.push(n,s,a,o,i,h,l,d,p),u};ee.prototype.readPrivateKeyFromPEMString=function(e){var t=Ne(e),r=ee.getHexValueArrayOfChildrenFromHex(t);this.setPrivateEx(r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8])};ee.prototype.readPKCS5PrvKeyHex=function(e){var t=ee.getHexValueArrayOfChildrenFromHex(e);this.setPrivateEx(t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])};ee.prototype.readPKCS8PrvKeyHex=function(e){var t,r,n,s,a,o,i,h,l=W,d=l.getVbyListEx;if(l.isASN1HEX(e)===!1)throw new Error("not ASN.1 hex string");try{t=d(e,0,[2,0,1],"02"),r=d(e,0,[2,0,2],"02"),n=d(e,0,[2,0,3],"02"),s=d(e,0,[2,0,4],"02"),a=d(e,0,[2,0,5],"02"),o=d(e,0,[2,0,6],"02"),i=d(e,0,[2,0,7],"02"),h=d(e,0,[2,0,8],"02")}catch{throw new Error("malformed PKCS#8 plain RSA private key")}this.setPrivateEx(t,r,n,s,a,o,i,h)};ee.prototype.readPKCS5PubKeyHex=function(e){var t=W,r=t.getV;if(t.isASN1HEX(e)===!1)throw new Error("keyHex is not ASN.1 hex string");var n=t.getChildIdx(e,0);if(n.length!==2||e.substr(n[0],2)!=="02"||e.substr(n[1],2)!=="02")throw new Error("wrong hex for PKCS#5 public key");var s=r(e,n[0]),a=r(e,n[1]);this.setPublic(s,a)};ee.prototype.readPKCS8PubKeyHex=function(e){var t=W;if(t.isASN1HEX(e)===!1)throw new Error("not ASN.1 hex string");if(t.getTLVbyListEx(e,0,[0,0])!=="06092a864886f70d010101")throw new Error("not PKCS8 RSA public key");var r=t.getTLVbyListEx(e,0,[1,0]);this.readPKCS5PubKeyHex(r)};ee.prototype.readCertPubKeyHex=function(e,t){var r,n;r=new te,r.readCertHex(e),n=r.getPublicKeyHex(),this.readPKCS8PubKeyHex(n)};var $g=new RegExp("[^0-9a-f]","gi");function Eu(e,t){for(var r="",n=t/4-e.length,s=0;s<n;s++)r=r+"0";return r+e}ee.prototype.sign=function(e,t){var r=function(s){return g.crypto.Util.hashString(s,t)},n=r(e);return this.signWithMessageHash(n,t)};ee.prototype.signWithMessageHash=function(e,t){var r=g.crypto.Util.getPaddedDigestInfoHex(e,t,this.n.bitLength()),n=Qe(r,16),s=this.doPrivate(n),a=s.toString(16);return Eu(a,this.n.bitLength())};function Pu(e,t,r){for(var n="",s=0;n.length<t;)n+=et(r(pt(e+String.fromCharCode.apply(String,[(s&4278190080)>>24,(s&16711680)>>16,(s&65280)>>8,s&255])))),s+=1;return n}ee.prototype.signPSS=function(e,t,r){var n=function(a){return g.crypto.Util.hashHex(a,t)},s=n(pt(e));return r===void 0&&(r=-1),this.signWithMessageHashPSS(s,t,r)};ee.prototype.signWithMessageHashPSS=function(e,t,r){var n=et(e),s=n.length,a=this.n.bitLength()-1,o=Math.ceil(a/8),i,h=function(v){return g.crypto.Util.hashHex(v,t)};if(r===-1||r===void 0)r=s;else if(r===-2)r=o-s-2;else if(r<-2)throw new Error("invalid salt length");if(o<s+r+2)throw new Error("data too long");var l="";r>0&&(l=new Array(r),new Jt().nextBytes(l),l=String.fromCharCode.apply(String,l));var d=et(h(pt("\0\0\0\0\0\0\0\0"+n+l))),p=[];for(i=0;i<o-r-s-2;i+=1)p[i]=0;var u=String.fromCharCode.apply(String,p)+""+l,c=Pu(d,u.length,h),x=[];for(i=0;i<u.length;i+=1)x[i]=u.charCodeAt(i)^c.charCodeAt(i);var f=65280>>8*o-a&255;for(x[0]&=~f,i=0;i<s;i++)x.push(d.charCodeAt(i));return x.push(188),Eu(this.doPrivate(new M(x)).toString(16),this.n.bitLength())};function Au(e){for(var t in g.crypto.Util.DIGESTINFOHEAD){var r=g.crypto.Util.DIGESTINFOHEAD[t],n=r.length;if(e.substring(0,n)==r){var s=[t,e.substring(n)];return s}}return[]}ee.prototype.verify=function(e,t){if(t=t.toLowerCase(),t.match(/^[0-9a-f]+$/)==null)return!1;var r=Qe(t,16),n=this.n.bitLength();if(r.bitLength()>n)return!1;var s=this.doPublic(r),a=s.toString(16);if(a.length+3!=n/4)return!1;var o=a.replace(/^1f+00/,""),i=Au(o);if(i.length==0)return!1;var h=i[0],l=i[1],d=function(u){return g.crypto.Util.hashString(u,h)},p=d(e);return l==p};ee.prototype.verifyWithMessageHash=function(e,t){if(t.length!=Math.ceil(this.n.bitLength()/4))return!1;var r=Qe(t,16);if(r.bitLength()>this.n.bitLength())return 0;var n=this.doPublic(r),s=n.toString(16).replace(/^1f+00/,""),a=Au(s);if(a.length==0)return!1;var o=a[0],i=a[1];return i==e};ee.prototype.verifyPSS=function(e,t,r,n){var s=function(o){return g.crypto.Util.hashHex(o,r)},a=s(pt(e));return n===void 0&&(n=-1),this.verifyWithMessageHashPSS(a,t,r,n)};ee.prototype.verifyWithMessageHashPSS=function(e,t,r,n){if(t.length!=Math.ceil(this.n.bitLength()/4))return!1;var s=new M(t,16),a=function(m){return g.crypto.Util.hashHex(m,r)},o=et(e),i=o.length,h=this.n.bitLength()-1,l=Math.ceil(h/8),d;if(n===-1||n===void 0)n=i;else if(n===-2)n=l-i-2;else if(n<-2)throw new Error("invalid salt length");if(l<i+n+2)throw new Error("data too long");var p=this.doPublic(s).toByteArray();for(d=0;d<p.length;d+=1)p[d]&=255;for(;p.length<l;)p.unshift(0);if(p[l-1]!==188)throw new Error("encoded message does not end in 0xbc");p=String.fromCharCode.apply(String,p);var u=p.substr(0,l-i-1),c=p.substr(u.length,i),x=65280>>8*l-h&255;if((u.charCodeAt(0)&x)!==0)throw new Error("bits beyond keysize not zero");var f=Pu(c,u.length,a),v=[];for(d=0;d<u.length;d+=1)v[d]=u.charCodeAt(d)^f.charCodeAt(d);v[0]&=~x;var y=l-i-n-2;for(d=0;d<y;d+=1)if(v[d]!==0)throw new Error("leftmost octets not zero");if(v[y]!==1)throw new Error("0x01 marker not found");return c===et(a(pt("\0\0\0\0\0\0\0\0"+o+String.fromCharCode.apply(String,v.slice(-n)))))};ee.SALT_LEN_HLEN=-1;ee.SALT_LEN_MAX=-2;ee.SALT_LEN_RECOVER=-2;function te(e){var t=W,r=t.getChildIdx,n=t.getV,s=t.dump,a=t.parse,o=t.getTLV,i=t.getVbyList,h=t.getVbyListEx,l=t.getTLVbyList,d=t.getTLVbyListEx,p=t.getIdxbyList,u=t.getIdxbyListEx,c=t.getVidx,x=t.getInt,f=t.oidname,v=t.hextooidstr,y=te,m=Ne,b,E=Error;try{b=g.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV}catch{}this.HEX2STAG={"0c":"utf8",13:"prn",16:"ia5","1a":"vis","1e":"bmp"},this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){if(this.hex===null||this.version!==0)return this.version;var S=l(this.hex,0,[0,0]);if(S.substr(0,2)=="a0"){var w=l(S,0,[0]),C=x(w,0);if(C<0||2<C)throw new Error("malformed version field");return this.version=C+1,this.version}else return this.version=1,this.foffset=-1,1},this.getSerialNumberHex=function(){return h(this.hex,0,[0,0],"02")},this.getSignatureAlgorithmField=function(){var S=d(this.hex,0,[0,1]);return this.getAlgorithmIdentifierName(S)},this.getAlgorithmIdentifierName=function(S){for(var w in b)if(S===b[w])return w;return f(h(S,0,[0],"06"))},this.getIssuer=function(S,w){return this.getX500Name(this.getIssuerHex(),S,w)},this.getIssuerHex=function(){return l(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){var S=this.getIssuer();return S.str},this.getSubject=function(S,w){return this.getX500Name(this.getSubjectHex(),S,w)},this.getSubjectHex=function(){return l(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){var S=this.getSubject();return S.str},this.getNotBefore=function(){var S=i(this.hex,0,[0,4+this.foffset,0]);return S=S.replace(/(..)/g,"%$1"),S=decodeURIComponent(S),S},this.getNotAfter=function(){var S=i(this.hex,0,[0,4+this.foffset,1]);return S=S.replace(/(..)/g,"%$1"),S=decodeURIComponent(S),S},this.getPublicKeyHex=function(){return this.getSPKI()},this.getSPKI=function(){return l(this.hex,0,[0,6+this.foffset],"30")},this.getSPKIValue=function(){var S=this.getSPKI();return S==null?null:i(S,0,[1],"03",!0)},this.getPublicKeyIdx=function(){return p(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var S=this.getPublicKeyIdx();return p(this.hex,S,[1,0],"30")},this.getPublicKey=function(){return ue.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){var S=l(this.hex,0,[1],"30");return this.getAlgorithmIdentifierName(S)},this.getSignatureValueHex=function(){return i(this.hex,0,[2],"03",!0)},this.verifySignature=function(S){var w=this.getSignatureAlgorithmField(),C=this.getSignatureValueHex(),A=l(this.hex,0,[0],"30"),B=new g.crypto.Signature({alg:w});return B.init(S),B.updateHex(A),B.verify(C)},this.parseExt=function(S){var w,C,A;if(S===void 0){if(A=this.hex,this.version!==3)return-1;w=p(A,0,[0,7,0],"30"),C=r(A,w)}else{A=Ne(S);var B=p(A,0,[0,3,0,0],"06");if(n(A,B)!="2a864886f70d01090e"){this.aExtInfo=new Array;return}w=p(A,0,[0,3,0,1,0],"30"),C=r(A,w),this.hex=A}this.aExtInfo=new Array;for(var R=0;R<C.length;R++){var _={};_.critical=!1;var I=r(A,C[R]),N=0;I.length===3&&(_.critical=!0,N=1),_.oid=t.hextooidstr(i(A,C[R],[0],"06"));var K=p(A,C[R],[1+N]);_.vidx=c(A,K),this.aExtInfo.push(_)}},this.getExtInfo=function(S){var w=this.aExtInfo,C=S;if(S.match(/^[0-9.]+$/)||(C=g.asn1.x509.OID.name2oid(S)),C!==""){for(var A=0;A<w.length;A++)if(w[A].oid===C)return w[A]}},this.getCriticalExtV=function(S,w,C){if(w!=null)return[w,C];var A=this.getExtInfo(S);return A==null?[null,null]:[o(this.hex,A.vidx),A.critical]},this.getExtBasicConstraints=function(S,w){if(S===void 0&&w===void 0){var C=this.getExtInfo("basicConstraints");if(C===void 0)return;S=o(this.hex,C.vidx),w=C.critical}var A={extname:"basicConstraints"};if(w&&(A.critical=!0),S==="3000")return A;if(S==="30030101ff")return A.cA=!0,A;if(S.substr(0,12)==="30060101ff02"){var B=n(S,10),R=parseInt(B,16);return A.cA=!0,A.pathLen=R,A}throw new Error("hExtV parse error: "+S)},this.getExtNameConstraints=function(S,w){var C=this.getCriticalExtV("nameConstraints",S,w);if(S=C[0],w=C[1],S!=null){var A={extname:"nameConstraints"};w&&(A.critical=!0);for(var B=r(S,0),R=0;R<B.length;R++){for(var _=[],I=r(S,B[R]),N=0;N<I.length;N++){var K=o(S,I[N]),L=this.getGeneralSubtree(K);_.push(L)}var H=S.substr(B[R],2);H=="a0"?A.permit=_:H=="a1"&&(A.exclude=_)}return A}},this.getGeneralSubtree=function(S){var w=r(S,0),C=w.length;if(C<1||2<C)throw new Error("wrong num elements");for(var A=this.getGeneralName(o(S,w[0])),B=1;B<C;B++){var R=S.substr(w[B],2),_=n(S,w[B]),I=parseInt(_,16);R=="80"&&(A.min=I),R=="81"&&(A.max=I)}return A},this.getExtKeyUsage=function(S,w){var C=this.getCriticalExtV("keyUsage",S,w);if(S=C[0],w=C[1],S!=null){var A={extname:"keyUsage"};return w&&(A.critical=!0),A.names=this.getExtKeyUsageString(S).split(","),A}},this.getExtKeyUsageBin=function(S){if(S===void 0){var w=this.getExtInfo("keyUsage");if(w===void 0)return"";S=o(this.hex,w.vidx)}if(S.length!=8&&S.length!=10)throw new Error("malformed key usage value: "+S);var C="000000000000000"+parseInt(S.substr(6),16).toString(2);return S.length==8&&(C=C.slice(-8)),S.length==10&&(C=C.slice(-16)),C=C.replace(/0+$/,""),C==""&&(C="0"),C},this.getExtKeyUsageString=function(S){for(var w=this.getExtKeyUsageBin(S),C=new Array,A=0;A<w.length;A++)w.substr(A,1)=="1"&&C.push(te.KEYUSAGE_NAME[A]);return C.join(",")},this.getExtSubjectKeyIdentifier=function(S,w){if(S===void 0&&w===void 0){var C=this.getExtInfo("subjectKeyIdentifier");if(C===void 0)return;S=o(this.hex,C.vidx),w=C.critical}var A={extname:"subjectKeyIdentifier"};w&&(A.critical=!0);var B=n(S,0);return A.kid={hex:B},A},this.getExtAuthorityKeyIdentifier=function(S,w){if(S===void 0&&w===void 0){var C=this.getExtInfo("authorityKeyIdentifier");if(C===void 0)return;S=o(this.hex,C.vidx),w=C.critical}var A={extname:"authorityKeyIdentifier"};w&&(A.critical=!0);for(var B=r(S,0),R=0;R<B.length;R++){var _=S.substr(B[R],2);if(_==="80"&&(A.kid={hex:n(S,B[R])}),_==="a1"){var I=o(S,B[R]),N=this.getGeneralNames(I);A.issuer=N[0].dn}_==="82"&&(A.sn={hex:n(S,B[R])})}return A},this.getExtExtKeyUsage=function(S,w){if(S===void 0&&w===void 0){var C=this.getExtInfo("extKeyUsage");if(C===void 0)return;S=o(this.hex,C.vidx),w=C.critical}var A={extname:"extKeyUsage",array:[]};w&&(A.critical=!0);for(var B=r(S,0),R=0;R<B.length;R++)A.array.push(f(n(S,B[R])));return A},this.getExtExtKeyUsageName=function(){var S=this.getExtInfo("extKeyUsage");if(S===void 0)return S;var w=new Array,C=o(this.hex,S.vidx);if(C==="")return w;for(var A=r(C,0),B=0;B<A.length;B++)w.push(f(n(C,A[B])));return w},this.getExtSubjectAltName=function(S,w){if(S===void 0&&w===void 0){var C=this.getExtInfo("subjectAltName");if(C===void 0)return;S=o(this.hex,C.vidx),w=C.critical}var A={extname:"subjectAltName",array:[]};return w&&(A.critical=!0),A.array=this.getGeneralNames(S),A},this.getExtIssuerAltName=function(S,w){if(S===void 0&&w===void 0){var C=this.getExtInfo("issuerAltName");if(C===void 0)return;S=o(this.hex,C.vidx),w=C.critical}var A={extname:"issuerAltName",array:[]};return w&&(A.critical=!0),A.array=this.getGeneralNames(S),A},this.getGeneralNames=function(S){for(var w=r(S,0),C=[],A=0;A<w.length;A++){var B=this.getGeneralName(o(S,w[A]));B!==void 0&&C.push(B)}return C},this.getGeneralName=function(S){var w=S.substr(0,2),C=n(S,0),A=et(C);if(w=="81")return{rfc822:A};if(w=="82")return{dns:A};if(w=="86")return{uri:A};if(w=="87")return{ip:Ai(C)};if(w=="a4")return{dn:this.getX500Name(C)};if(w=="a0")return{other:this.getOtherName(S)}},this.getExtSubjectAltName2=function(){var S,w,C,A=this.getExtInfo("subjectAltName");if(A===void 0)return A;for(var B=new Array,R=o(this.hex,A.vidx),_=r(R,0),I=0;I<_.length;I++)C=R.substr(_[I],2),S=n(R,_[I]),C==="81"&&(w=ge(S),B.push(["MAIL",w])),C==="82"&&(w=ge(S),B.push(["DNS",w])),C==="84"&&(w=te.hex2dn(S,0),B.push(["DN",w])),C==="86"&&(w=ge(S),B.push(["URI",w])),C==="87"&&(w=Ai(S),B.push(["IP",w]));return B},this.getExtCRLDistributionPoints=function(S,w){if(S===void 0&&w===void 0){var C=this.getExtInfo("cRLDistributionPoints");if(C===void 0)return;S=o(this.hex,C.vidx),w=C.critical}var A={extname:"cRLDistributionPoints",array:[]};w&&(A.critical=!0);for(var B=r(S,0),R=0;R<B.length;R++){var _=o(S,B[R]);A.array.push(this.getDistributionPoint(_))}return A},this.getDistributionPoint=function(S){for(var w={},C=r(S,0),A=0;A<C.length;A++){var B=S.substr(C[A],2),R=o(S,C[A]);B=="a0"&&(w.dpname=this.getDistributionPointName(R))}return w},this.getDistributionPointName=function(S){for(var w={},C=r(S,0),A=0;A<C.length;A++){var B=S.substr(C[A],2),R=o(S,C[A]);B=="a0"&&(w.full=this.getGeneralNames(R))}return w},this.getExtCRLDistributionPointsURI=function(){var S=this.getExtCRLDistributionPoints();if(S==null)return S;for(var w=S.array,C=[],A=0;A<w.length;A++)try{w[A].dpname.full[0].uri!=null&&C.push(w[A].dpname.full[0].uri)}catch{}return C},this.getExtAIAInfo=function(){var S=this.getExtInfo("authorityInfoAccess");if(S===void 0)return S;for(var w={ocsp:[],caissuer:[]},C=r(this.hex,S.vidx),A=0;A<C.length;A++){var B=i(this.hex,C[A],[0],"06"),R=i(this.hex,C[A],[1],"86");B==="2b06010505073001"&&w.ocsp.push(ge(R)),B==="2b06010505073002"&&w.caissuer.push(ge(R))}return w},this.getExtAuthorityInfoAccess=function(S,w){if(S===void 0&&w===void 0){var C=this.getExtInfo("authorityInfoAccess");if(C===void 0)return;S=o(this.hex,C.vidx),w=C.critical}var A={extname:"authorityInfoAccess",array:[]};w&&(A.critical=!0);for(var B=r(S,0),R=0;R<B.length;R++){var _=h(S,B[R],[0],"06"),I=i(S,B[R],[1],"86"),N=ge(I);if(_=="2b06010505073001")A.array.push({ocsp:N});else if(_=="2b06010505073002")A.array.push({caissuer:N});else throw new Error("unknown method: "+_)}return A},this.getExtCertificatePolicies=function(S,w){if(S===void 0&&w===void 0){var C=this.getExtInfo("certificatePolicies");if(C===void 0)return;S=o(this.hex,C.vidx),w=C.critical}var A={extname:"certificatePolicies",array:[]};w&&(A.critical=!0);for(var B=r(S,0),R=0;R<B.length;R++){var _=o(S,B[R]),I=this.getPolicyInformation(_);A.array.push(I)}return A},this.getPolicyInformation=function(S){var w={},C=i(S,0,[0],"06");w.policyoid=f(C);var A=u(S,0,[1],"30");if(A!=-1){w.array=[];for(var B=r(S,A),R=0;R<B.length;R++){var _=o(S,B[R]),I=this.getPolicyQualifierInfo(_);w.array.push(I)}}return w},this.getOtherName=function(S){var w={},C=r(S,0),A=i(S,C[0],[],"06"),B=i(S,C[1],[]);return w.oid=f(A),w.value=a(B),w},this.getPolicyQualifierInfo=function(S){var w={},C=i(S,0,[0],"06");if(C==="2b06010505070201"){var A=h(S,0,[1],"16");w.cps=et(A)}else if(C==="2b06010505070202"){var B=l(S,0,[1],"30");w.unotice=this.getUserNotice(B)}return w},this.getUserNotice=function(S){var w=null,C={};try{w=t.parse(S);var A=this._asn1ToUnotice(w);return A}catch{return}},this._asn1ToUnotice=function(S){try{for(var w={},C=Se(S,"seq"),A=0;A<C.length;A++){var B=this._asn1ToNoticeRef(C[A]);B!=null&&(w.noticeref=B);var R=this.asn1ToDisplayText(C[A]);R!=null&&(w.exptext=R)}return Object.keys(w).length>0?w:void 0}catch{return}},this._asn1ToNoticeRef=function(S){try{for(var w={},C=Se(S,"seq"),A=0;A<C.length;A++){var B=this._asn1ToNoticeNum(C[A]);B!=null&&(w.noticenum=B);var R=this.asn1ToDisplayText(C[A]);R!=null&&(w.org=R)}return Object.keys(w).length>0?w:void 0}catch{return}},this._asn1ToNoticeNum=function(S){try{for(var w=Se(S,"seq"),C=[],A=0;A<w.length;A++){var B=w[A];C.push(parseInt(Se(B,"int.hex"),16))}return C}catch{return}},this.getDisplayText=function(S){var w={"0c":"utf8",16:"ia5","1a":"vis","1e":"bmp"},C={};return C.type=w[S.substr(0,2)],C.str=et(n(S,0)),C},this.asn1ToDisplayText=function(S){if(S.utf8str!=null)return{type:"utf8",str:S.utf8str.str};if(S.ia5str!=null)return{type:"ia5",str:S.ia5str.str};if(S.visstr!=null)return{type:"vis",str:S.visstr.str};if(S.bmpstr!=null)return{type:"bmp",str:S.bmpstr.str};if(S.prnstr!=null)return{type:"prn",str:S.prnstr.str}},this.getExtPolicyMappings=function(S,w){var C=this.getCriticalExtV("policyMappings",S,w);if(S=C[0],w=C[1],S!=null){var A={extname:"policyMappings"};w&&(A.critical=!0);try{for(var B=a(S),R=B.seq,_=[],I=0;I<R.length;I++){var N=R[I].seq;_.push([N[0].oid,N[1].oid])}A.array=_}catch{throw new E("malformed policyMappings")}return A}},this.getExtPolicyConstraints=function(S,w){var C=this.getCriticalExtV("policyConstraints",S,w);if(S=C[0],w=C[1],S!=null){var A={extname:"policyConstraints"};w&&(A.critical=!0);var B=a(S);try{for(var R=B.seq,_=0;_<R.length;_++){var I=R[_].tag;I.explicit==!1&&(I.tag=="80"&&(A.reqexp=parseInt(I.hex,16)),I.tag=="81"&&(A.inhibit=parseInt(I.hex,16)))}}catch{return new E("malformed policyConstraints value")}return A}},this.getExtInhibitAnyPolicy=function(S,w){var C=this.getCriticalExtV("inhibitAnyPolicy",S,w);if(S=C[0],w=C[1],S!=null){var A={extname:"inhibitAnyPolicy"};w&&(A.critical=!0);var B=x(S,0);return B==-1?new E("wrong value"):(A.skip=B,A)}},this.getExtCRLNumber=function(S,w){var C={extname:"cRLNumber"};if(w&&(C.critical=!0),S.substr(0,2)=="02")return C.num={hex:n(S,0)},C;throw new E("hExtV parse error: "+S)},this.getExtCRLReason=function(S,w){var C={extname:"cRLReason"};if(w&&(C.critical=!0),S.substr(0,2)=="0a")return C.code=parseInt(n(S,0),16),C;throw new Error("hExtV parse error: "+S)},this.getExtOcspNonce=function(S,w){var C={extname:"ocspNonce"};w&&(C.critical=!0);var A=n(S,0);return C.hex=A,C},this.getExtOcspNoCheck=function(S,w){var C={extname:"ocspNoCheck"};return w&&(C.critical=!0),C},this.getExtAdobeTimeStamp=function(S,w){if(S===void 0&&w===void 0){var C=this.getExtInfo("adobeTimeStamp");if(C===void 0)return;S=o(this.hex,C.vidx),w=C.critical}var A={extname:"adobeTimeStamp"};w&&(A.critical=!0);var B=r(S,0);if(B.length>1){var R=o(S,B[1]),_=this.getGeneralName(R);_.uri!=null&&(A.uri=_.uri)}if(B.length>2){var I=o(S,B[2]);I=="0101ff"&&(A.reqauth=!0),I=="010100"&&(A.reqauth=!1)}return A},this.getExtSubjectDirectoryAttributes=function(S,w){if(S===void 0&&w===void 0){var C=this.getExtInfo("subjectDirectoryAttributes");if(C===void 0)return;S=o(this.hex,C.vidx),w=C.critical}var A={extname:"subjectDirectoryAttributes"};w&&(A.critical=!0);try{for(var B=a(S),R=[],_=0;_<B.seq.length;_++){var I=B.seq[_],N=Se(I,"seq.0.oid"),K=Se(I,"seq.1.set");if(N==null||K==null)throw"error";R.push({attr:N,array:K})}return A.array=R,A}catch{throw new Error("malformed subjectDirectoryAttributes extension value")}};var P=function(S){var w={};try{var C=S.seq[0].oid,A=g.asn1.x509.OID.name2oid(C);w.type=g.asn1.x509.OID.oid2atype(A);var B=S.seq[1];if(B.utf8str!=null)w.ds="utf8",w.value=B.utf8str.str;else if(B.numstr!=null)w.ds="num",w.value=B.numstr.str;else if(B.telstr!=null)w.ds="tel",w.value=B.telstr.str;else if(B.prnstr!=null)w.ds="prn",w.value=B.prnstr.str;else if(B.ia5str!=null)w.ds="ia5",w.value=B.ia5str.str;else if(B.visstr!=null)w.ds="vis",w.value=B.visstr.str;else if(B.bmpstr!=null)w.ds="bmp",w.value=B.bmpstr.str;else throw"error";return w}catch{throw new Erorr("improper ASN.1 parsed AttrTypeAndValue")}},F=function(S){try{return S.set.map(function(w){return P(w)})}catch(w){throw new Error("improper ASN.1 parsed RDN: "+w)}},D=function(S){try{return S.seq.map(function(w){return F(w)})}catch(w){throw new Error("improper ASN.1 parsed X500Name: "+w)}};this.getX500NameRule=function(S){for(var w=!0,C=!0,A=!1,B="",R="",_=null,I=[],N=0;N<S.length;N++)for(var K=S[N],L=0;L<K.length;L++)I.push(K[L]);for(var N=0;N<I.length;N++){var H=I[N],T=H.ds,k=H.value,q=H.type;if(B+=":"+T,T!="prn"&&T!="utf8"&&T!="ia5")return"mixed";if(T=="ia5"){if(q!="CN")return"mixed";if(g.lang.String.isMail(k))continue;return"mixed"}if(q=="C"){if(T=="prn")continue;return"mixed"}if(R+=":"+T,_==null)_=T;else if(_!==T)return"mixed"}return _??"prn"},this.getAttrTypeAndValue=function(S){var w=a(S);return P(w)},this.getRDN=function(S){var w=a(S);return F(w)},this.getX500NameArray=function(S){var w=a(S);return D(w)},this.getX500Name=function(S,w,C){var A=this.getX500NameArray(S),B=this.dnarraytostr(A),R={str:B};return R.array=A,C==!0&&(R.hex=S),w==!0&&(R.canon=this.c14nRDNArray(A)),R},this.readCertPEM=function(S){this.readCertHex(m(S))},this.readCertHex=function(S){this.hex=S,this.getVersion();try{p(this.hex,0,[0,7],"a3"),this.parseExt()}catch{}},this.getParam=function(S){var w={};return S==null&&(S={}),w.version=this.getVersion(),w.serial={hex:this.getSerialNumberHex()},w.sigalg=this.getSignatureAlgorithmField(),w.issuer=this.getIssuer(S.dncanon,S.dnhex),w.notbefore=this.getNotBefore(),w.notafter=this.getNotAfter(),w.subject=this.getSubject(S.dncanon,S.dnhex),w.sbjpubkey=Ze(this.getPublicKeyHex(),"PUBLIC KEY"),this.aExtInfo!=null&&this.aExtInfo.length>0&&(w.ext=this.getExtParamArray()),w.sighex=this.getSignatureValueHex(),S.tbshex==!0&&(w.tbshex=l(this.hex,0,[0])),S.nodnarray==!0&&(delete w.issuer.array,delete w.subject.array),w},this.getExtParamArray=function(S){if(S==null){var w=u(this.hex,0,[0,"[3]"]);w!=-1&&(S=d(this.hex,0,[0,"[3]",0],"30"))}for(var C=[],A=r(S,0),B=0;B<A.length;B++){var R=o(S,A[B]),_=this.getExtParam(R);_!=null&&C.push(_)}return C},this.getExtParam=function(S){var w={},C=r(S,0),A=C.length;if(A!=2&&A!=3)throw new Error("wrong number elements in Extension: "+A+" "+S);var B=v(i(S,0,[0],"06")),R=!1;A==3&&l(S,0,[1])=="0101ff"&&(R=!0);var _=l(S,0,[A-1,0]),I=void 0;if(B=="2.5.29.14"?I=this.getExtSubjectKeyIdentifier(_,R):B=="2.5.29.15"?I=this.getExtKeyUsage(_,R):B=="2.5.29.17"?I=this.getExtSubjectAltName(_,R):B=="2.5.29.18"?I=this.getExtIssuerAltName(_,R):B=="2.5.29.19"?I=this.getExtBasicConstraints(_,R):B=="2.5.29.30"?I=this.getExtNameConstraints(_,R):B=="2.5.29.31"?I=this.getExtCRLDistributionPoints(_,R):B=="2.5.29.32"?I=this.getExtCertificatePolicies(_,R):B=="2.5.29.33"?I=this.getExtPolicyMappings(_,R):B=="2.5.29.35"?I=this.getExtAuthorityKeyIdentifier(_,R):B=="2.5.29.36"?I=this.getExtPolicyConstraints(_,R):B=="2.5.29.37"?I=this.getExtExtKeyUsage(_,R):B=="2.5.29.54"?I=this.getExtInhibitAnyPolicy(_,R):B=="1.3.6.1.5.5.7.1.1"?I=this.getExtAuthorityInfoAccess(_,R):B=="2.5.29.20"?I=this.getExtCRLNumber(_,R):B=="2.5.29.21"?I=this.getExtCRLReason(_,R):B=="2.5.29.9"?I=this.getExtSubjectDirectoryAttributes(_,R):B=="1.3.6.1.5.5.7.48.1.2"?I=this.getExtOcspNonce(_,R):B=="1.3.6.1.5.5.7.48.1.5"?I=this.getExtOcspNoCheck(_,R):B=="1.2.840.113583.1.1.9.1"?I=this.getExtAdobeTimeStamp(_,R):te.EXT_PARSER[B]!=null&&(I=te.EXT_PARSER[B](B,R,_)),I!=null)return I;var N={extname:B,extn:_};try{N.extn=a(_)}catch{}return R&&(N.critical=!0),N},this.findExt=function(S,w){for(var C=0;C<S.length;C++)if(S[C].extname==w)return S[C];return null},this.updateExtCDPFullURI=function(S,w){var C=this.findExt(S,"cRLDistributionPoints");if(C!=null&&C.array!=null){for(var A=C.array,B=0;B<A.length;B++)if(A[B].dpname!=null&&A[B].dpname.full!=null)for(var R=A[B].dpname.full,_=0;_<R.length;_++){var I=R[B];I.uri!=null&&(I.uri=w)}}},this.updateExtAIAOCSP=function(S,w){var C=this.findExt(S,"authorityInfoAccess");if(C!=null&&C.array!=null)for(var A=C.array,B=0;B<A.length;B++)A[B].ocsp!=null&&(A[B].ocsp=w)},this.updateExtAIACAIssuer=function(S,w){var C=this.findExt(S,"authorityInfoAccess");if(C!=null&&C.array!=null)for(var A=C.array,B=0;B<A.length;B++)A[B].caissuer!=null&&(A[B].caissuer=w)},this.dnarraytostr=function(S){function w(A){return A.map(function(B){return C(B).replace(/\+/,"\\+")}).join("+")}function C(A){return A.type+"="+A.value}return"/"+S.map(function(A){return w(A).replace(/\//,"\\/")}).join("/")},this.setCanonicalizedDN=function(S){var w;if(S.str!=null&&S.array==null){var C=new g.asn1.x509.X500Name({str:S.str}),A=C.tohex();w=this.getX500NameArray(A)}else w=S.array;S.canon==null&&(S.canon=this.c14nRDNArray(w))},this.c14nRDNArray=function(S){for(var w=[],C=0;C<S.length;C++){for(var A=S[C],B=[],R=0;R<A.length;R++){var _=A[R],I=_.value;I=I.replace(/^\s*/,""),I=I.replace(/\s*$/,""),I=I.replace(/\s+/g," "),I=I.toLowerCase(),B.push(_.type.toLowerCase()+"="+I)}w.push(B.join("+"))}return"/"+w.join("/")},this.getInfo=function(){var S=function(He){for(var ie="",ne="    ",re=`
`,xe=He.array,be=0;be<xe.length;be++){var oe=xe[be];if(oe.dn!=null&&(ie+=ne+"dn: "+oe.dn.str+re),oe.ip!=null&&(ie+=ne+"ip: "+oe.ip+re),oe.rfc822!=null&&(ie+=ne+"rfc822: "+oe.rfc822+re),oe.dns!=null&&(ie+=ne+"dns: "+oe.dns+re),oe.uri!=null&&(ie+=ne+"uri: "+oe.uri+re),oe.other!=null){var Pe=oe.other.oid,ot=JSON.stringify(oe.other.value).replace(/\"/g,"");ie+=ne+"other: "+Pe+"="+ot+re}}return ie=ie.replace(/\n$/,""),ie},w=function(He){for(var ie="",ne=He.array,re=0;re<ne.length;re++){var xe=ne[re];if(ie+="    policy oid: "+xe.policyoid+`
`,xe.array!==void 0)for(var be=0;be<xe.array.length;be++){var oe=xe.array[be];oe.cps!==void 0&&(ie+="    cps: "+oe.cps+`
`)}}return ie},C=function(He){for(var ie="",ne=He.array,re=0;re<ne.length;re++){var xe=ne[re];try{xe.dpname.full[0].uri!==void 0&&(ie+="    "+xe.dpname.full[0].uri+`
`)}catch{}try{xe.dname.full[0].dn.hex!==void 0&&(ie+="    "+te.hex2dn(xe.dpname.full[0].dn.hex)+`
`)}catch{}}return ie},A=function(He){for(var ie="",ne=He.array,re=0;re<ne.length;re++){var xe=ne[re];xe.caissuer!==void 0&&(ie+="    caissuer: "+xe.caissuer+`
`),xe.ocsp!==void 0&&(ie+="    ocsp: "+xe.ocsp+`
`)}return ie},B=te,R,_,I;if(R=`Basic Fields
`,R+="  serial number: "+this.getSerialNumberHex()+`
`,R+="  signature algorithm: "+this.getSignatureAlgorithmField()+`
`,R+="  issuer: "+this.getIssuerString()+`
`,R+="  notBefore: "+this.getNotBefore()+`
`,R+="  notAfter: "+this.getNotAfter()+`
`,R+="  subject: "+this.getSubjectString()+`
`,R+=`  subject public key info: 
`,_=this.getPublicKey(),R+="    key algorithm: "+_.type+`
`,_.type==="RSA"&&(R+="    n="+Ds(_.n.toString(16)).substr(0,16)+`...
`,R+="    e="+Ds(_.e.toString(16))+`
`),I=this.aExtInfo,I!=null){R+=`X509v3 Extensions:
`;for(var N=0;N<I.length;N++){var K=I[N],L=g.asn1.x509.OID.oid2name(K.oid);L===""&&(L=K.oid);var H="";if(K.critical===!0&&(H="CRITICAL"),R+="  "+L+" "+H+`:
`,L==="basicConstraints"){var T=this.getExtBasicConstraints();T.cA===void 0?R+=`    {}
`:(R+="    cA=true",T.pathLen!==void 0&&(R+=", pathLen="+T.pathLen),R+=`
`)}else if(L=="policyMappings"){var k=this.getExtPolicyMappings().array,q=k.map(function(He){var ie=He;return ie[0]+":"+ie[1]}).join(", ");R+="    "+q+`
`}else if(L=="policyConstraints"){var $=this.getExtPolicyConstraints();R+="    ",$.reqexp!=null&&(R+=" reqexp="+$.reqexp),$.inhibit!=null&&(R+=" inhibit="+$.inhibit),R+=`
`}else if(L=="inhibitAnyPolicy"){var $=this.getExtInhibitAnyPolicy();R+="    skip="+$.skip+`
`}else if(L=="keyUsage")R+="    "+this.getExtKeyUsageString()+`
`;else if(L=="subjectKeyIdentifier")R+="    "+this.getExtSubjectKeyIdentifier().kid.hex+`
`;else if(L=="authorityKeyIdentifier"){var Y=this.getExtAuthorityKeyIdentifier();Y.kid!==void 0&&(R+="    kid="+Y.kid.hex+`
`)}else if(L=="extKeyUsage"){var se=this.getExtExtKeyUsage().array;R+="    "+se.join(", ")+`
`}else if(L=="subjectAltName"){var G=S(this.getExtSubjectAltName());R+=G+`
`}else if(L=="cRLDistributionPoints"){var me=this.getExtCRLDistributionPoints();R+=C(me)}else if(L=="authorityInfoAccess"){var ye=this.getExtAuthorityInfoAccess();R+=A(ye)}else L=="certificatePolicies"&&(R+=w(this.getExtCertificatePolicies()))}}return R+="signature algorithm: "+this.getSignatureAlgorithmName()+`
`,R+="signature: "+this.getSignatureValueHex().substr(0,16)+`...
`,R},typeof e=="string"&&(e.indexOf("-----BEGIN")!=-1?this.readCertPEM(e):g.lang.String.isHex(e)&&this.readCertHex(e))}te.EXT_PARSER={};te.registExtParser=function(e,t){te.EXT_PARSER[e]=t};te.hex2dn=function(e,t){t===void 0&&(t=0);var r=new te,n=W.getTLV(e,t),s=r.getX500Name(e);return s.str};te.hex2rdn=function(e,t){if(t===void 0&&(t=0),e.substr(t,2)!=="31")throw new Error("malformed RDN");for(var r=new Array,n=W.getChildIdx(e,t),s=0;s<n.length;s++)r.push(te.hex2attrTypeValue(e,n[s]));return r=r.map(function(a){return a.replace("+","\\+")}),r.join("+")};te.hex2attrTypeValue=function(e,t){var r=W,n=r.getV;if(t===void 0&&(t=0),e.substr(t,2)!=="30")throw new Error("malformed attribute type and value");var s=r.getChildIdx(e,t);s.length!==2||e.substr(s[0],2);var a=n(e,s[0]),o=g.asn1.ASN1Util.oidHexToInt(a),i=g.asn1.x509.OID.oid2atype(o),h=n(e,s[1]),l=et(h);return i+"="+l};te.getPublicKeyFromCertHex=function(e){var t=new te;return t.readCertHex(e),t.getPublicKey()};te.getPublicKeyFromCertPEM=function(e){var t=new te;return t.readCertPEM(e),t.getPublicKey()};te.getPublicKeyInfoPropOfCertPEM=function(e){var t=W,r=t.getVbyList,n={},s,a,o;return n.algparam=null,s=new te,s.readCertPEM(e),a=s.getPublicKeyHex(),n.keyhex=r(a,0,[1],"03").substr(2),n.algoid=r(a,0,[0,0],"06"),n.algoid==="2a8648ce3d0201"&&(n.algparam=r(a,0,[0,1],"06")),n};te.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"];var jv=function(e){var t=g,r=t.lang.String.isHex,n=W,s=n.getV,a=n.getTLV,o=n.getVbyList,i=n.getTLVbyList,h=n.getTLVbyListEx,l=n.getIdxbyList,d=n.getIdxbyListEx,p=n.getChildIdx,u=new te;this.hex=null,this.posSigAlg=null,this.posRevCert=null,this.parsed=null,this._setPos=function(){var c=l(this.hex,0,[0,0]),x=this.hex.substr(c,2);if(x=="02")this.posSigAlg=1;else if(x=="30")this.posSigAlg=0;else throw new Error("malformed 1st item of TBSCertList: "+x);var f=l(this.hex,0,[0,this.posSigAlg+3]),v=this.hex.substr(f,2);if(v=="17"||v=="18"){var y,m;y=l(this.hex,0,[0,this.posSigAlg+4]),this.posRevCert=null,y!=-1&&(m=this.hex.substr(y,2),m=="30"&&(this.posRevCert=this.posSigAlg+4))}else if(v=="30")this.posRevCert=this.posSigAlg+3;else if(v=="a0")this.posRevCert=null;else throw new Error("malformed nextUpdate or revCert tag: "+v)},this.getVersion=function(){return this.posSigAlg==0?null:parseInt(o(this.hex,0,[0,0],"02"),16)+1},this.getSignatureAlgorithmField=function(){var c=i(this.hex,0,[0,this.posSigAlg],"30");return u.getAlgorithmIdentifierName(c)},this.getIssuer=function(){return u.getX500Name(this.getIssuerHex())},this.getIssuerHex=function(){return i(this.hex,0,[0,this.posSigAlg+1],"30")},this.getThisUpdate=function(){var c=o(this.hex,0,[0,this.posSigAlg+2]);return result=et(c)},this.getNextUpdate=function(){var c=l(this.hex,0,[0,this.posSigAlg+3]),x=this.hex.substr(c,2);return x!="17"&&x!="18"?null:et(s(this.hex,c))},this.getRevCertArray=function(){if(this.posRevCert==null)return null;for(var c=[],x=l(this.hex,0,[0,this.posRevCert]),f=p(this.hex,x),v=0;v<f.length;v++){var y=a(this.hex,f[v]);c.push(this.getRevCert(y))}return c},this.getRevCert=function(c){var x={},f=p(c,0);return x.sn={hex:o(c,0,[0],"02")},x.date=et(o(c,0,[1])),f.length==3&&(x.ext=u.getExtParamArray(i(c,0,[2]))),x},this.findRevCert=function(c){var x=new te(c),f=x.getSerialNumberHex();return this.findRevCertBySN(f)},this.findRevCertBySN=function(c){if(this.parsed==null&&this.getParam(),this.parsed.revcert==null)return null;for(var x=this.parsed.revcert,f=0;f<x.length;f++)if(c==x[f].sn.hex)return x[f];return null},this.getSignatureValueHex=function(){return o(this.hex,0,[2],"03",!0)},this.verifySignature=function(c){var x=this.getSignatureAlgorithmField(),f=this.getSignatureValueHex(),v=i(this.hex,0,[0],"30"),y=new g.crypto.Signature({alg:x});return y.init(c),y.updateHex(v),y.verify(f)},this.getParam=function(c){var x={},f=this.getVersion();f!=null&&(x.version=f),x.sigalg=this.getSignatureAlgorithmField(),x.issuer=this.getIssuer(),x.thisupdate=this.getThisUpdate();var v=this.getNextUpdate();v!=null&&(x.nextupdate=v);var y=this.getRevCertArray();y!=null&&(x.revcert=y);var m=d(this.hex,0,[0,"[0]"]);if(m!=-1){var b=h(this.hex,0,[0,"[0]",0]);x.ext=u.getExtParamArray(b)}return x.sighex=this.getSignatureValueHex(),this.parsed=x,typeof c=="object"&&(c.tbshex==!0&&(x.tbshex=i(this.hex,0,[0])),c.nodnarray==!0&&delete x.issuer.array),x},typeof e=="string"&&(r(e)?this.hex=e:e.match(/-----BEGIN X509 CRL/)&&(this.hex=Ne(e)),this._setPos())};(typeof g>"u"||!g)&&(g={});(typeof g.jws>"u"||!g.jws)&&(g.jws={});g.jws.JWS=function(){var e=g,t=e.jws.JWS,r=t.isSafeJSONString;this.parseJWS=function(n,s){if(!(this.parsedJWS!==void 0&&(s||this.parsedJWS.sigvalH!==void 0))){var a=n.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(a==null)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var o=a[1],i=a[2],h=a[3],l=o+"."+i;if(this.parsedJWS={},this.parsedJWS.headB64U=o,this.parsedJWS.payloadB64U=i,this.parsedJWS.sigvalB64U=h,this.parsedJWS.si=l,!s){var d=_e(h),p=Qe(d,16);this.parsedJWS.sigvalH=d,this.parsedJWS.sigvalBI=p}var u=At(o),c=At(i);if(this.parsedJWS.headS=u,this.parsedJWS.payloadS=c,!r(u,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+u}}};g.jws.JWS.sign=function(e,t,r,n,s){var a=g,o=a.jws,i=o.JWS,h=i.readSafeJSONString,l=i.isSafeJSONString,d=a.crypto,p=d.ECDSA,u=d.Mac,c=d.Signature,x=JSON,f,v,y;if(typeof t!="string"&&typeof t!="object")throw"spHeader must be JSON string or object: "+t;if(typeof t=="object"&&(v=t,f=x.stringify(v)),typeof t=="string"){if(f=t,!l(f))throw"JWS Head is not safe JSON string: "+f;v=h(f)}if(y=r,typeof r=="object"&&(y=x.stringify(r)),(e==""||e==null)&&v.alg!==void 0&&(e=v.alg),e!=""&&e!=null&&v.alg===void 0&&(v.alg=e,f=x.stringify(v)),e!==v.alg)throw"alg and sHeader.alg doesn't match: "+e+"!="+v.alg;var m=null;if(i.jwsalg2sigalg[e]===void 0)throw"unsupported alg name: "+e;m=i.jwsalg2sigalg[e];var b=an(f),E=an(y),P=b+"."+E,F="";if(m.substr(0,4)=="Hmac"){if(n===void 0)throw"mac key shall be specified for HS* alg";var D=new u({alg:m,prov:"cryptojs",pass:n});D.updateString(P),F=D.doFinal()}else if(m.indexOf("withECDSA")!=-1){var S=new c({alg:m});S.init(n,s),S.updateString(P);var w=S.sign();F=g.crypto.ECDSA.asn1SigToConcatSig(w)}else if(m!="none"){var S=new c({alg:m});S.init(n,s),S.updateString(P),F=S.sign()}var C=Me(F);return P+"."+C};g.jws.JWS.verify=function(e,t,r){var n=g,s=n.jws,a=s.JWS,o=a.readSafeJSONString,i=n.crypto,h=i.ECDSA,l=i.Mac,d=i.Signature,p;if(typeof ee!==void 0&&(p=ee),!Ks(e))return!1;var u=e.split(".");if(u.length!==3)return!1;var c=u[0],x=u[1],f=c+"."+x,v=_e(u[2]),y=o(At(u[0])),m=null,b=null;if(y.alg===void 0)throw"algorithm not specified in header";if(m=y.alg,b=m.substr(0,2),r!=null&&Object.prototype.toString.call(r)==="[object Array]"&&r.length>0){var E=":"+r.join(":")+":";if(E.indexOf(":"+m+":")==-1)throw"algorithm '"+m+"' not accepted in the list"}if(m!="none"&&t===null)throw"key shall be specified to verify.";if(typeof t=="string"&&t.indexOf("-----BEGIN ")!=-1&&(t=ue.getKey(t)),(b=="RS"||b=="PS")&&!(t instanceof p))throw"key shall be a RSAKey obj for RS* and PS* algs";if(b=="ES"&&!(t instanceof h))throw"key shall be a ECDSA obj for ES* algs";m=="none";var P=null;if(a.jwsalg2sigalg[y.alg]===void 0)throw"unsupported alg name: "+m;if(P=a.jwsalg2sigalg[m],P=="none")throw"not supported";if(P.substr(0,4)=="Hmac"){var F=null;if(t===void 0)throw"hexadecimal key shall be specified for HMAC";var D=new l({alg:P,pass:t});return D.updateString(f),F=D.doFinal(),v==F}else if(P.indexOf("withECDSA")!=-1){var S=null;try{S=h.concatSigToASN1Sig(v)}catch{return!1}var w=new d({alg:P});return w.init(t),w.updateString(f),w.verify(S)}else{var w=new d({alg:P});return w.init(t),w.updateString(f),w.verify(v)}};g.jws.JWS.parse=function(e){var t=e.split("."),r={},n,s,a;if(t.length!=2&&t.length!=3)throw"malformed sJWS: wrong number of '.' splitted elements";return n=t[0],s=t[1],t.length==3&&(a=t[2]),r.headerObj=g.jws.JWS.readSafeJSONString(At(n)),r.payloadObj=g.jws.JWS.readSafeJSONString(At(s)),r.headerPP=JSON.stringify(r.headerObj,null,"  "),r.payloadObj==null?r.payloadPP=At(s):r.payloadPP=JSON.stringify(r.payloadObj,null,"  "),a!==void 0&&(r.sigHex=_e(a)),r};g.jws.JWS.verifyJWT=function(e,t,r){var n=g,s=n.jws,a=s.JWS,o=a.readSafeJSONString,i=a.inArray,h=a.includedArray;if(!Ks(e))return!1;var l=e.split(".");if(l.length!=3)return!1;var d=l[0],p=l[1],u=d+"."+p,c=_e(l[2]),x=o(At(d)),f=o(At(p));if(x.alg===void 0)return!1;if(r.alg===void 0)throw"acceptField.alg shall be specified";if(!i(x.alg,r.alg)||f.iss!==void 0&&typeof r.iss=="object"&&!i(f.iss,r.iss)||f.sub!==void 0&&typeof r.sub=="object"&&!i(f.sub,r.sub))return!1;if(f.aud!==void 0&&typeof r.aud=="object"){if(typeof f.aud=="string"){if(!i(f.aud,r.aud))return!1}else if(typeof f.aud=="object"&&!h(f.aud,r.aud))return!1}var v=s.IntDate.getNow();return r.verifyAt!==void 0&&typeof r.verifyAt=="number"&&(v=r.verifyAt),(r.gracePeriod===void 0||typeof r.gracePeriod!="number")&&(r.gracePeriod=0),!(f.exp!==void 0&&typeof f.exp=="number"&&f.exp+r.gracePeriod<v||f.nbf!==void 0&&typeof f.nbf=="number"&&v<f.nbf-r.gracePeriod||f.iat!==void 0&&typeof f.iat=="number"&&v<f.iat-r.gracePeriod||f.jti!==void 0&&r.jti!==void 0&&f.jti!==r.jti||!a.verify(e,t,r.alg))};g.jws.JWS.includedArray=function(e,t){var r=g.jws.JWS.inArray;if(e===null||typeof e!="object"||typeof e.length!="number")return!1;for(var n=0;n<e.length;n++)if(!r(e[n],t))return!1;return!0};g.jws.JWS.inArray=function(e,t){if(t===null||typeof t!="object"||typeof t.length!="number")return!1;for(var r=0;r<t.length;r++)if(t[r]==e)return!0;return!1};g.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",ES512:"SHA512withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"};g.jws.JWS.isSafeJSONString=function(e,t,r){var n=null;try{return n=hu(e),typeof n!="object"||n.constructor===Array?0:(t&&(t[r]=n),1)}catch{return 0}};g.jws.JWS.readSafeJSONString=function(e){var t=null;try{return t=hu(e),typeof t!="object"||t.constructor===Array?null:t}catch{return null}};g.jws.JWS.getEncodedSignatureValueFromJWS=function(e){var t=e.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(t==null)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return t[1]};g.jws.JWS.getJWKthumbprint=function(e){if(e.kty!=="RSA"&&e.kty!=="EC"&&e.kty!=="oct")throw"unsupported algorithm for JWK Thumprint";var t="{";if(e.kty==="RSA"){if(typeof e.n!="string"||typeof e.e!="string")throw"wrong n and e value for RSA key";t+='"e":"'+e.e+'",',t+='"kty":"'+e.kty+'",',t+='"n":"'+e.n+'"}'}else if(e.kty==="EC"){if(typeof e.crv!="string"||typeof e.x!="string"||typeof e.y!="string")throw"wrong crv, x and y value for EC key";t+='"crv":"'+e.crv+'",',t+='"kty":"'+e.kty+'",',t+='"x":"'+e.x+'",',t+='"y":"'+e.y+'"}'}else if(e.kty==="oct"){if(typeof e.k!="string")throw"wrong k value for oct(symmetric) key";t+='"kty":"'+e.kty+'",',t+='"k":"'+e.k+'"}'}var r=pt(t),n=g.crypto.Util.hashHex(r,"sha256"),s=Me(n);return s};g.jws.IntDate={};g.jws.IntDate.get=function(e){var t=g.jws.IntDate,r=t.getNow,n=t.getZulu;if(e=="now")return r();if(e=="now + 1hour")return r()+60*60;if(e=="now + 1day")return r()+60*60*24;if(e=="now + 1month")return r()+60*60*24*30;if(e=="now + 1year")return r()+60*60*24*365;if(e.match(/Z$/))return n(e);if(e.match(/^[0-9]+$/))return parseInt(e);throw"unsupported format: "+e};g.jws.IntDate.getZulu=function(e){return pu(e)};g.jws.IntDate.getNow=function(){var e=~~(new Date/1e3);return e};g.jws.IntDate.intDate2UTCString=function(e){var t=new Date(e*1e3);return t.toUTCString()};g.jws.IntDate.intDate2Zulu=function(e){var t=new Date(e*1e3),r=("0000"+t.getUTCFullYear()).slice(-4),n=("00"+(t.getUTCMonth()+1)).slice(-2),s=("00"+t.getUTCDate()).slice(-2),a=("00"+t.getUTCHours()).slice(-2),o=("00"+t.getUTCMinutes()).slice(-2),i=("00"+t.getUTCSeconds()).slice(-2);return r+n+s+a+o+i+"Z"};(typeof g>"u"||!g)&&(g={});(typeof g.jws>"u"||!g.jws)&&(g.jws={});g.jws.JWSJS=function(){var e=g,t=e.jws,r=t.JWS,n=r.readSafeJSONString;this.aHeader=[],this.sPayload="",this.aSignature=[],this.init=function(){this.aHeader=[],this.sPayload=void 0,this.aSignature=[]},this.initWithJWS=function(s){this.init();var a=s.split(".");if(a.length!=3)throw"malformed input JWS";this.aHeader.push(a[0]),this.sPayload=a[1],this.aSignature.push(a[2])},this.addSignature=function(s,a,o,i){if(this.sPayload===void 0||this.sPayload===null)throw"there's no JSON-JS signature to add.";var h=this.aHeader.length;if(this.aHeader.length!=this.aSignature.length)throw"aHeader.length != aSignature.length";try{var l=g.jws.JWS.sign(s,a,this.sPayload,o,i),d=l.split("."),p=d[0],u=d[2];this.aHeader.push(d[0]),this.aSignature.push(d[2])}catch(c){throw this.aHeader.length>h&&this.aHeader.pop(),this.aSignature.length>h&&this.aSignature.pop(),"addSignature failed: "+c}},this.verifyAll=function(s){if(this.aHeader.length!==s.length||this.aSignature.length!==s.length)return!1;for(var a=0;a<s.length;a++){var o=s[a];if(o.length!==2)return!1;var i=this.verifyNth(a,o[0],o[1]);if(i===!1)return!1}return!0},this.verifyNth=function(s,a,o){if(this.aHeader.length<=s||this.aSignature.length<=s)return!1;var i=this.aHeader[s],h=this.aSignature[s],l=i+"."+this.sPayload+"."+h,d=!1;try{d=r.verify(l,a,o)}catch{return!1}return d},this.readJWSJS=function(s){if(typeof s=="string"){var a=n(s);if(a==null)throw"argument is not safe JSON object string";this.aHeader=a.headers,this.sPayload=a.payload,this.aSignature=a.signatures}else try{if(s.headers.length>0)this.aHeader=s.headers;else throw"malformed header";if(typeof s.payload=="string")this.sPayload=s.payload;else throw"malformed signatures";if(s.signatures.length>0)this.aSignature=s.signatures;else throw"malformed signatures"}catch(o){throw"malformed JWS-JS JSON object: "+o}},this.getJSON=function(){return{headers:this.aHeader,payload:this.sPayload,signatures:this.aSignature}},this.isEmpty=function(){return this.aHeader.length==0?1:0}};X.SecureRandom=Jt;X.rng_seed_time=Hs;X.BigInteger=M;X.RSAKey=ee;X.ECDSA=g.crypto.ECDSA;X.DSA=g.crypto.DSA;X.Signature=g.crypto.Signature;X.MessageDigest=g.crypto.MessageDigest;X.Mac=g.crypto.Mac;X.Cipher=g.crypto.Cipher;X.KEYUTIL=ue;X.ASN1HEX=W;X.X509=te;X.X509CRL=jv;X.CryptoJS=J;X.b64tohex=Fr;X.b64toBA=au;X.ECFieldElementFp=Ve;X.ECPointFp=pe;X.ECCurveFp=Kt;X.stoBA=lu;X.BAtos=du;X.BAtohex=Di;X.stohex=st;X.stob64=gv;X.stob64u=yv;X.b64utos=mv;X.b64tob64u=Ar;X.b64utob64=un;X.hex2b64=qt;X.hextob64u=Me;X.b64utohex=_e;X.utf8tob64u=an;X.b64utoutf8=At;X.utf8tob64=Sv;X.b64toutf8=bv;X.utf8tohex=Ii;X.hextoutf8=ge;X.hextorstr=et;X.rstrtohex=pt;X.hextob64=Ts;X.hextob64nl=Pv;X.b64nltohex=vu;X.hextopem=Ze;X.pemtohex=Ne;X.hextoArrayBuffer=Cv;X.ArrayBuffertohex=_v;X.zulutomsec=Os;X.msectozulu=Bv;X.zulutosec=pu;X.zulutodate=Dv;X.datetozulu=Iv;X.uricmptohex=Ni;X.hextouricmp=Hi;X.ipv6tohex=_s;X.hextoipv6=Bs;X.hextoip=Ai;X.iptohex=js;X.ucs2hextoutf8=qs;X.encodeURIComponentAll=Ti;X.newline_toUnix=Rv;X.newline_toDos=Nv;X.hextoposhex=Ds;X.intarystrtohex=Hv;X.strdiffidx=Tv;X.oidtohex=yu;X.hextooid=Oi;X.strpad=Fi;X.bitstrtoint=Su;X.inttobitstr=bu;X.bitstrtobinstr=wu;X.binstrtobitstr=Ov;X.isBase64URLDot=Ks;X.namearraytobinstr=Ci;X.extendClass=U;X.foldnl=Ri;X.b64topem=Av;X.pemtob64=Fv;X.timeogen=xu;X.aryval=Se;X.inttohex=mu;X.twoscompl=fn;X.KJUR=g;X.crypto=g.crypto;X.asn1=g.asn1;X.jws=g.jws;X.lang=g.lang;X.VERSION=q1;X.VERSION_FULL=K1});var _u=z(ze=>{"use strict";O();j();var qv=ze&&ze.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Kv=ze&&ze.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),kv=ze&&ze.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&qv(t,e,r);return Kv(t,e),t};Object.defineProperty(ze,"__esModule",{value:!0});ze.GenRSAKeyPair=ze.decodeRsaPublicKey=ze.decodeRsaPrivateKey=ze.RSADecode=ze.RSAEncode=void 0;var kt=kv(ks()),It=Ft();function Mv(e,t){try{let r=Cu(t),n=kt.KJUR.crypto.Cipher.encrypt(e,r,"RSAOAEP256");return kt.hextob64(n)}catch(r){throw new It.MPCError(It.RSAEncodeError,r)}}ze.RSAEncode=Mv;function Vv(e,t){try{let r=Fu(t),n=kt.b64tohex(e);return kt.KJUR.crypto.Cipher.decrypt(n,r,"RSAOAEP256")}catch(r){throw new It.MPCError(It.RSADecodeError,r)}}ze.RSADecode=Vv;function Fu(e){try{let t=`-----BEGIN RSA PRIVATE KEY-----
`+e+"-----END RSA PRIVATE KEY-----";return kt.KEYUTIL.getKey(t,"PKCS1PRV")}catch(t){throw new It.MPCError(It.DecodeRSAPrivateKeyError,t)}}ze.decodeRsaPrivateKey=Fu;function Cu(e){try{let t=`-----BEGIN PUBLIC KEY-----
`+e+"-----END PUBLIC KEY-----";return kt.KEYUTIL.getKey(t)}catch(t){throw new It.MPCError(It.DecodeRsaPublicKeyError,t)}}ze.decodeRsaPublicKey=Cu;function Lv(){try{let e=kt.KEYUTIL.generateKeypair("RSA",1024),t=kt.KEYUTIL.getPEM(e.prvKeyObj,"PKCS1PRV"),r=kt.KEYUTIL.getPEM(e.pubKeyObj),n=t.split(`\r
`),s=r.split(`\r
`),a="",o="";for(let i=0;i<n.length;i++){let h=n[i];h==="-----BEGIN RSA PRIVATE KEY-----"||h==="-----END RSA PRIVATE KEY-----"||(a+=h)}for(let i=0;i<s.length;i++){let h=s[i];h==="-----BEGIN PUBLIC KEY-----"||h==="-----END PUBLIC KEY-----"||(o+=h)}return[a,o]}catch(e){throw new It.MPCError(It.GenRSAKeyPairError,e)}}ze.GenRSAKeyPair=Lv});var Du=z(xt=>{"use strict";O();j();var Uv=xt&&xt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),zv=xt&&xt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Wv=xt&&xt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Uv(t,e,r);return zv(t,e),t};Object.defineProperty(xt,"__esModule",{value:!0});xt.AESDecrypt=xt.AESEncrypt=void 0;var Mt=Wv(es()),Bu=wi(),ji=Ft();function Gv(e,t){try{let r=(0,Bu.md5)(t),n=Mt.enc.Utf8.parse(r);return Mt.AES.encrypt(e,n,{iv:n,mode:Mt.mode.CBC,padding:Mt.pad.Pkcs7}).toString()}catch(r){throw new ji.MPCError(ji.AESEncryptError,r)}}xt.AESEncrypt=Gv;function Xv(e,t){try{let r=(0,Bu.md5)(t),n=Mt.enc.Utf8.parse(r);return Mt.AES.decrypt(e,n,{iv:n,mode:Mt.mode.CBC,padding:Mt.pad.Pkcs7}).toString(Mt.enc.Utf8)}catch(r){throw new ji.MPCError(ji.AESDecryptError,r)}}xt.AESDecrypt=Xv});var Ru=z(ki=>{"use strict";O();j();Object.defineProperty(ki,"__esModule",{value:!0});ki.bip32Derive=void 0;var Iu=Ee(),Jv=hi(),Yv=ds(),qi=Pt(),Ki=Ft();async function $v(e,t,r,n,s){try{if(r.Curve===qi.CurveName.Secp256k1){let[a,o]=await Zv(e,t,r.toEcdsaPoint(),n,s);return Promise.resolve([a,qi.ECPoint.fromEcdsaPoint(o)])}else if(r.Curve===qi.CurveName.Ed25519){let[a,o]=await Qv(e,t,r.toEd25519Point(),n);return Promise.resolve([a,qi.ECPoint.fromEd25519Point(o)])}return Promise.reject(new Ki.MPCError(Ki.Bip32DeriveError,`bip32Derive un_supported curve type: [${r.Curve}]`))}catch(a){return Promise.reject(new Ki.MPCError(Ki.Bip32DeriveError,a))}}ki.bip32Derive=$v;async function Zv(e,t,r,n,s){let a=new Jv.TssKey(new Iu.BN(t.toString()),r,V.Buffer.from(n,"hex"));return a=await a.NewChildKey(e[0]),a=await a.NewChildKey(e[1]),a=await a.NewChildKey(e[2]),s!=null&&(a=await a.NewChildKey(s)),[BigInt(a.shareI.toString(10)),a.publicKey]}async function Qv(e,t,r,n){let s=new Yv.TssKey(new Iu.BN(t.toString()),r,V.Buffer.from(n,"hex"));return s=await s.NewChildKey(e[0]),s=await s.NewChildKey(e[1]),s=await s.NewChildKey(e[2]),[BigInt(s.shareI.toString(10)),s.publicKey]}});var Ms=z(ct=>{"use strict";O();j();var e2=ct&&ct.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),fr=ct&&ct.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&e2(t,e,r)};Object.defineProperty(ct,"__esModule",{value:!0});fr($o(),ct);fr(Zo(),ct);fr(eu(),ct);fr(_u(),ct);fr(Du(),ct);fr(Ru(),ct);fr(wi(),ct)});var Nu=z(Vi=>{"use strict";O();j();Object.defineProperty(Vi,"__esModule",{value:!0});Vi.PedersenParameters=void 0;var Mi=(vi(),$0(di)),cn=class{constructor(t,r,n){this.S=t,this.T=r,this.Ntilde=n}static async NewPedersenParameters(){let t=24080463838836201080652082632305534732002063580868256837038210994857729586600268211801279564303369693950429682190326566093932573855509453567393841648357081821880053752774170718047382946252536000678870735515855163646754581081435553356222873770351932852227834667536288582125296651398663163648979543718769199804146918220464587326136530135286945735587984838293187128267423286364628812794385921668573124571396250799658461906690728456458650228465312865048432010152190862532689545798727242877158647292465531176377500682726348426989332482863616802427143787375284653058516335361011466118712811309500705785525375482092098963097n,r=3969445706491109142504463761757113181243720789927116177071520922075525103482617922906331624855888956328960525194513254320803314863178743526851561817509828829014160418629634938441455784583112125465764928720574665390156185396679649272387565016698159745106440263736311759353449267253427424326566011948150894938620330116124058453568512487633908317746279061077639294887980762568955530152514368105906737713994609570534667642479638349602421006214098814038802561220441092513322886567020060969058638935878546693061106757943434742074861416747299644165447889875592530645696214475164899537461943948958136027895218376240993342673n,n=13469185658727475035931073279550075030057497136872025477242105309462997417546940639217444818113817898323930497326722071401088281046063589760494766301417922508037554444807983479412495341757134204363059411424555694916349689713120515929919936432986593339122531838276046180495264783565315603443986101974283074727281432196871144636171331980926684638343639398221779004000968880059122234209774426712142116396474765406158933809440842904102096045102577802122569204376459489609991759029760310331107566518614976666732556835318392772320945696543239652277734046054967196610265022261270041776733838263923439736476965782219187765549n;return new cn(r,n,t)}Commit(t,r){let n=(0,Mi.modPow)(this.S,t,this.Ntilde),s=(0,Mi.modPow)(this.T,r,this.Ntilde);return n*s%this.Ntilde}Open(t,r,n){let s=(0,Mi.modPow)(this.S,r,this.Ntilde),a=(0,Mi.modPow)(this.T,n,this.Ntilde);return s*a%this.Ntilde===t}};Vi.PedersenParameters=cn});var Hu=z(Ui=>{"use strict";O();j();Object.defineProperty(Ui,"__esModule",{value:!0});Ui.ecdsaSign=void 0;var Br=Pt(),Li=Ee(),t2=Nu(),hn=new Map;async function r2(e){let t={},r=new Map,n=await t2.PedersenParameters.NewPedersenParameters();for(let s of e.Messages){let a=(0,Br.GetMapKeyTssSign)(e.MpcId,s),o=e.EcdsaMessageMap.get(a);if(e.Step===Br.SignStep.Step1){let i=e.EcdsaShare,h=new Br.P2(new Li.BN(i.X2.toString()),new Li.BN(i.E_x1.toString()),i.PaiPubKey,i.PublicKey.toEcdsaPoint(),s,n),[l,d]=await Promise.all(h.step1(o.CmtC));r.set(a,{Proof:l,R2:Br.ECPoint.fromEcdsaPoint(d),E_x1:i.E_x1}),hn.set(a,h)}else if(e.Step===Br.SignStep.Step2){let i=hn.get(a),[h,l]=i.step2(o.Proof,o.Witness);r.set(a,{E_k2_h_rx:BigInt(h.toString()),AffGProof:l})}else if(e.Step==Br.SignStep.Step3){let i=hn.get(a),h=new Li.secp256k1.Signature(o.Signature.r,o.Signature.s);if(!Li.secp256k1.verify(h,s,i.publicKey))throw new Error("ecdsa sign verify fail");r.set(a,{Signature:o.Signature}),hn.delete(a)}else throw hn.delete(a),new Error(`un supported step: ${e.Step}`)}return t.EcdsaMessageMap=r,t}Ui.ecdsaSign=r2});var Ou=z(zi=>{"use strict";O();j();Object.defineProperty(zi,"__esModule",{value:!0});zi.ed25519Sign=void 0;var Yt=Pt(),Tu=Ee(),ln=new Map;async function n2(e){let t={},r=new Map;for(let n of e.Messages){let s=(0,Yt.GetMapKeyTssSign)(e.MpcId,n),a=e.Ed25519MessageMap.get(s);if(e.Step===Yt.SignStep.Step1){let o=e.Ed25519Share,i=o.PublicKey,h=new Yt.Ed25519Sign(e.DeviceNumber,o.Threshold,o.PartList,o.ShareI,i.toEd25519Point(),n),l=await h.signStep1();r.set(s,{OutputDataMap:l}),ln.set(s,h)}else if(e.Step===Yt.SignStep.Step2){let i=await ln.get(s).signStep2(a.TssInput);r.set(s,{OutputDataMap:i})}else if(e.Step===Yt.SignStep.Step3){let o=ln.get(s),[i,h]=await o.signStep3(a.TssInput),d=(a.Signature.s+i+Tu.ed25519.CURVE.n)%Tu.ed25519.CURVE.n,[p,u]=await(0,Yt.Ed25519Verify)(new Yt.Signature(h,d),n,Yt.ECPoint.fromEd25519Point(o.publicKey));if(!u)throw new Error("ed25519 sign verify fail");r.set(s,{Signature:p}),o={},ln.delete(s)}else throw ln.delete(s),new Error(`un supported step: ${e.Step}`)}return t.Ed25519MessageMap=r,t}zi.ed25519Sign=n2});var qu=z(Wi=>{"use strict";O();j();Object.defineProperty(Wi,"__esModule",{value:!0});Wi.Dispatch=void 0;var Vs=Ms(),ju=yr(),i2=Hu(),s2=Ou(),a2=[Vs.DeviceNumber.P2_No,Vs.DeviceNumber.P3_No];async function o2(e){if(!a2.includes(e.DeviceNumber))throw new Error(`wrong part number: ${e.DeviceNumber}`);if(e.FuncType!==Vs.FuncType.TssSign)throw new Error(`un supported operate: ${e.FuncType}`);switch(e.CurveName){case ju.CurveName.Secp256k1:return await(0,i2.ecdsaSign)(e);case ju.CurveName.Ed25519:return(0,s2.ed25519Sign)(e);default:throw new Error(`un supported curve: ${e.CurveName}`)}}Wi.Dispatch=o2});var ku=z($t=>{"use strict";O();j();var u2=$t&&$t.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Ku=$t&&$t.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&u2(t,e,r)};Object.defineProperty($t,"__esModule",{value:!0});Ku(qu(),$t);Ku(Ms(),$t)});var Uu=z((_4,Lu)=>{O();j();var Mu=ua(),Vu=Lu.exports;(function(){"use strict";function e(l){return l<10?"0"+l:l}var t=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,r=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,n,s,a={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},o;function i(l){return r.lastIndex=0,r.test(l)?'"'+l.replace(r,function(d){var p=a[d];return typeof p=="string"?p:"\\u"+("0000"+d.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+l+'"'}function h(l,d){var p,u,c,x,f=n,v,y=d[l],m=y!=null&&(y instanceof Mu||Mu.isBigNumber(y));switch(y&&typeof y=="object"&&typeof y.toJSON=="function"&&(y=y.toJSON(l)),typeof o=="function"&&(y=o.call(d,l,y)),typeof y){case"string":return m?y:i(y);case"number":return isFinite(y)?String(y):"null";case"boolean":case"null":case"bigint":return String(y);case"object":if(!y)return"null";if(n+=s,v=[],Object.prototype.toString.apply(y)==="[object Array]"){for(x=y.length,p=0;p<x;p+=1)v[p]=h(p,y)||"null";return c=v.length===0?"[]":n?`[
`+n+v.join(`,
`+n)+`
`+f+"]":"["+v.join(",")+"]",n=f,c}if(o&&typeof o=="object")for(x=o.length,p=0;p<x;p+=1)typeof o[p]=="string"&&(u=o[p],c=h(u,y),c&&v.push(i(u)+(n?": ":":")+c));else Object.keys(y).forEach(function(b){var E=h(b,y);E&&v.push(i(b)+(n?": ":":")+E)});return c=v.length===0?"{}":n?`{
`+n+v.join(`,
`+n)+`
`+f+"}":"{"+v.join(",")+"}",n=f,c}}typeof Vu.stringify!="function"&&(Vu.stringify=function(l,d,p){var u;if(n="",s="",typeof p=="number")for(u=0;u<p;u+=1)s+=" ";else typeof p=="string"&&(s=p);if(o=d,d&&typeof d!="function"&&(typeof d!="object"||typeof d.length!="number"))throw new Error("JSON.stringify");return h("",{"":l})})})()});var Wu=z((I4,zu)=>{O();j();var Gi=null,f2=/(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])/,c2=/(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)/,h2=function(e){"use strict";var t={strict:!1,storeAsString:!1,alwaysParseAsBig:!1,useNativeBigInt:!1,protoAction:"error",constructorAction:"error"};if(e!=null){if(e.strict===!0&&(t.strict=!0),e.storeAsString===!0&&(t.storeAsString=!0),t.alwaysParseAsBig=e.alwaysParseAsBig===!0?e.alwaysParseAsBig:!1,t.useNativeBigInt=e.useNativeBigInt===!0?e.useNativeBigInt:!1,typeof e.constructorAction<"u")if(e.constructorAction==="error"||e.constructorAction==="ignore"||e.constructorAction==="preserve")t.constructorAction=e.constructorAction;else throw new Error(`Incorrect value for constructorAction option, must be "error", "ignore" or undefined but passed ${e.constructorAction}`);if(typeof e.protoAction<"u")if(e.protoAction==="error"||e.protoAction==="ignore"||e.protoAction==="preserve")t.protoAction=e.protoAction;else throw new Error(`Incorrect value for protoAction option, must be "error", "ignore" or undefined but passed ${e.protoAction}`)}var r,n,s={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"},a,o=function(f){throw{name:"SyntaxError",message:f,at:r,text:a}},i=function(f){return f&&f!==n&&o("Expected '"+f+"' instead of '"+n+"'"),n=a.charAt(r),r+=1,n},h=function(){var f,v="";for(n==="-"&&(v="-",i("-"));n>="0"&&n<="9";)v+=n,i();if(n===".")for(v+=".";i()&&n>="0"&&n<="9";)v+=n;if(n==="e"||n==="E")for(v+=n,i(),(n==="-"||n==="+")&&(v+=n,i());n>="0"&&n<="9";)v+=n,i();if(f=+v,!isFinite(f))o("Bad number");else return Gi==null&&(Gi=ua()),v.length>15?t.storeAsString?v:t.useNativeBigInt?BigInt(v):new Gi(v):t.alwaysParseAsBig?t.useNativeBigInt?BigInt(f):new Gi(f):f},l=function(){var f,v,y="",m;if(n==='"')for(var b=r;i();){if(n==='"')return r-1>b&&(y+=a.substring(b,r-1)),i(),y;if(n==="\\"){if(r-1>b&&(y+=a.substring(b,r-1)),i(),n==="u"){for(m=0,v=0;v<4&&(f=parseInt(i(),16),!!isFinite(f));v+=1)m=m*16+f;y+=String.fromCharCode(m)}else if(typeof s[n]=="string")y+=s[n];else break;b=r}}o("Bad string")},d=function(){for(;n&&n<=" ";)i()},p=function(){switch(n){case"t":return i("t"),i("r"),i("u"),i("e"),!0;case"f":return i("f"),i("a"),i("l"),i("s"),i("e"),!1;case"n":return i("n"),i("u"),i("l"),i("l"),null}o("Unexpected '"+n+"'")},u,c=function(){var f=[];if(n==="["){if(i("["),d(),n==="]")return i("]"),f;for(;n;){if(f.push(u()),d(),n==="]")return i("]"),f;i(","),d()}}o("Bad array")},x=function(){var f,v=Object.create(null);if(n==="{"){if(i("{"),d(),n==="}")return i("}"),v;for(;n;){if(f=l(),d(),i(":"),t.strict===!0&&Object.hasOwnProperty.call(v,f)&&o('Duplicate key "'+f+'"'),f2.test(f)===!0?t.protoAction==="error"?o("Object contains forbidden prototype property"):t.protoAction==="ignore"?u():v[f]=u():c2.test(f)===!0?t.constructorAction==="error"?o("Object contains forbidden constructor property"):t.constructorAction==="ignore"?u():v[f]=u():v[f]=u(),d(),n==="}")return i("}"),v;i(","),d()}}o("Bad object")};return u=function(){switch(d(),n){case"{":return x();case"[":return c();case'"':return l();case"-":return h();default:return n>="0"&&n<="9"?h():p()}},function(f,v){var y;return a=f+"",r=0,n=" ",y=u(),d(),n&&o("Syntax error"),typeof v=="function"?function m(b,E){var P,F,D=b[E];return D&&typeof D=="object"&&Object.keys(D).forEach(function(S){F=m(D,S),F!==void 0?D[S]=F:delete D[S]}),v.call(b,E,D)}({"":y},""):y}};zu.exports=h2});var Ju=z((H4,Xi)=>{O();j();var Gu=Uu().stringify,Xu=Wu();Xi.exports=function(e){return{parse:Xu(e),stringify:Gu}};Xi.exports.parse=Xu();Xi.exports.stringify=Gu});var Pt=z(at=>{"use strict";O();j();var l2=at&&at.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Ji=at&&at.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&l2(t,e,r)};Object.defineProperty(at,"__esModule",{value:!0});at.JSONBigNative=at.JsonParseBigInt=void 0;Ji(Jo(),at);Ji(yr(),at);Ji(ku(),at);Ji(Ft(),at);function d2(e,t){return/\d{16,}/.test(e)&&(e=e.replace(/"(\\?[\s\S])*?"|([+\-\d.eE]{16,})/g,function(r,n,s){return s&&/^\d{16,}$/.test(s)?'"'+r+'"':r})),JSON.parse(e,t)}at.JsonParseBigInt=d2;var v2=Ju()({useNativeBigInt:!0});at.JSONBigNative=v2});var Ls=z(Dr=>{"use strict";O();j();Object.defineProperty(Dr,"__esModule",{value:!0});Dr.EcdsaPData=Dr.ShareData=void 0;var Yu=Ee(),Yi=Pt(),dn=class{constructor(t,r,n){this.shareI=t,this.publicKey=r,this.chaincode=n}static parseShareData(t){let r=(0,Yi.JsonParseBigInt)(t),n=BigInt(r.ShareI.toString()),s=r.ChainCode.toString(),a=new Yi.ECPoint(r.PublicKey.Curve,BigInt(r.PublicKey.X.toString()),BigInt(r.PublicKey.Y.toString()));return new dn(n,a,s)}};Dr.ShareData=dn;var vn=class{constructor(t,r,n){this.e_x1=t,this.paiPubKey=r,this.x2=n}static parseEcdsaPShare(t){let r=(0,Yi.JsonParseBigInt)(t),n=BigInt(r.E_x1.toString()),s=BigInt(r.X2),a=new Yu.BN(r.PaiPubKey.N.toString());return new vn(n,new Yi.PailPubKey(new Yu.BN(a.toString())),s)}};Dr.EcdsaPData=vn});var Us=z(Rt=>{"use strict";O();j();Object.defineProperty(Rt,"__esModule",{value:!0});Rt.saveContext=Rt.loadContext=Rt.saveAesKey=Rt.loadAesKey=void 0;var $u=new Map,Zu=new Map;function p2(e){let t=$u.get(e);if(t===void 0)throw new Error("aesKey miss, please shakeHand first");return t}Rt.loadAesKey=p2;function x2(e,t){$u.set(e,t)}Rt.saveAesKey=x2;function g2(e){let t=Zu.get(e);if(t===void 0)throw new Error("sign context miss, please setup first");return t}Rt.loadContext=g2;function y2(e,t){Zu.set(e,t)}Rt.saveContext=y2});var Gs=z(Ie=>{"use strict";O();j();Object.defineProperty(Ie,"__esModule",{value:!0});Ie.extractShare=Ie.ed25519Step3=Ie.ed25519Step2=Ie.ed25519Step1=Ie.ed25519SetUp=Ie.mpcEcdsaStep3=Ie.ecdsaStep3=Ie.ecdsaStep2=Ie.ecdsaStep1=Ie.ecdsaSetUp=Ie.shakeHands=void 0;var $i=lr(),zs=Ls(),Zi=gn(),pn=lr(),Z=Pt(),Qu=Ee(),We=Us(),m2=Bc(),S2="MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC93PS4MnSbE5pLbXFrgSjphDjG9tqnWfwxgWbaMUhvtMVvSgFhO7JVbrY2AtflD8p3bXpFMIiGOLEp6W73No77rMigEJzbfRKy/vD8YMcdvW8KaoU5b4I7kloC7ItWW+keFWvoBO7OeqlPaMEBb/gXNWlqPvT2Gz5gDfqGJz5HRQIDAQAB";function b2(e){try{let t=Qu.base.toHex(Qu.base.randomBytes(16));return(0,We.saveAesKey)(e,t),(0,Z.RSAEncode)(t,S2)}catch(t){throw new Z.MPCError(pn.MPCShakeHandsError,t)}}Ie.shakeHands=b2;async function w2(e,t,r,n,s,a,o){try{let i;o!=null&&o.length>0?i={hash:o,raw:""}:i=await(0,Zi.getMPCRawTransaction)(s,n);let h=e,l=s,d=a,[p,,u]=Ws(t,"",r),c=[];Array.isArray(i.hash)?i.hash.forEach(m=>c.push(m)):c.push(i.hash);let x={version:Z.MpcVersion.Version_v1,messages:c,path:a},f=Z.JSONBigNative.stringify(x),v=(0,We.loadAesKey)(e),y=(0,Z.AESEncrypt)(f,v);return(0,We.saveContext)(e,{messages:c,pShareData:u,path:d,shareData:p,currentMpcId:h,mpcRawData:i,currency:l}),Promise.resolve(y)}catch(i){return Promise.reject(new Z.MPCError(pn.EcdsaSetupError,i))}}Ie.ecdsaSetUp=w2;async function E2(e,t){let r=(0,We.loadContext)(e),n=(0,We.loadAesKey)(e),s=r.path,a=r.shareData,o=r.pShareData,i=r.currentMpcId,h=r.messages;try{let l=(0,Z.AESDecrypt)(t,n),d=new Map(Object.entries(Z.JSONBigNative.parse(l))),[p,u]=await(0,Z.bip32Derive)(s,o.x2,a.publicKey,a.chaincode),c=u,x={MpcId:i,DeviceNumber:Z.DeviceNumber.P2_No,CurveName:Z.CurveName.Secp256k1,FuncType:Z.FuncType.TssSign,Step:Z.SignStep.Step1,Messages:h,EcdsaShare:{PublicKey:u,X2:p,E_x1:o.e_x1,PaiPubKey:o.paiPubKey},EcdsaMessageMap:d},f=await(0,Z.Dispatch)(x),v=Z.JSONBigNative.stringify(Object.fromEntries(f.EcdsaMessageMap)),y=(0,Z.AESEncrypt)(v,n);return r.childPublicKey=c,r.p2Input=x,Promise.resolve(y)}catch(l){return Promise.reject(new Z.MPCError(pn.EcdsaStep1Error,l))}}Ie.ecdsaStep1=E2;async function P2(e,t){let r=(0,We.loadContext)(e),n=(0,We.loadAesKey)(e),s=r.p2Input;try{let a=(0,Z.AESDecrypt)(t,n),o=new Map(Object.entries(Z.JSONBigNative.parse(a)));s.Step=Z.SignStep.Step2,s.EcdsaMessageMap=o;let i=await(0,Z.Dispatch)(s),h=Z.JSONBigNative.stringify(Object.fromEntries(i.EcdsaMessageMap)),l=(0,Z.AESEncrypt)(h,n);return Promise.resolve(l)}catch(a){return Promise.reject(new Z.MPCError(pn.EcdsaStep2Error,a))}}Ie.ecdsaStep2=P2;async function A2(e,t){let r=(0,We.loadContext)(e),n=r.messages,s=r.currentMpcId,a=r.mpcRawData,o=r.childPublicKey,i=r.currency;try{let h=await ef(e,t),l=[],d=[];for(let x of n){let f=(0,Z.GetMapKeyTssSign)(s,x),v=h.EcdsaMessageMap.get(f).Signature;l.push("0x"+v.r.toString(16).padStart(64,"0")+v.s.toString(16).padStart(64,"0")),d.push(v.r.toString(16).padStart(64,"0")+v.s.toString(16).padStart(64,"0"))}let p=Array.isArray(a.hash)?l:l[0],u={raw:a.raw,sigs:p,publicKey:o.toHex()};if(a?.raw===""&&a?.hash!=null&&a?.hash.length>0){let x={signatures:d};return Promise.resolve(m2.json.stringify(x))}let c=await(0,Zi.getMPCTransaction)(i,u);return Promise.resolve(c.toString())}catch(h){return Promise.reject(new Z.MPCError(pn.EcdsaStep3Error,h))}}Ie.ecdsaStep3=A2;async function ef(e,t){let r=(0,We.loadContext)(e),n=(0,We.loadAesKey)(e),s=r.p2Input,a=(0,Z.AESDecrypt)(t,n),o=new Map(Object.entries(Z.JSONBigNative.parse(a)));s.Step=Z.SignStep.Step3,s.EcdsaMessageMap=o;let i=await(0,Z.Dispatch)(s);return Promise.resolve(i)}Ie.mpcEcdsaStep3=ef;async function F2(e,t,r,n,s){try{let a=await(0,Zi.getMPCRawTransaction)(n,r),o=e,i=n,h=s,[,l]=Ws("",t,""),d=[];Array.isArray(a.hash)?a.hash.forEach(f=>d.push(f)):d.push(a.hash);let p={version:Z.MpcVersion.Version_v1,messages:d,path:s,ed25519Share:{threshold:2,partList:[Z.DeviceNumber.P1_No,Z.DeviceNumber.P2_No]}},u=Z.JSONBigNative.stringify(p),c=(0,We.loadAesKey)(e),x=(0,Z.AESEncrypt)(u,c);return(0,We.saveContext)(e,{currency:i,currentMpcId:o,messages:d,mpcRawData:a,path:h,shareData:l}),Promise.resolve(x)}catch(a){return Promise.reject(new Z.MPCError($i.Ed25519SetupError,a))}}Ie.ed25519SetUp=F2;async function C2(e,t){let r=(0,We.loadContext)(e),n=(0,We.loadAesKey)(e),s=r.path,a=r.currentMpcId,o=r.messages,i=r.shareData;try{let h=(0,Z.AESDecrypt)(t,n),l=(0,Z.cvtObjToEd25519Map)((0,Z.JsonParseBigInt)(h)),[d,p]=await(0,Z.bip32Derive)(s,i.shareI,i.publicKey,i.chaincode),u=p,c={MpcId:a,DeviceNumber:Z.DeviceNumber.P2_No,CurveName:Z.CurveName.Ed25519,FuncType:Z.FuncType.TssSign,Step:Z.SignStep.Step1,Messages:o,Ed25519Share:{PublicKey:p,Threshold:2,PartList:[Z.DeviceNumber.P1_No,Z.DeviceNumber.P2_No],ShareI:d},Ed25519MessageMap:l},x=await(0,Z.Dispatch)(c),f=(0,Z.bigintStringify)((0,Z.cvtEd25519MapToObj)(x.Ed25519MessageMap)),v=(0,Z.AESEncrypt)(f,n);return r.childPublicKey=u,r.p2Input=c,r.ed25519P1Step1=l,Promise.resolve(v)}catch(h){return Promise.reject(new Z.MPCError($i.Ed25519Step1Error,h))}}Ie.ed25519Step1=C2;async function _2(e,t){let r=(0,We.loadContext)(e),n=(0,We.loadAesKey)(e),s=r.p2Input,a=r.ed25519P1Step1;try{let o=(0,Z.AESDecrypt)(t,n),i=(0,Z.cvtObjToEd25519Map)((0,Z.JsonParseBigInt)(o));s.Step=Z.SignStep.Step2,s.Ed25519MessageMap=a;let h=await(0,Z.Dispatch)(s),l=(0,Z.bigintStringify)((0,Z.cvtEd25519MapToObj)(h.Ed25519MessageMap)),d=(0,Z.AESEncrypt)(l,n);return r.ed25519P1Step2=i,Promise.resolve(d)}catch(o){return Promise.reject(new Z.MPCError($i.Ed25519Step2Error,o))}}Ie.ed25519Step2=_2;async function B2(e,t){let r=(0,We.loadContext)(e),n=(0,We.loadAesKey)(e),s=r.p2Input,a=r.messages,o=r.currentMpcId,i=r.mpcRawData,h=r.childPublicKey,l=r.ed25519P1Step2,d=r.currency;try{let p=(0,Z.AESDecrypt)(t,n),u=(0,Z.cvtObjToEd25519Map)((0,Z.JsonParseBigInt)(p));s.Step=Z.SignStep.Step3,s.Ed25519MessageMap=l;for(let[m,b]of u)s.Ed25519MessageMap.get(m).Signature=u.get(m).Signature;let c=await(0,Z.Dispatch)(s),x=[];for(let m of a){let b=(0,Z.GetMapKeyTssSign)(o,m),E=c.Ed25519MessageMap.get(b).Signature;x.push("0x"+E.r.toString(16).padStart(64,"0")+E.s.toString(16).padStart(64,"0"))}let f=Array.isArray(i.hash)?x:x[0],v={raw:i.raw,sigs:f,publicKey:h.toHex()},y=await(0,Zi.getMPCTransaction)(d,v);return Promise.resolve(y.toString())}catch(p){return Promise.reject(new Z.MPCError($i.Ed25519Step3Error,p))}}Ie.ed25519Step3=B2;function Ws(e,t,r){let n,s,a;return e!==""&&(n=zs.ShareData.parseShareData(e)),t!==""&&(s=zs.ShareData.parseShareData(t)),r!==""&&(a=zs.EcdsaPData.parseEcdsaPShare(r)),[n,s,a]}Ie.extractShare=Ws});var sf=z(Rr=>{"use strict";O();j();Object.defineProperty(Rr,"__esModule",{value:!0});Rr.signMsgStep3=Rr.signMsgSetup=void 0;var tf=lr(),rf=gn(),Xs=Us(),nf=Gs(),Ir=Pt(),D2=Ee();async function I2(e,t,r,n,s,a){try{let o=await(0,rf.getMPCRawMessage)(s,n),h=[D2.base.stripHexPrefix(o.hash)],[l,,d]=(0,nf.extractShare)(t,"",r),p={version:Ir.MpcVersion.Version_v1,messages:h,path:a},u=Ir.JSONBigNative.stringify(p),c=(0,Xs.loadAesKey)(e),x=(0,Ir.AESEncrypt)(u,c);return(0,Xs.saveContext)(e,{trxParam:n.data,messages:h,pShareData:d,path:a,shareData:l,currentMpcId:e,mpcRawData:o,currency:s}),Promise.resolve(x)}catch(o){return Promise.reject(new Ir.MPCError(tf.SignMsgSetupError,o))}}Rr.signMsgSetup=I2;async function R2(e,t){let r=(0,Xs.loadContext)(e),n=r.messages,s=r.trxParam,a=r.currentMpcId,o=r.mpcRawData,i=r.childPublicKey,h=r.currency;try{let l=await(0,nf.mpcEcdsaStep3)(e,t),d=[];for(let c of n){let x=(0,Ir.GetMapKeyTssSign)(a,c),f=l.EcdsaMessageMap.get(x).Signature;d.push("0x"+f.r.toString(16).padStart(64,"0")+f.s.toString(16).padStart(64,"0"))}let p={hash:o.hash,sigs:d[0],publicKey:i.toHex(),type:s.type,message:s.message},u=await(0,rf.getMPCSignedMessage)(h,p);return Promise.resolve(u.toString())}catch(l){return Promise.reject(new Ir.MPCError(tf.SignMsgStep3Error,l))}}Rr.signMsgStep3=R2});var af=z(gt=>{"use strict";O();j();Object.defineProperty(gt,"__esModule",{value:!0});gt.mpcSignMsg=gt.mpcSignEd25519=gt.mpcSignEcdsa=gt.mpcShakeHands=gt.getMPCAddress=void 0;var Js=Pt(),Ge=of(),Nt=lr();async function N2(e,t,r,n){if(!Nt.CoinCurveMap.has(r))return Promise.reject(Nt.UnsupportedCoinError);let s,a=Nt.CoinCurveMap.get(r);if(a===Js.CurveName.Secp256k1)[s,,]=(0,Ge.extractShare)(t,"","");else if(a===Js.CurveName.Ed25519)[,s]=(0,Ge.extractShare)("",t,"");else return Promise.reject(Nt.UnsupportedCoinError);let[o,i]=await(0,Js.bip32Derive)(e,0n,s.publicKey,s.chaincode),h={publicKey:i.toHex(),hrp:n},l=await(0,Ge.getAddressByPublicKey)(r,h);if(Nt.MultiAddressCoins.includes(r)){for(let d of l){let p={address:d.address,hrp:n};if(!await(0,Ge.validAddress)(r,p))return Promise.reject(Nt.ValidAddressError)}return{childPublicKey:i.toHex(),multiAddress:l}}else{let d={address:l,hrp:n};return await(0,Ge.validAddress)(r,d)?{childPublicKey:i.toHex(),address:l}:Promise.reject(Nt.ValidAddressError)}}gt.getMPCAddress=N2;function H2(e){return(0,Ge.shakeHands)(e)}gt.mpcShakeHands=H2;async function T2(e){switch(e.step){case 0:return await(0,Ge.ecdsaSetUp)(e.mpcId,e.share,e.pShare,e.txParams,e.currency,e.path,e.signHashList);case 1:return await(0,Ge.ecdsaStep1)(e.mpcId,e.serverData);case 2:return await(0,Ge.ecdsaStep2)(e.mpcId,e.serverData);case 3:return await(0,Ge.ecdsaStep3)(e.mpcId,e.serverData);default:return Promise.reject(Nt.MPCStepError)}}gt.mpcSignEcdsa=T2;async function O2(e){switch(e.step){case 0:return await(0,Ge.ed25519SetUp)(e.mpcId,e.share,e.txParams,e.currency,e.path);case 1:return await(0,Ge.ed25519Step1)(e.mpcId,e.serverData);case 2:return await(0,Ge.ed25519Step2)(e.mpcId,e.serverData);case 3:return await(0,Ge.ed25519Step3)(e.mpcId,e.serverData);default:return Promise.reject(Nt.MPCStepError)}}gt.mpcSignEd25519=O2;async function j2(e){switch(e.step){case 0:return await(0,Ge.signMsgSetup)(e.mpcId,e.share,e.pShare,e.txParams,e.currency,e.path);case 1:return await(0,Ge.ecdsaStep1)(e.mpcId,e.serverData);case 2:return await(0,Ge.ecdsaStep2)(e.mpcId,e.serverData);case 3:return await(0,Ge.signMsgStep3)(e.mpcId,e.serverData);default:return Promise.reject(Nt.MPCStepError)}}gt.mpcSignMsg=j2});var Ys=z(Ht=>{"use strict";O();j();Object.defineProperty(Ht,"__esModule",{value:!0});Ht.isHexPrefixed=Ht.stripHexPrefix=Ht.fromHex=Ht.toHex=void 0;function q2(e,t=!1){let r=V.Buffer.from(e);return t?"0x"+r.toString("hex"):r.toString("hex")}Ht.toHex=q2;function K2(e){return e.startsWith("0x")&&(e=e.substring(2)),V.Buffer.from(e,"hex")}Ht.fromHex=K2;function k2(e){return e.startsWith("0x")?e.substring(2):e}Ht.stripHexPrefix=k2;function M2(e){return e.startsWith("0x")}Ht.isHexPrefixed=M2});var $s=z(Nr=>{"use strict";O();j();Object.defineProperty(Nr,"__esModule",{value:!0});Nr.fromBase64=Nr.toBase64=void 0;var uf=_c();function V2(e){let t=V.Buffer.from(e);return uf.base64.encode(Uint8Array.from(t))}Nr.toBase64=V2;function L2(e){return uf.base64.decode(e)}Nr.fromBase64=L2});var de=z((Qi,ff)=>{O();j();(function(e,t){typeof Qi=="object"?ff.exports=Qi=t():typeof define=="function"&&define.amd?define([],t):e.CryptoJS=t()})(Qi,function(){var e=e||function(t,r){var n=Object.create||function(){function f(){}return function(v){var y;return f.prototype=v,y=new f,f.prototype=null,y}}(),s={},a=s.lib={},o=a.Base=function(){return{extend:function(f){var v=n(this);return f&&v.mixIn(f),(!v.hasOwnProperty("init")||this.init===v.init)&&(v.init=function(){v.$super.init.apply(this,arguments)}),v.init.prototype=v,v.$super=this,v},create:function(){var f=this.extend();return f.init.apply(f,arguments),f},init:function(){},mixIn:function(f){for(var v in f)f.hasOwnProperty(v)&&(this[v]=f[v]);f.hasOwnProperty("toString")&&(this.toString=f.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),i=a.WordArray=o.extend({init:function(f,v){f=this.words=f||[],v!=r?this.sigBytes=v:this.sigBytes=f.length*4},toString:function(f){return(f||l).stringify(this)},concat:function(f){var v=this.words,y=f.words,m=this.sigBytes,b=f.sigBytes;if(this.clamp(),m%4)for(var E=0;E<b;E++){var P=y[E>>>2]>>>24-E%4*8&255;v[m+E>>>2]|=P<<24-(m+E)%4*8}else for(var E=0;E<b;E+=4)v[m+E>>>2]=y[E>>>2];return this.sigBytes+=b,this},clamp:function(){var f=this.words,v=this.sigBytes;f[v>>>2]&=4294967295<<32-v%4*8,f.length=t.ceil(v/4)},clone:function(){var f=o.clone.call(this);return f.words=this.words.slice(0),f},random:function(f){for(var v=[],y=function(F){var F=F,D=987654321,S=4294967295;return function(){D=36969*(D&65535)+(D>>16)&S,F=18e3*(F&65535)+(F>>16)&S;var w=(D<<16)+F&S;return w/=4294967296,w+=.5,w*(t.random()>.5?1:-1)}},m=0,b;m<f;m+=4){var E=y((b||t.random())*4294967296);b=E()*987654071,v.push(E()*4294967296|0)}return new i.init(v,f)}}),h=s.enc={},l=h.Hex={stringify:function(f){for(var v=f.words,y=f.sigBytes,m=[],b=0;b<y;b++){var E=v[b>>>2]>>>24-b%4*8&255;m.push((E>>>4).toString(16)),m.push((E&15).toString(16))}return m.join("")},parse:function(f){for(var v=f.length,y=[],m=0;m<v;m+=2)y[m>>>3]|=parseInt(f.substr(m,2),16)<<24-m%8*4;return new i.init(y,v/2)}},d=h.Latin1={stringify:function(f){for(var v=f.words,y=f.sigBytes,m=[],b=0;b<y;b++){var E=v[b>>>2]>>>24-b%4*8&255;m.push(String.fromCharCode(E))}return m.join("")},parse:function(f){for(var v=f.length,y=[],m=0;m<v;m++)y[m>>>2]|=(f.charCodeAt(m)&255)<<24-m%4*8;return new i.init(y,v)}},p=h.Utf8={stringify:function(f){try{return decodeURIComponent(escape(d.stringify(f)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(f){return d.parse(unescape(encodeURIComponent(f)))}},u=a.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new i.init,this._nDataBytes=0},_append:function(f){typeof f=="string"&&(f=p.parse(f)),this._data.concat(f),this._nDataBytes+=f.sigBytes},_process:function(f){var v=this._data,y=v.words,m=v.sigBytes,b=this.blockSize,E=b*4,P=m/E;f?P=t.ceil(P):P=t.max((P|0)-this._minBufferSize,0);var F=P*b,D=t.min(F*4,m);if(F){for(var S=0;S<F;S+=b)this._doProcessBlock(y,S);var w=y.splice(0,F);v.sigBytes-=D}return new i.init(w,D)},clone:function(){var f=o.clone.call(this);return f._data=this._data.clone(),f},_minBufferSize:0}),c=a.Hasher=u.extend({cfg:o.extend(),init:function(f){this.cfg=this.cfg.extend(f),this.reset()},reset:function(){u.reset.call(this),this._doReset()},update:function(f){return this._append(f),this._process(),this},finalize:function(f){f&&this._append(f);var v=this._doFinalize();return v},blockSize:512/32,_createHelper:function(f){return function(v,y){return new f.init(y).finalize(v)}},_createHmacHelper:function(f){return function(v,y){return new x.HMAC.init(f,y).finalize(v)}}}),x=s.algo={};return s}(Math);return e})});var xn=z((e0,cf)=>{O();j();(function(e,t){typeof e0=="object"?cf.exports=e0=t(de()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(e0,function(e){return function(t){var r=e,n=r.lib,s=n.Base,a=n.WordArray,o=r.x64={},i=o.Word=s.extend({init:function(l,d){this.high=l,this.low=d}}),h=o.WordArray=s.extend({init:function(l,d){l=this.words=l||[],d!=t?this.sigBytes=d:this.sigBytes=l.length*8},toX32:function(){for(var l=this.words,d=l.length,p=[],u=0;u<d;u++){var c=l[u];p.push(c.high),p.push(c.low)}return a.create(p,this.sigBytes)},clone:function(){for(var l=s.clone.call(this),d=l.words=this.words.slice(0),p=d.length,u=0;u<p;u++)d[u]=d[u].clone();return l}})}(),e})});var lf=z((t0,hf)=>{O();j();(function(e,t){typeof t0=="object"?hf.exports=t0=t(de()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(t0,function(e){return function(){if(typeof ArrayBuffer=="function"){var t=e,r=t.lib,n=r.WordArray,s=n.init,a=n.init=function(o){if(o instanceof ArrayBuffer&&(o=new Uint8Array(o)),(o instanceof Int8Array||typeof Uint8ClampedArray<"u"&&o instanceof Uint8ClampedArray||o instanceof Int16Array||o instanceof Uint16Array||o instanceof Int32Array||o instanceof Uint32Array||o instanceof Float32Array||o instanceof Float64Array)&&(o=new Uint8Array(o.buffer,o.byteOffset,o.byteLength)),o instanceof Uint8Array){for(var i=o.byteLength,h=[],l=0;l<i;l++)h[l>>>2]|=o[l]<<24-l%4*8;s.call(this,h,i)}else s.apply(this,arguments)};a.prototype=n}}(),e.lib.WordArray})});var vf=z((r0,df)=>{O();j();(function(e,t){typeof r0=="object"?df.exports=r0=t(de()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(r0,function(e){return function(){var t=e,r=t.lib,n=r.WordArray,s=t.enc,a=s.Utf16=s.Utf16BE={stringify:function(i){for(var h=i.words,l=i.sigBytes,d=[],p=0;p<l;p+=2){var u=h[p>>>2]>>>16-p%4*8&65535;d.push(String.fromCharCode(u))}return d.join("")},parse:function(i){for(var h=i.length,l=[],d=0;d<h;d++)l[d>>>1]|=i.charCodeAt(d)<<16-d%2*16;return n.create(l,h*2)}};s.Utf16LE={stringify:function(i){for(var h=i.words,l=i.sigBytes,d=[],p=0;p<l;p+=2){var u=o(h[p>>>2]>>>16-p%4*8&65535);d.push(String.fromCharCode(u))}return d.join("")},parse:function(i){for(var h=i.length,l=[],d=0;d<h;d++)l[d>>>1]|=o(i.charCodeAt(d)<<16-d%2*16);return n.create(l,h*2)}};function o(i){return i<<8&4278255360|i>>>8&16711935}}(),e.enc.Utf16})});var cr=z((n0,pf)=>{O();j();(function(e,t){typeof n0=="object"?pf.exports=n0=t(de()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(n0,function(e){return function(){var t=e,r=t.lib,n=r.WordArray,s=t.enc,a=s.Base64={stringify:function(i){var h=i.words,l=i.sigBytes,d=this._map;i.clamp();for(var p=[],u=0;u<l;u+=3)for(var c=h[u>>>2]>>>24-u%4*8&255,x=h[u+1>>>2]>>>24-(u+1)%4*8&255,f=h[u+2>>>2]>>>24-(u+2)%4*8&255,v=c<<16|x<<8|f,y=0;y<4&&u+y*.75<l;y++)p.push(d.charAt(v>>>6*(3-y)&63));var m=d.charAt(64);if(m)for(;p.length%4;)p.push(m);return p.join("")},parse:function(i){var h=i.length,l=this._map,d=this._reverseMap;if(!d){d=this._reverseMap=[];for(var p=0;p<l.length;p++)d[l.charCodeAt(p)]=p}var u=l.charAt(64);if(u){var c=i.indexOf(u);c!==-1&&(h=c)}return o(i,h,d)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function o(i,h,l){for(var d=[],p=0,u=0;u<h;u++)if(u%4){var c=l[i.charCodeAt(u-1)]<<u%4*2,x=l[i.charCodeAt(u)]>>>6-u%4*2;d[p>>>2]|=(c|x)<<24-p%4*8,p++}return n.create(d,p)}}(),e.enc.Base64})});var hr=z((i0,xf)=>{O();j();(function(e,t){typeof i0=="object"?xf.exports=i0=t(de()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(i0,function(e){return function(t){var r=e,n=r.lib,s=n.WordArray,a=n.Hasher,o=r.algo,i=[];(function(){for(var c=0;c<64;c++)i[c]=t.abs(t.sin(c+1))*4294967296|0})();var h=o.MD5=a.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(c,x){for(var f=0;f<16;f++){var v=x+f,y=c[v];c[v]=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360}var m=this._hash.words,b=c[x+0],E=c[x+1],P=c[x+2],F=c[x+3],D=c[x+4],S=c[x+5],w=c[x+6],C=c[x+7],A=c[x+8],B=c[x+9],R=c[x+10],_=c[x+11],I=c[x+12],N=c[x+13],K=c[x+14],L=c[x+15],H=m[0],T=m[1],k=m[2],q=m[3];H=l(H,T,k,q,b,7,i[0]),q=l(q,H,T,k,E,12,i[1]),k=l(k,q,H,T,P,17,i[2]),T=l(T,k,q,H,F,22,i[3]),H=l(H,T,k,q,D,7,i[4]),q=l(q,H,T,k,S,12,i[5]),k=l(k,q,H,T,w,17,i[6]),T=l(T,k,q,H,C,22,i[7]),H=l(H,T,k,q,A,7,i[8]),q=l(q,H,T,k,B,12,i[9]),k=l(k,q,H,T,R,17,i[10]),T=l(T,k,q,H,_,22,i[11]),H=l(H,T,k,q,I,7,i[12]),q=l(q,H,T,k,N,12,i[13]),k=l(k,q,H,T,K,17,i[14]),T=l(T,k,q,H,L,22,i[15]),H=d(H,T,k,q,E,5,i[16]),q=d(q,H,T,k,w,9,i[17]),k=d(k,q,H,T,_,14,i[18]),T=d(T,k,q,H,b,20,i[19]),H=d(H,T,k,q,S,5,i[20]),q=d(q,H,T,k,R,9,i[21]),k=d(k,q,H,T,L,14,i[22]),T=d(T,k,q,H,D,20,i[23]),H=d(H,T,k,q,B,5,i[24]),q=d(q,H,T,k,K,9,i[25]),k=d(k,q,H,T,F,14,i[26]),T=d(T,k,q,H,A,20,i[27]),H=d(H,T,k,q,N,5,i[28]),q=d(q,H,T,k,P,9,i[29]),k=d(k,q,H,T,C,14,i[30]),T=d(T,k,q,H,I,20,i[31]),H=p(H,T,k,q,S,4,i[32]),q=p(q,H,T,k,A,11,i[33]),k=p(k,q,H,T,_,16,i[34]),T=p(T,k,q,H,K,23,i[35]),H=p(H,T,k,q,E,4,i[36]),q=p(q,H,T,k,D,11,i[37]),k=p(k,q,H,T,C,16,i[38]),T=p(T,k,q,H,R,23,i[39]),H=p(H,T,k,q,N,4,i[40]),q=p(q,H,T,k,b,11,i[41]),k=p(k,q,H,T,F,16,i[42]),T=p(T,k,q,H,w,23,i[43]),H=p(H,T,k,q,B,4,i[44]),q=p(q,H,T,k,I,11,i[45]),k=p(k,q,H,T,L,16,i[46]),T=p(T,k,q,H,P,23,i[47]),H=u(H,T,k,q,b,6,i[48]),q=u(q,H,T,k,C,10,i[49]),k=u(k,q,H,T,K,15,i[50]),T=u(T,k,q,H,S,21,i[51]),H=u(H,T,k,q,I,6,i[52]),q=u(q,H,T,k,F,10,i[53]),k=u(k,q,H,T,R,15,i[54]),T=u(T,k,q,H,E,21,i[55]),H=u(H,T,k,q,A,6,i[56]),q=u(q,H,T,k,L,10,i[57]),k=u(k,q,H,T,w,15,i[58]),T=u(T,k,q,H,N,21,i[59]),H=u(H,T,k,q,D,6,i[60]),q=u(q,H,T,k,_,10,i[61]),k=u(k,q,H,T,P,15,i[62]),T=u(T,k,q,H,B,21,i[63]),m[0]=m[0]+H|0,m[1]=m[1]+T|0,m[2]=m[2]+k|0,m[3]=m[3]+q|0},_doFinalize:function(){var c=this._data,x=c.words,f=this._nDataBytes*8,v=c.sigBytes*8;x[v>>>5]|=128<<24-v%32;var y=t.floor(f/4294967296),m=f;x[(v+64>>>9<<4)+15]=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,x[(v+64>>>9<<4)+14]=(m<<8|m>>>24)&16711935|(m<<24|m>>>8)&4278255360,c.sigBytes=(x.length+1)*4,this._process();for(var b=this._hash,E=b.words,P=0;P<4;P++){var F=E[P];E[P]=(F<<8|F>>>24)&16711935|(F<<24|F>>>8)&4278255360}return b},clone:function(){var c=a.clone.call(this);return c._hash=this._hash.clone(),c}});function l(c,x,f,v,y,m,b){var E=c+(x&f|~x&v)+y+b;return(E<<m|E>>>32-m)+x}function d(c,x,f,v,y,m,b){var E=c+(x&v|f&~v)+y+b;return(E<<m|E>>>32-m)+x}function p(c,x,f,v,y,m,b){var E=c+(x^f^v)+y+b;return(E<<m|E>>>32-m)+x}function u(c,x,f,v,y,m,b){var E=c+(f^(x|~v))+y+b;return(E<<m|E>>>32-m)+x}r.MD5=a._createHelper(h),r.HmacMD5=a._createHmacHelper(h)}(Math),e.MD5})});var a0=z((s0,gf)=>{O();j();(function(e,t){typeof s0=="object"?gf.exports=s0=t(de()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(s0,function(e){return function(){var t=e,r=t.lib,n=r.WordArray,s=r.Hasher,a=t.algo,o=[],i=a.SHA1=s.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(h,l){for(var d=this._hash.words,p=d[0],u=d[1],c=d[2],x=d[3],f=d[4],v=0;v<80;v++){if(v<16)o[v]=h[l+v]|0;else{var y=o[v-3]^o[v-8]^o[v-14]^o[v-16];o[v]=y<<1|y>>>31}var m=(p<<5|p>>>27)+f+o[v];v<20?m+=(u&c|~u&x)+1518500249:v<40?m+=(u^c^x)+1859775393:v<60?m+=(u&c|u&x|c&x)-1894007588:m+=(u^c^x)-899497514,f=x,x=c,c=u<<30|u>>>2,u=p,p=m}d[0]=d[0]+p|0,d[1]=d[1]+u|0,d[2]=d[2]+c|0,d[3]=d[3]+x|0,d[4]=d[4]+f|0},_doFinalize:function(){var h=this._data,l=h.words,d=this._nDataBytes*8,p=h.sigBytes*8;return l[p>>>5]|=128<<24-p%32,l[(p+64>>>9<<4)+14]=Math.floor(d/4294967296),l[(p+64>>>9<<4)+15]=d,h.sigBytes=l.length*4,this._process(),this._hash},clone:function(){var h=s.clone.call(this);return h._hash=this._hash.clone(),h}});t.SHA1=s._createHelper(i),t.HmacSHA1=s._createHmacHelper(i)}(),e.SHA1})});var Zs=z((o0,yf)=>{O();j();(function(e,t){typeof o0=="object"?yf.exports=o0=t(de()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(o0,function(e){return function(t){var r=e,n=r.lib,s=n.WordArray,a=n.Hasher,o=r.algo,i=[],h=[];(function(){function p(f){for(var v=t.sqrt(f),y=2;y<=v;y++)if(!(f%y))return!1;return!0}function u(f){return(f-(f|0))*4294967296|0}for(var c=2,x=0;x<64;)p(c)&&(x<8&&(i[x]=u(t.pow(c,1/2))),h[x]=u(t.pow(c,1/3)),x++),c++})();var l=[],d=o.SHA256=a.extend({_doReset:function(){this._hash=new s.init(i.slice(0))},_doProcessBlock:function(p,u){for(var c=this._hash.words,x=c[0],f=c[1],v=c[2],y=c[3],m=c[4],b=c[5],E=c[6],P=c[7],F=0;F<64;F++){if(F<16)l[F]=p[u+F]|0;else{var D=l[F-15],S=(D<<25|D>>>7)^(D<<14|D>>>18)^D>>>3,w=l[F-2],C=(w<<15|w>>>17)^(w<<13|w>>>19)^w>>>10;l[F]=S+l[F-7]+C+l[F-16]}var A=m&b^~m&E,B=x&f^x&v^f&v,R=(x<<30|x>>>2)^(x<<19|x>>>13)^(x<<10|x>>>22),_=(m<<26|m>>>6)^(m<<21|m>>>11)^(m<<7|m>>>25),I=P+_+A+h[F]+l[F],N=R+B;P=E,E=b,b=m,m=y+I|0,y=v,v=f,f=x,x=I+N|0}c[0]=c[0]+x|0,c[1]=c[1]+f|0,c[2]=c[2]+v|0,c[3]=c[3]+y|0,c[4]=c[4]+m|0,c[5]=c[5]+b|0,c[6]=c[6]+E|0,c[7]=c[7]+P|0},_doFinalize:function(){var p=this._data,u=p.words,c=this._nDataBytes*8,x=p.sigBytes*8;return u[x>>>5]|=128<<24-x%32,u[(x+64>>>9<<4)+14]=t.floor(c/4294967296),u[(x+64>>>9<<4)+15]=c,p.sigBytes=u.length*4,this._process(),this._hash},clone:function(){var p=a.clone.call(this);return p._hash=this._hash.clone(),p}});r.SHA256=a._createHelper(d),r.HmacSHA256=a._createHmacHelper(d)}(Math),e.SHA256})});var Sf=z((u0,mf)=>{O();j();(function(e,t,r){typeof u0=="object"?mf.exports=u0=t(de(),Zs()):typeof define=="function"&&define.amd?define(["./core","./sha256"],t):t(e.CryptoJS)})(u0,function(e){return function(){var t=e,r=t.lib,n=r.WordArray,s=t.algo,a=s.SHA256,o=s.SHA224=a.extend({_doReset:function(){this._hash=new n.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var i=a._doFinalize.call(this);return i.sigBytes-=4,i}});t.SHA224=a._createHelper(o),t.HmacSHA224=a._createHmacHelper(o)}(),e.SHA224})});var Qs=z((f0,bf)=>{O();j();(function(e,t,r){typeof f0=="object"?bf.exports=f0=t(de(),xn()):typeof define=="function"&&define.amd?define(["./core","./x64-core"],t):t(e.CryptoJS)})(f0,function(e){return function(){var t=e,r=t.lib,n=r.Hasher,s=t.x64,a=s.Word,o=s.WordArray,i=t.algo;function h(){return a.create.apply(a,arguments)}var l=[h(1116352408,3609767458),h(1899447441,602891725),h(3049323471,3964484399),h(3921009573,2173295548),h(961987163,4081628472),h(1508970993,3053834265),h(2453635748,2937671579),h(2870763221,3664609560),h(3624381080,2734883394),h(310598401,1164996542),h(607225278,1323610764),h(1426881987,3590304994),h(1925078388,4068182383),h(2162078206,991336113),h(2614888103,633803317),h(3248222580,3479774868),h(3835390401,2666613458),h(4022224774,944711139),h(264347078,2341262773),h(604807628,2007800933),h(770255983,1495990901),h(1249150122,1856431235),h(1555081692,3175218132),h(1996064986,2198950837),h(2554220882,3999719339),h(2821834349,766784016),h(2952996808,2566594879),h(3210313671,3203337956),h(3336571891,1034457026),h(3584528711,2466948901),h(113926993,3758326383),h(338241895,168717936),h(666307205,1188179964),h(773529912,1546045734),h(1294757372,1522805485),h(1396182291,2643833823),h(1695183700,2343527390),h(1986661051,1014477480),h(2177026350,1206759142),h(2456956037,344077627),h(2730485921,1290863460),h(2820302411,3158454273),h(3259730800,3505952657),h(3345764771,106217008),h(3516065817,3606008344),h(3600352804,1432725776),h(4094571909,1467031594),h(275423344,851169720),h(430227734,3100823752),h(506948616,1363258195),h(659060556,3750685593),h(883997877,3785050280),h(958139571,3318307427),h(1322822218,3812723403),h(1537002063,2003034995),h(1747873779,3602036899),h(1955562222,1575990012),h(2024104815,1125592928),h(2227730452,2716904306),h(2361852424,442776044),h(2428436474,593698344),h(2756734187,3733110249),h(3204031479,2999351573),h(3329325298,3815920427),h(3391569614,3928383900),h(3515267271,566280711),h(3940187606,3454069534),h(4118630271,4000239992),h(116418474,1914138554),h(174292421,2731055270),h(289380356,3203993006),h(460393269,320620315),h(685471733,587496836),h(852142971,1086792851),h(1017036298,365543100),h(1126000580,2618297676),h(1288033470,3409855158),h(1501505948,4234509866),h(1607167915,987167468),h(1816402316,1246189591)],d=[];(function(){for(var u=0;u<80;u++)d[u]=h()})();var p=i.SHA512=n.extend({_doReset:function(){this._hash=new o.init([new a.init(1779033703,4089235720),new a.init(3144134277,2227873595),new a.init(1013904242,4271175723),new a.init(2773480762,1595750129),new a.init(1359893119,2917565137),new a.init(2600822924,725511199),new a.init(528734635,4215389547),new a.init(1541459225,327033209)])},_doProcessBlock:function(u,c){for(var x=this._hash.words,f=x[0],v=x[1],y=x[2],m=x[3],b=x[4],E=x[5],P=x[6],F=x[7],D=f.high,S=f.low,w=v.high,C=v.low,A=y.high,B=y.low,R=m.high,_=m.low,I=b.high,N=b.low,K=E.high,L=E.low,H=P.high,T=P.low,k=F.high,q=F.low,$=D,Y=S,se=w,G=C,me=A,ye=B,He=R,ie=_,ne=I,re=N,xe=K,be=L,oe=H,Pe=T,ot=k,qe=q,Fe=0;Fe<80;Fe++){var Ke=d[Fe];if(Fe<16)var Re=Ke.high=u[c+Fe*2]|0,Ce=Ke.low=u[c+Fe*2+1]|0;else{var Lt=d[Fe-15],ae=Lt.high,Te=Lt.low,fe=(ae>>>1|Te<<31)^(ae>>>8|Te<<24)^ae>>>7,it=(Te>>>1|ae<<31)^(Te>>>8|ae<<24)^(Te>>>7|ae<<25),Or=d[Fe-2],ut=Or.high,bt=Or.low,K0=(ut>>>19|bt<<13)^(ut<<3|bt>>>29)^ut>>>6,jr=(bt>>>19|ut<<13)^(bt<<3|ut>>>29)^(bt>>>6|ut<<26),qr=d[Fe-7],k0=qr.high,M0=qr.low,Kr=d[Fe-16],V0=Kr.high,kr=Kr.low,Ce=it+M0,Re=fe+k0+(Ce>>>0<it>>>0?1:0),Ce=Ce+jr,Re=Re+K0+(Ce>>>0<jr>>>0?1:0),Ce=Ce+kr,Re=Re+V0+(Ce>>>0<kr>>>0?1:0);Ke.high=Re,Ke.low=Ce}var L0=ne&xe^~ne&oe,Mr=re&be^~re&Pe,U0=$&se^$&me^se&me,z0=Y&G^Y&ye^G&ye,W0=($>>>28|Y<<4)^($<<30|Y>>>2)^($<<25|Y>>>7),Vr=(Y>>>28|$<<4)^(Y<<30|$>>>2)^(Y<<25|$>>>7),G0=(ne>>>14|re<<18)^(ne>>>18|re<<14)^(ne<<23|re>>>9),X0=(re>>>14|ne<<18)^(re>>>18|ne<<14)^(re<<23|ne>>>9),Lr=l[Fe],J0=Lr.high,Ur=Lr.low,we=qe+X0,Je=ot+G0+(we>>>0<qe>>>0?1:0),we=we+Mr,Je=Je+L0+(we>>>0<Mr>>>0?1:0),we=we+Ur,Je=Je+J0+(we>>>0<Ur>>>0?1:0),we=we+Ce,Je=Je+Re+(we>>>0<Ce>>>0?1:0),zr=Vr+z0,Y0=W0+U0+(zr>>>0<Vr>>>0?1:0);ot=oe,qe=Pe,oe=xe,Pe=be,xe=ne,be=re,re=ie+we|0,ne=He+Je+(re>>>0<ie>>>0?1:0)|0,He=me,ie=ye,me=se,ye=G,se=$,G=Y,Y=we+zr|0,$=Je+Y0+(Y>>>0<we>>>0?1:0)|0}S=f.low=S+Y,f.high=D+$+(S>>>0<Y>>>0?1:0),C=v.low=C+G,v.high=w+se+(C>>>0<G>>>0?1:0),B=y.low=B+ye,y.high=A+me+(B>>>0<ye>>>0?1:0),_=m.low=_+ie,m.high=R+He+(_>>>0<ie>>>0?1:0),N=b.low=N+re,b.high=I+ne+(N>>>0<re>>>0?1:0),L=E.low=L+be,E.high=K+xe+(L>>>0<be>>>0?1:0),T=P.low=T+Pe,P.high=H+oe+(T>>>0<Pe>>>0?1:0),q=F.low=q+qe,F.high=k+ot+(q>>>0<qe>>>0?1:0)},_doFinalize:function(){var u=this._data,c=u.words,x=this._nDataBytes*8,f=u.sigBytes*8;c[f>>>5]|=128<<24-f%32,c[(f+128>>>10<<5)+30]=Math.floor(x/4294967296),c[(f+128>>>10<<5)+31]=x,u.sigBytes=c.length*4,this._process();var v=this._hash.toX32();return v},clone:function(){var u=n.clone.call(this);return u._hash=this._hash.clone(),u},blockSize:1024/32});t.SHA512=n._createHelper(p),t.HmacSHA512=n._createHmacHelper(p)}(),e.SHA512})});var Ef=z((c0,wf)=>{O();j();(function(e,t,r){typeof c0=="object"?wf.exports=c0=t(de(),xn(),Qs()):typeof define=="function"&&define.amd?define(["./core","./x64-core","./sha512"],t):t(e.CryptoJS)})(c0,function(e){return function(){var t=e,r=t.x64,n=r.Word,s=r.WordArray,a=t.algo,o=a.SHA512,i=a.SHA384=o.extend({_doReset:function(){this._hash=new s.init([new n.init(3418070365,3238371032),new n.init(1654270250,914150663),new n.init(2438529370,812702999),new n.init(355462360,4144912697),new n.init(1731405415,4290775857),new n.init(2394180231,1750603025),new n.init(3675008525,1694076839),new n.init(1203062813,3204075428)])},_doFinalize:function(){var h=o._doFinalize.call(this);return h.sigBytes-=16,h}});t.SHA384=o._createHelper(i),t.HmacSHA384=o._createHmacHelper(i)}(),e.SHA384})});var Af=z((h0,Pf)=>{O();j();(function(e,t,r){typeof h0=="object"?Pf.exports=h0=t(de(),xn()):typeof define=="function"&&define.amd?define(["./core","./x64-core"],t):t(e.CryptoJS)})(h0,function(e){return function(t){var r=e,n=r.lib,s=n.WordArray,a=n.Hasher,o=r.x64,i=o.Word,h=r.algo,l=[],d=[],p=[];(function(){for(var x=1,f=0,v=0;v<24;v++){l[x+5*f]=(v+1)*(v+2)/2%64;var y=f%5,m=(2*x+3*f)%5;x=y,f=m}for(var x=0;x<5;x++)for(var f=0;f<5;f++)d[x+5*f]=f+(2*x+3*f)%5*5;for(var b=1,E=0;E<24;E++){for(var P=0,F=0,D=0;D<7;D++){if(b&1){var S=(1<<D)-1;S<32?F^=1<<S:P^=1<<S-32}b&128?b=b<<1^113:b<<=1}p[E]=i.create(P,F)}})();var u=[];(function(){for(var x=0;x<25;x++)u[x]=i.create()})();var c=h.SHA3=a.extend({cfg:a.cfg.extend({outputLength:512}),_doReset:function(){for(var x=this._state=[],f=0;f<25;f++)x[f]=new i.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(x,f){for(var v=this._state,y=this.blockSize/2,m=0;m<y;m++){var b=x[f+2*m],E=x[f+2*m+1];b=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,E=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360;var P=v[m];P.high^=E,P.low^=b}for(var F=0;F<24;F++){for(var D=0;D<5;D++){for(var S=0,w=0,C=0;C<5;C++){var P=v[D+5*C];S^=P.high,w^=P.low}var A=u[D];A.high=S,A.low=w}for(var D=0;D<5;D++)for(var B=u[(D+4)%5],R=u[(D+1)%5],_=R.high,I=R.low,S=B.high^(_<<1|I>>>31),w=B.low^(I<<1|_>>>31),C=0;C<5;C++){var P=v[D+5*C];P.high^=S,P.low^=w}for(var N=1;N<25;N++){var P=v[N],K=P.high,L=P.low,H=l[N];if(H<32)var S=K<<H|L>>>32-H,w=L<<H|K>>>32-H;else var S=L<<H-32|K>>>64-H,w=K<<H-32|L>>>64-H;var T=u[d[N]];T.high=S,T.low=w}var k=u[0],q=v[0];k.high=q.high,k.low=q.low;for(var D=0;D<5;D++)for(var C=0;C<5;C++){var N=D+5*C,P=v[N],$=u[N],Y=u[(D+1)%5+5*C],se=u[(D+2)%5+5*C];P.high=$.high^~Y.high&se.high,P.low=$.low^~Y.low&se.low}var P=v[0],G=p[F];P.high^=G.high,P.low^=G.low}},_doFinalize:function(){var x=this._data,f=x.words,v=this._nDataBytes*8,y=x.sigBytes*8,m=this.blockSize*32;f[y>>>5]|=1<<24-y%32,f[(t.ceil((y+1)/m)*m>>>5)-1]|=128,x.sigBytes=f.length*4,this._process();for(var b=this._state,E=this.cfg.outputLength/8,P=E/8,F=[],D=0;D<P;D++){var S=b[D],w=S.high,C=S.low;w=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,C=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360,F.push(C),F.push(w)}return new s.init(F,E)},clone:function(){for(var x=a.clone.call(this),f=x._state=this._state.slice(0),v=0;v<25;v++)f[v]=f[v].clone();return x}});r.SHA3=a._createHelper(c),r.HmacSHA3=a._createHmacHelper(c)}(Math),e.SHA3})});var Cf=z((l0,Ff)=>{O();j();(function(e,t){typeof l0=="object"?Ff.exports=l0=t(de()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(l0,function(e){return function(t){var r=e,n=r.lib,s=n.WordArray,a=n.Hasher,o=r.algo,i=s.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),h=s.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),l=s.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),d=s.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),p=s.create([0,1518500249,1859775393,2400959708,2840853838]),u=s.create([1352829926,1548603684,1836072691,2053994217,0]),c=o.RIPEMD160=a.extend({_doReset:function(){this._hash=s.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(E,P){for(var F=0;F<16;F++){var D=P+F,S=E[D];E[D]=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360}var w=this._hash.words,C=p.words,A=u.words,B=i.words,R=h.words,_=l.words,I=d.words,N,K,L,H,T,k,q,$,Y,se;k=N=w[0],q=K=w[1],$=L=w[2],Y=H=w[3],se=T=w[4];for(var G,F=0;F<80;F+=1)G=N+E[P+B[F]]|0,F<16?G+=x(K,L,H)+C[0]:F<32?G+=f(K,L,H)+C[1]:F<48?G+=v(K,L,H)+C[2]:F<64?G+=y(K,L,H)+C[3]:G+=m(K,L,H)+C[4],G=G|0,G=b(G,_[F]),G=G+T|0,N=T,T=H,H=b(L,10),L=K,K=G,G=k+E[P+R[F]]|0,F<16?G+=m(q,$,Y)+A[0]:F<32?G+=y(q,$,Y)+A[1]:F<48?G+=v(q,$,Y)+A[2]:F<64?G+=f(q,$,Y)+A[3]:G+=x(q,$,Y)+A[4],G=G|0,G=b(G,I[F]),G=G+se|0,k=se,se=Y,Y=b($,10),$=q,q=G;G=w[1]+L+Y|0,w[1]=w[2]+H+se|0,w[2]=w[3]+T+k|0,w[3]=w[4]+N+q|0,w[4]=w[0]+K+$|0,w[0]=G},_doFinalize:function(){var E=this._data,P=E.words,F=this._nDataBytes*8,D=E.sigBytes*8;P[D>>>5]|=128<<24-D%32,P[(D+64>>>9<<4)+14]=(F<<8|F>>>24)&16711935|(F<<24|F>>>8)&4278255360,E.sigBytes=(P.length+1)*4,this._process();for(var S=this._hash,w=S.words,C=0;C<5;C++){var A=w[C];w[C]=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360}return S},clone:function(){var E=a.clone.call(this);return E._hash=this._hash.clone(),E}});function x(E,P,F){return E^P^F}function f(E,P,F){return E&P|~E&F}function v(E,P,F){return(E|~P)^F}function y(E,P,F){return E&F|P&~F}function m(E,P,F){return E^(P|~F)}function b(E,P){return E<<P|E>>>32-P}r.RIPEMD160=a._createHelper(c),r.HmacRIPEMD160=a._createHmacHelper(c)}(Math),e.RIPEMD160})});var v0=z((d0,_f)=>{O();j();(function(e,t){typeof d0=="object"?_f.exports=d0=t(de()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(d0,function(e){(function(){var t=e,r=t.lib,n=r.Base,s=t.enc,a=s.Utf8,o=t.algo,i=o.HMAC=n.extend({init:function(h,l){h=this._hasher=new h.init,typeof l=="string"&&(l=a.parse(l));var d=h.blockSize,p=d*4;l.sigBytes>p&&(l=h.finalize(l)),l.clamp();for(var u=this._oKey=l.clone(),c=this._iKey=l.clone(),x=u.words,f=c.words,v=0;v<d;v++)x[v]^=1549556828,f[v]^=909522486;u.sigBytes=c.sigBytes=p,this.reset()},reset:function(){var h=this._hasher;h.reset(),h.update(this._iKey)},update:function(h){return this._hasher.update(h),this},finalize:function(h){var l=this._hasher,d=l.finalize(h);l.reset();var p=l.finalize(this._oKey.clone().concat(d));return p}})})()})});var Df=z((p0,Bf)=>{O();j();(function(e,t,r){typeof p0=="object"?Bf.exports=p0=t(de(),a0(),v0()):typeof define=="function"&&define.amd?define(["./core","./sha1","./hmac"],t):t(e.CryptoJS)})(p0,function(e){return function(){var t=e,r=t.lib,n=r.Base,s=r.WordArray,a=t.algo,o=a.SHA1,i=a.HMAC,h=a.PBKDF2=n.extend({cfg:n.extend({keySize:128/32,hasher:o,iterations:1}),init:function(l){this.cfg=this.cfg.extend(l)},compute:function(l,d){for(var p=this.cfg,u=i.create(p.hasher,l),c=s.create(),x=s.create([1]),f=c.words,v=x.words,y=p.keySize,m=p.iterations;f.length<y;){var b=u.update(d).finalize(x);u.reset();for(var E=b.words,P=E.length,F=b,D=1;D<m;D++){F=u.finalize(F),u.reset();for(var S=F.words,w=0;w<P;w++)E[w]^=S[w]}c.concat(b),v[0]++}return c.sigBytes=y*4,c}});t.PBKDF2=function(l,d,p){return h.create(p).compute(l,d)}}(),e.PBKDF2})});var Zt=z((x0,If)=>{O();j();(function(e,t,r){typeof x0=="object"?If.exports=x0=t(de(),a0(),v0()):typeof define=="function"&&define.amd?define(["./core","./sha1","./hmac"],t):t(e.CryptoJS)})(x0,function(e){return function(){var t=e,r=t.lib,n=r.Base,s=r.WordArray,a=t.algo,o=a.MD5,i=a.EvpKDF=n.extend({cfg:n.extend({keySize:128/32,hasher:o,iterations:1}),init:function(h){this.cfg=this.cfg.extend(h)},compute:function(h,l){for(var d=this.cfg,p=d.hasher.create(),u=s.create(),c=u.words,x=d.keySize,f=d.iterations;c.length<x;){v&&p.update(v);var v=p.update(h).finalize(l);p.reset();for(var y=1;y<f;y++)v=p.finalize(v),p.reset();u.concat(v)}return u.sigBytes=x*4,u}});t.EvpKDF=function(h,l,d){return i.create(d).compute(h,l)}}(),e.EvpKDF})});var Xe=z((g0,Rf)=>{O();j();(function(e,t,r){typeof g0=="object"?Rf.exports=g0=t(de(),Zt()):typeof define=="function"&&define.amd?define(["./core","./evpkdf"],t):t(e.CryptoJS)})(g0,function(e){e.lib.Cipher||function(t){var r=e,n=r.lib,s=n.Base,a=n.WordArray,o=n.BufferedBlockAlgorithm,i=r.enc,h=i.Utf8,l=i.Base64,d=r.algo,p=d.EvpKDF,u=n.Cipher=o.extend({cfg:s.extend(),createEncryptor:function(A,B){return this.create(this._ENC_XFORM_MODE,A,B)},createDecryptor:function(A,B){return this.create(this._DEC_XFORM_MODE,A,B)},init:function(A,B,R){this.cfg=this.cfg.extend(R),this._xformMode=A,this._key=B,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(A){return this._append(A),this._process()},finalize:function(A){A&&this._append(A);var B=this._doFinalize();return B},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function A(B){return typeof B=="string"?C:D}return function(B){return{encrypt:function(R,_,I){return A(_).encrypt(B,R,_,I)},decrypt:function(R,_,I){return A(_).decrypt(B,R,_,I)}}}}()}),c=n.StreamCipher=u.extend({_doFinalize:function(){var A=this._process(!0);return A},blockSize:1}),x=r.mode={},f=n.BlockCipherMode=s.extend({createEncryptor:function(A,B){return this.Encryptor.create(A,B)},createDecryptor:function(A,B){return this.Decryptor.create(A,B)},init:function(A,B){this._cipher=A,this._iv=B}}),v=x.CBC=function(){var A=f.extend();A.Encryptor=A.extend({processBlock:function(R,_){var I=this._cipher,N=I.blockSize;B.call(this,R,_,N),I.encryptBlock(R,_),this._prevBlock=R.slice(_,_+N)}}),A.Decryptor=A.extend({processBlock:function(R,_){var I=this._cipher,N=I.blockSize,K=R.slice(_,_+N);I.decryptBlock(R,_),B.call(this,R,_,N),this._prevBlock=K}});function B(R,_,I){var N=this._iv;if(N){var K=N;this._iv=t}else var K=this._prevBlock;for(var L=0;L<I;L++)R[_+L]^=K[L]}return A}(),y=r.pad={},m=y.Pkcs7={pad:function(A,B){for(var R=B*4,_=R-A.sigBytes%R,I=_<<24|_<<16|_<<8|_,N=[],K=0;K<_;K+=4)N.push(I);var L=a.create(N,_);A.concat(L)},unpad:function(A){var B=A.words[A.sigBytes-1>>>2]&255;A.sigBytes-=B}},b=n.BlockCipher=u.extend({cfg:u.cfg.extend({mode:v,padding:m}),reset:function(){u.reset.call(this);var A=this.cfg,B=A.iv,R=A.mode;if(this._xformMode==this._ENC_XFORM_MODE)var _=R.createEncryptor;else{var _=R.createDecryptor;this._minBufferSize=1}this._mode&&this._mode.__creator==_?this._mode.init(this,B&&B.words):(this._mode=_.call(R,this,B&&B.words),this._mode.__creator=_)},_doProcessBlock:function(A,B){this._mode.processBlock(A,B)},_doFinalize:function(){var A=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){A.pad(this._data,this.blockSize);var B=this._process(!0)}else{var B=this._process(!0);A.unpad(B)}return B},blockSize:128/32}),E=n.CipherParams=s.extend({init:function(A){this.mixIn(A)},toString:function(A){return(A||this.formatter).stringify(this)}}),P=r.format={},F=P.OpenSSL={stringify:function(A){var B=A.ciphertext,R=A.salt;if(R)var _=a.create([1398893684,1701076831]).concat(R).concat(B);else var _=B;return _.toString(l)},parse:function(A){var B=l.parse(A),R=B.words;if(R[0]==1398893684&&R[1]==1701076831){var _=a.create(R.slice(2,4));R.splice(0,4),B.sigBytes-=16}return E.create({ciphertext:B,salt:_})}},D=n.SerializableCipher=s.extend({cfg:s.extend({format:F}),encrypt:function(A,B,R,_){_=this.cfg.extend(_);var I=A.createEncryptor(R,_),N=I.finalize(B),K=I.cfg;return E.create({ciphertext:N,key:R,iv:K.iv,algorithm:A,mode:K.mode,padding:K.padding,blockSize:A.blockSize,formatter:_.format})},decrypt:function(A,B,R,_){_=this.cfg.extend(_),B=this._parse(B,_.format);var I=A.createDecryptor(R,_).finalize(B.ciphertext);return I},_parse:function(A,B){return typeof A=="string"?B.parse(A,this):A}}),S=r.kdf={},w=S.OpenSSL={execute:function(A,B,R,_){_||(_=a.random(64/8));var I=p.create({keySize:B+R}).compute(A,_),N=a.create(I.words.slice(B),R*4);return I.sigBytes=B*4,E.create({key:I,iv:N,salt:_})}},C=n.PasswordBasedCipher=D.extend({cfg:D.cfg.extend({kdf:w}),encrypt:function(A,B,R,_){_=this.cfg.extend(_);var I=_.kdf.execute(R,A.keySize,A.ivSize);_.iv=I.iv;var N=D.encrypt.call(this,A,B,I.key,_);return N.mixIn(I),N},decrypt:function(A,B,R,_){_=this.cfg.extend(_),B=this._parse(B,_.format);var I=_.kdf.execute(R,A.keySize,A.ivSize,B.salt);_.iv=I.iv;var N=D.decrypt.call(this,A,B,I.key,_);return N}})}()})});var Hf=z((y0,Nf)=>{O();j();(function(e,t,r){typeof y0=="object"?Nf.exports=y0=t(de(),Xe()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(y0,function(e){return e.mode.CFB=function(){var t=e.lib.BlockCipherMode.extend();t.Encryptor=t.extend({processBlock:function(n,s){var a=this._cipher,o=a.blockSize;r.call(this,n,s,o,a),this._prevBlock=n.slice(s,s+o)}}),t.Decryptor=t.extend({processBlock:function(n,s){var a=this._cipher,o=a.blockSize,i=n.slice(s,s+o);r.call(this,n,s,o,a),this._prevBlock=i}});function r(n,s,a,o){var i=this._iv;if(i){var h=i.slice(0);this._iv=void 0}else var h=this._prevBlock;o.encryptBlock(h,0);for(var l=0;l<a;l++)n[s+l]^=h[l]}return t}(),e.mode.CFB})});var Of=z((m0,Tf)=>{O();j();(function(e,t,r){typeof m0=="object"?Tf.exports=m0=t(de(),Xe()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(m0,function(e){return e.mode.CTR=function(){var t=e.lib.BlockCipherMode.extend(),r=t.Encryptor=t.extend({processBlock:function(n,s){var a=this._cipher,o=a.blockSize,i=this._iv,h=this._counter;i&&(h=this._counter=i.slice(0),this._iv=void 0);var l=h.slice(0);a.encryptBlock(l,0),h[o-1]=h[o-1]+1|0;for(var d=0;d<o;d++)n[s+d]^=l[d]}});return t.Decryptor=r,t}(),e.mode.CTR})});var qf=z((S0,jf)=>{O();j();(function(e,t,r){typeof S0=="object"?jf.exports=S0=t(de(),Xe()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(S0,function(e){return e.mode.CTRGladman=function(){var t=e.lib.BlockCipherMode.extend();function r(a){if((a>>24&255)===255){var o=a>>16&255,i=a>>8&255,h=a&255;o===255?(o=0,i===255?(i=0,h===255?h=0:++h):++i):++o,a=0,a+=o<<16,a+=i<<8,a+=h}else a+=1<<24;return a}function n(a){return(a[0]=r(a[0]))===0&&(a[1]=r(a[1])),a}var s=t.Encryptor=t.extend({processBlock:function(a,o){var i=this._cipher,h=i.blockSize,l=this._iv,d=this._counter;l&&(d=this._counter=l.slice(0),this._iv=void 0),n(d);var p=d.slice(0);i.encryptBlock(p,0);for(var u=0;u<h;u++)a[o+u]^=p[u]}});return t.Decryptor=s,t}(),e.mode.CTRGladman})});var kf=z((b0,Kf)=>{O();j();(function(e,t,r){typeof b0=="object"?Kf.exports=b0=t(de(),Xe()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(b0,function(e){return e.mode.OFB=function(){var t=e.lib.BlockCipherMode.extend(),r=t.Encryptor=t.extend({processBlock:function(n,s){var a=this._cipher,o=a.blockSize,i=this._iv,h=this._keystream;i&&(h=this._keystream=i.slice(0),this._iv=void 0),a.encryptBlock(h,0);for(var l=0;l<o;l++)n[s+l]^=h[l]}});return t.Decryptor=r,t}(),e.mode.OFB})});var Vf=z((w0,Mf)=>{O();j();(function(e,t,r){typeof w0=="object"?Mf.exports=w0=t(de(),Xe()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(w0,function(e){return e.mode.ECB=function(){var t=e.lib.BlockCipherMode.extend();return t.Encryptor=t.extend({processBlock:function(r,n){this._cipher.encryptBlock(r,n)}}),t.Decryptor=t.extend({processBlock:function(r,n){this._cipher.decryptBlock(r,n)}}),t}(),e.mode.ECB})});var Uf=z((E0,Lf)=>{O();j();(function(e,t,r){typeof E0=="object"?Lf.exports=E0=t(de(),Xe()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(E0,function(e){return e.pad.AnsiX923={pad:function(t,r){var n=t.sigBytes,s=r*4,a=s-n%s,o=n+a-1;t.clamp(),t.words[o>>>2]|=a<<24-o%4*8,t.sigBytes+=a},unpad:function(t){var r=t.words[t.sigBytes-1>>>2]&255;t.sigBytes-=r}},e.pad.Ansix923})});var Wf=z((P0,zf)=>{O();j();(function(e,t,r){typeof P0=="object"?zf.exports=P0=t(de(),Xe()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(P0,function(e){return e.pad.Iso10126={pad:function(t,r){var n=r*4,s=n-t.sigBytes%n;t.concat(e.lib.WordArray.random(s-1)).concat(e.lib.WordArray.create([s<<24],1))},unpad:function(t){var r=t.words[t.sigBytes-1>>>2]&255;t.sigBytes-=r}},e.pad.Iso10126})});var Xf=z((A0,Gf)=>{O();j();(function(e,t,r){typeof A0=="object"?Gf.exports=A0=t(de(),Xe()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(A0,function(e){return e.pad.Iso97971={pad:function(t,r){t.concat(e.lib.WordArray.create([2147483648],1)),e.pad.ZeroPadding.pad(t,r)},unpad:function(t){e.pad.ZeroPadding.unpad(t),t.sigBytes--}},e.pad.Iso97971})});var Yf=z((F0,Jf)=>{O();j();(function(e,t,r){typeof F0=="object"?Jf.exports=F0=t(de(),Xe()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(F0,function(e){return e.pad.ZeroPadding={pad:function(t,r){var n=r*4;t.clamp(),t.sigBytes+=n-(t.sigBytes%n||n)},unpad:function(t){for(var r=t.words,n=t.sigBytes-1;!(r[n>>>2]>>>24-n%4*8&255);)n--;t.sigBytes=n+1}},e.pad.ZeroPadding})});var Zf=z((C0,$f)=>{O();j();(function(e,t,r){typeof C0=="object"?$f.exports=C0=t(de(),Xe()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(C0,function(e){return e.pad.NoPadding={pad:function(){},unpad:function(){}},e.pad.NoPadding})});var ec=z((_0,Qf)=>{O();j();(function(e,t,r){typeof _0=="object"?Qf.exports=_0=t(de(),Xe()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(_0,function(e){return function(t){var r=e,n=r.lib,s=n.CipherParams,a=r.enc,o=a.Hex,i=r.format,h=i.Hex={stringify:function(l){return l.ciphertext.toString(o)},parse:function(l){var d=o.parse(l);return s.create({ciphertext:d})}}}(),e.format.Hex})});var rc=z((B0,tc)=>{O();j();(function(e,t,r){typeof B0=="object"?tc.exports=B0=t(de(),cr(),hr(),Zt(),Xe()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],t):t(e.CryptoJS)})(B0,function(e){return function(){var t=e,r=t.lib,n=r.BlockCipher,s=t.algo,a=[],o=[],i=[],h=[],l=[],d=[],p=[],u=[],c=[],x=[];(function(){for(var y=[],m=0;m<256;m++)m<128?y[m]=m<<1:y[m]=m<<1^283;for(var b=0,E=0,m=0;m<256;m++){var P=E^E<<1^E<<2^E<<3^E<<4;P=P>>>8^P&255^99,a[b]=P,o[P]=b;var F=y[b],D=y[F],S=y[D],w=y[P]*257^P*16843008;i[b]=w<<24|w>>>8,h[b]=w<<16|w>>>16,l[b]=w<<8|w>>>24,d[b]=w;var w=S*16843009^D*65537^F*257^b*16843008;p[P]=w<<24|w>>>8,u[P]=w<<16|w>>>16,c[P]=w<<8|w>>>24,x[P]=w,b?(b=F^y[y[y[S^F]]],E^=y[y[E]]):b=E=1}})();var f=[0,1,2,4,8,16,32,64,128,27,54],v=s.AES=n.extend({_doReset:function(){if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var y=this._keyPriorReset=this._key,m=y.words,b=y.sigBytes/4,E=this._nRounds=b+6,P=(E+1)*4,F=this._keySchedule=[],D=0;D<P;D++)if(D<b)F[D]=m[D];else{var S=F[D-1];D%b?b>6&&D%b==4&&(S=a[S>>>24]<<24|a[S>>>16&255]<<16|a[S>>>8&255]<<8|a[S&255]):(S=S<<8|S>>>24,S=a[S>>>24]<<24|a[S>>>16&255]<<16|a[S>>>8&255]<<8|a[S&255],S^=f[D/b|0]<<24),F[D]=F[D-b]^S}for(var w=this._invKeySchedule=[],C=0;C<P;C++){var D=P-C;if(C%4)var S=F[D];else var S=F[D-4];C<4||D<=4?w[C]=S:w[C]=p[a[S>>>24]]^u[a[S>>>16&255]]^c[a[S>>>8&255]]^x[a[S&255]]}}},encryptBlock:function(y,m){this._doCryptBlock(y,m,this._keySchedule,i,h,l,d,a)},decryptBlock:function(y,m){var b=y[m+1];y[m+1]=y[m+3],y[m+3]=b,this._doCryptBlock(y,m,this._invKeySchedule,p,u,c,x,o);var b=y[m+1];y[m+1]=y[m+3],y[m+3]=b},_doCryptBlock:function(y,m,b,E,P,F,D,S){for(var w=this._nRounds,C=y[m]^b[0],A=y[m+1]^b[1],B=y[m+2]^b[2],R=y[m+3]^b[3],_=4,I=1;I<w;I++){var N=E[C>>>24]^P[A>>>16&255]^F[B>>>8&255]^D[R&255]^b[_++],K=E[A>>>24]^P[B>>>16&255]^F[R>>>8&255]^D[C&255]^b[_++],L=E[B>>>24]^P[R>>>16&255]^F[C>>>8&255]^D[A&255]^b[_++],H=E[R>>>24]^P[C>>>16&255]^F[A>>>8&255]^D[B&255]^b[_++];C=N,A=K,B=L,R=H}var N=(S[C>>>24]<<24|S[A>>>16&255]<<16|S[B>>>8&255]<<8|S[R&255])^b[_++],K=(S[A>>>24]<<24|S[B>>>16&255]<<16|S[R>>>8&255]<<8|S[C&255])^b[_++],L=(S[B>>>24]<<24|S[R>>>16&255]<<16|S[C>>>8&255]<<8|S[A&255])^b[_++],H=(S[R>>>24]<<24|S[C>>>16&255]<<16|S[A>>>8&255]<<8|S[B&255])^b[_++];y[m]=N,y[m+1]=K,y[m+2]=L,y[m+3]=H},keySize:256/32});t.AES=n._createHelper(v)}(),e.AES})});var ic=z((D0,nc)=>{O();j();(function(e,t,r){typeof D0=="object"?nc.exports=D0=t(de(),cr(),hr(),Zt(),Xe()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],t):t(e.CryptoJS)})(D0,function(e){return function(){var t=e,r=t.lib,n=r.WordArray,s=r.BlockCipher,a=t.algo,o=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],i=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],h=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],l=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],d=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],p=a.DES=s.extend({_doReset:function(){for(var f=this._key,v=f.words,y=[],m=0;m<56;m++){var b=o[m]-1;y[m]=v[b>>>5]>>>31-b%32&1}for(var E=this._subKeys=[],P=0;P<16;P++){for(var F=E[P]=[],D=h[P],m=0;m<24;m++)F[m/6|0]|=y[(i[m]-1+D)%28]<<31-m%6,F[4+(m/6|0)]|=y[28+(i[m+24]-1+D)%28]<<31-m%6;F[0]=F[0]<<1|F[0]>>>31;for(var m=1;m<7;m++)F[m]=F[m]>>>(m-1)*4+3;F[7]=F[7]<<5|F[7]>>>27}for(var S=this._invSubKeys=[],m=0;m<16;m++)S[m]=E[15-m]},encryptBlock:function(f,v){this._doCryptBlock(f,v,this._subKeys)},decryptBlock:function(f,v){this._doCryptBlock(f,v,this._invSubKeys)},_doCryptBlock:function(f,v,y){this._lBlock=f[v],this._rBlock=f[v+1],u.call(this,4,252645135),u.call(this,16,65535),c.call(this,2,858993459),c.call(this,8,16711935),u.call(this,1,1431655765);for(var m=0;m<16;m++){for(var b=y[m],E=this._lBlock,P=this._rBlock,F=0,D=0;D<8;D++)F|=l[D][((P^b[D])&d[D])>>>0];this._lBlock=P,this._rBlock=E^F}var S=this._lBlock;this._lBlock=this._rBlock,this._rBlock=S,u.call(this,1,1431655765),c.call(this,8,16711935),c.call(this,2,858993459),u.call(this,16,65535),u.call(this,4,252645135),f[v]=this._lBlock,f[v+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function u(f,v){var y=(this._lBlock>>>f^this._rBlock)&v;this._rBlock^=y,this._lBlock^=y<<f}function c(f,v){var y=(this._rBlock>>>f^this._lBlock)&v;this._lBlock^=y,this._rBlock^=y<<f}t.DES=s._createHelper(p);var x=a.TripleDES=s.extend({_doReset:function(){var f=this._key,v=f.words;this._des1=p.createEncryptor(n.create(v.slice(0,2))),this._des2=p.createEncryptor(n.create(v.slice(2,4))),this._des3=p.createEncryptor(n.create(v.slice(4,6)))},encryptBlock:function(f,v){this._des1.encryptBlock(f,v),this._des2.decryptBlock(f,v),this._des3.encryptBlock(f,v)},decryptBlock:function(f,v){this._des3.decryptBlock(f,v),this._des2.encryptBlock(f,v),this._des1.decryptBlock(f,v)},keySize:192/32,ivSize:64/32,blockSize:64/32});t.TripleDES=s._createHelper(x)}(),e.TripleDES})});var ac=z((I0,sc)=>{O();j();(function(e,t,r){typeof I0=="object"?sc.exports=I0=t(de(),cr(),hr(),Zt(),Xe()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],t):t(e.CryptoJS)})(I0,function(e){return function(){var t=e,r=t.lib,n=r.StreamCipher,s=t.algo,a=s.RC4=n.extend({_doReset:function(){for(var h=this._key,l=h.words,d=h.sigBytes,p=this._S=[],u=0;u<256;u++)p[u]=u;for(var u=0,c=0;u<256;u++){var x=u%d,f=l[x>>>2]>>>24-x%4*8&255;c=(c+p[u]+f)%256;var v=p[u];p[u]=p[c],p[c]=v}this._i=this._j=0},_doProcessBlock:function(h,l){h[l]^=o.call(this)},keySize:256/32,ivSize:0});function o(){for(var h=this._S,l=this._i,d=this._j,p=0,u=0;u<4;u++){l=(l+1)%256,d=(d+h[l])%256;var c=h[l];h[l]=h[d],h[d]=c,p|=h[(h[l]+h[d])%256]<<24-u*8}return this._i=l,this._j=d,p}t.RC4=n._createHelper(a);var i=s.RC4Drop=a.extend({cfg:a.cfg.extend({drop:192}),_doReset:function(){a._doReset.call(this);for(var h=this.cfg.drop;h>0;h--)o.call(this)}});t.RC4Drop=n._createHelper(i)}(),e.RC4})});var uc=z((R0,oc)=>{O();j();(function(e,t,r){typeof R0=="object"?oc.exports=R0=t(de(),cr(),hr(),Zt(),Xe()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],t):t(e.CryptoJS)})(R0,function(e){return function(){var t=e,r=t.lib,n=r.StreamCipher,s=t.algo,a=[],o=[],i=[],h=s.Rabbit=n.extend({_doReset:function(){for(var d=this._key.words,p=this.cfg.iv,u=0;u<4;u++)d[u]=(d[u]<<8|d[u]>>>24)&16711935|(d[u]<<24|d[u]>>>8)&4278255360;var c=this._X=[d[0],d[3]<<16|d[2]>>>16,d[1],d[0]<<16|d[3]>>>16,d[2],d[1]<<16|d[0]>>>16,d[3],d[2]<<16|d[1]>>>16],x=this._C=[d[2]<<16|d[2]>>>16,d[0]&4294901760|d[1]&65535,d[3]<<16|d[3]>>>16,d[1]&4294901760|d[2]&65535,d[0]<<16|d[0]>>>16,d[2]&4294901760|d[3]&65535,d[1]<<16|d[1]>>>16,d[3]&4294901760|d[0]&65535];this._b=0;for(var u=0;u<4;u++)l.call(this);for(var u=0;u<8;u++)x[u]^=c[u+4&7];if(p){var f=p.words,v=f[0],y=f[1],m=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360,b=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,E=m>>>16|b&4294901760,P=b<<16|m&65535;x[0]^=m,x[1]^=E,x[2]^=b,x[3]^=P,x[4]^=m,x[5]^=E,x[6]^=b,x[7]^=P;for(var u=0;u<4;u++)l.call(this)}},_doProcessBlock:function(d,p){var u=this._X;l.call(this),a[0]=u[0]^u[5]>>>16^u[3]<<16,a[1]=u[2]^u[7]>>>16^u[5]<<16,a[2]=u[4]^u[1]>>>16^u[7]<<16,a[3]=u[6]^u[3]>>>16^u[1]<<16;for(var c=0;c<4;c++)a[c]=(a[c]<<8|a[c]>>>24)&16711935|(a[c]<<24|a[c]>>>8)&4278255360,d[p+c]^=a[c]},blockSize:128/32,ivSize:64/32});function l(){for(var d=this._X,p=this._C,u=0;u<8;u++)o[u]=p[u];p[0]=p[0]+1295307597+this._b|0,p[1]=p[1]+3545052371+(p[0]>>>0<o[0]>>>0?1:0)|0,p[2]=p[2]+886263092+(p[1]>>>0<o[1]>>>0?1:0)|0,p[3]=p[3]+1295307597+(p[2]>>>0<o[2]>>>0?1:0)|0,p[4]=p[4]+3545052371+(p[3]>>>0<o[3]>>>0?1:0)|0,p[5]=p[5]+886263092+(p[4]>>>0<o[4]>>>0?1:0)|0,p[6]=p[6]+1295307597+(p[5]>>>0<o[5]>>>0?1:0)|0,p[7]=p[7]+3545052371+(p[6]>>>0<o[6]>>>0?1:0)|0,this._b=p[7]>>>0<o[7]>>>0?1:0;for(var u=0;u<8;u++){var c=d[u]+p[u],x=c&65535,f=c>>>16,v=((x*x>>>17)+x*f>>>15)+f*f,y=((c&4294901760)*c|0)+((c&65535)*c|0);i[u]=v^y}d[0]=i[0]+(i[7]<<16|i[7]>>>16)+(i[6]<<16|i[6]>>>16)|0,d[1]=i[1]+(i[0]<<8|i[0]>>>24)+i[7]|0,d[2]=i[2]+(i[1]<<16|i[1]>>>16)+(i[0]<<16|i[0]>>>16)|0,d[3]=i[3]+(i[2]<<8|i[2]>>>24)+i[1]|0,d[4]=i[4]+(i[3]<<16|i[3]>>>16)+(i[2]<<16|i[2]>>>16)|0,d[5]=i[5]+(i[4]<<8|i[4]>>>24)+i[3]|0,d[6]=i[6]+(i[5]<<16|i[5]>>>16)+(i[4]<<16|i[4]>>>16)|0,d[7]=i[7]+(i[6]<<8|i[6]>>>24)+i[5]|0}t.Rabbit=n._createHelper(h)}(),e.Rabbit})});var cc=z((N0,fc)=>{O();j();(function(e,t,r){typeof N0=="object"?fc.exports=N0=t(de(),cr(),hr(),Zt(),Xe()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],t):t(e.CryptoJS)})(N0,function(e){return function(){var t=e,r=t.lib,n=r.StreamCipher,s=t.algo,a=[],o=[],i=[],h=s.RabbitLegacy=n.extend({_doReset:function(){var d=this._key.words,p=this.cfg.iv,u=this._X=[d[0],d[3]<<16|d[2]>>>16,d[1],d[0]<<16|d[3]>>>16,d[2],d[1]<<16|d[0]>>>16,d[3],d[2]<<16|d[1]>>>16],c=this._C=[d[2]<<16|d[2]>>>16,d[0]&4294901760|d[1]&65535,d[3]<<16|d[3]>>>16,d[1]&4294901760|d[2]&65535,d[0]<<16|d[0]>>>16,d[2]&4294901760|d[3]&65535,d[1]<<16|d[1]>>>16,d[3]&4294901760|d[0]&65535];this._b=0;for(var x=0;x<4;x++)l.call(this);for(var x=0;x<8;x++)c[x]^=u[x+4&7];if(p){var f=p.words,v=f[0],y=f[1],m=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360,b=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,E=m>>>16|b&4294901760,P=b<<16|m&65535;c[0]^=m,c[1]^=E,c[2]^=b,c[3]^=P,c[4]^=m,c[5]^=E,c[6]^=b,c[7]^=P;for(var x=0;x<4;x++)l.call(this)}},_doProcessBlock:function(d,p){var u=this._X;l.call(this),a[0]=u[0]^u[5]>>>16^u[3]<<16,a[1]=u[2]^u[7]>>>16^u[5]<<16,a[2]=u[4]^u[1]>>>16^u[7]<<16,a[3]=u[6]^u[3]>>>16^u[1]<<16;for(var c=0;c<4;c++)a[c]=(a[c]<<8|a[c]>>>24)&16711935|(a[c]<<24|a[c]>>>8)&4278255360,d[p+c]^=a[c]},blockSize:128/32,ivSize:64/32});function l(){for(var d=this._X,p=this._C,u=0;u<8;u++)o[u]=p[u];p[0]=p[0]+1295307597+this._b|0,p[1]=p[1]+3545052371+(p[0]>>>0<o[0]>>>0?1:0)|0,p[2]=p[2]+886263092+(p[1]>>>0<o[1]>>>0?1:0)|0,p[3]=p[3]+1295307597+(p[2]>>>0<o[2]>>>0?1:0)|0,p[4]=p[4]+3545052371+(p[3]>>>0<o[3]>>>0?1:0)|0,p[5]=p[5]+886263092+(p[4]>>>0<o[4]>>>0?1:0)|0,p[6]=p[6]+1295307597+(p[5]>>>0<o[5]>>>0?1:0)|0,p[7]=p[7]+3545052371+(p[6]>>>0<o[6]>>>0?1:0)|0,this._b=p[7]>>>0<o[7]>>>0?1:0;for(var u=0;u<8;u++){var c=d[u]+p[u],x=c&65535,f=c>>>16,v=((x*x>>>17)+x*f>>>15)+f*f,y=((c&4294901760)*c|0)+((c&65535)*c|0);i[u]=v^y}d[0]=i[0]+(i[7]<<16|i[7]>>>16)+(i[6]<<16|i[6]>>>16)|0,d[1]=i[1]+(i[0]<<8|i[0]>>>24)+i[7]|0,d[2]=i[2]+(i[1]<<16|i[1]>>>16)+(i[0]<<16|i[0]>>>16)|0,d[3]=i[3]+(i[2]<<8|i[2]>>>24)+i[1]|0,d[4]=i[4]+(i[3]<<16|i[3]>>>16)+(i[2]<<16|i[2]>>>16)|0,d[5]=i[5]+(i[4]<<8|i[4]>>>24)+i[3]|0,d[6]=i[6]+(i[5]<<16|i[5]>>>16)+(i[4]<<16|i[4]>>>16)|0,d[7]=i[7]+(i[6]<<8|i[6]>>>24)+i[5]|0}t.RabbitLegacy=n._createHelper(h)}(),e.RabbitLegacy})});var lc=z((H0,hc)=>{O();j();(function(e,t,r){typeof H0=="object"?hc.exports=H0=t(de(),xn(),lf(),vf(),cr(),hr(),a0(),Zs(),Sf(),Qs(),Ef(),Af(),Cf(),v0(),Df(),Zt(),Xe(),Hf(),Of(),qf(),kf(),Vf(),Uf(),Wf(),Xf(),Yf(),Zf(),ec(),rc(),ic(),ac(),uc(),cc()):typeof define=="function"&&define.amd?define(["./core","./x64-core","./lib-typedarrays","./enc-utf16","./enc-base64","./md5","./sha1","./sha256","./sha224","./sha512","./sha384","./sha3","./ripemd160","./hmac","./pbkdf2","./evpkdf","./cipher-core","./mode-cfb","./mode-ctr","./mode-ctr-gladman","./mode-ofb","./mode-ecb","./pad-ansix923","./pad-iso10126","./pad-iso97971","./pad-zeropadding","./pad-nopadding","./format-hex","./aes","./tripledes","./rc4","./rabbit","./rabbit-legacy"],t):e.CryptoJS=t(e.CryptoJS)})(H0,function(e){return e})});var dc=z(yt=>{"use strict";O();j();var U2=yt&&yt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),z2=yt&&yt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),W2=yt&&yt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&U2(t,e,r);return z2(t,e),t};Object.defineProperty(yt,"__esModule",{value:!0});yt.decrypt=yt.encrypt=void 0;var Vt=W2(lc());function G2(e,t){let r=Vt.enc.Utf8.parse(t);return Vt.AES.encrypt(e,r,{iv:r,mode:Vt.mode.CBC,padding:Vt.pad.Pkcs7}).toString()}yt.encrypt=G2;function X2(e,t){let r=Vt.enc.Utf8.parse(t);return Vt.AES.decrypt(e,r,{iv:r,mode:Vt.mode.CBC,padding:Vt.pad.Pkcs7}).toString(Vt.enc.Utf8)}yt.decrypt=X2});var pc=z(Ae=>{"use strict";O();j();var J2=Ae&&Ae.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Y2=Ae&&Ae.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),$2=Ae&&Ae.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&J2(t,e,r);return Y2(t,e),t};Object.defineProperty(Ae,"__esModule",{value:!0});Ae.wrapPEM=Ae.unwrapPEM=Ae.covertPublicKeyFromPkcs8ToPkcs1=Ae.covertPublicKeyFromPkcs8ToPkix=Ae.genKeyPair=Ae.decodeAny=Ae.encodeAny=Ae.decode=Ae.encode=void 0;var he=$2(ks()),Z2=he.BigInteger,T0=Ys(),Q2=$s();function ea(e,t){let r=he.KJUR.crypto.Cipher.encrypt(e,t,"RSA");return(0,T0.fromHex)(r)}Ae.encode=ea;function ta(e,t){return he.KJUR.crypto.Cipher.decrypt(e,t,"RSA")}Ae.decode=ta;function ep(e,t){let r=ip(t),n=Math.floor((r.n.bitLength()+7)/8),s=e.length,a=0,o=n-11,i=[];for(;;){if(a+o>=s){let l=ea(e.slice(a),r);i.push(l);break}let h=ea(e.slice(a,a+o),r);i.push(h),a+=o}return he.hextob64((0,T0.toHex)(V.Buffer.concat(i)))}Ae.encodeAny=ep;function tp(e,t){let r=he.RSAKey.getHexValueArrayOfChildrenFromHex(he.b64tohex(t)),n=new he.RSAKey;n.setPrivateEx(r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8]);let s=Math.floor((n.n.bitLength()+7)/8),a=(0,Q2.fromBase64)(e),o=a.length,i=0,h=[];for(;;){if(i+s>=o){let d=ta((0,T0.toHex)(a.slice(i)),n);h.push(d);break}let l=ta((0,T0.toHex)(a.slice(i,i+s)),n);h.push(l),i+=s}return h.join("")}Ae.decodeAny=tp;function rp(e){let t=he.KEYUTIL.generateKeypair("RSA",e),r=he.KEYUTIL.getPEM(t.prvKeyObj,"PKCS1PRV"),n=he.KEYUTIL.getPEM(t.pubKeyObj),s=vc(ra(n,!0));return{privateKey:ra(r,!1),publicKey:s}}Ae.genKeyPair=rp;function np(e){let t=he.KEYUTIL.getKey(na(e,!0)),r=new he.KJUR.asn1.DERSequence({array:[new he.KJUR.asn1.DERObjectIdentifier({oid:"1.2.840.113549.1.1.1"}),new he.KJUR.asn1.DERNull]}),n=new he.KJUR.asn1.DERSequence({array:[new he.KJUR.asn1.DERInteger({bigint:t.n}),new he.KJUR.asn1.DERInteger({int:t.e})]}),s=new he.KJUR.asn1.DERBitString({hex:"00"+n.getEncodedHex()}),a=new he.KJUR.asn1.DERSequence({array:[r,s]});return he.hextob64(a.getEncodedHex())}Ae.covertPublicKeyFromPkcs8ToPkix=np;function vc(e){let t=he.KEYUTIL.getKey(na(e,!0)),r=new he.KJUR.asn1.DERSequence({array:[new he.KJUR.asn1.DERInteger({bigint:t.n}),new he.KJUR.asn1.DERInteger({int:t.e})]});return he.hextob64(r.getEncodedHex())}Ae.covertPublicKeyFromPkcs8ToPkcs1=vc;function ip(e){let t=he.b64tohex(e);if(!he.ASN1HEX.isASN1HEX(t))throw new Error("keyHex is not ASN.1 hex string");let r=he.ASN1HEX.getChildIdx(t,0),n=new he.RSAKey,s=he.ASN1HEX.getV(t,r[0]);n.n=new Z2(s,16);let a=he.ASN1HEX.getV(t,r[1]);return n.e=parseInt(a,16),n.isPublic=!0,n.isPrivate=!1,n}function ra(e,t){let r=t?"PUBLIC KEY":"RSA PRIVATE KEY";return he.hextob64(he.pemtohex(e,r))}Ae.unwrapPEM=ra;function na(e,t){let r=t?"PUBLIC KEY":"RSA PRIVATE KEY";return he.hextopem(he.b64tohex(e),r)}Ae.wrapPEM=na});var ia=z(tt=>{"use strict";O();j();var xc=tt&&tt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),sp=tt&&tt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),gc=tt&&tt.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&xc(t,e,r)},yc=tt&&tt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&xc(t,e,r);return sp(t,e),t};Object.defineProperty(tt,"__esModule",{value:!0});tt.rsa=tt.aes=void 0;gc(Ys(),tt);gc($s(),tt);tt.aes=yc(dc());tt.rsa=yc(pc())});var bc=z(mt=>{"use strict";O();j();Object.defineProperty(mt,"__esModule",{value:!0});mt.RSADecodeQRCodeInfo=mt.RSAEncodeQRCodeInfo=mt.GenRSAKeyForQRCode=mt.AesDecodeQRCodeInfo=mt.AesEncodeQRCodeInfo=void 0;var sa=Ee(),Hr=ia(),mc=sa.base.md5.encode("1677594506944"),ap=2048;function op(e,t){if(e.length===0)throw new Error("message is empty");if(t.length===0)throw new Error("accountId is empty");let r=Sc(t);return Hr.aes.encrypt(e,r)}mt.AesEncodeQRCodeInfo=op;function up(e,t){if(e.length===0)throw new Error("secret is empty");if(t.length===0)throw new Error("accountId is empty");let r=Sc(t);return Hr.aes.decrypt(e,r)}mt.AesDecodeQRCodeInfo=up;async function fp(){return Promise.resolve(Hr.rsa.genKeyPair(ap))}mt.GenRSAKeyForQRCode=fp;async function cp(e,t){return Promise.resolve(Hr.rsa.encodeAny(e,t))}mt.RSAEncodeQRCodeInfo=cp;async function hp(e,t){return Promise.resolve(Hr.rsa.decodeAny(e,t))}mt.RSADecodeQRCodeInfo=hp;function Sc(e){let t=Hr.aes.encrypt(e,sa.base.md5.encode(mc));return sa.base.md5.encode(mc+t)}});var wc=z(O0=>{"use strict";O();j();Object.defineProperty(O0,"__esModule",{value:!0});O0.getCoinHexKeyStringFromShareString=void 0;var aa=Pt();async function lp(e,t){let r=(0,aa.JsonParseBigInt)(e),n=BigInt(r.ecdsaShare2.ShareI.toString()),s=n.toString(16);if(t&&t.length==3){let a=r.ecdsaShare2.ChainCode.toString(),o=new aa.ECPoint(r.ecdsaShare2.PublicKey.Curve,BigInt(r.ecdsaShare2.PublicKey.X.toString()),BigInt(r.ecdsaShare2.PublicKey.Y.toString())),[i,h]=await(0,aa.bip32Derive)([t[0],t[1],t[2]],n,o,a);s=i.toString(16)}return s.length%2==1&&(s="0"+s),s}O0.getCoinHexKeyStringFromShareString=lp});var Ec=z(St=>{"use strict";O();j();var dp=St&&St.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Tr=St&&St.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&dp(t,e,r)};Object.defineProperty(St,"__esModule",{value:!0});Tr(Gs(),St);Tr(sf(),St);Tr(af(),St);Tr(bc(),St);Tr(Ls(),St);Tr(wc(),St)});var Pc=z(j0=>{"use strict";O();j();Object.defineProperty(j0,"__esModule",{value:!0});j0.getMidKey=void 0;var oa=Pt(),vp=Ee();function pp(e){return e.startsWith("0x")&&(e=e.substring(2)),V.Buffer.from(e,"hex")}async function xp(e,t){let r=(0,oa.JsonParseBigInt)(e),n=r.ecdsaShare2.PublicKey,s=r.ecdsaShare2.ChainCode,a=new oa.ECPoint(n.Curve,BigInt(n.X.toString()),BigInt(n.Y.toString())),[o,i]=await(0,oa.bip32Derive)([0,t.valueOf(),0],0n,a,s,0),h=i.toHex(),l=pp(h);return vp.base.sha256(l)}j0.getMidKey=xp});var of=z(rt=>{O();j();var Ac=rt&&rt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),gp=rt&&rt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),q0=rt&&rt.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&Ac(t,e,r)},yp=rt&&rt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Ac(t,e,r);return gp(t,e),t};Object.defineProperty(rt,"__esModule",{value:!0});rt.base=void 0;q0(gn(),rt);q0(Ec(),rt);q0(lr(),rt);q0(Pc(),rt);rt.base=yp(ia())});export{of as a};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "prepub";

//# sourceMappingURL=chunk-DYBOX26H.js.map
