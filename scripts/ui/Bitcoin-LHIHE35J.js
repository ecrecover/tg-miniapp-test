import{a as Qo}from"./chunk-QJYMCODD.js";import{a as jo}from"./chunk-J7WTXBCA.js";import{a as $o}from"./chunk-DTYLEM3V.js";import{a as Jo}from"./chunk-PSJFSVFM.js";import{a as Ko}from"./chunk-MYKMM3H4.js";import{a as Go}from"./chunk-QTGHH5WR.js";import{g as Xo,j as zo,k as qo,l as Zo,m as Ho,n as Vo}from"./chunk-W4ZU5OVY.js";import"./chunk-OBBTCULP.js";import"./chunk-IKTFX5VA.js";import{a as Se,b as Ae}from"./chunk-AEQXVQW6.js";import{a as Ro}from"./chunk-3G5IAADG.js";import{a as we}from"./chunk-NHHEXXPU.js";import"./chunk-WUFX5FIX.js";import{a as Ie}from"./chunk-5WLVDQXN.js";import"./chunk-TAIMVZA3.js";import"./chunk-XHGDRCKN.js";import"./chunk-MJY6W4GC.js";import"./chunk-5KKHZTOM.js";import{a as re}from"./chunk-EKXTRWYR.js";import{a as Ne,b as Ee}from"./chunk-W22RY77F.js";import{b as Yt,f as ye,h as vo,i as Oo,j as ge,l as Ce,o as Do,p as Uo,q as Wo}from"./chunk-HTDEED7X.js";import"./chunk-WQ5TWFR7.js";import"./chunk-A7BL4T7A.js";import"./chunk-AQEDLRCW.js";import{a as Te}from"./chunk-JXXKPVB7.js";import{d as Mo}from"./chunk-3LOAATWV.js";import"./chunk-OR3IMHNP.js";import{c as ko}from"./chunk-G2LUKHAZ.js";import"./chunk-BITK2ZRS.js";import"./chunk-FC47KHHQ.js";import"./chunk-NWBT27VI.js";import{a as ne}from"./chunk-ERRJFVON.js";import"./chunk-AGNEMUCC.js";import{a as Yo,b as oe,c as qe,d as G,e as Rt,g as j}from"./chunk-SFY37WOS.js";import"./chunk-7GRBMPLB.js";import"./chunk-H2MP374E.js";import{e as Y}from"./chunk-JFCE4WMN.js";import"./chunk-2CQDB45Y.js";import{b as ee}from"./chunk-TCY2QN26.js";import"./chunk-TAMFXRQS.js";import"./chunk-SWNKITDG.js";import{a as Fo}from"./chunk-PCT6WF3F.js";import"./chunk-7G3IOU2S.js";import"./chunk-FSSAJWUE.js";import"./chunk-EYUJFPID.js";import"./chunk-QXSGLFJ4.js";import"./chunk-LTVFH3JK.js";import"./chunk-UX45LV4J.js";import"./chunk-S2L2SUZT.js";import"./chunk-WAOH7NV4.js";import{e as Lt,h as Lo}from"./chunk-Z7MVEL6Q.js";import"./chunk-EQQ4TY26.js";import{c as _t}from"./chunk-BSJ5U7SB.js";import"./chunk-RQ4URFJV.js";import"./chunk-A7QDOMG2.js";import"./chunk-PCN4TJH3.js";import"./chunk-UV4CBWDM.js";import{l as Qt,m as te}from"./chunk-JZYFGUUR.js";import"./chunk-55MBPFME.js";import"./chunk-ITV6J4J2.js";import"./chunk-E4R5GU2A.js";import{a as tn}from"./chunk-CTYUELJA.js";import"./chunk-PAA53NMF.js";import"./chunk-GEYEJT2N.js";import"./chunk-3HN2WM7L.js";import"./chunk-3OA7XW3I.js";import{b as bo}from"./chunk-MVELXHVO.js";import"./chunk-YFG3KJV4.js";import"./chunk-QAD7XKBR.js";import"./chunk-FSHQROIB.js";import"./chunk-RSZRDNEQ.js";import{b as et}from"./chunk-LWWOGE47.js";import{g as Bo}from"./chunk-PNKC4I7V.js";import"./chunk-OBDMMZ5P.js";import"./chunk-AWV3UGPG.js";import"./chunk-ZFY6KTVJ.js";import"./chunk-LQ6EG3M7.js";import"./chunk-EFXUUWZM.js";import"./chunk-SXT2HSEA.js";import"./chunk-X6MJ7FAJ.js";import"./chunk-4QGZMEGU.js";import"./chunk-JGVOOQUI.js";import{q as $,r as it}from"./chunk-OL5PZGTP.js";import{a as ze}from"./chunk-T6BAWHSV.js";import"./chunk-NZFRZUU7.js";import"./chunk-GKPU7ZYD.js";import"./chunk-IY5XPXLD.js";import"./chunk-N6T7YZKN.js";import"./chunk-CE2I3GSK.js";import"./chunk-SPMBQ3GG.js";import{d as ho}from"./chunk-W3BHXSAD.js";import"./chunk-KWEOQTFQ.js";import"./chunk-MYLTZKPJ.js";import"./chunk-RAK5MQVM.js";import{l as Po}from"./chunk-ILYGYWTN.js";import"./chunk-HOK5U34D.js";import"./chunk-XPB5VA3I.js";import"./chunk-XSNWL3NI.js";import"./chunk-IOMWHGY3.js";import"./chunk-EDYYUNM2.js";import"./chunk-FOI3TQUA.js";import"./chunk-Y3W2FGGC.js";import"./chunk-6SKAHEOE.js";import"./chunk-QYGNKIL6.js";import"./chunk-WWF4GAYE.js";import"./chunk-YITM3H6Z.js";import"./chunk-IQFXZKFW.js";import"./chunk-7BFUGHAL.js";import"./chunk-JVN7YJ6W.js";import"./chunk-VSX7BSN7.js";import{a as Pt}from"./chunk-V4V6C6NY.js";import{b as tt}from"./chunk-ZQ5A3KPQ.js";import{a as Jt}from"./chunk-BGUY7SH3.js";import{h as fo,w as C}from"./chunk-MJYAUOKI.js";import{a as Kn}from"./chunk-LI3NFLG3.js";import{a as Xe,c as xe,l as Eo,o as ht,y as So}from"./chunk-FCCCJLF6.js";import{a as Wt}from"./chunk-4Z4GXCHB.js";import{k as Ye,l as de,n as mo,o as po,y as Kt}from"./chunk-FK3ETA6I.js";import{H as V,V as No,X as bt,b as P,c as Io,ga as It,i as wo}from"./chunk-QZDHFNHK.js";import"./chunk-24PQFN5C.js";import{a as xo}from"./chunk-6KPQELH2.js";import{a as Re}from"./chunk-EJQOS3F4.js";import{k as me,o as Ao}from"./chunk-LHHZ5TAA.js";import"./chunk-PI6QLVMS.js";import"./chunk-QY4HIIR3.js";import"./chunk-XFWUEPSK.js";import{d as co,f as jn}from"./chunk-MNNY2ODL.js";import"./chunk-VCAWL4NW.js";import"./chunk-XVIU24G2.js";import{a as Jn}from"./chunk-WHHFO6J4.js";import"./chunk-2LDYLNUY.js";import"./chunk-KCITCUTL.js";import"./chunk-YZ3HCB4K.js";import"./chunk-EZ7VUFME.js";import"./chunk-T2OWRX3Y.js";import{f as uo,h as _o}from"./chunk-C3FJ2D4V.js";import"./chunk-C5ZJZEPI.js";import"./chunk-LGHM3MOC.js";import"./chunk-2FULUWWG.js";import"./chunk-SLEUZTBQ.js";import"./chunk-4X6ZAX3L.js";import{c as u}from"./chunk-4QSQKIBZ.js";import{b as lo,c as $n}from"./chunk-OXVQDEZW.js";import{g as ao,m as Hn}from"./chunk-X3G52GGX.js";import"./chunk-WUKT6J7S.js";import"./chunk-FTJCOLFJ.js";import{Ea as io,Jc as Ut,Kb as Vn,Tc as Ge,Xc as To,Yc as yo,Zc as go,_c as Co,hb as Zn,ib as We,va as so,za as qn}from"./chunk-QG673PNL.js";import"./chunk-ZUFARSFM.js";import{F as eo,G as oo,M as Ue,N as no,T as ro,c as Dt,n as jt,o as De,x as to}from"./chunk-6MTHEPGF.js";import{I as Q,m as B,w as r}from"./chunk-ZQQ7HNWV.js";import"./chunk-Y62GSKHT.js";import"./chunk-2BXFMFMK.js";import{M as fe,S as Qe,Y as st,c as _e}from"./chunk-ZOQTSYT4.js";import{a as W}from"./chunk-ADZWCU3Q.js";import"./chunk-AXQY4CD5.js";import"./chunk-ZPRPROG4.js";import"./chunk-FDI7TLXH.js";import"./chunk-L4HTIIR6.js";import"./chunk-733NI6T7.js";import"./chunk-5TB3ZTAO.js";import"./chunk-EYWGNJVY.js";import"./chunk-PIGJQYQ3.js";import"./chunk-7TSJ7C24.js";import"./chunk-DW2DZMT3.js";import"./chunk-YSXN7JDZ.js";import"./chunk-TBVIGR5T.js";import"./chunk-FHQVMQUK.js";import"./chunk-XNS2NFYY.js";import{f as T,m as i,n as g,o as a}from"./chunk-REC7XVZY.js";i();a();var Et=T(W());i();a();var Be=T(W());Q();i();a();var en=({unapproved:t})=>Be.default.createElement(u.Container,null,Be.default.createElement(Pt,{title:r("wallet_trade_maintitle_transaction_confirm"),backable:!1,closeable:!1}),Be.default.createElement(Go,{unapproved:t}));i();a();var I=T(W()),on=T(Kt());Q();jn();var Qn=({unapproved:t})=>{let e=t?.localType,o=_t({localType:e})?.coinId,s=Lt(o),l=(0,on.useDispatch)(),c=t.walletId,f=t.params.transaction.from,y=te(c),w=t.params.transaction.amount||2,[,x]=Te({coinId:o,address:f,chainId:s?.chainId}),z=x?.transferReminder,m=x?.dummyOutput,[p,N]=(0,I.useState)({level:bt.STANDARD,satBytes:x?.normal}),U=p?.satBytes;(0,I.useEffect)(()=>{if(!U&&x?.normal&&N({level:bt.STANDARD,satBytes:x?.normal}),U&&p?.level!==bt.CUSTOM){let Z=x[Ne[p?.level]?.satBytes];N({...p,satBytes:Z})}},[x]);let[M,{toggle:v}]=ht(!1),[E,{set:k}]=ht(!1),[h,{set:F}]=ht(!1),[O,q]=(0,I.useState)(),[S,ot]=ge({coinId:o,walletId:c,address:f,batchDummyNum:w,utxoType:Yt.SPLIT_UTXO}),[St,A,xt]=Oo({coinId:o,walletId:c,address:f,networkFee:O,utxoType:Yt.SPLIT_UTXO,batchDummyNum:w,coinAmount:B.mul(m,w)},{ready:!!m}),nt=(0,I.useMemo)(()=>A.findIndex(({dummy:Z})=>Z!==!0),[A]),lt=(0,I.useMemo)(()=>nt===-1?[]:A.slice(nt),[nt,A]),rt=(0,I.useMemo)(()=>nt===-1?0:Math.max(w-nt,0),[w,nt]),gt=B.gt(rt,0),Xt=B.mul(m,rt),K=Do({coinId:o,fromAddr:f,satBytes:U}),ct=(0,I.useCallback)(async()=>{try{if(!U)return;k(!0);let Z=await K({inputs:lt,outputs:Array.from({length:rt}).map(()=>({address:f,amount:m}))});F(!1),q(Z)}catch{F(!0)}finally{k(!1)}},[m,K,f,lt,rt,U,F,k]);(0,I.useEffect)(()=>{ct()},[ct]);let mt=(0,I.useMemo)(()=>ot===void 0||!O?!0:B.gt(ot,O),[ot,O]),zt=(0,I.useMemo)(()=>y?{type:j.TIP_TYPE.COMMON_ERROR,message:r("wallet_extension_top_toast_dapp_comingsoon")}:h?{type:j.TIP_TYPE.FEE_ERROR}:mt?{type:Dt.TYPE.warn,message:z}:{coinId:o,type:j.TIP_TYPE.FEE_BALANCE_INSUFFICIENT},[o,h,y,mt,z]),At=Mo({coinId:o,walletId:c,coinAmount:0,fromAddr:f,toAddr:f,localType:s?.localType,networkFee:O,extJson:JSON.stringify({}),txSource:Ut.DAPP,txType:P.BTC_SPLIT_UTXO}),Ct=Ce({coinId:o,txType:P.BTC_SPLIT_UTXO,address:f}),J=Qt(c),[Mt,vt]=(0,I.useState)(!1),qt=(0,I.useCallback)(async()=>{await l($(t.id)),await l(et()),vt(!1)},[l,t.id]),Zt=(0,I.useCallback)(async()=>{if(gt)try{if(!await ee({walletId:c,callback:async()=>{await l($(t.id))}}))return;await Ct(lt),vt(!0);let{signed:Ot,utxos:Me}=await co().splitUtxo({splitAmount:rt,inputs:ye(lt),amount:m,feePerB:p.satBytes},f,c);await At(Ot);let ve=A.filter(Ht=>Ht.dummy),Oe=[...ye(ve),...Me.map(Ht=>({...Ht,rawTransaction:Ot}))];await l(it(t.id,{utxos:Oe}))}catch(Z){console.log(Z)}finally{vt(!1)}else{let Z=A.slice(0,w);await l(it(t.id,{utxos:ye(Z)}))}},[w,l,m,A,f,gt,lt,At,rt,p.satBytes,t.id,Ct,c]),le=(0,I.useMemo)(()=>{let Z={actionType:Y.ACTION_TYPE.CANCEL,btnText:r("wallet_dapp_connection_btn_reject"),onClick:qt},Ot={actionType:Y.ACTION_TYPE.CONFIRM,disabled:S||E||St||h||xt||!Number(O)||y,onClick:Zt};return mt||(Ot={coinId:o,walletId:c,address:f,actionType:Y.ACTION_TYPE.FILL_UP}),[Z,Ot]},[o,O,h,E,f,y,mt,S,qt,Zt,xt,St,c]);return I.default.createElement(u.Container,null,I.default.createElement(Pt,{backable:!1,closeable:!1,title:r("wallet_extension_send_title_send")}),I.default.createElement(G,null,I.default.createElement(oe,{title:r("wallet_extension_send_colored_send"),summaryList:[{coinId:o,coinAmount:Xt}]})),I.default.createElement(G,null,I.default.createElement(Rt,{walletId:c,address:f,title:r("wallet_extension_network_address_title_walletused")},!!ot&&I.default.createElement(Se,{coinBalance:ot,tooltip:r("extension_defi_bot_popuptext_avail_amount"),coinId:o}))),I.default.createElement(G,{bordered:!1},I.default.createElement(ne,{coinId:o,loading:E,feeError:h,networkFee:O,onClick:v})),I.default.createElement(Jt,{placeholder:!0,offsetBottom:0,borderTop:!0},I.default.createElement(j,{coinId:o,...zt}),I.default.createElement(Y,{buttonGroup:le})),I.default.createElement(Ee,{coinId:o,visible:M,signInfo:x,value:p,estimatedFee:O,onChange:N,onToggleVisible:v}),I.default.createElement(Ae,{visible:J&&Mt}))},nn=Qn;i();a();var rn=T(W());var sn=({unapproved:t})=>{let e=t.params?.message,n=Qo({unapproved:t});return rn.default.createElement(Ko,{needCheckMpc:!0,message:e,unapproved:t,tipMessage:n})};i();a();var yt=T(W()),an=T(Kt()),ln=T(Re());Zn();i();a();var Gt={AMOUNT:1,CONFIRM:2};var Ze=Gt.AMOUNT;function tr({unapproved:t}){let{from:e,type:n=P.BRC20_INSCRIBE,tick:o="",tid:s,amount:l,txSource:c=Ut.DAPP}=t?.params?.transaction||{},f=t?.localType||io,[y,w]=(0,yt.useState)(Ze),x=(0,an.useDispatch)(),z=(0,ln.useHistory)(),p=+_t({localType:f})?.netWorkId,N=xe(()=>n===P.BRC20_INSCRIBE?{chainId:p,coinType:de(p),symbol:o}:null,[n,s,o,p]),M=Lt(void 0,{},N)?.coinId,v=(0,yt.useCallback)(async()=>{await x($(t.id)),await x(et()),z.push(Wt)},[x,z,t.id]),E=(0,yt.useCallback)(()=>{w(Gt.CONFIRM),Ze=Gt.CONFIRM},[]),k=(0,yt.useCallback)(async({txIds:F,commitTx:O,revealTxs:q})=>{await x(it(t.id,{txIds:F,commitTx:O,revealTxs:q})),await x(et()),z.push(Wt)},[x,z,t.id]),h=(0,yt.useCallback)(()=>{w(Gt.AMOUNT),Ze=Gt.AMOUNT},[]);return yt.default.createElement(Xo,{fromAddress:e,coinId:M},y===Gt.AMOUNT?yt.default.createElement(Ho,{amount:l,walletId:t.walletId,onCancel:v,onConfirm:E,headerProps:{closeable:!1,backable:!1}}):yt.default.createElement(Vo,{txSource:c,onCancel:v,onConfirm:k,walletId:t.walletId,headerProps:{onBack:h,closeable:!1,backable:!0}}))}var cn=tr;i();a();var _=T(W()),Pn=T(Kt()),Ln=T(Re());Q();i();a();var He=T(W());i();a();function mn(t=[]){if(!Array.isArray(t))throw new Error("assetChange should be an array");return t.map(e=>{let{direction:n,amount:o,usdAmount:s,symbol:l,logo:c}=e;return{operator:n===1?"+":"-",usdValue:s,rawValue:o,asset:{assetType:ko.NATIVE,amount:o,symbol:l,imageUrl:c}}})}var er=({address:t,hexStringList:e=[],chainIndex:n=0},o={})=>{let s=e?.toString(),l={ready:n!==void 0&&!!e?.length,refreshDeps:[t,s,n],...o},{loading:c,data:f,error:y}=Eo(async()=>(await Po({address:t,hexStringList:e,chainIndex:n})).data,l);return{loading:c,data:f,error:y}},or=t=>(0,He.useMemo)(()=>!t||!t.length?[]:t.map(e=>{let{assetChange:n=[],assetInversion:o}=e;return{status:e.analysisStatus,gasFee:e?.gasFee||0,exploreUrl:e?.exploreUrl,inputInfo:e?.inputInfo||[],outputInfo:e?.outputInfo||[],assetChange:mn(n),assetInversion:o||!1}}),[t]),nr=(t=[])=>(0,He.useMemo)(()=>!t||!t.length?null:t.some(n=>n.status>0)?It.EXECUTE_ERROR:null,[t]);function pn(t={},e={}){let{loading:n,data:o,error:s}=er(t,e),{utxoAllInfos:l}=o||{},c=or(l),f=nr(c);return{loading:n,error:s||f,data:c}}i();a();var d=T(W()),ie=T(_e());Q();i();a();var se=T(W());var _n=T(Kn());Q();i();a();var un={address:"_address_11ipy_1"};function Ve({children:t,addresses:e=[],exploreUrl:n=""}){let o=e[0],s=Xe(()=>{(0,_n.default)(o),eo.success({title:r("wallet_receive_toast_address_copied"),desc:""})},[o]),l=Xe(()=>{n&&globalThis.platform.openTab({url:`${n}${o}`})},[o,n]);return e.length>1?t:se.default.createElement(De.WhiteBoard,{rebirthPopper:!0,popupStyle:{marginLeft:16,marginRight:16,padding:12,borderRadius:8},content:se.default.createElement(u.FlexBox,{align:u.ALIGN.center,justify:"center"},se.default.createElement(C.Text,{forceWrap:!0,size:C.SIZE.sm,className:un.address},o),se.default.createElement(tt,{size:tt.SIZE.xs,icon:"okds-copy",onClick:s,style:{marginLeft:8}}),se.default.createElement(tt,{size:tt.SIZE.sm,icon:"okx-wallet-plugin-open-link",onClick:l,style:{marginLeft:8}})),trigger:De.TRIGGER.hover},t)}i();a();function $e(t){return t===To.XRC_NFT}i();a();var L={content:"_content_1i550_1",none:"_none_1i550_4",title:"_title_1i550_10",input:"_input_1i550_15",utxoContainer:"_utxoContainer_1i550_18",isCurrentAddr:"_isCurrentAddr_1i550_18",signTag:"_signTag_1i550_18",addrContainer:"_addrContainer_1i550_24",address:"_address_1i550_29",amount:"_amount_1i550_38",xrcAssetsContainer:"_xrcAssetsContainer_1i550_50",xrcAssetsTitle:"_xrcAssetsTitle_1i550_56",xrcAssetContainer:"_xrcAssetContainer_1i550_62",logo:"_logo_1i550_65",isNFT:"_isNFT_1i550_72",isNft:"_isNFT_1i550_72",amountText:"_amountText_1i550_75",protocol:"_protocol_1i550_78",moreXRCContainer:"_moreXRCContainer_1i550_85",moreXrcContainer:"_moreXRCContainer_1i550_85",showMoreTitle:"_showMoreTitle_1i550_89",moreAssetsLogos:"_moreAssetsLogos_1i550_95",moreAssetsLogo:"_moreAssetsLogo_1i550_95",expandContainer:"_expandContainer_1i550_106",expandContainer_title:"_expandContainer_title_1i550_110",expandContainerTitle:"_expandContainer_title_1i550_110",expandContainer_leftTotal:"_expandContainer_leftTotal_1i550_116",expandContainerLeftTotal:"_expandContainer_leftTotal_1i550_116",expandContainer_icon:"_expandContainer_icon_1i550_123",expandContainerIcon:"_expandContainer_icon_1i550_123"};var je="inputInfo",fn="outputInfo",be={xrcAsset:10,utxo:50},rr=({coinId:t,data:e={},currentAddr:n})=>{let[o,s]=(0,d.useState)({}),[,l]=Lo(t,{withPrice:!0}),c=(0,d.useMemo)(()=>[je,fn].map(p=>{let N=e[p]||[],U=o[p]||!1;return N.map((M,v)=>{let E=o[`${p}-${v}`]||!1,k=M.xrcAssets||[];return M.xrcToShow=E?k:k.slice(0,be.xrcAsset),M.moreXRC=k.slice(be.xrcAsset),M}),{key:p,exploreUrl:e.exploreUrl,allData:N,dataToShow:U?N:N.slice(0,be.utxo),moreData:N.slice(be.utxo)}}),[e,o]),f=(0,d.useCallback)((m=[])=>m.reduce((p,{amount:N})=>B.add(p,N),0),[]),y=(0,d.useCallback)(m=>{switch(m){case je:return r("wallet_extension_asset_input_inputs_num",{amount:c[0].allData.length});case fn:return r("wallet_extension_asset_outputs",{amount:c[1].allData.length});default:return""}},[c]),w=(0,d.useCallback)(m=>{s(p=>({...p,[m]:!0}))},[]),x=m=>{let{protocolType:p}=m||{};return $e(p)?m.logo||_o:m.logo||uo},z=d.default.memo(({xrcAssets:m=[]})=>d.default.createElement(u.FlexBox,{align:u.ALIGN.center,className:L.moreAssetsLogos},m.slice(0,3).map(p=>d.default.createElement("img",{className:L.moreAssetsLogo,src:p.logo||"",alt:p.symbol}))));return d.default.createElement(Ie,{copyable:!1,title:r("wallet_extension_asset_btn_transaction_details")},c.map(m=>d.default.createElement("div",{className:(0,ie.default)(L.content,m.key===je?L.input:"",m.dataToShow.length===0?L.none:"")},d.default.createElement("div",{className:(0,ie.default)(L.title)},y(m.key)),m.dataToShow.map((p,N)=>d.default.createElement(d.default.Fragment,null,d.default.createElement(u.FlexBox,{align:u.ALIGN.center,justify:"space-between",className:(0,ie.default)(L.utxoContainer,n===p.address[0]?L.isCurrentAddr:"")},d.default.createElement("div",{className:(0,ie.default)(L.addrContainer)},d.default.createElement(Ve,{addresses:p.address,exploreUrl:m.exploreUrl},d.default.createElement("div",{className:L.address},p.address.length>1?r("wallet_extension_asset_title_multisig"):mo(p.address[0]))),d.default.createElement(ro,{className:L.signTag,size:Ue.SIZE.sm},r("wallet_extension_asset_tag_sign"))),d.default.createElement("div",{className:L.amount},d.default.createElement(C.DisplayAmount,{noStyle:!0,amount:p.amount,mode:C.CRYPTO,symbol:l?.symbol,decimals:l?.decimals}))),p.xrcToShow.length>0&&d.default.createElement("div",{className:L.xrcAssetsContainer},d.default.createElement(C.Text,{size:C.SIZE.xs,className:L.xrcAssetsTitle},r("wallet_extension_asset_include_asset")),p.xrcToShow.map(U=>d.default.createElement(u.FlexBox,{align:u.ALIGN.center,className:L.xrcAssetContainer},d.default.createElement("img",{className:(0,ie.default)(L.logo,$e(U.protocolType)?L.isNFT:""),src:x(U),alt:U.symbol}),d.default.createElement(C.Text,{nowrap:!0,size:C.SIZE.xs,ellipsis:{tooltip:!0},className:L.amountText},`${U.amount} ${U.symbol}`),d.default.createElement(no,{className:L.protocol,size:Ue.SIZE.sm},U.protocolName))),p.moreXRC.length>0&&!o[`${m.key}-${N}`]?d.default.createElement(u.FlexBox,{align:u.ALIGN.center,onClick:()=>{w(`${m.key}-${N}`)},className:L.moreXRCContainer},d.default.createElement(z,{xrcAssets:p.moreXRC}),d.default.createElement("div",{className:L.showMoreTitle},r("wallet_extension_asset_btn_show_num_asset",{amount:B.thousandFormat(p.moreXRC.length)})),d.default.createElement(tt,{icon:"okds-arrow-chevron-down-md",size:tt.SIZE.xs})):null))),m.moreData.length>0&&!o[m.key]?d.default.createElement("div",{className:L.expandContainer,onClick:()=>{w(m.key)}},d.default.createElement(u.FlexBox,{align:u.ALIGN.center,justify:"space-between"},d.default.createElement("div",{className:L.expandContainer_title},r("wallet_extension_asset_more_amount_inputs",{amount:B.thousandFormat(m.moreData.length)})),d.default.createElement(u.FlexBox,null,d.default.createElement("div",{className:L.expandContainer_leftTotal},d.default.createElement(C.DisplayAmount,{noStyle:!0,amount:f(m.moreData),mode:C.CRYPTO,symbol:l?.symbol,decimals:l?.decimals})),d.default.createElement(tt,{icon:"okds-arrow-chevron-down-md",size:fo.xs,className:L.expandContainer_icon})))):null)))},dn=rr;i();a();var X=T(W()),xn=T(_e());Q();i();a();var at={main:"_main_asg9r_1",title:"_title_asg9r_8",scrollArea:"_scrollArea_asg9r_17",item:"_item_asg9r_22",subTitle:"_subTitle_asg9r_25",content:"_content_asg9r_32",loading:"_loading_asg9r_38",arrow:"_arrow_asg9r_43",icon:"_icon_asg9r_48"};function sr({psbts:t=[],loading:e,onClick:n}){let o=(0,X.useCallback)(l=>{n(l)},[n]),s=()=>e?X.default.createElement("div",{className:at.scrollArea},X.default.createElement("div",{className:at.loading},X.default.createElement(Qe.Circle,null))):t.length===0?X.default.createElement(to.State,{className:at.empty}):X.default.createElement("div",{className:at.scrollArea},(t||[]).map((l,c)=>X.default.createElement(u.FlexBox,{className:at.item,align:u.ALIGN.center,key:l,onClick:()=>{o(c)}},X.default.createElement(u.FlexBox,{className:at.content,direction:u.DIRECTION.vertical},X.default.createElement("div",{className:at.subTitle},r("wallet_extension_asset_transaction_confirmation",{amount:ze(c+1)})),X.default.createElement("div",{className:at.content},po(l))),X.default.createElement("div",{className:at.arrow},X.default.createElement(tt,{className:(0,xn.default)("okx-wallet-plugin-arrow-small-right",at.icon)})))));return X.default.createElement(u.FlexBox,{className:at.main},X.default.createElement("div",{className:at.title},r("",{number:ze(t.length)})),s())}var Tn=(0,X.memo)(sr);Ao();qn();i();a();var ft=T(W()),yn=T(_e());Q();i();a();var Ft={main:"_main_1w6ta_1",box:"_box_1w6ta_6",tipImg:"_tipImg_1w6ta_12",tipImgIcon:"_tipImgIcon_1w6ta_21",title:"_title_1w6ta_25",decs:"_decs_1w6ta_33",w100:"_w100_1w6ta_39",footerWrap:"_footerWrap_1w6ta_42"};var ir=({visible:t,onCancel:e,onConfirm:n,headerProps:o,psbtHasMultiXRCAsset:s,paymentUseXRCAsset:l,assetInversion:c})=>{let f=(0,ft.useMemo)(()=>s?r("wallet_extension_tip_multiple_inscription_use"):l?r("wallet_extension_desc_inscription_asset"):c?r("wallet_extension_transaction_desc_risky_greater_pay"):"",[c,l,s]);return ft.default.createElement(jt,{visible:t,alignBottom:!0,noMargin:!0,maskClosable:!0,noContentPadding:!0,transitionProps:{type:"slide",placement:"bottom",timeout:300},confirmBtnProps:{size:st.SIZE.lg},cancelBtnProps:{size:st.SIZE.lg},cancelText:r("wallet_extension_function_btn_continue_transaction"),confirmText:r("wallet_extension_mid_dialog_btn_cancel"),onCancel:e,onConfirm:n,onClose:e},ft.default.createElement(u.FlexBox,{className:Ft.main,direction:u.DIRECTION.vertical},ft.default.createElement(u.Box,{className:Ft.box},ft.default.createElement(u.Box,{className:Ft.tipImg},ft.default.createElement(fe,{className:(0,yn.default)("okx-wallet-plugin-risk-trading",Ft.tipImgIcon)})),ft.default.createElement(C.Text,{className:Ft.title,align:C.ALIGN.center},r("wallet_extension_title_transaction_risk")),ft.default.createElement(C.Text,{className:Ft.decs,size:C.SIZE.sm,align:C.ALIGN.center},f)),ft.default.createElement(u.Box,{className:Ft.w100},ft.default.createElement(we,{...o,showDappInfo:!1,loading:!1,noFold:!0}))))},gn=ir;i();a();$n();Hn();var he=T(W()),ar=()=>{let[t,e]=(0,he.useState)(""),n=async()=>{let{data:o}=await ao(lo.getSignPrompt);o.assetReminder?e(o.assetReminder):e(null)};return(0,he.useEffect)(()=>{n()},[]),{assetReminder:t}},Cn=ar;i();a();var In=T(W());Q();var lr=({onConfirm:t})=>(0,In.useCallback)(()=>{jt.warn({title:r("wallet_extension_asset_alertbanner_title_alert"),alignBottom:!1,maskClosable:!1,hideCloseBtn:!0,text:r("wallet_extension_asset_alertbanner_desc_utxo_lost"),confirmBtnProps:{type:st.TYPE.outline,size:st.SIZE.lg},cancelBtnProps:{type:st.TYPE.highlight,size:st.SIZE.lg},onConfirm(e){e.destroy(),t()},async onCancel(e){e.destroy()},cancelText:r("commonall_text_btn_cancel"),confirmText:r("wallet_extension_asset_btn_continue")})},[t]),wn=lr;i();a();var ae=T(W());i();a();var R=T(W()),Ke=T(_e());i();a();var dt={main:"_main_1fewt_1",box:"_box_1fewt_6",isPureScreen:"_isPureScreen_1fewt_12",tipImg:"_tipImg_1fewt_15",tipImgIcon:"_tipImgIcon_1fewt_24",title:"_title_1fewt_28",decs:"_decs_1fewt_36",extLink:"_extLink_1fewt_42",footerWrap:"_footerWrap_1fewt_46",screenOneButtons:"_screenOneButtons_1fewt_49",extButton:"_extButton_1fewt_53"};var Nn=t=>{let{children:e,desc:n,title:o,isPureScreen:s}=t;return R.default.createElement(u.FlexBox,{className:dt.main,direction:u.DIRECTION.vertical},R.default.createElement(u.Box,{className:(0,Ke.default)(dt.box,{[dt.isPureScreen]:s})},R.default.createElement(u.Box,{className:dt.tipImg},R.default.createElement(fe,{className:(0,Ke.default)("okx-wallet-plugin-risk-trading",dt.tipImgIcon)})),R.default.createElement(C.Text,{className:dt.title,align:C.ALIGN.center},o),R.default.createElement(C.Text,{className:dt.decs,size:C.SIZE.sm,align:C.ALIGN.center},n)),R.default.createElement(u.Box,{className:dt.footerWrap},e))},cr=({modalParams:t,handleCancel:e,handleNext:n})=>{let{screenOne:o,screenTwo:s}=t,[l,c]=(0,R.useState)(!1),f=async()=>{c(!0),await e(),c(!1)};return R.default.createElement(Nn,{desc:o.desc,title:o.title},R.default.createElement(u.Box,{className:dt.screenOneButtons},R.default.createElement(st,{block:!0,loading:l,size:st.SIZE.lg,onClick:f,type:st.TYPE.highlight,category:st.CATEGORY.fill},o.mainBtnText),s?R.default.createElement(u.Box,{className:dt.extButton,onClick:n},o.subBtnText):null))},mr=({handleCancel:t,handleNext:e,modalParams:n})=>{let{screenTwo:o={}}=n,s=[{actionType:Y.ACTION_TYPE.CANCEL,btnText:o.subBtnText,onClick:e},{actionType:Y.ACTION_TYPE.CONFIRM,btnText:o.mainBtnText,onClick:t}];return R.default.createElement(Nn,{isPureScreen:!0,desc:o.desc,title:o.title},R.default.createElement(u.Box,{className:dt.screenTwoButtons},R.default.createElement(Y,{buttonGroup:s})))},pr=({handleCancel:t,closeModal:e,modalParams:n})=>{let[o,s]=(0,R.useState)(1);return o===2?R.default.createElement(mr,{modalParams:n,handleCancel:t,handleNext:e}):R.default.createElement(cr,{modalParams:n,handleCancel:t,handleNext:()=>{s(2)}})},En=pr;i();a();var An=T(W());Q();i();a();var Sn={extLink:"_extLink_1eb1z_1"};var ur=()=>{let t=Fo(),e=s=>({title:r("wallet_extension_fractal_title_transaction_risky"),desc:r(s,{case:An.default.createElement(xo,{className:Sn.extLink,href:t?.scamsUrl},r("wallet_extension_function_link_case"))}),mainBtnText:r("wallet_extension_function_btn_cancel"),subBtnText:r("wallet_extension_function_btn_advanced")}),n={title:r("wallet_extension_fractal_title_transaction_risky"),desc:r("wallet_extension_function_desc_developer_continue"),mainBtnText:r("wallet_extension_mid_dialog_btn_cancel"),subBtnText:r("wallet_extension_function_btn_continue_transaction")};return{getUTXONotFoundModalParams:()=>({screenOne:e("wallet_extension_fractal_desc_transaction_risky"),screenTwo:n})}},Bn=ur;var _r=({psbtsInfoErr:t,handleCancel:e})=>{let{getUTXONotFoundModalParams:n}=Bn(),o=(0,ae.useRef)(),s=l=>{o.current||(o.current=jt.action({hideCloseBtn:!0,maskClosable:!1,noContentPadding:!0,children:ae.default.createElement(En,{modalParams:l,handleCancel:async()=>{await e(),o.current.destroy(),o.current=null},closeModal:()=>{o.current.destroy(),o.current=null}})}))};(0,ae.useEffect)(()=>{t?.code==It.UTXO_NOT_FOUND&&s(n())},[t])},bn=_r;i();a();Q();var Pe=T(Jn()),wt={LIST:"list",UNLIST:"unlist",TRADE:"trade",RUNES:"runes"},hn=t=>{try{let e=Pe.Psbt.fromBase64(tn(t)),n=e?.data?.inputs||[],o=e?.data?.globalMap?.unsignedTx?.tx?.outs||[],s=[];return n.forEach((l,c)=>{if(l.witnessUtxo)s.push({...l,value:l.witnessUtxo.value});else if(l.nonWitnessUtxo){let f=Pe.Transaction.fromBuffer(l.nonWitnessUtxo),y=e?.data?.globalMap?.unsignedTx?.tx?.ins||[],x=f.outs[y[c]?.index]?.value;s.push({...l,value:x})}}),{inputs:s,outputs:o}}catch{return{inputs:[],outputs:[]}}},kt=(t,e=0,n)=>!Array.isArray(t)||n===0?0:t.slice(e,n?e+n:void 0).reduce((o,{value:s})=>B.add(o,s),0);var Fn=({unapproved:t})=>{let{psbt:e,psbts:n,type:o,from:s,amount:l=1,psbtOpts:c}=t.params.transaction,{origin:f}=t,y=t.method===V.SIGNPSBTS,w=t?.walletId,x=t?.localType,m=_t({localType:x})?.coinId,p=Qt(w),N=te(w),U=re(w),{loading:M,data:v,error:E}=pn({address:s,hexStringList:y?n:[e],chainIndex:so(x)}),[k,h]=(0,_.useState)(!1),[F,O]=(0,_.useState)(0),q=(0,_.useMemo)(()=>y&&!k,[y,k]),S=(0,_.useMemo)(()=>v[F]||{},[v,F]),{assetReminder:ot}=Cn(),St=o==="list",A=(0,Pn.useDispatch)(),xt=(0,Ln.useHistory)(),nt=Ro(t),{name:lt,icon:rt,host:gt}=nt,{inputs:Xt,outputs:K}=hn(y?n[F]:e),ct=(0,_.useMemo)(()=>B.sub(kt(Xt),kt(K)),[Xt,K]),mt=$o(),zt=(0,_.useMemo)(()=>{if(o!==wt.TRADE&&o!==wt.RUNES)return null;let H=Number(l);if(o===wt.RUNES){let Vt=kt(K,1,H),$t=B.add(kt(K,0,1),kt(K,K.length-H+1,H-1));return`${B.sub($t,B.add(Vt,ct))}`}let Tt=kt(K,H+1,H),Bt=kt(K,1,H);return`${B.sub(Bt,B.add(Tt,ct))}`},[l,ct,K,o]),At=(0,_.useMemo)(()=>p&&y?{type:j.TIP_TYPE.COMMON_ERROR,message:r("extension_wallet_contractual_interaction_wallet_unavailable")}:N?{type:j.TIP_TYPE.COMMON_ERROR,message:r("wallet_extension_top_toast_dapp_comingsoon")}:E?{type:Dt.TYPE.warn,message:r("wallet_extension_asset_alert_trust_network")}:ot&&!f?.includes("okx.com")?{type:Dt.TYPE.warn,message:ot}:{},[N,p,ot,E,f]),Ct=(0,_.useCallback)(async()=>{await A($(t.id)),await A(et()),await me(A)},[A,t.id]),J=(0,_.useCallback)(async()=>{if(!!await ee({walletId:w,callback:async()=>{await A($(t.id))}})){try{let Tt=await Bo(y?n:e,s,w,{localType:x,isPsbts:y},c);await A(it(t.id,{signedTx:Tt}))}catch(Tt){await mt({id:t.id,error:Tt?.message||"Error"})}await A(et()),xt.push(Wt)}},[xt,s,mt,A,y,x,e,c,n,t.id,w]);bn({psbtsInfoErr:E,handleCancel:Ct});let Mt=wn({onConfirm:J}),[vt,qt]=(0,_.useState)(!1),Zt=(0,_.useMemo)(()=>{let H=S?.inputInfo||[],Tt=S?.outputInfo||[],Bt=H.filter(pt=>pt.address?.includes(s)),Vt=Tt.filter(pt=>pt.address?.includes(s)),$t=[],ue=[];return Bt.forEach(pt=>{pt.xrcAssets&&pt.xrcAssets.forEach(ut=>{$t.some(ce=>ce.symbol===ut.symbol&&ce.protocolId===ut.protocolId)||$t.push({symbol:ut.symbol,protocolId:ut.protocolId})})}),Vt.forEach(pt=>{pt.xrcAssets&&pt.xrcAssets.forEach(ut=>{ue.some(ce=>ce.symbol===ut.symbol&&ce.protocolId===ut.protocolId)||ue.push({symbol:ut.symbol,protocolId:ut.protocolId})})}),$t.length>0&&ue.length>0?!$t.every(pt=>ue.some(ut=>pt.symbol===ut.symbol&&pt.protocolId===ut.protocolId)):!1},[S,s]),le=(0,_.useMemo)(()=>{let H=S.inputInfo||[],Tt=S.outputInfo||[];return[...H,...Tt].some(Bt=>!!(Bt.xrcAssets&&Bt.xrcAssets.length>1))},[S]),Z=(0,_.useMemo)(()=>v.some(H=>{let Tt=H.inputInfo||[],Bt=H.outputInfo||[];return[...Tt,...Bt].some(Vt=>!!(Vt.xrcAssets&&Vt.xrcAssets.length>1))}),[v]);(0,_.useEffect)(()=>{q||(le||Zt||S.assetInversion)&&qt(!0)},[v,q,le,Zt,S.assetInversion]);let Ot=(0,_.useCallback)(()=>{if(!Z||!q){J();return}Mt()},[Z,J,Mt,q]),Me=(0,_.useCallback)(H=>{h(!0),O(H)},[h]),ve=(0,_.useMemo)(()=>[{actionType:Y.ACTION_TYPE.CANCEL,btnText:q?r("wallet_extension_asset_btn_cancel_all"):r("wallet_dapp_connection_btn_reject"),onClick:Ct},{disabled:N||M||At.type===j.TIP_TYPE.COMMON_ERROR,actionType:Y.ACTION_TYPE.CONFIRM,btnText:q?r("wallet_extension_asset_btn_confirm_all"):r("extension_transactions_btn_confirm"),onClick:Ot}],[N,Ct,At,q,M]),Oe=(0,_.useMemo)(()=>{switch(o){case wt.LIST:return r("extension_wallet_transfer_maintitle_list");case wt.UNLIST:return r("extension_wallet_transfer_maintitle_cancel_listing");case wt.TRADE:return r("extension_wallet_transfer_maintitle_transaction");default:return r("extension_wallet_transfer_maintitle_transaction")}},[o]),Ht=!St&&(B.gt(S.gasFee,0)||B.gt(ct,0)),Xn=(0,_.useMemo)(()=>!E||E===It.EXECUTE_ERROR&&S.status!==It.PSBT_ANALYSIS_FAILED,[E,S]),zn=(0,_.useMemo)(()=>E&&E!==It.EXECUTE_ERROR||S?.status===It.PSBT_ANALYSIS_FAILED,[E,S]);return _.default.createElement(u.Container,null,_.default.createElement(Pt,{title:Oe,backable:y&&k,closeable:!1,onBack:()=>{h(!1)}}),q?_.default.createElement("div",null,_.default.createElement(G,null,_.default.createElement(qe,{summaryList:[{title:lt,desc:gt,icon:{src:rt}}],title:r("extension_contract_interaction_maintitle_request_from")})),_.default.createElement(Tn,{psbts:n,loading:M,onClick:Me})):null,q?null:_.default.createElement(_.default.Fragment,null,Xn&&_.default.createElement(we,{coinId:m,txType:P.TRANS_OUT,loading:M,dappInfo:{name:lt,host:gt,icon:rt},analyzeRet:S}),zn&&_.default.createElement(G,null,(o===wt.TRADE||o===wt.RUNES)&&_.default.createElement(oe,{summaryList:[{coinId:m,coinAmount:zt}],tooltip:r("extension_infor_tooltip_asset_changestips"),title:r("extension_contract_interaction_maintitle_asset_changes")}),_.default.createElement(qe,{summaryList:[{title:lt,desc:gt,icon:{src:rt}}],title:r("extension_contract_interaction_maintitle_request_from")})),Ht&&_.default.createElement(G,null,_.default.createElement(ne,{coinId:m,networkFee:S.gasFee||ct})),_.default.createElement(G,null,_.default.createElement(Rt,{title:r("wallet_extension_network_address_title_walletused"),address:s,walletId:w,onCopyCallback:()=>{U({trade:"approve",all_confirmation:"wallet_used_address"})}})),!Ht&&_.default.createElement(G,null,_.default.createElement(Jo,{coinId:m})),_.default.createElement(G,null,_.default.createElement(dn,{coinId:m,data:S,currentAddr:s})),_.default.createElement(G,null,_.default.createElement(Ie,{data:y?n[F]:e,copyable:{hideDesc:!0}}))),k?null:_.default.createElement(Jt,{placeholder:!0,offsetBottom:0,borderTop:!0},_.default.createElement(j,{coinId:m,...At}),_.default.createElement(Y,{buttonGroup:ve})),_.default.createElement(gn,{visible:vt,onCancel:()=>{qt(!1)},onConfirm:()=>{qt(!1),Ct()},headerProps:{coinId:m,txType:P.TRANS_OUT,analyzeRet:S},psbtHasMultiXRCAsset:le,paymentUseXRCAsset:Zt,assetInversion:S.assetInversion}))};i();a();var b=T(W()),kn=T(Kt()),Mn=T(Re());Q();var vn=({unapproved:t})=>{let e=t.walletId,{localType:n}=t,o=_t({localType:n}),s=te(e),{memo:l,value:c,memoPos:f,to:y,satBytes:w,from:x,extraParams:z}=t.params.transaction,m=o?.coinId,p=Lt(m),[N,{toggle:U}]=ht(!1),[M,v]=(0,b.useState)(w?{level:bt.CUSTOM,satBytes:w}:{}),E=M?.satBytes,k=(0,kn.useDispatch)(),h=(0,Mn.useHistory)(),[,F]=Te({coinId:m,address:x,chainId:p?.chainId}),O=F?.transferReminder;(0,b.useEffect)(()=>{if(!E&&F?.normal&&v({level:bt.STANDARD,satBytes:F?.normal}),E&&M?.level!==bt.CUSTOM){let J=F[Ne[M?.level]?.satBytes];v({...M,satBytes:J})}},[F]);let[q,S]=ge({coinId:m,walletId:e,address:x,satBytes:E},{}),ot=re(e),[St,A,xt]=Uo({coinId:m,toAddr:y,walletId:e,fromAddr:x,satBytes:E,coinAmount:c,canTransferAmount:S},{}),nt=(0,b.useMemo)(()=>S===void 0||A===void 0?!0:B.gte(S,B.add(A,c)),[S,c,A]),lt=Ce({coinId:m,txType:P.TRANS_OUT,address:x}),rt=Wo({memo:l,memoPos:f,coinId:m,toAddr:y,walletId:e,coinAmount:c,fromAddr:x,localType:p?.localType,dustSize:F?.minOutput,networkFee:A,satBytes:M.satBytes}),gt=vo({coinId:m,walletId:e,satBytes:E,address:x,utxoType:Yt.TRANSFER}),Xt=Qt(e),[K,ct]=(0,b.useState)(!1),mt=(0,b.useCallback)(async()=>{await k($(t.id)),await k(et()),ct(!1),h.push(Wt)},[k,h,t.id]),zt=(0,b.useCallback)(async()=>{if(!await ee({walletId:e,callback:async()=>{await k($(t.id))}}))return;let Mt=await gt(c,A);await lt(Mt,()=>{mt()}),ct(!0);let vt=await rt({utxoList:Mt});t.id&&(await k(it(t.id,{signedTx:vt,coinAmount:c,serviceCharge:A,satPerByte:E,coinId:m,...z})),await k(et())),ct(!1)},[lt,c,k,A,z,gt,mt,E,rt,t.id]),At=(0,b.useMemo)(()=>s?{type:j.TIP_TYPE.COMMON_ERROR,message:r("wallet_extension_top_toast_dapp_comingsoon")}:nt?xt?{type:j.TIP_TYPE.FEE_ERROR}:{type:Dt.TYPE.warn,message:O}:{type:j.TIP_TYPE.FEE_BALANCE_INSUFFICIENT},[xt,s,nt,O]),Ct=(0,b.useMemo)(()=>{let J=[{actionType:Y.ACTION_TYPE.CANCEL,btnText:r("wallet_dapp_connection_btn_reject"),onClick:mt}];return nt?J=[...J,{disabled:q||St||xt||s||!Number(A),actionType:Y.ACTION_TYPE.CONFIRM,onClick:zt}]:J=[...J,{coinId:m,address:x,walletId:e,actionType:Y.ACTION_TYPE.FILL_UP}],J},[m,A,xt,St,x,s,nt,q,mt,zt,e]);return b.default.createElement(u.Container,null,b.default.createElement(Pt,{title:r("wallet_trade_maintitle_transaction_confirm"),backable:!1,closeable:!1}),b.default.createElement(G,null,b.default.createElement(oe,{title:r("wallet_extension_send_colored_send"),summaryList:[{coinId:m,coinAmount:c}]})),b.default.createElement(G,null,b.default.createElement(Rt,{walletId:e,address:x,title:r("extension_send_mid_text_from"),onCopyCallback:()=>{ot({trade:"send",all_confirmation:"wallet_used_address"})}},!!S&&b.default.createElement(Se,{coinBalance:S,coinId:m})),b.default.createElement(Rt,{address:y,title:r("extension_send_mid_text_to"),onCopyCallback:()=>{ot({trade:"send",all_confirmation:"to_address"})}})),b.default.createElement(G,{bordered:!1},b.default.createElement(ne,{coinId:m,loading:St,estimateFailed:xt,networkFee:A,level:M?.level,onClick:()=>{U(),ot({trade:"send",all_confirmation:"network_fee"})}})),b.default.createElement(Jt,{placeholder:!0,offsetBottom:0,borderTop:!0},b.default.createElement(j,{coinId:m,...At}),b.default.createElement(Y,{buttonGroup:Ct})),b.default.createElement(Ee,{coinId:m,visible:N,signInfo:F,value:M,estimatedFee:A,onChange:v,onToggleVisible:U}),b.default.createElement(Ae,{visible:Xt&&K}))};i();a();var pe=T(W());i();a();function On(t){try{return[JSON.parse(t),null]}catch{return[null,new Error("Illegal JSON string")]}}Vn();i();a();var Fe=T(W()),Un=T(Kt());Q();i();a();var D=T(W());Q();i();a();var Nt={"inscription-preview":"_inscription-preview_yy6vc_1",inscriptionPreview:"_inscription-preview_yy6vc_1","inscription-preview__inner":"_inscription-preview__inner_yy6vc_13",inscriptionPreviewInner:"_inscription-preview__inner_yy6vc_13","inscription-preview-text":"_inscription-preview-text_yy6vc_21",inscriptionPreviewText:"_inscription-preview-text_yy6vc_21","inscription-preview-image":"_inscription-preview-image_yy6vc_26",inscriptionPreviewImage:"_inscription-preview-image_yy6vc_26","inscription-item__content":"_inscription-item__content_yy6vc_30",inscriptionItemContent:"_inscription-item__content_yy6vc_30","inscription-exceedTip":"_inscription-exceedTip_yy6vc_34",inscriptionExceedTip:"_inscription-exceedTip_yy6vc_34","inscription-extend":"_inscription-extend_yy6vc_39",inscriptionExtend:"_inscription-extend_yy6vc_39","inscription-extend__icon":"_inscription-extend__icon_yy6vc_43",inscriptionExtendIcon:"_inscription-extend__icon_yy6vc_43"};var Je=24,Le={TEXT:"text",IMAGE:"image"},fr=D.default.memo(({type:t,contentType:e,body:n})=>{let[{inscriptionType:o,inscriptionContent:s},l]=So({inscriptionType:Le.TEXT,inscriptionContent:n});return(0,D.useEffect)(()=>{if(t===P.ORDINAL_NFT||e?.startsWith("image/"))try{let c=URL.createObjectURL(new Blob([n]));l({inscriptionType:Le.IMAGE,inscriptionContent:c})}catch{l({inscriptionType:Le.TEXT,inscriptionContent:n})}finally{l({initing:!1})}},[n,e,l,t]),D.default.createElement(u.Box,{className:Nt["inscription-preview"]},o===Le.IMAGE?D.default.createElement("img",{alt:"",src:s,className:Nt["inscription-preview-image"]}):D.default.createElement(u.Box,{className:Nt["inscription-preview__inner"]},D.default.createElement(C.Text,{forceWrap:!0,className:Nt["inscription-preview-text"]},s)))}),dr=({type:t,contentType:e,body:n,rawBody:o})=>{let s=(0,D.useMemo)(()=>{let f=n?.length;return B.lt(f,1024)?`${f} B`:`${B.floorTruncate(B.div(f,1024),3)} KB`},[n?.length]),l=t===P.ORDINAL_NFT||e?.startsWith("image/"),c=l?o?.slice(0,200):o;return D.default.createElement(u.FlexBox,null,D.default.createElement(fr,{type:t,body:n,contentType:e}),D.default.createElement(u.FlexBox,{direction:u.DIRECTION.vertical,className:Nt["inscription-item__content"]},D.default.createElement(C.Text,{strong:!0,ellipsis:{tooltip:!l},size:C.SIZE.xs},c),D.default.createElement(C.Text,{size:C.SIZE.xs,type:C.TYPE.secondary},s)))},xr=({type:t,dataSource:e=[]})=>{let n=e?.length||0,[o,{toggle:s}]=ht(!1),l=(0,D.useMemo)(()=>o?e?.slice(0,Je):e?.slice(0,3),[e,o]),c=(0,D.useMemo)(()=>wo(t),[t]);return D.default.createElement(Yo,{space:16,title:r(c,{num:n})},D.default.createElement(ho,{space:24,renderEmpty:!1,dataSource:l,renderItem:f=>D.default.createElement(dr,{...f,type:t})}),o&&n>Je&&D.default.createElement(C.Text,{size:C.SIZE.xs,type:C.TYPE.secondary,className:Nt["inscription-exceedTip"]},r("wallet_info_dialog_desc_replicate_hide",{num:B.sub(n,Je)})),n>3&&D.default.createElement(u.FlexBox,{justify:"center",className:Nt["inscription-extend"],onClick:s},D.default.createElement(tt,{size:tt.SIZE.xs,className:Nt["inscription-extend__icon"],icon:o?"okds-arrow-chevron-up-md":"okx-wallet-plugin-add-arrow-chevrons"})))},Dn=xr;function Tr({unapproved:t}){let e=(0,Un.useDispatch)(),{id:n}=t,{type:o}=t.params?.transaction||{},s=Io[o],{localType:l}=t,f=_t({localType:l})?.coinId,y=async()=>{await e(et()),await e($(t.id))},w=async z=>{await e(it(t.id,z)),await e(et())},{inscriptions:x}=zo();return Fe.default.createElement(qo,{txId:n,headerProps:{title:s?r(s):null,closeable:!1,backable:!1},confirmButtonProps:{onCancel:y,onConfirm:w},slot:{top:Fe.default.createElement(G,null,Fe.default.createElement(Dn,{type:o,dataSource:x}))},netWorkCoinId:f})}var Wn=Tr;var yr=[P.BRC20_MINT,P.BRC20_INSCRIBE,P.BRC20_DEPLOY],gr=[P.EARN_BRC30_APPLY,P.EARN_BRC30_REDEEM,P.EARN_BRC30_CLAIM,P.EARN_BRC30_DEPLOY],Cr=[P.RUNES_ETCH];function Ir(t,e){let n=go(e);return yr.includes(t)?n=yo(e):gr.includes(t)?n=Ge.BRC_20S:Cr.includes(t)&&(n=Co(e)),n}function wr(t,e){return e.map(({contentType:n,body:o})=>{let s=o;try{(t===P.ORDINAL_NFT||typeof t!="number"&&n?.startsWith("image/"))&&(s=g.Buffer.from(o,"hex"))}catch{}return{contentType:n,body:s,rawBody:o}})}function Nr({unapproved:t}){let{tick:e,tid:n,type:o,from:s,to:l,txSource:c,inscriptions:f=[],amount:y,mintType:w=No.parallel}=t.params?.transaction||{},{localType:x}=t,z=(0,pe.useMemo)(()=>wr(o,f),[o,f]),m=_t({localType:x}),p=+m?.netWorkId,N=m?.coinId,U=xe(()=>{if(o===P.RUNES_ETCH){let[h,F]=On(f[0]?.body);if(F)return{chainId:p,coinType:Ye(p),symbol:e,address:"btc-runesMain-invalid-inscriptions"};let O=h?.id||"";return{chainId:p,coinType:Ye(p),symbol:e,address:`btc-runesMain-${O}`}}return e?{chainId:p,coinType:de(p),symbol:e}:null},[n,e,o,p]),M=Ir(o,p),v=Lt(void 0,{},U),E=(h,F)=>{let O=0;if(o===P.RUNES_ETCH){h.coinAmount=We(y,10**v?.decimals),h.coinId=v?.coinId||N,h.txSource=c||Ut.DAPP;return}y&&v?.decimals&&(O=We(y,10**v?.decimals)),h.coinAmount=O,h.coinId=F?N:v?.coinId||N,h.txSource=c||Ut.DAPP},k=(h,F)=>{h&&E(h,!0),Array.isArray(F)&&F.forEach(O=>{E(O,!1)})};return pe.default.createElement(Zo,{params:{walletId:t.walletId,utxoType:Yt.INSCRIPTION_USE_NFT_UTXO,from:s,to:l,inscriptions:z,txType:o,protocolId:M,mintType:w,netWorkCoinId:N},lifecycle:{beforePostTx:k}},pe.default.createElement(Wn,{unapproved:t}))}var Yn=Nr;i();a();Q();var ke=T(W()),Rn=T(Kt());Ao();var Er=({unapproved:t})=>{let e=(0,Rn.useDispatch)(),{targetCoin:n}=t.params||{},o={image:n.logo,decimals:n.decimals,name:n.name,address:n.contractAddress,symbol:n.symbol},s={name:n.blockChain||n.localType},l=re(),c=(0,ke.useMemo)(()=>{let f={actionType:Y.ACTION_TYPE.CANCEL,async onClick(){l({all_confirmation:"cancel",trade:"add_token"}),await e($(t.id)),await me(e)},btnText:r("wallet_dapp_connection_btn_reject")},y={actionType:Y.ACTION_TYPE.CONFIRM,async onClick(){try{l({all_confirmation:"confirm",trade:"add_token"}),await bo(n),await e(it(t.id)),await me(e)}catch(w){oo.error(w?.data?.originalError?.msg||r("wallet_extenshion_toast_add_failed"))}}};return[f,y]},[l,e,n,t.id]);return ke.default.createElement(jo,{token:o,provider:s,buttonGroup:c})},Gn=Er;var vm=({unapproved:t})=>{switch(t.method){case V.TRANSFER_NFT:case V.SEND_INSCRIPTION:return Et.default.createElement(en,{unapproved:t});case V.SPLITUTXO:return Et.default.createElement(nn,{unapproved:t});case V.INSCRIBE:case V.INSCRIBE_TRANSFER:return Et.default.createElement(cn,{unapproved:t});case V.SIGNPSBT:case V.SIGNPSBTS:return Et.default.createElement(Fn,{unapproved:t});case V.SIGN_MESSAGE:return Et.default.createElement(sn,{unapproved:t});case V.MINT:return Et.default.createElement(Yn,{unapproved:t});case V.WATCHASSET:return Et.default.createElement(Gn,{unapproved:t});case V.SEND:case V.SEND_BTC:return Et.default.createElement(vn,{unapproved:t});default:return""}};export{vm as default};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "prepub";

//# sourceMappingURL=Bitcoin-LHIHE35J.js.map
