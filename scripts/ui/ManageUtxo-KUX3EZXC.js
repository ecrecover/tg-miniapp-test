import{a as Jt}from"./chunk-RC5IAFKK.js";import{e as bt}from"./chunk-VTLNAOHG.js";import"./chunk-Y7YPG2EJ.js";import"./chunk-7R67VE77.js";import{a as Rt}from"./chunk-NHGZUGLZ.js";import"./chunk-G5LEAVCY.js";import"./chunk-ACHWU2H6.js";import"./chunk-ZPFBKNRM.js";import"./chunk-7DP5LYUM.js";import{a as R}from"./chunk-BVXKJJ4A.js";import"./chunk-TBBE7OKY.js";import"./chunk-7HJDVUH5.js";import{c as Et}from"./chunk-ZD4EJWX6.js";import"./chunk-DXRBY5MU.js";import"./chunk-6FR2UIE7.js";import{h as xt}from"./chunk-5GMHHIH5.js";import"./chunk-7KCWBFQ2.js";import"./chunk-QLUP7GYN.js";import"./chunk-7Y44NCE5.js";import"./chunk-BKPOG6ZD.js";import"./chunk-OZMVWMFO.js";import"./chunk-KTO7CPX7.js";import"./chunk-P3XTPXPO.js";import"./chunk-4IY6P5HR.js";import"./chunk-FQWGOLDH.js";import"./chunk-QEPBNPHF.js";import"./chunk-3JLS3TGD.js";import"./chunk-KDP5Z4RF.js";import"./chunk-W234FNSM.js";import"./chunk-CLWWTOKP.js";import{a as Kt}from"./chunk-KZ2PCELG.js";import{b as Bt}from"./chunk-C7ZG4INB.js";import{a as jt}from"./chunk-J5ANWCEO.js";import{s as yt,w as T}from"./chunk-VMO2INN3.js";import"./chunk-J4TF3RT7.js";import"./chunk-6FOZGMAL.js";import"./chunk-2MV3WEYP.js";import{db as Wt,qb as Qt,y as Vt}from"./chunk-HPXM6RSK.js";import"./chunk-IUIJ46C3.js";import"./chunk-KZ3ZU675.js";import{a as Ce}from"./chunk-NJ5CWPUY.js";import"./chunk-UMJMJOW4.js";import"./chunk-YTJBYVBO.js";import"./chunk-QO3243S4.js";import"./chunk-O5JCC6KG.js";import{d as qt,f as Ie}from"./chunk-MAIAJ7GD.js";import"./chunk-4PGNX6E2.js";import"./chunk-MGLVPWSV.js";import"./chunk-TXKWPME2.js";import"./chunk-4D3M2I6W.js";import"./chunk-AMVK42SC.js";import{a as gt}from"./chunk-D6RIE45O.js";import"./chunk-XCAARJ7Q.js";import{c as L}from"./chunk-JXCCIV3J.js";import{b as ft,c as Ne}from"./chunk-AOA7NX2Y.js";import{j as pt,m as he}from"./chunk-HXZH2DHB.js";import"./chunk-MZG4RHXJ.js";import"./chunk-VTST2UXT.js";import{Eb as Gt,Kb as Zt,ba as J,ib as Ut,jb as Mt,kb as dt,za as Dt}from"./chunk-X7YMANPZ.js";import"./chunk-IRITFTWC.js";import{A as kt,F as wt,L as Q,c as At,f as St,n as G,q as Ht,x as Z}from"./chunk-SOHTSUTI.js";import{I as $,v as It,w as t}from"./chunk-RPZQDAIQ.js";import"./chunk-LDRI4AYU.js";import"./chunk-E24EBHFY.js";import{M as W,S as ut,Y as d,c as Ct}from"./chunk-V4F2JFTP.js";import{a as k}from"./chunk-6DDC4Y2S.js";import"./chunk-KJOC4LFM.js";import"./chunk-6FDO4Y56.js";import"./chunk-NNZ5SU5W.js";import"./chunk-YUXYCITH.js";import"./chunk-TEKDZ77C.js";import"./chunk-NC54RUAI.js";import"./chunk-YR74Q3QD.js";import{f as g,m as o,o as n}from"./chunk-EQYVU4XP.js";o();n();var nt=g(k()),de=g(Ce()),fe=g(Ct());$();Dt();o();n();var i=g(k()),ue=g(Vt());$();Zt();o();n();$();var Ae=({isUnSpend:e=!1,onConfirm:m=()=>{},coin:_})=>async()=>{if(e){let r=G.warn({alignBottom:!1,title:t("wallet_extension_footer_btn_unfreeze"),text:t("wallet_extension_bot_text_confirm_unoccupy_icu",{chainName:_?.symbol}),cancelText:t("wallet_extension_bot_btn_reconsider"),confirmText:t("wallet_extension_btn_general_confirm"),onCancel:()=>{r.destroy()},onConfirm:async()=>{await m()}})}else await m()},te=Ae;o();n();var Lt=g(k()),oe=g(Vt());Ie();Dt();Ne();he();var ee={utxoList:[],totalUtxoNum:0,canTransferAmount:0};function Se(e){let _=R().get("coinId"),s=bt(_||J,{withPrice:!0,withPriceChangePercent24h:!1}),r=Rt(s?.localType),u=(0,oe.useSelector)(Wt),b=xt(s?.localType)[e],c=e?b:r,U=(0,Lt.useCallback)(async()=>{let C={coinId:s?.coinId,utxoRequests:[{address:c,utxoType:12}]};try{let{data:N}=await pt(ft.getBTCUTXO,C);return N.length===1?N[0]:ee}catch{return ee}},[c,s]),A=(0,Lt.useCallback)(async(C,N,B)=>{let I=s?.chainId;if(!I&&I!==0)return{};let O={txHash:C,address:c,status:B,vout:N,chainId:I};try{let{data:M}=await pt(ft.getUTXOAsset,O);return M}catch{return{}}},[s]);return{fetchUTXO:U,fetchUTXOAsset:A,manageUTXO:async({utxoList:C=[],spentStatus:N})=>{let B=s?.chainId,I=await qt().getRequestHeaders({walletId:u,needSign:!0,currency:"usd"}),O={address:c,spentStatus:N,chainId:B};C&&(O.utxoList=C);try{return await pt(ft.manageUTXO,O,{headers:I})}catch{return{}}}}}var Tt=Se;o();n();var x=g(k());Dt();var ne=(e,m)=>{let s=R().get("coinId"),r=bt(s||J,{withPrice:!0,withPriceChangePercent24h:!1}),[u,y]=(0,x.useState)({address:"",canTransferAmount:"",utxoList:[],totalUtxoNum:0}),[b,c]=(0,x.useState)(!0),[U,A]=(0,x.useState)({}),[j,C]=(0,x.useState)(!1),{fetchUTXO:N,fetchUTXOAsset:B}=Tt(m),I=(0,x.useCallback)(async()=>{c(!0);let a=await N();return c(!1),a},[N]),O=(0,x.useCallback)(async()=>{if(!r?.coinId&&r?.coinId!==0)return;let a=await I();y(a)},[I]),M=(0,x.useCallback)(async(a,z,E)=>{C(!0);let X=await B(a,z,E);A(X),C(!1)},[B]),F=(0,x.useMemo)(()=>(u?.utxoList||[]).filter(a=>a.utxoStatusType===e),[u,e]),vt=(0,x.useMemo)(()=>F.reduce((a,z)=>a+z.coinAmount,0),[F]),at=(0,x.useMemo)(()=>F.every(a=>a.select),[F]),ht=(0,x.useMemo)(()=>F.filter(a=>a.select),[F]),lt=a=>{let z=(u?.utxoList||[]).map(E=>E.utxoStatusType===e?{...E,select:a}:{...E});y({...u,utxoList:z})},mt=({txHash:a,vout:z})=>{let E=(u?.utxoList||[]).map(X=>X.txHash===a&&X.vout===z?{...X,select:!X.select}:X);y({...u,utxoList:E})};return(0,x.useEffect)(()=>{(async()=>await O())()},[r?.coinId]),{utxoData:u,activeList:F,activeAmount:vt,loading:b,selectList:ht,isSelectAll:at,selectUtxo:mt,handleSelectAll:lt,fetchAndSetData:O,detail:U,fetchDetail:M,detailLoading:j,coin:r}};o();n();o();n();var w=g(k());$();o();n();var rt={main:"_main_19np7_1",btn:"_btn_19np7_7",header:"_header_19np7_10",banner:"_banner_19np7_14",subContent:"_subContent_19np7_21"};var re=({visible:e,close:m,token:_})=>{let s=w.default.createElement(w.default.Fragment,null,w.default.createElement("div",{className:rt.main},w.default.createElement(T.Text,{strong:700,className:rt.header},t("extension_defi_toast_title_manage_utxos")),w.default.createElement(T.Text,{className:rt.subContent},t("extension_defi_toast_text_utxo_usage",{token:_}))),w.default.createElement("div",{className:rt.btn},w.default.createElement(d,{block:!0,type:d.TYPE.highlight,size:d.SIZE.lg,onClick:()=>{m()}},t("wallet_extension_btn_general_gotit"))));return w.default.createElement(G.Action,{onClose:()=>{m()},visible:e,title:w.default.createElement(w.default.Fragment,null),alignBottom:!0,maskClosable:!0,topStyle:{border:"none",padding:"12px"},windowStyle:{overflow:"hidden"},noTopRadius:!1,renderContent:()=>s})};o();n();var et=g(k());$();o();n();var tt={header:"_header_y50y8_1",title:"_title_y50y8_11",amount:"_amount_y50y8_14",unfreeze:"_unfreeze_y50y8_21",text:"_text_y50y8_26",divider:"_divider_y50y8_29",icon:"_icon_y50y8_32",currency:"_currency_y50y8_36",background:"_background_y50y8_43"};var ie=({amount:e="",currencyAmount:m="",symbol:_="",activeTab:s})=>{let r=gt();return et.default.createElement("div",{className:tt.header},et.default.createElement("img",{alt:"UTXO",src:`${r}/cdn/assets/imgs/241/46CBAC7179F5F752.png`,className:tt.background}),et.default.createElement(T.Text,{className:tt.title,size:T.SIZE.sm},s===1?t("wallet_extension_card_input_total_amount"):t("wallet_extension_card_input_total_unavailable")),et.default.createElement("div",{className:tt.amount},`${e} ${_}`),et.default.createElement("div",{className:tt.currency},m))};o();n();var f=g(k());$();o();n();var v=g(k());$();o();n();var D={nftContain:"_nftContain_19spt_1",detail:"_detail_19spt_4",detailLeft:"_detailLeft_19spt_12",img:"_img_19spt_22",tokenAltImg:"_tokenAltImg_19spt_33",altImgFont:"_altImgFont_19spt_44",content:"_content_19spt_51",badge:"_badge_19spt_55",currency:"_currency_19spt_63"};var se=({item:e,getUSDtoCurrency:m})=>{let _=gt(),s=e.protocolType===1,r=s?`${yt(e.tokenAmount)} ${e.tokenSymbol}`:e.collectionName,u=()=>{let y={fontSize:"16px",lineHeight:"20px"};return s?(e.tokenSymbol.length>4&&(y={fontSize:"12px",lineHeight:"16px"}),v.default.createElement("div",{className:D.tokenAltImg},v.default.createElement("div",{className:D.altImgFont,style:y},e.tokenSymbol))):v.default.createElement("div",{className:D.img},v.default.createElement("img",{src:`${_}/cdn/assets/imgs/241/C82F2BF8460AC236.png`,alt:"nft-img"}))};return v.default.createElement("div",{className:D.nftContain},v.default.createElement("div",{className:D.detail},v.default.createElement("div",{className:D.detailLeft},e.logo?v.default.createElement("div",{className:D.img},v.default.createElement("img",{src:e.logo,alt:"nft-img"})):u(),v.default.createElement(L.FlexBox,{direction:L.DIRECTION.vertical,className:D.content},v.default.createElement(T.Text,{ellipsis:{tooltip:!0},style:{flex:1}},r),e.protocolName&&v.default.createElement(St,{type:St.TYPE.rect,className:D.badge},e.protocolName))),v.default.createElement(T.Text,{size:T.SIZE.xs,className:D.currency},e.usdAmount?m(e.usdAmount):t("extension_defi_card_text_unknown_value")),v.default.createElement("div",null)))};o();n();var P={detailDialog:"_detailDialog_10fh7_1",container:"_container_10fh7_4",footer:"_footer_10fh7_9",alertIcon:"_alertIcon_10fh7_18",loading:"_loading_10fh7_25",error:"_error_10fh7_29",empty:"_empty_10fh7_33",unknown:"_unknown_10fh7_37"};var ae=({visible:e,closeCallback:m,detail:_,detailLoading:s,getUSDtoCurrency:r,detailUTXO:u,fetchDetail:y})=>{let{protocolAssetList:b,assetUnknown:c=[]}=_,U=c.join(t("extension_wallet_text_punctuation_mark"));return f.default.createElement(G.Action,{onClose:()=>{m()},visible:e,maskClosable:!0,noTopRadius:!1,windowClass:P.detailDialog,alignBottom:!0},s&&f.default.createElement("div",{className:P.loading},f.default.createElement(ut.Circle,null)),!s&&b&&f.default.createElement(f.default.Fragment,null,f.default.createElement("div",{className:P.container},c.length>0&&f.default.createElement("div",{className:P.unknown},f.default.createElement(At,{desc:t("extension_defi_popup_alert_utxo_not_decode_yet",{asset:U}),type:At.TYPE.warn,closable:!1})),b.length>0?b.map(A=>f.default.createElement(f.default.Fragment,null,f.default.createElement(se,{getUSDtoCurrency:r,key:A.protocolId,item:A}))):f.default.createElement(Z.State,{type:c.length>0?Z.State.TYPE.noRecord:Z.State.TYPE.noResult,title:c.length>0?t("extension_defi_popup_emptystate_btn_nodata"):t("extension_defi_toast_error_no_inscriptions"),className:P.empty})),b.length>0&&f.default.createElement("div",{className:P.footer},f.default.createElement(Bt,{size:Bt.SIZE.xs,className:`okds-information-circle-fill ${P.alertIcon}`}),f.default.createElement("div",null,t("extension_defi_bot_tips_show_300_assets")))),!s&&!b&&f.default.createElement("div",{className:P.container},f.default.createElement(Z.State,{type:Z.State.TYPE.noNetwork,className:P.error,title:t("extension_defi_popup_emptystate_title_data_loading_fail"),buttonText:t("extension_defi_popup_emptystate_btn_reload"),onButtonClick:()=>{y(u.txHash,u.vout,u.status)}})))};o();n();var st=g(k());$();o();n();var it={btnWrapper:"_btnWrapper_14mei_1",confirmBtn:"_confirmBtn_14mei_5",tipContent:"_tipContent_14mei_8",closeBtn:"_closeBtn_14mei_11"};var le=({tipData:e,handleConfirm:m,symbol:_})=>st.default.createElement(G.Tip,{visible:e.visible,titleCenter:!0,title:t("extension_investutxo_mid_text_successfully_unlock"),closeClassName:it.closeBtn,renderFooter:()=>st.default.createElement("div",{className:it.btnWrapper},st.default.createElement(d,{size:d.SIZE.lg,type:d.TYPE.highlight,category:d.CATEGORY.fill,onClick:m,className:it.confirmBtn},t("extension_defi_modal_btn_ok")))},st.default.createElement(T.Text,{type:T.TYPE.secondary,size:T.SIZE.sm,className:it.tipContent,align:T.ALIGN.center},t("extension_investutxo_mid_textarea_released_and_get_token",{num:e.valuelessNftNum,num1:e?.freedBtcAmount,symbol:_})));o();n();var h=g(k());$();Zt();var Pt=g(Ct());o();n();var H={footerContain:"_footerContain_19y6a_1",footer:"_footer_19y6a_1",tip:"_tip_19y6a_8",footerIcon:"_footerIcon_19y6a_15",leftBtn:"_leftBtn_19y6a_22",rightBtn:"_rightBtn_19y6a_25"};var me=({selectList:e=[],handleConfirm:m,handleSelectAll:_,divDecimal:s,activeTab:r,isSelectAll:u,utxoData:y,symbol:b})=>{let c=e.length,U=y?.utxoList?.length===0,A=y?.totalUtxoNum,j=(0,h.useMemo)(()=>e.reduce((B,I)=>dt(B,I.coinAmount),0),[e]),C=(0,h.useMemo)(()=>r===1?c===0?t("wallet_extension_footer_btn_frozen"):t("wallet_extension_footer_btn_frozen_value",{value:c}):c===0?t("wallet_extension_footer_btn_unfreeze"):t("wallet_extension_footer_btn_unfreeze_value",{value:c}),[r,c]),N=()=>r===2&&c!==0?h.default.createElement("div",{className:H.tip},h.default.createElement(W,{className:(0,Pt.default)("okds-information-circle-fill",H.footerIcon)}),h.default.createElement("div",null,t("extension_investutxo_bot_textarea_desc_potential_risk",{extension_investutxo_bot_textarea_desc_potential_risk:c,numToken:`${s(j)} ${b}`}))):A>300?h.default.createElement("div",{className:H.tip},h.default.createElement(W,{className:(0,Pt.default)("okds-information-circle-fill",H.footerIcon)}),h.default.createElement("div",null,A<=1e3?t("extension_defi_bot_tips_300_utxo_variable_unlock",{num:A}):t("extension_defi_bot_tips_300_utxo_unlock"))):null;return h.default.createElement(jt.FooterActions,{className:H.footerContain},h.default.createElement("div",{className:H.footer},N(),h.default.createElement(L.FlexBox,null,h.default.createElement(d,{category:d.CATEGORY.outline,type:d.TYPE.secondary,size:d.SIZE.lg,disabled:U,onClick:()=>{_(!u)},className:H.leftBtn},u?t("extension_defi_mid_btn_cancel"):t("extension_investutxo_bot_btn_select_all")),h.default.createElement(d,{size:d.SIZE.lg,type:d.TYPE.highlight,category:d.CATEGORY.fill,disabled:c===0,onClick:m,className:H.rightBtn},C))))};o();n();var Ft=g(k()),ce=g(Ct());o();n();var Ot={root:"_root_15vei_1",item:"_item_15vei_6",more:"_more_15vei_14",arrow:"_arrow_15vei_22"};function ke({onClick:e}){return Ft.default.createElement("div",{className:Ot.root,onClick:e},Ft.default.createElement(W,{className:(0,ce.default)("okx-wallet-plugin-arrow-small-right",Ot.arrow)}))}var _e=ke;o();n();var S={main:"_main_15b0d_1",scrollArea:"_scrollArea_15b0d_8",item:"_item_15b0d_12",select:"_select_15b0d_16",content:"_content_15b0d_20",itemTitle:"_itemTitle_15b0d_23",itemSubTitle:"_itemSubTitle_15b0d_30",circle:"_circle_15b0d_36",checkIcon:"_checkIcon_15b0d_37",empty:"_empty_15b0d_52",loading:"_loading_15b0d_55",nftPortal:"_nftPortal_15b0d_60",internalPortal:"_internalPortal_15b0d_64"};var pe=({baseCoin:e,addressType:m})=>{let[_,s]=(0,i.useState)(!1),[r,u]=(0,i.useState)(2),[y,b]=i.default.useState({visible:!1,valuelessNftNum:0,freedBtcAmount:""}),[c,U]=i.default.useState(!1),[A,j]=i.default.useState({txHash:"",vout:0,status:0}),{utxoData:C,loading:N,fetchAndSetData:B,selectList:I,isSelectAll:O,selectUtxo:M,handleSelectAll:F,detail:vt,fetchDetail:at,detailLoading:ht,activeList:lt,activeAmount:mt,coin:a}=ne(r,m);(0,i.useEffect)(()=>{It.get("manageUTXOAlert")||!a?.symbol||(U(!0),It.set("manageUTXOAlert",!0))},[a]);let{manageUTXO:z}=Tt(m),E=(0,ue.useSelector)(Qt),X=r===2,ye=l=>{j({txHash:l.txHash,vout:l.vout,status:l.status}),at(l.txHash,l.vout,l.status),s(!0)},Xt=l=>{let Y=a?.decimals||8;return Mt(l,10**Y)},ct=l=>{let Y=Xt(l);return yt(Y)},ge=te({isUnSpend:X,onConfirm:async()=>{let Y={utxoList:I.map(({txHash:V,vout:Nt,coinAmount:ve})=>({txHash:V,vout:Nt,coinAmount:ve})),spentStatus:r===1?0:1},{code:K,msg:_t}=await z(Y);await B();let $t=I.reduce((V,Nt)=>dt(V,Nt.coinAmount),0);if(K===0){let V=r===1?"extension_defi_mid_toast_frozen_success":"extension_defi_mid_toast_unfreeze_successful";wt.success({title:t(V,{value:ct($t),token:e.symbol})})}else{let V=r===1?"wallet_extension_top_toast_frozen_failed":"wallet_extension_top_toast_unfreeze_failed";wt.error({title:_t||t(V)})}},coin:a}),xe=async l=>{u(l)},Yt=l=>{let Y=Xt(l),K=a?.currencyPrice||0,_t=a?.currencySymbol||"$";return Et(Ut(Gt(Y),K),{symbol:_t,isFixedUp:!0})},be=l=>{let Y=E?.symbol||"$",K=E?.usdToThisRate||1;return Et(Ut(l,K),{symbol:Y,isFixedUp:!0})},Te=()=>N?i.default.createElement("div",{className:S.scrollArea},i.default.createElement("div",{className:S.loading},i.default.createElement(ut.Circle,null))):lt.length===0?i.default.createElement(Z.State,{className:S.empty,title:r===2?t("wallet_extension_mid_text_utxo_available"):t("wallet_extension_mid_text_noutxo_now")}):i.default.createElement("div",{className:S.scrollArea},i.default.createElement(ie,{amount:ct(mt),currencyAmount:Yt(mt),symbol:e.symbol,activeTab:r}),i.default.createElement("div",{className:S.list},(lt||[]).map(l=>i.default.createElement(L.FlexBox,{className:S.item,align:L.ALIGN.center,key:`${l.txHash}${l.vout}`},i.default.createElement("div",{className:S.select,onClick:()=>M(l)},i.default.createElement(Ht.Circle,{checked:l.select})),i.default.createElement(L.FlexBox,{className:S.content,direction:L.DIRECTION.vertical},i.default.createElement("div",{className:S.itemTitle},`${ct(l.coinAmount)} ${e.symbol}`),i.default.createElement("div",{className:S.itemSubTitle},Yt(l.coinAmount))),i.default.createElement(_e,{onClick:()=>ye(l)})))));return i.default.createElement(i.default.Fragment,null,i.default.createElement("div",{className:S.main},i.default.createElement(Q,{activeId:r,style:{height:"auto"},size:Q.SIZE.sm,category:Q.CATEGORY.outline,hideContent:!0,type:Q.NEW_TYPE.highlight,onChange:xe},i.default.createElement(Q.TabPane,{tab:t("wallet_extension_top_tab_unavailable"),id:2}),i.default.createElement(Q.TabPane,{tab:t("wallet_extension_top_tab_available"),id:1})),Te()),i.default.createElement(me,{selectList:I,utxoData:C,activeTab:r,handleConfirm:ge,divDecimal:ct,handleSelectAll:F,isSelectAll:O,symbol:e.symbol}),i.default.createElement(ae,{visible:_,closeCallback:s,detail:vt,getUSDtoCurrency:be,detailLoading:ht,detailUTXO:A,fetchDetail:at}),i.default.createElement(re,{visible:c,close:()=>U(!1),token:a?.symbol}),i.default.createElement(le,{tipData:y,handleConfirm:()=>b({...y,visible:!1}),symbol:e.symbol}))};o();n();var zt={container:"_container_8wg37_1",headerIcon:"_headerIcon_8wg37_8"};var we=()=>{let e=(0,de.useHistory)(),m=R(),_=m.get("addressType"),s=m.get("coinId"),{baseCoin:r={}}=Jt(s||J,!0),y=xt(r?.localType)[_],b=()=>{e.go(-1)};return nt.default.createElement("div",{className:zt.container},nt.default.createElement(Kt,{title:t("wallet_extension_header_title_manage_utxo"),onBack:b,closeable:!1},nt.default.createElement(kt,{placement:kt.DIRECTION.bottom,title:r.symbol?t("extension_defi_popup_tooltips_text_utxo_usage",{token:r.symbol}):""},nt.default.createElement(W,{className:(0,fe.default)("okds-information-circle",zt.headerIcon)}))),nt.default.createElement(pe,{addressType:_,baseCoin:r,looker:y,coinId:s}))},$r=we;export{$r as default};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "prepub";

//# sourceMappingURL=ManageUtxo-KUX3EZXC.js.map
