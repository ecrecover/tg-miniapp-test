import{a as ge,b as _e,c as N,d as we,e as Ie}from"./chunk-D6QLUPRP.js";import{a as xe}from"./chunk-T4GCTTFD.js";import"./chunk-2N725U3P.js";import{a as Pe}from"./chunk-HRX2UNWH.js";import{a as Ce}from"./chunk-44RHJNWT.js";import"./chunk-4T2UKPH7.js";import"./chunk-XQL7T4TZ.js";import"./chunk-SCZBCO2U.js";import"./chunk-NYT3QVML.js";import{j as de}from"./chunk-2P6KMQ6R.js";import{a as it}from"./chunk-PVE3B4RU.js";import{a as pe,c as fe}from"./chunk-UR6DV4PE.js";import"./chunk-ZB7DRNAH.js";import"./chunk-FJ3SSUO7.js";import"./chunk-TH64D43G.js";import"./chunk-LE6IGNMO.js";import"./chunk-EEQBHLM7.js";import"./chunk-37OBG2P3.js";import"./chunk-636MHS2Q.js";import"./chunk-XJ4IKVPR.js";import"./chunk-XE2F6LDQ.js";import"./chunk-REIQGNZB.js";import{d as le}from"./chunk-Q4CU3DV4.js";import{a as L}from"./chunk-DSYZP5KR.js";import{a as ne,b as ae,d as se}from"./chunk-UOZDNCIX.js";import"./chunk-FA3U5YIB.js";import"./chunk-RNB3JHFL.js";import"./chunk-2XG4UAIK.js";import"./chunk-2K7DYI6B.js";import"./chunk-UFQZJGJ2.js";import"./chunk-NZPUYPHL.js";import{c as re}from"./chunk-4QAFBCO2.js";import"./chunk-B553FNEQ.js";import"./chunk-6QKWDR6X.js";import{a as ue}from"./chunk-7XFZKU6W.js";import"./chunk-5DVBM2WJ.js";import"./chunk-2PABOPC7.js";import"./chunk-I3U7CKFC.js";import"./chunk-ZPDRUAGN.js";import{a as ie}from"./chunk-WCH23YYN.js";import"./chunk-NZZFB6IS.js";import{d as st,e as me,g as ce}from"./chunk-35PGDXR7.js";import"./chunk-PUO23DIP.js";import"./chunk-O2J764NL.js";import{a as te,e as v}from"./chunk-CDLW656Z.js";import"./chunk-3K3KMGWB.js";import{b as at}from"./chunk-5EZVDCYS.js";import"./chunk-475E6NBR.js";import"./chunk-RC5IAFKK.js";import"./chunk-4VLUHY4K.js";import"./chunk-IHPHPUUG.js";import"./chunk-ZEWK7OGU.js";import"./chunk-QVA4WXOQ.js";import"./chunk-EX22SDGB.js";import"./chunk-4RARGC4D.js";import"./chunk-OQOFXHGC.js";import{a as Ct}from"./chunk-3QA2SYRR.js";import"./chunk-3SC55VQ2.js";import{g as Zt}from"./chunk-VTLNAOHG.js";import"./chunk-Y7YPG2EJ.js";import"./chunk-7R67VE77.js";import"./chunk-NHGZUGLZ.js";import"./chunk-G5LEAVCY.js";import"./chunk-ACHWU2H6.js";import"./chunk-ZPFBKNRM.js";import{m as rt}from"./chunk-7DP5LYUM.js";import"./chunk-BVXKJJ4A.js";import"./chunk-TBBE7OKY.js";import"./chunk-7HJDVUH5.js";import{a as jt}from"./chunk-5CHBWRLU.js";import"./chunk-IY45K5V7.js";import"./chunk-QKBD2KSL.js";import"./chunk-VTOQBCNE.js";import{l as Te}from"./chunk-NEFFYVGA.js";import"./chunk-KUI26AZJ.js";import"./chunk-E2XQ2FKN.js";import"./chunk-ADKEXOTG.js";import"./chunk-7PVSIZ6H.js";import"./chunk-H7DITLB3.js";import{b as Jt}from"./chunk-5NXPDYL5.js";import"./chunk-DY54SY5O.js";import"./chunk-REOQ3O2A.js";import"./chunk-VQBK6IHT.js";import"./chunk-CTT7GD4C.js";import{e as qt,g as Vt,m as Kt}from"./chunk-LQAOHG2H.js";import"./chunk-WNQ6F6VV.js";import"./chunk-LEADLFDQ.js";import"./chunk-DGK7TBBE.js";import"./chunk-6Y7ULJF6.js";import{a as Ht,b as Yt}from"./chunk-3YH3AGVS.js";import"./chunk-3LB7TUPB.js";import"./chunk-TK6JYPIW.js";import"./chunk-OS6E6KVM.js";import"./chunk-GZRBUDXF.js";import"./chunk-WY46TT4P.js";import"./chunk-MTMUCMTY.js";import{h as nt,j as ee,k as oe,p as Tt}from"./chunk-S6N4IJX7.js";import"./chunk-ZD4EJWX6.js";import"./chunk-WGCZSWYA.js";import"./chunk-IINHHLHP.js";import"./chunk-DY2YURLY.js";import"./chunk-KXZSXP3G.js";import"./chunk-6HXVFU7V.js";import"./chunk-D5FMQLJG.js";import"./chunk-3I7UBQEQ.js";import"./chunk-DXRBY5MU.js";import"./chunk-6FR2UIE7.js";import{a as ot}from"./chunk-5GMHHIH5.js";import{f as Qt}from"./chunk-7KCWBFQ2.js";import"./chunk-QLUP7GYN.js";import"./chunk-7Y44NCE5.js";import"./chunk-BKPOG6ZD.js";import"./chunk-OZMVWMFO.js";import"./chunk-KTO7CPX7.js";import"./chunk-P3XTPXPO.js";import"./chunk-S6TPD26J.js";import"./chunk-4IY6P5HR.js";import"./chunk-FQWGOLDH.js";import{B as $t}from"./chunk-QEPBNPHF.js";import"./chunk-3JLS3TGD.js";import"./chunk-KDP5Z4RF.js";import"./chunk-W234FNSM.js";import"./chunk-DDO6HXRN.js";import"./chunk-CLWWTOKP.js";import{a as zt}from"./chunk-KZ2PCELG.js";import"./chunk-C7ZG4INB.js";import{a as Xt}from"./chunk-J5ANWCEO.js";import"./chunk-VMO2INN3.js";import"./chunk-J4TF3RT7.js";import{a as et,j as Dt,o as Ot}from"./chunk-6FOZGMAL.js";import{a as Wt}from"./chunk-2MV3WEYP.js";import{Wa as Lt,y as $}from"./chunk-HPXM6RSK.js";import{S as Gt,X as Rt,aa as dt,ca as Bt,d as vt,m as tt}from"./chunk-IUIJ46C3.js";import"./chunk-XRXUVH6X.js";import"./chunk-KZ3ZU675.js";import{a as mo}from"./chunk-NJ5CWPUY.js";import{l as U,p as Ut}from"./chunk-UMJMJOW4.js";import"./chunk-YTJBYVBO.js";import"./chunk-QO3243S4.js";import"./chunk-O5JCC6KG.js";import{d as St,f as io}from"./chunk-MAIAJ7GD.js";import"./chunk-4PGNX6E2.js";import"./chunk-DBHB6SUD.js";import"./chunk-6UYK5TIR.js";import"./chunk-I56VJWE4.js";import"./chunk-PS3S6BG3.js";import"./chunk-RT4Y2U5N.js";import"./chunk-2VHH444P.js";import{a as y,b as g}from"./chunk-RIMU4JTV.js";import"./chunk-MGLVPWSV.js";import"./chunk-TXKWPME2.js";import"./chunk-4D3M2I6W.js";import"./chunk-AMVK42SC.js";import"./chunk-D6RIE45O.js";import"./chunk-XCAARJ7Q.js";import{c as Mt}from"./chunk-JXCCIV3J.js";import{b as Nt,c as so}from"./chunk-AOA7NX2Y.js";import{j as Ft,m as ro}from"./chunk-HXZH2DHB.js";import"./chunk-MZG4RHXJ.js";import"./chunk-VTST2UXT.js";import{Ca as ft,Jc as bt,Kb as At,Tb as B,Wb as no,ac as kt,hb as oo,jc as ao,kb as ut,lb as Et,m as pt,pb as Z,qb as yt,rb as ht}from"./chunk-X7YMANPZ.js";import"./chunk-IRITFTWC.js";import{G as R,c as lt}from"./chunk-SOHTSUTI.js";import{I as K,w as T}from"./chunk-RPZQDAIQ.js";import"./chunk-LDRI4AYU.js";import"./chunk-E24EBHFY.js";import"./chunk-V4F2JFTP.js";import{a as W}from"./chunk-6DDC4Y2S.js";import"./chunk-TEY24VZN.js";import"./chunk-RKHQOOTU.js";import"./chunk-KJOC4LFM.js";import"./chunk-6FDO4Y56.js";import"./chunk-NNZ5SU5W.js";import"./chunk-F4JTGWJH.js";import"./chunk-YUXYCITH.js";import"./chunk-RMV3AS5X.js";import"./chunk-SF2LTPAC.js";import"./chunk-TEKDZ77C.js";import"./chunk-NC54RUAI.js";import"./chunk-YR74Q3QD.js";import{f as x,m,o as c}from"./chunk-EQYVU4XP.js";m();c();var O=x(W());no();m();c();var J=x(W()),Ae=x($()),ke=x(mo());m();c();var Fe=x($()),mt=x(pt());var co=t=>{let o=(0,Fe.useSelector)(Lt),e=t?.image;return(0,mt.isArray)(e)?t.image=e[0]:(0,mt.isObject)(e)&&(t.image=null),{token:t,provider:o}},Ee=co;m();c();K();var ye=x($());Ut();var po=(t={},o={},e=!0)=>{let r=(0,ye.useDispatch)(),a=t.address,u=ot(),i=_e(),s=L(),l={actionType:v.ACTION_TYPE.CANCEL,async onClick(){s({all_confirmation:"cancel",trade:"add_token"}),await i(a,!1),await U(r)},btnText:T("wallet_dapp_connection_btn_reject")},n={actionType:v.ACTION_TYPE.CONFIRM,disabled:!e,async onClick(){try{s({all_confirmation:"confirm",trade:"add_token"});let f=await nt(o.type,u),C={...t,contractAddress:a,blockChain:f.shortName,localType:o.type};await Jt(C),await i(a,!0),await U(r)}catch(f){R.error(f?.data?.originalError?.msg||T("wallet_extenshion_toast_add_failed"))}}};return[l,n]},he=po;var lo=({unapproved:t})=>{let o=(0,Ae.useSelector)(Yt),{token:e,provider:r}=Ee(t),[a,u]=(0,J.useState)(!0),i=ot();Dt(async()=>{let l=await nt(r.type,i);u(!!l)});let s=he(e,r,a);return!e||o!==Ht.addToken?J.default.createElement(ke.Redirect,{to:Wt}):J.default.createElement(Pe,{token:e,provider:r,supported:a,buttonGroup:s})},Ne=lo;m();c();var Re=x(W());var X=x($());Ut();K();m();c();var D=x(W());io();var Se=()=>(0,D.useCallback)(async(o,e)=>{await St().updateReportTimestamp(o,e)},[]);var fo=()=>{let t=Se();return(0,D.useCallback)(async e=>{await t(e,"CAN_CONFIRM")},[t])},Me=(t,o)=>{let e=fo(),r=(0,D.useRef)(!1);(0,D.useEffect)(()=>{!o&&!r.current&&(r.current=!0,e(t))},[t,o,e])},be=()=>{let t=Se();return(0,D.useCallback)(async e=>{await t(e,"CLICK_CONFIRM")},[t])};m();c();var ve=x(pt());var Ge=({isMev:t,mevInfo:o,unapproved:e,modifiedData:r,customGasInfo:a,updateData:u,gasReturnActivity:i})=>{let{nonce:s,updateGasInfo:l}=u,n=(0,ve.cloneDeep)(e),{supportEip1559:f,gasLimitInfo:C={},gasLimit:P,maxFeePerGas:w,gasPrice:I,maxPriorityFeePerGas:F}=a;if(r&&n.txParams&&(n.txParams.data=r),f?(delete n?.txParams.gasPrice,n.txParams.maxFeePerGas=g(w),n.txParams.maxPriorityFeePerGas=g(F),n.txParams.type=tt.FEE_MARKET):(delete n?.txParams.maxFeePerGas,delete n?.txParams.maxPriorityFeePerGas,delete n?.txParams.type,n.txParams.gasPrice=g(I)),l){let A=Object.entries(l).reduce((_,[E,h])=>(_[E]=g(h),_),{});n.txParams={...n.txParams,...A}}return n.txParams.gas=g(P),n.txParams.nonce=g(s),n.gasLimitInfo=C||{},n.mev=t?o.name:"",n.activityId=i?.activityId,n.gasType=a.gasType,e?.txParams?.data||(n.isBaseCoinTransfer=!0),n};var uo=(t,o)=>{let e=(0,X.useSelector)(a=>oe(a,t)),r=(0,X.useSelector)(a=>ee(a,t)??o??!1);return{mevInfo:e,isMev:r}},To=({unapproved:t})=>{let o=(0,X.useDispatch)(),e=N(),r=it(t),{id:a,txParams:u={},extParams:i={}}=t,{from:s,to:l,value:n}=u,{coinId:f,chainName:C}=e,P=ge(t.origin,s)||{},{isMev:w,mevInfo:I}=uo(a,i?.isMev),F=be(),A=et((M,b)=>{o(Tt.setIsMev({isMev:M,id:a})),o(Tt.setMevInfo({mevInfo:b,id:a}))});Me();let _=L(P?.walletId),E=et(async()=>{_({trade:"contract_interaction",all_confirmation:"cancel",network:C,dapp_url:t.origin}),$t(),await o(Kt({id:a})),await U(o)}),h=pe(),k=et(async({modifiedData:M,customGasInfo:b,gasReturnActivity:H,reportGasReturnActivityDataInConfirm:q})=>{let{gasPrice:ct}=b;if(F(a),await at({callback:E,walletId:P?.walletId})){_({all_confirmation:"confirm",trade:"contract_interaction",network:C,dapp_url:t.origin});let j=await h({to:l,from:s,coinId:f,gasPrice:ct,userGasInfo:b,amount:y(n||0),baseCoinAmountUse:y(n||0)});q(),await o(Vt(Ge({isMev:w,mevInfo:I,unapproved:t,updateData:j,modifiedData:M,customGasInfo:b,gasReturnActivity:H}))).then(V=>{let{serverTxId:G}=V||{};Te({tx_id:G})}).catch(V=>{try{let G=V?.data?.originalError;qt(G.code)&&(H?.clear(),R.error({title:G?.msg||T("wallet_home_toast_network_error"),duration:3}))}catch(G){console.log(G)}}),await U(o)}});return Re.default.createElement(fe,{needMev:!0,coinId:f,openMev:w,onConfirmReplace:!0,dappInfo:r,txParams:u,txType:t?.type,walletId:P?.walletId,isShowBlockSwapMevTooltip:i?.isShowBlockSwapMevTooltip,onMevChange:A,onCancel:E,onConfirm:k})},Be=To;m();c();K();var d=x(W());m();c();var xt=x(pt()),Le=x(W());At();var Co=({unapproved:t,walletAccount:o,customGasInfo:e={}})=>{let{params:r}=t,{walletId:a}=o,u=N(),{coinId:i}=u,s=Zt(i,a)?.coinAmountInt,{gasType:l,isNetworkFeeLoading:n,networkFee:f,getLimit:C}=e,{minGasFee:P}=ne(e),w=ae(e),I=(0,Le.useMemo)(()=>{if((0,xt.isNil)(s))return r;let h=s,k=[];return r.forEach(M=>{h=Et(h,f),Z(h,0)&&k.push(M)}),k},[s,r,f]),F=n&&ht(C,0),A={level:l||Rt.STANDARD,loading:n,coinId:u?.coinId,networkFee:F?void 0:P,maxNetworkFee:F?void 0:f,estimateFailed:w},_=n||I.length&&I.length===r.length,E=(0,xt.isNil)(s)||yt(s,f);return{isNetworkFeeLoading:n,estimateFailed:w,networkFeeProps:A,canApproveTxs:I,isSufficientGas:E,canApproveAll:_}},De=Co;m();c();K();var xo=t=>{for(let o=0;o<t.length;o++){let e=t[o],r=e();if(r)return r}return null},go=({walletAccount:t,canApproveTxs:o,canApproveAll:e,isSufficientGas:r})=>{let a=rt(t.walletId),u=()=>a?{type:lt.TYPE.error,message:T("wallet_extension_function_alert_wallet_unsupported")}:null,i=N(),s=de({baseCoin:i,isSufficientGas:r});return xo([u,s,()=>e?null:{type:lt.TYPE.warn,message:T("wallet_extension_function_alert_available_balance",{gasToken:i.symbol,num:o.length})}])},Oe=go;m();c();var He=x(W());K();At();oo();so();ao();ro();var We=100,Po=({unapproved:t,walletAccount:o,isSufficientGas:e,canApproveTxs:r,customGasInfo:a,isNetworkFeeLoading:u})=>{let{id:i}=t,{walletId:s,address:l}=o,n=rt(s),f=L(s),{coinId:C}=N(),P=xe(),w=Ce(),I=(0,He.useCallback)(async()=>{f({trade:"sendEvmInscriptions",all_confirmation:"cancel"}),await P({id:i})},[P,f,i]),F={onClick:I,actionType:v.ACTION_TYPE.CANCEL,btnText:T("wallet_dapp_connection_btn_reject")},A=n||u,{gasPrice:_,supportEip1559:E,gasLimitInfo:h={},gasLimit:k,maxFeePerGas:M,maxPriorityFeePerGas:b,networkFee:H}=a,q=re({fromAddr:r[0]?.txParams?.from,walletId:s,localType:ft}),ct=async()=>{try{let j=r.length,V=r[0],{from:G,to:qe,value:je}=V.txParams;if(f({trade:"sendEvmInscriptions",all_confirmation:"confirm"}),!await at({callback:I,walletId:s}))return;let{data:Ve}=await Qt({checkTypes:[dt.OVERWRITTEN],coinId:C,from:G,to:qe,amount:y(je||0),gasPrice:_}),Ke=Ve.find(({checkType:Y})=>Y===dt.OVERWRITTEN)||{},{newNonce:Je,toastType:Xe,pendingNum:ze}=Ke;if(Xe===Bt.FAILED){R.error(T("wallet_extension_function_toast_failed_single")),await Ct(1500),await P({id:i});return}let gt=ut(ze,j);if(Z(gt,We)){R.error(T("wallet_extension_function_toast_pending",{TotalNum:gt,ExceededNum:We}));return}let Pt=[],_t=[];for(let Y=0;Y<r.length;Y++){let Q=r[Y],{txParams:p}=Q,{from:Qe,to:Ze}=p;p.nonce=kt(g(ut(Je,Y))),E?(delete Q.gasPrice,p.maxFeePerGas=g(M),p.maxPriorityFeePerGas=g(b),p.type=tt.FEE_MARKET):(delete p.maxFeePerGas,delete p.maxPriorityFeePerGas,delete p.type,p.gasPrice=g(_)),p.gas=g(k),p.gasLimit=g(k),p.gasLimitInfo=h,p.gasType=a.gasType;let $e=jt(Q.txParams),wt=await q({params:$e}),It=await te(ft,wt),to={...p,value:y(p.value),gas:k,gasPrice:y(E?p.maxFeePerGas:p.gasPrice),priorityFee:y(E?p.maxPriorityFeePerGas:0),nonce:y(p.nonce),repeatTxType:vt.CONFIRMING,oldTxHash:"",inscriptionType:1},eo={extJson:JSON.stringify(to),signedTx:wt,coinId:C,coinAmount:y(p.value||0),fromAdr:Qe,toAdr:Ze,serviceCharge:H,txHash:It,txSource:bt.DAPP,inputData:p.data,accountId:s,txType:1,walletType:o?.serverWalletType};_t.push(eo),Pt.push({id:Q.id,txHash:It})}await Ft(Nt.postSendEvmInscriptions,{txList:_t}),await w({id:i,result:Pt})}catch(j){R.error(j.msg||T("wallet_home_toast_network_error")),await Ct(1500),await w({id:i,error:"Failed"})}},z={disabled:A,actionType:v.ACTION_TYPE.CONFIRM,onClick:ct};return A?[F,z]:(e||(z={actionType:v.ACTION_TYPE.FILL_UP,txId:i,coinId:C,walletId:s,address:l,receiveOnly:e}),[F,z])},Ye=Po;var _o=({unapproved:t})=>{let{coinId:o}=N(),{txParams:e={}}=t?.params?.[0],{from:r,to:a,data:u,value:i}=e,{walletId:s}=t,l=ue(t),n=L(s),f=it(t),[C,P]=(0,d.useState)({}),w=(0,d.useCallback)(q=>{P(q)},[]),{networkFeeProps:I,canApproveTxs:F,canApproveAll:A,isSufficientGas:_,isNetworkFeeLoading:E}=De({unapproved:t,walletAccount:l,customGasInfo:C}),h=Ye({unapproved:t,walletAccount:l,canApproveTxs:F,customGasInfo:C,isSufficientGas:_,isNetworkFeeLoading:E}),k=Oe({walletAccount:l,canApproveTxs:F,canApproveAll:A,isSufficientGas:_}),[M,{setTrue:b,setFalse:H}]=Ot(!1);return d.default.createElement(Mt.Container,null,d.default.createElement(zt,{title:T("wallet_extension_function_title_bulk_signing"),closeable:!1,backable:!1}),d.default.createElement(st,null,d.default.createElement(le,{...f})),d.default.createElement(st,null,d.default.createElement(ie,{onClick:b,...I})),d.default.createElement(st,{bordered:!1},d.default.createElement(me,{title:T("wallet_extension_network_address_title_walletused"),address:l.address,walletId:l.walletId,onCopyCallback:()=>{n({trade:"sendEvmInscriptions",all_confirmation:"wallet_used_address"})}})),d.default.createElement(Xt,{placeholder:!0,offsetBottom:0,borderTop:!0},d.default.createElement(ce,{...k}),d.default.createElement(v,{buttonGroup:h})),d.default.createElement(se,{visible:M,coinId:o,address:r,inputData:u,tokenAddress:a,value:y(i),onBack:H,onClose:null,onGasChange:w}))},Ue=_o;var Kn=(0,O.memo)(({unapproved:t})=>{switch(t.method){case Gt.SEND_EVM_INSCRIPTIONS:return O.default.createElement(Ue,{unapproved:t});default:break}switch(t.type){case B.ETH_SIGN:case B.PERSONAL_SIGN:case B.ETH_SIGN_TYPED_DATA:case B.ETH_GET_ENCRYPTION_PUBLIC_KEY:case B.ETH_DECRYPT:return O.default.createElement(we,{unapproved:t});case B.WATCH_ASSET:return O.default.createElement(Ne,{unapproved:t});case B.ADD_ETHEREUM_CHAIN:return O.default.createElement(Ie,{unapproved:t});default:return O.default.createElement(Be,{unapproved:t})}});export{Kn as default};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "prepub";

//# sourceMappingURL=Ethereum-TXKALWZK.js.map
